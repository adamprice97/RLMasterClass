{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0003, "total_loss": 9.29830911424425, "policy_loss": -0.0011381315826265901, "vf_loss": 9.299147923787435, "vf_explained_var": 0.00013941305655020255, "kl": 0.001850455323895211, "entropy": 0.7068783839543661, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 14.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 18000, "num_env_steps_trained": 18000, "num_agent_steps_sampled": 18000, "num_agent_steps_trained": 18000}, "sampler_results": {"episode_reward_max": 36.30000000000003, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -33.16388888888927, "episode_len_mean": 456.8888888888889, "episode_media": {}, "episodes_this_iter": 36, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [25.29999999999992, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 16.499999999999794, 36.30000000000003, -50.00000000000044, -50.00000000000044, 8.899999999999686, 29.299999999999976, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 13.899999999999757, -50.00000000000044, -50.00000000000044, 22.899999999999885, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 2.8999999999996007, 0.09999999999956088], "episode_lengths": [248, 500, 500, 500, 500, 500, 500, 500, 336, 138, 500, 500, 412, 208, 500, 500, 500, 500, 500, 500, 500, 500, 362, 500, 500, 272, 500, 500, 500, 500, 500, 500, 500, 500, 472, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42012744867984325, "mean_inference_ms": 1.3740888548352679, "mean_action_processing_ms": 0.16360240011196148, "mean_env_wait_ms": 0.09674674374459452, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022210015190972224, "StateBufferConnector_ms": 0.022218624750773113, "ViewRequirementAgentConnector_ms": 0.11788540416293675}}, "episode_reward_max": 36.30000000000003, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -33.16388888888927, "episode_len_mean": 456.8888888888889, "episodes_this_iter": 36, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [25.29999999999992, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 16.499999999999794, 36.30000000000003, -50.00000000000044, -50.00000000000044, 8.899999999999686, 29.299999999999976, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 13.899999999999757, -50.00000000000044, -50.00000000000044, 22.899999999999885, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 2.8999999999996007, 0.09999999999956088], "episode_lengths": [248, 500, 500, 500, 500, 500, 500, 500, 336, 138, 500, 500, 412, 208, 500, 500, 500, 500, 500, 500, 500, 500, 362, 500, 500, 272, 500, 500, 500, 500, 500, 500, 500, 500, 472, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42012744867984325, "mean_inference_ms": 1.3740888548352679, "mean_action_processing_ms": 0.16360240011196148, "mean_env_wait_ms": 0.09674674374459452, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022210015190972224, "StateBufferConnector_ms": 0.022218624750773113, "ViewRequirementAgentConnector_ms": 0.11788540416293675}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18000, "num_agent_steps_trained": 18000, "num_env_steps_sampled": 18000, "num_env_steps_trained": 18000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5258.104403123878, "num_env_steps_trained_throughput_per_sec": 5258.104403123878, "timesteps_total": 18000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 18000, "timers": {"training_iteration_time_ms": 3423.287, "sample_time_ms": 3208.404, "load_time_ms": 10.773, "load_throughput": 1670852.54, "learn_time_ms": 188.56, "learn_throughput": 95460.085, "synch_weights_time_ms": 11.548}, "counters": {"num_env_steps_sampled": 18000, "num_env_steps_trained": 18000, "num_agent_steps_sampled": 18000, "num_agent_steps_trained": 18000}, "done": false, "episodes_total": 36, "training_iteration": 1, "trial_id": "9f288_00020", "date": "2023-10-25_17-11-52", "timestamp": 1698250312, "time_this_iter_s": 3.428286075592041, "time_total_s": 3.428286075592041, "pid": 9936, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 3.428286075592041, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 71.38, "ram_util_percent": 27.139999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0003, "total_loss": 8.829129607589156, "policy_loss": -0.002956149202805978, "vf_loss": 8.831773722613299, "vf_explained_var": -6.490283542209202e-07, "kl": 0.0038511592685052973, "entropy": 0.7295882613570602, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 41.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "sampler_results": {"episode_reward_max": 42.10000000000001, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -24.5936708860763, "episode_len_mean": 429.8481012658228, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [25.29999999999992, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 16.499999999999794, 36.30000000000003, -50.00000000000044, -50.00000000000044, 8.899999999999686, 29.299999999999976, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 13.899999999999757, -50.00000000000044, -50.00000000000044, 22.899999999999885, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 2.8999999999996007, 0.09999999999956088, -50.00000000000044, 5.899999999999643, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, 21.499999999999865, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.099999999999774, 33.90000000000004, 17.499999999999808, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.50000000000003, 36.10000000000004, 7.899999999999672, 7.499999999999666, 5.099999999999632, -50.00000000000044, 27.49999999999995, 25.099999999999916, 8.299999999999677, -50.00000000000044, 5.299999999999635, -50.00000000000044, 24.899999999999913, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 10.499999999999709, -50.00000000000044, -50.00000000000044, 30.099999999999987, 29.299999999999976, 8.899999999999686, -50.00000000000044, -50.00000000000044], "episode_lengths": [248, 500, 500, 500, 500, 500, 500, 500, 336, 138, 500, 500, 412, 208, 500, 500, 500, 500, 500, 500, 500, 500, 362, 500, 500, 272, 500, 500, 500, 500, 500, 500, 500, 500, 472, 500, 500, 442, 500, 500, 80, 500, 286, 500, 500, 500, 500, 350, 162, 326, 500, 500, 500, 116, 140, 422, 426, 450, 500, 226, 250, 418, 500, 448, 500, 252, 500, 500, 500, 500, 500, 396, 500, 500, 200, 208, 412, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4169388090994265, "mean_inference_ms": 1.365715491299307, "mean_action_processing_ms": 0.16254645570326337, "mean_env_wait_ms": 0.09427506881955737, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029908252667777146, "StateBufferConnector_ms": 0.012653990636897993, "ViewRequirementAgentConnector_ms": 0.13874905018866818}}, "episode_reward_max": 42.10000000000001, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -24.5936708860763, "episode_len_mean": 429.8481012658228, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [25.29999999999992, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 16.499999999999794, 36.30000000000003, -50.00000000000044, -50.00000000000044, 8.899999999999686, 29.299999999999976, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 13.899999999999757, -50.00000000000044, -50.00000000000044, 22.899999999999885, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 2.8999999999996007, 0.09999999999956088, -50.00000000000044, 5.899999999999643, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, 21.499999999999865, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.099999999999774, 33.90000000000004, 17.499999999999808, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.50000000000003, 36.10000000000004, 7.899999999999672, 7.499999999999666, 5.099999999999632, -50.00000000000044, 27.49999999999995, 25.099999999999916, 8.299999999999677, -50.00000000000044, 5.299999999999635, -50.00000000000044, 24.899999999999913, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 10.499999999999709, -50.00000000000044, -50.00000000000044, 30.099999999999987, 29.299999999999976, 8.899999999999686, -50.00000000000044, -50.00000000000044], "episode_lengths": [248, 500, 500, 500, 500, 500, 500, 500, 336, 138, 500, 500, 412, 208, 500, 500, 500, 500, 500, 500, 500, 500, 362, 500, 500, 272, 500, 500, 500, 500, 500, 500, 500, 500, 472, 500, 500, 442, 500, 500, 80, 500, 286, 500, 500, 500, 500, 350, 162, 326, 500, 500, 500, 116, 140, 422, 426, 450, 500, 226, 250, 418, 500, 448, 500, 252, 500, 500, 500, 500, 500, 396, 500, 500, 200, 208, 412, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4169388090994265, "mean_inference_ms": 1.365715491299307, "mean_action_processing_ms": 0.16254645570326337, "mean_env_wait_ms": 0.09427506881955737, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029908252667777146, "StateBufferConnector_ms": 0.012653990636897993, "ViewRequirementAgentConnector_ms": 0.13874905018866818}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5206.935870816768, "num_env_steps_trained_throughput_per_sec": 5206.935870816768, "timesteps_total": 36000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 3440.107, "sample_time_ms": 3165.119, "load_time_ms": 13.886, "load_throughput": 1296271.969, "learn_time_ms": 247.326, "learn_throughput": 72778.539, "synch_weights_time_ms": 10.775}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "episodes_total": 79, "training_iteration": 2, "trial_id": "9f288_00020", "date": "2023-10-25_17-11-55", "timestamp": 1698250315, "time_this_iter_s": 3.4618351459503174, "time_total_s": 6.890121221542358, "pid": 9936, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 6.890121221542358, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 69.38, "ram_util_percent": 27.160000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.05000000000000001, "cur_lr": 0.0003, "total_loss": 8.952489146479854, "policy_loss": -0.0011936149525421638, "vf_loss": 8.95363027078134, "vf_explained_var": -2.569622463650174e-06, "kl": 0.00241665135478831, "entropy": 0.6825283456731726, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 68.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 54000, "num_env_steps_trained": 54000, "num_agent_steps_sampled": 54000, "num_agent_steps_trained": 54000}, "sampler_results": {"episode_reward_max": 44.300000000000004, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -7.919000000000263, "episode_len_mean": 364.76, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 2.8999999999996007, 0.09999999999956088, -50.00000000000044, 5.899999999999643, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, 21.499999999999865, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.099999999999774, 33.90000000000004, 17.499999999999808, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.50000000000003, 36.10000000000004, 7.899999999999672, 7.499999999999666, 5.099999999999632, -50.00000000000044, 27.49999999999995, 25.099999999999916, 8.299999999999677, -50.00000000000044, 5.299999999999635, -50.00000000000044, 24.899999999999913, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 10.499999999999709, -50.00000000000044, -50.00000000000044, 30.099999999999987, 29.299999999999976, 8.899999999999686, -50.00000000000044, -50.00000000000044, 13.499999999999751, -50.00000000000044, 24.899999999999913, -50.00000000000044, 35.10000000000004, 1.8999999999995865, 39.70000000000002, 36.50000000000003, 42.10000000000001, -50.00000000000044, 31.1, 8.49999999999968, 38.10000000000002, 33.30000000000003, -50.00000000000044, 3.2999999999996064, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.50000000000002, 20.299999999999848, 38.10000000000002, -50.00000000000044, -50.00000000000044, 32.100000000000016, 2.0999999999995893, -50.00000000000044, 32.30000000000002, 41.90000000000001, -50.00000000000044, -50.00000000000044, 37.70000000000003, 10.499999999999709, 5.499999999999638, 15.699999999999783, -50.00000000000044, -50.00000000000044, 33.70000000000004, -50.00000000000044, 41.500000000000014, 30.099999999999987, 21.699999999999868, 44.300000000000004, 18.099999999999817, 42.30000000000001, 19.499999999999837, 26.89999999999994, 41.30000000000001, 29.299999999999976, -50.00000000000044, -50.00000000000044, 28.699999999999967, -50.00000000000044], "episode_lengths": [500, 500, 472, 500, 500, 442, 500, 500, 80, 500, 286, 500, 500, 500, 500, 350, 162, 326, 500, 500, 500, 116, 140, 422, 426, 450, 500, 226, 250, 418, 500, 448, 500, 252, 500, 500, 500, 500, 500, 396, 500, 500, 200, 208, 412, 500, 500, 366, 500, 252, 500, 150, 482, 104, 136, 80, 500, 190, 416, 120, 168, 500, 468, 500, 500, 500, 176, 298, 120, 500, 500, 180, 480, 500, 178, 82, 500, 500, 124, 396, 446, 344, 500, 500, 164, 500, 86, 200, 284, 58, 320, 78, 306, 232, 88, 208, 500, 500, 214, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41425507683884794, "mean_inference_ms": 1.3553427295826013, "mean_action_processing_ms": 0.16071749823900372, "mean_env_wait_ms": 0.09216218015499898, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03462028503417969, "StateBufferConnector_ms": 0.005989551544189453, "ViewRequirementAgentConnector_ms": 0.1462996006011963}}, "episode_reward_max": 44.300000000000004, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -7.919000000000263, "episode_len_mean": 364.76, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 2.8999999999996007, 0.09999999999956088, -50.00000000000044, 5.899999999999643, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, 21.499999999999865, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.099999999999774, 33.90000000000004, 17.499999999999808, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.50000000000003, 36.10000000000004, 7.899999999999672, 7.499999999999666, 5.099999999999632, -50.00000000000044, 27.49999999999995, 25.099999999999916, 8.299999999999677, -50.00000000000044, 5.299999999999635, -50.00000000000044, 24.899999999999913, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 10.499999999999709, -50.00000000000044, -50.00000000000044, 30.099999999999987, 29.299999999999976, 8.899999999999686, -50.00000000000044, -50.00000000000044, 13.499999999999751, -50.00000000000044, 24.899999999999913, -50.00000000000044, 35.10000000000004, 1.8999999999995865, 39.70000000000002, 36.50000000000003, 42.10000000000001, -50.00000000000044, 31.1, 8.49999999999968, 38.10000000000002, 33.30000000000003, -50.00000000000044, 3.2999999999996064, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.50000000000002, 20.299999999999848, 38.10000000000002, -50.00000000000044, -50.00000000000044, 32.100000000000016, 2.0999999999995893, -50.00000000000044, 32.30000000000002, 41.90000000000001, -50.00000000000044, -50.00000000000044, 37.70000000000003, 10.499999999999709, 5.499999999999638, 15.699999999999783, -50.00000000000044, -50.00000000000044, 33.70000000000004, -50.00000000000044, 41.500000000000014, 30.099999999999987, 21.699999999999868, 44.300000000000004, 18.099999999999817, 42.30000000000001, 19.499999999999837, 26.89999999999994, 41.30000000000001, 29.299999999999976, -50.00000000000044, -50.00000000000044, 28.699999999999967, -50.00000000000044], "episode_lengths": [500, 500, 472, 500, 500, 442, 500, 500, 80, 500, 286, 500, 500, 500, 500, 350, 162, 326, 500, 500, 500, 116, 140, 422, 426, 450, 500, 226, 250, 418, 500, 448, 500, 252, 500, 500, 500, 500, 500, 396, 500, 500, 200, 208, 412, 500, 500, 366, 500, 252, 500, 150, 482, 104, 136, 80, 500, 190, 416, 120, 168, 500, 468, 500, 500, 500, 176, 298, 120, 500, 500, 180, 480, 500, 178, 82, 500, 500, 124, 396, 446, 344, 500, 500, 164, 500, 86, 200, 284, 58, 320, 78, 306, 232, 88, 208, 500, 500, 214, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41425507683884794, "mean_inference_ms": 1.3553427295826013, "mean_action_processing_ms": 0.16071749823900372, "mean_env_wait_ms": 0.09216218015499898, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03462028503417969, "StateBufferConnector_ms": 0.005989551544189453, "ViewRequirementAgentConnector_ms": 0.1462996006011963}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 54000, "num_agent_steps_trained": 54000, "num_env_steps_sampled": 54000, "num_env_steps_trained": 54000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5186.373737797016, "num_env_steps_trained_throughput_per_sec": 5186.373737797016, "timesteps_total": 54000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 54000, "timers": {"training_iteration_time_ms": 3450.282, "sample_time_ms": 3143.612, "load_time_ms": 14.448, "load_throughput": 1245860.283, "learn_time_ms": 279.038, "learn_throughput": 64507.428, "synch_weights_time_ms": 10.518}, "counters": {"num_env_steps_sampled": 54000, "num_env_steps_trained": 54000, "num_agent_steps_sampled": 54000, "num_agent_steps_trained": 54000}, "done": false, "episodes_total": 132, "training_iteration": 3, "trial_id": "9f288_00020", "date": "2023-10-25_17-11-59", "timestamp": 1698250319, "time_this_iter_s": 3.476682186126709, "time_total_s": 10.366803407669067, "pid": 9936, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 10.366803407669067, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 66.9, "ram_util_percent": 27.22}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.0003, "total_loss": 8.87321804187916, "policy_loss": -0.0006675544988226007, "vf_loss": 8.873895574499059, "vf_explained_var": 2.2075794361255787e-07, "kl": 0.0022133572680710736, "entropy": 0.6525139345063103, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 95.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "sampler_results": {"episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.2769999999997923, "episode_len_mean": 312.92, "episode_media": {}, "episodes_this_iter": 62, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.2999999999996064, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.50000000000002, 20.299999999999848, 38.10000000000002, -50.00000000000044, -50.00000000000044, 32.100000000000016, 2.0999999999995893, -50.00000000000044, 32.30000000000002, 41.90000000000001, -50.00000000000044, -50.00000000000044, 37.70000000000003, 10.499999999999709, 5.499999999999638, 15.699999999999783, -50.00000000000044, -50.00000000000044, 33.70000000000004, -50.00000000000044, 41.500000000000014, 30.099999999999987, 21.699999999999868, 44.300000000000004, 18.099999999999817, 42.30000000000001, 19.499999999999837, 26.89999999999994, 41.30000000000001, 29.299999999999976, -50.00000000000044, -50.00000000000044, 28.699999999999967, -50.00000000000044, 10.699999999999712, 18.099999999999817, 28.89999999999997, 46.5, 3.0999999999996035, -50.00000000000044, -50.00000000000044, 7.699999999999669, 39.70000000000002, 44.10000000000001, -50.00000000000044, 39.300000000000026, 7.299999999999663, 44.10000000000001, 42.70000000000001, 19.09999999999983, 43.50000000000001, 29.299999999999976, -50.00000000000044, 38.700000000000024, -50.00000000000044, 26.09999999999993, 35.10000000000004, 16.699999999999797, -50.00000000000044, 43.30000000000001, 38.700000000000024, -50.00000000000044, 0.09999999999956088, 39.90000000000002, 22.299999999999876, 12.099999999999731, 13.299999999999748, 35.10000000000004, 35.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 11.099999999999717, 38.50000000000003, 41.500000000000014, 42.900000000000006, 20.899999999999856, -50.00000000000044, 11.699999999999726, -50.00000000000044, 20.899999999999856, 39.300000000000026, 29.69999999999998, 41.500000000000014, -50.00000000000044, 45.1, 32.100000000000016, 3.499999999999609, 3.499999999999609, -50.00000000000044, 26.89999999999994, -50.00000000000044, 8.49999999999968, -50.00000000000044, -50.00000000000044, 29.49999999999998], "episode_lengths": [468, 500, 500, 500, 176, 298, 120, 500, 500, 180, 480, 500, 178, 82, 500, 500, 124, 396, 446, 344, 500, 500, 164, 500, 86, 200, 284, 58, 320, 78, 306, 232, 88, 208, 500, 500, 214, 500, 394, 320, 212, 36, 470, 500, 500, 424, 104, 60, 500, 108, 428, 60, 74, 310, 66, 208, 500, 114, 500, 240, 150, 334, 500, 68, 114, 500, 500, 102, 278, 380, 368, 150, 144, 500, 500, 500, 390, 116, 86, 72, 292, 500, 384, 500, 292, 108, 204, 86, 500, 50, 180, 466, 466, 500, 232, 500, 416, 500, 500, 206]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4224510642502187, "mean_inference_ms": 1.369244358318096, "mean_action_processing_ms": 0.1618336134494875, "mean_env_wait_ms": 0.09461690736083027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.036962270736694336, "StateBufferConnector_ms": 0.007035493850708008, "ViewRequirementAgentConnector_ms": 0.15452957153320312}}, "episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.2769999999997923, "episode_len_mean": 312.92, "episodes_this_iter": 62, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [3.2999999999996064, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.50000000000002, 20.299999999999848, 38.10000000000002, -50.00000000000044, -50.00000000000044, 32.100000000000016, 2.0999999999995893, -50.00000000000044, 32.30000000000002, 41.90000000000001, -50.00000000000044, -50.00000000000044, 37.70000000000003, 10.499999999999709, 5.499999999999638, 15.699999999999783, -50.00000000000044, -50.00000000000044, 33.70000000000004, -50.00000000000044, 41.500000000000014, 30.099999999999987, 21.699999999999868, 44.300000000000004, 18.099999999999817, 42.30000000000001, 19.499999999999837, 26.89999999999994, 41.30000000000001, 29.299999999999976, -50.00000000000044, -50.00000000000044, 28.699999999999967, -50.00000000000044, 10.699999999999712, 18.099999999999817, 28.89999999999997, 46.5, 3.0999999999996035, -50.00000000000044, -50.00000000000044, 7.699999999999669, 39.70000000000002, 44.10000000000001, -50.00000000000044, 39.300000000000026, 7.299999999999663, 44.10000000000001, 42.70000000000001, 19.09999999999983, 43.50000000000001, 29.299999999999976, -50.00000000000044, 38.700000000000024, -50.00000000000044, 26.09999999999993, 35.10000000000004, 16.699999999999797, -50.00000000000044, 43.30000000000001, 38.700000000000024, -50.00000000000044, 0.09999999999956088, 39.90000000000002, 22.299999999999876, 12.099999999999731, 13.299999999999748, 35.10000000000004, 35.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 11.099999999999717, 38.50000000000003, 41.500000000000014, 42.900000000000006, 20.899999999999856, -50.00000000000044, 11.699999999999726, -50.00000000000044, 20.899999999999856, 39.300000000000026, 29.69999999999998, 41.500000000000014, -50.00000000000044, 45.1, 32.100000000000016, 3.499999999999609, 3.499999999999609, -50.00000000000044, 26.89999999999994, -50.00000000000044, 8.49999999999968, -50.00000000000044, -50.00000000000044, 29.49999999999998], "episode_lengths": [468, 500, 500, 500, 176, 298, 120, 500, 500, 180, 480, 500, 178, 82, 500, 500, 124, 396, 446, 344, 500, 500, 164, 500, 86, 200, 284, 58, 320, 78, 306, 232, 88, 208, 500, 500, 214, 500, 394, 320, 212, 36, 470, 500, 500, 424, 104, 60, 500, 108, 428, 60, 74, 310, 66, 208, 500, 114, 500, 240, 150, 334, 500, 68, 114, 500, 500, 102, 278, 380, 368, 150, 144, 500, 500, 500, 390, 116, 86, 72, 292, 500, 384, 500, 292, 108, 204, 86, 500, 50, 180, 466, 466, 500, 232, 500, 416, 500, 500, 206]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4224510642502187, "mean_inference_ms": 1.369244358318096, "mean_action_processing_ms": 0.1618336134494875, "mean_env_wait_ms": 0.09461690736083027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.036962270736694336, "StateBufferConnector_ms": 0.007035493850708008, "ViewRequirementAgentConnector_ms": 0.15452957153320312}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4743.107641176101, "num_env_steps_trained_throughput_per_sec": 4743.107641176101, "timesteps_total": 72000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 3536.457, "sample_time_ms": 3215.986, "load_time_ms": 14.586, "load_throughput": 1234087.656, "learn_time_ms": 293.007, "learn_throughput": 61431.926, "synch_weights_time_ms": 10.379}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "episodes_total": 194, "training_iteration": 4, "trial_id": "9f288_00020", "date": "2023-10-25_17-12-03", "timestamp": 1698250323, "time_this_iter_s": 3.800978899002075, "time_total_s": 14.167782306671143, "pid": 9936, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 14.167782306671143, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 73.0, "ram_util_percent": 27.26}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0003, "total_loss": 8.816782562821, "policy_loss": -0.0003635626010320805, "vf_loss": 8.817188580830893, "vf_explained_var": -8.830317744502314e-08, "kl": 0.0017360496373208388, "entropy": 0.6408324153335007, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 122.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 90000, "num_env_steps_trained": 90000, "num_agent_steps_sampled": 90000, "num_agent_steps_trained": 90000}, "sampler_results": {"episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.028999999999844, "episode_len_mean": 265.42, "episode_media": {}, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 11.099999999999717, 38.50000000000003, 41.500000000000014, 42.900000000000006, 20.899999999999856, -50.00000000000044, 11.699999999999726, -50.00000000000044, 20.899999999999856, 39.300000000000026, 29.69999999999998, 41.500000000000014, -50.00000000000044, 45.1, 32.100000000000016, 3.499999999999609, 3.499999999999609, -50.00000000000044, 26.89999999999994, -50.00000000000044, 8.49999999999968, -50.00000000000044, -50.00000000000044, 29.49999999999998, 33.90000000000004, 19.899999999999842, 45.7, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 21.699999999999868, 37.10000000000003, 44.10000000000001, -50.00000000000044, 26.69999999999994, 35.900000000000034, 38.50000000000003, 30.29999999999999, -50.00000000000044, 14.899999999999771, 44.300000000000004, 33.10000000000003, 24.499999999999908, 43.7, 40.10000000000002, 21.699999999999868, 36.10000000000004, -50.00000000000044, -50.00000000000044, 35.30000000000004, 25.499999999999922, 45.3, 40.10000000000002, 35.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.29999999999999, 46.099999999999994, 23.29999999999989, 42.900000000000006, -50.00000000000044, 42.30000000000001, 46.099999999999994, -50.00000000000044, 40.90000000000002, 38.700000000000024, 34.900000000000034, 46.3, 39.10000000000002, 35.10000000000004, 36.50000000000003, 42.500000000000014, 30.699999999999996, 25.099999999999916, 41.100000000000016, 34.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.500000000000036, 8.299999999999677, 41.500000000000014, 43.50000000000001, 39.50000000000002, 38.300000000000026, 34.70000000000004, 12.899999999999743, -50.00000000000044, -50.00000000000044, 43.50000000000001, 37.50000000000003, 41.100000000000016, -50.00000000000044], "episode_lengths": [144, 500, 500, 500, 390, 116, 86, 72, 292, 500, 384, 500, 292, 108, 204, 86, 500, 50, 180, 466, 466, 500, 232, 500, 416, 500, 500, 206, 162, 302, 44, 66, 500, 500, 500, 500, 284, 130, 60, 500, 234, 142, 116, 198, 500, 352, 58, 170, 256, 64, 100, 284, 140, 500, 500, 148, 246, 48, 100, 148, 500, 500, 500, 198, 40, 268, 72, 500, 78, 40, 500, 92, 114, 152, 38, 110, 150, 136, 76, 194, 250, 90, 154, 500, 500, 500, 146, 418, 86, 66, 106, 118, 154, 372, 500, 500, 66, 126, 90, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4296153576676866, "mean_inference_ms": 1.3896969557107652, "mean_action_processing_ms": 0.1621467909219076, "mean_env_wait_ms": 0.09688249656903132, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02853107452392578, "StateBufferConnector_ms": 0.005999088287353516, "ViewRequirementAgentConnector_ms": 0.14698576927185059}}, "episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.028999999999844, "episode_len_mean": 265.42, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [35.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 11.099999999999717, 38.50000000000003, 41.500000000000014, 42.900000000000006, 20.899999999999856, -50.00000000000044, 11.699999999999726, -50.00000000000044, 20.899999999999856, 39.300000000000026, 29.69999999999998, 41.500000000000014, -50.00000000000044, 45.1, 32.100000000000016, 3.499999999999609, 3.499999999999609, -50.00000000000044, 26.89999999999994, -50.00000000000044, 8.49999999999968, -50.00000000000044, -50.00000000000044, 29.49999999999998, 33.90000000000004, 19.899999999999842, 45.7, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 21.699999999999868, 37.10000000000003, 44.10000000000001, -50.00000000000044, 26.69999999999994, 35.900000000000034, 38.50000000000003, 30.29999999999999, -50.00000000000044, 14.899999999999771, 44.300000000000004, 33.10000000000003, 24.499999999999908, 43.7, 40.10000000000002, 21.699999999999868, 36.10000000000004, -50.00000000000044, -50.00000000000044, 35.30000000000004, 25.499999999999922, 45.3, 40.10000000000002, 35.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.29999999999999, 46.099999999999994, 23.29999999999989, 42.900000000000006, -50.00000000000044, 42.30000000000001, 46.099999999999994, -50.00000000000044, 40.90000000000002, 38.700000000000024, 34.900000000000034, 46.3, 39.10000000000002, 35.10000000000004, 36.50000000000003, 42.500000000000014, 30.699999999999996, 25.099999999999916, 41.100000000000016, 34.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.500000000000036, 8.299999999999677, 41.500000000000014, 43.50000000000001, 39.50000000000002, 38.300000000000026, 34.70000000000004, 12.899999999999743, -50.00000000000044, -50.00000000000044, 43.50000000000001, 37.50000000000003, 41.100000000000016, -50.00000000000044], "episode_lengths": [144, 500, 500, 500, 390, 116, 86, 72, 292, 500, 384, 500, 292, 108, 204, 86, 500, 50, 180, 466, 466, 500, 232, 500, 416, 500, 500, 206, 162, 302, 44, 66, 500, 500, 500, 500, 284, 130, 60, 500, 234, 142, 116, 198, 500, 352, 58, 170, 256, 64, 100, 284, 140, 500, 500, 148, 246, 48, 100, 148, 500, 500, 500, 198, 40, 268, 72, 500, 78, 40, 500, 92, 114, 152, 38, 110, 150, 136, 76, 194, 250, 90, 154, 500, 500, 500, 146, 418, 86, 66, 106, 118, 154, 372, 500, 500, 66, 126, 90, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4296153576676866, "mean_inference_ms": 1.3896969557107652, "mean_action_processing_ms": 0.1621467909219076, "mean_env_wait_ms": 0.09688249656903132, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02853107452392578, "StateBufferConnector_ms": 0.005999088287353516, "ViewRequirementAgentConnector_ms": 0.14698576927185059}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 90000, "num_agent_steps_trained": 90000, "num_env_steps_sampled": 90000, "num_env_steps_trained": 90000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4915.116481419163, "num_env_steps_trained_throughput_per_sec": 4915.116481419163, "timesteps_total": 90000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 90000, "timers": {"training_iteration_time_ms": 3561.6, "sample_time_ms": 3233.007, "load_time_ms": 14.068, "load_throughput": 1279488.052, "learn_time_ms": 301.516, "learn_throughput": 59698.379, "synch_weights_time_ms": 10.61}, "counters": {"num_env_steps_sampled": 90000, "num_env_steps_trained": 90000, "num_agent_steps_sampled": 90000, "num_agent_steps_trained": 90000}, "done": false, "episodes_total": 266, "training_iteration": 5, "trial_id": "9f288_00020", "date": "2023-10-25_17-12-06", "timestamp": 1698250326, "time_this_iter_s": 3.668185234069824, "time_total_s": 17.835967540740967, "pid": 9936, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 17.835967540740967, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 67.78333333333333, "ram_util_percent": 27.26666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.006250000000000001, "cur_lr": 0.0003, "total_loss": 8.451976599516692, "policy_loss": -0.0006138428493782326, "vf_loss": 8.452641822673657, "vf_explained_var": -1.1545640450936777e-06, "kl": 0.0016316679047021251, "entropy": 0.6159693598747253, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 149.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.56499999999986, "episode_len_mean": 240.06, "episode_media": {}, "episodes_this_iter": 80, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [25.099999999999916, 41.100000000000016, 34.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.500000000000036, 8.299999999999677, 41.500000000000014, 43.50000000000001, 39.50000000000002, 38.300000000000026, 34.70000000000004, 12.899999999999743, -50.00000000000044, -50.00000000000044, 43.50000000000001, 37.50000000000003, 41.100000000000016, -50.00000000000044, 29.099999999999973, 28.499999999999964, -50.00000000000044, 30.9, -50.00000000000044, 31.900000000000013, 19.899999999999842, 37.90000000000003, -50.00000000000044, 39.50000000000002, 34.900000000000034, -50.00000000000044, -50.00000000000044, 35.10000000000004, 43.50000000000001, -50.00000000000044, 41.100000000000016, 42.500000000000014, 37.10000000000003, 28.29999999999996, -50.00000000000044, 40.90000000000002, 47.5, 35.500000000000036, 42.500000000000014, 47.1, -50.00000000000044, 38.10000000000002, 39.70000000000002, 45.3, 41.500000000000014, 35.30000000000004, 5.099999999999632, 45.9, -50.00000000000044, 44.7, -50.00000000000044, 47.3, 21.499999999999865, 44.900000000000006, 40.500000000000014, 46.099999999999994, -50.00000000000044, -50.00000000000044, 42.10000000000001, 42.70000000000001, 44.5, 41.70000000000002, 44.7, 40.70000000000002, 33.70000000000004, 41.30000000000001, 31.1, 37.90000000000003, -50.00000000000044, 3.499999999999609, 39.70000000000002, 44.900000000000006, 44.900000000000006, 43.900000000000006, -50.00000000000044, 42.500000000000014, -50.00000000000044, 37.10000000000003, -50.00000000000044, 42.900000000000006, 21.299999999999862, 35.900000000000034, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 34.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, 23.29999999999989, 44.300000000000004], "episode_lengths": [250, 90, 154, 500, 500, 500, 146, 418, 86, 66, 106, 118, 154, 372, 500, 500, 66, 126, 90, 500, 210, 216, 500, 192, 500, 182, 302, 122, 500, 106, 152, 500, 500, 150, 66, 500, 90, 76, 130, 218, 500, 92, 26, 146, 76, 30, 500, 120, 104, 48, 86, 148, 450, 42, 500, 54, 500, 28, 286, 52, 96, 40, 500, 500, 80, 74, 56, 84, 54, 94, 164, 88, 190, 122, 500, 466, 104, 52, 52, 62, 500, 76, 500, 130, 500, 72, 288, 142, 500, 80, 500, 500, 158, 500, 500, 500, 500, 114, 268, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43382179836206397, "mean_inference_ms": 1.3910204973371367, "mean_action_processing_ms": 0.1634462338963566, "mean_env_wait_ms": 0.09690414327382933, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.038997650146484375, "StateBufferConnector_ms": 0.007000923156738281, "ViewRequirementAgentConnector_ms": 0.14076590538024902}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.56499999999986, "episode_len_mean": 240.06, "episodes_this_iter": 80, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [25.099999999999916, 41.100000000000016, 34.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.500000000000036, 8.299999999999677, 41.500000000000014, 43.50000000000001, 39.50000000000002, 38.300000000000026, 34.70000000000004, 12.899999999999743, -50.00000000000044, -50.00000000000044, 43.50000000000001, 37.50000000000003, 41.100000000000016, -50.00000000000044, 29.099999999999973, 28.499999999999964, -50.00000000000044, 30.9, -50.00000000000044, 31.900000000000013, 19.899999999999842, 37.90000000000003, -50.00000000000044, 39.50000000000002, 34.900000000000034, -50.00000000000044, -50.00000000000044, 35.10000000000004, 43.50000000000001, -50.00000000000044, 41.100000000000016, 42.500000000000014, 37.10000000000003, 28.29999999999996, -50.00000000000044, 40.90000000000002, 47.5, 35.500000000000036, 42.500000000000014, 47.1, -50.00000000000044, 38.10000000000002, 39.70000000000002, 45.3, 41.500000000000014, 35.30000000000004, 5.099999999999632, 45.9, -50.00000000000044, 44.7, -50.00000000000044, 47.3, 21.499999999999865, 44.900000000000006, 40.500000000000014, 46.099999999999994, -50.00000000000044, -50.00000000000044, 42.10000000000001, 42.70000000000001, 44.5, 41.70000000000002, 44.7, 40.70000000000002, 33.70000000000004, 41.30000000000001, 31.1, 37.90000000000003, -50.00000000000044, 3.499999999999609, 39.70000000000002, 44.900000000000006, 44.900000000000006, 43.900000000000006, -50.00000000000044, 42.500000000000014, -50.00000000000044, 37.10000000000003, -50.00000000000044, 42.900000000000006, 21.299999999999862, 35.900000000000034, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 34.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, 23.29999999999989, 44.300000000000004], "episode_lengths": [250, 90, 154, 500, 500, 500, 146, 418, 86, 66, 106, 118, 154, 372, 500, 500, 66, 126, 90, 500, 210, 216, 500, 192, 500, 182, 302, 122, 500, 106, 152, 500, 500, 150, 66, 500, 90, 76, 130, 218, 500, 92, 26, 146, 76, 30, 500, 120, 104, 48, 86, 148, 450, 42, 500, 54, 500, 28, 286, 52, 96, 40, 500, 500, 80, 74, 56, 84, 54, 94, 164, 88, 190, 122, 500, 466, 104, 52, 52, 62, 500, 76, 500, 130, 500, 72, 288, 142, 500, 80, 500, 500, 158, 500, 500, 500, 500, 114, 268, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43382179836206397, "mean_inference_ms": 1.3910204973371367, "mean_action_processing_ms": 0.1634462338963566, "mean_env_wait_ms": 0.09690414327382933, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.038997650146484375, "StateBufferConnector_ms": 0.007000923156738281, "ViewRequirementAgentConnector_ms": 0.14076590538024902}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4897.506482439873, "num_env_steps_trained_throughput_per_sec": 4897.506482439873, "timesteps_total": 108000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 3580.557, "sample_time_ms": 3241.923, "load_time_ms": 14.579, "load_throughput": 1234671.253, "learn_time_ms": 311.035, "learn_throughput": 57871.235, "synch_weights_time_ms": 10.509}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "done": false, "episodes_total": 346, "training_iteration": 6, "trial_id": "9f288_00020", "date": "2023-10-25_17-12-10", "timestamp": 1698250330, "time_this_iter_s": 3.6813361644744873, "time_total_s": 21.517303705215454, "pid": 9936, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 21.517303705215454, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 71.68, "ram_util_percent": 27.240000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0031250000000000006, "cur_lr": 0.0003, "total_loss": 7.651889624419035, "policy_loss": -0.00019707365168465508, "vf_loss": 7.652140652691877, "vf_explained_var": -6.335752981680411e-07, "kl": 0.0013322986511260144, "entropy": 0.5811061859130859, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 176.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 126000, "num_env_steps_trained": 126000, "num_agent_steps_sampled": 126000, "num_agent_steps_trained": 126000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.840999999999837, "episode_len_mean": 257.26, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [33.70000000000004, 41.30000000000001, 31.1, 37.90000000000003, -50.00000000000044, 3.499999999999609, 39.70000000000002, 44.900000000000006, 44.900000000000006, 43.900000000000006, -50.00000000000044, 42.500000000000014, -50.00000000000044, 37.10000000000003, -50.00000000000044, 42.900000000000006, 21.299999999999862, 35.900000000000034, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 34.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, 23.29999999999989, 44.300000000000004, 6.8999999999996575, 36.70000000000003, 28.09999999999996, -50.00000000000044, 40.500000000000014, 38.700000000000024, 45.9, -50.00000000000044, 41.500000000000014, 46.9, 35.70000000000003, -50.00000000000044, 43.10000000000001, -50.00000000000044, 46.3, 43.900000000000006, -50.00000000000044, -50.00000000000044, 46.099999999999994, 45.5, 37.70000000000003, 40.30000000000002, 28.699999999999967, 42.10000000000001, 12.899999999999743, 43.900000000000006, -50.00000000000044, -50.00000000000044, 36.30000000000003, 6.499999999999652, -50.00000000000044, -50.00000000000044, 42.70000000000001, 42.900000000000006, 43.50000000000001, 34.30000000000004, 38.50000000000003, 45.5, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.50000000000004, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.30000000000002, -50.00000000000044, 7.499999999999666, 31.500000000000007, 31.900000000000013, -50.00000000000044, 44.900000000000006, -50.00000000000044, 45.1, -50.00000000000044, 46.9, 44.5, 45.5, 26.69999999999994, 43.50000000000001, 25.699999999999925, 39.300000000000026, 1.8999999999995865, 39.70000000000002, 44.7, 39.10000000000002, -50.00000000000044, -50.00000000000044], "episode_lengths": [164, 88, 190, 122, 500, 466, 104, 52, 52, 62, 500, 76, 500, 130, 500, 72, 288, 142, 500, 80, 500, 500, 158, 500, 500, 500, 500, 114, 268, 58, 432, 134, 220, 500, 96, 114, 42, 500, 86, 32, 144, 500, 70, 500, 38, 62, 500, 500, 40, 46, 124, 98, 214, 80, 372, 62, 500, 500, 138, 436, 500, 500, 74, 72, 66, 158, 116, 46, 110, 500, 500, 500, 156, 52, 500, 500, 500, 178, 500, 426, 186, 182, 500, 52, 500, 50, 500, 32, 56, 46, 234, 66, 244, 108, 482, 104, 54, 110, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4330945787598601, "mean_inference_ms": 1.3926235696531575, "mean_action_processing_ms": 0.16255934089460966, "mean_env_wait_ms": 0.09727805819425284, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025412797927856445, "StateBufferConnector_ms": 0.006999969482421875, "ViewRequirementAgentConnector_ms": 0.12671566009521484}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.840999999999837, "episode_len_mean": 257.26, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [33.70000000000004, 41.30000000000001, 31.1, 37.90000000000003, -50.00000000000044, 3.499999999999609, 39.70000000000002, 44.900000000000006, 44.900000000000006, 43.900000000000006, -50.00000000000044, 42.500000000000014, -50.00000000000044, 37.10000000000003, -50.00000000000044, 42.900000000000006, 21.299999999999862, 35.900000000000034, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 34.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, 23.29999999999989, 44.300000000000004, 6.8999999999996575, 36.70000000000003, 28.09999999999996, -50.00000000000044, 40.500000000000014, 38.700000000000024, 45.9, -50.00000000000044, 41.500000000000014, 46.9, 35.70000000000003, -50.00000000000044, 43.10000000000001, -50.00000000000044, 46.3, 43.900000000000006, -50.00000000000044, -50.00000000000044, 46.099999999999994, 45.5, 37.70000000000003, 40.30000000000002, 28.699999999999967, 42.10000000000001, 12.899999999999743, 43.900000000000006, -50.00000000000044, -50.00000000000044, 36.30000000000003, 6.499999999999652, -50.00000000000044, -50.00000000000044, 42.70000000000001, 42.900000000000006, 43.50000000000001, 34.30000000000004, 38.50000000000003, 45.5, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.50000000000004, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.30000000000002, -50.00000000000044, 7.499999999999666, 31.500000000000007, 31.900000000000013, -50.00000000000044, 44.900000000000006, -50.00000000000044, 45.1, -50.00000000000044, 46.9, 44.5, 45.5, 26.69999999999994, 43.50000000000001, 25.699999999999925, 39.300000000000026, 1.8999999999995865, 39.70000000000002, 44.7, 39.10000000000002, -50.00000000000044, -50.00000000000044], "episode_lengths": [164, 88, 190, 122, 500, 466, 104, 52, 52, 62, 500, 76, 500, 130, 500, 72, 288, 142, 500, 80, 500, 500, 158, 500, 500, 500, 500, 114, 268, 58, 432, 134, 220, 500, 96, 114, 42, 500, 86, 32, 144, 500, 70, 500, 38, 62, 500, 500, 40, 46, 124, 98, 214, 80, 372, 62, 500, 500, 138, 436, 500, 500, 74, 72, 66, 158, 116, 46, 110, 500, 500, 500, 156, 52, 500, 500, 500, 178, 500, 426, 186, 182, 500, 52, 500, 50, 500, 32, 56, 46, 234, 66, 244, 108, 482, 104, 54, 110, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4330945787598601, "mean_inference_ms": 1.3926235696531575, "mean_action_processing_ms": 0.16255934089460966, "mean_env_wait_ms": 0.09727805819425284, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025412797927856445, "StateBufferConnector_ms": 0.006999969482421875, "ViewRequirementAgentConnector_ms": 0.12671566009521484}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 126000, "num_agent_steps_trained": 126000, "num_env_steps_sampled": 126000, "num_env_steps_trained": 126000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5028.004726349505, "num_env_steps_trained_throughput_per_sec": 5028.004726349505, "timesteps_total": 126000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 126000, "timers": {"training_iteration_time_ms": 3580.47, "sample_time_ms": 3236.216, "load_time_ms": 18.353, "load_throughput": 980745.027, "learn_time_ms": 312.99, "learn_throughput": 57509.859, "synch_weights_time_ms": 10.408}, "counters": {"num_env_steps_sampled": 126000, "num_env_steps_trained": 126000, "num_agent_steps_sampled": 126000, "num_agent_steps_trained": 126000}, "done": false, "episodes_total": 416, "training_iteration": 7, "trial_id": "9f288_00020", "date": "2023-10-25_17-12-14", "timestamp": 1698250334, "time_this_iter_s": 3.58591365814209, "time_total_s": 25.103217363357544, "pid": 9936, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 25.103217363357544, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 68.7, "ram_util_percent": 27.22}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0015625000000000003, "cur_lr": 0.0003, "total_loss": 6.733228259616428, "policy_loss": -0.0008032788970956096, "vf_loss": 6.73408246923376, "vf_explained_var": 9.492591575339988e-07, "kl": 0.0015914087756732662, "entropy": 0.5342592707386723, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 203.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.268999999999831, "episode_len_mean": 252.96, "episode_media": {}, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 32.30000000000002, -50.00000000000044, 7.499999999999666, 31.500000000000007, 31.900000000000013, -50.00000000000044, 44.900000000000006, -50.00000000000044, 45.1, -50.00000000000044, 46.9, 44.5, 45.5, 26.69999999999994, 43.50000000000001, 25.699999999999925, 39.300000000000026, 1.8999999999995865, 39.70000000000002, 44.7, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 45.1, -50.00000000000044, 41.500000000000014, 44.7, 23.099999999999888, 27.099999999999945, 42.30000000000001, 43.7, 46.5, -50.00000000000044, 41.500000000000014, -50.00000000000044, 31.300000000000004, 20.699999999999854, 43.30000000000001, 46.5, 43.50000000000001, -50.00000000000044, -50.00000000000044, 42.30000000000001, 11.099999999999717, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, 31.500000000000007, -50.00000000000044, 45.1, 44.5, 45.1, 45.1, 40.70000000000002, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 45.3, 36.900000000000034, 44.10000000000001, 42.30000000000001, -50.00000000000044, 38.50000000000003, 40.30000000000002, 44.7, 19.899999999999842, 43.50000000000001, 45.5, 43.30000000000001, -50.00000000000044, -50.00000000000044, 46.3, 43.50000000000001, -50.00000000000044, 41.90000000000001, 33.30000000000003, 36.10000000000004, -50.00000000000044, 16.09999999999979, 42.30000000000001, 37.300000000000026, -50.00000000000044, 42.10000000000001, 42.10000000000001, -50.00000000000044, -50.00000000000044, 39.300000000000026, -50.00000000000044], "episode_lengths": [500, 500, 178, 500, 426, 186, 182, 500, 52, 500, 50, 500, 32, 56, 46, 234, 66, 244, 108, 482, 104, 54, 110, 500, 500, 500, 500, 44, 500, 500, 500, 500, 72, 50, 500, 86, 54, 270, 230, 78, 64, 36, 500, 86, 500, 188, 294, 68, 36, 66, 500, 500, 78, 390, 500, 500, 88, 500, 186, 500, 50, 56, 50, 50, 94, 500, 46, 500, 500, 48, 132, 60, 78, 500, 116, 98, 54, 302, 66, 46, 68, 500, 500, 38, 66, 500, 82, 168, 140, 500, 340, 78, 128, 500, 80, 80, 500, 500, 108, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4318507657629651, "mean_inference_ms": 1.388649219702416, "mean_action_processing_ms": 0.1625351044928323, "mean_env_wait_ms": 0.09786478870912894, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030017375946044922, "StateBufferConnector_ms": 0.009004354476928711, "ViewRequirementAgentConnector_ms": 0.14204716682434082}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.268999999999831, "episode_len_mean": 252.96, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 32.30000000000002, -50.00000000000044, 7.499999999999666, 31.500000000000007, 31.900000000000013, -50.00000000000044, 44.900000000000006, -50.00000000000044, 45.1, -50.00000000000044, 46.9, 44.5, 45.5, 26.69999999999994, 43.50000000000001, 25.699999999999925, 39.300000000000026, 1.8999999999995865, 39.70000000000002, 44.7, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 45.1, -50.00000000000044, 41.500000000000014, 44.7, 23.099999999999888, 27.099999999999945, 42.30000000000001, 43.7, 46.5, -50.00000000000044, 41.500000000000014, -50.00000000000044, 31.300000000000004, 20.699999999999854, 43.30000000000001, 46.5, 43.50000000000001, -50.00000000000044, -50.00000000000044, 42.30000000000001, 11.099999999999717, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, 31.500000000000007, -50.00000000000044, 45.1, 44.5, 45.1, 45.1, 40.70000000000002, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 45.3, 36.900000000000034, 44.10000000000001, 42.30000000000001, -50.00000000000044, 38.50000000000003, 40.30000000000002, 44.7, 19.899999999999842, 43.50000000000001, 45.5, 43.30000000000001, -50.00000000000044, -50.00000000000044, 46.3, 43.50000000000001, -50.00000000000044, 41.90000000000001, 33.30000000000003, 36.10000000000004, -50.00000000000044, 16.09999999999979, 42.30000000000001, 37.300000000000026, -50.00000000000044, 42.10000000000001, 42.10000000000001, -50.00000000000044, -50.00000000000044, 39.300000000000026, -50.00000000000044], "episode_lengths": [500, 500, 178, 500, 426, 186, 182, 500, 52, 500, 50, 500, 32, 56, 46, 234, 66, 244, 108, 482, 104, 54, 110, 500, 500, 500, 500, 44, 500, 500, 500, 500, 72, 50, 500, 86, 54, 270, 230, 78, 64, 36, 500, 86, 500, 188, 294, 68, 36, 66, 500, 500, 78, 390, 500, 500, 88, 500, 186, 500, 50, 56, 50, 50, 94, 500, 46, 500, 500, 48, 132, 60, 78, 500, 116, 98, 54, 302, 66, 46, 68, 500, 500, 38, 66, 500, 82, 168, 140, 500, 340, 78, 128, 500, 80, 80, 500, 500, 108, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4318507657629651, "mean_inference_ms": 1.388649219702416, "mean_action_processing_ms": 0.1625351044928323, "mean_env_wait_ms": 0.09786478870912894, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030017375946044922, "StateBufferConnector_ms": 0.009004354476928711, "ViewRequirementAgentConnector_ms": 0.14204716682434082}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5086.961794896535, "num_env_steps_trained_throughput_per_sec": 5086.961794896535, "timesteps_total": 144000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 3575.218, "sample_time_ms": 3229.074, "load_time_ms": 18.065, "load_throughput": 996404.864, "learn_time_ms": 315.294, "learn_throughput": 57089.66, "synch_weights_time_ms": 10.346}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "episodes_total": 491, "training_iteration": 8, "trial_id": "9f288_00020", "date": "2023-10-25_17-12-17", "timestamp": 1698250337, "time_this_iter_s": 3.544372797012329, "time_total_s": 28.647590160369873, "pid": 9936, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 28.647590160369873, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 67.38000000000001, "ram_util_percent": 27.22}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0007812500000000002, "cur_lr": 0.0003, "total_loss": 7.204310611442283, "policy_loss": -0.000616237227977426, "vf_loss": 7.204981433020698, "vf_explained_var": -1.6799679508915655e-06, "kl": 0.0013365861964387106, "entropy": 0.5559405574092159, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 230.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 162000, "num_env_steps_trained": 162000, "num_agent_steps_sampled": 162000, "num_agent_steps_trained": 162000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.40399999999986, "episode_len_mean": 236.68, "episode_media": {}, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [38.50000000000003, 40.30000000000002, 44.7, 19.899999999999842, 43.50000000000001, 45.5, 43.30000000000001, -50.00000000000044, -50.00000000000044, 46.3, 43.50000000000001, -50.00000000000044, 41.90000000000001, 33.30000000000003, 36.10000000000004, -50.00000000000044, 16.09999999999979, 42.30000000000001, 37.300000000000026, -50.00000000000044, 42.10000000000001, 42.10000000000001, -50.00000000000044, -50.00000000000044, 39.300000000000026, -50.00000000000044, -50.00000000000044, 40.90000000000002, 29.299999999999976, -50.00000000000044, 44.10000000000001, 43.900000000000006, 41.500000000000014, 2.699999999999598, -50.00000000000044, 37.90000000000003, 45.5, 42.10000000000001, 6.8999999999996575, -50.00000000000044, 26.09999999999993, -50.00000000000044, 42.70000000000001, 44.300000000000004, -50.00000000000044, 33.90000000000004, 42.70000000000001, -50.00000000000044, 19.69999999999984, -50.00000000000044, 34.10000000000004, 46.3, 35.500000000000036, 40.10000000000002, 38.10000000000002, 32.90000000000003, 26.299999999999933, 6.699999999999655, -50.00000000000044, 44.5, 42.10000000000001, 39.10000000000002, 33.500000000000036, 42.10000000000001, -50.00000000000044, 41.30000000000001, -50.00000000000044, 40.90000000000002, -50.00000000000044, 45.3, -50.00000000000044, 30.9, -50.00000000000044, 37.50000000000003, -50.00000000000044, 44.10000000000001, 35.70000000000003, 44.300000000000004, 40.500000000000014, -50.00000000000044, 40.10000000000002, 46.699999999999996, 47.3, 34.10000000000004, -50.00000000000044, 13.499999999999751, 43.10000000000001, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 10.099999999999703, 43.50000000000001, 36.30000000000003, 41.100000000000016, 41.90000000000001, 42.500000000000014, 42.500000000000014, 10.899999999999714], "episode_lengths": [116, 98, 54, 302, 66, 46, 68, 500, 500, 38, 66, 500, 82, 168, 140, 500, 340, 78, 128, 500, 80, 80, 500, 500, 108, 500, 500, 92, 208, 500, 60, 62, 86, 474, 500, 122, 46, 80, 432, 500, 240, 500, 74, 58, 500, 162, 74, 500, 304, 500, 160, 38, 146, 100, 120, 172, 238, 434, 500, 56, 80, 110, 166, 80, 500, 88, 500, 92, 500, 48, 500, 192, 500, 126, 500, 60, 144, 58, 96, 500, 100, 34, 28, 160, 500, 366, 70, 76, 500, 500, 500, 78, 400, 66, 138, 90, 82, 76, 76, 392]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4308607303679668, "mean_inference_ms": 1.3868355628166875, "mean_action_processing_ms": 0.16223269297779785, "mean_env_wait_ms": 0.09801379097172419, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029001951217651367, "StateBufferConnector_ms": 0.00500035285949707, "ViewRequirementAgentConnector_ms": 0.12190365791320801}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.40399999999986, "episode_len_mean": 236.68, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [38.50000000000003, 40.30000000000002, 44.7, 19.899999999999842, 43.50000000000001, 45.5, 43.30000000000001, -50.00000000000044, -50.00000000000044, 46.3, 43.50000000000001, -50.00000000000044, 41.90000000000001, 33.30000000000003, 36.10000000000004, -50.00000000000044, 16.09999999999979, 42.30000000000001, 37.300000000000026, -50.00000000000044, 42.10000000000001, 42.10000000000001, -50.00000000000044, -50.00000000000044, 39.300000000000026, -50.00000000000044, -50.00000000000044, 40.90000000000002, 29.299999999999976, -50.00000000000044, 44.10000000000001, 43.900000000000006, 41.500000000000014, 2.699999999999598, -50.00000000000044, 37.90000000000003, 45.5, 42.10000000000001, 6.8999999999996575, -50.00000000000044, 26.09999999999993, -50.00000000000044, 42.70000000000001, 44.300000000000004, -50.00000000000044, 33.90000000000004, 42.70000000000001, -50.00000000000044, 19.69999999999984, -50.00000000000044, 34.10000000000004, 46.3, 35.500000000000036, 40.10000000000002, 38.10000000000002, 32.90000000000003, 26.299999999999933, 6.699999999999655, -50.00000000000044, 44.5, 42.10000000000001, 39.10000000000002, 33.500000000000036, 42.10000000000001, -50.00000000000044, 41.30000000000001, -50.00000000000044, 40.90000000000002, -50.00000000000044, 45.3, -50.00000000000044, 30.9, -50.00000000000044, 37.50000000000003, -50.00000000000044, 44.10000000000001, 35.70000000000003, 44.300000000000004, 40.500000000000014, -50.00000000000044, 40.10000000000002, 46.699999999999996, 47.3, 34.10000000000004, -50.00000000000044, 13.499999999999751, 43.10000000000001, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 10.099999999999703, 43.50000000000001, 36.30000000000003, 41.100000000000016, 41.90000000000001, 42.500000000000014, 42.500000000000014, 10.899999999999714], "episode_lengths": [116, 98, 54, 302, 66, 46, 68, 500, 500, 38, 66, 500, 82, 168, 140, 500, 340, 78, 128, 500, 80, 80, 500, 500, 108, 500, 500, 92, 208, 500, 60, 62, 86, 474, 500, 122, 46, 80, 432, 500, 240, 500, 74, 58, 500, 162, 74, 500, 304, 500, 160, 38, 146, 100, 120, 172, 238, 434, 500, 56, 80, 110, 166, 80, 500, 88, 500, 92, 500, 48, 500, 192, 500, 126, 500, 60, 144, 58, 96, 500, 100, 34, 28, 160, 500, 366, 70, 76, 500, 500, 500, 78, 400, 66, 138, 90, 82, 76, 76, 392]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4308607303679668, "mean_inference_ms": 1.3868355628166875, "mean_action_processing_ms": 0.16223269297779785, "mean_env_wait_ms": 0.09801379097172419, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029001951217651367, "StateBufferConnector_ms": 0.00500035285949707, "ViewRequirementAgentConnector_ms": 0.12190365791320801}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 162000, "num_agent_steps_trained": 162000, "num_env_steps_sampled": 162000, "num_env_steps_trained": 162000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4996.24951086403, "num_env_steps_trained_throughput_per_sec": 4996.24951086403, "timesteps_total": 162000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 162000, "timers": {"training_iteration_time_ms": 3578.272, "sample_time_ms": 3227.531, "load_time_ms": 17.724, "load_throughput": 1015557.833, "learn_time_ms": 320.316, "learn_throughput": 56194.448, "synch_weights_time_ms": 10.309}, "counters": {"num_env_steps_sampled": 162000, "num_env_steps_trained": 162000, "num_agent_steps_sampled": 162000, "num_agent_steps_trained": 162000}, "done": false, "episodes_total": 565, "training_iteration": 9, "trial_id": "9f288_00020", "date": "2023-10-25_17-12-21", "timestamp": 1698250341, "time_this_iter_s": 3.6096982955932617, "time_total_s": 32.257288455963135, "pid": 9936, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 32.257288455963135, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 68.38000000000001, "ram_util_percent": 27.22}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0003906250000000001, "cur_lr": 0.0003, "total_loss": 6.622960090637207, "policy_loss": -0.00015035133670877527, "vf_loss": 6.623163046660246, "vf_explained_var": 8.234271296748409e-07, "kl": 0.0008426204153482905, "entropy": 0.5285481004803269, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 257.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.159999999999856, "episode_len_mean": 229.1, "episode_media": {}, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.10000000000001, 35.70000000000003, 44.300000000000004, 40.500000000000014, -50.00000000000044, 40.10000000000002, 46.699999999999996, 47.3, 34.10000000000004, -50.00000000000044, 13.499999999999751, 43.10000000000001, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 10.099999999999703, 43.50000000000001, 36.30000000000003, 41.100000000000016, 41.90000000000001, 42.500000000000014, 42.500000000000014, 10.899999999999714, -50.00000000000044, -50.00000000000044, 13.699999999999754, 45.1, 41.70000000000002, -50.00000000000044, 40.30000000000002, 29.49999999999998, 44.10000000000001, 34.10000000000004, 47.1, 29.099999999999973, 15.699999999999783, -50.00000000000044, -50.00000000000044, 38.90000000000002, 43.10000000000001, 39.10000000000002, 44.7, 46.3, 42.10000000000001, -50.00000000000044, 44.10000000000001, -50.00000000000044, 46.099999999999994, 43.7, -50.00000000000044, 45.5, -50.00000000000044, 36.50000000000003, 47.3, 35.30000000000004, 37.10000000000003, 45.5, 34.900000000000034, 41.90000000000001, -50.00000000000044, 33.10000000000003, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 25.29999999999992, 45.9, 37.90000000000003, 47.5, 26.299999999999933, 40.30000000000002, 44.300000000000004, -50.00000000000044, -50.00000000000044, 33.30000000000003, 46.9, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 42.500000000000014, 43.30000000000001, 45.1, 12.499999999999737, 43.7, -50.00000000000044, 43.7, 43.900000000000006, 45.9, 45.7, 33.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [60, 144, 58, 96, 500, 100, 34, 28, 160, 500, 366, 70, 76, 500, 500, 500, 78, 400, 66, 138, 90, 82, 76, 76, 392, 500, 500, 364, 50, 84, 500, 98, 206, 60, 160, 30, 210, 344, 500, 500, 112, 70, 110, 54, 38, 80, 500, 60, 500, 40, 64, 500, 46, 500, 136, 28, 148, 130, 46, 152, 82, 500, 170, 42, 500, 500, 500, 34, 248, 42, 122, 26, 238, 98, 58, 500, 500, 168, 32, 500, 500, 30, 500, 500, 76, 68, 50, 376, 64, 500, 64, 62, 42, 44, 164, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43085130576354636, "mean_inference_ms": 1.3874329652300168, "mean_action_processing_ms": 0.16233190512391016, "mean_env_wait_ms": 0.09859315348600013, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031993865966796875, "StateBufferConnector_ms": 0.003996849060058594, "ViewRequirementAgentConnector_ms": 0.13833022117614746}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.159999999999856, "episode_len_mean": 229.1, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.10000000000001, 35.70000000000003, 44.300000000000004, 40.500000000000014, -50.00000000000044, 40.10000000000002, 46.699999999999996, 47.3, 34.10000000000004, -50.00000000000044, 13.499999999999751, 43.10000000000001, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 10.099999999999703, 43.50000000000001, 36.30000000000003, 41.100000000000016, 41.90000000000001, 42.500000000000014, 42.500000000000014, 10.899999999999714, -50.00000000000044, -50.00000000000044, 13.699999999999754, 45.1, 41.70000000000002, -50.00000000000044, 40.30000000000002, 29.49999999999998, 44.10000000000001, 34.10000000000004, 47.1, 29.099999999999973, 15.699999999999783, -50.00000000000044, -50.00000000000044, 38.90000000000002, 43.10000000000001, 39.10000000000002, 44.7, 46.3, 42.10000000000001, -50.00000000000044, 44.10000000000001, -50.00000000000044, 46.099999999999994, 43.7, -50.00000000000044, 45.5, -50.00000000000044, 36.50000000000003, 47.3, 35.30000000000004, 37.10000000000003, 45.5, 34.900000000000034, 41.90000000000001, -50.00000000000044, 33.10000000000003, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 25.29999999999992, 45.9, 37.90000000000003, 47.5, 26.299999999999933, 40.30000000000002, 44.300000000000004, -50.00000000000044, -50.00000000000044, 33.30000000000003, 46.9, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 42.500000000000014, 43.30000000000001, 45.1, 12.499999999999737, 43.7, -50.00000000000044, 43.7, 43.900000000000006, 45.9, 45.7, 33.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [60, 144, 58, 96, 500, 100, 34, 28, 160, 500, 366, 70, 76, 500, 500, 500, 78, 400, 66, 138, 90, 82, 76, 76, 392, 500, 500, 364, 50, 84, 500, 98, 206, 60, 160, 30, 210, 344, 500, 500, 112, 70, 110, 54, 38, 80, 500, 60, 500, 40, 64, 500, 46, 500, 136, 28, 148, 130, 46, 152, 82, 500, 170, 42, 500, 500, 500, 34, 248, 42, 122, 26, 238, 98, 58, 500, 500, 168, 32, 500, 500, 30, 500, 500, 76, 68, 50, 376, 64, 500, 64, 62, 42, 44, 164, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43085130576354636, "mean_inference_ms": 1.3874329652300168, "mean_action_processing_ms": 0.16233190512391016, "mean_env_wait_ms": 0.09859315348600013, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031993865966796875, "StateBufferConnector_ms": 0.003996849060058594, "ViewRequirementAgentConnector_ms": 0.13833022117614746}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4884.274212982836, "num_env_steps_trained_throughput_per_sec": 4884.274212982836, "timesteps_total": 180000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 180000, "timers": {"training_iteration_time_ms": 3588.974, "sample_time_ms": 3234.188, "load_time_ms": 17.578, "load_throughput": 1024004.167, "learn_time_ms": 324.485, "learn_throughput": 55472.479, "synch_weights_time_ms": 10.279}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "done": false, "episodes_total": 640, "training_iteration": 10, "trial_id": "9f288_00020", "date": "2023-10-25_17-12-24", "timestamp": 1698250344, "time_this_iter_s": 3.692260980606079, "time_total_s": 35.949549436569214, "pid": 9936, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 35.949549436569214, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 71.96000000000001, "ram_util_percent": 27.22}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.00019531250000000004, "cur_lr": 0.0003, "total_loss": 6.377615027957493, "policy_loss": -0.00011170689982396584, "vf_loss": 6.377776410844591, "vf_explained_var": -3.532127097800926e-08, "kl": 0.0007562508192956822, "entropy": 0.49687099015271224, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 284.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 198000, "num_env_steps_trained": 198000, "num_agent_steps_sampled": 198000, "num_agent_steps_trained": 198000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.124999999999822, "episode_len_mean": 254.36, "episode_media": {}, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.699999999999996, 25.29999999999992, 45.9, 37.90000000000003, 47.5, 26.299999999999933, 40.30000000000002, 44.300000000000004, -50.00000000000044, -50.00000000000044, 33.30000000000003, 46.9, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 42.500000000000014, 43.30000000000001, 45.1, 12.499999999999737, 43.7, -50.00000000000044, 43.7, 43.900000000000006, 45.9, 45.7, 33.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 43.7, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002, -50.00000000000044, -50.00000000000044, 44.300000000000004, 41.100000000000016, 43.30000000000001, 46.699999999999996, 33.10000000000003, -50.00000000000044, -50.00000000000044, 25.899999999999928, -50.00000000000044, 45.5, 45.9, 26.299999999999933, 45.9, 45.7, -50.00000000000044, 45.9, 44.5, -50.00000000000044, 46.699999999999996, -50.00000000000044, 47.3, 45.9, 47.3, 29.099999999999973, 39.10000000000002, -50.00000000000044, 46.9, -50.00000000000044, 35.500000000000036, 40.90000000000002, 43.900000000000006, 38.90000000000002, 44.5, 45.1, -50.00000000000044, 21.299999999999862, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 38.50000000000003, 45.7, -50.00000000000044, -50.00000000000044, 35.900000000000034, 38.300000000000026, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 40.500000000000014, 11.899999999999729], "episode_lengths": [34, 248, 42, 122, 26, 238, 98, 58, 500, 500, 168, 32, 500, 500, 30, 500, 500, 76, 68, 50, 376, 64, 500, 64, 62, 42, 44, 164, 500, 500, 500, 500, 500, 500, 500, 500, 38, 64, 76, 500, 500, 500, 106, 500, 500, 58, 90, 68, 34, 170, 500, 500, 242, 500, 46, 42, 238, 42, 44, 500, 42, 56, 500, 34, 500, 28, 42, 28, 210, 110, 500, 32, 500, 146, 92, 62, 112, 56, 50, 500, 288, 500, 500, 500, 56, 116, 44, 500, 500, 142, 118, 500, 88, 500, 500, 500, 500, 42, 96, 382]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4296969930864759, "mean_inference_ms": 1.3886070928067484, "mean_action_processing_ms": 0.1618737785113132, "mean_env_wait_ms": 0.09909828759944166, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03400611877441406, "StateBufferConnector_ms": 0.003998279571533203, "ViewRequirementAgentConnector_ms": 0.134552001953125}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.124999999999822, "episode_len_mean": 254.36, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.699999999999996, 25.29999999999992, 45.9, 37.90000000000003, 47.5, 26.299999999999933, 40.30000000000002, 44.300000000000004, -50.00000000000044, -50.00000000000044, 33.30000000000003, 46.9, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 42.500000000000014, 43.30000000000001, 45.1, 12.499999999999737, 43.7, -50.00000000000044, 43.7, 43.900000000000006, 45.9, 45.7, 33.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 43.7, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002, -50.00000000000044, -50.00000000000044, 44.300000000000004, 41.100000000000016, 43.30000000000001, 46.699999999999996, 33.10000000000003, -50.00000000000044, -50.00000000000044, 25.899999999999928, -50.00000000000044, 45.5, 45.9, 26.299999999999933, 45.9, 45.7, -50.00000000000044, 45.9, 44.5, -50.00000000000044, 46.699999999999996, -50.00000000000044, 47.3, 45.9, 47.3, 29.099999999999973, 39.10000000000002, -50.00000000000044, 46.9, -50.00000000000044, 35.500000000000036, 40.90000000000002, 43.900000000000006, 38.90000000000002, 44.5, 45.1, -50.00000000000044, 21.299999999999862, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 38.50000000000003, 45.7, -50.00000000000044, -50.00000000000044, 35.900000000000034, 38.300000000000026, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 40.500000000000014, 11.899999999999729], "episode_lengths": [34, 248, 42, 122, 26, 238, 98, 58, 500, 500, 168, 32, 500, 500, 30, 500, 500, 76, 68, 50, 376, 64, 500, 64, 62, 42, 44, 164, 500, 500, 500, 500, 500, 500, 500, 500, 38, 64, 76, 500, 500, 500, 106, 500, 500, 58, 90, 68, 34, 170, 500, 500, 242, 500, 46, 42, 238, 42, 44, 500, 42, 56, 500, 34, 500, 28, 42, 28, 210, 110, 500, 32, 500, 146, 92, 62, 112, 56, 50, 500, 288, 500, 500, 500, 56, 116, 44, 500, 500, 142, 118, 500, 88, 500, 500, 500, 500, 42, 96, 382]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4296969930864759, "mean_inference_ms": 1.3886070928067484, "mean_action_processing_ms": 0.1618737785113132, "mean_env_wait_ms": 0.09909828759944166, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03400611877441406, "StateBufferConnector_ms": 0.003998279571533203, "ViewRequirementAgentConnector_ms": 0.134552001953125}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 198000, "num_agent_steps_trained": 198000, "num_env_steps_sampled": 198000, "num_env_steps_trained": 198000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4993.006712743631, "num_env_steps_trained_throughput_per_sec": 4993.006712743631, "timesteps_total": 198000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 198000, "timers": {"training_iteration_time_ms": 3607.15, "sample_time_ms": 3236.686, "load_time_ms": 18.201, "load_throughput": 988938.866, "learn_time_ms": 339.957, "learn_throughput": 52947.936, "synch_weights_time_ms": 10.062}, "counters": {"num_env_steps_sampled": 198000, "num_env_steps_trained": 198000, "num_agent_steps_sampled": 198000, "num_agent_steps_trained": 198000}, "done": false, "episodes_total": 707, "training_iteration": 11, "trial_id": "9f288_00020", "date": "2023-10-25_17-12-28", "timestamp": 1698250348, "time_this_iter_s": 3.610983371734619, "time_total_s": 39.56053280830383, "pid": 9936, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 39.56053280830383, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 69.88, "ram_util_percent": 27.22}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.765625000000002e-05, "cur_lr": 0.0003, "total_loss": 6.808235927864358, "policy_loss": -0.00013290526759293344, "vf_loss": 6.808417390894006, "vf_explained_var": -2.037595819543909e-06, "kl": 0.0006350188760714454, "entropy": 0.4853800513126232, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 311.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.369999999999805, "episode_len_mean": 276.88, "episode_media": {}, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [47.3, 29.099999999999973, 39.10000000000002, -50.00000000000044, 46.9, -50.00000000000044, 35.500000000000036, 40.90000000000002, 43.900000000000006, 38.90000000000002, 44.5, 45.1, -50.00000000000044, 21.299999999999862, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 38.50000000000003, 45.7, -50.00000000000044, -50.00000000000044, 35.900000000000034, 38.300000000000026, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 40.500000000000014, 11.899999999999729, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 47.1, 46.3, 43.7, 45.3, 42.10000000000001, -50.00000000000044, 10.499999999999709, -50.00000000000044, 25.499999999999922, -50.00000000000044, -50.00000000000044, 33.30000000000003, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 33.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 42.70000000000001, 43.900000000000006, 28.29999999999996, -50.00000000000044, 45.9, -50.00000000000044, 41.90000000000001, -50.00000000000044, 29.299999999999976, -50.00000000000044, 42.30000000000001, 40.10000000000002, 37.50000000000003, 44.5, 36.900000000000034, -50.00000000000044, -50.00000000000044, 45.7, 41.500000000000014, 37.70000000000003, 46.099999999999994, 17.499999999999808, -50.00000000000044, 39.70000000000002, 45.9, 45.1, 46.699999999999996, 38.700000000000024, 2.499999999999595, -50.00000000000044, 29.099999999999973, 41.30000000000001, -50.00000000000044, 47.5, -50.00000000000044], "episode_lengths": [28, 210, 110, 500, 32, 500, 146, 92, 62, 112, 56, 50, 500, 288, 500, 500, 500, 56, 116, 44, 500, 500, 142, 118, 500, 88, 500, 500, 500, 500, 42, 96, 382, 500, 500, 54, 500, 500, 500, 500, 46, 500, 30, 38, 64, 48, 80, 500, 396, 500, 246, 500, 500, 168, 500, 70, 500, 500, 170, 500, 500, 500, 66, 500, 500, 74, 62, 218, 500, 42, 500, 82, 500, 208, 500, 78, 100, 126, 56, 132, 500, 500, 44, 86, 124, 40, 326, 500, 104, 42, 50, 34, 114, 476, 500, 210, 88, 500, 26, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4289315682691186, "mean_inference_ms": 1.3854971362202726, "mean_action_processing_ms": 0.16200741798917595, "mean_env_wait_ms": 0.09885464516479414, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029004573822021484, "StateBufferConnector_ms": 0.0020012855529785156, "ViewRequirementAgentConnector_ms": 0.1341705322265625}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.369999999999805, "episode_len_mean": 276.88, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [47.3, 29.099999999999973, 39.10000000000002, -50.00000000000044, 46.9, -50.00000000000044, 35.500000000000036, 40.90000000000002, 43.900000000000006, 38.90000000000002, 44.5, 45.1, -50.00000000000044, 21.299999999999862, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 38.50000000000003, 45.7, -50.00000000000044, -50.00000000000044, 35.900000000000034, 38.300000000000026, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 40.500000000000014, 11.899999999999729, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 47.1, 46.3, 43.7, 45.3, 42.10000000000001, -50.00000000000044, 10.499999999999709, -50.00000000000044, 25.499999999999922, -50.00000000000044, -50.00000000000044, 33.30000000000003, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 33.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 42.70000000000001, 43.900000000000006, 28.29999999999996, -50.00000000000044, 45.9, -50.00000000000044, 41.90000000000001, -50.00000000000044, 29.299999999999976, -50.00000000000044, 42.30000000000001, 40.10000000000002, 37.50000000000003, 44.5, 36.900000000000034, -50.00000000000044, -50.00000000000044, 45.7, 41.500000000000014, 37.70000000000003, 46.099999999999994, 17.499999999999808, -50.00000000000044, 39.70000000000002, 45.9, 45.1, 46.699999999999996, 38.700000000000024, 2.499999999999595, -50.00000000000044, 29.099999999999973, 41.30000000000001, -50.00000000000044, 47.5, -50.00000000000044], "episode_lengths": [28, 210, 110, 500, 32, 500, 146, 92, 62, 112, 56, 50, 500, 288, 500, 500, 500, 56, 116, 44, 500, 500, 142, 118, 500, 88, 500, 500, 500, 500, 42, 96, 382, 500, 500, 54, 500, 500, 500, 500, 46, 500, 30, 38, 64, 48, 80, 500, 396, 500, 246, 500, 500, 168, 500, 70, 500, 500, 170, 500, 500, 500, 66, 500, 500, 74, 62, 218, 500, 42, 500, 82, 500, 208, 500, 78, 100, 126, 56, 132, 500, 500, 44, 86, 124, 40, 326, 500, 104, 42, 50, 34, 114, 476, 500, 210, 88, 500, 26, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4289315682691186, "mean_inference_ms": 1.3854971362202726, "mean_action_processing_ms": 0.16200741798917595, "mean_env_wait_ms": 0.09885464516479414, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029004573822021484, "StateBufferConnector_ms": 0.0020012855529785156, "ViewRequirementAgentConnector_ms": 0.1341705322265625}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5087.904547445052, "num_env_steps_trained_throughput_per_sec": 5087.904547445052, "timesteps_total": 216000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 216000, "timers": {"training_iteration_time_ms": 3615.237, "sample_time_ms": 3240.335, "load_time_ms": 17.795, "load_throughput": 1011500.299, "learn_time_ms": 344.404, "learn_throughput": 52264.135, "synch_weights_time_ms": 10.459}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "done": false, "episodes_total": 774, "training_iteration": 12, "trial_id": "9f288_00020", "date": "2023-10-25_17-12-32", "timestamp": 1698250352, "time_this_iter_s": 3.5437979698181152, "time_total_s": 43.10433077812195, "pid": 9936, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 43.10433077812195, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 66.17999999999999, "ram_util_percent": 27.240000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.882812500000001e-05, "cur_lr": 0.0003, "total_loss": 6.748885172384757, "policy_loss": -8.127909084713017e-05, "vf_loss": 6.749018492522063, "vf_explained_var": -9.713349518952547e-07, "kl": 0.0005060835300606978, "entropy": 0.5202413256521579, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 338.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 234000, "num_env_steps_trained": 234000, "num_agent_steps_sampled": 234000, "num_agent_steps_trained": 234000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.778999999999847, "episode_len_mean": 237.88, "episode_media": {}, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.30000000000001, 40.10000000000002, 37.50000000000003, 44.5, 36.900000000000034, -50.00000000000044, -50.00000000000044, 45.7, 41.500000000000014, 37.70000000000003, 46.099999999999994, 17.499999999999808, -50.00000000000044, 39.70000000000002, 45.9, 45.1, 46.699999999999996, 38.700000000000024, 2.499999999999595, -50.00000000000044, 29.099999999999973, 41.30000000000001, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 43.900000000000006, 43.10000000000001, 34.50000000000004, -50.00000000000044, 21.499999999999865, -50.00000000000044, 44.300000000000004, -50.00000000000044, 43.900000000000006, -50.00000000000044, 42.70000000000001, 44.300000000000004, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 29.099999999999973, 6.8999999999996575, 35.900000000000034, 45.9, -50.00000000000044, 42.900000000000006, -50.00000000000044, 26.69999999999994, 42.500000000000014, 39.10000000000002, -50.00000000000044, -50.00000000000044, 45.9, 36.70000000000003, -50.00000000000044, 39.50000000000002, 47.1, -50.00000000000044, 45.7, 38.300000000000026, -50.00000000000044, -50.00000000000044, 39.50000000000002, 47.3, 17.499999999999808, 43.10000000000001, 47.3, -50.00000000000044, 44.10000000000001, 44.300000000000004, 45.1, -50.00000000000044, -50.00000000000044, 44.300000000000004, 42.70000000000001, 45.1, 45.3, -50.00000000000044, 44.900000000000006, 43.50000000000001, -50.00000000000044, -50.00000000000044, 37.70000000000003, 20.699999999999854, 38.50000000000003, 44.7, 33.70000000000004, -50.00000000000044, 45.9, 42.900000000000006, 29.099999999999973, 45.5, -50.00000000000044, 36.900000000000034], "episode_lengths": [78, 100, 126, 56, 132, 500, 500, 44, 86, 124, 40, 326, 500, 104, 42, 50, 34, 114, 476, 500, 210, 88, 500, 26, 500, 500, 62, 70, 156, 500, 286, 500, 58, 500, 62, 500, 74, 58, 40, 500, 500, 500, 500, 46, 500, 500, 210, 432, 142, 42, 500, 72, 500, 234, 76, 110, 500, 500, 42, 134, 500, 106, 30, 500, 44, 118, 500, 500, 106, 28, 326, 70, 28, 500, 60, 58, 50, 500, 500, 58, 74, 50, 48, 500, 52, 66, 500, 500, 124, 294, 116, 54, 164, 500, 42, 72, 210, 46, 500, 132]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4288746154564147, "mean_inference_ms": 1.3844699573762052, "mean_action_processing_ms": 0.16250914264570512, "mean_env_wait_ms": 0.09875736162236516, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03209400177001953, "StateBufferConnector_ms": 0.0019941329956054688, "ViewRequirementAgentConnector_ms": 0.14328694343566895}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.778999999999847, "episode_len_mean": 237.88, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.30000000000001, 40.10000000000002, 37.50000000000003, 44.5, 36.900000000000034, -50.00000000000044, -50.00000000000044, 45.7, 41.500000000000014, 37.70000000000003, 46.099999999999994, 17.499999999999808, -50.00000000000044, 39.70000000000002, 45.9, 45.1, 46.699999999999996, 38.700000000000024, 2.499999999999595, -50.00000000000044, 29.099999999999973, 41.30000000000001, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 43.900000000000006, 43.10000000000001, 34.50000000000004, -50.00000000000044, 21.499999999999865, -50.00000000000044, 44.300000000000004, -50.00000000000044, 43.900000000000006, -50.00000000000044, 42.70000000000001, 44.300000000000004, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 29.099999999999973, 6.8999999999996575, 35.900000000000034, 45.9, -50.00000000000044, 42.900000000000006, -50.00000000000044, 26.69999999999994, 42.500000000000014, 39.10000000000002, -50.00000000000044, -50.00000000000044, 45.9, 36.70000000000003, -50.00000000000044, 39.50000000000002, 47.1, -50.00000000000044, 45.7, 38.300000000000026, -50.00000000000044, -50.00000000000044, 39.50000000000002, 47.3, 17.499999999999808, 43.10000000000001, 47.3, -50.00000000000044, 44.10000000000001, 44.300000000000004, 45.1, -50.00000000000044, -50.00000000000044, 44.300000000000004, 42.70000000000001, 45.1, 45.3, -50.00000000000044, 44.900000000000006, 43.50000000000001, -50.00000000000044, -50.00000000000044, 37.70000000000003, 20.699999999999854, 38.50000000000003, 44.7, 33.70000000000004, -50.00000000000044, 45.9, 42.900000000000006, 29.099999999999973, 45.5, -50.00000000000044, 36.900000000000034], "episode_lengths": [78, 100, 126, 56, 132, 500, 500, 44, 86, 124, 40, 326, 500, 104, 42, 50, 34, 114, 476, 500, 210, 88, 500, 26, 500, 500, 62, 70, 156, 500, 286, 500, 58, 500, 62, 500, 74, 58, 40, 500, 500, 500, 500, 46, 500, 500, 210, 432, 142, 42, 500, 72, 500, 234, 76, 110, 500, 500, 42, 134, 500, 106, 30, 500, 44, 118, 500, 500, 106, 28, 326, 70, 28, 500, 60, 58, 50, 500, 500, 58, 74, 50, 48, 500, 52, 66, 500, 500, 124, 294, 116, 54, 164, 500, 42, 72, 210, 46, 500, 132]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4288746154564147, "mean_inference_ms": 1.3844699573762052, "mean_action_processing_ms": 0.16250914264570512, "mean_env_wait_ms": 0.09875736162236516, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03209400177001953, "StateBufferConnector_ms": 0.0019941329956054688, "ViewRequirementAgentConnector_ms": 0.14328694343566895}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 234000, "num_agent_steps_trained": 234000, "num_env_steps_sampled": 234000, "num_env_steps_trained": 234000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4947.55883860195, "num_env_steps_trained_throughput_per_sec": 4947.55883860195, "timesteps_total": 234000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 234000, "timers": {"training_iteration_time_ms": 3631.89, "sample_time_ms": 3257.036, "load_time_ms": 17.938, "load_throughput": 1003454.018, "learn_time_ms": 344.217, "learn_throughput": 52292.639, "synch_weights_time_ms": 10.456}, "counters": {"num_env_steps_sampled": 234000, "num_env_steps_trained": 234000, "num_agent_steps_sampled": 234000, "num_agent_steps_trained": 234000}, "done": false, "episodes_total": 849, "training_iteration": 13, "trial_id": "9f288_00020", "date": "2023-10-25_17-12-35", "timestamp": 1698250355, "time_this_iter_s": 3.643155813217163, "time_total_s": 46.74748659133911, "pid": 9936, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 46.74748659133911, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 69.53999999999999, "ram_util_percent": 27.18}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.4414062500000005e-05, "cur_lr": 0.0003, "total_loss": 7.452909045749241, "policy_loss": -0.00029794485480697067, "vf_loss": 7.45326116349962, "vf_explained_var": -2.693246912073206e-07, "kl": 0.0009592060692661427, "entropy": 0.542192573900576, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 365.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.729999999999862, "episode_len_mean": 233.44, "episode_media": {}, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.10000000000001, 44.300000000000004, 45.1, -50.00000000000044, -50.00000000000044, 44.300000000000004, 42.70000000000001, 45.1, 45.3, -50.00000000000044, 44.900000000000006, 43.50000000000001, -50.00000000000044, -50.00000000000044, 37.70000000000003, 20.699999999999854, 38.50000000000003, 44.7, 33.70000000000004, -50.00000000000044, 45.9, 42.900000000000006, 29.099999999999973, 45.5, -50.00000000000044, 36.900000000000034, 23.499999999999893, -50.00000000000044, 43.7, 29.49999999999998, 45.1, 43.900000000000006, 42.900000000000006, 37.300000000000026, 42.70000000000001, 46.9, 44.10000000000001, 16.8999999999998, 43.50000000000001, -50.00000000000044, 26.299999999999933, 43.30000000000001, 34.900000000000034, -50.00000000000044, 6.299999999999649, 35.30000000000004, 27.49999999999995, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 37.50000000000003, -50.00000000000044, 4.099999999999618, 30.499999999999993, 16.499999999999794, -50.00000000000044, 21.89999999999987, -50.00000000000044, -50.00000000000044, 7.499999999999666, -50.00000000000044, 36.50000000000003, 43.900000000000006, 18.699999999999825, -50.00000000000044, 40.30000000000002, -50.00000000000044, 10.699999999999712, 45.7, 44.5, 44.900000000000006, 34.50000000000004, 46.3, 38.10000000000002, 28.09999999999996, 45.9, 35.70000000000003, 45.3, 41.90000000000001, 45.9, 43.50000000000001, 44.300000000000004, 41.500000000000014, 41.100000000000016, -50.00000000000044, 20.899999999999856, -50.00000000000044, 19.299999999999834, 46.3, 22.899999999999885, 38.90000000000002, 29.899999999999984, 13.899999999999757, 47.9, 42.900000000000006, -50.00000000000044], "episode_lengths": [500, 60, 58, 50, 500, 500, 58, 74, 50, 48, 500, 52, 66, 500, 500, 124, 294, 116, 54, 164, 500, 42, 72, 210, 46, 500, 132, 266, 500, 64, 206, 50, 62, 72, 128, 74, 32, 60, 332, 66, 500, 238, 68, 152, 500, 438, 148, 226, 500, 500, 500, 500, 500, 38, 126, 500, 460, 196, 336, 500, 282, 500, 500, 426, 500, 136, 62, 314, 500, 98, 500, 394, 44, 56, 52, 156, 38, 120, 220, 42, 144, 48, 82, 42, 66, 58, 86, 90, 500, 292, 500, 308, 38, 272, 112, 202, 362, 22, 72, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43061334935232204, "mean_inference_ms": 1.3962095040453357, "mean_action_processing_ms": 0.1622044578308006, "mean_env_wait_ms": 0.09846279731294025, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028169631958007812, "StateBufferConnector_ms": 0.007991790771484375, "ViewRequirementAgentConnector_ms": 0.13487792015075684}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.729999999999862, "episode_len_mean": 233.44, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.10000000000001, 44.300000000000004, 45.1, -50.00000000000044, -50.00000000000044, 44.300000000000004, 42.70000000000001, 45.1, 45.3, -50.00000000000044, 44.900000000000006, 43.50000000000001, -50.00000000000044, -50.00000000000044, 37.70000000000003, 20.699999999999854, 38.50000000000003, 44.7, 33.70000000000004, -50.00000000000044, 45.9, 42.900000000000006, 29.099999999999973, 45.5, -50.00000000000044, 36.900000000000034, 23.499999999999893, -50.00000000000044, 43.7, 29.49999999999998, 45.1, 43.900000000000006, 42.900000000000006, 37.300000000000026, 42.70000000000001, 46.9, 44.10000000000001, 16.8999999999998, 43.50000000000001, -50.00000000000044, 26.299999999999933, 43.30000000000001, 34.900000000000034, -50.00000000000044, 6.299999999999649, 35.30000000000004, 27.49999999999995, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 37.50000000000003, -50.00000000000044, 4.099999999999618, 30.499999999999993, 16.499999999999794, -50.00000000000044, 21.89999999999987, -50.00000000000044, -50.00000000000044, 7.499999999999666, -50.00000000000044, 36.50000000000003, 43.900000000000006, 18.699999999999825, -50.00000000000044, 40.30000000000002, -50.00000000000044, 10.699999999999712, 45.7, 44.5, 44.900000000000006, 34.50000000000004, 46.3, 38.10000000000002, 28.09999999999996, 45.9, 35.70000000000003, 45.3, 41.90000000000001, 45.9, 43.50000000000001, 44.300000000000004, 41.500000000000014, 41.100000000000016, -50.00000000000044, 20.899999999999856, -50.00000000000044, 19.299999999999834, 46.3, 22.899999999999885, 38.90000000000002, 29.899999999999984, 13.899999999999757, 47.9, 42.900000000000006, -50.00000000000044], "episode_lengths": [500, 60, 58, 50, 500, 500, 58, 74, 50, 48, 500, 52, 66, 500, 500, 124, 294, 116, 54, 164, 500, 42, 72, 210, 46, 500, 132, 266, 500, 64, 206, 50, 62, 72, 128, 74, 32, 60, 332, 66, 500, 238, 68, 152, 500, 438, 148, 226, 500, 500, 500, 500, 500, 38, 126, 500, 460, 196, 336, 500, 282, 500, 500, 426, 500, 136, 62, 314, 500, 98, 500, 394, 44, 56, 52, 156, 38, 120, 220, 42, 144, 48, 82, 42, 66, 58, 86, 90, 500, 292, 500, 308, 38, 272, 112, 202, 362, 22, 72, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43061334935232204, "mean_inference_ms": 1.3962095040453357, "mean_action_processing_ms": 0.1622044578308006, "mean_env_wait_ms": 0.09846279731294025, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028169631958007812, "StateBufferConnector_ms": 0.007991790771484375, "ViewRequirementAgentConnector_ms": 0.13487792015075684}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4497.452539713091, "num_env_steps_trained_throughput_per_sec": 4497.452539713091, "timesteps_total": 252000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 252000, "timers": {"training_iteration_time_ms": 3652.619, "sample_time_ms": 3274.59, "load_time_ms": 19.748, "load_throughput": 911506.886, "learn_time_ms": 345.478, "learn_throughput": 52101.667, "synch_weights_time_ms": 10.458}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "done": false, "episodes_total": 922, "training_iteration": 14, "trial_id": "9f288_00020", "date": "2023-10-25_17-12-39", "timestamp": 1698250359, "time_this_iter_s": 4.00826096534729, "time_total_s": 50.7557475566864, "pid": 9936, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 50.7557475566864, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 67.81666666666666, "ram_util_percent": 26.933333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.2207031250000002e-05, "cur_lr": 0.0003, "total_loss": 6.460842203210901, "policy_loss": -0.0006094792926753009, "vf_loss": 6.461503682313142, "vf_explained_var": 1.3245476616753471e-08, "kl": 0.0012813302684443679, "entropy": 0.5205798281563653, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 392.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 270000, "num_env_steps_trained": 270000, "num_agent_steps_sampled": 270000, "num_agent_steps_trained": 270000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.465999999999843, "episode_len_mean": 246.0, "episode_media": {}, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [36.50000000000003, 43.900000000000006, 18.699999999999825, -50.00000000000044, 40.30000000000002, -50.00000000000044, 10.699999999999712, 45.7, 44.5, 44.900000000000006, 34.50000000000004, 46.3, 38.10000000000002, 28.09999999999996, 45.9, 35.70000000000003, 45.3, 41.90000000000001, 45.9, 43.50000000000001, 44.300000000000004, 41.500000000000014, 41.100000000000016, -50.00000000000044, 20.899999999999856, -50.00000000000044, 19.299999999999834, 46.3, 22.899999999999885, 38.90000000000002, 29.899999999999984, 13.899999999999757, 47.9, 42.900000000000006, -50.00000000000044, -50.00000000000044, 43.30000000000001, 36.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.30000000000004, 41.70000000000002, 42.900000000000006, -50.00000000000044, 44.900000000000006, -50.00000000000044, 29.299999999999976, -50.00000000000044, -50.00000000000044, 38.700000000000024, 34.50000000000004, -50.00000000000044, 40.10000000000002, -50.00000000000044, 44.900000000000006, -50.00000000000044, 38.10000000000002, -50.00000000000044, 44.300000000000004, 43.7, -50.00000000000044, 44.7, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.300000000000026, 40.30000000000002, 40.30000000000002, 40.30000000000002, -50.00000000000044, -50.00000000000044, 10.299999999999706, -50.00000000000044, 44.10000000000001, 44.5, 44.900000000000006, -50.00000000000044, 37.300000000000026, 35.500000000000036, -50.00000000000044, -50.00000000000044, 38.300000000000026, 33.500000000000036, 45.9, 46.699999999999996, -50.00000000000044, 34.900000000000034, 43.50000000000001, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 46.3, 44.5, -50.00000000000044, 45.5, -50.00000000000044], "episode_lengths": [136, 62, 314, 500, 98, 500, 394, 44, 56, 52, 156, 38, 120, 220, 42, 144, 48, 82, 42, 66, 58, 86, 90, 500, 292, 500, 308, 38, 272, 112, 202, 362, 22, 72, 500, 500, 68, 136, 500, 500, 500, 500, 158, 84, 72, 500, 52, 500, 208, 500, 500, 114, 156, 500, 100, 500, 52, 500, 120, 500, 58, 64, 500, 54, 60, 500, 500, 500, 108, 98, 98, 98, 500, 500, 398, 500, 60, 56, 52, 500, 128, 146, 500, 500, 118, 166, 42, 34, 500, 152, 66, 500, 56, 500, 500, 38, 56, 500, 46, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43197811244260576, "mean_inference_ms": 1.3960717886144614, "mean_action_processing_ms": 0.16265115251995677, "mean_env_wait_ms": 0.09825851085244128, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020160436630249023, "StateBufferConnector_ms": 0.007504701614379883, "ViewRequirementAgentConnector_ms": 0.13185453414916992}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.465999999999843, "episode_len_mean": 246.0, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [36.50000000000003, 43.900000000000006, 18.699999999999825, -50.00000000000044, 40.30000000000002, -50.00000000000044, 10.699999999999712, 45.7, 44.5, 44.900000000000006, 34.50000000000004, 46.3, 38.10000000000002, 28.09999999999996, 45.9, 35.70000000000003, 45.3, 41.90000000000001, 45.9, 43.50000000000001, 44.300000000000004, 41.500000000000014, 41.100000000000016, -50.00000000000044, 20.899999999999856, -50.00000000000044, 19.299999999999834, 46.3, 22.899999999999885, 38.90000000000002, 29.899999999999984, 13.899999999999757, 47.9, 42.900000000000006, -50.00000000000044, -50.00000000000044, 43.30000000000001, 36.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.30000000000004, 41.70000000000002, 42.900000000000006, -50.00000000000044, 44.900000000000006, -50.00000000000044, 29.299999999999976, -50.00000000000044, -50.00000000000044, 38.700000000000024, 34.50000000000004, -50.00000000000044, 40.10000000000002, -50.00000000000044, 44.900000000000006, -50.00000000000044, 38.10000000000002, -50.00000000000044, 44.300000000000004, 43.7, -50.00000000000044, 44.7, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.300000000000026, 40.30000000000002, 40.30000000000002, 40.30000000000002, -50.00000000000044, -50.00000000000044, 10.299999999999706, -50.00000000000044, 44.10000000000001, 44.5, 44.900000000000006, -50.00000000000044, 37.300000000000026, 35.500000000000036, -50.00000000000044, -50.00000000000044, 38.300000000000026, 33.500000000000036, 45.9, 46.699999999999996, -50.00000000000044, 34.900000000000034, 43.50000000000001, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 46.3, 44.5, -50.00000000000044, 45.5, -50.00000000000044], "episode_lengths": [136, 62, 314, 500, 98, 500, 394, 44, 56, 52, 156, 38, 120, 220, 42, 144, 48, 82, 42, 66, 58, 86, 90, 500, 292, 500, 308, 38, 272, 112, 202, 362, 22, 72, 500, 500, 68, 136, 500, 500, 500, 500, 158, 84, 72, 500, 52, 500, 208, 500, 500, 114, 156, 500, 100, 500, 52, 500, 120, 500, 58, 64, 500, 54, 60, 500, 500, 500, 108, 98, 98, 98, 500, 500, 398, 500, 60, 56, 52, 500, 128, 146, 500, 500, 118, 166, 42, 34, 500, 152, 66, 500, 56, 500, 500, 38, 56, 500, 46, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43197811244260576, "mean_inference_ms": 1.3960717886144614, "mean_action_processing_ms": 0.16265115251995677, "mean_env_wait_ms": 0.09825851085244128, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020160436630249023, "StateBufferConnector_ms": 0.007504701614379883, "ViewRequirementAgentConnector_ms": 0.13185453414916992}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 270000, "num_agent_steps_trained": 270000, "num_env_steps_sampled": 270000, "num_env_steps_trained": 270000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5093.11861555361, "num_env_steps_trained_throughput_per_sec": 5093.11861555361, "timesteps_total": 270000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 270000, "timers": {"training_iteration_time_ms": 3639.82, "sample_time_ms": 3259.82, "load_time_ms": 20.149, "load_throughput": 893350.199, "learn_time_ms": 347.15, "learn_throughput": 51850.758, "synch_weights_time_ms": 10.256}, "counters": {"num_env_steps_sampled": 270000, "num_env_steps_trained": 270000, "num_agent_steps_sampled": 270000, "num_agent_steps_trained": 270000}, "done": false, "episodes_total": 987, "training_iteration": 15, "trial_id": "9f288_00020", "date": "2023-10-25_17-12-43", "timestamp": 1698250363, "time_this_iter_s": 3.5411787033081055, "time_total_s": 54.29692625999451, "pid": 9936, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 54.29692625999451, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 65.85999999999999, "ram_util_percent": 26.919999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.103515625000001e-06, "cur_lr": 0.0003, "total_loss": 6.406032721201579, "policy_loss": -0.0004018296108201698, "vf_loss": 6.4064864229272915, "vf_explained_var": -4.547613638418692e-07, "kl": 0.0012942600528394568, "entropy": 0.5181301931540171, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 419.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.583999999999858, "episode_len_mean": 224.84, "episode_media": {}, "episodes_this_iter": 77, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.5, 44.900000000000006, -50.00000000000044, 37.300000000000026, 35.500000000000036, -50.00000000000044, -50.00000000000044, 38.300000000000026, 33.500000000000036, 45.9, 46.699999999999996, -50.00000000000044, 34.900000000000034, 43.50000000000001, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 46.3, 44.5, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 25.499999999999922, 30.699999999999996, 42.10000000000001, 34.70000000000004, 40.70000000000002, 44.7, 47.3, 43.50000000000001, -50.00000000000044, 40.10000000000002, -50.00000000000044, 43.7, 32.90000000000003, -50.00000000000044, 41.30000000000001, 45.1, 45.1, -50.00000000000044, -50.00000000000044, 43.30000000000001, 43.10000000000001, 44.300000000000004, -50.00000000000044, 45.1, 46.5, 43.50000000000001, 36.900000000000034, 45.7, 32.700000000000024, 40.70000000000002, 36.10000000000004, -50.00000000000044, 42.900000000000006, 36.10000000000004, 31.1, 38.90000000000002, -50.00000000000044, 46.099999999999994, 44.300000000000004, 47.3, -50.00000000000044, 47.7, 43.7, 24.69999999999991, 33.30000000000003, 47.1, 44.300000000000004, 39.50000000000002, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, 45.1, -50.00000000000044, 46.099999999999994, 45.1, 40.10000000000002, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 16.499999999999794, 41.100000000000016, 46.9, 46.3, 46.3, -50.00000000000044, 45.7, 2.699999999999598], "episode_lengths": [56, 52, 500, 128, 146, 500, 500, 118, 166, 42, 34, 500, 152, 66, 500, 56, 500, 500, 38, 56, 500, 46, 500, 500, 500, 500, 52, 246, 194, 80, 154, 94, 54, 28, 66, 500, 100, 500, 64, 172, 500, 88, 50, 50, 500, 500, 68, 70, 58, 500, 50, 36, 66, 132, 44, 174, 94, 140, 500, 72, 140, 190, 112, 500, 40, 58, 28, 500, 24, 64, 254, 168, 30, 58, 106, 70, 500, 500, 500, 500, 500, 110, 50, 500, 40, 50, 100, 500, 500, 88, 500, 500, 336, 90, 32, 38, 38, 500, 44, 474]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4309516180678557, "mean_inference_ms": 1.3899115518132732, "mean_action_processing_ms": 0.16229013051024208, "mean_env_wait_ms": 0.0971607344145324, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019537687301635742, "StateBufferConnector_ms": 0.008509159088134766, "ViewRequirementAgentConnector_ms": 0.13676738739013672}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.583999999999858, "episode_len_mean": 224.84, "episodes_this_iter": 77, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.5, 44.900000000000006, -50.00000000000044, 37.300000000000026, 35.500000000000036, -50.00000000000044, -50.00000000000044, 38.300000000000026, 33.500000000000036, 45.9, 46.699999999999996, -50.00000000000044, 34.900000000000034, 43.50000000000001, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 46.3, 44.5, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 25.499999999999922, 30.699999999999996, 42.10000000000001, 34.70000000000004, 40.70000000000002, 44.7, 47.3, 43.50000000000001, -50.00000000000044, 40.10000000000002, -50.00000000000044, 43.7, 32.90000000000003, -50.00000000000044, 41.30000000000001, 45.1, 45.1, -50.00000000000044, -50.00000000000044, 43.30000000000001, 43.10000000000001, 44.300000000000004, -50.00000000000044, 45.1, 46.5, 43.50000000000001, 36.900000000000034, 45.7, 32.700000000000024, 40.70000000000002, 36.10000000000004, -50.00000000000044, 42.900000000000006, 36.10000000000004, 31.1, 38.90000000000002, -50.00000000000044, 46.099999999999994, 44.300000000000004, 47.3, -50.00000000000044, 47.7, 43.7, 24.69999999999991, 33.30000000000003, 47.1, 44.300000000000004, 39.50000000000002, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, 45.1, -50.00000000000044, 46.099999999999994, 45.1, 40.10000000000002, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 16.499999999999794, 41.100000000000016, 46.9, 46.3, 46.3, -50.00000000000044, 45.7, 2.699999999999598], "episode_lengths": [56, 52, 500, 128, 146, 500, 500, 118, 166, 42, 34, 500, 152, 66, 500, 56, 500, 500, 38, 56, 500, 46, 500, 500, 500, 500, 52, 246, 194, 80, 154, 94, 54, 28, 66, 500, 100, 500, 64, 172, 500, 88, 50, 50, 500, 500, 68, 70, 58, 500, 50, 36, 66, 132, 44, 174, 94, 140, 500, 72, 140, 190, 112, 500, 40, 58, 28, 500, 24, 64, 254, 168, 30, 58, 106, 70, 500, 500, 500, 500, 500, 110, 50, 500, 40, 50, 100, 500, 500, 88, 500, 500, 336, 90, 32, 38, 38, 500, 44, 474]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4309516180678557, "mean_inference_ms": 1.3899115518132732, "mean_action_processing_ms": 0.16229013051024208, "mean_env_wait_ms": 0.0971607344145324, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019537687301635742, "StateBufferConnector_ms": 0.008509159088134766, "ViewRequirementAgentConnector_ms": 0.13676738739013672}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5071.966697762335, "num_env_steps_trained_throughput_per_sec": 5071.966697762335, "timesteps_total": 288000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 3627.178, "sample_time_ms": 3246.203, "load_time_ms": 21.936, "load_throughput": 820582.775, "learn_time_ms": 346.345, "learn_throughput": 51971.333, "synch_weights_time_ms": 10.255}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "episodes_total": 1064, "training_iteration": 16, "trial_id": "9f288_00020", "date": "2023-10-25_17-12-46", "timestamp": 1698250366, "time_this_iter_s": 3.554915428161621, "time_total_s": 57.85184168815613, "pid": 9936, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 57.85184168815613, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 66.5, "ram_util_percent": 26.919999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.0517578125000006e-06, "cur_lr": 0.0003, "total_loss": 6.759715804347286, "policy_loss": -3.755561731479786e-05, "vf_loss": 6.759807922221996, "vf_explained_var": -1.724119539614077e-06, "kl": 0.00018167910630916562, "entropy": 0.5447189531944416, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 446.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 306000, "num_env_steps_trained": 306000, "num_agent_steps_sampled": 306000, "num_agent_steps_trained": 306000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.806999999999818, "episode_len_mean": 257.54, "episode_media": {}, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, 45.1, -50.00000000000044, 46.099999999999994, 45.1, 40.10000000000002, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 16.499999999999794, 41.100000000000016, 46.9, 46.3, 46.3, -50.00000000000044, 45.7, 2.699999999999598, -50.00000000000044, 37.300000000000026, 43.7, 41.100000000000016, -50.00000000000044, 42.10000000000001, -50.00000000000044, 41.100000000000016, 34.50000000000004, 42.10000000000001, 39.70000000000002, -50.00000000000044, 41.500000000000014, -50.00000000000044, 34.50000000000004, 45.3, 30.099999999999987, -50.00000000000044, 44.7, 43.10000000000001, 38.300000000000026, -50.00000000000044, -50.00000000000044, 1.299999999999578, 42.500000000000014, 43.900000000000006, 41.70000000000002, -50.00000000000044, 4.899999999999629, 44.10000000000001, -50.00000000000044, 45.9, 45.9, 46.3, 45.1, 46.3, -50.00000000000044, -50.00000000000044, 45.3, 46.699999999999996, 44.5, 45.5, -50.00000000000044, 43.50000000000001, -50.00000000000044, 32.50000000000002, 44.5, 41.30000000000001, 44.900000000000006, -50.00000000000044, 32.50000000000002, -50.00000000000044, -50.00000000000044, 42.900000000000006, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 44.5, 45.1, 45.1, 46.099999999999994, -50.00000000000044, 27.099999999999945, 32.100000000000016], "episode_lengths": [70, 500, 500, 500, 500, 500, 110, 50, 500, 40, 50, 100, 500, 500, 88, 500, 500, 336, 90, 32, 38, 38, 500, 44, 474, 500, 128, 64, 90, 500, 80, 500, 90, 156, 80, 104, 500, 86, 500, 156, 48, 200, 500, 54, 70, 118, 500, 500, 488, 76, 62, 84, 500, 452, 60, 500, 42, 42, 38, 50, 38, 500, 500, 48, 34, 56, 46, 500, 66, 500, 176, 56, 88, 52, 500, 176, 500, 500, 72, 52, 500, 500, 500, 500, 500, 98, 500, 62, 500, 500, 50, 500, 500, 56, 50, 50, 40, 500, 230, 180]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43066874469409816, "mean_inference_ms": 1.3885507592397277, "mean_action_processing_ms": 0.16161076397051377, "mean_env_wait_ms": 0.09698434032065194, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.035016536712646484, "StateBufferConnector_ms": 0.00633549690246582, "ViewRequirementAgentConnector_ms": 0.1366744041442871}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.806999999999818, "episode_len_mean": 257.54, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, 45.1, -50.00000000000044, 46.099999999999994, 45.1, 40.10000000000002, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 16.499999999999794, 41.100000000000016, 46.9, 46.3, 46.3, -50.00000000000044, 45.7, 2.699999999999598, -50.00000000000044, 37.300000000000026, 43.7, 41.100000000000016, -50.00000000000044, 42.10000000000001, -50.00000000000044, 41.100000000000016, 34.50000000000004, 42.10000000000001, 39.70000000000002, -50.00000000000044, 41.500000000000014, -50.00000000000044, 34.50000000000004, 45.3, 30.099999999999987, -50.00000000000044, 44.7, 43.10000000000001, 38.300000000000026, -50.00000000000044, -50.00000000000044, 1.299999999999578, 42.500000000000014, 43.900000000000006, 41.70000000000002, -50.00000000000044, 4.899999999999629, 44.10000000000001, -50.00000000000044, 45.9, 45.9, 46.3, 45.1, 46.3, -50.00000000000044, -50.00000000000044, 45.3, 46.699999999999996, 44.5, 45.5, -50.00000000000044, 43.50000000000001, -50.00000000000044, 32.50000000000002, 44.5, 41.30000000000001, 44.900000000000006, -50.00000000000044, 32.50000000000002, -50.00000000000044, -50.00000000000044, 42.900000000000006, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 44.5, 45.1, 45.1, 46.099999999999994, -50.00000000000044, 27.099999999999945, 32.100000000000016], "episode_lengths": [70, 500, 500, 500, 500, 500, 110, 50, 500, 40, 50, 100, 500, 500, 88, 500, 500, 336, 90, 32, 38, 38, 500, 44, 474, 500, 128, 64, 90, 500, 80, 500, 90, 156, 80, 104, 500, 86, 500, 156, 48, 200, 500, 54, 70, 118, 500, 500, 488, 76, 62, 84, 500, 452, 60, 500, 42, 42, 38, 50, 38, 500, 500, 48, 34, 56, 46, 500, 66, 500, 176, 56, 88, 52, 500, 176, 500, 500, 72, 52, 500, 500, 500, 500, 500, 98, 500, 62, 500, 500, 50, 500, 500, 56, 50, 50, 40, 500, 230, 180]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43066874469409816, "mean_inference_ms": 1.3885507592397277, "mean_action_processing_ms": 0.16161076397051377, "mean_env_wait_ms": 0.09698434032065194, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.035016536712646484, "StateBufferConnector_ms": 0.00633549690246582, "ViewRequirementAgentConnector_ms": 0.1366744041442871}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 306000, "num_agent_steps_trained": 306000, "num_env_steps_sampled": 306000, "num_env_steps_trained": 306000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5092.402683455565, "num_env_steps_trained_throughput_per_sec": 5092.402683455565, "timesteps_total": 306000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 306000, "timers": {"training_iteration_time_ms": 3622.65, "sample_time_ms": 3241.569, "load_time_ms": 19.436, "load_throughput": 926126.625, "learn_time_ms": 348.777, "learn_throughput": 51608.896, "synch_weights_time_ms": 10.275}, "counters": {"num_env_steps_sampled": 306000, "num_env_steps_trained": 306000, "num_agent_steps_sampled": 306000, "num_agent_steps_trained": 306000}, "done": false, "episodes_total": 1139, "training_iteration": 17, "trial_id": "9f288_00020", "date": "2023-10-25_17-12-50", "timestamp": 1698250370, "time_this_iter_s": 3.5396764278411865, "time_total_s": 61.391518115997314, "pid": 9936, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 61.391518115997314, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 67.26, "ram_util_percent": 26.919999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.5258789062500003e-06, "cur_lr": 0.0003, "total_loss": 6.542095767127143, "policy_loss": 6.237777846830863e-05, "vf_loss": 6.5420904336152255, "vf_explained_var": -1.037562334979022e-07, "kl": 0.00010683353043256578, "entropy": 0.5708431623600148, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 473.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.7799999999998095, "episode_len_mean": 272.78, "episode_media": {}, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.5, 45.5, -50.00000000000044, 43.50000000000001, -50.00000000000044, 32.50000000000002, 44.5, 41.30000000000001, 44.900000000000006, -50.00000000000044, 32.50000000000002, -50.00000000000044, -50.00000000000044, 42.900000000000006, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 44.5, 45.1, 45.1, 46.099999999999994, -50.00000000000044, 27.099999999999945, 32.100000000000016, -50.00000000000044, -50.00000000000044, 41.30000000000001, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 44.900000000000006, 43.50000000000001, -50.00000000000044, 39.300000000000026, -50.00000000000044, 36.900000000000034, 38.90000000000002, 45.9, 36.50000000000003, 9.499999999999694, -50.00000000000044, 33.10000000000003, 44.10000000000001, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 42.500000000000014, 43.50000000000001, -50.00000000000044, -50.00000000000044, 37.50000000000003, 44.7, -50.00000000000044, 46.699999999999996, 21.299999999999862, 34.10000000000004, 44.5, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 1.4999999999995808, -50.00000000000044, 37.70000000000003, 29.69999999999998, 42.30000000000001, -50.00000000000044, 42.10000000000001, 32.30000000000002, 46.3, 45.1, 46.099999999999994, -50.00000000000044, 39.10000000000002, -50.00000000000044, 33.90000000000004, -50.00000000000044, 29.299999999999976, 43.10000000000001, 40.500000000000014, 44.10000000000001, 34.900000000000034, -50.00000000000044], "episode_lengths": [56, 46, 500, 66, 500, 176, 56, 88, 52, 500, 176, 500, 500, 72, 52, 500, 500, 500, 500, 500, 98, 500, 62, 500, 500, 50, 500, 500, 56, 50, 50, 40, 500, 230, 180, 500, 500, 88, 72, 500, 500, 500, 500, 500, 74, 500, 52, 66, 500, 108, 500, 132, 112, 42, 136, 406, 500, 170, 60, 500, 500, 58, 500, 76, 66, 500, 500, 126, 54, 500, 34, 288, 160, 56, 500, 500, 50, 500, 486, 500, 124, 204, 78, 500, 80, 178, 38, 50, 40, 500, 110, 500, 162, 500, 208, 70, 96, 60, 152, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4300273358477017, "mean_inference_ms": 1.3879544484748805, "mean_action_processing_ms": 0.1613913219392582, "mean_env_wait_ms": 0.09714851848270105, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.034162044525146484, "StateBufferConnector_ms": 0.006003379821777344, "ViewRequirementAgentConnector_ms": 0.12118196487426758}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.7799999999998095, "episode_len_mean": 272.78, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.5, 45.5, -50.00000000000044, 43.50000000000001, -50.00000000000044, 32.50000000000002, 44.5, 41.30000000000001, 44.900000000000006, -50.00000000000044, 32.50000000000002, -50.00000000000044, -50.00000000000044, 42.900000000000006, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 44.5, 45.1, 45.1, 46.099999999999994, -50.00000000000044, 27.099999999999945, 32.100000000000016, -50.00000000000044, -50.00000000000044, 41.30000000000001, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 44.900000000000006, 43.50000000000001, -50.00000000000044, 39.300000000000026, -50.00000000000044, 36.900000000000034, 38.90000000000002, 45.9, 36.50000000000003, 9.499999999999694, -50.00000000000044, 33.10000000000003, 44.10000000000001, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 42.500000000000014, 43.50000000000001, -50.00000000000044, -50.00000000000044, 37.50000000000003, 44.7, -50.00000000000044, 46.699999999999996, 21.299999999999862, 34.10000000000004, 44.5, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 1.4999999999995808, -50.00000000000044, 37.70000000000003, 29.69999999999998, 42.30000000000001, -50.00000000000044, 42.10000000000001, 32.30000000000002, 46.3, 45.1, 46.099999999999994, -50.00000000000044, 39.10000000000002, -50.00000000000044, 33.90000000000004, -50.00000000000044, 29.299999999999976, 43.10000000000001, 40.500000000000014, 44.10000000000001, 34.900000000000034, -50.00000000000044], "episode_lengths": [56, 46, 500, 66, 500, 176, 56, 88, 52, 500, 176, 500, 500, 72, 52, 500, 500, 500, 500, 500, 98, 500, 62, 500, 500, 50, 500, 500, 56, 50, 50, 40, 500, 230, 180, 500, 500, 88, 72, 500, 500, 500, 500, 500, 74, 500, 52, 66, 500, 108, 500, 132, 112, 42, 136, 406, 500, 170, 60, 500, 500, 58, 500, 76, 66, 500, 500, 126, 54, 500, 34, 288, 160, 56, 500, 500, 50, 500, 486, 500, 124, 204, 78, 500, 80, 178, 38, 50, 40, 500, 110, 500, 162, 500, 208, 70, 96, 60, 152, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4300273358477017, "mean_inference_ms": 1.3879544484748805, "mean_action_processing_ms": 0.1613913219392582, "mean_env_wait_ms": 0.09714851848270105, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.034162044525146484, "StateBufferConnector_ms": 0.006003379821777344, "ViewRequirementAgentConnector_ms": 0.12118196487426758}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5040.739687553142, "num_env_steps_trained_throughput_per_sec": 5040.739687553142, "timesteps_total": 324000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 324000, "timers": {"training_iteration_time_ms": 3625.895, "sample_time_ms": 3242.718, "load_time_ms": 19.631, "load_throughput": 916905.783, "learn_time_ms": 350.639, "learn_throughput": 51334.851, "synch_weights_time_ms": 10.184}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "done": false, "episodes_total": 1204, "training_iteration": 18, "trial_id": "9f288_00020", "date": "2023-10-25_17-12-54", "timestamp": 1698250374, "time_this_iter_s": 3.576605796813965, "time_total_s": 64.96812391281128, "pid": 9936, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 64.96812391281128, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 66.42, "ram_util_percent": 26.919999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.629394531250001e-07, "cur_lr": 0.0003, "total_loss": 6.931795296845613, "policy_loss": -0.0008307104861294782, "vf_loss": 6.932682443548132, "vf_explained_var": -1.445964530662254e-06, "kl": 0.001591754180238438, "entropy": 0.5635502790963208, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 500.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 342000, "num_env_steps_trained": 342000, "num_agent_steps_sampled": 342000, "num_agent_steps_trained": 342000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.496999999999836, "episode_len_mean": 250.7, "episode_media": {}, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.5, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 1.4999999999995808, -50.00000000000044, 37.70000000000003, 29.69999999999998, 42.30000000000001, -50.00000000000044, 42.10000000000001, 32.30000000000002, 46.3, 45.1, 46.099999999999994, -50.00000000000044, 39.10000000000002, -50.00000000000044, 33.90000000000004, -50.00000000000044, 29.299999999999976, 43.10000000000001, 40.500000000000014, 44.10000000000001, 34.900000000000034, -50.00000000000044, -50.00000000000044, 46.9, 43.7, -50.00000000000044, -50.00000000000044, 46.099999999999994, 41.500000000000014, -50.00000000000044, 44.5, 44.300000000000004, 23.099999999999888, 44.7, 12.099999999999731, 39.70000000000002, -50.00000000000044, -50.00000000000044, 35.30000000000004, -50.00000000000044, -50.00000000000044, 46.3, 40.10000000000002, -50.00000000000044, -50.00000000000044, 45.9, 2.0999999999995893, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.50000000000003, 43.30000000000001, 41.70000000000002, 41.70000000000002, 37.300000000000026, -50.00000000000044, 44.7, 36.70000000000003, 20.099999999999845, 43.30000000000001, -50.00000000000044, 46.3, 18.699999999999825, 41.70000000000002, 45.7, -50.00000000000044, 45.7, 42.10000000000001, 8.899999999999686, 34.70000000000004, -50.00000000000044, 44.7, -50.00000000000044, 42.10000000000001, 16.09999999999979, 45.3, 40.90000000000002, -50.00000000000044, 36.70000000000003, 24.099999999999902, 44.7, 32.100000000000016, 38.10000000000002, -50.00000000000044, 43.50000000000001, 43.30000000000001, 31.70000000000001, -50.00000000000044, 41.90000000000001, -50.00000000000044, 19.499999999999837, 43.30000000000001, 46.699999999999996], "episode_lengths": [56, 500, 500, 50, 500, 486, 500, 124, 204, 78, 500, 80, 178, 38, 50, 40, 500, 110, 500, 162, 500, 208, 70, 96, 60, 152, 500, 500, 32, 64, 500, 500, 40, 86, 500, 56, 58, 270, 54, 380, 104, 500, 500, 148, 500, 500, 38, 100, 500, 500, 42, 480, 500, 500, 500, 500, 500, 116, 68, 84, 84, 128, 500, 54, 134, 300, 68, 500, 38, 314, 84, 44, 500, 44, 80, 412, 154, 500, 54, 500, 80, 340, 48, 92, 500, 134, 260, 54, 180, 120, 500, 66, 68, 184, 500, 82, 500, 306, 68, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4288097761167732, "mean_inference_ms": 1.3865846954325354, "mean_action_processing_ms": 0.16074429409328214, "mean_env_wait_ms": 0.09739474861797566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024310827255249023, "StateBufferConnector_ms": 0.0030062198638916016, "ViewRequirementAgentConnector_ms": 0.1451890468597412}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.496999999999836, "episode_len_mean": 250.7, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.5, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 1.4999999999995808, -50.00000000000044, 37.70000000000003, 29.69999999999998, 42.30000000000001, -50.00000000000044, 42.10000000000001, 32.30000000000002, 46.3, 45.1, 46.099999999999994, -50.00000000000044, 39.10000000000002, -50.00000000000044, 33.90000000000004, -50.00000000000044, 29.299999999999976, 43.10000000000001, 40.500000000000014, 44.10000000000001, 34.900000000000034, -50.00000000000044, -50.00000000000044, 46.9, 43.7, -50.00000000000044, -50.00000000000044, 46.099999999999994, 41.500000000000014, -50.00000000000044, 44.5, 44.300000000000004, 23.099999999999888, 44.7, 12.099999999999731, 39.70000000000002, -50.00000000000044, -50.00000000000044, 35.30000000000004, -50.00000000000044, -50.00000000000044, 46.3, 40.10000000000002, -50.00000000000044, -50.00000000000044, 45.9, 2.0999999999995893, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.50000000000003, 43.30000000000001, 41.70000000000002, 41.70000000000002, 37.300000000000026, -50.00000000000044, 44.7, 36.70000000000003, 20.099999999999845, 43.30000000000001, -50.00000000000044, 46.3, 18.699999999999825, 41.70000000000002, 45.7, -50.00000000000044, 45.7, 42.10000000000001, 8.899999999999686, 34.70000000000004, -50.00000000000044, 44.7, -50.00000000000044, 42.10000000000001, 16.09999999999979, 45.3, 40.90000000000002, -50.00000000000044, 36.70000000000003, 24.099999999999902, 44.7, 32.100000000000016, 38.10000000000002, -50.00000000000044, 43.50000000000001, 43.30000000000001, 31.70000000000001, -50.00000000000044, 41.90000000000001, -50.00000000000044, 19.499999999999837, 43.30000000000001, 46.699999999999996], "episode_lengths": [56, 500, 500, 50, 500, 486, 500, 124, 204, 78, 500, 80, 178, 38, 50, 40, 500, 110, 500, 162, 500, 208, 70, 96, 60, 152, 500, 500, 32, 64, 500, 500, 40, 86, 500, 56, 58, 270, 54, 380, 104, 500, 500, 148, 500, 500, 38, 100, 500, 500, 42, 480, 500, 500, 500, 500, 500, 116, 68, 84, 84, 128, 500, 54, 134, 300, 68, 500, 38, 314, 84, 44, 500, 44, 80, 412, 154, 500, 54, 500, 80, 340, 48, 92, 500, 134, 260, 54, 180, 120, 500, 66, 68, 184, 500, 82, 500, 306, 68, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4288097761167732, "mean_inference_ms": 1.3865846954325354, "mean_action_processing_ms": 0.16074429409328214, "mean_env_wait_ms": 0.09739474861797566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024310827255249023, "StateBufferConnector_ms": 0.0030062198638916016, "ViewRequirementAgentConnector_ms": 0.1451890468597412}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 342000, "num_agent_steps_trained": 342000, "num_env_steps_sampled": 342000, "num_env_steps_trained": 342000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5027.612304970391, "num_env_steps_trained_throughput_per_sec": 5027.612304970391, "timesteps_total": 342000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 342000, "timers": {"training_iteration_time_ms": 3623.648, "sample_time_ms": 3240.942, "load_time_ms": 19.831, "load_throughput": 907653.907, "learn_time_ms": 349.79, "learn_throughput": 51459.436, "synch_weights_time_ms": 10.158}, "counters": {"num_env_steps_sampled": 342000, "num_env_steps_trained": 342000, "num_agent_steps_sampled": 342000, "num_agent_steps_trained": 342000}, "done": false, "episodes_total": 1277, "training_iteration": 19, "trial_id": "9f288_00020", "date": "2023-10-25_17-12-57", "timestamp": 1698250377, "time_this_iter_s": 3.5861868858337402, "time_total_s": 68.55431079864502, "pid": 9936, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 68.55431079864502, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 68.22, "ram_util_percent": 26.919999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.814697265625001e-07, "cur_lr": 0.0003, "total_loss": 7.090405411190456, "policy_loss": -0.0002709714074929555, "vf_loss": 7.090731426521584, "vf_explained_var": 3.0464596218532984e-07, "kl": 0.0009317900940720426, "entropy": 0.5513449300218511, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 527.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.433999999999847, "episode_len_mean": 246.36, "episode_media": {}, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.7, 42.10000000000001, 8.899999999999686, 34.70000000000004, -50.00000000000044, 44.7, -50.00000000000044, 42.10000000000001, 16.09999999999979, 45.3, 40.90000000000002, -50.00000000000044, 36.70000000000003, 24.099999999999902, 44.7, 32.100000000000016, 38.10000000000002, -50.00000000000044, 43.50000000000001, 43.30000000000001, 31.70000000000001, -50.00000000000044, 41.90000000000001, -50.00000000000044, 19.499999999999837, 43.30000000000001, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.70000000000003, 45.7, 44.5, 35.900000000000034, 42.500000000000014, 26.499999999999936, 40.10000000000002, 45.3, 45.9, -50.00000000000044, 31.70000000000001, -50.00000000000044, 18.899999999999828, 6.699999999999655, 23.099999999999888, -50.00000000000044, 42.70000000000001, 42.10000000000001, 22.899999999999885, -50.00000000000044, 41.70000000000002, -50.00000000000044, 42.70000000000001, 13.899999999999757, 41.30000000000001, 44.900000000000006, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 8.099999999999675, -50.00000000000044, 35.10000000000004, -50.00000000000044, 8.899999999999686, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.9, -50.00000000000044, 44.10000000000001, 43.7, 44.300000000000004, 29.69999999999998, -50.00000000000044, 27.899999999999956, 36.50000000000003, -50.00000000000044, 28.699999999999967, 43.10000000000001, 42.30000000000001, 28.29999999999996, 39.300000000000026, 46.5, 45.5, 47.3, 45.1, 41.30000000000001, 43.900000000000006, 25.699999999999925, 46.699999999999996, -50.00000000000044, -50.00000000000044, 46.699999999999996, 32.700000000000024, 44.5, -50.00000000000044], "episode_lengths": [500, 44, 80, 412, 154, 500, 54, 500, 80, 340, 48, 92, 500, 134, 260, 54, 180, 120, 500, 66, 68, 184, 500, 82, 500, 306, 68, 34, 500, 500, 500, 144, 44, 56, 142, 76, 236, 100, 48, 42, 500, 184, 500, 312, 434, 270, 500, 74, 80, 272, 500, 84, 500, 74, 362, 88, 52, 72, 500, 500, 500, 420, 500, 150, 500, 412, 500, 72, 500, 500, 500, 192, 500, 60, 64, 58, 204, 500, 222, 136, 500, 214, 70, 78, 218, 108, 36, 46, 28, 50, 88, 62, 244, 34, 500, 500, 34, 174, 56, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42918167784509237, "mean_inference_ms": 1.3806924528428575, "mean_action_processing_ms": 0.1610090747425806, "mean_env_wait_ms": 0.09739700605193949, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018979787826538086, "StateBufferConnector_ms": 0.007012128829956055, "ViewRequirementAgentConnector_ms": 0.13374066352844238}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.433999999999847, "episode_len_mean": 246.36, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.7, 42.10000000000001, 8.899999999999686, 34.70000000000004, -50.00000000000044, 44.7, -50.00000000000044, 42.10000000000001, 16.09999999999979, 45.3, 40.90000000000002, -50.00000000000044, 36.70000000000003, 24.099999999999902, 44.7, 32.100000000000016, 38.10000000000002, -50.00000000000044, 43.50000000000001, 43.30000000000001, 31.70000000000001, -50.00000000000044, 41.90000000000001, -50.00000000000044, 19.499999999999837, 43.30000000000001, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.70000000000003, 45.7, 44.5, 35.900000000000034, 42.500000000000014, 26.499999999999936, 40.10000000000002, 45.3, 45.9, -50.00000000000044, 31.70000000000001, -50.00000000000044, 18.899999999999828, 6.699999999999655, 23.099999999999888, -50.00000000000044, 42.70000000000001, 42.10000000000001, 22.899999999999885, -50.00000000000044, 41.70000000000002, -50.00000000000044, 42.70000000000001, 13.899999999999757, 41.30000000000001, 44.900000000000006, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 8.099999999999675, -50.00000000000044, 35.10000000000004, -50.00000000000044, 8.899999999999686, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.9, -50.00000000000044, 44.10000000000001, 43.7, 44.300000000000004, 29.69999999999998, -50.00000000000044, 27.899999999999956, 36.50000000000003, -50.00000000000044, 28.699999999999967, 43.10000000000001, 42.30000000000001, 28.29999999999996, 39.300000000000026, 46.5, 45.5, 47.3, 45.1, 41.30000000000001, 43.900000000000006, 25.699999999999925, 46.699999999999996, -50.00000000000044, -50.00000000000044, 46.699999999999996, 32.700000000000024, 44.5, -50.00000000000044], "episode_lengths": [500, 44, 80, 412, 154, 500, 54, 500, 80, 340, 48, 92, 500, 134, 260, 54, 180, 120, 500, 66, 68, 184, 500, 82, 500, 306, 68, 34, 500, 500, 500, 144, 44, 56, 142, 76, 236, 100, 48, 42, 500, 184, 500, 312, 434, 270, 500, 74, 80, 272, 500, 84, 500, 74, 362, 88, 52, 72, 500, 500, 500, 420, 500, 150, 500, 412, 500, 72, 500, 500, 500, 192, 500, 60, 64, 58, 204, 500, 222, 136, 500, 214, 70, 78, 218, 108, 36, 46, 28, 50, 88, 62, 244, 34, 500, 500, 34, 174, 56, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42918167784509237, "mean_inference_ms": 1.3806924528428575, "mean_action_processing_ms": 0.1610090747425806, "mean_env_wait_ms": 0.09739700605193949, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018979787826538086, "StateBufferConnector_ms": 0.007012128829956055, "ViewRequirementAgentConnector_ms": 0.13374066352844238}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5049.445221282459, "num_env_steps_trained_throughput_per_sec": 5049.445221282459, "timesteps_total": 360000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 360000, "timers": {"training_iteration_time_ms": 3611.593, "sample_time_ms": 3227.694, "load_time_ms": 19.905, "load_throughput": 904295.632, "learn_time_ms": 350.9, "learn_throughput": 51296.613, "synch_weights_time_ms": 10.157}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "done": false, "episodes_total": 1349, "training_iteration": 20, "trial_id": "9f288_00020", "date": "2023-10-25_17-13-01", "timestamp": 1698250381, "time_this_iter_s": 3.570736885070801, "time_total_s": 72.12504768371582, "pid": 9936, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 72.12504768371582, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 67.8, "ram_util_percent": 26.839999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.9073486328125004e-07, "cur_lr": 0.0003, "total_loss": 6.929259830050999, "policy_loss": 6.823862592379253e-05, "vf_loss": 6.929245913470233, "vf_explained_var": -3.311369154188368e-08, "kl": 0.00015395421600159252, "entropy": 0.5438930767553823, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 554.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 378000, "num_env_steps_trained": 378000, "num_agent_steps_sampled": 378000, "num_agent_steps_trained": 378000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.555999999999838, "episode_len_mean": 245.1, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 30.9, -50.00000000000044, 44.10000000000001, 43.7, 44.300000000000004, 29.69999999999998, -50.00000000000044, 27.899999999999956, 36.50000000000003, -50.00000000000044, 28.699999999999967, 43.10000000000001, 42.30000000000001, 28.29999999999996, 39.300000000000026, 46.5, 45.5, 47.3, 45.1, 41.30000000000001, 43.900000000000006, 25.699999999999925, 46.699999999999996, -50.00000000000044, -50.00000000000044, 46.699999999999996, 32.700000000000024, 44.5, -50.00000000000044, -50.00000000000044, 45.9, 0.6999999999995694, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 41.70000000000002, 44.7, -50.00000000000044, -50.00000000000044, 40.90000000000002, 41.70000000000002, 41.100000000000016, -50.00000000000044, 42.900000000000006, -50.00000000000044, 36.900000000000034, 7.699999999999669, -50.00000000000044, 42.10000000000001, -50.00000000000044, 41.70000000000002, 45.7, -50.00000000000044, 12.099999999999731, -50.00000000000044, 18.29999999999982, 43.900000000000006, -50.00000000000044, 44.5, 42.30000000000001, 16.699999999999797, 38.700000000000024, 43.900000000000006, 43.900000000000006, -50.00000000000044, -50.00000000000044, 41.90000000000001, 41.70000000000002, -50.00000000000044, -50.00000000000044, 36.70000000000003, -50.00000000000044, 43.900000000000006, 43.10000000000001, -50.00000000000044, 38.300000000000026, 45.5, 29.299999999999976, -50.00000000000044, 46.5, 44.10000000000001, 36.70000000000003, 44.10000000000001, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 39.90000000000002, 38.700000000000024, -50.00000000000044, 44.900000000000006, -50.00000000000044, 40.10000000000002, -50.00000000000044, 45.3, -50.00000000000044, 41.100000000000016, 41.500000000000014], "episode_lengths": [500, 192, 500, 60, 64, 58, 204, 500, 222, 136, 500, 214, 70, 78, 218, 108, 36, 46, 28, 50, 88, 62, 244, 34, 500, 500, 34, 174, 56, 500, 500, 42, 494, 500, 500, 40, 500, 84, 54, 500, 500, 92, 84, 90, 500, 72, 500, 132, 424, 500, 80, 500, 84, 44, 500, 380, 500, 318, 62, 500, 56, 78, 334, 114, 62, 62, 500, 500, 82, 84, 500, 500, 134, 500, 62, 70, 500, 118, 46, 208, 500, 36, 60, 134, 60, 500, 66, 500, 500, 102, 114, 500, 52, 500, 100, 500, 48, 500, 90, 86]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43029286123413635, "mean_inference_ms": 1.3813746933246973, "mean_action_processing_ms": 0.1612141302338843, "mean_env_wait_ms": 0.09769054684424412, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018531084060668945, "StateBufferConnector_ms": 0.0070035457611083984, "ViewRequirementAgentConnector_ms": 0.14249205589294434}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.555999999999838, "episode_len_mean": 245.1, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 30.9, -50.00000000000044, 44.10000000000001, 43.7, 44.300000000000004, 29.69999999999998, -50.00000000000044, 27.899999999999956, 36.50000000000003, -50.00000000000044, 28.699999999999967, 43.10000000000001, 42.30000000000001, 28.29999999999996, 39.300000000000026, 46.5, 45.5, 47.3, 45.1, 41.30000000000001, 43.900000000000006, 25.699999999999925, 46.699999999999996, -50.00000000000044, -50.00000000000044, 46.699999999999996, 32.700000000000024, 44.5, -50.00000000000044, -50.00000000000044, 45.9, 0.6999999999995694, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 41.70000000000002, 44.7, -50.00000000000044, -50.00000000000044, 40.90000000000002, 41.70000000000002, 41.100000000000016, -50.00000000000044, 42.900000000000006, -50.00000000000044, 36.900000000000034, 7.699999999999669, -50.00000000000044, 42.10000000000001, -50.00000000000044, 41.70000000000002, 45.7, -50.00000000000044, 12.099999999999731, -50.00000000000044, 18.29999999999982, 43.900000000000006, -50.00000000000044, 44.5, 42.30000000000001, 16.699999999999797, 38.700000000000024, 43.900000000000006, 43.900000000000006, -50.00000000000044, -50.00000000000044, 41.90000000000001, 41.70000000000002, -50.00000000000044, -50.00000000000044, 36.70000000000003, -50.00000000000044, 43.900000000000006, 43.10000000000001, -50.00000000000044, 38.300000000000026, 45.5, 29.299999999999976, -50.00000000000044, 46.5, 44.10000000000001, 36.70000000000003, 44.10000000000001, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 39.90000000000002, 38.700000000000024, -50.00000000000044, 44.900000000000006, -50.00000000000044, 40.10000000000002, -50.00000000000044, 45.3, -50.00000000000044, 41.100000000000016, 41.500000000000014], "episode_lengths": [500, 192, 500, 60, 64, 58, 204, 500, 222, 136, 500, 214, 70, 78, 218, 108, 36, 46, 28, 50, 88, 62, 244, 34, 500, 500, 34, 174, 56, 500, 500, 42, 494, 500, 500, 40, 500, 84, 54, 500, 500, 92, 84, 90, 500, 72, 500, 132, 424, 500, 80, 500, 84, 44, 500, 380, 500, 318, 62, 500, 56, 78, 334, 114, 62, 62, 500, 500, 82, 84, 500, 500, 134, 500, 62, 70, 500, 118, 46, 208, 500, 36, 60, 134, 60, 500, 66, 500, 500, 102, 114, 500, 52, 500, 100, 500, 48, 500, 90, 86]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43029286123413635, "mean_inference_ms": 1.3813746933246973, "mean_action_processing_ms": 0.1612141302338843, "mean_env_wait_ms": 0.09769054684424412, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018531084060668945, "StateBufferConnector_ms": 0.0070035457611083984, "ViewRequirementAgentConnector_ms": 0.14249205589294434}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 378000, "num_agent_steps_trained": 378000, "num_env_steps_sampled": 378000, "num_env_steps_trained": 378000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4878.32261240274, "num_env_steps_trained_throughput_per_sec": 4878.32261240274, "timesteps_total": 378000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 378000, "timers": {"training_iteration_time_ms": 3620.068, "sample_time_ms": 3236.179, "load_time_ms": 19.704, "load_throughput": 913502.036, "learn_time_ms": 351.028, "learn_throughput": 51278.011, "synch_weights_time_ms": 10.223}, "counters": {"num_env_steps_sampled": 378000, "num_env_steps_trained": 378000, "num_agent_steps_sampled": 378000, "num_agent_steps_trained": 378000}, "done": false, "episodes_total": 1419, "training_iteration": 21, "trial_id": "9f288_00020", "date": "2023-10-25_17-13-05", "timestamp": 1698250385, "time_this_iter_s": 3.6957907676696777, "time_total_s": 75.8208384513855, "pid": 9936, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 75.8208384513855, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 74.97999999999999, "ram_util_percent": 26.919999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.536743164062502e-08, "cur_lr": 0.0003, "total_loss": 6.653530721311216, "policy_loss": -0.00028972731282313663, "vf_loss": 6.653879236291956, "vf_explained_var": 7.770679615162037e-07, "kl": 0.0005324638190510692, "entropy": 0.5864767255606474, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 581.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.833999999999856, "episode_len_mean": 232.34, "episode_media": {}, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.10000000000001, -50.00000000000044, 38.300000000000026, 45.5, 29.299999999999976, -50.00000000000044, 46.5, 44.10000000000001, 36.70000000000003, 44.10000000000001, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 39.90000000000002, 38.700000000000024, -50.00000000000044, 44.900000000000006, -50.00000000000044, 40.10000000000002, -50.00000000000044, 45.3, -50.00000000000044, 41.100000000000016, 41.500000000000014, -50.00000000000044, 40.30000000000002, 41.500000000000014, 23.099999999999888, -50.00000000000044, -50.00000000000044, 40.90000000000002, 43.900000000000006, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 21.89999999999987, 41.500000000000014, 37.10000000000003, 45.9, 43.30000000000001, 33.500000000000036, 44.900000000000006, 46.699999999999996, 46.699999999999996, 44.7, 46.099999999999994, 43.7, 47.1, -50.00000000000044, 33.30000000000003, 31.1, 42.70000000000001, 44.7, -50.00000000000044, 44.10000000000001, 37.70000000000003, 42.500000000000014, 45.9, 43.7, 11.499999999999723, -50.00000000000044, 43.50000000000001, -50.00000000000044, 44.5, 45.9, 41.500000000000014, 37.90000000000003, 33.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 44.900000000000006, 34.10000000000004, 15.299999999999777, 33.30000000000003, -50.00000000000044, 36.70000000000003, 45.1, 23.499999999999893, -50.00000000000044, 45.9, 43.7, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.8999999999999, 40.500000000000014, 26.299999999999933, 43.50000000000001, -50.00000000000044, 39.90000000000002, 31.70000000000001], "episode_lengths": [70, 500, 118, 46, 208, 500, 36, 60, 134, 60, 500, 66, 500, 500, 102, 114, 500, 52, 500, 100, 500, 48, 500, 90, 86, 500, 98, 86, 270, 500, 500, 92, 62, 500, 500, 42, 500, 282, 86, 130, 42, 68, 166, 52, 34, 34, 54, 40, 64, 30, 500, 168, 190, 74, 54, 500, 60, 124, 76, 42, 64, 386, 500, 66, 500, 56, 42, 86, 122, 166, 500, 500, 500, 500, 34, 52, 160, 348, 168, 500, 134, 50, 266, 500, 42, 64, 500, 70, 500, 500, 500, 500, 500, 262, 96, 238, 66, 500, 102, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.432501954095681, "mean_inference_ms": 1.3845360609138455, "mean_action_processing_ms": 0.16149623567859514, "mean_env_wait_ms": 0.09802488387809216, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03151750564575195, "StateBufferConnector_ms": 0.004995822906494141, "ViewRequirementAgentConnector_ms": 0.14276909828186035}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.833999999999856, "episode_len_mean": 232.34, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.10000000000001, -50.00000000000044, 38.300000000000026, 45.5, 29.299999999999976, -50.00000000000044, 46.5, 44.10000000000001, 36.70000000000003, 44.10000000000001, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 39.90000000000002, 38.700000000000024, -50.00000000000044, 44.900000000000006, -50.00000000000044, 40.10000000000002, -50.00000000000044, 45.3, -50.00000000000044, 41.100000000000016, 41.500000000000014, -50.00000000000044, 40.30000000000002, 41.500000000000014, 23.099999999999888, -50.00000000000044, -50.00000000000044, 40.90000000000002, 43.900000000000006, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 21.89999999999987, 41.500000000000014, 37.10000000000003, 45.9, 43.30000000000001, 33.500000000000036, 44.900000000000006, 46.699999999999996, 46.699999999999996, 44.7, 46.099999999999994, 43.7, 47.1, -50.00000000000044, 33.30000000000003, 31.1, 42.70000000000001, 44.7, -50.00000000000044, 44.10000000000001, 37.70000000000003, 42.500000000000014, 45.9, 43.7, 11.499999999999723, -50.00000000000044, 43.50000000000001, -50.00000000000044, 44.5, 45.9, 41.500000000000014, 37.90000000000003, 33.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 44.900000000000006, 34.10000000000004, 15.299999999999777, 33.30000000000003, -50.00000000000044, 36.70000000000003, 45.1, 23.499999999999893, -50.00000000000044, 45.9, 43.7, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.8999999999999, 40.500000000000014, 26.299999999999933, 43.50000000000001, -50.00000000000044, 39.90000000000002, 31.70000000000001], "episode_lengths": [70, 500, 118, 46, 208, 500, 36, 60, 134, 60, 500, 66, 500, 500, 102, 114, 500, 52, 500, 100, 500, 48, 500, 90, 86, 500, 98, 86, 270, 500, 500, 92, 62, 500, 500, 42, 500, 282, 86, 130, 42, 68, 166, 52, 34, 34, 54, 40, 64, 30, 500, 168, 190, 74, 54, 500, 60, 124, 76, 42, 64, 386, 500, 66, 500, 56, 42, 86, 122, 166, 500, 500, 500, 500, 34, 52, 160, 348, 168, 500, 134, 50, 266, 500, 42, 64, 500, 70, 500, 500, 500, 500, 500, 262, 96, 238, 66, 500, 102, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.432501954095681, "mean_inference_ms": 1.3845360609138455, "mean_action_processing_ms": 0.16149623567859514, "mean_env_wait_ms": 0.09802488387809216, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03151750564575195, "StateBufferConnector_ms": 0.004995822906494141, "ViewRequirementAgentConnector_ms": 0.14276909828186035}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4932.199390346676, "num_env_steps_trained_throughput_per_sec": 4932.199390346676, "timesteps_total": 396000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 396000, "timers": {"training_iteration_time_ms": 3631.236, "sample_time_ms": 3248.547, "load_time_ms": 20.202, "load_throughput": 891003.303, "learn_time_ms": 349.432, "learn_throughput": 51512.099, "synch_weights_time_ms": 10.022}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "done": false, "episodes_total": 1494, "training_iteration": 22, "trial_id": "9f288_00020", "date": "2023-10-25_17-13-08", "timestamp": 1698250388, "time_this_iter_s": 3.6555206775665283, "time_total_s": 79.47635912895203, "pid": 9936, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 79.47635912895203, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 70.4, "ram_util_percent": 26.919999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.768371582031251e-08, "cur_lr": 0.0003, "total_loss": 6.92435179816352, "policy_loss": -3.1404559397035176e-05, "vf_loss": 6.924437911422165, "vf_explained_var": -1.4790782222041377e-07, "kl": 0.00014221208962057803, "entropy": 0.5465181525106784, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 608.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 414000, "num_env_steps_trained": 414000, "num_agent_steps_sampled": 414000, "num_agent_steps_trained": 414000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.39799999999983, "episode_len_mean": 256.68, "episode_media": {}, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.699999999999996, 44.900000000000006, 34.10000000000004, 15.299999999999777, 33.30000000000003, -50.00000000000044, 36.70000000000003, 45.1, 23.499999999999893, -50.00000000000044, 45.9, 43.7, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.8999999999999, 40.500000000000014, 26.299999999999933, 43.50000000000001, -50.00000000000044, 39.90000000000002, 31.70000000000001, 39.90000000000002, -50.00000000000044, -50.00000000000044, 42.70000000000001, 42.70000000000001, 39.50000000000002, 45.5, -50.00000000000044, 43.900000000000006, 8.699999999999683, -50.00000000000044, 38.700000000000024, 42.10000000000001, -50.00000000000044, -50.00000000000044, 29.099999999999973, 42.70000000000001, 46.099999999999994, -50.00000000000044, 16.8999999999998, 30.099999999999987, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.500000000000007, 40.30000000000002, 17.499999999999808, 1.299999999999578, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 3.499999999999609, 42.70000000000001, -50.00000000000044, -50.00000000000044, 32.700000000000024, -50.00000000000044, 36.30000000000003, 25.699999999999925, 45.7, 44.5, 45.5, -50.00000000000044, 44.5, 44.300000000000004, 36.10000000000004, -50.00000000000044, 46.3, -50.00000000000044, 45.1, 46.099999999999994, 40.500000000000014, 45.5, 46.099999999999994, -50.00000000000044, 41.30000000000001, 46.9, -50.00000000000044, 22.299999999999876, 40.90000000000002, 44.10000000000001, 45.1, 43.50000000000001, 41.100000000000016, -50.00000000000044, 46.099999999999994, 42.900000000000006, 43.30000000000001, 7.699999999999669], "episode_lengths": [500, 34, 52, 160, 348, 168, 500, 134, 50, 266, 500, 42, 64, 500, 70, 500, 500, 500, 500, 500, 262, 96, 238, 66, 500, 102, 184, 102, 500, 500, 74, 74, 106, 46, 500, 62, 414, 500, 114, 80, 500, 500, 210, 74, 40, 500, 332, 200, 500, 500, 500, 500, 186, 98, 326, 488, 500, 64, 500, 500, 76, 500, 466, 74, 500, 500, 174, 500, 138, 244, 44, 56, 46, 500, 56, 58, 140, 500, 38, 500, 50, 40, 96, 46, 40, 500, 88, 32, 500, 278, 92, 60, 50, 66, 90, 500, 40, 72, 68, 424]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43233004474322156, "mean_inference_ms": 1.388687352988619, "mean_action_processing_ms": 0.16129084795588658, "mean_env_wait_ms": 0.09833720028433725, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02798771858215332, "StateBufferConnector_ms": 0.01400303840637207, "ViewRequirementAgentConnector_ms": 0.1470661163330078}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.39799999999983, "episode_len_mean": 256.68, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.699999999999996, 44.900000000000006, 34.10000000000004, 15.299999999999777, 33.30000000000003, -50.00000000000044, 36.70000000000003, 45.1, 23.499999999999893, -50.00000000000044, 45.9, 43.7, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.8999999999999, 40.500000000000014, 26.299999999999933, 43.50000000000001, -50.00000000000044, 39.90000000000002, 31.70000000000001, 39.90000000000002, -50.00000000000044, -50.00000000000044, 42.70000000000001, 42.70000000000001, 39.50000000000002, 45.5, -50.00000000000044, 43.900000000000006, 8.699999999999683, -50.00000000000044, 38.700000000000024, 42.10000000000001, -50.00000000000044, -50.00000000000044, 29.099999999999973, 42.70000000000001, 46.099999999999994, -50.00000000000044, 16.8999999999998, 30.099999999999987, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.500000000000007, 40.30000000000002, 17.499999999999808, 1.299999999999578, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 3.499999999999609, 42.70000000000001, -50.00000000000044, -50.00000000000044, 32.700000000000024, -50.00000000000044, 36.30000000000003, 25.699999999999925, 45.7, 44.5, 45.5, -50.00000000000044, 44.5, 44.300000000000004, 36.10000000000004, -50.00000000000044, 46.3, -50.00000000000044, 45.1, 46.099999999999994, 40.500000000000014, 45.5, 46.099999999999994, -50.00000000000044, 41.30000000000001, 46.9, -50.00000000000044, 22.299999999999876, 40.90000000000002, 44.10000000000001, 45.1, 43.50000000000001, 41.100000000000016, -50.00000000000044, 46.099999999999994, 42.900000000000006, 43.30000000000001, 7.699999999999669], "episode_lengths": [500, 34, 52, 160, 348, 168, 500, 134, 50, 266, 500, 42, 64, 500, 70, 500, 500, 500, 500, 500, 262, 96, 238, 66, 500, 102, 184, 102, 500, 500, 74, 74, 106, 46, 500, 62, 414, 500, 114, 80, 500, 500, 210, 74, 40, 500, 332, 200, 500, 500, 500, 500, 186, 98, 326, 488, 500, 64, 500, 500, 76, 500, 466, 74, 500, 500, 174, 500, 138, 244, 44, 56, 46, 500, 56, 58, 140, 500, 38, 500, 50, 40, 96, 46, 40, 500, 88, 32, 500, 278, 92, 60, 50, 66, 90, 500, 40, 72, 68, 424]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43233004474322156, "mean_inference_ms": 1.388687352988619, "mean_action_processing_ms": 0.16129084795588658, "mean_env_wait_ms": 0.09833720028433725, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02798771858215332, "StateBufferConnector_ms": 0.01400303840637207, "ViewRequirementAgentConnector_ms": 0.1470661163330078}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 414000, "num_agent_steps_trained": 414000, "num_env_steps_sampled": 414000, "num_env_steps_trained": 414000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4448.545807119915, "num_env_steps_trained_throughput_per_sec": 4448.545807119915, "timesteps_total": 414000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 414000, "timers": {"training_iteration_time_ms": 3671.947, "sample_time_ms": 3283.893, "load_time_ms": 21.614, "load_throughput": 832790.681, "learn_time_ms": 353.246, "learn_throughput": 50956.033, "synch_weights_time_ms": 10.074}, "counters": {"num_env_steps_sampled": 414000, "num_env_steps_trained": 414000, "num_agent_steps_sampled": 414000, "num_agent_steps_trained": 414000}, "done": false, "episodes_total": 1567, "training_iteration": 23, "trial_id": "9f288_00020", "date": "2023-10-25_17-13-12", "timestamp": 1698250392, "time_this_iter_s": 4.05227518081665, "time_total_s": 83.52863430976868, "pid": 9936, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 83.52863430976868, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 66.48333333333335, "ram_util_percent": 26.916666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.3841857910156255e-08, "cur_lr": 0.0003, "total_loss": 6.767019095244231, "policy_loss": -0.00031643381549252407, "vf_loss": 6.767388732345016, "vf_explained_var": -4.3268556948061344e-07, "kl": 0.0006038284968781227, "entropy": 0.5329654426486404, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 635.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 14.942999999999863, "episode_len_mean": 216.3, "episode_media": {}, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.5, 44.300000000000004, 36.10000000000004, -50.00000000000044, 46.3, -50.00000000000044, 45.1, 46.099999999999994, 40.500000000000014, 45.5, 46.099999999999994, -50.00000000000044, 41.30000000000001, 46.9, -50.00000000000044, 22.299999999999876, 40.90000000000002, 44.10000000000001, 45.1, 43.50000000000001, 41.100000000000016, -50.00000000000044, 46.099999999999994, 42.900000000000006, 43.30000000000001, 7.699999999999669, 9.099999999999689, -50.00000000000044, 42.70000000000001, -50.00000000000044, 44.5, 44.900000000000006, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, 39.90000000000002, 44.7, 46.099999999999994, 42.30000000000001, 45.3, -50.00000000000044, -50.00000000000044, 44.900000000000006, 33.90000000000004, 26.299999999999933, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 42.70000000000001, -50.00000000000044, 27.299999999999947, 44.300000000000004, -50.00000000000044, -50.00000000000044, 15.899999999999785, 43.50000000000001, 41.100000000000016, -50.00000000000044, 36.900000000000034, 47.1, 44.300000000000004, 40.70000000000002, 44.7, 44.900000000000006, 35.900000000000034, -50.00000000000044, 41.500000000000014, -50.00000000000044, 46.099999999999994, 45.9, 45.7, -50.00000000000044, 43.10000000000001, 44.7, 40.90000000000002, 41.100000000000016, -50.00000000000044, 24.299999999999905, -50.00000000000044, 0.49999999999956657, 26.69999999999994, 42.30000000000001, 47.1, 37.10000000000003, 32.90000000000003, 35.30000000000004, 17.69999999999981, 41.90000000000001, 45.5, -50.00000000000044, -50.00000000000044, 45.3, 0.49999999999956657, 43.50000000000001, -50.00000000000044, 44.7, 47.3], "episode_lengths": [56, 58, 140, 500, 38, 500, 50, 40, 96, 46, 40, 500, 88, 32, 500, 278, 92, 60, 50, 66, 90, 500, 40, 72, 68, 424, 410, 500, 74, 500, 56, 52, 500, 500, 98, 500, 102, 54, 40, 78, 48, 500, 500, 52, 162, 238, 64, 500, 500, 500, 50, 74, 500, 228, 58, 500, 500, 342, 66, 90, 500, 132, 30, 58, 94, 54, 52, 142, 500, 86, 500, 40, 42, 44, 500, 70, 54, 92, 90, 500, 258, 500, 496, 234, 78, 30, 130, 172, 148, 324, 82, 46, 500, 500, 48, 496, 66, 500, 54, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4327587343434894, "mean_inference_ms": 1.388597496533522, "mean_action_processing_ms": 0.16138047188840599, "mean_env_wait_ms": 0.09826020149243389, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02863001823425293, "StateBufferConnector_ms": 0.010931968688964844, "ViewRequirementAgentConnector_ms": 0.13640594482421875}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 14.942999999999863, "episode_len_mean": 216.3, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.5, 44.300000000000004, 36.10000000000004, -50.00000000000044, 46.3, -50.00000000000044, 45.1, 46.099999999999994, 40.500000000000014, 45.5, 46.099999999999994, -50.00000000000044, 41.30000000000001, 46.9, -50.00000000000044, 22.299999999999876, 40.90000000000002, 44.10000000000001, 45.1, 43.50000000000001, 41.100000000000016, -50.00000000000044, 46.099999999999994, 42.900000000000006, 43.30000000000001, 7.699999999999669, 9.099999999999689, -50.00000000000044, 42.70000000000001, -50.00000000000044, 44.5, 44.900000000000006, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, 39.90000000000002, 44.7, 46.099999999999994, 42.30000000000001, 45.3, -50.00000000000044, -50.00000000000044, 44.900000000000006, 33.90000000000004, 26.299999999999933, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 42.70000000000001, -50.00000000000044, 27.299999999999947, 44.300000000000004, -50.00000000000044, -50.00000000000044, 15.899999999999785, 43.50000000000001, 41.100000000000016, -50.00000000000044, 36.900000000000034, 47.1, 44.300000000000004, 40.70000000000002, 44.7, 44.900000000000006, 35.900000000000034, -50.00000000000044, 41.500000000000014, -50.00000000000044, 46.099999999999994, 45.9, 45.7, -50.00000000000044, 43.10000000000001, 44.7, 40.90000000000002, 41.100000000000016, -50.00000000000044, 24.299999999999905, -50.00000000000044, 0.49999999999956657, 26.69999999999994, 42.30000000000001, 47.1, 37.10000000000003, 32.90000000000003, 35.30000000000004, 17.69999999999981, 41.90000000000001, 45.5, -50.00000000000044, -50.00000000000044, 45.3, 0.49999999999956657, 43.50000000000001, -50.00000000000044, 44.7, 47.3], "episode_lengths": [56, 58, 140, 500, 38, 500, 50, 40, 96, 46, 40, 500, 88, 32, 500, 278, 92, 60, 50, 66, 90, 500, 40, 72, 68, 424, 410, 500, 74, 500, 56, 52, 500, 500, 98, 500, 102, 54, 40, 78, 48, 500, 500, 52, 162, 238, 64, 500, 500, 500, 50, 74, 500, 228, 58, 500, 500, 342, 66, 90, 500, 132, 30, 58, 94, 54, 52, 142, 500, 86, 500, 40, 42, 44, 500, 70, 54, 92, 90, 500, 258, 500, 496, 234, 78, 30, 130, 172, 148, 324, 82, 46, 500, 500, 48, 496, 66, 500, 54, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4327587343434894, "mean_inference_ms": 1.388597496533522, "mean_action_processing_ms": 0.16138047188840599, "mean_env_wait_ms": 0.09826020149243389, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02863001823425293, "StateBufferConnector_ms": 0.010931968688964844, "ViewRequirementAgentConnector_ms": 0.13640594482421875}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4962.160582602135, "num_env_steps_trained_throughput_per_sec": 4962.160582602135, "timesteps_total": 432000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 432000, "timers": {"training_iteration_time_ms": 3634.466, "sample_time_ms": 3249.877, "load_time_ms": 19.805, "load_throughput": 908875.521, "learn_time_ms": 351.579, "learn_throughput": 51197.538, "synch_weights_time_ms": 10.176}, "counters": {"num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "done": false, "episodes_total": 1641, "training_iteration": 24, "trial_id": "9f288_00020", "date": "2023-10-25_17-13-16", "timestamp": 1698250396, "time_this_iter_s": 3.6334471702575684, "time_total_s": 87.16208148002625, "pid": 9936, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 87.16208148002625, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 70.47999999999999, "ram_util_percent": 26.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1920928955078127e-08, "cur_lr": 0.0003, "total_loss": 6.645457956526014, "policy_loss": -0.00033551123407151963, "vf_loss": 6.645843735447636, "vf_explained_var": -1.8874804178873699e-06, "kl": 0.0008250584624807676, "entropy": 0.5027501417530907, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 662.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 450000, "num_env_steps_trained": 450000, "num_agent_steps_sampled": 450000, "num_agent_steps_trained": 450000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.022999999999849, "episode_len_mean": 235.48, "episode_media": {}, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.10000000000001, 44.7, 40.90000000000002, 41.100000000000016, -50.00000000000044, 24.299999999999905, -50.00000000000044, 0.49999999999956657, 26.69999999999994, 42.30000000000001, 47.1, 37.10000000000003, 32.90000000000003, 35.30000000000004, 17.69999999999981, 41.90000000000001, 45.5, -50.00000000000044, -50.00000000000044, 45.3, 0.49999999999956657, 43.50000000000001, -50.00000000000044, 44.7, 47.3, 21.499999999999865, -50.00000000000044, -50.00000000000044, 45.5, 43.30000000000001, 37.70000000000003, 44.300000000000004, -50.00000000000044, 44.5, 44.300000000000004, 27.699999999999953, -50.00000000000044, 41.90000000000001, -50.00000000000044, 42.10000000000001, 45.9, 43.30000000000001, -50.00000000000044, 29.69999999999998, 47.1, 42.500000000000014, 45.5, 42.30000000000001, 46.5, -50.00000000000044, 34.50000000000004, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.89999999999997, 41.100000000000016, -50.00000000000044, -50.00000000000044, 33.10000000000003, 28.89999999999997, 47.3, 46.699999999999996, 20.899999999999856, 2.299999999999592, 43.10000000000001, 42.900000000000006, 46.5, -50.00000000000044, 44.5, 43.50000000000001, 23.099999999999888, 46.5, -50.00000000000044, 46.5, 39.90000000000002, -50.00000000000044, 44.5, 46.099999999999994, -50.00000000000044, -50.00000000000044, 33.30000000000003, 43.30000000000001, -50.00000000000044, 32.90000000000003, 37.70000000000003, -50.00000000000044, 20.699999999999854, 38.700000000000024, -50.00000000000044, 36.900000000000034, 38.300000000000026, 23.099999999999888, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 21.499999999999865, 43.50000000000001], "episode_lengths": [70, 54, 92, 90, 500, 258, 500, 496, 234, 78, 30, 130, 172, 148, 324, 82, 46, 500, 500, 48, 496, 66, 500, 54, 28, 286, 500, 500, 46, 68, 124, 58, 500, 56, 58, 224, 500, 82, 500, 80, 42, 68, 500, 204, 30, 76, 46, 78, 36, 500, 156, 36, 500, 500, 500, 500, 212, 90, 500, 500, 170, 212, 28, 34, 292, 478, 70, 72, 36, 500, 56, 66, 270, 36, 500, 36, 102, 500, 56, 40, 500, 500, 168, 68, 500, 172, 124, 500, 294, 114, 500, 132, 118, 270, 500, 500, 30, 500, 286, 66]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43392986323722127, "mean_inference_ms": 1.3894462482484895, "mean_action_processing_ms": 0.1618932164593142, "mean_env_wait_ms": 0.0980947506638398, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02255392074584961, "StateBufferConnector_ms": 0.009929895401000977, "ViewRequirementAgentConnector_ms": 0.14691686630249023}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.022999999999849, "episode_len_mean": 235.48, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.10000000000001, 44.7, 40.90000000000002, 41.100000000000016, -50.00000000000044, 24.299999999999905, -50.00000000000044, 0.49999999999956657, 26.69999999999994, 42.30000000000001, 47.1, 37.10000000000003, 32.90000000000003, 35.30000000000004, 17.69999999999981, 41.90000000000001, 45.5, -50.00000000000044, -50.00000000000044, 45.3, 0.49999999999956657, 43.50000000000001, -50.00000000000044, 44.7, 47.3, 21.499999999999865, -50.00000000000044, -50.00000000000044, 45.5, 43.30000000000001, 37.70000000000003, 44.300000000000004, -50.00000000000044, 44.5, 44.300000000000004, 27.699999999999953, -50.00000000000044, 41.90000000000001, -50.00000000000044, 42.10000000000001, 45.9, 43.30000000000001, -50.00000000000044, 29.69999999999998, 47.1, 42.500000000000014, 45.5, 42.30000000000001, 46.5, -50.00000000000044, 34.50000000000004, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.89999999999997, 41.100000000000016, -50.00000000000044, -50.00000000000044, 33.10000000000003, 28.89999999999997, 47.3, 46.699999999999996, 20.899999999999856, 2.299999999999592, 43.10000000000001, 42.900000000000006, 46.5, -50.00000000000044, 44.5, 43.50000000000001, 23.099999999999888, 46.5, -50.00000000000044, 46.5, 39.90000000000002, -50.00000000000044, 44.5, 46.099999999999994, -50.00000000000044, -50.00000000000044, 33.30000000000003, 43.30000000000001, -50.00000000000044, 32.90000000000003, 37.70000000000003, -50.00000000000044, 20.699999999999854, 38.700000000000024, -50.00000000000044, 36.900000000000034, 38.300000000000026, 23.099999999999888, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 21.499999999999865, 43.50000000000001], "episode_lengths": [70, 54, 92, 90, 500, 258, 500, 496, 234, 78, 30, 130, 172, 148, 324, 82, 46, 500, 500, 48, 496, 66, 500, 54, 28, 286, 500, 500, 46, 68, 124, 58, 500, 56, 58, 224, 500, 82, 500, 80, 42, 68, 500, 204, 30, 76, 46, 78, 36, 500, 156, 36, 500, 500, 500, 500, 212, 90, 500, 500, 170, 212, 28, 34, 292, 478, 70, 72, 36, 500, 56, 66, 270, 36, 500, 36, 102, 500, 56, 40, 500, 500, 168, 68, 500, 172, 124, 500, 294, 114, 500, 132, 118, 270, 500, 500, 30, 500, 286, 66]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43392986323722127, "mean_inference_ms": 1.3894462482484895, "mean_action_processing_ms": 0.1618932164593142, "mean_env_wait_ms": 0.0980947506638398, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02255392074584961, "StateBufferConnector_ms": 0.009929895401000977, "ViewRequirementAgentConnector_ms": 0.14691686630249023}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 450000, "num_agent_steps_trained": 450000, "num_env_steps_sampled": 450000, "num_env_steps_trained": 450000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4839.906680910359, "num_env_steps_trained_throughput_per_sec": 4839.906680910359, "timesteps_total": 450000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 450000, "timers": {"training_iteration_time_ms": 3652.956, "sample_time_ms": 3270.372, "load_time_ms": 19.703, "load_throughput": 913553.989, "learn_time_ms": 349.644, "learn_throughput": 51480.904, "synch_weights_time_ms": 10.307}, "counters": {"num_env_steps_sampled": 450000, "num_env_steps_trained": 450000, "num_agent_steps_sampled": 450000, "num_agent_steps_trained": 450000}, "done": false, "episodes_total": 1716, "training_iteration": 25, "trial_id": "9f288_00020", "date": "2023-10-25_17-13-20", "timestamp": 1698250400, "time_this_iter_s": 3.7250735759735107, "time_total_s": 90.88715505599976, "pid": 9936, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 90.88715505599976, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 73.32000000000001, "ram_util_percent": 26.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.960464477539064e-09, "cur_lr": 0.0003, "total_loss": 7.342996350041142, "policy_loss": -0.00010288244596234074, "vf_loss": 7.3431520815248845, "vf_explained_var": -6.843496251989294e-07, "kl": 0.00026260179682226063, "entropy": 0.5284831038227787, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 689.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.018999999999828, "episode_len_mean": 255.48, "episode_media": {}, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.90000000000002, -50.00000000000044, 44.5, 46.099999999999994, -50.00000000000044, -50.00000000000044, 33.30000000000003, 43.30000000000001, -50.00000000000044, 32.90000000000003, 37.70000000000003, -50.00000000000044, 20.699999999999854, 38.700000000000024, -50.00000000000044, 36.900000000000034, 38.300000000000026, 23.099999999999888, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 21.499999999999865, 43.50000000000001, 41.500000000000014, 42.500000000000014, -50.00000000000044, -50.00000000000044, 44.10000000000001, 43.7, 31.1, -50.00000000000044, 46.699999999999996, 38.10000000000002, 11.699999999999726, -50.00000000000044, 40.70000000000002, 35.30000000000004, 45.1, 46.3, -50.00000000000044, 43.900000000000006, 43.7, 29.099999999999973, -50.00000000000044, 43.900000000000006, 44.5, -50.00000000000044, 21.699999999999868, 32.700000000000024, 40.30000000000002, 44.900000000000006, 44.5, -50.00000000000044, -50.00000000000044, 47.5, 44.10000000000001, 43.900000000000006, -50.00000000000044, 12.099999999999731, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 6.299999999999649, 16.8999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.699999999999996, -50.00000000000044, 45.7, 43.7, 47.3, 37.90000000000003, 9.499999999999694, 47.3, 43.7, 11.099999999999717, 44.10000000000001, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, 44.900000000000006, -50.00000000000044, 43.7, -50.00000000000044, 10.699999999999712, 46.9, 39.300000000000026, -50.00000000000044, 45.3, 42.10000000000001, 45.9, 7.299999999999663, 31.900000000000013, 27.899999999999956], "episode_lengths": [102, 500, 56, 40, 500, 500, 168, 68, 500, 172, 124, 500, 294, 114, 500, 132, 118, 270, 500, 500, 30, 500, 286, 66, 86, 76, 500, 500, 60, 64, 190, 500, 34, 120, 384, 500, 94, 148, 50, 38, 500, 62, 64, 210, 500, 62, 56, 500, 284, 174, 98, 52, 56, 500, 500, 26, 60, 62, 500, 380, 52, 500, 500, 500, 500, 64, 438, 332, 500, 500, 500, 194, 500, 44, 64, 28, 122, 406, 28, 64, 390, 60, 500, 500, 80, 500, 52, 500, 64, 500, 394, 32, 108, 500, 48, 80, 42, 428, 182, 222]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43290380544415114, "mean_inference_ms": 1.3887760346070428, "mean_action_processing_ms": 0.1617473109547628, "mean_env_wait_ms": 0.09819357707645444, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021672725677490234, "StateBufferConnector_ms": 0.003000020980834961, "ViewRequirementAgentConnector_ms": 0.155623197555542}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.018999999999828, "episode_len_mean": 255.48, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [39.90000000000002, -50.00000000000044, 44.5, 46.099999999999994, -50.00000000000044, -50.00000000000044, 33.30000000000003, 43.30000000000001, -50.00000000000044, 32.90000000000003, 37.70000000000003, -50.00000000000044, 20.699999999999854, 38.700000000000024, -50.00000000000044, 36.900000000000034, 38.300000000000026, 23.099999999999888, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 21.499999999999865, 43.50000000000001, 41.500000000000014, 42.500000000000014, -50.00000000000044, -50.00000000000044, 44.10000000000001, 43.7, 31.1, -50.00000000000044, 46.699999999999996, 38.10000000000002, 11.699999999999726, -50.00000000000044, 40.70000000000002, 35.30000000000004, 45.1, 46.3, -50.00000000000044, 43.900000000000006, 43.7, 29.099999999999973, -50.00000000000044, 43.900000000000006, 44.5, -50.00000000000044, 21.699999999999868, 32.700000000000024, 40.30000000000002, 44.900000000000006, 44.5, -50.00000000000044, -50.00000000000044, 47.5, 44.10000000000001, 43.900000000000006, -50.00000000000044, 12.099999999999731, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 6.299999999999649, 16.8999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.699999999999996, -50.00000000000044, 45.7, 43.7, 47.3, 37.90000000000003, 9.499999999999694, 47.3, 43.7, 11.099999999999717, 44.10000000000001, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, 44.900000000000006, -50.00000000000044, 43.7, -50.00000000000044, 10.699999999999712, 46.9, 39.300000000000026, -50.00000000000044, 45.3, 42.10000000000001, 45.9, 7.299999999999663, 31.900000000000013, 27.899999999999956], "episode_lengths": [102, 500, 56, 40, 500, 500, 168, 68, 500, 172, 124, 500, 294, 114, 500, 132, 118, 270, 500, 500, 30, 500, 286, 66, 86, 76, 500, 500, 60, 64, 190, 500, 34, 120, 384, 500, 94, 148, 50, 38, 500, 62, 64, 210, 500, 62, 56, 500, 284, 174, 98, 52, 56, 500, 500, 26, 60, 62, 500, 380, 52, 500, 500, 500, 500, 64, 438, 332, 500, 500, 500, 194, 500, 44, 64, 28, 122, 406, 28, 64, 390, 60, 500, 500, 80, 500, 52, 500, 64, 500, 394, 32, 108, 500, 48, 80, 42, 428, 182, 222]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43290380544415114, "mean_inference_ms": 1.3887760346070428, "mean_action_processing_ms": 0.1617473109547628, "mean_env_wait_ms": 0.09819357707645444, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021672725677490234, "StateBufferConnector_ms": 0.003000020980834961, "ViewRequirementAgentConnector_ms": 0.155623197555542}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5102.950367853932, "num_env_steps_trained_throughput_per_sec": 5102.950367853932, "timesteps_total": 468000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 468000, "timers": {"training_iteration_time_ms": 3650.801, "sample_time_ms": 3270.675, "load_time_ms": 17.947, "load_throughput": 1002936.804, "learn_time_ms": 348.94, "learn_throughput": 51584.872, "synch_weights_time_ms": 10.416}, "counters": {"num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000}, "done": false, "episodes_total": 1792, "training_iteration": 26, "trial_id": "9f288_00020", "date": "2023-10-25_17-13-23", "timestamp": 1698250403, "time_this_iter_s": 3.5333635807037354, "time_total_s": 94.42051863670349, "pid": 9936, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 94.42051863670349, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 66.2, "ram_util_percent": 26.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.980232238769532e-09, "cur_lr": 0.0003, "total_loss": 6.446987364027235, "policy_loss": -0.00019867932079014954, "vf_loss": 6.4472362553631815, "vf_explained_var": -3.156838593659578e-07, "kl": 0.0004708330590203871, "entropy": 0.5026108501134096, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 716.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 486000, "num_env_steps_trained": 486000, "num_agent_steps_sampled": 486000, "num_agent_steps_trained": 486000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.637999999999821, "episode_len_mean": 264.26, "episode_media": {}, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.299999999999649, 16.8999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.699999999999996, -50.00000000000044, 45.7, 43.7, 47.3, 37.90000000000003, 9.499999999999694, 47.3, 43.7, 11.099999999999717, 44.10000000000001, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, 44.900000000000006, -50.00000000000044, 43.7, -50.00000000000044, 10.699999999999712, 46.9, 39.300000000000026, -50.00000000000044, 45.3, 42.10000000000001, 45.9, 7.299999999999663, 31.900000000000013, 27.899999999999956, 40.90000000000002, 44.10000000000001, -50.00000000000044, 43.900000000000006, -50.00000000000044, 39.70000000000002, 27.699999999999953, -50.00000000000044, 33.90000000000004, -50.00000000000044, 43.50000000000001, -50.00000000000044, 45.7, -50.00000000000044, 33.30000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.499999999999993, -50.00000000000044, 40.70000000000002, -50.00000000000044, 46.5, 44.300000000000004, 36.900000000000034, 43.900000000000006, 32.700000000000024, 38.90000000000002, -50.00000000000044, -50.00000000000044, 45.1, 30.699999999999996, -50.00000000000044, 43.50000000000001, 43.900000000000006, -50.00000000000044, 31.1, 15.299999999999777, 43.10000000000001, 10.699999999999712, 43.30000000000001, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 35.500000000000036, 44.10000000000001, 44.900000000000006, 45.3, -50.00000000000044, -50.00000000000044, 45.1, 47.5, -50.00000000000044, 35.10000000000004, 43.50000000000001, 45.3, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, -50.00000000000044, 45.7, 15.699999999999783, -50.00000000000044], "episode_lengths": [438, 332, 500, 500, 500, 194, 500, 44, 64, 28, 122, 406, 28, 64, 390, 60, 500, 500, 80, 500, 52, 500, 64, 500, 394, 32, 108, 500, 48, 80, 42, 428, 182, 222, 92, 60, 500, 62, 500, 104, 224, 500, 162, 500, 66, 500, 44, 500, 168, 500, 500, 500, 196, 500, 94, 500, 36, 58, 132, 62, 174, 112, 500, 500, 50, 194, 500, 66, 62, 500, 190, 348, 70, 394, 68, 500, 500, 44, 500, 146, 60, 52, 48, 500, 500, 50, 26, 500, 150, 66, 48, 48, 500, 500, 500, 110, 500, 44, 344, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4330453101986598, "mean_inference_ms": 1.3891687974062494, "mean_action_processing_ms": 0.16187011392493994, "mean_env_wait_ms": 0.09835859401650518, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027544498443603516, "StateBufferConnector_ms": 0.007996559143066406, "ViewRequirementAgentConnector_ms": 0.14081192016601562}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.637999999999821, "episode_len_mean": 264.26, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.299999999999649, 16.8999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.699999999999996, -50.00000000000044, 45.7, 43.7, 47.3, 37.90000000000003, 9.499999999999694, 47.3, 43.7, 11.099999999999717, 44.10000000000001, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, 44.900000000000006, -50.00000000000044, 43.7, -50.00000000000044, 10.699999999999712, 46.9, 39.300000000000026, -50.00000000000044, 45.3, 42.10000000000001, 45.9, 7.299999999999663, 31.900000000000013, 27.899999999999956, 40.90000000000002, 44.10000000000001, -50.00000000000044, 43.900000000000006, -50.00000000000044, 39.70000000000002, 27.699999999999953, -50.00000000000044, 33.90000000000004, -50.00000000000044, 43.50000000000001, -50.00000000000044, 45.7, -50.00000000000044, 33.30000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.499999999999993, -50.00000000000044, 40.70000000000002, -50.00000000000044, 46.5, 44.300000000000004, 36.900000000000034, 43.900000000000006, 32.700000000000024, 38.90000000000002, -50.00000000000044, -50.00000000000044, 45.1, 30.699999999999996, -50.00000000000044, 43.50000000000001, 43.900000000000006, -50.00000000000044, 31.1, 15.299999999999777, 43.10000000000001, 10.699999999999712, 43.30000000000001, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 35.500000000000036, 44.10000000000001, 44.900000000000006, 45.3, -50.00000000000044, -50.00000000000044, 45.1, 47.5, -50.00000000000044, 35.10000000000004, 43.50000000000001, 45.3, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, -50.00000000000044, 45.7, 15.699999999999783, -50.00000000000044], "episode_lengths": [438, 332, 500, 500, 500, 194, 500, 44, 64, 28, 122, 406, 28, 64, 390, 60, 500, 500, 80, 500, 52, 500, 64, 500, 394, 32, 108, 500, 48, 80, 42, 428, 182, 222, 92, 60, 500, 62, 500, 104, 224, 500, 162, 500, 66, 500, 44, 500, 168, 500, 500, 500, 196, 500, 94, 500, 36, 58, 132, 62, 174, 112, 500, 500, 50, 194, 500, 66, 62, 500, 190, 348, 70, 394, 68, 500, 500, 44, 500, 146, 60, 52, 48, 500, 500, 50, 26, 500, 150, 66, 48, 48, 500, 500, 500, 110, 500, 44, 344, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4330453101986598, "mean_inference_ms": 1.3891687974062494, "mean_action_processing_ms": 0.16187011392493994, "mean_env_wait_ms": 0.09835859401650518, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027544498443603516, "StateBufferConnector_ms": 0.007996559143066406, "ViewRequirementAgentConnector_ms": 0.14081192016601562}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 486000, "num_agent_steps_trained": 486000, "num_env_steps_sampled": 486000, "num_env_steps_trained": 486000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4706.807624585421, "num_env_steps_trained_throughput_per_sec": 4706.807624585421, "timesteps_total": 486000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 486000, "timers": {"training_iteration_time_ms": 3679.758, "sample_time_ms": 3300.366, "load_time_ms": 19.729, "load_throughput": 912382.619, "learn_time_ms": 346.562, "learn_throughput": 51938.829, "synch_weights_time_ms": 10.378}, "counters": {"num_env_steps_sampled": 486000, "num_env_steps_trained": 486000, "num_agent_steps_sampled": 486000, "num_agent_steps_trained": 486000}, "done": false, "episodes_total": 1858, "training_iteration": 27, "trial_id": "9f288_00020", "date": "2023-10-25_17-13-27", "timestamp": 1698250407, "time_this_iter_s": 3.829259157180786, "time_total_s": 98.24977779388428, "pid": 9936, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 98.24977779388428, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 62.53333333333333, "ram_util_percent": 27.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.490116119384766e-09, "cur_lr": 0.0003, "total_loss": 6.607932797184697, "policy_loss": -0.0001533633029019391, "vf_loss": 6.608140097724067, "vf_explained_var": -1.545305605287905e-08, "kl": 0.0005001435002630164, "entropy": 0.5397531666137554, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 743.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.883999999999826, "episode_len_mean": 261.78, "episode_media": {}, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 31.1, 15.299999999999777, 43.10000000000001, 10.699999999999712, 43.30000000000001, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 35.500000000000036, 44.10000000000001, 44.900000000000006, 45.3, -50.00000000000044, -50.00000000000044, 45.1, 47.5, -50.00000000000044, 35.10000000000004, 43.50000000000001, 45.3, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, -50.00000000000044, 45.7, 15.699999999999783, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 45.5, -50.00000000000044, -50.00000000000044, 29.49999999999998, 40.30000000000002, 40.500000000000014, 26.69999999999994, 34.900000000000034, 41.100000000000016, 42.900000000000006, -50.00000000000044, 30.099999999999987, 25.899999999999928, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, 38.90000000000002, 31.1, 43.50000000000001, 31.900000000000013, 39.90000000000002, 43.10000000000001, 46.099999999999994, -50.00000000000044, 25.699999999999925, 29.69999999999998, 18.499999999999822, -50.00000000000044, 47.1, 45.7, 36.900000000000034, 44.900000000000006, 36.10000000000004, 31.70000000000001, 43.10000000000001, -50.00000000000044, 43.7, -50.00000000000044, 47.7, -50.00000000000044, 43.30000000000001, 34.30000000000004, 38.700000000000024, -50.00000000000044, -50.00000000000044, 45.1, 44.10000000000001, -50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 30.699999999999996, 44.7, -50.00000000000044, -50.00000000000044, 43.7, 45.9, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 190, 348, 70, 394, 68, 500, 500, 44, 500, 146, 60, 52, 48, 500, 500, 50, 26, 500, 150, 66, 48, 48, 500, 500, 500, 110, 500, 44, 344, 500, 500, 500, 26, 46, 500, 500, 206, 98, 96, 234, 152, 90, 72, 500, 200, 242, 500, 500, 500, 102, 500, 500, 112, 190, 66, 182, 102, 70, 40, 500, 244, 204, 316, 500, 30, 44, 132, 52, 140, 184, 70, 500, 64, 500, 24, 500, 68, 158, 114, 500, 500, 50, 60, 500, 96, 500, 500, 58, 500, 194, 54, 500, 500, 64, 42, 84, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4322830064676794, "mean_inference_ms": 1.3871900815704012, "mean_action_processing_ms": 0.16193531854690243, "mean_env_wait_ms": 0.09794019632841382, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0455322265625, "StateBufferConnector_ms": 0.01000070571899414, "ViewRequirementAgentConnector_ms": 0.16552066802978516}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.883999999999826, "episode_len_mean": 261.78, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 31.1, 15.299999999999777, 43.10000000000001, 10.699999999999712, 43.30000000000001, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 35.500000000000036, 44.10000000000001, 44.900000000000006, 45.3, -50.00000000000044, -50.00000000000044, 45.1, 47.5, -50.00000000000044, 35.10000000000004, 43.50000000000001, 45.3, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, -50.00000000000044, 45.7, 15.699999999999783, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 45.5, -50.00000000000044, -50.00000000000044, 29.49999999999998, 40.30000000000002, 40.500000000000014, 26.69999999999994, 34.900000000000034, 41.100000000000016, 42.900000000000006, -50.00000000000044, 30.099999999999987, 25.899999999999928, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, 38.90000000000002, 31.1, 43.50000000000001, 31.900000000000013, 39.90000000000002, 43.10000000000001, 46.099999999999994, -50.00000000000044, 25.699999999999925, 29.69999999999998, 18.499999999999822, -50.00000000000044, 47.1, 45.7, 36.900000000000034, 44.900000000000006, 36.10000000000004, 31.70000000000001, 43.10000000000001, -50.00000000000044, 43.7, -50.00000000000044, 47.7, -50.00000000000044, 43.30000000000001, 34.30000000000004, 38.700000000000024, -50.00000000000044, -50.00000000000044, 45.1, 44.10000000000001, -50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 30.699999999999996, 44.7, -50.00000000000044, -50.00000000000044, 43.7, 45.9, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 190, 348, 70, 394, 68, 500, 500, 44, 500, 146, 60, 52, 48, 500, 500, 50, 26, 500, 150, 66, 48, 48, 500, 500, 500, 110, 500, 44, 344, 500, 500, 500, 26, 46, 500, 500, 206, 98, 96, 234, 152, 90, 72, 500, 200, 242, 500, 500, 500, 102, 500, 500, 112, 190, 66, 182, 102, 70, 40, 500, 244, 204, 316, 500, 30, 44, 132, 52, 140, 184, 70, 500, 64, 500, 24, 500, 68, 158, 114, 500, 500, 50, 60, 500, 96, 500, 500, 58, 500, 194, 54, 500, 500, 64, 42, 84, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4322830064676794, "mean_inference_ms": 1.3871900815704012, "mean_action_processing_ms": 0.16193531854690243, "mean_env_wait_ms": 0.09794019632841382, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0455322265625, "StateBufferConnector_ms": 0.01000070571899414, "ViewRequirementAgentConnector_ms": 0.16552066802978516}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5133.9996331957445, "num_env_steps_trained_throughput_per_sec": 5133.9996331957445, "timesteps_total": 504000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 504000, "timers": {"training_iteration_time_ms": 3673.272, "sample_time_ms": 3295.16, "load_time_ms": 19.682, "load_throughput": 914524.492, "learn_time_ms": 345.253, "learn_throughput": 52135.664, "synch_weights_time_ms": 10.479}, "counters": {"num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000}, "done": false, "episodes_total": 1927, "training_iteration": 28, "trial_id": "9f288_00020", "date": "2023-10-25_17-13-31", "timestamp": 1698250411, "time_this_iter_s": 3.511035203933716, "time_total_s": 101.760812997818, "pid": 9936, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 101.760812997818, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 66.84, "ram_util_percent": 27.02}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.45058059692383e-10, "cur_lr": 0.0003, "total_loss": 7.016284041934544, "policy_loss": -0.0002930727269914415, "vf_loss": 7.016634870458533, "vf_explained_var": -1.0397699144151475e-06, "kl": 0.000682416961594796, "entropy": 0.5763948924011655, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 770.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 522000, "num_env_steps_trained": 522000, "num_agent_steps_sampled": 522000, "num_agent_steps_trained": 522000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.324999999999843, "episode_len_mean": 252.4, "episode_media": {}, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 47.7, -50.00000000000044, 43.30000000000001, 34.30000000000004, 38.700000000000024, -50.00000000000044, -50.00000000000044, 45.1, 44.10000000000001, -50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 30.699999999999996, 44.7, -50.00000000000044, -50.00000000000044, 43.7, 45.9, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 17.499999999999808, 27.49999999999995, -50.00000000000044, 46.699999999999996, 39.300000000000026, 44.10000000000001, 44.5, 45.5, -50.00000000000044, 32.90000000000003, 27.699999999999953, 45.9, -50.00000000000044, -50.00000000000044, 32.700000000000024, 42.500000000000014, 44.900000000000006, 32.50000000000002, 46.699999999999996, -50.00000000000044, 23.699999999999896, 39.90000000000002, 33.10000000000003, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 40.90000000000002, 25.499999999999922, 40.500000000000014, 38.700000000000024, 35.70000000000003, 42.500000000000014, -50.00000000000044, 38.700000000000024, -50.00000000000044, 45.7, 39.70000000000002, 41.500000000000014, 12.499999999999737, 40.10000000000002, 44.10000000000001, -50.00000000000044, 40.10000000000002, 37.50000000000003, 39.70000000000002, -50.00000000000044, 42.500000000000014, 29.299999999999976, 41.500000000000014, 25.699999999999925, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.699999999999996, 37.300000000000026, 43.30000000000001, 39.70000000000002, -50.00000000000044, 38.10000000000002, -50.00000000000044, 42.900000000000006, 40.10000000000002, 29.49999999999998, 47.3, -50.00000000000044, 31.900000000000013, 39.300000000000026, -50.00000000000044, 20.299999999999848, -50.00000000000044], "episode_lengths": [500, 24, 500, 68, 158, 114, 500, 500, 50, 60, 500, 96, 500, 500, 58, 500, 194, 54, 500, 500, 64, 42, 84, 500, 500, 500, 500, 500, 64, 326, 226, 500, 34, 108, 60, 56, 46, 500, 172, 224, 42, 500, 500, 174, 76, 52, 176, 34, 500, 264, 102, 170, 500, 64, 500, 500, 92, 246, 96, 114, 144, 76, 500, 114, 500, 44, 104, 86, 376, 100, 60, 500, 100, 126, 104, 500, 76, 208, 86, 244, 500, 500, 500, 194, 128, 68, 104, 500, 120, 500, 72, 100, 206, 28, 500, 182, 108, 500, 298, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4302827785087057, "mean_inference_ms": 1.386178095087825, "mean_action_processing_ms": 0.16131958137195654, "mean_env_wait_ms": 0.09789992856652707, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022629499435424805, "StateBufferConnector_ms": 0.0039980411529541016, "ViewRequirementAgentConnector_ms": 0.13781237602233887}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.324999999999843, "episode_len_mean": 252.4, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 47.7, -50.00000000000044, 43.30000000000001, 34.30000000000004, 38.700000000000024, -50.00000000000044, -50.00000000000044, 45.1, 44.10000000000001, -50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 30.699999999999996, 44.7, -50.00000000000044, -50.00000000000044, 43.7, 45.9, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 17.499999999999808, 27.49999999999995, -50.00000000000044, 46.699999999999996, 39.300000000000026, 44.10000000000001, 44.5, 45.5, -50.00000000000044, 32.90000000000003, 27.699999999999953, 45.9, -50.00000000000044, -50.00000000000044, 32.700000000000024, 42.500000000000014, 44.900000000000006, 32.50000000000002, 46.699999999999996, -50.00000000000044, 23.699999999999896, 39.90000000000002, 33.10000000000003, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 40.90000000000002, 25.499999999999922, 40.500000000000014, 38.700000000000024, 35.70000000000003, 42.500000000000014, -50.00000000000044, 38.700000000000024, -50.00000000000044, 45.7, 39.70000000000002, 41.500000000000014, 12.499999999999737, 40.10000000000002, 44.10000000000001, -50.00000000000044, 40.10000000000002, 37.50000000000003, 39.70000000000002, -50.00000000000044, 42.500000000000014, 29.299999999999976, 41.500000000000014, 25.699999999999925, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.699999999999996, 37.300000000000026, 43.30000000000001, 39.70000000000002, -50.00000000000044, 38.10000000000002, -50.00000000000044, 42.900000000000006, 40.10000000000002, 29.49999999999998, 47.3, -50.00000000000044, 31.900000000000013, 39.300000000000026, -50.00000000000044, 20.299999999999848, -50.00000000000044], "episode_lengths": [500, 24, 500, 68, 158, 114, 500, 500, 50, 60, 500, 96, 500, 500, 58, 500, 194, 54, 500, 500, 64, 42, 84, 500, 500, 500, 500, 500, 64, 326, 226, 500, 34, 108, 60, 56, 46, 500, 172, 224, 42, 500, 500, 174, 76, 52, 176, 34, 500, 264, 102, 170, 500, 64, 500, 500, 92, 246, 96, 114, 144, 76, 500, 114, 500, 44, 104, 86, 376, 100, 60, 500, 100, 126, 104, 500, 76, 208, 86, 244, 500, 500, 500, 194, 128, 68, 104, 500, 120, 500, 72, 100, 206, 28, 500, 182, 108, 500, 298, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4302827785087057, "mean_inference_ms": 1.386178095087825, "mean_action_processing_ms": 0.16131958137195654, "mean_env_wait_ms": 0.09789992856652707, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022629499435424805, "StateBufferConnector_ms": 0.0039980411529541016, "ViewRequirementAgentConnector_ms": 0.13781237602233887}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 522000, "num_agent_steps_trained": 522000, "num_env_steps_sampled": 522000, "num_env_steps_trained": 522000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5107.743646007847, "num_env_steps_trained_throughput_per_sec": 5107.743646007847, "timesteps_total": 522000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 522000, "timers": {"training_iteration_time_ms": 3667.655, "sample_time_ms": 3288.792, "load_time_ms": 19.767, "load_throughput": 910599.882, "learn_time_ms": 346.108, "learn_throughput": 52006.89, "synch_weights_time_ms": 10.396}, "counters": {"num_env_steps_sampled": 522000, "num_env_steps_trained": 522000, "num_agent_steps_sampled": 522000, "num_agent_steps_trained": 522000}, "done": false, "episodes_total": 2001, "training_iteration": 29, "trial_id": "9f288_00020", "date": "2023-10-25_17-13-34", "timestamp": 1698250414, "time_this_iter_s": 3.529724359512329, "time_total_s": 105.29053735733032, "pid": 9936, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 105.29053735733032, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 66.03999999999999, "ram_util_percent": 27.02}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.725290298461915e-10, "cur_lr": 0.0003, "total_loss": 6.966704527537028, "policy_loss": -0.0001771968823892099, "vf_loss": 6.966936270395915, "vf_explained_var": -1.2693581757722078e-06, "kl": 0.0009678292757112093, "entropy": 0.5441629257467058, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 797.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.085999999999837, "episode_len_mean": 259.8, "episode_media": {}, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.10000000000002, 37.50000000000003, 39.70000000000002, -50.00000000000044, 42.500000000000014, 29.299999999999976, 41.500000000000014, 25.699999999999925, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.699999999999996, 37.300000000000026, 43.30000000000001, 39.70000000000002, -50.00000000000044, 38.10000000000002, -50.00000000000044, 42.900000000000006, 40.10000000000002, 29.49999999999998, 47.3, -50.00000000000044, 31.900000000000013, 39.300000000000026, -50.00000000000044, 20.299999999999848, -50.00000000000044, -50.00000000000044, 37.300000000000026, 45.9, 43.900000000000006, 42.30000000000001, 32.50000000000002, -50.00000000000044, 33.500000000000036, 13.099999999999746, 20.699999999999854, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 42.70000000000001, -50.00000000000044, 18.29999999999982, 9.099999999999689, 20.299999999999848, 39.10000000000002, 42.30000000000001, 41.70000000000002, 38.10000000000002, 45.5, 46.699999999999996, 38.700000000000024, 37.10000000000003, 42.70000000000001, 47.7, -50.00000000000044, 31.70000000000001, -50.00000000000044, -50.00000000000044, 38.700000000000024, -50.00000000000044, 34.30000000000004, 31.900000000000013, 46.5, 40.500000000000014, -50.00000000000044, -50.00000000000044, 19.69999999999984, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 32.30000000000002, 41.70000000000002, 35.900000000000034, 33.30000000000003, 45.7, 43.7, -50.00000000000044, 33.90000000000004, -50.00000000000044, 44.300000000000004, 45.5, 13.899999999999757, 9.8999999999997, 45.7, -50.00000000000044, 45.3, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 44.900000000000006], "episode_lengths": [100, 126, 104, 500, 76, 208, 86, 244, 500, 500, 500, 194, 128, 68, 104, 500, 120, 500, 72, 100, 206, 28, 500, 182, 108, 500, 298, 500, 500, 128, 42, 62, 78, 176, 500, 166, 370, 294, 500, 500, 500, 500, 36, 74, 500, 318, 410, 298, 110, 78, 84, 120, 46, 34, 114, 130, 74, 24, 500, 184, 500, 500, 114, 500, 158, 182, 36, 96, 500, 500, 304, 500, 500, 80, 500, 500, 500, 500, 86, 178, 84, 142, 168, 44, 64, 500, 162, 500, 58, 46, 362, 402, 44, 500, 48, 500, 68, 500, 500, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4317696949119123, "mean_inference_ms": 1.3869011873250332, "mean_action_processing_ms": 0.16155385447616954, "mean_env_wait_ms": 0.09817793084900192, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025844573974609375, "StateBufferConnector_ms": 0.009002447128295898, "ViewRequirementAgentConnector_ms": 0.15787768363952637}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.085999999999837, "episode_len_mean": 259.8, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [40.10000000000002, 37.50000000000003, 39.70000000000002, -50.00000000000044, 42.500000000000014, 29.299999999999976, 41.500000000000014, 25.699999999999925, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.699999999999996, 37.300000000000026, 43.30000000000001, 39.70000000000002, -50.00000000000044, 38.10000000000002, -50.00000000000044, 42.900000000000006, 40.10000000000002, 29.49999999999998, 47.3, -50.00000000000044, 31.900000000000013, 39.300000000000026, -50.00000000000044, 20.299999999999848, -50.00000000000044, -50.00000000000044, 37.300000000000026, 45.9, 43.900000000000006, 42.30000000000001, 32.50000000000002, -50.00000000000044, 33.500000000000036, 13.099999999999746, 20.699999999999854, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 42.70000000000001, -50.00000000000044, 18.29999999999982, 9.099999999999689, 20.299999999999848, 39.10000000000002, 42.30000000000001, 41.70000000000002, 38.10000000000002, 45.5, 46.699999999999996, 38.700000000000024, 37.10000000000003, 42.70000000000001, 47.7, -50.00000000000044, 31.70000000000001, -50.00000000000044, -50.00000000000044, 38.700000000000024, -50.00000000000044, 34.30000000000004, 31.900000000000013, 46.5, 40.500000000000014, -50.00000000000044, -50.00000000000044, 19.69999999999984, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 32.30000000000002, 41.70000000000002, 35.900000000000034, 33.30000000000003, 45.7, 43.7, -50.00000000000044, 33.90000000000004, -50.00000000000044, 44.300000000000004, 45.5, 13.899999999999757, 9.8999999999997, 45.7, -50.00000000000044, 45.3, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 44.900000000000006], "episode_lengths": [100, 126, 104, 500, 76, 208, 86, 244, 500, 500, 500, 194, 128, 68, 104, 500, 120, 500, 72, 100, 206, 28, 500, 182, 108, 500, 298, 500, 500, 128, 42, 62, 78, 176, 500, 166, 370, 294, 500, 500, 500, 500, 36, 74, 500, 318, 410, 298, 110, 78, 84, 120, 46, 34, 114, 130, 74, 24, 500, 184, 500, 500, 114, 500, 158, 182, 36, 96, 500, 500, 304, 500, 500, 80, 500, 500, 500, 500, 86, 178, 84, 142, 168, 44, 64, 500, 162, 500, 58, 46, 362, 402, 44, 500, 48, 500, 68, 500, 500, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4317696949119123, "mean_inference_ms": 1.3869011873250332, "mean_action_processing_ms": 0.16155385447616954, "mean_env_wait_ms": 0.09817793084900192, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025844573974609375, "StateBufferConnector_ms": 0.009002447128295898, "ViewRequirementAgentConnector_ms": 0.15787768363952637}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4705.446453062161, "num_env_steps_trained_throughput_per_sec": 4705.446453062161, "timesteps_total": 540000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 540000, "timers": {"training_iteration_time_ms": 3693.715, "sample_time_ms": 3314.356, "load_time_ms": 19.569, "load_throughput": 919833.766, "learn_time_ms": 346.467, "learn_throughput": 51952.958, "synch_weights_time_ms": 10.498}, "counters": {"num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000}, "done": false, "episodes_total": 2073, "training_iteration": 30, "trial_id": "9f288_00020", "date": "2023-10-25_17-13-38", "timestamp": 1698250418, "time_this_iter_s": 3.831442356109619, "time_total_s": 109.12197971343994, "pid": 9936, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 109.12197971343994, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 73.84, "ram_util_percent": 27.04}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.8626451492309574e-10, "cur_lr": 0.0003, "total_loss": 6.572693312609637, "policy_loss": -0.00022133246616080955, "vf_loss": 6.572967176084165, "vf_explained_var": -8.035589147497106e-07, "kl": 0.00042665221409758186, "entropy": 0.5245788759655423, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 824.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 558000, "num_env_steps_trained": 558000, "num_agent_steps_sampled": 558000, "num_agent_steps_trained": 558000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.15899999999984, "episode_len_mean": 244.06, "episode_media": {}, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 41.500000000000014, 32.30000000000002, 41.70000000000002, 35.900000000000034, 33.30000000000003, 45.7, 43.7, -50.00000000000044, 33.90000000000004, -50.00000000000044, 44.300000000000004, 45.5, 13.899999999999757, 9.8999999999997, 45.7, -50.00000000000044, 45.3, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 42.30000000000001, 45.3, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 44.5, 36.50000000000003, 43.900000000000006, -50.00000000000044, 39.90000000000002, 45.9, 47.3, 45.9, 45.3, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 21.89999999999987, 43.50000000000001, -50.00000000000044, 22.299999999999876, -50.00000000000044, 21.89999999999987, 42.30000000000001, 42.30000000000001, 45.7, 36.30000000000003, 37.300000000000026, 30.099999999999987, 44.300000000000004, 40.30000000000002, 37.50000000000003, 44.300000000000004, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 40.500000000000014, 39.50000000000002, 45.9, -50.00000000000044, -50.00000000000044, 36.70000000000003, -50.00000000000044, 37.50000000000003, -50.00000000000044, -50.00000000000044, 15.49999999999978, 43.10000000000001, 47.1, 43.50000000000001, -50.00000000000044, 45.1, -50.00000000000044, 38.10000000000002, -50.00000000000044, 31.900000000000013, 41.70000000000002, 46.099999999999994, -50.00000000000044, 39.300000000000026, 45.3, -50.00000000000044, -50.00000000000044, 30.499999999999993, 40.90000000000002, 42.500000000000014, 42.900000000000006, 45.7], "episode_lengths": [500, 500, 86, 178, 84, 142, 168, 44, 64, 500, 162, 500, 58, 46, 362, 402, 44, 500, 48, 500, 68, 500, 500, 52, 500, 500, 78, 48, 500, 50, 500, 500, 56, 136, 62, 500, 102, 42, 28, 42, 48, 66, 500, 500, 500, 500, 500, 56, 282, 66, 500, 278, 500, 282, 78, 78, 44, 138, 128, 200, 58, 98, 126, 58, 500, 500, 42, 500, 96, 106, 42, 500, 500, 134, 500, 126, 500, 500, 346, 70, 30, 66, 500, 50, 500, 120, 500, 182, 84, 40, 500, 108, 48, 500, 500, 196, 92, 76, 72, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43244118385609354, "mean_inference_ms": 1.383697525975349, "mean_action_processing_ms": 0.16157088613913476, "mean_env_wait_ms": 0.09799035590727372, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014249324798583984, "StateBufferConnector_ms": 0.013010740280151367, "ViewRequirementAgentConnector_ms": 0.13498139381408691}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.15899999999984, "episode_len_mean": 244.06, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 41.500000000000014, 32.30000000000002, 41.70000000000002, 35.900000000000034, 33.30000000000003, 45.7, 43.7, -50.00000000000044, 33.90000000000004, -50.00000000000044, 44.300000000000004, 45.5, 13.899999999999757, 9.8999999999997, 45.7, -50.00000000000044, 45.3, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 42.30000000000001, 45.3, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 44.5, 36.50000000000003, 43.900000000000006, -50.00000000000044, 39.90000000000002, 45.9, 47.3, 45.9, 45.3, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 21.89999999999987, 43.50000000000001, -50.00000000000044, 22.299999999999876, -50.00000000000044, 21.89999999999987, 42.30000000000001, 42.30000000000001, 45.7, 36.30000000000003, 37.300000000000026, 30.099999999999987, 44.300000000000004, 40.30000000000002, 37.50000000000003, 44.300000000000004, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 40.500000000000014, 39.50000000000002, 45.9, -50.00000000000044, -50.00000000000044, 36.70000000000003, -50.00000000000044, 37.50000000000003, -50.00000000000044, -50.00000000000044, 15.49999999999978, 43.10000000000001, 47.1, 43.50000000000001, -50.00000000000044, 45.1, -50.00000000000044, 38.10000000000002, -50.00000000000044, 31.900000000000013, 41.70000000000002, 46.099999999999994, -50.00000000000044, 39.300000000000026, 45.3, -50.00000000000044, -50.00000000000044, 30.499999999999993, 40.90000000000002, 42.500000000000014, 42.900000000000006, 45.7], "episode_lengths": [500, 500, 86, 178, 84, 142, 168, 44, 64, 500, 162, 500, 58, 46, 362, 402, 44, 500, 48, 500, 68, 500, 500, 52, 500, 500, 78, 48, 500, 50, 500, 500, 56, 136, 62, 500, 102, 42, 28, 42, 48, 66, 500, 500, 500, 500, 500, 56, 282, 66, 500, 278, 500, 282, 78, 78, 44, 138, 128, 200, 58, 98, 126, 58, 500, 500, 42, 500, 96, 106, 42, 500, 500, 134, 500, 126, 500, 500, 346, 70, 30, 66, 500, 50, 500, 120, 500, 182, 84, 40, 500, 108, 48, 500, 500, 196, 92, 76, 72, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43244118385609354, "mean_inference_ms": 1.383697525975349, "mean_action_processing_ms": 0.16157088613913476, "mean_env_wait_ms": 0.09799035590727372, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014249324798583984, "StateBufferConnector_ms": 0.013010740280151367, "ViewRequirementAgentConnector_ms": 0.13498139381408691}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 558000, "num_agent_steps_trained": 558000, "num_env_steps_sampled": 558000, "num_env_steps_trained": 558000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5289.298738806803, "num_env_steps_trained_throughput_per_sec": 5289.298738806803, "timesteps_total": 558000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 558000, "timers": {"training_iteration_time_ms": 3665.046, "sample_time_ms": 3277.543, "load_time_ms": 20.227, "load_throughput": 889891.111, "learn_time_ms": 354.053, "learn_throughput": 50839.795, "synch_weights_time_ms": 10.394}, "counters": {"num_env_steps_sampled": 558000, "num_env_steps_trained": 558000, "num_agent_steps_sampled": 558000, "num_agent_steps_trained": 558000}, "done": false, "episodes_total": 2149, "training_iteration": 31, "trial_id": "9f288_00020", "date": "2023-10-25_17-13-42", "timestamp": 1698250422, "time_this_iter_s": 3.4080960750579834, "time_total_s": 112.53007578849792, "pid": 9936, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 112.53007578849792, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 59.98, "ram_util_percent": 27.060000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.313225746154787e-11, "cur_lr": 0.0003, "total_loss": 6.981666105764884, "policy_loss": -0.0002550649353199535, "vf_loss": 6.981972835682057, "vf_explained_var": -4.790447376392505e-07, "kl": 0.0007642291786093361, "entropy": 0.5171305592413302, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 851.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.748999999999846, "episode_len_mean": 238.22, "episode_media": {}, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 36.70000000000003, -50.00000000000044, 37.50000000000003, -50.00000000000044, -50.00000000000044, 15.49999999999978, 43.10000000000001, 47.1, 43.50000000000001, -50.00000000000044, 45.1, -50.00000000000044, 38.10000000000002, -50.00000000000044, 31.900000000000013, 41.70000000000002, 46.099999999999994, -50.00000000000044, 39.300000000000026, 45.3, -50.00000000000044, -50.00000000000044, 30.499999999999993, 40.90000000000002, 42.500000000000014, 42.900000000000006, 45.7, 5.899999999999643, 37.10000000000003, 18.29999999999982, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 45.3, 33.10000000000003, 0.6999999999995694, 38.50000000000003, -50.00000000000044, 2.499999999999595, 45.7, 40.500000000000014, 45.3, 37.90000000000003, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.69999999999984, 44.10000000000001, 45.3, 19.299999999999834, 43.30000000000001, 38.700000000000024, 36.50000000000003, 46.099999999999994, 0.8999999999995723, -50.00000000000044, 42.30000000000001, 44.5, 1.299999999999578, -50.00000000000044, 40.90000000000002, 33.90000000000004, -50.00000000000044, -50.00000000000044, 34.900000000000034, 44.900000000000006, -50.00000000000044, 44.5, -50.00000000000044, 46.9, 40.500000000000014, 45.9, 45.3, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 46.099999999999994, 45.7, 22.099999999999874, 37.10000000000003, 42.70000000000001, 44.10000000000001, 41.30000000000001, 44.7, 43.30000000000001, 42.70000000000001, 45.9, -50.00000000000044, 44.7, 36.70000000000003, 34.900000000000034, 43.30000000000001, -50.00000000000044, 10.299999999999706, 42.500000000000014], "episode_lengths": [500, 500, 134, 500, 126, 500, 500, 346, 70, 30, 66, 500, 50, 500, 120, 500, 182, 84, 40, 500, 108, 48, 500, 500, 196, 92, 76, 72, 44, 442, 130, 318, 500, 500, 58, 500, 48, 170, 494, 116, 500, 476, 44, 96, 48, 122, 54, 500, 500, 500, 304, 60, 48, 308, 68, 114, 136, 40, 492, 500, 78, 56, 488, 500, 92, 162, 500, 500, 152, 52, 500, 56, 500, 32, 96, 42, 48, 500, 62, 500, 500, 40, 44, 280, 130, 74, 60, 88, 54, 68, 74, 42, 500, 54, 134, 152, 68, 500, 398, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43006731145567584, "mean_inference_ms": 1.3782431337817034, "mean_action_processing_ms": 0.16058154128034008, "mean_env_wait_ms": 0.09768834231643472, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022279977798461914, "StateBufferConnector_ms": 0.0059986114501953125, "ViewRequirementAgentConnector_ms": 0.10151171684265137}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.748999999999846, "episode_len_mean": 238.22, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 36.70000000000003, -50.00000000000044, 37.50000000000003, -50.00000000000044, -50.00000000000044, 15.49999999999978, 43.10000000000001, 47.1, 43.50000000000001, -50.00000000000044, 45.1, -50.00000000000044, 38.10000000000002, -50.00000000000044, 31.900000000000013, 41.70000000000002, 46.099999999999994, -50.00000000000044, 39.300000000000026, 45.3, -50.00000000000044, -50.00000000000044, 30.499999999999993, 40.90000000000002, 42.500000000000014, 42.900000000000006, 45.7, 5.899999999999643, 37.10000000000003, 18.29999999999982, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 45.3, 33.10000000000003, 0.6999999999995694, 38.50000000000003, -50.00000000000044, 2.499999999999595, 45.7, 40.500000000000014, 45.3, 37.90000000000003, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.69999999999984, 44.10000000000001, 45.3, 19.299999999999834, 43.30000000000001, 38.700000000000024, 36.50000000000003, 46.099999999999994, 0.8999999999995723, -50.00000000000044, 42.30000000000001, 44.5, 1.299999999999578, -50.00000000000044, 40.90000000000002, 33.90000000000004, -50.00000000000044, -50.00000000000044, 34.900000000000034, 44.900000000000006, -50.00000000000044, 44.5, -50.00000000000044, 46.9, 40.500000000000014, 45.9, 45.3, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 46.099999999999994, 45.7, 22.099999999999874, 37.10000000000003, 42.70000000000001, 44.10000000000001, 41.30000000000001, 44.7, 43.30000000000001, 42.70000000000001, 45.9, -50.00000000000044, 44.7, 36.70000000000003, 34.900000000000034, 43.30000000000001, -50.00000000000044, 10.299999999999706, 42.500000000000014], "episode_lengths": [500, 500, 134, 500, 126, 500, 500, 346, 70, 30, 66, 500, 50, 500, 120, 500, 182, 84, 40, 500, 108, 48, 500, 500, 196, 92, 76, 72, 44, 442, 130, 318, 500, 500, 58, 500, 48, 170, 494, 116, 500, 476, 44, 96, 48, 122, 54, 500, 500, 500, 304, 60, 48, 308, 68, 114, 136, 40, 492, 500, 78, 56, 488, 500, 92, 162, 500, 500, 152, 52, 500, 56, 500, 32, 96, 42, 48, 500, 62, 500, 500, 40, 44, 280, 130, 74, 60, 88, 54, 68, 74, 42, 500, 54, 134, 152, 68, 500, 398, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43006731145567584, "mean_inference_ms": 1.3782431337817034, "mean_action_processing_ms": 0.16058154128034008, "mean_env_wait_ms": 0.09768834231643472, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022279977798461914, "StateBufferConnector_ms": 0.0059986114501953125, "ViewRequirementAgentConnector_ms": 0.10151171684265137}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5801.060008250844, "num_env_steps_trained_throughput_per_sec": 5801.060008250844, "timesteps_total": 576000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 576000, "timers": {"training_iteration_time_ms": 3610.385, "sample_time_ms": 3231.456, "load_time_ms": 19.536, "load_throughput": 921360.437, "learn_time_ms": 346.4, "learn_throughput": 51963.052, "synch_weights_time_ms": 10.165}, "counters": {"num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "done": false, "episodes_total": 2220, "training_iteration": 32, "trial_id": "9f288_00020", "date": "2023-10-25_17-13-45", "timestamp": 1698250425, "time_this_iter_s": 3.108416795730591, "time_total_s": 115.63849258422852, "pid": 9936, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 115.63849258422852, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 64.125, "ram_util_percent": 27.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.6566128730773935e-11, "cur_lr": 0.0003, "total_loss": 7.181360297732883, "policy_loss": -5.689525493869075e-05, "vf_loss": 7.181470553080241, "vf_explained_var": -9.360136809172454e-07, "kl": 0.0009318027946855418, "entropy": 0.5342148277494643, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 878.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 594000, "num_env_steps_trained": 594000, "num_agent_steps_sampled": 594000, "num_agent_steps_trained": 594000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.302999999999852, "episode_len_mean": 232.66, "episode_media": {}, "episodes_this_iter": 79, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 46.099999999999994, 45.7, 22.099999999999874, 37.10000000000003, 42.70000000000001, 44.10000000000001, 41.30000000000001, 44.7, 43.30000000000001, 42.70000000000001, 45.9, -50.00000000000044, 44.7, 36.70000000000003, 34.900000000000034, 43.30000000000001, -50.00000000000044, 10.299999999999706, 42.500000000000014, -50.00000000000044, -50.00000000000044, 38.50000000000003, 45.7, 22.899999999999885, 32.30000000000002, -50.00000000000044, 44.5, 46.3, -50.00000000000044, 17.69999999999981, -50.00000000000044, 45.7, 43.900000000000006, 42.500000000000014, 45.5, 43.30000000000001, 34.900000000000034, -50.00000000000044, 36.50000000000003, 44.7, 41.70000000000002, 45.3, -50.00000000000044, -50.00000000000044, 32.30000000000002, -50.00000000000044, 34.50000000000004, -50.00000000000044, 45.5, 23.29999999999989, -50.00000000000044, 44.900000000000006, 41.500000000000014, -50.00000000000044, 1.4999999999995808, 36.10000000000004, 42.70000000000001, 43.10000000000001, 39.300000000000026, -50.00000000000044, -50.00000000000044, 42.500000000000014, 46.9, -50.00000000000044, 45.1, -50.00000000000044, 43.10000000000001, -50.00000000000044, 42.30000000000001, 44.10000000000001, -50.00000000000044, 31.70000000000001, 45.5, -50.00000000000044, 31.300000000000004, 34.900000000000034, -50.00000000000044, 44.7, 21.499999999999865, 11.499999999999723, 45.9, -50.00000000000044, 43.7, -50.00000000000044, 38.700000000000024, 45.1, 43.30000000000001, -50.00000000000044, -50.00000000000044, 43.900000000000006, 43.10000000000001, 35.10000000000004, 42.10000000000001, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014], "episode_lengths": [500, 500, 40, 44, 280, 130, 74, 60, 88, 54, 68, 74, 42, 500, 54, 134, 152, 68, 500, 398, 76, 500, 500, 116, 44, 272, 178, 500, 56, 38, 500, 324, 500, 44, 62, 76, 46, 68, 152, 500, 136, 54, 84, 48, 500, 500, 178, 500, 156, 500, 46, 268, 500, 52, 86, 500, 486, 140, 74, 70, 108, 500, 500, 76, 32, 500, 50, 500, 70, 500, 78, 60, 500, 184, 46, 500, 188, 152, 500, 54, 286, 386, 42, 500, 64, 500, 114, 50, 68, 500, 500, 62, 70, 150, 80, 30, 500, 500, 500, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42875556428710637, "mean_inference_ms": 1.373536035271474, "mean_action_processing_ms": 0.16016971458074636, "mean_env_wait_ms": 0.09704052032227808, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025017976760864258, "StateBufferConnector_ms": 0.004992961883544922, "ViewRequirementAgentConnector_ms": 0.12077736854553223}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.302999999999852, "episode_len_mean": 232.66, "episodes_this_iter": 79, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 46.099999999999994, 45.7, 22.099999999999874, 37.10000000000003, 42.70000000000001, 44.10000000000001, 41.30000000000001, 44.7, 43.30000000000001, 42.70000000000001, 45.9, -50.00000000000044, 44.7, 36.70000000000003, 34.900000000000034, 43.30000000000001, -50.00000000000044, 10.299999999999706, 42.500000000000014, -50.00000000000044, -50.00000000000044, 38.50000000000003, 45.7, 22.899999999999885, 32.30000000000002, -50.00000000000044, 44.5, 46.3, -50.00000000000044, 17.69999999999981, -50.00000000000044, 45.7, 43.900000000000006, 42.500000000000014, 45.5, 43.30000000000001, 34.900000000000034, -50.00000000000044, 36.50000000000003, 44.7, 41.70000000000002, 45.3, -50.00000000000044, -50.00000000000044, 32.30000000000002, -50.00000000000044, 34.50000000000004, -50.00000000000044, 45.5, 23.29999999999989, -50.00000000000044, 44.900000000000006, 41.500000000000014, -50.00000000000044, 1.4999999999995808, 36.10000000000004, 42.70000000000001, 43.10000000000001, 39.300000000000026, -50.00000000000044, -50.00000000000044, 42.500000000000014, 46.9, -50.00000000000044, 45.1, -50.00000000000044, 43.10000000000001, -50.00000000000044, 42.30000000000001, 44.10000000000001, -50.00000000000044, 31.70000000000001, 45.5, -50.00000000000044, 31.300000000000004, 34.900000000000034, -50.00000000000044, 44.7, 21.499999999999865, 11.499999999999723, 45.9, -50.00000000000044, 43.7, -50.00000000000044, 38.700000000000024, 45.1, 43.30000000000001, -50.00000000000044, -50.00000000000044, 43.900000000000006, 43.10000000000001, 35.10000000000004, 42.10000000000001, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014], "episode_lengths": [500, 500, 40, 44, 280, 130, 74, 60, 88, 54, 68, 74, 42, 500, 54, 134, 152, 68, 500, 398, 76, 500, 500, 116, 44, 272, 178, 500, 56, 38, 500, 324, 500, 44, 62, 76, 46, 68, 152, 500, 136, 54, 84, 48, 500, 500, 178, 500, 156, 500, 46, 268, 500, 52, 86, 500, 486, 140, 74, 70, 108, 500, 500, 76, 32, 500, 50, 500, 70, 500, 78, 60, 500, 184, 46, 500, 188, 152, 500, 54, 286, 386, 42, 500, 64, 500, 114, 50, 68, 500, 500, 62, 70, 150, 80, 30, 500, 500, 500, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42875556428710637, "mean_inference_ms": 1.373536035271474, "mean_action_processing_ms": 0.16016971458074636, "mean_env_wait_ms": 0.09704052032227808, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025017976760864258, "StateBufferConnector_ms": 0.004992961883544922, "ViewRequirementAgentConnector_ms": 0.12077736854553223}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 594000, "num_agent_steps_trained": 594000, "num_env_steps_sampled": 594000, "num_env_steps_trained": 594000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5535.812111032018, "num_env_steps_trained_throughput_per_sec": 5535.812111032018, "timesteps_total": 594000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 594000, "timers": {"training_iteration_time_ms": 3531.114, "sample_time_ms": 3160.304, "load_time_ms": 18.524, "load_throughput": 971698.457, "learn_time_ms": 339.529, "learn_throughput": 53014.678, "synch_weights_time_ms": 9.916}, "counters": {"num_env_steps_sampled": 594000, "num_env_steps_trained": 594000, "num_agent_steps_sampled": 594000, "num_agent_steps_trained": 594000}, "done": false, "episodes_total": 2299, "training_iteration": 33, "trial_id": "9f288_00020", "date": "2023-10-25_17-13-48", "timestamp": 1698250428, "time_this_iter_s": 3.257547616958618, "time_total_s": 118.89604020118713, "pid": 9936, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 118.89604020118713, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 59.760000000000005, "ram_util_percent": 27.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.3283064365386967e-11, "cur_lr": 0.0003, "total_loss": 6.458336529908357, "policy_loss": -0.0003640593753920661, "vf_loss": 6.458749682814987, "vf_explained_var": -1.3422082971643519e-06, "kl": 0.0008227535320475841, "entropy": 0.49134724449228356, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 905.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.566999999999832, "episode_len_mean": 249.96, "episode_media": {}, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 42.30000000000001, 44.10000000000001, -50.00000000000044, 31.70000000000001, 45.5, -50.00000000000044, 31.300000000000004, 34.900000000000034, -50.00000000000044, 44.7, 21.499999999999865, 11.499999999999723, 45.9, -50.00000000000044, 43.7, -50.00000000000044, 38.700000000000024, 45.1, 43.30000000000001, -50.00000000000044, -50.00000000000044, 43.900000000000006, 43.10000000000001, 35.10000000000004, 42.10000000000001, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 33.70000000000004, 36.30000000000003, 41.500000000000014, -50.00000000000044, 22.299999999999876, 41.30000000000001, 42.10000000000001, -50.00000000000044, 37.50000000000003, -50.00000000000044, -50.00000000000044, 40.90000000000002, 46.9, 43.30000000000001, -50.00000000000044, 45.1, 45.9, 35.70000000000003, -50.00000000000044, 39.90000000000002, 46.099999999999994, 43.900000000000006, -50.00000000000044, 39.90000000000002, -50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, 23.699999999999896, -50.00000000000044, -50.00000000000044, 38.50000000000003, 44.900000000000006, 47.5, 39.300000000000026, 46.3, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 13.099999999999746, 42.10000000000001, 47.7, -50.00000000000044, 36.10000000000004, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 45.5, -50.00000000000044, -50.00000000000044, 46.099999999999994, 45.5, 44.900000000000006, -50.00000000000044, -50.00000000000044, 16.8999999999998, -50.00000000000044, 41.100000000000016, 41.70000000000002, 39.70000000000002, 45.5, 42.900000000000006, -50.00000000000044, 44.10000000000001, 39.300000000000026], "episode_lengths": [500, 78, 60, 500, 184, 46, 500, 188, 152, 500, 54, 286, 386, 42, 500, 64, 500, 114, 50, 68, 500, 500, 62, 70, 150, 80, 30, 500, 500, 500, 76, 500, 164, 138, 86, 500, 278, 88, 80, 500, 126, 500, 500, 92, 32, 68, 500, 50, 42, 144, 500, 102, 40, 62, 500, 102, 500, 96, 500, 500, 264, 500, 500, 116, 52, 26, 108, 38, 500, 500, 66, 500, 370, 80, 24, 500, 140, 36, 500, 500, 500, 66, 46, 500, 500, 40, 46, 52, 500, 500, 332, 500, 90, 84, 104, 46, 72, 500, 60, 108]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42729264168896336, "mean_inference_ms": 1.3703272745586839, "mean_action_processing_ms": 0.15934403904791108, "mean_env_wait_ms": 0.09676780451635356, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03100299835205078, "StateBufferConnector_ms": 0.003997802734375, "ViewRequirementAgentConnector_ms": 0.11720871925354004}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.566999999999832, "episode_len_mean": 249.96, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 42.30000000000001, 44.10000000000001, -50.00000000000044, 31.70000000000001, 45.5, -50.00000000000044, 31.300000000000004, 34.900000000000034, -50.00000000000044, 44.7, 21.499999999999865, 11.499999999999723, 45.9, -50.00000000000044, 43.7, -50.00000000000044, 38.700000000000024, 45.1, 43.30000000000001, -50.00000000000044, -50.00000000000044, 43.900000000000006, 43.10000000000001, 35.10000000000004, 42.10000000000001, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 33.70000000000004, 36.30000000000003, 41.500000000000014, -50.00000000000044, 22.299999999999876, 41.30000000000001, 42.10000000000001, -50.00000000000044, 37.50000000000003, -50.00000000000044, -50.00000000000044, 40.90000000000002, 46.9, 43.30000000000001, -50.00000000000044, 45.1, 45.9, 35.70000000000003, -50.00000000000044, 39.90000000000002, 46.099999999999994, 43.900000000000006, -50.00000000000044, 39.90000000000002, -50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, 23.699999999999896, -50.00000000000044, -50.00000000000044, 38.50000000000003, 44.900000000000006, 47.5, 39.300000000000026, 46.3, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 13.099999999999746, 42.10000000000001, 47.7, -50.00000000000044, 36.10000000000004, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 45.5, -50.00000000000044, -50.00000000000044, 46.099999999999994, 45.5, 44.900000000000006, -50.00000000000044, -50.00000000000044, 16.8999999999998, -50.00000000000044, 41.100000000000016, 41.70000000000002, 39.70000000000002, 45.5, 42.900000000000006, -50.00000000000044, 44.10000000000001, 39.300000000000026], "episode_lengths": [500, 78, 60, 500, 184, 46, 500, 188, 152, 500, 54, 286, 386, 42, 500, 64, 500, 114, 50, 68, 500, 500, 62, 70, 150, 80, 30, 500, 500, 500, 76, 500, 164, 138, 86, 500, 278, 88, 80, 500, 126, 500, 500, 92, 32, 68, 500, 50, 42, 144, 500, 102, 40, 62, 500, 102, 500, 96, 500, 500, 264, 500, 500, 116, 52, 26, 108, 38, 500, 500, 66, 500, 370, 80, 24, 500, 140, 36, 500, 500, 500, 66, 46, 500, 500, 40, 46, 52, 500, 500, 332, 500, 90, 84, 104, 46, 72, 500, 60, 108]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42729264168896336, "mean_inference_ms": 1.3703272745586839, "mean_action_processing_ms": 0.15934403904791108, "mean_env_wait_ms": 0.09676780451635356, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03100299835205078, "StateBufferConnector_ms": 0.003997802734375, "ViewRequirementAgentConnector_ms": 0.11720871925354004}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000, "num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5059.561544489913, "num_env_steps_trained_throughput_per_sec": 5059.561544489913, "timesteps_total": 612000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 612000, "timers": {"training_iteration_time_ms": 3524.131, "sample_time_ms": 3149.816, "load_time_ms": 19.224, "load_throughput": 936316.816, "learn_time_ms": 342.445, "learn_throughput": 52563.245, "synch_weights_time_ms": 9.812}, "counters": {"num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000}, "done": false, "episodes_total": 2368, "training_iteration": 34, "trial_id": "9f288_00020", "date": "2023-10-25_17-13-52", "timestamp": 1698250432, "time_this_iter_s": 3.562615156173706, "time_total_s": 122.45865535736084, "pid": 9936, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 122.45865535736084, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 56.81999999999999, "ram_util_percent": 26.939999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1641532182693484e-11, "cur_lr": 0.0003, "total_loss": 6.320823263238977, "policy_loss": 3.268100597240307e-05, "vf_loss": 6.320840164467141, "vf_explained_var": -9.338061014811198e-07, "kl": 0.0002319475685605236, "entropy": 0.4966210656695896, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 932.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 630000, "num_env_steps_trained": 630000, "num_agent_steps_sampled": 630000, "num_agent_steps_trained": 630000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.614999999999839, "episode_len_mean": 239.48, "episode_media": {}, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [47.7, -50.00000000000044, 36.10000000000004, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 45.5, -50.00000000000044, -50.00000000000044, 46.099999999999994, 45.5, 44.900000000000006, -50.00000000000044, -50.00000000000044, 16.8999999999998, -50.00000000000044, 41.100000000000016, 41.70000000000002, 39.70000000000002, 45.5, 42.900000000000006, -50.00000000000044, 44.10000000000001, 39.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002, 43.30000000000001, 32.90000000000003, -50.00000000000044, 41.100000000000016, 36.30000000000003, -50.00000000000044, 46.099999999999994, 40.10000000000002, 45.5, -50.00000000000044, 45.7, -50.00000000000044, 42.70000000000001, -50.00000000000044, 42.500000000000014, -50.00000000000044, 44.10000000000001, 40.90000000000002, -50.00000000000044, -50.00000000000044, 47.7, 36.900000000000034, -50.00000000000044, 46.5, -50.00000000000044, 37.10000000000003, 45.5, 45.3, 40.30000000000002, 45.7, -50.00000000000044, 46.699999999999996, -50.00000000000044, 45.7, -50.00000000000044, 46.099999999999994, 46.099999999999994, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 45.3, 36.70000000000003, -50.00000000000044, 31.1, 43.900000000000006, 45.9, 38.10000000000002, 46.9, 44.5, -50.00000000000044, 43.7, 42.900000000000006, 44.7, 21.89999999999987, 42.30000000000001, -50.00000000000044, 41.70000000000002, 30.499999999999993, 46.5, 42.70000000000001, -50.00000000000044, 42.10000000000001, -50.00000000000044, 43.30000000000001, 11.499999999999723, -50.00000000000044], "episode_lengths": [24, 500, 140, 36, 500, 500, 500, 66, 46, 500, 500, 40, 46, 52, 500, 500, 332, 500, 90, 84, 104, 46, 72, 500, 60, 108, 500, 500, 500, 106, 68, 172, 500, 90, 138, 500, 40, 100, 46, 500, 44, 500, 74, 500, 76, 500, 60, 92, 500, 500, 24, 132, 500, 36, 500, 130, 46, 48, 98, 44, 500, 34, 500, 44, 500, 40, 40, 500, 52, 500, 500, 70, 500, 500, 48, 134, 500, 190, 62, 42, 120, 32, 56, 500, 64, 72, 54, 282, 78, 500, 84, 196, 36, 74, 500, 80, 500, 68, 386, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42718061723208195, "mean_inference_ms": 1.3648457853304319, "mean_action_processing_ms": 0.15916395037021785, "mean_env_wait_ms": 0.09620890501430113, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02596759796142578, "StateBufferConnector_ms": 0.003997802734375, "ViewRequirementAgentConnector_ms": 0.1190333366394043}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.614999999999839, "episode_len_mean": 239.48, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [47.7, -50.00000000000044, 36.10000000000004, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 45.5, -50.00000000000044, -50.00000000000044, 46.099999999999994, 45.5, 44.900000000000006, -50.00000000000044, -50.00000000000044, 16.8999999999998, -50.00000000000044, 41.100000000000016, 41.70000000000002, 39.70000000000002, 45.5, 42.900000000000006, -50.00000000000044, 44.10000000000001, 39.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002, 43.30000000000001, 32.90000000000003, -50.00000000000044, 41.100000000000016, 36.30000000000003, -50.00000000000044, 46.099999999999994, 40.10000000000002, 45.5, -50.00000000000044, 45.7, -50.00000000000044, 42.70000000000001, -50.00000000000044, 42.500000000000014, -50.00000000000044, 44.10000000000001, 40.90000000000002, -50.00000000000044, -50.00000000000044, 47.7, 36.900000000000034, -50.00000000000044, 46.5, -50.00000000000044, 37.10000000000003, 45.5, 45.3, 40.30000000000002, 45.7, -50.00000000000044, 46.699999999999996, -50.00000000000044, 45.7, -50.00000000000044, 46.099999999999994, 46.099999999999994, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 45.3, 36.70000000000003, -50.00000000000044, 31.1, 43.900000000000006, 45.9, 38.10000000000002, 46.9, 44.5, -50.00000000000044, 43.7, 42.900000000000006, 44.7, 21.89999999999987, 42.30000000000001, -50.00000000000044, 41.70000000000002, 30.499999999999993, 46.5, 42.70000000000001, -50.00000000000044, 42.10000000000001, -50.00000000000044, 43.30000000000001, 11.499999999999723, -50.00000000000044], "episode_lengths": [24, 500, 140, 36, 500, 500, 500, 66, 46, 500, 500, 40, 46, 52, 500, 500, 332, 500, 90, 84, 104, 46, 72, 500, 60, 108, 500, 500, 500, 106, 68, 172, 500, 90, 138, 500, 40, 100, 46, 500, 44, 500, 74, 500, 76, 500, 60, 92, 500, 500, 24, 132, 500, 36, 500, 130, 46, 48, 98, 44, 500, 34, 500, 44, 500, 40, 40, 500, 52, 500, 500, 70, 500, 500, 48, 134, 500, 190, 62, 42, 120, 32, 56, 500, 64, 72, 54, 282, 78, 500, 84, 196, 36, 74, 500, 80, 500, 68, 386, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42718061723208195, "mean_inference_ms": 1.3648457853304319, "mean_action_processing_ms": 0.15916395037021785, "mean_env_wait_ms": 0.09620890501430113, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02596759796142578, "StateBufferConnector_ms": 0.003997802734375, "ViewRequirementAgentConnector_ms": 0.1190333366394043}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 630000, "num_agent_steps_trained": 630000, "num_env_steps_sampled": 630000, "num_env_steps_trained": 630000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5425.003391638863, "num_env_steps_trained_throughput_per_sec": 5425.003391638863, "timesteps_total": 630000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 630000, "timers": {"training_iteration_time_ms": 3484.02, "sample_time_ms": 3103.479, "load_time_ms": 20.024, "load_throughput": 898904.633, "learn_time_ms": 348.053, "learn_throughput": 51716.24, "synch_weights_time_ms": 9.63}, "counters": {"num_env_steps_sampled": 630000, "num_env_steps_trained": 630000, "num_agent_steps_sampled": 630000, "num_agent_steps_trained": 630000}, "done": false, "episodes_total": 2442, "training_iteration": 35, "trial_id": "9f288_00020", "date": "2023-10-25_17-13-55", "timestamp": 1698250435, "time_this_iter_s": 3.3229644298553467, "time_total_s": 125.78161978721619, "pid": 9936, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 125.78161978721619, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 65.9, "ram_util_percent": 26.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.820766091346742e-12, "cur_lr": 0.0003, "total_loss": 6.5836853451199, "policy_loss": 5.175360409473932e-05, "vf_loss": 6.5836809299610275, "vf_explained_var": -8.432953445999711e-07, "kl": 0.0001082923060043531, "entropy": 0.47342161889429446, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 959.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.14499999999981, "episode_len_mean": 264.16, "episode_media": {}, "episodes_this_iter": 63, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.7, -50.00000000000044, 46.099999999999994, 46.099999999999994, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 45.3, 36.70000000000003, -50.00000000000044, 31.1, 43.900000000000006, 45.9, 38.10000000000002, 46.9, 44.5, -50.00000000000044, 43.7, 42.900000000000006, 44.7, 21.89999999999987, 42.30000000000001, -50.00000000000044, 41.70000000000002, 30.499999999999993, 46.5, 42.70000000000001, -50.00000000000044, 42.10000000000001, -50.00000000000044, 43.30000000000001, 11.499999999999723, -50.00000000000044, -50.00000000000044, 44.5, 45.9, 15.299999999999777, 44.5, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, 45.9, -50.00000000000044, 44.900000000000006, 32.50000000000002, 44.5, 42.30000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 44.900000000000006, 10.699999999999712, 43.900000000000006, -50.00000000000044, -50.00000000000044, 6.099999999999646, 42.900000000000006, -50.00000000000044, -50.00000000000044, 43.30000000000001, 42.500000000000014, 6.099999999999646, 14.299999999999763, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 44.10000000000001, 45.1, 43.50000000000001, -50.00000000000044, 46.3, -50.00000000000044, 23.29999999999989, 28.89999999999997, 47.3, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.49999999999995, -50.00000000000044, 44.300000000000004, 45.5, 45.5, 30.099999999999987, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [44, 500, 40, 40, 500, 52, 500, 500, 70, 500, 500, 48, 134, 500, 190, 62, 42, 120, 32, 56, 500, 64, 72, 54, 282, 78, 500, 84, 196, 36, 74, 500, 80, 500, 68, 386, 500, 500, 56, 42, 348, 56, 72, 500, 500, 500, 92, 42, 500, 52, 176, 56, 78, 40, 500, 500, 500, 500, 66, 52, 394, 62, 500, 500, 440, 72, 500, 500, 68, 76, 440, 358, 500, 500, 500, 36, 60, 50, 66, 500, 38, 500, 268, 212, 28, 500, 500, 40, 500, 500, 500, 226, 500, 58, 46, 46, 200, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42463185954510957, "mean_inference_ms": 1.362500130686924, "mean_action_processing_ms": 0.15846349173832938, "mean_env_wait_ms": 0.09583590195243488, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026996135711669922, "StateBufferConnector_ms": 0.00500035285949707, "ViewRequirementAgentConnector_ms": 0.10200119018554688}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.14499999999981, "episode_len_mean": 264.16, "episodes_this_iter": 63, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.7, -50.00000000000044, 46.099999999999994, 46.099999999999994, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 45.3, 36.70000000000003, -50.00000000000044, 31.1, 43.900000000000006, 45.9, 38.10000000000002, 46.9, 44.5, -50.00000000000044, 43.7, 42.900000000000006, 44.7, 21.89999999999987, 42.30000000000001, -50.00000000000044, 41.70000000000002, 30.499999999999993, 46.5, 42.70000000000001, -50.00000000000044, 42.10000000000001, -50.00000000000044, 43.30000000000001, 11.499999999999723, -50.00000000000044, -50.00000000000044, 44.5, 45.9, 15.299999999999777, 44.5, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, 45.9, -50.00000000000044, 44.900000000000006, 32.50000000000002, 44.5, 42.30000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 44.900000000000006, 10.699999999999712, 43.900000000000006, -50.00000000000044, -50.00000000000044, 6.099999999999646, 42.900000000000006, -50.00000000000044, -50.00000000000044, 43.30000000000001, 42.500000000000014, 6.099999999999646, 14.299999999999763, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 44.10000000000001, 45.1, 43.50000000000001, -50.00000000000044, 46.3, -50.00000000000044, 23.29999999999989, 28.89999999999997, 47.3, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.49999999999995, -50.00000000000044, 44.300000000000004, 45.5, 45.5, 30.099999999999987, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [44, 500, 40, 40, 500, 52, 500, 500, 70, 500, 500, 48, 134, 500, 190, 62, 42, 120, 32, 56, 500, 64, 72, 54, 282, 78, 500, 84, 196, 36, 74, 500, 80, 500, 68, 386, 500, 500, 56, 42, 348, 56, 72, 500, 500, 500, 92, 42, 500, 52, 176, 56, 78, 40, 500, 500, 500, 500, 66, 52, 394, 62, 500, 500, 440, 72, 500, 500, 68, 76, 440, 358, 500, 500, 500, 36, 60, 50, 66, 500, 38, 500, 268, 212, 28, 500, 500, 40, 500, 500, 500, 226, 500, 58, 46, 46, 200, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42463185954510957, "mean_inference_ms": 1.362500130686924, "mean_action_processing_ms": 0.15846349173832938, "mean_env_wait_ms": 0.09583590195243488, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026996135711669922, "StateBufferConnector_ms": 0.00500035285949707, "ViewRequirementAgentConnector_ms": 0.10200119018554688}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5242.515936393306, "num_env_steps_trained_throughput_per_sec": 5242.515936393306, "timesteps_total": 648000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 648000, "timers": {"training_iteration_time_ms": 3474.629, "sample_time_ms": 3094.993, "load_time_ms": 20.38, "load_throughput": 883200.404, "learn_time_ms": 347.055, "learn_throughput": 51865.034, "synch_weights_time_ms": 9.463}, "counters": {"num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000}, "done": false, "episodes_total": 2505, "training_iteration": 36, "trial_id": "9f288_00020", "date": "2023-10-25_17-13-58", "timestamp": 1698250438, "time_this_iter_s": 3.439465284347534, "time_total_s": 129.22108507156372, "pid": 9936, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 129.22108507156372, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 58.3, "ram_util_percent": 26.919999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.910383045673371e-12, "cur_lr": 0.0003, "total_loss": 6.45177427927653, "policy_loss": -0.0008937589548252247, "vf_loss": 6.452716915695755, "vf_explained_var": -1.0441850732873988e-06, "kl": 0.00132616494657664, "entropy": 0.48796671628952026, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 986.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 666000, "num_env_steps_trained": 666000, "num_agent_steps_sampled": 666000, "num_agent_steps_trained": 666000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.6789999999998173, "episode_len_mean": 258.8, "episode_media": {}, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.5, 44.10000000000001, 45.1, 43.50000000000001, -50.00000000000044, 46.3, -50.00000000000044, 23.29999999999989, 28.89999999999997, 47.3, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.49999999999995, -50.00000000000044, 44.300000000000004, 45.5, 45.5, 30.099999999999987, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.699999999999967, -50.00000000000044, 43.10000000000001, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 45.5, 43.30000000000001, 32.700000000000024, 31.300000000000004, -50.00000000000044, 44.900000000000006, 10.099999999999703, 45.5, 40.500000000000014, -50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 39.90000000000002, 40.90000000000002, 47.1, -50.00000000000044, -50.00000000000044, 46.9, 44.5, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 43.10000000000001, 34.30000000000004, 40.70000000000002, 42.10000000000001, 46.5, 47.1, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 42.30000000000001, 41.500000000000014, 37.50000000000003, 46.3, 36.10000000000004, 44.300000000000004, 35.10000000000004, 42.10000000000001, -50.00000000000044, 33.90000000000004, 37.90000000000003, 41.90000000000001, 45.9, 45.9, -50.00000000000044, 43.900000000000006, -50.00000000000044, 41.30000000000001], "episode_lengths": [500, 36, 60, 50, 66, 500, 38, 500, 268, 212, 28, 500, 500, 40, 500, 500, 500, 226, 500, 58, 46, 46, 200, 500, 500, 500, 214, 500, 70, 48, 500, 500, 500, 500, 48, 500, 500, 44, 500, 46, 68, 174, 188, 500, 52, 400, 46, 96, 500, 500, 102, 500, 500, 42, 500, 74, 500, 500, 102, 92, 30, 500, 500, 32, 56, 500, 500, 52, 500, 66, 500, 500, 70, 158, 94, 80, 36, 30, 500, 40, 500, 500, 78, 86, 126, 38, 140, 58, 150, 80, 500, 162, 122, 82, 42, 42, 500, 62, 500, 88]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4235464608100775, "mean_inference_ms": 1.3563156514096253, "mean_action_processing_ms": 0.15782826873363673, "mean_env_wait_ms": 0.09547455290630999, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02099442481994629, "StateBufferConnector_ms": 0.007001399993896484, "ViewRequirementAgentConnector_ms": 0.11896896362304688}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.6789999999998173, "episode_len_mean": 258.8, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.5, 44.10000000000001, 45.1, 43.50000000000001, -50.00000000000044, 46.3, -50.00000000000044, 23.29999999999989, 28.89999999999997, 47.3, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.49999999999995, -50.00000000000044, 44.300000000000004, 45.5, 45.5, 30.099999999999987, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.699999999999967, -50.00000000000044, 43.10000000000001, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 45.5, 43.30000000000001, 32.700000000000024, 31.300000000000004, -50.00000000000044, 44.900000000000006, 10.099999999999703, 45.5, 40.500000000000014, -50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 39.90000000000002, 40.90000000000002, 47.1, -50.00000000000044, -50.00000000000044, 46.9, 44.5, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 43.10000000000001, 34.30000000000004, 40.70000000000002, 42.10000000000001, 46.5, 47.1, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 42.30000000000001, 41.500000000000014, 37.50000000000003, 46.3, 36.10000000000004, 44.300000000000004, 35.10000000000004, 42.10000000000001, -50.00000000000044, 33.90000000000004, 37.90000000000003, 41.90000000000001, 45.9, 45.9, -50.00000000000044, 43.900000000000006, -50.00000000000044, 41.30000000000001], "episode_lengths": [500, 36, 60, 50, 66, 500, 38, 500, 268, 212, 28, 500, 500, 40, 500, 500, 500, 226, 500, 58, 46, 46, 200, 500, 500, 500, 214, 500, 70, 48, 500, 500, 500, 500, 48, 500, 500, 44, 500, 46, 68, 174, 188, 500, 52, 400, 46, 96, 500, 500, 102, 500, 500, 42, 500, 74, 500, 500, 102, 92, 30, 500, 500, 32, 56, 500, 500, 52, 500, 66, 500, 500, 70, 158, 94, 80, 36, 30, 500, 40, 500, 500, 78, 86, 126, 38, 140, 58, 150, 80, 500, 162, 122, 82, 42, 42, 500, 62, 500, 88]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4235464608100775, "mean_inference_ms": 1.3563156514096253, "mean_action_processing_ms": 0.15782826873363673, "mean_env_wait_ms": 0.09547455290630999, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02099442481994629, "StateBufferConnector_ms": 0.007001399993896484, "ViewRequirementAgentConnector_ms": 0.11896896362304688}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 666000, "num_agent_steps_trained": 666000, "num_env_steps_sampled": 666000, "num_env_steps_trained": 666000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5610.97141430199, "num_env_steps_trained_throughput_per_sec": 5610.97141430199, "timesteps_total": 666000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 666000, "timers": {"training_iteration_time_ms": 3413.005, "sample_time_ms": 3036.239, "load_time_ms": 18.502, "load_throughput": 972877.985, "learn_time_ms": 346.126, "learn_throughput": 52004.24, "synch_weights_time_ms": 9.5}, "counters": {"num_env_steps_sampled": 666000, "num_env_steps_trained": 666000, "num_agent_steps_sampled": 666000, "num_agent_steps_trained": 666000}, "done": false, "episodes_total": 2579, "training_iteration": 37, "trial_id": "9f288_00020", "date": "2023-10-25_17-14-02", "timestamp": 1698250442, "time_this_iter_s": 3.213998317718506, "time_total_s": 132.43508338928223, "pid": 9936, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 132.43508338928223, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 56.239999999999995, "ram_util_percent": 26.919999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.4551915228366855e-12, "cur_lr": 0.0003, "total_loss": 6.392934958140056, "policy_loss": -0.0005285342534383138, "vf_loss": 6.393513449916133, "vf_explained_var": -1.3135097644947194e-06, "kl": 0.0010629476627709916, "entropy": 0.500468788323579, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1013.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.600999999999834, "episode_len_mean": 249.62, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.5, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 43.10000000000001, 34.30000000000004, 40.70000000000002, 42.10000000000001, 46.5, 47.1, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 42.30000000000001, 41.500000000000014, 37.50000000000003, 46.3, 36.10000000000004, 44.300000000000004, 35.10000000000004, 42.10000000000001, -50.00000000000044, 33.90000000000004, 37.90000000000003, 41.90000000000001, 45.9, 45.9, -50.00000000000044, 43.900000000000006, -50.00000000000044, 41.30000000000001, 14.899999999999771, 37.10000000000003, 39.50000000000002, -50.00000000000044, 31.900000000000013, -50.00000000000044, -50.00000000000044, 35.500000000000036, 43.30000000000001, 46.5, 43.30000000000001, -50.00000000000044, -50.00000000000044, 45.9, 45.7, 37.70000000000003, -50.00000000000044, -50.00000000000044, 39.300000000000026, -50.00000000000044, 17.499999999999808, 9.499999999999694, 45.5, -50.00000000000044, 36.50000000000003, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 46.699999999999996, 46.3, -50.00000000000044, 39.10000000000002, 45.5, -50.00000000000044, -50.00000000000044, 7.899999999999672, 43.900000000000006, -50.00000000000044, 36.50000000000003, 45.7, -50.00000000000044, 41.70000000000002, 44.7, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.099999999999987, -50.00000000000044, 38.10000000000002, -50.00000000000044, -50.00000000000044, 46.3, 42.10000000000001, 47.5, 35.900000000000034, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 45.1, 40.30000000000002, 35.10000000000004], "episode_lengths": [56, 500, 500, 52, 500, 66, 500, 500, 70, 158, 94, 80, 36, 30, 500, 40, 500, 500, 78, 86, 126, 38, 140, 58, 150, 80, 500, 162, 122, 82, 42, 42, 500, 62, 500, 88, 352, 130, 106, 500, 182, 500, 500, 146, 68, 36, 68, 500, 500, 42, 44, 124, 500, 500, 108, 500, 326, 406, 46, 500, 136, 500, 58, 500, 500, 34, 38, 500, 110, 46, 500, 500, 422, 62, 500, 136, 44, 500, 84, 54, 52, 500, 500, 500, 200, 500, 120, 500, 500, 38, 80, 26, 142, 500, 500, 60, 500, 50, 98, 150]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42292716418624177, "mean_inference_ms": 1.3529273845954646, "mean_action_processing_ms": 0.15737027773979453, "mean_env_wait_ms": 0.09526948193525618, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03099370002746582, "StateBufferConnector_ms": 0.006003141403198242, "ViewRequirementAgentConnector_ms": 0.12998390197753906}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.600999999999834, "episode_len_mean": 249.62, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.5, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 43.10000000000001, 34.30000000000004, 40.70000000000002, 42.10000000000001, 46.5, 47.1, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 42.30000000000001, 41.500000000000014, 37.50000000000003, 46.3, 36.10000000000004, 44.300000000000004, 35.10000000000004, 42.10000000000001, -50.00000000000044, 33.90000000000004, 37.90000000000003, 41.90000000000001, 45.9, 45.9, -50.00000000000044, 43.900000000000006, -50.00000000000044, 41.30000000000001, 14.899999999999771, 37.10000000000003, 39.50000000000002, -50.00000000000044, 31.900000000000013, -50.00000000000044, -50.00000000000044, 35.500000000000036, 43.30000000000001, 46.5, 43.30000000000001, -50.00000000000044, -50.00000000000044, 45.9, 45.7, 37.70000000000003, -50.00000000000044, -50.00000000000044, 39.300000000000026, -50.00000000000044, 17.499999999999808, 9.499999999999694, 45.5, -50.00000000000044, 36.50000000000003, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 46.699999999999996, 46.3, -50.00000000000044, 39.10000000000002, 45.5, -50.00000000000044, -50.00000000000044, 7.899999999999672, 43.900000000000006, -50.00000000000044, 36.50000000000003, 45.7, -50.00000000000044, 41.70000000000002, 44.7, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.099999999999987, -50.00000000000044, 38.10000000000002, -50.00000000000044, -50.00000000000044, 46.3, 42.10000000000001, 47.5, 35.900000000000034, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 45.1, 40.30000000000002, 35.10000000000004], "episode_lengths": [56, 500, 500, 52, 500, 66, 500, 500, 70, 158, 94, 80, 36, 30, 500, 40, 500, 500, 78, 86, 126, 38, 140, 58, 150, 80, 500, 162, 122, 82, 42, 42, 500, 62, 500, 88, 352, 130, 106, 500, 182, 500, 500, 146, 68, 36, 68, 500, 500, 42, 44, 124, 500, 500, 108, 500, 326, 406, 46, 500, 136, 500, 58, 500, 500, 34, 38, 500, 110, 46, 500, 500, 422, 62, 500, 136, 44, 500, 84, 54, 52, 500, 500, 500, 200, 500, 120, 500, 500, 38, 80, 26, 142, 500, 500, 60, 500, 50, 98, 150]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42292716418624177, "mean_inference_ms": 1.3529273845954646, "mean_action_processing_ms": 0.15737027773979453, "mean_env_wait_ms": 0.09526948193525618, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03099370002746582, "StateBufferConnector_ms": 0.006003141403198242, "ViewRequirementAgentConnector_ms": 0.12998390197753906}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000, "num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5439.911713401156, "num_env_steps_trained_throughput_per_sec": 5439.911713401156, "timesteps_total": 684000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 684000, "timers": {"training_iteration_time_ms": 3393.288, "sample_time_ms": 3009.687, "load_time_ms": 18.951, "load_throughput": 949817.415, "learn_time_ms": 352.615, "learn_throughput": 51047.245, "synch_weights_time_ms": 9.5}, "counters": {"num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000}, "done": false, "episodes_total": 2643, "training_iteration": 38, "trial_id": "9f288_00020", "date": "2023-10-25_17-14-05", "timestamp": 1698250445, "time_this_iter_s": 3.313873767852783, "time_total_s": 135.748957157135, "pid": 9936, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 135.748957157135, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 64.6, "ram_util_percent": 26.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.275957614183427e-13, "cur_lr": 0.0003, "total_loss": 7.176757582911739, "policy_loss": -0.00047468256067346646, "vf_loss": 7.17728528270015, "vf_explained_var": 7.064254195601851e-08, "kl": 0.0010241683861585847, "entropy": 0.5302677827852743, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1040.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 702000, "num_env_steps_trained": 702000, "num_agent_steps_sampled": 702000, "num_agent_steps_trained": 702000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.261999999999835, "episode_len_mean": 248.04, "episode_media": {}, "episodes_this_iter": 79, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.7, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.099999999999987, -50.00000000000044, 38.10000000000002, -50.00000000000044, -50.00000000000044, 46.3, 42.10000000000001, 47.5, 35.900000000000034, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 45.1, 40.30000000000002, 35.10000000000004, 0.6999999999995694, 41.70000000000002, 28.09999999999996, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 39.50000000000002, 45.5, 38.700000000000024, -50.00000000000044, 2.499999999999595, 17.099999999999802, 46.099999999999994, -50.00000000000044, 45.1, 45.1, -50.00000000000044, -50.00000000000044, 45.1, 41.90000000000001, 45.7, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 47.5, 26.09999999999993, 45.1, 38.90000000000002, 44.300000000000004, 35.30000000000004, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 40.30000000000002, 19.499999999999837, 46.9, 39.70000000000002, 46.5, 40.30000000000002, 45.1, 10.299999999999706, 32.100000000000016, 32.50000000000002, 33.90000000000004, 45.9, 42.900000000000006, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 36.30000000000003, -50.00000000000044, -50.00000000000044, 40.10000000000002, 42.900000000000006, 43.30000000000001, 23.699999999999896, 42.30000000000001, -50.00000000000044, 47.1, 42.10000000000001, -50.00000000000044, 46.099999999999994, 25.099999999999916, -50.00000000000044, 33.10000000000003, -50.00000000000044, 19.09999999999983, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 45.9, 42.30000000000001, 42.10000000000001], "episode_lengths": [54, 52, 500, 500, 500, 200, 500, 120, 500, 500, 38, 80, 26, 142, 500, 500, 60, 500, 50, 98, 150, 494, 84, 220, 500, 54, 500, 500, 106, 46, 114, 500, 476, 330, 40, 500, 50, 50, 500, 500, 50, 82, 44, 68, 500, 500, 500, 78, 26, 240, 50, 112, 58, 148, 500, 500, 38, 500, 98, 306, 32, 104, 36, 98, 50, 398, 180, 176, 162, 42, 72, 500, 500, 58, 500, 138, 500, 500, 100, 72, 68, 264, 78, 500, 30, 80, 500, 40, 250, 500, 170, 500, 310, 500, 500, 500, 64, 42, 78, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42178977116569255, "mean_inference_ms": 1.3485744132896444, "mean_action_processing_ms": 0.1571629151136852, "mean_env_wait_ms": 0.09479959108579811, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02599167823791504, "StateBufferConnector_ms": 0.004999876022338867, "ViewRequirementAgentConnector_ms": 0.12702655792236328}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.261999999999835, "episode_len_mean": 248.04, "episodes_this_iter": 79, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.7, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.099999999999987, -50.00000000000044, 38.10000000000002, -50.00000000000044, -50.00000000000044, 46.3, 42.10000000000001, 47.5, 35.900000000000034, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 45.1, 40.30000000000002, 35.10000000000004, 0.6999999999995694, 41.70000000000002, 28.09999999999996, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 39.50000000000002, 45.5, 38.700000000000024, -50.00000000000044, 2.499999999999595, 17.099999999999802, 46.099999999999994, -50.00000000000044, 45.1, 45.1, -50.00000000000044, -50.00000000000044, 45.1, 41.90000000000001, 45.7, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 47.5, 26.09999999999993, 45.1, 38.90000000000002, 44.300000000000004, 35.30000000000004, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 40.30000000000002, 19.499999999999837, 46.9, 39.70000000000002, 46.5, 40.30000000000002, 45.1, 10.299999999999706, 32.100000000000016, 32.50000000000002, 33.90000000000004, 45.9, 42.900000000000006, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 36.30000000000003, -50.00000000000044, -50.00000000000044, 40.10000000000002, 42.900000000000006, 43.30000000000001, 23.699999999999896, 42.30000000000001, -50.00000000000044, 47.1, 42.10000000000001, -50.00000000000044, 46.099999999999994, 25.099999999999916, -50.00000000000044, 33.10000000000003, -50.00000000000044, 19.09999999999983, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 45.9, 42.30000000000001, 42.10000000000001], "episode_lengths": [54, 52, 500, 500, 500, 200, 500, 120, 500, 500, 38, 80, 26, 142, 500, 500, 60, 500, 50, 98, 150, 494, 84, 220, 500, 54, 500, 500, 106, 46, 114, 500, 476, 330, 40, 500, 50, 50, 500, 500, 50, 82, 44, 68, 500, 500, 500, 78, 26, 240, 50, 112, 58, 148, 500, 500, 38, 500, 98, 306, 32, 104, 36, 98, 50, 398, 180, 176, 162, 42, 72, 500, 500, 58, 500, 138, 500, 500, 100, 72, 68, 264, 78, 500, 30, 80, 500, 40, 250, 500, 170, 500, 310, 500, 500, 500, 64, 42, 78, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42178977116569255, "mean_inference_ms": 1.3485744132896444, "mean_action_processing_ms": 0.1571629151136852, "mean_env_wait_ms": 0.09479959108579811, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02599167823791504, "StateBufferConnector_ms": 0.004999876022338867, "ViewRequirementAgentConnector_ms": 0.12702655792236328}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 702000, "num_agent_steps_trained": 702000, "num_env_steps_sampled": 702000, "num_env_steps_trained": 702000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5651.530388360721, "num_env_steps_trained_throughput_per_sec": 5651.530388360721, "timesteps_total": 702000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 702000, "timers": {"training_iteration_time_ms": 3359.38, "sample_time_ms": 2981.11, "load_time_ms": 18.466, "load_throughput": 974754.586, "learn_time_ms": 347.862, "learn_throughput": 51744.699, "synch_weights_time_ms": 9.505}, "counters": {"num_env_steps_sampled": 702000, "num_env_steps_trained": 702000, "num_agent_steps_sampled": 702000, "num_agent_steps_trained": 702000}, "done": false, "episodes_total": 2722, "training_iteration": 39, "trial_id": "9f288_00020", "date": "2023-10-25_17-14-08", "timestamp": 1698250448, "time_this_iter_s": 3.189967393875122, "time_total_s": 138.93892455101013, "pid": 9936, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 138.93892455101013, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 56.38000000000001, "ram_util_percent": 26.939999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.6379788070917137e-13, "cur_lr": 0.0003, "total_loss": 6.817289511362712, "policy_loss": -0.0003016640742619832, "vf_loss": 6.817638079325358, "vf_explained_var": -5.850085505732784e-07, "kl": 0.0005165928725242944, "entropy": 0.4694338187023445, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1067.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.455999999999841, "episode_len_mean": 246.12, "episode_media": {}, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 36.30000000000003, -50.00000000000044, -50.00000000000044, 40.10000000000002, 42.900000000000006, 43.30000000000001, 23.699999999999896, 42.30000000000001, -50.00000000000044, 47.1, 42.10000000000001, -50.00000000000044, 46.099999999999994, 25.099999999999916, -50.00000000000044, 33.10000000000003, -50.00000000000044, 19.09999999999983, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 45.9, 42.30000000000001, 42.10000000000001, -50.00000000000044, 46.699999999999996, -50.00000000000044, 42.500000000000014, 19.899999999999842, 15.299999999999777, 39.300000000000026, 40.30000000000002, 43.50000000000001, -50.00000000000044, -50.00000000000044, 39.300000000000026, 20.099999999999845, 45.3, 36.30000000000003, -50.00000000000044, 38.50000000000003, 46.5, 40.10000000000002, -50.00000000000044, -50.00000000000044, 44.5, 30.9, -50.00000000000044, 42.500000000000014, -50.00000000000044, 15.49999999999978, 46.699999999999996, 45.1, 39.90000000000002, 30.499999999999993, 42.30000000000001, -50.00000000000044, 5.899999999999643, -50.00000000000044, 44.300000000000004, -50.00000000000044, 45.9, 32.30000000000002, 45.7, -50.00000000000044, -50.00000000000044, 46.3, 42.500000000000014, 11.699999999999726, 39.90000000000002, 41.90000000000001, 34.900000000000034, 28.09999999999996, 35.70000000000003, 44.10000000000001, 39.70000000000002, 45.5, 43.7, 47.1, 30.9, -50.00000000000044, 46.5, 8.699999999999683, 34.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 27.49999999999995, 42.900000000000006, 36.70000000000003, 44.5, 45.5, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 58, 500, 138, 500, 500, 100, 72, 68, 264, 78, 500, 30, 80, 500, 40, 250, 500, 170, 500, 310, 500, 500, 500, 64, 42, 78, 80, 500, 34, 500, 76, 302, 348, 108, 98, 66, 500, 500, 108, 300, 48, 138, 500, 116, 36, 100, 500, 500, 56, 192, 500, 76, 500, 346, 34, 50, 102, 196, 78, 500, 442, 500, 58, 500, 42, 178, 44, 500, 500, 38, 76, 384, 102, 82, 152, 220, 144, 60, 104, 46, 64, 30, 192, 500, 36, 414, 160, 500, 500, 500, 80, 226, 72, 134, 56, 46, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4208373009205678, "mean_inference_ms": 1.3459863436132233, "mean_action_processing_ms": 0.15684903011719245, "mean_env_wait_ms": 0.09466220835147694, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03199934959411621, "StateBufferConnector_ms": 0.005002737045288086, "ViewRequirementAgentConnector_ms": 0.11497020721435547}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.455999999999841, "episode_len_mean": 246.12, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 36.30000000000003, -50.00000000000044, -50.00000000000044, 40.10000000000002, 42.900000000000006, 43.30000000000001, 23.699999999999896, 42.30000000000001, -50.00000000000044, 47.1, 42.10000000000001, -50.00000000000044, 46.099999999999994, 25.099999999999916, -50.00000000000044, 33.10000000000003, -50.00000000000044, 19.09999999999983, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 45.9, 42.30000000000001, 42.10000000000001, -50.00000000000044, 46.699999999999996, -50.00000000000044, 42.500000000000014, 19.899999999999842, 15.299999999999777, 39.300000000000026, 40.30000000000002, 43.50000000000001, -50.00000000000044, -50.00000000000044, 39.300000000000026, 20.099999999999845, 45.3, 36.30000000000003, -50.00000000000044, 38.50000000000003, 46.5, 40.10000000000002, -50.00000000000044, -50.00000000000044, 44.5, 30.9, -50.00000000000044, 42.500000000000014, -50.00000000000044, 15.49999999999978, 46.699999999999996, 45.1, 39.90000000000002, 30.499999999999993, 42.30000000000001, -50.00000000000044, 5.899999999999643, -50.00000000000044, 44.300000000000004, -50.00000000000044, 45.9, 32.30000000000002, 45.7, -50.00000000000044, -50.00000000000044, 46.3, 42.500000000000014, 11.699999999999726, 39.90000000000002, 41.90000000000001, 34.900000000000034, 28.09999999999996, 35.70000000000003, 44.10000000000001, 39.70000000000002, 45.5, 43.7, 47.1, 30.9, -50.00000000000044, 46.5, 8.699999999999683, 34.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 27.49999999999995, 42.900000000000006, 36.70000000000003, 44.5, 45.5, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 58, 500, 138, 500, 500, 100, 72, 68, 264, 78, 500, 30, 80, 500, 40, 250, 500, 170, 500, 310, 500, 500, 500, 64, 42, 78, 80, 500, 34, 500, 76, 302, 348, 108, 98, 66, 500, 500, 108, 300, 48, 138, 500, 116, 36, 100, 500, 500, 56, 192, 500, 76, 500, 346, 34, 50, 102, 196, 78, 500, 442, 500, 58, 500, 42, 178, 44, 500, 500, 38, 76, 384, 102, 82, 152, 220, 144, 60, 104, 46, 64, 30, 192, 500, 36, 414, 160, 500, 500, 500, 80, 226, 72, 134, 56, 46, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4208373009205678, "mean_inference_ms": 1.3459863436132233, "mean_action_processing_ms": 0.15684903011719245, "mean_env_wait_ms": 0.09466220835147694, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03199934959411621, "StateBufferConnector_ms": 0.005002737045288086, "ViewRequirementAgentConnector_ms": 0.11497020721435547}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4773.734601819265, "num_env_steps_trained_throughput_per_sec": 4773.734601819265, "timesteps_total": 720000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 720000, "timers": {"training_iteration_time_ms": 3353.908, "sample_time_ms": 2964.646, "load_time_ms": 19.265, "load_throughput": 934346.901, "learn_time_ms": 358.595, "learn_throughput": 50195.972, "synch_weights_time_ms": 9.3}, "counters": {"num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "done": false, "episodes_total": 2793, "training_iteration": 40, "trial_id": "9f288_00020", "date": "2023-10-25_17-14-12", "timestamp": 1698250452, "time_this_iter_s": 3.7766306400299072, "time_total_s": 142.71555519104004, "pid": 9936, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 142.71555519104004, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 54.919999999999995, "ram_util_percent": 26.96}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.8189894035458568e-13, "cur_lr": 0.0003, "total_loss": 6.779031665236862, "policy_loss": -0.0001688227747325544, "vf_loss": 6.779251858040139, "vf_explained_var": -8.455029240360966e-07, "kl": 0.00048344832910754524, "entropy": 0.5144517752859328, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1094.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 738000, "num_env_steps_trained": 738000, "num_agent_steps_sampled": 738000, "num_agent_steps_trained": 738000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.004999999999834, "episode_len_mean": 245.6, "episode_media": {}, "episodes_this_iter": 77, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [28.09999999999996, 35.70000000000003, 44.10000000000001, 39.70000000000002, 45.5, 43.7, 47.1, 30.9, -50.00000000000044, 46.5, 8.699999999999683, 34.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 27.49999999999995, 42.900000000000006, 36.70000000000003, 44.5, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 36.70000000000003, 41.500000000000014, 35.500000000000036, 46.699999999999996, -50.00000000000044, 19.09999999999983, -50.00000000000044, -50.00000000000044, 36.50000000000003, 41.100000000000016, 45.3, 46.699999999999996, 45.9, 1.4999999999995808, 42.10000000000001, 43.7, -50.00000000000044, 43.7, 36.30000000000003, 46.099999999999994, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 42.500000000000014, -50.00000000000044, 42.30000000000001, 25.899999999999928, 18.099999999999817, -50.00000000000044, 42.30000000000001, 44.10000000000001, -50.00000000000044, -50.00000000000044, 43.7, 39.300000000000026, 43.900000000000006, 45.5, 45.7, 44.900000000000006, 42.10000000000001, 42.500000000000014, 46.3, -50.00000000000044, -50.00000000000044, 25.499999999999922, 20.099999999999845, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 45.1, 46.5, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 23.099999999999888, -50.00000000000044, -50.00000000000044, 45.3, 43.900000000000006, 47.5, 46.699999999999996, -50.00000000000044, 41.500000000000014, 45.9], "episode_lengths": [220, 144, 60, 104, 46, 64, 30, 192, 500, 36, 414, 160, 500, 500, 500, 80, 226, 72, 134, 56, 46, 500, 500, 500, 500, 64, 134, 86, 146, 34, 500, 310, 500, 500, 136, 90, 48, 34, 42, 486, 80, 64, 500, 64, 138, 40, 500, 500, 130, 500, 500, 500, 500, 62, 76, 500, 78, 242, 320, 500, 78, 60, 500, 500, 64, 108, 62, 46, 44, 52, 80, 76, 38, 500, 500, 246, 300, 500, 500, 500, 48, 500, 50, 36, 500, 44, 500, 500, 500, 72, 270, 500, 500, 48, 62, 26, 34, 500, 86, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4196553417282179, "mean_inference_ms": 1.3415562160592018, "mean_action_processing_ms": 0.15655381628625986, "mean_env_wait_ms": 0.09405248457560336, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023963212966918945, "StateBufferConnector_ms": 0.006008148193359375, "ViewRequirementAgentConnector_ms": 0.11500668525695801}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.004999999999834, "episode_len_mean": 245.6, "episodes_this_iter": 77, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [28.09999999999996, 35.70000000000003, 44.10000000000001, 39.70000000000002, 45.5, 43.7, 47.1, 30.9, -50.00000000000044, 46.5, 8.699999999999683, 34.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 27.49999999999995, 42.900000000000006, 36.70000000000003, 44.5, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 36.70000000000003, 41.500000000000014, 35.500000000000036, 46.699999999999996, -50.00000000000044, 19.09999999999983, -50.00000000000044, -50.00000000000044, 36.50000000000003, 41.100000000000016, 45.3, 46.699999999999996, 45.9, 1.4999999999995808, 42.10000000000001, 43.7, -50.00000000000044, 43.7, 36.30000000000003, 46.099999999999994, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 42.500000000000014, -50.00000000000044, 42.30000000000001, 25.899999999999928, 18.099999999999817, -50.00000000000044, 42.30000000000001, 44.10000000000001, -50.00000000000044, -50.00000000000044, 43.7, 39.300000000000026, 43.900000000000006, 45.5, 45.7, 44.900000000000006, 42.10000000000001, 42.500000000000014, 46.3, -50.00000000000044, -50.00000000000044, 25.499999999999922, 20.099999999999845, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 45.1, 46.5, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 23.099999999999888, -50.00000000000044, -50.00000000000044, 45.3, 43.900000000000006, 47.5, 46.699999999999996, -50.00000000000044, 41.500000000000014, 45.9], "episode_lengths": [220, 144, 60, 104, 46, 64, 30, 192, 500, 36, 414, 160, 500, 500, 500, 80, 226, 72, 134, 56, 46, 500, 500, 500, 500, 64, 134, 86, 146, 34, 500, 310, 500, 500, 136, 90, 48, 34, 42, 486, 80, 64, 500, 64, 138, 40, 500, 500, 130, 500, 500, 500, 500, 62, 76, 500, 78, 242, 320, 500, 78, 60, 500, 500, 64, 108, 62, 46, 44, 52, 80, 76, 38, 500, 500, 246, 300, 500, 500, 500, 48, 500, 50, 36, 500, 44, 500, 500, 500, 72, 270, 500, 500, 48, 62, 26, 34, 500, 86, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4196553417282179, "mean_inference_ms": 1.3415562160592018, "mean_action_processing_ms": 0.15655381628625986, "mean_env_wait_ms": 0.09405248457560336, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023963212966918945, "StateBufferConnector_ms": 0.006008148193359375, "ViewRequirementAgentConnector_ms": 0.11500668525695801}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 738000, "num_agent_steps_trained": 738000, "num_env_steps_sampled": 738000, "num_env_steps_trained": 738000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5584.905012749545, "num_env_steps_trained_throughput_per_sec": 5584.905012749545, "timesteps_total": 738000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 738000, "timers": {"training_iteration_time_ms": 3335.896, "sample_time_ms": 2951.833, "load_time_ms": 19.309, "load_throughput": 932190.697, "learn_time_ms": 353.351, "learn_throughput": 50940.887, "synch_weights_time_ms": 9.3}, "counters": {"num_env_steps_sampled": 738000, "num_env_steps_trained": 738000, "num_agent_steps_sampled": 738000, "num_agent_steps_trained": 738000}, "done": false, "episodes_total": 2870, "training_iteration": 41, "trial_id": "9f288_00020", "date": "2023-10-25_17-14-15", "timestamp": 1698250455, "time_this_iter_s": 3.2279698848724365, "time_total_s": 145.94352507591248, "pid": 9936, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 145.94352507591248, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 54.8, "ram_util_percent": 26.919999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.094947017729284e-14, "cur_lr": 0.0003, "total_loss": 7.2092263963487415, "policy_loss": -2.9857097952454178e-05, "vf_loss": 7.209307335041188, "vf_explained_var": -7.638224848994502e-07, "kl": 0.00013814325797073328, "entropy": 0.5095209070929775, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1121.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.24299999999983, "episode_len_mean": 253.24, "episode_media": {}, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 25.499999999999922, 20.099999999999845, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 45.1, 46.5, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 23.099999999999888, -50.00000000000044, -50.00000000000044, 45.3, 43.900000000000006, 47.5, 46.699999999999996, -50.00000000000044, 41.500000000000014, 45.9, 45.3, 45.1, 41.90000000000001, -50.00000000000044, 46.699999999999996, 40.500000000000014, -50.00000000000044, 28.499999999999964, 44.7, -50.00000000000044, 22.899999999999885, 43.10000000000001, -50.00000000000044, 41.500000000000014, -50.00000000000044, 38.700000000000024, -50.00000000000044, 15.899999999999785, 37.70000000000003, -50.00000000000044, 24.299999999999905, -50.00000000000044, 43.10000000000001, 44.900000000000006, 33.500000000000036, -50.00000000000044, 37.50000000000003, 39.90000000000002, 42.30000000000001, 45.1, -50.00000000000044, -50.00000000000044, 43.7, 33.30000000000003, -50.00000000000044, 37.70000000000003, -50.00000000000044, -50.00000000000044, 1.8999999999995865, 3.499999999999609, -50.00000000000044, 44.10000000000001, 41.70000000000002, 41.100000000000016, -50.00000000000044, 44.5, 43.7, 30.29999999999999, 43.30000000000001, 44.7, -50.00000000000044, 41.30000000000001, 38.700000000000024, 43.50000000000001, 13.499999999999751, -50.00000000000044, 21.499999999999865, 44.7, -50.00000000000044, 21.699999999999868, 41.30000000000001, 47.3, 45.1, 43.50000000000001, -50.00000000000044, 25.699999999999925, 43.10000000000001, 27.899999999999956, 6.299999999999649, 46.699999999999996, 45.3, -50.00000000000044, 11.499999999999723, 44.10000000000001], "episode_lengths": [500, 246, 300, 500, 500, 500, 48, 500, 50, 36, 500, 44, 500, 500, 500, 72, 270, 500, 500, 48, 62, 26, 34, 500, 86, 42, 48, 50, 82, 500, 34, 96, 500, 216, 54, 500, 272, 70, 500, 86, 500, 114, 500, 342, 124, 500, 258, 500, 70, 52, 166, 500, 126, 102, 78, 50, 500, 500, 64, 168, 500, 124, 500, 500, 482, 466, 500, 60, 84, 90, 500, 56, 64, 198, 68, 54, 500, 88, 114, 66, 366, 500, 286, 54, 500, 284, 88, 28, 50, 66, 500, 244, 70, 222, 438, 34, 48, 500, 386, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41819490186704145, "mean_inference_ms": 1.3382604038946653, "mean_action_processing_ms": 0.15565367363395327, "mean_env_wait_ms": 0.0939926523348462, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021996736526489258, "StateBufferConnector_ms": 0.005003452301025391, "ViewRequirementAgentConnector_ms": 0.13000917434692383}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.24299999999983, "episode_len_mean": 253.24, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 25.499999999999922, 20.099999999999845, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 45.1, 46.5, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 23.099999999999888, -50.00000000000044, -50.00000000000044, 45.3, 43.900000000000006, 47.5, 46.699999999999996, -50.00000000000044, 41.500000000000014, 45.9, 45.3, 45.1, 41.90000000000001, -50.00000000000044, 46.699999999999996, 40.500000000000014, -50.00000000000044, 28.499999999999964, 44.7, -50.00000000000044, 22.899999999999885, 43.10000000000001, -50.00000000000044, 41.500000000000014, -50.00000000000044, 38.700000000000024, -50.00000000000044, 15.899999999999785, 37.70000000000003, -50.00000000000044, 24.299999999999905, -50.00000000000044, 43.10000000000001, 44.900000000000006, 33.500000000000036, -50.00000000000044, 37.50000000000003, 39.90000000000002, 42.30000000000001, 45.1, -50.00000000000044, -50.00000000000044, 43.7, 33.30000000000003, -50.00000000000044, 37.70000000000003, -50.00000000000044, -50.00000000000044, 1.8999999999995865, 3.499999999999609, -50.00000000000044, 44.10000000000001, 41.70000000000002, 41.100000000000016, -50.00000000000044, 44.5, 43.7, 30.29999999999999, 43.30000000000001, 44.7, -50.00000000000044, 41.30000000000001, 38.700000000000024, 43.50000000000001, 13.499999999999751, -50.00000000000044, 21.499999999999865, 44.7, -50.00000000000044, 21.699999999999868, 41.30000000000001, 47.3, 45.1, 43.50000000000001, -50.00000000000044, 25.699999999999925, 43.10000000000001, 27.899999999999956, 6.299999999999649, 46.699999999999996, 45.3, -50.00000000000044, 11.499999999999723, 44.10000000000001], "episode_lengths": [500, 246, 300, 500, 500, 500, 48, 500, 50, 36, 500, 44, 500, 500, 500, 72, 270, 500, 500, 48, 62, 26, 34, 500, 86, 42, 48, 50, 82, 500, 34, 96, 500, 216, 54, 500, 272, 70, 500, 86, 500, 114, 500, 342, 124, 500, 258, 500, 70, 52, 166, 500, 126, 102, 78, 50, 500, 500, 64, 168, 500, 124, 500, 500, 482, 466, 500, 60, 84, 90, 500, 56, 64, 198, 68, 54, 500, 88, 114, 66, 366, 500, 286, 54, 500, 284, 88, 28, 50, 66, 500, 244, 70, 222, 438, 34, 48, 500, 386, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41819490186704145, "mean_inference_ms": 1.3382604038946653, "mean_action_processing_ms": 0.15565367363395327, "mean_env_wait_ms": 0.0939926523348462, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021996736526489258, "StateBufferConnector_ms": 0.005003452301025391, "ViewRequirementAgentConnector_ms": 0.13000917434692383}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000, "num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5561.52814105922, "num_env_steps_trained_throughput_per_sec": 5561.52814105922, "timesteps_total": 756000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 756000, "timers": {"training_iteration_time_ms": 3349.259, "sample_time_ms": 2948.073, "load_time_ms": 20.508, "load_throughput": 877687.756, "learn_time_ms": 369.346, "learn_throughput": 48734.841, "synch_weights_time_ms": 9.33}, "counters": {"num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000}, "done": false, "episodes_total": 2944, "training_iteration": 42, "trial_id": "9f288_00020", "date": "2023-10-25_17-14-18", "timestamp": 1698250458, "time_this_iter_s": 3.2415201663970947, "time_total_s": 149.18504524230957, "pid": 9936, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 149.18504524230957, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 64.9, "ram_util_percent": 26.924999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.547473508864642e-14, "cur_lr": 0.0003, "total_loss": 7.061330636342366, "policy_loss": -0.0009268028661608696, "vf_loss": 7.062310783951371, "vf_explained_var": -1.0750911853931569e-06, "kl": 0.0010894319024167224, "entropy": 0.5328940925774751, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1148.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 774000, "num_env_steps_trained": 774000, "num_agent_steps_sampled": 774000, "num_agent_steps_trained": 774000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 14.746999999999861, "episode_len_mean": 228.28, "episode_media": {}, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [30.29999999999999, 43.30000000000001, 44.7, -50.00000000000044, 41.30000000000001, 38.700000000000024, 43.50000000000001, 13.499999999999751, -50.00000000000044, 21.499999999999865, 44.7, -50.00000000000044, 21.699999999999868, 41.30000000000001, 47.3, 45.1, 43.50000000000001, -50.00000000000044, 25.699999999999925, 43.10000000000001, 27.899999999999956, 6.299999999999649, 46.699999999999996, 45.3, -50.00000000000044, 11.499999999999723, 44.10000000000001, 15.099999999999774, -50.00000000000044, -50.00000000000044, 20.299999999999848, 41.70000000000002, 38.90000000000002, 33.90000000000004, -50.00000000000044, 43.900000000000006, 39.10000000000002, 47.3, -50.00000000000044, 42.70000000000001, 31.70000000000001, 44.5, -50.00000000000044, 46.3, -50.00000000000044, 45.3, 44.7, 46.3, -50.00000000000044, -50.00000000000044, 42.10000000000001, 46.3, 44.900000000000006, 25.899999999999928, -50.00000000000044, 40.90000000000002, -50.00000000000044, 5.099999999999632, -50.00000000000044, 42.30000000000001, 46.5, -50.00000000000044, 30.099999999999987, 39.50000000000002, 40.10000000000002, 16.699999999999797, 24.299999999999905, 29.49999999999998, -50.00000000000044, 45.3, 34.900000000000034, 19.09999999999983, 46.699999999999996, 29.899999999999984, 45.5, 3.899999999999615, 39.70000000000002, -50.00000000000044, 32.50000000000002, -50.00000000000044, 46.9, 44.900000000000006, -50.00000000000044, 26.09999999999993, 42.30000000000001, 43.50000000000001, -50.00000000000044, 41.70000000000002, 27.099999999999945, 44.7, 46.5, -50.00000000000044, 42.500000000000014, 40.70000000000002, 24.299999999999905, -50.00000000000044, -50.00000000000044, 42.500000000000014, 41.30000000000001, 45.3], "episode_lengths": [198, 68, 54, 500, 88, 114, 66, 366, 500, 286, 54, 500, 284, 88, 28, 50, 66, 500, 244, 70, 222, 438, 34, 48, 500, 386, 60, 350, 500, 500, 298, 84, 112, 162, 500, 62, 110, 28, 500, 74, 184, 56, 500, 38, 500, 48, 54, 38, 500, 500, 80, 38, 52, 242, 500, 92, 500, 450, 500, 78, 36, 500, 200, 106, 100, 334, 258, 206, 500, 48, 152, 310, 34, 202, 46, 462, 104, 500, 176, 500, 32, 52, 500, 240, 78, 66, 500, 84, 230, 54, 36, 500, 76, 94, 258, 500, 500, 76, 88, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4175852770814697, "mean_inference_ms": 1.3341976432763827, "mean_action_processing_ms": 0.15549938879451852, "mean_env_wait_ms": 0.09380107558013445, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03000640869140625, "StateBufferConnector_ms": 0.0030014514923095703, "ViewRequirementAgentConnector_ms": 0.10898828506469727}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 14.746999999999861, "episode_len_mean": 228.28, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [30.29999999999999, 43.30000000000001, 44.7, -50.00000000000044, 41.30000000000001, 38.700000000000024, 43.50000000000001, 13.499999999999751, -50.00000000000044, 21.499999999999865, 44.7, -50.00000000000044, 21.699999999999868, 41.30000000000001, 47.3, 45.1, 43.50000000000001, -50.00000000000044, 25.699999999999925, 43.10000000000001, 27.899999999999956, 6.299999999999649, 46.699999999999996, 45.3, -50.00000000000044, 11.499999999999723, 44.10000000000001, 15.099999999999774, -50.00000000000044, -50.00000000000044, 20.299999999999848, 41.70000000000002, 38.90000000000002, 33.90000000000004, -50.00000000000044, 43.900000000000006, 39.10000000000002, 47.3, -50.00000000000044, 42.70000000000001, 31.70000000000001, 44.5, -50.00000000000044, 46.3, -50.00000000000044, 45.3, 44.7, 46.3, -50.00000000000044, -50.00000000000044, 42.10000000000001, 46.3, 44.900000000000006, 25.899999999999928, -50.00000000000044, 40.90000000000002, -50.00000000000044, 5.099999999999632, -50.00000000000044, 42.30000000000001, 46.5, -50.00000000000044, 30.099999999999987, 39.50000000000002, 40.10000000000002, 16.699999999999797, 24.299999999999905, 29.49999999999998, -50.00000000000044, 45.3, 34.900000000000034, 19.09999999999983, 46.699999999999996, 29.899999999999984, 45.5, 3.899999999999615, 39.70000000000002, -50.00000000000044, 32.50000000000002, -50.00000000000044, 46.9, 44.900000000000006, -50.00000000000044, 26.09999999999993, 42.30000000000001, 43.50000000000001, -50.00000000000044, 41.70000000000002, 27.099999999999945, 44.7, 46.5, -50.00000000000044, 42.500000000000014, 40.70000000000002, 24.299999999999905, -50.00000000000044, -50.00000000000044, 42.500000000000014, 41.30000000000001, 45.3], "episode_lengths": [198, 68, 54, 500, 88, 114, 66, 366, 500, 286, 54, 500, 284, 88, 28, 50, 66, 500, 244, 70, 222, 438, 34, 48, 500, 386, 60, 350, 500, 500, 298, 84, 112, 162, 500, 62, 110, 28, 500, 74, 184, 56, 500, 38, 500, 48, 54, 38, 500, 500, 80, 38, 52, 242, 500, 92, 500, 450, 500, 78, 36, 500, 200, 106, 100, 334, 258, 206, 500, 48, 152, 310, 34, 202, 46, 462, 104, 500, 176, 500, 32, 52, 500, 240, 78, 66, 500, 84, 230, 54, 36, 500, 76, 94, 258, 500, 500, 76, 88, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4175852770814697, "mean_inference_ms": 1.3341976432763827, "mean_action_processing_ms": 0.15549938879451852, "mean_env_wait_ms": 0.09380107558013445, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03000640869140625, "StateBufferConnector_ms": 0.0030014514923095703, "ViewRequirementAgentConnector_ms": 0.10898828506469727}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 774000, "num_agent_steps_trained": 774000, "num_env_steps_sampled": 774000, "num_env_steps_trained": 774000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5671.121763662246, "num_env_steps_trained_throughput_per_sec": 5671.121763662246, "timesteps_total": 774000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 774000, "timers": {"training_iteration_time_ms": 3341.501, "sample_time_ms": 2942.815, "load_time_ms": 19.708, "load_throughput": 913315.276, "learn_time_ms": 367.649, "learn_throughput": 48959.788, "synch_weights_time_ms": 9.427}, "counters": {"num_env_steps_sampled": 774000, "num_env_steps_trained": 774000, "num_agent_steps_sampled": 774000, "num_agent_steps_trained": 774000}, "done": false, "episodes_total": 3017, "training_iteration": 43, "trial_id": "9f288_00020", "date": "2023-10-25_17-14-22", "timestamp": 1698250462, "time_this_iter_s": 3.1789748668670654, "time_total_s": 152.36402010917664, "pid": 9936, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 152.36402010917664, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 58.48, "ram_util_percent": 26.939999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.273736754432321e-14, "cur_lr": 0.0003, "total_loss": 7.042847456755461, "policy_loss": -0.0003144337485233943, "vf_loss": 7.043215345453333, "vf_explained_var": -1.037562334979022e-06, "kl": 0.0005697981017057693, "entropy": 0.5353299445576138, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1175.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.431999999999846, "episode_len_mean": 246.36, "episode_media": {}, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19.09999999999983, 46.699999999999996, 29.899999999999984, 45.5, 3.899999999999615, 39.70000000000002, -50.00000000000044, 32.50000000000002, -50.00000000000044, 46.9, 44.900000000000006, -50.00000000000044, 26.09999999999993, 42.30000000000001, 43.50000000000001, -50.00000000000044, 41.70000000000002, 27.099999999999945, 44.7, 46.5, -50.00000000000044, 42.500000000000014, 40.70000000000002, 24.299999999999905, -50.00000000000044, -50.00000000000044, 42.500000000000014, 41.30000000000001, 45.3, -50.00000000000044, -50.00000000000044, 42.500000000000014, 44.900000000000006, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 43.7, 39.10000000000002, -50.00000000000044, 31.900000000000013, -50.00000000000044, 39.90000000000002, 35.10000000000004, 45.9, -50.00000000000044, 41.90000000000001, 42.10000000000001, 38.90000000000002, 34.10000000000004, 41.30000000000001, 11.499999999999723, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 24.099999999999902, 39.10000000000002, 38.700000000000024, -50.00000000000044, 24.499999999999908, 30.499999999999993, -50.00000000000044, 35.70000000000003, 36.50000000000003, 46.5, 44.5, 11.499999999999723, 41.90000000000001, 42.70000000000001, 17.499999999999808, -50.00000000000044, 46.099999999999994, 44.300000000000004, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 33.10000000000003, 42.10000000000001, -50.00000000000044, 44.10000000000001, 46.3, 5.499999999999638, -50.00000000000044, 38.700000000000024, 46.5, -50.00000000000044, 43.900000000000006, 43.50000000000001, 24.899999999999913, 44.900000000000006, 37.10000000000003, -50.00000000000044, 35.10000000000004, -50.00000000000044, -50.00000000000044], "episode_lengths": [310, 34, 202, 46, 462, 104, 500, 176, 500, 32, 52, 500, 240, 78, 66, 500, 84, 230, 54, 36, 500, 76, 94, 258, 500, 500, 76, 88, 48, 500, 500, 76, 52, 500, 500, 52, 500, 500, 64, 110, 500, 182, 500, 102, 150, 42, 500, 82, 80, 112, 160, 88, 386, 500, 48, 500, 500, 260, 110, 114, 500, 256, 196, 500, 144, 136, 36, 56, 386, 82, 74, 326, 500, 40, 58, 500, 36, 500, 500, 38, 500, 170, 80, 500, 60, 38, 446, 500, 114, 36, 500, 62, 66, 252, 52, 130, 500, 150, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4159926545660138, "mean_inference_ms": 1.3308485615727141, "mean_action_processing_ms": 0.15482564146411687, "mean_env_wait_ms": 0.09346391987192038, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031006336212158203, "StateBufferConnector_ms": 0.003000497817993164, "ViewRequirementAgentConnector_ms": 0.11300826072692871}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.431999999999846, "episode_len_mean": 246.36, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [19.09999999999983, 46.699999999999996, 29.899999999999984, 45.5, 3.899999999999615, 39.70000000000002, -50.00000000000044, 32.50000000000002, -50.00000000000044, 46.9, 44.900000000000006, -50.00000000000044, 26.09999999999993, 42.30000000000001, 43.50000000000001, -50.00000000000044, 41.70000000000002, 27.099999999999945, 44.7, 46.5, -50.00000000000044, 42.500000000000014, 40.70000000000002, 24.299999999999905, -50.00000000000044, -50.00000000000044, 42.500000000000014, 41.30000000000001, 45.3, -50.00000000000044, -50.00000000000044, 42.500000000000014, 44.900000000000006, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 43.7, 39.10000000000002, -50.00000000000044, 31.900000000000013, -50.00000000000044, 39.90000000000002, 35.10000000000004, 45.9, -50.00000000000044, 41.90000000000001, 42.10000000000001, 38.90000000000002, 34.10000000000004, 41.30000000000001, 11.499999999999723, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 24.099999999999902, 39.10000000000002, 38.700000000000024, -50.00000000000044, 24.499999999999908, 30.499999999999993, -50.00000000000044, 35.70000000000003, 36.50000000000003, 46.5, 44.5, 11.499999999999723, 41.90000000000001, 42.70000000000001, 17.499999999999808, -50.00000000000044, 46.099999999999994, 44.300000000000004, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 33.10000000000003, 42.10000000000001, -50.00000000000044, 44.10000000000001, 46.3, 5.499999999999638, -50.00000000000044, 38.700000000000024, 46.5, -50.00000000000044, 43.900000000000006, 43.50000000000001, 24.899999999999913, 44.900000000000006, 37.10000000000003, -50.00000000000044, 35.10000000000004, -50.00000000000044, -50.00000000000044], "episode_lengths": [310, 34, 202, 46, 462, 104, 500, 176, 500, 32, 52, 500, 240, 78, 66, 500, 84, 230, 54, 36, 500, 76, 94, 258, 500, 500, 76, 88, 48, 500, 500, 76, 52, 500, 500, 52, 500, 500, 64, 110, 500, 182, 500, 102, 150, 42, 500, 82, 80, 112, 160, 88, 386, 500, 48, 500, 500, 260, 110, 114, 500, 256, 196, 500, 144, 136, 36, 56, 386, 82, 74, 326, 500, 40, 58, 500, 36, 500, 500, 38, 500, 170, 80, 500, 60, 38, 446, 500, 114, 36, 500, 62, 66, 252, 52, 130, 500, 150, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4159926545660138, "mean_inference_ms": 1.3308485615727141, "mean_action_processing_ms": 0.15482564146411687, "mean_env_wait_ms": 0.09346391987192038, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031006336212158203, "StateBufferConnector_ms": 0.003000497817993164, "ViewRequirementAgentConnector_ms": 0.11300826072692871}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000, "num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5964.2629934635015, "num_env_steps_trained_throughput_per_sec": 5964.2629934635015, "timesteps_total": 792000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 792000, "timers": {"training_iteration_time_ms": 3287.537, "sample_time_ms": 2908.551, "load_time_ms": 18.509, "load_throughput": 972509.545, "learn_time_ms": 349.245, "learn_throughput": 51539.697, "synch_weights_time_ms": 9.33}, "counters": {"num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000}, "done": false, "episodes_total": 3088, "training_iteration": 44, "trial_id": "9f288_00020", "date": "2023-10-25_17-14-25", "timestamp": 1698250465, "time_this_iter_s": 3.023972511291504, "time_total_s": 155.38799262046814, "pid": 9936, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 155.38799262046814, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 63.675, "ram_util_percent": 26.975}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1368683772161605e-14, "cur_lr": 0.0003, "total_loss": 6.738311537989864, "policy_loss": -0.0003073440381774196, "vf_loss": 6.7386709495827, "vf_explained_var": -5.585175973397714e-07, "kl": 0.000655782900303671, "entropy": 0.5214739000355756, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1202.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 810000, "num_env_steps_trained": 810000, "num_agent_steps_sampled": 810000, "num_agent_steps_trained": 810000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.175999999999826, "episode_len_mean": 258.88, "episode_media": {}, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.5, 11.499999999999723, 41.90000000000001, 42.70000000000001, 17.499999999999808, -50.00000000000044, 46.099999999999994, 44.300000000000004, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 33.10000000000003, 42.10000000000001, -50.00000000000044, 44.10000000000001, 46.3, 5.499999999999638, -50.00000000000044, 38.700000000000024, 46.5, -50.00000000000044, 43.900000000000006, 43.50000000000001, 24.899999999999913, 44.900000000000006, 37.10000000000003, -50.00000000000044, 35.10000000000004, -50.00000000000044, -50.00000000000044, 45.5, 44.7, 41.100000000000016, 44.7, 36.10000000000004, -50.00000000000044, 42.70000000000001, 44.300000000000004, -50.00000000000044, 11.29999999999972, 0.8999999999995723, 26.69999999999994, 46.699999999999996, -50.00000000000044, -50.00000000000044, 41.100000000000016, 43.30000000000001, -50.00000000000044, 43.10000000000001, 46.699999999999996, 44.900000000000006, 35.10000000000004, 34.900000000000034, 39.50000000000002, 29.099999999999973, 44.900000000000006, -50.00000000000044, 37.300000000000026, 40.30000000000002, 37.10000000000003, 22.49999999999988, -50.00000000000044, -50.00000000000044, 34.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, 42.900000000000006, 30.9, 46.699999999999996, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.30000000000002, 44.900000000000006, -50.00000000000044, -50.00000000000044, 41.90000000000001, 45.3, 35.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, 33.30000000000003, 46.3, 19.499999999999837, 36.900000000000034], "episode_lengths": [56, 386, 82, 74, 326, 500, 40, 58, 500, 36, 500, 500, 38, 500, 170, 80, 500, 60, 38, 446, 500, 114, 36, 500, 62, 66, 252, 52, 130, 500, 150, 500, 500, 46, 54, 90, 54, 140, 500, 74, 58, 500, 388, 492, 234, 34, 500, 500, 90, 68, 500, 70, 34, 52, 150, 152, 106, 210, 52, 500, 128, 98, 130, 276, 500, 500, 154, 500, 500, 500, 500, 60, 40, 500, 500, 72, 192, 34, 64, 500, 500, 500, 500, 178, 52, 500, 500, 82, 48, 150, 500, 500, 500, 86, 500, 500, 168, 38, 306, 132]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41484842906828623, "mean_inference_ms": 1.3295225253705536, "mean_action_processing_ms": 0.15441918808690627, "mean_env_wait_ms": 0.09323570346605196, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028002500534057617, "StateBufferConnector_ms": 0.004999637603759766, "ViewRequirementAgentConnector_ms": 0.11098837852478027}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.175999999999826, "episode_len_mean": 258.88, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.5, 11.499999999999723, 41.90000000000001, 42.70000000000001, 17.499999999999808, -50.00000000000044, 46.099999999999994, 44.300000000000004, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 33.10000000000003, 42.10000000000001, -50.00000000000044, 44.10000000000001, 46.3, 5.499999999999638, -50.00000000000044, 38.700000000000024, 46.5, -50.00000000000044, 43.900000000000006, 43.50000000000001, 24.899999999999913, 44.900000000000006, 37.10000000000003, -50.00000000000044, 35.10000000000004, -50.00000000000044, -50.00000000000044, 45.5, 44.7, 41.100000000000016, 44.7, 36.10000000000004, -50.00000000000044, 42.70000000000001, 44.300000000000004, -50.00000000000044, 11.29999999999972, 0.8999999999995723, 26.69999999999994, 46.699999999999996, -50.00000000000044, -50.00000000000044, 41.100000000000016, 43.30000000000001, -50.00000000000044, 43.10000000000001, 46.699999999999996, 44.900000000000006, 35.10000000000004, 34.900000000000034, 39.50000000000002, 29.099999999999973, 44.900000000000006, -50.00000000000044, 37.300000000000026, 40.30000000000002, 37.10000000000003, 22.49999999999988, -50.00000000000044, -50.00000000000044, 34.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, 42.900000000000006, 30.9, 46.699999999999996, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.30000000000002, 44.900000000000006, -50.00000000000044, -50.00000000000044, 41.90000000000001, 45.3, 35.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, 33.30000000000003, 46.3, 19.499999999999837, 36.900000000000034], "episode_lengths": [56, 386, 82, 74, 326, 500, 40, 58, 500, 36, 500, 500, 38, 500, 170, 80, 500, 60, 38, 446, 500, 114, 36, 500, 62, 66, 252, 52, 130, 500, 150, 500, 500, 46, 54, 90, 54, 140, 500, 74, 58, 500, 388, 492, 234, 34, 500, 500, 90, 68, 500, 70, 34, 52, 150, 152, 106, 210, 52, 500, 128, 98, 130, 276, 500, 500, 154, 500, 500, 500, 500, 60, 40, 500, 500, 72, 192, 34, 64, 500, 500, 500, 500, 178, 52, 500, 500, 82, 48, 150, 500, 500, 500, 86, 500, 500, 168, 38, 306, 132]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41484842906828623, "mean_inference_ms": 1.3295225253705536, "mean_action_processing_ms": 0.15441918808690627, "mean_env_wait_ms": 0.09323570346605196, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028002500534057617, "StateBufferConnector_ms": 0.004999637603759766, "ViewRequirementAgentConnector_ms": 0.11098837852478027}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 810000, "num_agent_steps_trained": 810000, "num_env_steps_sampled": 810000, "num_env_steps_trained": 810000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5663.99019789294, "num_env_steps_trained_throughput_per_sec": 5663.99019789294, "timesteps_total": 810000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 810000, "timers": {"training_iteration_time_ms": 3273.537, "sample_time_ms": 2904.152, "load_time_ms": 18.809, "load_throughput": 956993.09, "learn_time_ms": 339.348, "learn_throughput": 53042.9, "synch_weights_time_ms": 9.328}, "counters": {"num_env_steps_sampled": 810000, "num_env_steps_trained": 810000, "num_agent_steps_sampled": 810000, "num_agent_steps_trained": 810000}, "done": false, "episodes_total": 3155, "training_iteration": 45, "trial_id": "9f288_00020", "date": "2023-10-25_17-14-28", "timestamp": 1698250468, "time_this_iter_s": 3.1829700469970703, "time_total_s": 158.5709626674652, "pid": 9936, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 158.5709626674652, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 59.620000000000005, "ram_util_percent": 27.02}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.6843418860808026e-15, "cur_lr": 0.0003, "total_loss": 7.249183813730876, "policy_loss": -0.00025610501567522687, "vf_loss": 7.2494916915893555, "vf_explained_var": -1.0772987648292823e-06, "kl": 0.0006533729331147663, "entropy": 0.5180352860026889, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1229.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 828000, "num_env_steps_trained": 828000, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.858999999999834, "episode_len_mean": 257.08, "episode_media": {}, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [30.9, 46.699999999999996, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.30000000000002, 44.900000000000006, -50.00000000000044, -50.00000000000044, 41.90000000000001, 45.3, 35.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, 33.30000000000003, 46.3, 19.499999999999837, 36.900000000000034, 45.3, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 16.8999999999998, -50.00000000000044, 41.70000000000002, -50.00000000000044, 30.499999999999993, 40.500000000000014, 41.30000000000001, 1.8999999999995865, -50.00000000000044, -50.00000000000044, 34.30000000000004, 37.300000000000026, 25.099999999999916, 7.499999999999666, 41.500000000000014, 30.699999999999996, 46.3, 42.10000000000001, 2.499999999999595, 35.10000000000004, 35.70000000000003, -50.00000000000044, 43.7, 27.299999999999947, 39.300000000000026, 13.499999999999751, 46.5, 44.300000000000004, 44.900000000000006, 33.90000000000004, 43.30000000000001, 45.5, 10.899999999999714, 41.90000000000001, -50.00000000000044, 42.70000000000001, 45.3, -50.00000000000044, -50.00000000000044, 36.30000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.500000000000036, 43.900000000000006, 42.70000000000001, -50.00000000000044, -50.00000000000044, 42.500000000000014, 44.10000000000001, -50.00000000000044, -50.00000000000044, 44.900000000000006, 44.300000000000004, 41.30000000000001, 44.7, -50.00000000000044, 45.9, 36.50000000000003, 33.30000000000003, 46.3, -50.00000000000044, 38.300000000000026, 43.7, 45.3, 47.3, 19.09999999999983, 30.499999999999993, 9.8999999999997, -50.00000000000044], "episode_lengths": [192, 34, 64, 500, 500, 500, 500, 178, 52, 500, 500, 82, 48, 150, 500, 500, 500, 86, 500, 500, 168, 38, 306, 132, 48, 60, 500, 500, 500, 500, 332, 500, 84, 500, 196, 96, 88, 482, 500, 500, 158, 128, 250, 426, 86, 194, 38, 80, 476, 150, 144, 500, 64, 228, 108, 366, 36, 58, 52, 162, 68, 46, 392, 82, 500, 74, 48, 500, 500, 138, 500, 500, 500, 166, 62, 74, 500, 500, 76, 60, 500, 500, 52, 58, 88, 54, 500, 42, 136, 168, 38, 500, 118, 64, 48, 28, 310, 196, 402, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4148183952464029, "mean_inference_ms": 1.3261096652914797, "mean_action_processing_ms": 0.1545265643340722, "mean_env_wait_ms": 0.09312479265952778, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02001166343688965, "StateBufferConnector_ms": 0.001999378204345703, "ViewRequirementAgentConnector_ms": 0.12399959564208984}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.858999999999834, "episode_len_mean": 257.08, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [30.9, 46.699999999999996, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.30000000000002, 44.900000000000006, -50.00000000000044, -50.00000000000044, 41.90000000000001, 45.3, 35.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, 33.30000000000003, 46.3, 19.499999999999837, 36.900000000000034, 45.3, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 16.8999999999998, -50.00000000000044, 41.70000000000002, -50.00000000000044, 30.499999999999993, 40.500000000000014, 41.30000000000001, 1.8999999999995865, -50.00000000000044, -50.00000000000044, 34.30000000000004, 37.300000000000026, 25.099999999999916, 7.499999999999666, 41.500000000000014, 30.699999999999996, 46.3, 42.10000000000001, 2.499999999999595, 35.10000000000004, 35.70000000000003, -50.00000000000044, 43.7, 27.299999999999947, 39.300000000000026, 13.499999999999751, 46.5, 44.300000000000004, 44.900000000000006, 33.90000000000004, 43.30000000000001, 45.5, 10.899999999999714, 41.90000000000001, -50.00000000000044, 42.70000000000001, 45.3, -50.00000000000044, -50.00000000000044, 36.30000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.500000000000036, 43.900000000000006, 42.70000000000001, -50.00000000000044, -50.00000000000044, 42.500000000000014, 44.10000000000001, -50.00000000000044, -50.00000000000044, 44.900000000000006, 44.300000000000004, 41.30000000000001, 44.7, -50.00000000000044, 45.9, 36.50000000000003, 33.30000000000003, 46.3, -50.00000000000044, 38.300000000000026, 43.7, 45.3, 47.3, 19.09999999999983, 30.499999999999993, 9.8999999999997, -50.00000000000044], "episode_lengths": [192, 34, 64, 500, 500, 500, 500, 178, 52, 500, 500, 82, 48, 150, 500, 500, 500, 86, 500, 500, 168, 38, 306, 132, 48, 60, 500, 500, 500, 500, 332, 500, 84, 500, 196, 96, 88, 482, 500, 500, 158, 128, 250, 426, 86, 194, 38, 80, 476, 150, 144, 500, 64, 228, 108, 366, 36, 58, 52, 162, 68, 46, 392, 82, 500, 74, 48, 500, 500, 138, 500, 500, 500, 166, 62, 74, 500, 500, 76, 60, 500, 500, 52, 58, 88, 54, 500, 42, 136, 168, 38, 500, 118, 64, 48, 28, 310, 196, 402, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4148183952464029, "mean_inference_ms": 1.3261096652914797, "mean_action_processing_ms": 0.1545265643340722, "mean_env_wait_ms": 0.09312479265952778, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02001166343688965, "StateBufferConnector_ms": 0.001999378204345703, "ViewRequirementAgentConnector_ms": 0.12399959564208984}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000, "num_env_steps_sampled": 828000, "num_env_steps_trained": 828000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5639.099584156632, "num_env_steps_trained_throughput_per_sec": 5639.099584156632, "timesteps_total": 828000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 828000, "timers": {"training_iteration_time_ms": 3249.39, "sample_time_ms": 2882.501, "load_time_ms": 17.909, "load_throughput": 1005099.848, "learn_time_ms": 337.393, "learn_throughput": 53350.169, "synch_weights_time_ms": 9.387}, "counters": {"num_env_steps_sampled": 828000, "num_env_steps_trained": 828000, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000}, "done": false, "episodes_total": 3231, "training_iteration": 46, "trial_id": "9f288_00020", "date": "2023-10-25_17-14-31", "timestamp": 1698250471, "time_this_iter_s": 3.197998523712158, "time_total_s": 161.76896119117737, "pid": 9936, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 161.76896119117737, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 67.82499999999999, "ram_util_percent": 27.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.8421709430404013e-15, "cur_lr": 0.0003, "total_loss": 6.298435034575285, "policy_loss": -0.0001520480684660099, "vf_loss": 6.298636012607151, "vf_explained_var": -1.1126200358072917e-06, "kl": 0.0005807324382237346, "entropy": 0.4893970908942046, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1256.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 846000, "num_env_steps_trained": 846000, "num_agent_steps_sampled": 846000, "num_agent_steps_trained": 846000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.669999999999816, "episode_len_mean": 263.92, "episode_media": {}, "episodes_this_iter": 62, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.899999999999714, 41.90000000000001, -50.00000000000044, 42.70000000000001, 45.3, -50.00000000000044, -50.00000000000044, 36.30000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.500000000000036, 43.900000000000006, 42.70000000000001, -50.00000000000044, -50.00000000000044, 42.500000000000014, 44.10000000000001, -50.00000000000044, -50.00000000000044, 44.900000000000006, 44.300000000000004, 41.30000000000001, 44.7, -50.00000000000044, 45.9, 36.50000000000003, 33.30000000000003, 46.3, -50.00000000000044, 38.300000000000026, 43.7, 45.3, 47.3, 19.09999999999983, 30.499999999999993, 9.8999999999997, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.499999999999922, 44.7, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 43.30000000000001, 41.30000000000001, -50.00000000000044, -50.00000000000044, 45.1, 30.699999999999996, -50.00000000000044, 43.900000000000006, 40.90000000000002, 1.4999999999995808, 46.5, 43.50000000000001, 43.50000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.5, 43.50000000000001, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, 47.1, 45.3, 40.10000000000002, 29.49999999999998, -50.00000000000044, 45.3, 44.900000000000006, 8.49999999999968, 43.7, -50.00000000000044, 46.099999999999994, 45.3, 34.30000000000004, 30.29999999999999, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.70000000000003, 40.30000000000002, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 43.30000000000001, 23.499999999999893, -50.00000000000044, -50.00000000000044, 11.499999999999723], "episode_lengths": [392, 82, 500, 74, 48, 500, 500, 138, 500, 500, 500, 166, 62, 74, 500, 500, 76, 60, 500, 500, 52, 58, 88, 54, 500, 42, 136, 168, 38, 500, 118, 64, 48, 28, 310, 196, 402, 500, 500, 500, 246, 54, 500, 48, 500, 500, 500, 52, 68, 88, 500, 500, 50, 194, 500, 62, 92, 486, 36, 66, 66, 40, 500, 500, 56, 66, 500, 500, 92, 500, 30, 48, 100, 206, 500, 48, 52, 416, 64, 500, 40, 48, 158, 198, 500, 104, 500, 500, 500, 144, 98, 500, 82, 500, 500, 68, 266, 500, 500, 386]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4138379225959385, "mean_inference_ms": 1.3237948905419408, "mean_action_processing_ms": 0.15415414245744827, "mean_env_wait_ms": 0.09290703399156566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024007081985473633, "StateBufferConnector_ms": 0.0029964447021484375, "ViewRequirementAgentConnector_ms": 0.09999871253967285}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.669999999999816, "episode_len_mean": 263.92, "episodes_this_iter": 62, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.899999999999714, 41.90000000000001, -50.00000000000044, 42.70000000000001, 45.3, -50.00000000000044, -50.00000000000044, 36.30000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.500000000000036, 43.900000000000006, 42.70000000000001, -50.00000000000044, -50.00000000000044, 42.500000000000014, 44.10000000000001, -50.00000000000044, -50.00000000000044, 44.900000000000006, 44.300000000000004, 41.30000000000001, 44.7, -50.00000000000044, 45.9, 36.50000000000003, 33.30000000000003, 46.3, -50.00000000000044, 38.300000000000026, 43.7, 45.3, 47.3, 19.09999999999983, 30.499999999999993, 9.8999999999997, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.499999999999922, 44.7, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 43.30000000000001, 41.30000000000001, -50.00000000000044, -50.00000000000044, 45.1, 30.699999999999996, -50.00000000000044, 43.900000000000006, 40.90000000000002, 1.4999999999995808, 46.5, 43.50000000000001, 43.50000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.5, 43.50000000000001, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, 47.1, 45.3, 40.10000000000002, 29.49999999999998, -50.00000000000044, 45.3, 44.900000000000006, 8.49999999999968, 43.7, -50.00000000000044, 46.099999999999994, 45.3, 34.30000000000004, 30.29999999999999, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.70000000000003, 40.30000000000002, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 43.30000000000001, 23.499999999999893, -50.00000000000044, -50.00000000000044, 11.499999999999723], "episode_lengths": [392, 82, 500, 74, 48, 500, 500, 138, 500, 500, 500, 166, 62, 74, 500, 500, 76, 60, 500, 500, 52, 58, 88, 54, 500, 42, 136, 168, 38, 500, 118, 64, 48, 28, 310, 196, 402, 500, 500, 500, 246, 54, 500, 48, 500, 500, 500, 52, 68, 88, 500, 500, 50, 194, 500, 62, 92, 486, 36, 66, 66, 40, 500, 500, 56, 66, 500, 500, 92, 500, 30, 48, 100, 206, 500, 48, 52, 416, 64, 500, 40, 48, 158, 198, 500, 104, 500, 500, 500, 144, 98, 500, 82, 500, 500, 68, 266, 500, 500, 386]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4138379225959385, "mean_inference_ms": 1.3237948905419408, "mean_action_processing_ms": 0.15415414245744827, "mean_env_wait_ms": 0.09290703399156566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024007081985473633, "StateBufferConnector_ms": 0.0029964447021484375, "ViewRequirementAgentConnector_ms": 0.09999871253967285}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 846000, "num_agent_steps_trained": 846000, "num_env_steps_sampled": 846000, "num_env_steps_trained": 846000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5333.329942493475, "num_env_steps_trained_throughput_per_sec": 5333.329942493475, "timesteps_total": 846000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 846000, "timers": {"training_iteration_time_ms": 3266.091, "sample_time_ms": 2882.801, "load_time_ms": 18.606, "load_throughput": 967447.468, "learn_time_ms": 353.099, "learn_throughput": 50977.155, "synch_weights_time_ms": 9.284}, "counters": {"num_env_steps_sampled": 846000, "num_env_steps_trained": 846000, "num_agent_steps_sampled": 846000, "num_agent_steps_trained": 846000}, "done": false, "episodes_total": 3293, "training_iteration": 47, "trial_id": "9f288_00020", "date": "2023-10-25_17-14-35", "timestamp": 1698250475, "time_this_iter_s": 3.3799991607666016, "time_total_s": 165.14896035194397, "pid": 9936, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 165.14896035194397, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 57.080000000000005, "ram_util_percent": 26.98}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.4210854715202006e-15, "cur_lr": 0.0003, "total_loss": 6.208018956360994, "policy_loss": -0.0001465627509686682, "vf_loss": 6.208215007075557, "vf_explained_var": -1.1744322600188078e-06, "kl": 0.000349732901478698, "entropy": 0.49562561953509293, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1283.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 864000, "num_env_steps_trained": 864000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -3.481000000000222, "episode_len_mean": 300.34, "episode_media": {}, "episodes_this_iter": 55, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.900000000000006, 40.90000000000002, 1.4999999999995808, 46.5, 43.50000000000001, 43.50000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.5, 43.50000000000001, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, 47.1, 45.3, 40.10000000000002, 29.49999999999998, -50.00000000000044, 45.3, 44.900000000000006, 8.49999999999968, 43.7, -50.00000000000044, 46.099999999999994, 45.3, 34.30000000000004, 30.29999999999999, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.70000000000003, 40.30000000000002, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 43.30000000000001, 23.499999999999893, -50.00000000000044, -50.00000000000044, 11.499999999999723, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.30000000000002, -50.00000000000044, 7.499999999999666, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 36.30000000000003, 45.3, -50.00000000000044, 43.50000000000001, -50.00000000000044, 31.500000000000007, -50.00000000000044, 47.9, 7.899999999999672, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 36.900000000000034, 35.900000000000034, 47.5, 26.69999999999994, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.300000000000026, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 44.10000000000001, 43.50000000000001], "episode_lengths": [62, 92, 486, 36, 66, 66, 40, 500, 500, 56, 66, 500, 500, 92, 500, 30, 48, 100, 206, 500, 48, 52, 416, 64, 500, 40, 48, 158, 198, 500, 104, 500, 500, 500, 144, 98, 500, 82, 500, 500, 68, 266, 500, 500, 386, 104, 500, 500, 500, 178, 500, 426, 84, 500, 500, 500, 38, 500, 138, 48, 500, 66, 500, 186, 500, 22, 422, 500, 500, 500, 500, 64, 132, 142, 26, 234, 500, 500, 34, 500, 500, 500, 110, 500, 80, 500, 500, 500, 128, 500, 56, 500, 500, 500, 500, 500, 72, 500, 60, 66]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41358375408367254, "mean_inference_ms": 1.3208972734857225, "mean_action_processing_ms": 0.1540542332712315, "mean_env_wait_ms": 0.09264155465383059, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029004812240600586, "StateBufferConnector_ms": 0.006996870040893555, "ViewRequirementAgentConnector_ms": 0.12192249298095703}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -3.481000000000222, "episode_len_mean": 300.34, "episodes_this_iter": 55, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.900000000000006, 40.90000000000002, 1.4999999999995808, 46.5, 43.50000000000001, 43.50000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.5, 43.50000000000001, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, 47.1, 45.3, 40.10000000000002, 29.49999999999998, -50.00000000000044, 45.3, 44.900000000000006, 8.49999999999968, 43.7, -50.00000000000044, 46.099999999999994, 45.3, 34.30000000000004, 30.29999999999999, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.70000000000003, 40.30000000000002, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 43.30000000000001, 23.499999999999893, -50.00000000000044, -50.00000000000044, 11.499999999999723, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.30000000000002, -50.00000000000044, 7.499999999999666, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 36.30000000000003, 45.3, -50.00000000000044, 43.50000000000001, -50.00000000000044, 31.500000000000007, -50.00000000000044, 47.9, 7.899999999999672, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 36.900000000000034, 35.900000000000034, 47.5, 26.69999999999994, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.300000000000026, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 44.10000000000001, 43.50000000000001], "episode_lengths": [62, 92, 486, 36, 66, 66, 40, 500, 500, 56, 66, 500, 500, 92, 500, 30, 48, 100, 206, 500, 48, 52, 416, 64, 500, 40, 48, 158, 198, 500, 104, 500, 500, 500, 144, 98, 500, 82, 500, 500, 68, 266, 500, 500, 386, 104, 500, 500, 500, 178, 500, 426, 84, 500, 500, 500, 38, 500, 138, 48, 500, 66, 500, 186, 500, 22, 422, 500, 500, 500, 500, 64, 132, 142, 26, 234, 500, 500, 34, 500, 500, 500, 110, 500, 80, 500, 500, 500, 128, 500, 56, 500, 500, 500, 500, 500, 72, 500, 60, 66]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41358375408367254, "mean_inference_ms": 1.3208972734857225, "mean_action_processing_ms": 0.1540542332712315, "mean_env_wait_ms": 0.09264155465383059, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029004812240600586, "StateBufferConnector_ms": 0.006996870040893555, "ViewRequirementAgentConnector_ms": 0.12192249298095703}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000, "num_env_steps_sampled": 864000, "num_env_steps_trained": 864000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5685.475300564621, "num_env_steps_trained_throughput_per_sec": 5685.475300564621, "timesteps_total": 864000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 864000, "timers": {"training_iteration_time_ms": 3251.799, "sample_time_ms": 2880.098, "load_time_ms": 17.603, "load_throughput": 1022574.21, "learn_time_ms": 342.515, "learn_throughput": 52552.433, "synch_weights_time_ms": 9.183}, "counters": {"num_env_steps_sampled": 864000, "num_env_steps_trained": 864000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "done": false, "episodes_total": 3348, "training_iteration": 48, "trial_id": "9f288_00020", "date": "2023-10-25_17-14-38", "timestamp": 1698250478, "time_this_iter_s": 3.170961618423462, "time_total_s": 168.31992197036743, "pid": 9936, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 168.31992197036743, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 64.55, "ram_util_percent": 27.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.105427357601003e-16, "cur_lr": 0.0003, "total_loss": 6.482655931402136, "policy_loss": -0.0002646248235746666, "vf_loss": 6.482973805180302, "vf_explained_var": -1.0817139237015336e-06, "kl": 0.0006657953506345604, "entropy": 0.5320670196303615, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1310.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 882000, "num_env_steps_trained": 882000, "num_agent_steps_sampled": 882000, "num_agent_steps_trained": 882000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.896000000000211, "episode_len_mean": 289.5, "episode_media": {}, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.899999999999672, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 36.900000000000034, 35.900000000000034, 47.5, 26.69999999999994, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.300000000000026, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 44.10000000000001, 43.50000000000001, -50.00000000000044, -50.00000000000044, 39.70000000000002, 45.3, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, 37.70000000000003, 37.90000000000003, -50.00000000000044, 46.5, 45.1, 31.300000000000004, 44.7, -50.00000000000044, 43.7, 45.9, 45.3, 24.69999999999991, 43.50000000000001, 37.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 45.9, 31.70000000000001, 46.3, 37.90000000000003, 42.500000000000014, -50.00000000000044, 31.1, -50.00000000000044, 45.1, -50.00000000000044, 44.300000000000004, 39.70000000000002, 4.699999999999626, -50.00000000000044, 45.9, 39.300000000000026, -50.00000000000044, -50.00000000000044, 46.699999999999996, 39.90000000000002, -50.00000000000044, 42.900000000000006, 19.899999999999842, -50.00000000000044, 40.500000000000014, 36.70000000000003, -50.00000000000044, -50.00000000000044, 14.499999999999766, 44.900000000000006, 45.1, 43.7, 46.5, -50.00000000000044], "episode_lengths": [422, 500, 500, 500, 500, 64, 132, 142, 26, 234, 500, 500, 34, 500, 500, 500, 110, 500, 80, 500, 500, 500, 128, 500, 56, 500, 500, 500, 500, 500, 72, 500, 60, 66, 500, 500, 104, 48, 500, 500, 88, 500, 124, 122, 500, 36, 50, 188, 54, 500, 64, 42, 48, 254, 66, 126, 500, 500, 500, 500, 60, 500, 500, 84, 500, 500, 42, 184, 38, 122, 76, 500, 190, 500, 50, 500, 58, 104, 454, 500, 42, 108, 500, 500, 34, 102, 500, 72, 302, 500, 96, 134, 500, 500, 356, 52, 50, 64, 36, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4130061968322807, "mean_inference_ms": 1.3202224948940935, "mean_action_processing_ms": 0.15390535013849066, "mean_env_wait_ms": 0.09256968940705146, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03399658203125, "StateBufferConnector_ms": 0.008002042770385742, "ViewRequirementAgentConnector_ms": 0.13245511054992676}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.896000000000211, "episode_len_mean": 289.5, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.899999999999672, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 36.900000000000034, 35.900000000000034, 47.5, 26.69999999999994, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.300000000000026, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 44.10000000000001, 43.50000000000001, -50.00000000000044, -50.00000000000044, 39.70000000000002, 45.3, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, 37.70000000000003, 37.90000000000003, -50.00000000000044, 46.5, 45.1, 31.300000000000004, 44.7, -50.00000000000044, 43.7, 45.9, 45.3, 24.69999999999991, 43.50000000000001, 37.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 45.9, 31.70000000000001, 46.3, 37.90000000000003, 42.500000000000014, -50.00000000000044, 31.1, -50.00000000000044, 45.1, -50.00000000000044, 44.300000000000004, 39.70000000000002, 4.699999999999626, -50.00000000000044, 45.9, 39.300000000000026, -50.00000000000044, -50.00000000000044, 46.699999999999996, 39.90000000000002, -50.00000000000044, 42.900000000000006, 19.899999999999842, -50.00000000000044, 40.500000000000014, 36.70000000000003, -50.00000000000044, -50.00000000000044, 14.499999999999766, 44.900000000000006, 45.1, 43.7, 46.5, -50.00000000000044], "episode_lengths": [422, 500, 500, 500, 500, 64, 132, 142, 26, 234, 500, 500, 34, 500, 500, 500, 110, 500, 80, 500, 500, 500, 128, 500, 56, 500, 500, 500, 500, 500, 72, 500, 60, 66, 500, 500, 104, 48, 500, 500, 88, 500, 124, 122, 500, 36, 50, 188, 54, 500, 64, 42, 48, 254, 66, 126, 500, 500, 500, 500, 60, 500, 500, 84, 500, 500, 42, 184, 38, 122, 76, 500, 190, 500, 50, 500, 58, 104, 454, 500, 42, 108, 500, 500, 34, 102, 500, 72, 302, 500, 96, 134, 500, 500, 356, 52, 50, 64, 36, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4130061968322807, "mean_inference_ms": 1.3202224948940935, "mean_action_processing_ms": 0.15390535013849066, "mean_env_wait_ms": 0.09256968940705146, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03399658203125, "StateBufferConnector_ms": 0.008002042770385742, "ViewRequirementAgentConnector_ms": 0.13245511054992676}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 882000, "num_agent_steps_trained": 882000, "num_env_steps_sampled": 882000, "num_env_steps_trained": 882000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5377.870142525454, "num_env_steps_trained_throughput_per_sec": 5377.870142525454, "timesteps_total": 882000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 882000, "timers": {"training_iteration_time_ms": 3268.006, "sample_time_ms": 2882.406, "load_time_ms": 18.703, "load_throughput": 962436.589, "learn_time_ms": 355.315, "learn_throughput": 50659.309, "synch_weights_time_ms": 9.183}, "counters": {"num_env_steps_sampled": 882000, "num_env_steps_trained": 882000, "num_agent_steps_sampled": 882000, "num_agent_steps_trained": 882000}, "done": false, "episodes_total": 3414, "training_iteration": 49, "trial_id": "9f288_00020", "date": "2023-10-25_17-14-41", "timestamp": 1698250481, "time_this_iter_s": 3.3530468940734863, "time_total_s": 171.67296886444092, "pid": 9936, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 171.67296886444092, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 59.86, "ram_util_percent": 27.02}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.5527136788005016e-16, "cur_lr": 0.0003, "total_loss": 7.369442692509404, "policy_loss": -0.00022398470038617098, "vf_loss": 7.369720494305646, "vf_explained_var": -9.64712213586878e-07, "kl": 0.0004439704835021985, "entropy": 0.537954576589443, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1337.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 900000, "num_env_steps_trained": 900000, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.838999999999848, "episode_len_mean": 247.3, "episode_media": {}, "episodes_this_iter": 80, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.9, 39.300000000000026, -50.00000000000044, -50.00000000000044, 46.699999999999996, 39.90000000000002, -50.00000000000044, 42.900000000000006, 19.899999999999842, -50.00000000000044, 40.500000000000014, 36.70000000000003, -50.00000000000044, -50.00000000000044, 14.499999999999766, 44.900000000000006, 45.1, 43.7, 46.5, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 29.099999999999973, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 44.7, 39.70000000000002, 38.10000000000002, -50.00000000000044, 43.50000000000001, -50.00000000000044, 42.10000000000001, -50.00000000000044, 9.099999999999689, 24.899999999999913, -50.00000000000044, 42.500000000000014, -50.00000000000044, 45.5, -50.00000000000044, 39.10000000000002, -50.00000000000044, 25.899999999999928, -50.00000000000044, 45.5, 41.90000000000001, 35.500000000000036, 28.89999999999997, 22.49999999999988, 6.099999999999646, 46.5, -50.00000000000044, 43.30000000000001, 8.699999999999683, 27.699999999999953, 41.100000000000016, 42.900000000000006, 46.699999999999996, 42.10000000000001, -50.00000000000044, 41.30000000000001, 33.10000000000003, 42.30000000000001, 32.700000000000024, 38.300000000000026, -50.00000000000044, 35.30000000000004, 39.50000000000002, 46.3, 20.899999999999856, 28.09999999999996, -50.00000000000044, 42.10000000000001, 34.30000000000004, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, 42.900000000000006, 44.300000000000004, 46.5, -50.00000000000044, 39.300000000000026, -50.00000000000044, 30.9, 15.49999999999978, -50.00000000000044, 43.900000000000006, 42.10000000000001, 39.90000000000002, 41.30000000000001, 32.90000000000003, -50.00000000000044, 38.300000000000026, 16.699999999999797, 43.50000000000001, 41.70000000000002], "episode_lengths": [42, 108, 500, 500, 34, 102, 500, 72, 302, 500, 96, 134, 500, 500, 356, 52, 50, 64, 36, 500, 500, 44, 500, 210, 500, 500, 42, 500, 54, 104, 120, 500, 66, 500, 80, 500, 410, 252, 500, 76, 500, 46, 500, 110, 500, 242, 500, 46, 82, 146, 212, 276, 440, 36, 500, 68, 414, 224, 90, 72, 34, 80, 500, 88, 170, 78, 174, 118, 500, 148, 106, 38, 292, 220, 500, 80, 158, 500, 118, 500, 500, 72, 58, 36, 500, 108, 500, 192, 346, 500, 62, 80, 102, 88, 172, 500, 118, 334, 66, 84]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41188114336524656, "mean_inference_ms": 1.3177696080328898, "mean_action_processing_ms": 0.15324946552390303, "mean_env_wait_ms": 0.09235242401006324, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014002323150634766, "StateBufferConnector_ms": 0.0020036697387695312, "ViewRequirementAgentConnector_ms": 0.10698175430297852}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.838999999999848, "episode_len_mean": 247.3, "episodes_this_iter": 80, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.9, 39.300000000000026, -50.00000000000044, -50.00000000000044, 46.699999999999996, 39.90000000000002, -50.00000000000044, 42.900000000000006, 19.899999999999842, -50.00000000000044, 40.500000000000014, 36.70000000000003, -50.00000000000044, -50.00000000000044, 14.499999999999766, 44.900000000000006, 45.1, 43.7, 46.5, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 29.099999999999973, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 44.7, 39.70000000000002, 38.10000000000002, -50.00000000000044, 43.50000000000001, -50.00000000000044, 42.10000000000001, -50.00000000000044, 9.099999999999689, 24.899999999999913, -50.00000000000044, 42.500000000000014, -50.00000000000044, 45.5, -50.00000000000044, 39.10000000000002, -50.00000000000044, 25.899999999999928, -50.00000000000044, 45.5, 41.90000000000001, 35.500000000000036, 28.89999999999997, 22.49999999999988, 6.099999999999646, 46.5, -50.00000000000044, 43.30000000000001, 8.699999999999683, 27.699999999999953, 41.100000000000016, 42.900000000000006, 46.699999999999996, 42.10000000000001, -50.00000000000044, 41.30000000000001, 33.10000000000003, 42.30000000000001, 32.700000000000024, 38.300000000000026, -50.00000000000044, 35.30000000000004, 39.50000000000002, 46.3, 20.899999999999856, 28.09999999999996, -50.00000000000044, 42.10000000000001, 34.30000000000004, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, 42.900000000000006, 44.300000000000004, 46.5, -50.00000000000044, 39.300000000000026, -50.00000000000044, 30.9, 15.49999999999978, -50.00000000000044, 43.900000000000006, 42.10000000000001, 39.90000000000002, 41.30000000000001, 32.90000000000003, -50.00000000000044, 38.300000000000026, 16.699999999999797, 43.50000000000001, 41.70000000000002], "episode_lengths": [42, 108, 500, 500, 34, 102, 500, 72, 302, 500, 96, 134, 500, 500, 356, 52, 50, 64, 36, 500, 500, 44, 500, 210, 500, 500, 42, 500, 54, 104, 120, 500, 66, 500, 80, 500, 410, 252, 500, 76, 500, 46, 500, 110, 500, 242, 500, 46, 82, 146, 212, 276, 440, 36, 500, 68, 414, 224, 90, 72, 34, 80, 500, 88, 170, 78, 174, 118, 500, 148, 106, 38, 292, 220, 500, 80, 158, 500, 118, 500, 500, 72, 58, 36, 500, 108, 500, 192, 346, 500, 62, 80, 102, 88, 172, 500, 118, 334, 66, 84]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41188114336524656, "mean_inference_ms": 1.3177696080328898, "mean_action_processing_ms": 0.15324946552390303, "mean_env_wait_ms": 0.09235242401006324, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014002323150634766, "StateBufferConnector_ms": 0.0020036697387695312, "ViewRequirementAgentConnector_ms": 0.10698175430297852}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000, "num_env_steps_sampled": 900000, "num_env_steps_trained": 900000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5574.523089118713, "num_env_steps_trained_throughput_per_sec": 5574.523089118713, "timesteps_total": 900000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 900000, "timers": {"training_iteration_time_ms": 3213.841, "sample_time_ms": 2845.44, "load_time_ms": 18.002, "load_throughput": 999864.544, "learn_time_ms": 338.812, "learn_throughput": 53126.816, "synch_weights_time_ms": 9.186}, "counters": {"num_env_steps_sampled": 900000, "num_env_steps_trained": 900000, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000}, "done": false, "episodes_total": 3494, "training_iteration": 50, "trial_id": "9f288_00020", "date": "2023-10-25_17-14-44", "timestamp": 1698250484, "time_this_iter_s": 3.2349698543548584, "time_total_s": 174.90793871879578, "pid": 9936, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 174.90793871879578, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 58.04, "ram_util_percent": 27.059999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.7763568394002508e-16, "cur_lr": 0.0003, "total_loss": 7.02180489787349, "policy_loss": -0.00036525981569731676, "vf_loss": 7.022226510224519, "vf_explained_var": -9.625046341507524e-07, "kl": 0.0005944620764626894, "entropy": 0.5649318087984014, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1364.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 918000, "num_env_steps_trained": 918000, "num_agent_steps_sampled": 918000, "num_agent_steps_trained": 918000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.630999999999867, "episode_len_mean": 229.42, "episode_media": {}, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [34.30000000000004, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, 42.900000000000006, 44.300000000000004, 46.5, -50.00000000000044, 39.300000000000026, -50.00000000000044, 30.9, 15.49999999999978, -50.00000000000044, 43.900000000000006, 42.10000000000001, 39.90000000000002, 41.30000000000001, 32.90000000000003, -50.00000000000044, 38.300000000000026, 16.699999999999797, 43.50000000000001, 41.70000000000002, -50.00000000000044, 38.700000000000024, 45.5, -50.00000000000044, 34.900000000000034, -50.00000000000044, 38.300000000000026, 3.2999999999996064, 40.70000000000002, 36.30000000000003, 25.29999999999992, 41.500000000000014, 40.90000000000002, 45.1, 43.900000000000006, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 23.499999999999893, 44.300000000000004, 37.10000000000003, -50.00000000000044, 35.500000000000036, -50.00000000000044, 42.500000000000014, 43.900000000000006, 38.90000000000002, 42.30000000000001, 31.900000000000013, -50.00000000000044, -50.00000000000044, 43.7, 45.3, 44.300000000000004, 46.9, -50.00000000000044, 38.700000000000024, 35.30000000000004, 40.10000000000002, 26.499999999999936, 44.300000000000004, 31.1, 43.10000000000001, 45.5, 17.69999999999981, 28.29999999999996, -50.00000000000044, 35.10000000000004, 45.3, 40.30000000000002, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 46.3, 38.90000000000002, 43.900000000000006, 45.5, 5.099999999999632, -50.00000000000044, 37.10000000000003, -50.00000000000044, 43.900000000000006, 41.90000000000001, -50.00000000000044, 43.7, 34.70000000000004, 24.899999999999913, 10.699999999999712, 15.49999999999978, 45.9, -50.00000000000044, 43.30000000000001], "episode_lengths": [158, 500, 118, 500, 500, 72, 58, 36, 500, 108, 500, 192, 346, 500, 62, 80, 102, 88, 172, 500, 118, 334, 66, 84, 500, 114, 46, 500, 152, 500, 118, 468, 94, 138, 248, 86, 92, 50, 62, 500, 60, 500, 500, 500, 50, 266, 58, 130, 500, 146, 500, 76, 62, 112, 78, 182, 500, 500, 64, 48, 58, 32, 500, 114, 148, 100, 236, 58, 190, 70, 46, 324, 218, 500, 150, 48, 98, 500, 500, 56, 500, 38, 112, 62, 46, 450, 500, 130, 500, 62, 82, 500, 64, 154, 252, 394, 346, 42, 500, 68]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4114224167244378, "mean_inference_ms": 1.3154662838611986, "mean_action_processing_ms": 0.15305913577620736, "mean_env_wait_ms": 0.09221376322286069, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.032994985580444336, "StateBufferConnector_ms": 0.004004478454589844, "ViewRequirementAgentConnector_ms": 0.10902976989746094}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.630999999999867, "episode_len_mean": 229.42, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [34.30000000000004, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, 42.900000000000006, 44.300000000000004, 46.5, -50.00000000000044, 39.300000000000026, -50.00000000000044, 30.9, 15.49999999999978, -50.00000000000044, 43.900000000000006, 42.10000000000001, 39.90000000000002, 41.30000000000001, 32.90000000000003, -50.00000000000044, 38.300000000000026, 16.699999999999797, 43.50000000000001, 41.70000000000002, -50.00000000000044, 38.700000000000024, 45.5, -50.00000000000044, 34.900000000000034, -50.00000000000044, 38.300000000000026, 3.2999999999996064, 40.70000000000002, 36.30000000000003, 25.29999999999992, 41.500000000000014, 40.90000000000002, 45.1, 43.900000000000006, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 23.499999999999893, 44.300000000000004, 37.10000000000003, -50.00000000000044, 35.500000000000036, -50.00000000000044, 42.500000000000014, 43.900000000000006, 38.90000000000002, 42.30000000000001, 31.900000000000013, -50.00000000000044, -50.00000000000044, 43.7, 45.3, 44.300000000000004, 46.9, -50.00000000000044, 38.700000000000024, 35.30000000000004, 40.10000000000002, 26.499999999999936, 44.300000000000004, 31.1, 43.10000000000001, 45.5, 17.69999999999981, 28.29999999999996, -50.00000000000044, 35.10000000000004, 45.3, 40.30000000000002, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 46.3, 38.90000000000002, 43.900000000000006, 45.5, 5.099999999999632, -50.00000000000044, 37.10000000000003, -50.00000000000044, 43.900000000000006, 41.90000000000001, -50.00000000000044, 43.7, 34.70000000000004, 24.899999999999913, 10.699999999999712, 15.49999999999978, 45.9, -50.00000000000044, 43.30000000000001], "episode_lengths": [158, 500, 118, 500, 500, 72, 58, 36, 500, 108, 500, 192, 346, 500, 62, 80, 102, 88, 172, 500, 118, 334, 66, 84, 500, 114, 46, 500, 152, 500, 118, 468, 94, 138, 248, 86, 92, 50, 62, 500, 60, 500, 500, 500, 50, 266, 58, 130, 500, 146, 500, 76, 62, 112, 78, 182, 500, 500, 64, 48, 58, 32, 500, 114, 148, 100, 236, 58, 190, 70, 46, 324, 218, 500, 150, 48, 98, 500, 500, 56, 500, 38, 112, 62, 46, 450, 500, 130, 500, 62, 82, 500, 64, 154, 252, 394, 346, 42, 500, 68]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4114224167244378, "mean_inference_ms": 1.3154662838611986, "mean_action_processing_ms": 0.15305913577620736, "mean_env_wait_ms": 0.09221376322286069, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.032994985580444336, "StateBufferConnector_ms": 0.004004478454589844, "ViewRequirementAgentConnector_ms": 0.10902976989746094}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 918000, "num_agent_steps_trained": 918000, "num_env_steps_sampled": 918000, "num_env_steps_trained": 918000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5410.274261359968, "num_env_steps_trained_throughput_per_sec": 5410.274261359968, "timesteps_total": 918000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 918000, "timers": {"training_iteration_time_ms": 3224.244, "sample_time_ms": 2849.643, "load_time_ms": 18.099, "load_throughput": 994506.609, "learn_time_ms": 344.918, "learn_throughput": 52186.365, "synch_weights_time_ms": 9.184}, "counters": {"num_env_steps_sampled": 918000, "num_env_steps_trained": 918000, "num_agent_steps_sampled": 918000, "num_agent_steps_trained": 918000}, "done": false, "episodes_total": 3570, "training_iteration": 51, "trial_id": "9f288_00020", "date": "2023-10-25_17-14-48", "timestamp": 1698250488, "time_this_iter_s": 3.3329994678497314, "time_total_s": 178.2409381866455, "pid": 9936, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 178.2409381866455, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 67.0, "ram_util_percent": 27.025}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.881784197001254e-17, "cur_lr": 0.0003, "total_loss": 6.687417312904641, "policy_loss": -0.00018994308387239775, "vf_loss": 6.68766106499566, "vf_explained_var": -8.145968119303385e-07, "kl": 0.0007731285548360305, "entropy": 0.5375299365432175, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1391.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 936000, "num_env_steps_trained": 936000, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.864999999999855, "episode_len_mean": 237.04, "episode_media": {}, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [28.29999999999996, -50.00000000000044, 35.10000000000004, 45.3, 40.30000000000002, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 46.3, 38.90000000000002, 43.900000000000006, 45.5, 5.099999999999632, -50.00000000000044, 37.10000000000003, -50.00000000000044, 43.900000000000006, 41.90000000000001, -50.00000000000044, 43.7, 34.70000000000004, 24.899999999999913, 10.699999999999712, 15.49999999999978, 45.9, -50.00000000000044, 43.30000000000001, -50.00000000000044, 42.900000000000006, -50.00000000000044, 37.50000000000003, 44.300000000000004, 45.5, -50.00000000000044, 46.099999999999994, 41.500000000000014, -50.00000000000044, 37.70000000000003, 37.70000000000003, 36.10000000000004, -50.00000000000044, 30.499999999999993, -50.00000000000044, 45.7, 41.500000000000014, 15.099999999999774, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 43.50000000000001, 41.500000000000014, 39.70000000000002, 33.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 45.5, 47.1, -50.00000000000044, 36.10000000000004, -50.00000000000044, 29.299999999999976, 34.30000000000004, 20.899999999999856, -50.00000000000044, -50.00000000000044, 42.30000000000001, 42.30000000000001, 36.30000000000003, 42.500000000000014, -50.00000000000044, 45.3, 42.500000000000014, 28.29999999999996, 44.300000000000004, -50.00000000000044, 45.3, 41.500000000000014, 35.30000000000004, 43.30000000000001, 40.500000000000014, 45.1, 32.100000000000016, 37.10000000000003, -50.00000000000044, -50.00000000000044, 39.70000000000002, 30.29999999999999, -50.00000000000044, 41.500000000000014, 34.10000000000004, -50.00000000000044, 40.500000000000014, 44.10000000000001, 44.10000000000001], "episode_lengths": [218, 500, 150, 48, 98, 500, 500, 56, 500, 38, 112, 62, 46, 450, 500, 130, 500, 62, 82, 500, 64, 154, 252, 394, 346, 42, 500, 68, 500, 72, 500, 126, 58, 46, 500, 40, 86, 500, 124, 124, 140, 500, 196, 500, 44, 86, 350, 500, 70, 500, 500, 500, 72, 66, 86, 104, 170, 500, 500, 500, 58, 46, 30, 500, 140, 500, 208, 158, 292, 500, 500, 78, 78, 138, 76, 500, 48, 76, 218, 58, 500, 48, 86, 148, 68, 96, 50, 180, 130, 500, 500, 104, 198, 500, 86, 160, 500, 96, 60, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4113205326990903, "mean_inference_ms": 1.3140966236818983, "mean_action_processing_ms": 0.15297980164475466, "mean_env_wait_ms": 0.09220287006497817, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0360107421875, "StateBufferConnector_ms": 0.008007526397705078, "ViewRequirementAgentConnector_ms": 0.12140250205993652}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.864999999999855, "episode_len_mean": 237.04, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [28.29999999999996, -50.00000000000044, 35.10000000000004, 45.3, 40.30000000000002, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 46.3, 38.90000000000002, 43.900000000000006, 45.5, 5.099999999999632, -50.00000000000044, 37.10000000000003, -50.00000000000044, 43.900000000000006, 41.90000000000001, -50.00000000000044, 43.7, 34.70000000000004, 24.899999999999913, 10.699999999999712, 15.49999999999978, 45.9, -50.00000000000044, 43.30000000000001, -50.00000000000044, 42.900000000000006, -50.00000000000044, 37.50000000000003, 44.300000000000004, 45.5, -50.00000000000044, 46.099999999999994, 41.500000000000014, -50.00000000000044, 37.70000000000003, 37.70000000000003, 36.10000000000004, -50.00000000000044, 30.499999999999993, -50.00000000000044, 45.7, 41.500000000000014, 15.099999999999774, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 43.50000000000001, 41.500000000000014, 39.70000000000002, 33.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 45.5, 47.1, -50.00000000000044, 36.10000000000004, -50.00000000000044, 29.299999999999976, 34.30000000000004, 20.899999999999856, -50.00000000000044, -50.00000000000044, 42.30000000000001, 42.30000000000001, 36.30000000000003, 42.500000000000014, -50.00000000000044, 45.3, 42.500000000000014, 28.29999999999996, 44.300000000000004, -50.00000000000044, 45.3, 41.500000000000014, 35.30000000000004, 43.30000000000001, 40.500000000000014, 45.1, 32.100000000000016, 37.10000000000003, -50.00000000000044, -50.00000000000044, 39.70000000000002, 30.29999999999999, -50.00000000000044, 41.500000000000014, 34.10000000000004, -50.00000000000044, 40.500000000000014, 44.10000000000001, 44.10000000000001], "episode_lengths": [218, 500, 150, 48, 98, 500, 500, 56, 500, 38, 112, 62, 46, 450, 500, 130, 500, 62, 82, 500, 64, 154, 252, 394, 346, 42, 500, 68, 500, 72, 500, 126, 58, 46, 500, 40, 86, 500, 124, 124, 140, 500, 196, 500, 44, 86, 350, 500, 70, 500, 500, 500, 72, 66, 86, 104, 170, 500, 500, 500, 58, 46, 30, 500, 140, 500, 208, 158, 292, 500, 500, 78, 78, 138, 76, 500, 48, 76, 218, 58, 500, 48, 86, 148, 68, 96, 50, 180, 130, 500, 500, 104, 198, 500, 86, 160, 500, 96, 60, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4113205326990903, "mean_inference_ms": 1.3140966236818983, "mean_action_processing_ms": 0.15297980164475466, "mean_env_wait_ms": 0.09220287006497817, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0360107421875, "StateBufferConnector_ms": 0.008007526397705078, "ViewRequirementAgentConnector_ms": 0.12140250205993652}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000, "num_env_steps_sampled": 936000, "num_env_steps_trained": 936000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5721.598606035496, "num_env_steps_trained_throughput_per_sec": 5721.598606035496, "timesteps_total": 936000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 936000, "timers": {"training_iteration_time_ms": 3215.189, "sample_time_ms": 2851.788, "load_time_ms": 16.9, "load_throughput": 1065108.856, "learn_time_ms": 334.814, "learn_throughput": 53761.116, "synch_weights_time_ms": 9.187}, "counters": {"num_env_steps_sampled": 936000, "num_env_steps_trained": 936000, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000}, "done": false, "episodes_total": 3642, "training_iteration": 52, "trial_id": "9f288_00020", "date": "2023-10-25_17-14-51", "timestamp": 1698250491, "time_this_iter_s": 3.150969982147217, "time_total_s": 181.39190816879272, "pid": 9936, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 181.39190816879272, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 54.54, "ram_util_percent": 26.96}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.440892098500627e-17, "cur_lr": 0.0003, "total_loss": 6.989680855362503, "policy_loss": -0.0005037714899690063, "vf_loss": 6.990239355299208, "vf_explained_var": -1.205338372124566e-06, "kl": 0.0009856203552758374, "entropy": 0.5478503803412119, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1418.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 954000, "num_env_steps_trained": 954000, "num_agent_steps_sampled": 954000, "num_agent_steps_trained": 954000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.100999999999853, "episode_len_mean": 234.68, "episode_media": {}, "episodes_this_iter": 80, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.3, 41.500000000000014, 35.30000000000004, 43.30000000000001, 40.500000000000014, 45.1, 32.100000000000016, 37.10000000000003, -50.00000000000044, -50.00000000000044, 39.70000000000002, 30.29999999999999, -50.00000000000044, 41.500000000000014, 34.10000000000004, -50.00000000000044, 40.500000000000014, 44.10000000000001, 44.10000000000001, -50.00000000000044, 45.5, 42.70000000000001, 44.5, 42.70000000000001, -50.00000000000044, -50.00000000000044, 43.50000000000001, 42.500000000000014, -50.00000000000044, 42.70000000000001, 32.30000000000002, 45.9, 14.899999999999771, 41.90000000000001, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 43.30000000000001, 38.300000000000026, 39.70000000000002, 37.50000000000003, -50.00000000000044, -50.00000000000044, 44.10000000000001, 43.900000000000006, 41.100000000000016, -50.00000000000044, 20.099999999999845, 42.10000000000001, 44.7, -50.00000000000044, 40.500000000000014, 41.30000000000001, 46.3, 45.5, -50.00000000000044, 43.50000000000001, 46.3, 11.699999999999726, 38.300000000000026, 18.899999999999828, 41.90000000000001, 40.90000000000002, 38.700000000000024, -50.00000000000044, -50.00000000000044, 42.500000000000014, 46.5, -50.00000000000044, -50.00000000000044, 29.099999999999973, -50.00000000000044, 34.30000000000004, 42.900000000000006, 8.699999999999683, 42.500000000000014, 47.3, 40.10000000000002, 44.7, 41.90000000000001, -50.00000000000044, -50.00000000000044, 35.900000000000034, 7.499999999999666, 38.700000000000024, 41.500000000000014, 18.29999999999982, -50.00000000000044, 42.30000000000001, -50.00000000000044, 45.9, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002], "episode_lengths": [500, 48, 86, 148, 68, 96, 50, 180, 130, 500, 500, 104, 198, 500, 86, 160, 500, 96, 60, 60, 500, 46, 74, 56, 74, 500, 500, 66, 76, 500, 74, 178, 42, 352, 82, 500, 60, 500, 500, 68, 118, 104, 126, 500, 500, 60, 62, 90, 500, 300, 80, 54, 500, 96, 88, 38, 46, 500, 66, 38, 384, 118, 312, 82, 92, 114, 500, 500, 76, 36, 500, 500, 210, 500, 158, 72, 414, 76, 28, 100, 54, 82, 500, 500, 142, 426, 114, 86, 318, 500, 78, 500, 42, 86, 500, 500, 500, 500, 500, 84]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41034900085057957, "mean_inference_ms": 1.3118338136836534, "mean_action_processing_ms": 0.15254313243524462, "mean_env_wait_ms": 0.09187485359190883, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01800823211669922, "StateBufferConnector_ms": 0.003000020980834961, "ViewRequirementAgentConnector_ms": 0.13499164581298828}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.100999999999853, "episode_len_mean": 234.68, "episodes_this_iter": 80, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.3, 41.500000000000014, 35.30000000000004, 43.30000000000001, 40.500000000000014, 45.1, 32.100000000000016, 37.10000000000003, -50.00000000000044, -50.00000000000044, 39.70000000000002, 30.29999999999999, -50.00000000000044, 41.500000000000014, 34.10000000000004, -50.00000000000044, 40.500000000000014, 44.10000000000001, 44.10000000000001, -50.00000000000044, 45.5, 42.70000000000001, 44.5, 42.70000000000001, -50.00000000000044, -50.00000000000044, 43.50000000000001, 42.500000000000014, -50.00000000000044, 42.70000000000001, 32.30000000000002, 45.9, 14.899999999999771, 41.90000000000001, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 43.30000000000001, 38.300000000000026, 39.70000000000002, 37.50000000000003, -50.00000000000044, -50.00000000000044, 44.10000000000001, 43.900000000000006, 41.100000000000016, -50.00000000000044, 20.099999999999845, 42.10000000000001, 44.7, -50.00000000000044, 40.500000000000014, 41.30000000000001, 46.3, 45.5, -50.00000000000044, 43.50000000000001, 46.3, 11.699999999999726, 38.300000000000026, 18.899999999999828, 41.90000000000001, 40.90000000000002, 38.700000000000024, -50.00000000000044, -50.00000000000044, 42.500000000000014, 46.5, -50.00000000000044, -50.00000000000044, 29.099999999999973, -50.00000000000044, 34.30000000000004, 42.900000000000006, 8.699999999999683, 42.500000000000014, 47.3, 40.10000000000002, 44.7, 41.90000000000001, -50.00000000000044, -50.00000000000044, 35.900000000000034, 7.499999999999666, 38.700000000000024, 41.500000000000014, 18.29999999999982, -50.00000000000044, 42.30000000000001, -50.00000000000044, 45.9, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002], "episode_lengths": [500, 48, 86, 148, 68, 96, 50, 180, 130, 500, 500, 104, 198, 500, 86, 160, 500, 96, 60, 60, 500, 46, 74, 56, 74, 500, 500, 66, 76, 500, 74, 178, 42, 352, 82, 500, 60, 500, 500, 68, 118, 104, 126, 500, 500, 60, 62, 90, 500, 300, 80, 54, 500, 96, 88, 38, 46, 500, 66, 38, 384, 118, 312, 82, 92, 114, 500, 500, 76, 36, 500, 500, 210, 500, 158, 72, 414, 76, 28, 100, 54, 82, 500, 500, 142, 426, 114, 86, 318, 500, 78, 500, 42, 86, 500, 500, 500, 500, 500, 84]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41034900085057957, "mean_inference_ms": 1.3118338136836534, "mean_action_processing_ms": 0.15254313243524462, "mean_env_wait_ms": 0.09187485359190883, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01800823211669922, "StateBufferConnector_ms": 0.003000020980834961, "ViewRequirementAgentConnector_ms": 0.13499164581298828}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 954000, "num_agent_steps_trained": 954000, "num_env_steps_sampled": 954000, "num_env_steps_trained": 954000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5405.408238332788, "num_env_steps_trained_throughput_per_sec": 5405.408238332788, "timesteps_total": 954000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 954000, "timers": {"training_iteration_time_ms": 3230.791, "sample_time_ms": 2856.791, "load_time_ms": 17.7, "load_throughput": 1016965.328, "learn_time_ms": 344.711, "learn_throughput": 52217.656, "synch_weights_time_ms": 9.09}, "counters": {"num_env_steps_sampled": 954000, "num_env_steps_trained": 954000, "num_agent_steps_sampled": 954000, "num_agent_steps_trained": 954000}, "done": false, "episodes_total": 3722, "training_iteration": 53, "trial_id": "9f288_00020", "date": "2023-10-25_17-14-54", "timestamp": 1698250494, "time_this_iter_s": 3.335996627807617, "time_total_s": 184.72790479660034, "pid": 9936, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 184.72790479660034, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 67.32499999999999, "ram_util_percent": 27.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.2204460492503135e-17, "cur_lr": 0.0003, "total_loss": 7.279695298936632, "policy_loss": -0.0004006482108875557, "vf_loss": 7.280150766725893, "vf_explained_var": -9.161454659921152e-07, "kl": 0.0009564964777163604, "entropy": 0.5483721847887393, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1445.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 972000, "num_env_steps_trained": 972000, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.978999999999823, "episode_len_mean": 265.88, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.500000000000014, 46.5, -50.00000000000044, -50.00000000000044, 29.099999999999973, -50.00000000000044, 34.30000000000004, 42.900000000000006, 8.699999999999683, 42.500000000000014, 47.3, 40.10000000000002, 44.7, 41.90000000000001, -50.00000000000044, -50.00000000000044, 35.900000000000034, 7.499999999999666, 38.700000000000024, 41.500000000000014, 18.29999999999982, -50.00000000000044, 42.30000000000001, -50.00000000000044, 45.9, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.30000000000002, 37.300000000000026, 39.10000000000002, 44.900000000000006, 44.7, 15.899999999999785, -50.00000000000044, -50.00000000000044, -50.00000000000044, 1.299999999999578, 45.1, 44.10000000000001, -50.00000000000044, 37.300000000000026, -50.00000000000044, 3.2999999999996064, 1.099999999999575, 43.7, -50.00000000000044, 43.10000000000001, 17.099999999999802, -50.00000000000044, 22.299999999999876, 42.10000000000001, 42.900000000000006, 45.5, 43.900000000000006, 10.699999999999712, 30.9, 45.3, 45.3, -50.00000000000044, 38.50000000000003, 35.900000000000034, 44.10000000000001, -50.00000000000044, 38.50000000000003, -50.00000000000044, 43.30000000000001, 33.30000000000003, 45.3, -50.00000000000044, 40.90000000000002, 44.5, 39.50000000000002, 28.09999999999996, 46.9, -50.00000000000044, 40.10000000000002, 22.699999999999882, -50.00000000000044, 38.300000000000026, 44.300000000000004, -50.00000000000044, 43.50000000000001, 24.69999999999991, 20.299999999999848, -50.00000000000044, -50.00000000000044, 7.499999999999666, 41.100000000000016, 46.5, -50.00000000000044, -50.00000000000044, 27.099999999999945], "episode_lengths": [76, 36, 500, 500, 210, 500, 158, 72, 414, 76, 28, 100, 54, 82, 500, 500, 142, 426, 114, 86, 318, 500, 78, 500, 42, 86, 500, 500, 500, 500, 500, 84, 500, 500, 500, 178, 128, 110, 52, 54, 342, 500, 500, 500, 488, 50, 60, 500, 128, 500, 468, 490, 64, 500, 70, 330, 500, 278, 80, 72, 46, 62, 394, 192, 48, 48, 500, 116, 142, 60, 500, 116, 500, 68, 168, 48, 500, 92, 56, 106, 220, 32, 500, 100, 274, 500, 118, 58, 500, 66, 254, 298, 500, 500, 426, 90, 36, 500, 500, 230]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4101107052732474, "mean_inference_ms": 1.3101081925186242, "mean_action_processing_ms": 0.15275315981410661, "mean_env_wait_ms": 0.09182193283001433, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019997119903564453, "StateBufferConnector_ms": 0.005998134613037109, "ViewRequirementAgentConnector_ms": 0.11499881744384766}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.978999999999823, "episode_len_mean": 265.88, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.500000000000014, 46.5, -50.00000000000044, -50.00000000000044, 29.099999999999973, -50.00000000000044, 34.30000000000004, 42.900000000000006, 8.699999999999683, 42.500000000000014, 47.3, 40.10000000000002, 44.7, 41.90000000000001, -50.00000000000044, -50.00000000000044, 35.900000000000034, 7.499999999999666, 38.700000000000024, 41.500000000000014, 18.29999999999982, -50.00000000000044, 42.30000000000001, -50.00000000000044, 45.9, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.30000000000002, 37.300000000000026, 39.10000000000002, 44.900000000000006, 44.7, 15.899999999999785, -50.00000000000044, -50.00000000000044, -50.00000000000044, 1.299999999999578, 45.1, 44.10000000000001, -50.00000000000044, 37.300000000000026, -50.00000000000044, 3.2999999999996064, 1.099999999999575, 43.7, -50.00000000000044, 43.10000000000001, 17.099999999999802, -50.00000000000044, 22.299999999999876, 42.10000000000001, 42.900000000000006, 45.5, 43.900000000000006, 10.699999999999712, 30.9, 45.3, 45.3, -50.00000000000044, 38.50000000000003, 35.900000000000034, 44.10000000000001, -50.00000000000044, 38.50000000000003, -50.00000000000044, 43.30000000000001, 33.30000000000003, 45.3, -50.00000000000044, 40.90000000000002, 44.5, 39.50000000000002, 28.09999999999996, 46.9, -50.00000000000044, 40.10000000000002, 22.699999999999882, -50.00000000000044, 38.300000000000026, 44.300000000000004, -50.00000000000044, 43.50000000000001, 24.69999999999991, 20.299999999999848, -50.00000000000044, -50.00000000000044, 7.499999999999666, 41.100000000000016, 46.5, -50.00000000000044, -50.00000000000044, 27.099999999999945], "episode_lengths": [76, 36, 500, 500, 210, 500, 158, 72, 414, 76, 28, 100, 54, 82, 500, 500, 142, 426, 114, 86, 318, 500, 78, 500, 42, 86, 500, 500, 500, 500, 500, 84, 500, 500, 500, 178, 128, 110, 52, 54, 342, 500, 500, 500, 488, 50, 60, 500, 128, 500, 468, 490, 64, 500, 70, 330, 500, 278, 80, 72, 46, 62, 394, 192, 48, 48, 500, 116, 142, 60, 500, 116, 500, 68, 168, 48, 500, 92, 56, 106, 220, 32, 500, 100, 274, 500, 118, 58, 500, 66, 254, 298, 500, 500, 426, 90, 36, 500, 500, 230]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4101107052732474, "mean_inference_ms": 1.3101081925186242, "mean_action_processing_ms": 0.15275315981410661, "mean_env_wait_ms": 0.09182193283001433, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019997119903564453, "StateBufferConnector_ms": 0.005998134613037109, "ViewRequirementAgentConnector_ms": 0.11499881744384766}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000, "num_env_steps_sampled": 972000, "num_env_steps_trained": 972000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5832.794226035684, "num_env_steps_trained_throughput_per_sec": 5832.794226035684, "timesteps_total": 972000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 972000, "timers": {"training_iteration_time_ms": 3237.594, "sample_time_ms": 2862.194, "load_time_ms": 17.599, "load_throughput": 1022777.849, "learn_time_ms": 346.211, "learn_throughput": 51991.351, "synch_weights_time_ms": 9.089}, "counters": {"num_env_steps_sampled": 972000, "num_env_steps_trained": 972000, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000}, "done": false, "episodes_total": 3790, "training_iteration": 54, "trial_id": "9f288_00020", "date": "2023-10-25_17-14-57", "timestamp": 1698250497, "time_this_iter_s": 3.09200119972229, "time_total_s": 187.81990599632263, "pid": 9936, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 187.81990599632263, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 59.32000000000001, "ram_util_percent": 26.96}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1102230246251568e-17, "cur_lr": 0.0003, "total_loss": 6.66607070852209, "policy_loss": -0.000158679430131559, "vf_loss": 6.666283943034984, "vf_explained_var": -1.064053288212529e-06, "kl": 0.00032389980483289775, "entropy": 0.5450923266234221, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1472.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 990000, "num_env_steps_trained": 990000, "num_agent_steps_sampled": 990000, "num_agent_steps_trained": 990000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.42599999999984, "episode_len_mean": 246.42, "episode_media": {}, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 43.30000000000001, 33.30000000000003, 45.3, -50.00000000000044, 40.90000000000002, 44.5, 39.50000000000002, 28.09999999999996, 46.9, -50.00000000000044, 40.10000000000002, 22.699999999999882, -50.00000000000044, 38.300000000000026, 44.300000000000004, -50.00000000000044, 43.50000000000001, 24.69999999999991, 20.299999999999848, -50.00000000000044, -50.00000000000044, 7.499999999999666, 41.100000000000016, 46.5, -50.00000000000044, -50.00000000000044, 27.099999999999945, 45.5, 40.70000000000002, 45.9, 26.69999999999994, 40.500000000000014, 40.90000000000002, 41.70000000000002, 38.10000000000002, -50.00000000000044, 42.70000000000001, 11.899999999999729, 42.900000000000006, 11.099999999999717, -50.00000000000044, -50.00000000000044, -50.00000000000044, 9.099999999999689, 40.10000000000002, 46.3, -50.00000000000044, -50.00000000000044, 40.90000000000002, 44.300000000000004, 44.7, 40.30000000000002, -50.00000000000044, 9.699999999999697, 31.500000000000007, -50.00000000000044, 41.70000000000002, 42.70000000000001, 40.500000000000014, 36.70000000000003, -50.00000000000044, -50.00000000000044, 43.30000000000001, 37.70000000000003, 42.10000000000001, 40.70000000000002, 39.70000000000002, 43.50000000000001, -50.00000000000044, 33.70000000000004, 35.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 45.1, -50.00000000000044, 39.10000000000002, -50.00000000000044, 44.7, -50.00000000000044, 47.3, 46.9, -50.00000000000044, 43.50000000000001, 42.30000000000001, 41.90000000000001, 32.100000000000016, 44.300000000000004, -50.00000000000044, -50.00000000000044, 36.70000000000003, 44.300000000000004, -50.00000000000044, 8.299999999999677, 45.5, -50.00000000000044, -50.00000000000044, 43.7], "episode_lengths": [500, 68, 168, 48, 500, 92, 56, 106, 220, 32, 500, 100, 274, 500, 118, 58, 500, 66, 254, 298, 500, 500, 426, 90, 36, 500, 500, 230, 46, 94, 42, 234, 96, 92, 84, 120, 500, 74, 382, 72, 390, 500, 500, 500, 410, 100, 38, 500, 500, 92, 58, 54, 98, 500, 404, 186, 500, 84, 74, 96, 134, 500, 500, 68, 124, 80, 94, 104, 66, 500, 164, 142, 500, 500, 500, 48, 50, 500, 110, 500, 54, 500, 28, 32, 500, 66, 78, 82, 180, 58, 500, 500, 134, 58, 500, 418, 46, 500, 500, 64]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40933511106674714, "mean_inference_ms": 1.309046376373968, "mean_action_processing_ms": 0.15227993514873145, "mean_env_wait_ms": 0.09155880950930614, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025002241134643555, "StateBufferConnector_ms": 0.008004188537597656, "ViewRequirementAgentConnector_ms": 0.12299513816833496}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.42599999999984, "episode_len_mean": 246.42, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 43.30000000000001, 33.30000000000003, 45.3, -50.00000000000044, 40.90000000000002, 44.5, 39.50000000000002, 28.09999999999996, 46.9, -50.00000000000044, 40.10000000000002, 22.699999999999882, -50.00000000000044, 38.300000000000026, 44.300000000000004, -50.00000000000044, 43.50000000000001, 24.69999999999991, 20.299999999999848, -50.00000000000044, -50.00000000000044, 7.499999999999666, 41.100000000000016, 46.5, -50.00000000000044, -50.00000000000044, 27.099999999999945, 45.5, 40.70000000000002, 45.9, 26.69999999999994, 40.500000000000014, 40.90000000000002, 41.70000000000002, 38.10000000000002, -50.00000000000044, 42.70000000000001, 11.899999999999729, 42.900000000000006, 11.099999999999717, -50.00000000000044, -50.00000000000044, -50.00000000000044, 9.099999999999689, 40.10000000000002, 46.3, -50.00000000000044, -50.00000000000044, 40.90000000000002, 44.300000000000004, 44.7, 40.30000000000002, -50.00000000000044, 9.699999999999697, 31.500000000000007, -50.00000000000044, 41.70000000000002, 42.70000000000001, 40.500000000000014, 36.70000000000003, -50.00000000000044, -50.00000000000044, 43.30000000000001, 37.70000000000003, 42.10000000000001, 40.70000000000002, 39.70000000000002, 43.50000000000001, -50.00000000000044, 33.70000000000004, 35.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 45.1, -50.00000000000044, 39.10000000000002, -50.00000000000044, 44.7, -50.00000000000044, 47.3, 46.9, -50.00000000000044, 43.50000000000001, 42.30000000000001, 41.90000000000001, 32.100000000000016, 44.300000000000004, -50.00000000000044, -50.00000000000044, 36.70000000000003, 44.300000000000004, -50.00000000000044, 8.299999999999677, 45.5, -50.00000000000044, -50.00000000000044, 43.7], "episode_lengths": [500, 68, 168, 48, 500, 92, 56, 106, 220, 32, 500, 100, 274, 500, 118, 58, 500, 66, 254, 298, 500, 500, 426, 90, 36, 500, 500, 230, 46, 94, 42, 234, 96, 92, 84, 120, 500, 74, 382, 72, 390, 500, 500, 500, 410, 100, 38, 500, 500, 92, 58, 54, 98, 500, 404, 186, 500, 84, 74, 96, 134, 500, 500, 68, 124, 80, 94, 104, 66, 500, 164, 142, 500, 500, 500, 48, 50, 500, 110, 500, 54, 500, 28, 32, 500, 66, 78, 82, 180, 58, 500, 500, 134, 58, 500, 418, 46, 500, 500, 64]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40933511106674714, "mean_inference_ms": 1.309046376373968, "mean_action_processing_ms": 0.15227993514873145, "mean_env_wait_ms": 0.09155880950930614, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025002241134643555, "StateBufferConnector_ms": 0.008004188537597656, "ViewRequirementAgentConnector_ms": 0.12299513816833496}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 990000, "num_agent_steps_trained": 990000, "num_env_steps_sampled": 990000, "num_env_steps_trained": 990000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5536.7584501280135, "num_env_steps_trained_throughput_per_sec": 5536.7584501280135, "timesteps_total": 990000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 990000, "timers": {"training_iteration_time_ms": 3244.896, "sample_time_ms": 2861.197, "load_time_ms": 17.599, "load_throughput": 1022779.235, "learn_time_ms": 354.409, "learn_throughput": 50788.815, "synch_weights_time_ms": 9.192}, "counters": {"num_env_steps_sampled": 990000, "num_env_steps_trained": 990000, "num_agent_steps_sampled": 990000, "num_agent_steps_trained": 990000}, "done": false, "episodes_total": 3862, "training_iteration": 55, "trial_id": "9f288_00020", "date": "2023-10-25_17-15-01", "timestamp": 1698250501, "time_this_iter_s": 3.2569997310638428, "time_total_s": 191.07690572738647, "pid": 9936, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 191.07690572738647, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 63.400000000000006, "ram_util_percent": 27.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.551115123125784e-18, "cur_lr": 0.0003, "total_loss": 7.013797177208795, "policy_loss": -0.0003399249442197658, "vf_loss": 7.0141903559366865, "vf_explained_var": -1.0463926527235244e-06, "kl": 0.0008557630151665728, "entropy": 0.5329096626352381, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1499.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 1008000, "num_env_steps_trained": 1008000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.272999999999814, "episode_len_mean": 272.88, "episode_media": {}, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.70000000000002, 43.50000000000001, -50.00000000000044, 33.70000000000004, 35.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 45.1, -50.00000000000044, 39.10000000000002, -50.00000000000044, 44.7, -50.00000000000044, 47.3, 46.9, -50.00000000000044, 43.50000000000001, 42.30000000000001, 41.90000000000001, 32.100000000000016, 44.300000000000004, -50.00000000000044, -50.00000000000044, 36.70000000000003, 44.300000000000004, -50.00000000000044, 8.299999999999677, 45.5, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 42.10000000000001, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 10.299999999999706, -50.00000000000044, -50.00000000000044, 29.69999999999998, -50.00000000000044, -50.00000000000044, 38.10000000000002, 46.699999999999996, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 22.299999999999876, 45.3, -50.00000000000044, 43.7, -50.00000000000044, 27.299999999999947, 46.3, -50.00000000000044, 29.49999999999998, 45.9, 37.70000000000003, 31.500000000000007, 46.9, -50.00000000000044, -50.00000000000044, 25.499999999999922, -50.00000000000044, 25.29999999999992, 34.30000000000004, 41.90000000000001, 45.7, -50.00000000000044, 41.100000000000016, 40.70000000000002, 33.70000000000004, 31.500000000000007, -50.00000000000044, 45.7, -50.00000000000044, 36.900000000000034, 42.500000000000014, 44.7, 39.90000000000002, 45.3, -50.00000000000044, 27.099999999999945, 45.3, 25.499999999999922, 0.6999999999995694, 39.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 0.8999999999995723, 45.1, 37.90000000000003, 45.5], "episode_lengths": [104, 66, 500, 164, 142, 500, 500, 500, 48, 50, 500, 110, 500, 54, 500, 28, 32, 500, 66, 78, 82, 180, 58, 500, 500, 134, 58, 500, 418, 46, 500, 500, 64, 500, 80, 500, 42, 500, 500, 500, 398, 500, 500, 204, 500, 500, 120, 34, 500, 500, 78, 500, 500, 278, 48, 500, 64, 500, 228, 38, 500, 206, 42, 124, 186, 32, 500, 500, 246, 500, 248, 158, 82, 44, 500, 90, 94, 164, 186, 500, 44, 500, 132, 76, 54, 102, 48, 500, 230, 48, 246, 494, 108, 500, 500, 500, 492, 50, 122, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.408839569919386, "mean_inference_ms": 1.307273347174422, "mean_action_processing_ms": 0.15203254965480317, "mean_env_wait_ms": 0.09142670272262367, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026005029678344727, "StateBufferConnector_ms": 0.009004354476928711, "ViewRequirementAgentConnector_ms": 0.13400912284851074}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.272999999999814, "episode_len_mean": 272.88, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [39.70000000000002, 43.50000000000001, -50.00000000000044, 33.70000000000004, 35.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 45.1, -50.00000000000044, 39.10000000000002, -50.00000000000044, 44.7, -50.00000000000044, 47.3, 46.9, -50.00000000000044, 43.50000000000001, 42.30000000000001, 41.90000000000001, 32.100000000000016, 44.300000000000004, -50.00000000000044, -50.00000000000044, 36.70000000000003, 44.300000000000004, -50.00000000000044, 8.299999999999677, 45.5, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 42.10000000000001, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 10.299999999999706, -50.00000000000044, -50.00000000000044, 29.69999999999998, -50.00000000000044, -50.00000000000044, 38.10000000000002, 46.699999999999996, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 22.299999999999876, 45.3, -50.00000000000044, 43.7, -50.00000000000044, 27.299999999999947, 46.3, -50.00000000000044, 29.49999999999998, 45.9, 37.70000000000003, 31.500000000000007, 46.9, -50.00000000000044, -50.00000000000044, 25.499999999999922, -50.00000000000044, 25.29999999999992, 34.30000000000004, 41.90000000000001, 45.7, -50.00000000000044, 41.100000000000016, 40.70000000000002, 33.70000000000004, 31.500000000000007, -50.00000000000044, 45.7, -50.00000000000044, 36.900000000000034, 42.500000000000014, 44.7, 39.90000000000002, 45.3, -50.00000000000044, 27.099999999999945, 45.3, 25.499999999999922, 0.6999999999995694, 39.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 0.8999999999995723, 45.1, 37.90000000000003, 45.5], "episode_lengths": [104, 66, 500, 164, 142, 500, 500, 500, 48, 50, 500, 110, 500, 54, 500, 28, 32, 500, 66, 78, 82, 180, 58, 500, 500, 134, 58, 500, 418, 46, 500, 500, 64, 500, 80, 500, 42, 500, 500, 500, 398, 500, 500, 204, 500, 500, 120, 34, 500, 500, 78, 500, 500, 278, 48, 500, 64, 500, 228, 38, 500, 206, 42, 124, 186, 32, 500, 500, 246, 500, 248, 158, 82, 44, 500, 90, 94, 164, 186, 500, 44, 500, 132, 76, 54, 102, 48, 500, 230, 48, 246, 494, 108, 500, 500, 500, 492, 50, 122, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.408839569919386, "mean_inference_ms": 1.307273347174422, "mean_action_processing_ms": 0.15203254965480317, "mean_env_wait_ms": 0.09142670272262367, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026005029678344727, "StateBufferConnector_ms": 0.009004354476928711, "ViewRequirementAgentConnector_ms": 0.13400912284851074}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000, "num_env_steps_sampled": 1008000, "num_env_steps_trained": 1008000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5277.824328271253, "num_env_steps_trained_throughput_per_sec": 5277.824328271253, "timesteps_total": 1008000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1008000, "timers": {"training_iteration_time_ms": 3266.746, "sample_time_ms": 2866.397, "load_time_ms": 18.599, "load_throughput": 967778.585, "learn_time_ms": 370.357, "learn_throughput": 48601.728, "synch_weights_time_ms": 9.092}, "counters": {"num_env_steps_sampled": 1008000, "num_env_steps_trained": 1008000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "done": false, "episodes_total": 3929, "training_iteration": 56, "trial_id": "9f288_00020", "date": "2023-10-25_17-15-04", "timestamp": 1698250504, "time_this_iter_s": 3.4154887199401855, "time_total_s": 194.49239444732666, "pid": 9936, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 194.49239444732666, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 58.660000000000004, "ram_util_percent": 27.02}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.775557561562892e-18, "cur_lr": 0.0003, "total_loss": 7.299025694529216, "policy_loss": -0.0007740206740520618, "vf_loss": 7.299854419849537, "vf_explained_var": -1.0552229704680265e-06, "kl": 0.0012205030453321375, "entropy": 0.5466338793436686, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1526.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 1026000, "num_env_steps_trained": 1026000, "num_agent_steps_sampled": 1026000, "num_agent_steps_trained": 1026000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 16.588999999999878, "episode_len_mean": 219.88, "episode_media": {}, "episodes_this_iter": 82, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [36.900000000000034, 42.500000000000014, 44.7, 39.90000000000002, 45.3, -50.00000000000044, 27.099999999999945, 45.3, 25.499999999999922, 0.6999999999995694, 39.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 0.8999999999995723, 45.1, 37.90000000000003, 45.5, 45.9, 33.90000000000004, -50.00000000000044, 43.7, 41.30000000000001, 32.30000000000002, 10.699999999999712, 45.1, 9.299999999999692, 44.10000000000001, 39.10000000000002, 31.500000000000007, 39.10000000000002, 7.899999999999672, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 33.90000000000004, 38.700000000000024, 35.70000000000003, 44.10000000000001, 40.70000000000002, -50.00000000000044, 45.1, 42.30000000000001, 24.099999999999902, 32.100000000000016, -50.00000000000044, -50.00000000000044, 44.900000000000006, 10.299999999999706, -50.00000000000044, 38.700000000000024, 41.100000000000016, 27.899999999999956, 33.500000000000036, 41.70000000000002, 42.30000000000001, 45.1, 41.100000000000016, 26.69999999999994, 41.90000000000001, 32.30000000000002, -50.00000000000044, 40.30000000000002, 45.3, -50.00000000000044, -50.00000000000044, 39.70000000000002, 13.699999999999754, 41.70000000000002, 45.7, -50.00000000000044, 42.70000000000001, 44.10000000000001, 17.69999999999981, 25.499999999999922, -50.00000000000044, 42.10000000000001, -50.00000000000044, 43.50000000000001, 45.5, -50.00000000000044, 32.700000000000024, 38.10000000000002, 45.1, 46.3, -50.00000000000044, 41.100000000000016, -50.00000000000044, 43.10000000000001, 42.900000000000006, 42.900000000000006, -50.00000000000044, 45.1, 30.099999999999987, 37.10000000000003, -50.00000000000044, 39.10000000000002, 44.5, 41.500000000000014], "episode_lengths": [132, 76, 54, 102, 48, 500, 230, 48, 246, 494, 108, 500, 500, 500, 492, 50, 122, 46, 42, 162, 500, 64, 88, 178, 394, 50, 408, 60, 110, 186, 110, 422, 500, 30, 500, 500, 162, 114, 144, 60, 94, 500, 50, 78, 260, 180, 500, 500, 52, 398, 500, 114, 90, 222, 166, 84, 78, 50, 90, 234, 82, 178, 500, 98, 48, 500, 500, 104, 364, 84, 44, 500, 74, 60, 324, 246, 500, 80, 500, 66, 46, 500, 174, 120, 50, 38, 500, 90, 500, 70, 72, 72, 500, 50, 200, 130, 500, 110, 56, 86]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40794111003230343, "mean_inference_ms": 1.3045547568576266, "mean_action_processing_ms": 0.1516574442601712, "mean_env_wait_ms": 0.0910105553568727, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02900385856628418, "StateBufferConnector_ms": 0.002998828887939453, "ViewRequirementAgentConnector_ms": 0.11600184440612793}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 16.588999999999878, "episode_len_mean": 219.88, "episodes_this_iter": 82, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [36.900000000000034, 42.500000000000014, 44.7, 39.90000000000002, 45.3, -50.00000000000044, 27.099999999999945, 45.3, 25.499999999999922, 0.6999999999995694, 39.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 0.8999999999995723, 45.1, 37.90000000000003, 45.5, 45.9, 33.90000000000004, -50.00000000000044, 43.7, 41.30000000000001, 32.30000000000002, 10.699999999999712, 45.1, 9.299999999999692, 44.10000000000001, 39.10000000000002, 31.500000000000007, 39.10000000000002, 7.899999999999672, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 33.90000000000004, 38.700000000000024, 35.70000000000003, 44.10000000000001, 40.70000000000002, -50.00000000000044, 45.1, 42.30000000000001, 24.099999999999902, 32.100000000000016, -50.00000000000044, -50.00000000000044, 44.900000000000006, 10.299999999999706, -50.00000000000044, 38.700000000000024, 41.100000000000016, 27.899999999999956, 33.500000000000036, 41.70000000000002, 42.30000000000001, 45.1, 41.100000000000016, 26.69999999999994, 41.90000000000001, 32.30000000000002, -50.00000000000044, 40.30000000000002, 45.3, -50.00000000000044, -50.00000000000044, 39.70000000000002, 13.699999999999754, 41.70000000000002, 45.7, -50.00000000000044, 42.70000000000001, 44.10000000000001, 17.69999999999981, 25.499999999999922, -50.00000000000044, 42.10000000000001, -50.00000000000044, 43.50000000000001, 45.5, -50.00000000000044, 32.700000000000024, 38.10000000000002, 45.1, 46.3, -50.00000000000044, 41.100000000000016, -50.00000000000044, 43.10000000000001, 42.900000000000006, 42.900000000000006, -50.00000000000044, 45.1, 30.099999999999987, 37.10000000000003, -50.00000000000044, 39.10000000000002, 44.5, 41.500000000000014], "episode_lengths": [132, 76, 54, 102, 48, 500, 230, 48, 246, 494, 108, 500, 500, 500, 492, 50, 122, 46, 42, 162, 500, 64, 88, 178, 394, 50, 408, 60, 110, 186, 110, 422, 500, 30, 500, 500, 162, 114, 144, 60, 94, 500, 50, 78, 260, 180, 500, 500, 52, 398, 500, 114, 90, 222, 166, 84, 78, 50, 90, 234, 82, 178, 500, 98, 48, 500, 500, 104, 364, 84, 44, 500, 74, 60, 324, 246, 500, 80, 500, 66, 46, 500, 174, 120, 50, 38, 500, 90, 500, 70, 72, 72, 500, 50, 200, 130, 500, 110, 56, 86]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40794111003230343, "mean_inference_ms": 1.3045547568576266, "mean_action_processing_ms": 0.1516574442601712, "mean_env_wait_ms": 0.0910105553568727, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02900385856628418, "StateBufferConnector_ms": 0.002998828887939453, "ViewRequirementAgentConnector_ms": 0.11600184440612793}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1026000, "num_agent_steps_trained": 1026000, "num_env_steps_sampled": 1026000, "num_env_steps_trained": 1026000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5531.702884414385, "num_env_steps_trained_throughput_per_sec": 5531.702884414385, "timesteps_total": 1026000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1026000, "timers": {"training_iteration_time_ms": 3254.643, "sample_time_ms": 2864.994, "load_time_ms": 18.402, "load_throughput": 978140.383, "learn_time_ms": 359.955, "learn_throughput": 50006.294, "synch_weights_time_ms": 9.092}, "counters": {"num_env_steps_sampled": 1026000, "num_env_steps_trained": 1026000, "num_agent_steps_sampled": 1026000, "num_agent_steps_trained": 1026000}, "done": false, "episodes_total": 4011, "training_iteration": 57, "trial_id": "9f288_00020", "date": "2023-10-25_17-15-07", "timestamp": 1698250507, "time_this_iter_s": 3.2599692344665527, "time_total_s": 197.7523636817932, "pid": 9936, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 197.7523636817932, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 55.64, "ram_util_percent": 26.98}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.387778780781446e-18, "cur_lr": 0.0003, "total_loss": 7.056668934998689, "policy_loss": -0.00013025022215313383, "vf_loss": 7.056854830847846, "vf_explained_var": -9.006924099392361e-07, "kl": 0.00034054499119688615, "entropy": 0.5564030640655093, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1553.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 1044000, "num_env_steps_trained": 1044000, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 15.525999999999875, "episode_len_mean": 215.48, "episode_media": {}, "episodes_this_iter": 80, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.5, -50.00000000000044, 32.700000000000024, 38.10000000000002, 45.1, 46.3, -50.00000000000044, 41.100000000000016, -50.00000000000044, 43.10000000000001, 42.900000000000006, 42.900000000000006, -50.00000000000044, 45.1, 30.099999999999987, 37.10000000000003, -50.00000000000044, 39.10000000000002, 44.5, 41.500000000000014, -50.00000000000044, 40.90000000000002, 33.30000000000003, -50.00000000000044, 45.7, 39.50000000000002, 42.900000000000006, 27.699999999999953, -50.00000000000044, 39.90000000000002, -50.00000000000044, 44.300000000000004, -50.00000000000044, 29.49999999999998, 41.500000000000014, 42.10000000000001, -50.00000000000044, 41.70000000000002, 43.10000000000001, 45.5, -50.00000000000044, 44.5, -50.00000000000044, 46.3, 46.099999999999994, 36.900000000000034, 43.30000000000001, 42.900000000000006, 44.5, 44.10000000000001, 45.1, 39.10000000000002, 32.50000000000002, 42.70000000000001, 32.30000000000002, 43.7, 38.10000000000002, 42.900000000000006, -50.00000000000044, 44.900000000000006, 30.099999999999987, 43.30000000000001, -50.00000000000044, 34.30000000000004, -50.00000000000044, 46.3, 46.099999999999994, -50.00000000000044, -50.00000000000044, 39.300000000000026, 44.7, 27.699999999999953, 42.500000000000014, 45.1, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 7.899999999999672, 45.5, 18.099999999999817, 1.8999999999995865, -50.00000000000044, 22.099999999999874, 45.3, 18.29999999999982, 36.50000000000003, 38.90000000000002, 25.099999999999916, 47.1, 23.8999999999999, 45.7, 31.900000000000013, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 24.099999999999902, 47.1], "episode_lengths": [46, 500, 174, 120, 50, 38, 500, 90, 500, 70, 72, 72, 500, 50, 200, 130, 500, 110, 56, 86, 500, 92, 168, 500, 44, 106, 72, 224, 500, 102, 500, 58, 500, 206, 86, 80, 500, 84, 70, 46, 500, 56, 500, 38, 40, 132, 68, 72, 56, 60, 50, 110, 176, 74, 178, 64, 120, 72, 500, 52, 200, 68, 500, 158, 500, 38, 40, 500, 500, 108, 54, 224, 76, 50, 48, 500, 500, 500, 500, 422, 46, 320, 482, 500, 280, 48, 318, 136, 112, 250, 30, 262, 44, 182, 500, 500, 42, 500, 260, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40731923421125216, "mean_inference_ms": 1.30001407204938, "mean_action_processing_ms": 0.15085626051783937, "mean_env_wait_ms": 0.09065116314703506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021997451782226562, "StateBufferConnector_ms": 0.006002902984619141, "ViewRequirementAgentConnector_ms": 0.1439802646636963}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 15.525999999999875, "episode_len_mean": 215.48, "episodes_this_iter": 80, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.5, -50.00000000000044, 32.700000000000024, 38.10000000000002, 45.1, 46.3, -50.00000000000044, 41.100000000000016, -50.00000000000044, 43.10000000000001, 42.900000000000006, 42.900000000000006, -50.00000000000044, 45.1, 30.099999999999987, 37.10000000000003, -50.00000000000044, 39.10000000000002, 44.5, 41.500000000000014, -50.00000000000044, 40.90000000000002, 33.30000000000003, -50.00000000000044, 45.7, 39.50000000000002, 42.900000000000006, 27.699999999999953, -50.00000000000044, 39.90000000000002, -50.00000000000044, 44.300000000000004, -50.00000000000044, 29.49999999999998, 41.500000000000014, 42.10000000000001, -50.00000000000044, 41.70000000000002, 43.10000000000001, 45.5, -50.00000000000044, 44.5, -50.00000000000044, 46.3, 46.099999999999994, 36.900000000000034, 43.30000000000001, 42.900000000000006, 44.5, 44.10000000000001, 45.1, 39.10000000000002, 32.50000000000002, 42.70000000000001, 32.30000000000002, 43.7, 38.10000000000002, 42.900000000000006, -50.00000000000044, 44.900000000000006, 30.099999999999987, 43.30000000000001, -50.00000000000044, 34.30000000000004, -50.00000000000044, 46.3, 46.099999999999994, -50.00000000000044, -50.00000000000044, 39.300000000000026, 44.7, 27.699999999999953, 42.500000000000014, 45.1, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 7.899999999999672, 45.5, 18.099999999999817, 1.8999999999995865, -50.00000000000044, 22.099999999999874, 45.3, 18.29999999999982, 36.50000000000003, 38.90000000000002, 25.099999999999916, 47.1, 23.8999999999999, 45.7, 31.900000000000013, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 24.099999999999902, 47.1], "episode_lengths": [46, 500, 174, 120, 50, 38, 500, 90, 500, 70, 72, 72, 500, 50, 200, 130, 500, 110, 56, 86, 500, 92, 168, 500, 44, 106, 72, 224, 500, 102, 500, 58, 500, 206, 86, 80, 500, 84, 70, 46, 500, 56, 500, 38, 40, 132, 68, 72, 56, 60, 50, 110, 176, 74, 178, 64, 120, 72, 500, 52, 200, 68, 500, 158, 500, 38, 40, 500, 500, 108, 54, 224, 76, 50, 48, 500, 500, 500, 500, 422, 46, 320, 482, 500, 280, 48, 318, 136, 112, 250, 30, 262, 44, 182, 500, 500, 42, 500, 260, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40731923421125216, "mean_inference_ms": 1.30001407204938, "mean_action_processing_ms": 0.15085626051783937, "mean_env_wait_ms": 0.09065116314703506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021997451782226562, "StateBufferConnector_ms": 0.006002902984619141, "ViewRequirementAgentConnector_ms": 0.1439802646636963}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000, "num_env_steps_sampled": 1044000, "num_env_steps_trained": 1044000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5643.437897156225, "num_env_steps_trained_throughput_per_sec": 5643.437897156225, "timesteps_total": 1044000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1044000, "timers": {"training_iteration_time_ms": 3256.901, "sample_time_ms": 2864.196, "load_time_ms": 19.402, "load_throughput": 927726.711, "learn_time_ms": 362.113, "learn_throughput": 49708.227, "synch_weights_time_ms": 9.089}, "counters": {"num_env_steps_sampled": 1044000, "num_env_steps_trained": 1044000, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000}, "done": false, "episodes_total": 4091, "training_iteration": 58, "trial_id": "9f288_00020", "date": "2023-10-25_17-15-11", "timestamp": 1698250511, "time_this_iter_s": 3.19454288482666, "time_total_s": 200.94690656661987, "pid": 9936, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 200.94690656661987, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 65.75, "ram_util_percent": 27.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.93889390390723e-19, "cur_lr": 0.0003, "total_loss": 7.061400501816361, "policy_loss": 4.433361054570587e-05, "vf_loss": 7.061413888578062, "vf_explained_var": -9.713349518952547e-07, "kl": 0.00011467009489849631, "entropy": 0.5780147247844272, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1580.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 1062000, "num_env_steps_trained": 1062000, "num_agent_steps_sampled": 1062000, "num_agent_steps_trained": 1062000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.23599999999983, "episode_len_mean": 258.32, "episode_media": {}, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 7.899999999999672, 45.5, 18.099999999999817, 1.8999999999995865, -50.00000000000044, 22.099999999999874, 45.3, 18.29999999999982, 36.50000000000003, 38.90000000000002, 25.099999999999916, 47.1, 23.8999999999999, 45.7, 31.900000000000013, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 24.099999999999902, 47.1, -50.00000000000044, -50.00000000000044, 37.70000000000003, 22.099999999999874, -50.00000000000044, 34.10000000000004, 46.3, 44.300000000000004, 42.10000000000001, -50.00000000000044, 43.900000000000006, 44.10000000000001, 41.90000000000001, 33.500000000000036, -50.00000000000044, 24.69999999999991, 17.899999999999814, 30.9, 43.7, 41.90000000000001, 46.099999999999994, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.499999999999922, 45.3, 47.1, 44.900000000000006, 44.900000000000006, 41.500000000000014, 43.50000000000001, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 44.5, 44.10000000000001, 32.50000000000002, -50.00000000000044, 41.70000000000002, 24.299999999999905, 36.30000000000003, 41.500000000000014, -50.00000000000044, 47.1, -50.00000000000044, 34.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 7.699999999999669, 44.900000000000006, 4.699999999999626, 44.7, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 30.499999999999993, 13.299999999999748, 41.500000000000014, 45.5, 41.100000000000016, 45.1, 33.500000000000036, -50.00000000000044, 9.699999999999697, -50.00000000000044, 43.900000000000006, -50.00000000000044, 41.30000000000001], "episode_lengths": [48, 500, 500, 500, 500, 422, 46, 320, 482, 500, 280, 48, 318, 136, 112, 250, 30, 262, 44, 182, 500, 500, 42, 500, 260, 30, 500, 500, 124, 280, 500, 160, 38, 58, 80, 500, 62, 60, 82, 166, 500, 254, 322, 192, 64, 82, 40, 500, 52, 500, 500, 500, 246, 48, 30, 52, 52, 86, 66, 500, 500, 74, 500, 56, 60, 176, 500, 84, 258, 138, 86, 500, 30, 500, 158, 500, 500, 500, 424, 52, 454, 54, 76, 500, 500, 500, 88, 196, 368, 86, 46, 90, 50, 166, 500, 404, 500, 62, 500, 88]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4071732468371117, "mean_inference_ms": 1.2992813149429037, "mean_action_processing_ms": 0.15139717935871932, "mean_env_wait_ms": 0.09071833930512453, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025989294052124023, "StateBufferConnector_ms": 0.00400090217590332, "ViewRequirementAgentConnector_ms": 0.12999677658081055}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.23599999999983, "episode_len_mean": 258.32, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 7.899999999999672, 45.5, 18.099999999999817, 1.8999999999995865, -50.00000000000044, 22.099999999999874, 45.3, 18.29999999999982, 36.50000000000003, 38.90000000000002, 25.099999999999916, 47.1, 23.8999999999999, 45.7, 31.900000000000013, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 24.099999999999902, 47.1, -50.00000000000044, -50.00000000000044, 37.70000000000003, 22.099999999999874, -50.00000000000044, 34.10000000000004, 46.3, 44.300000000000004, 42.10000000000001, -50.00000000000044, 43.900000000000006, 44.10000000000001, 41.90000000000001, 33.500000000000036, -50.00000000000044, 24.69999999999991, 17.899999999999814, 30.9, 43.7, 41.90000000000001, 46.099999999999994, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.499999999999922, 45.3, 47.1, 44.900000000000006, 44.900000000000006, 41.500000000000014, 43.50000000000001, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 44.5, 44.10000000000001, 32.50000000000002, -50.00000000000044, 41.70000000000002, 24.299999999999905, 36.30000000000003, 41.500000000000014, -50.00000000000044, 47.1, -50.00000000000044, 34.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 7.699999999999669, 44.900000000000006, 4.699999999999626, 44.7, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 30.499999999999993, 13.299999999999748, 41.500000000000014, 45.5, 41.100000000000016, 45.1, 33.500000000000036, -50.00000000000044, 9.699999999999697, -50.00000000000044, 43.900000000000006, -50.00000000000044, 41.30000000000001], "episode_lengths": [48, 500, 500, 500, 500, 422, 46, 320, 482, 500, 280, 48, 318, 136, 112, 250, 30, 262, 44, 182, 500, 500, 42, 500, 260, 30, 500, 500, 124, 280, 500, 160, 38, 58, 80, 500, 62, 60, 82, 166, 500, 254, 322, 192, 64, 82, 40, 500, 52, 500, 500, 500, 246, 48, 30, 52, 52, 86, 66, 500, 500, 74, 500, 56, 60, 176, 500, 84, 258, 138, 86, 500, 30, 500, 158, 500, 500, 500, 424, 52, 454, 54, 76, 500, 500, 500, 88, 196, 368, 86, 46, 90, 50, 166, 500, 404, 500, 62, 500, 88]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4071732468371117, "mean_inference_ms": 1.2992813149429037, "mean_action_processing_ms": 0.15139717935871932, "mean_env_wait_ms": 0.09071833930512453, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025989294052124023, "StateBufferConnector_ms": 0.00400090217590332, "ViewRequirementAgentConnector_ms": 0.12999677658081055}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1062000, "num_agent_steps_trained": 1062000, "num_env_steps_sampled": 1062000, "num_env_steps_trained": 1062000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5982.052765373736, "num_env_steps_trained_throughput_per_sec": 5982.052765373736, "timesteps_total": 1062000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1062000, "timers": {"training_iteration_time_ms": 3223.096, "sample_time_ms": 2857.391, "load_time_ms": 17.902, "load_throughput": 1005463.941, "learn_time_ms": 336.614, "learn_throughput": 53473.736, "synch_weights_time_ms": 9.089}, "counters": {"num_env_steps_sampled": 1062000, "num_env_steps_trained": 1062000, "num_agent_steps_sampled": 1062000, "num_agent_steps_trained": 1062000}, "done": false, "episodes_total": 4165, "training_iteration": 59, "trial_id": "9f288_00020", "date": "2023-10-25_17-15-14", "timestamp": 1698250514, "time_this_iter_s": 3.0139992237091064, "time_total_s": 203.96090579032898, "pid": 9936, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 203.96090579032898, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 60.55, "ram_util_percent": 27.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.469446951953615e-19, "cur_lr": 0.0003, "total_loss": 7.489345356270119, "policy_loss": -0.00025516720833601775, "vf_loss": 7.489655953866464, "vf_explained_var": -1.037562334979022e-06, "kl": 0.00041632256223120176, "entropy": 0.5543669053801784, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1607.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 1080000, "num_env_steps_trained": 1080000, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 15.41299999999987, "episode_len_mean": 221.62, "episode_media": {}, "episodes_this_iter": 85, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 41.30000000000001, 30.499999999999993, 13.299999999999748, 41.500000000000014, 45.5, 41.100000000000016, 45.1, 33.500000000000036, -50.00000000000044, 9.699999999999697, -50.00000000000044, 43.900000000000006, -50.00000000000044, 41.30000000000001, -50.00000000000044, 45.9, 26.299999999999933, 44.7, 27.899999999999956, 20.49999999999985, 14.699999999999768, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 45.7, 40.10000000000002, 9.699999999999697, 46.3, 45.9, 39.70000000000002, 29.49999999999998, 45.3, 36.50000000000003, 46.5, -50.00000000000044, 43.900000000000006, 44.5, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.300000000000026, -50.00000000000044, 42.900000000000006, 21.699999999999868, 41.500000000000014, 39.90000000000002, -50.00000000000044, 44.7, 42.10000000000001, 32.100000000000016, 42.500000000000014, 39.50000000000002, 22.49999999999988, 39.50000000000002, 37.90000000000003, 44.7, 24.299999999999905, 45.9, 33.70000000000004, 41.30000000000001, 20.099999999999845, -50.00000000000044, 7.09999999999966, 46.9, 29.69999999999998, 44.5, 46.699999999999996, -50.00000000000044, 37.70000000000003, -50.00000000000044, 25.099999999999916, -50.00000000000044, 40.70000000000002, 44.300000000000004, 41.500000000000014, -50.00000000000044, -50.00000000000044, 44.7, 41.30000000000001, 44.7, 42.500000000000014, 47.7, 38.50000000000003, -50.00000000000044, -50.00000000000044, 37.90000000000003, 44.900000000000006, 45.3, 40.10000000000002, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 42.10000000000001, 6.099999999999646, 39.90000000000002, 42.70000000000001], "episode_lengths": [500, 88, 196, 368, 86, 46, 90, 50, 166, 500, 404, 500, 62, 500, 88, 500, 42, 238, 54, 222, 296, 354, 500, 500, 62, 500, 44, 100, 404, 38, 42, 104, 206, 48, 136, 36, 500, 62, 56, 44, 500, 500, 500, 108, 500, 72, 284, 86, 102, 500, 54, 80, 180, 76, 106, 276, 106, 122, 54, 258, 42, 164, 88, 300, 500, 430, 32, 204, 56, 34, 500, 124, 500, 250, 500, 94, 58, 86, 500, 500, 54, 88, 54, 76, 24, 116, 500, 500, 122, 52, 48, 100, 500, 500, 74, 500, 80, 440, 102, 74]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40658722559681704, "mean_inference_ms": 1.29851629822115, "mean_action_processing_ms": 0.1509490377029274, "mean_env_wait_ms": 0.09059420816464471, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.033011674880981445, "StateBufferConnector_ms": 0.003998517990112305, "ViewRequirementAgentConnector_ms": 0.11555957794189453}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 15.41299999999987, "episode_len_mean": 221.62, "episodes_this_iter": 85, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 41.30000000000001, 30.499999999999993, 13.299999999999748, 41.500000000000014, 45.5, 41.100000000000016, 45.1, 33.500000000000036, -50.00000000000044, 9.699999999999697, -50.00000000000044, 43.900000000000006, -50.00000000000044, 41.30000000000001, -50.00000000000044, 45.9, 26.299999999999933, 44.7, 27.899999999999956, 20.49999999999985, 14.699999999999768, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 45.7, 40.10000000000002, 9.699999999999697, 46.3, 45.9, 39.70000000000002, 29.49999999999998, 45.3, 36.50000000000003, 46.5, -50.00000000000044, 43.900000000000006, 44.5, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.300000000000026, -50.00000000000044, 42.900000000000006, 21.699999999999868, 41.500000000000014, 39.90000000000002, -50.00000000000044, 44.7, 42.10000000000001, 32.100000000000016, 42.500000000000014, 39.50000000000002, 22.49999999999988, 39.50000000000002, 37.90000000000003, 44.7, 24.299999999999905, 45.9, 33.70000000000004, 41.30000000000001, 20.099999999999845, -50.00000000000044, 7.09999999999966, 46.9, 29.69999999999998, 44.5, 46.699999999999996, -50.00000000000044, 37.70000000000003, -50.00000000000044, 25.099999999999916, -50.00000000000044, 40.70000000000002, 44.300000000000004, 41.500000000000014, -50.00000000000044, -50.00000000000044, 44.7, 41.30000000000001, 44.7, 42.500000000000014, 47.7, 38.50000000000003, -50.00000000000044, -50.00000000000044, 37.90000000000003, 44.900000000000006, 45.3, 40.10000000000002, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 42.10000000000001, 6.099999999999646, 39.90000000000002, 42.70000000000001], "episode_lengths": [500, 88, 196, 368, 86, 46, 90, 50, 166, 500, 404, 500, 62, 500, 88, 500, 42, 238, 54, 222, 296, 354, 500, 500, 62, 500, 44, 100, 404, 38, 42, 104, 206, 48, 136, 36, 500, 62, 56, 44, 500, 500, 500, 108, 500, 72, 284, 86, 102, 500, 54, 80, 180, 76, 106, 276, 106, 122, 54, 258, 42, 164, 88, 300, 500, 430, 32, 204, 56, 34, 500, 124, 500, 250, 500, 94, 58, 86, 500, 500, 54, 88, 54, 76, 24, 116, 500, 500, 122, 52, 48, 100, 500, 500, 74, 500, 80, 440, 102, 74]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40658722559681704, "mean_inference_ms": 1.29851629822115, "mean_action_processing_ms": 0.1509490377029274, "mean_env_wait_ms": 0.09059420816464471, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.033011674880981445, "StateBufferConnector_ms": 0.003998517990112305, "ViewRequirementAgentConnector_ms": 0.11555957794189453}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000, "num_env_steps_sampled": 1080000, "num_env_steps_trained": 1080000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5640.859480588704, "num_env_steps_trained_throughput_per_sec": 5640.859480588704, "timesteps_total": 1080000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1080000, "timers": {"training_iteration_time_ms": 3219.299, "sample_time_ms": 2849.194, "load_time_ms": 18.405, "load_throughput": 977985.8, "learn_time_ms": 340.514, "learn_throughput": 52861.256, "synch_weights_time_ms": 9.085}, "counters": {"num_env_steps_sampled": 1080000, "num_env_steps_trained": 1080000, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000}, "done": false, "episodes_total": 4250, "training_iteration": 60, "trial_id": "9f288_00020", "date": "2023-10-25_17-15-17", "timestamp": 1698250517, "time_this_iter_s": 3.197028398513794, "time_total_s": 207.15793418884277, "pid": 9936, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 207.15793418884277, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 62.11999999999999, "ram_util_percent": 26.919999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.7347234759768074e-19, "cur_lr": 0.0003, "total_loss": 5.823196428793448, "policy_loss": -9.354880010640179e-05, "vf_loss": 5.823343435923259, "vf_explained_var": -1.1258655124240452e-06, "kl": 0.0005926221095891109, "entropy": 0.5337513276824245, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1634.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 1098000, "num_env_steps_trained": 1098000, "num_agent_steps_sampled": 1098000, "num_agent_steps_trained": 1098000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.422999999999834, "episode_len_mean": 251.42, "episode_media": {}, "episodes_this_iter": 57, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [37.90000000000003, 44.7, 24.299999999999905, 45.9, 33.70000000000004, 41.30000000000001, 20.099999999999845, -50.00000000000044, 7.09999999999966, 46.9, 29.69999999999998, 44.5, 46.699999999999996, -50.00000000000044, 37.70000000000003, -50.00000000000044, 25.099999999999916, -50.00000000000044, 40.70000000000002, 44.300000000000004, 41.500000000000014, -50.00000000000044, -50.00000000000044, 44.7, 41.30000000000001, 44.7, 42.500000000000014, 47.7, 38.50000000000003, -50.00000000000044, -50.00000000000044, 37.90000000000003, 44.900000000000006, 45.3, 40.10000000000002, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 42.10000000000001, 6.099999999999646, 39.90000000000002, 42.70000000000001, 33.30000000000003, -50.00000000000044, 33.30000000000003, -50.00000000000044, 40.70000000000002, 40.90000000000002, 43.7, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 45.1, 37.70000000000003, 2.8999999999996007, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 45.5, 43.7, 29.899999999999984, 43.900000000000006, 43.7, 41.90000000000001, 42.10000000000001, -50.00000000000044, 45.7, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, 26.09999999999993, -50.00000000000044, 46.3, -50.00000000000044, 46.699999999999996, 46.099999999999994, 43.10000000000001, -50.00000000000044, -50.00000000000044, 41.100000000000016, 43.30000000000001, 35.70000000000003, 38.300000000000026, -50.00000000000044, -50.00000000000044, 6.499999999999652, -50.00000000000044, 41.100000000000016, 36.70000000000003, 42.900000000000006], "episode_lengths": [122, 54, 258, 42, 164, 88, 300, 500, 430, 32, 204, 56, 34, 500, 124, 500, 250, 500, 94, 58, 86, 500, 500, 54, 88, 54, 76, 24, 116, 500, 500, 122, 52, 48, 100, 500, 500, 74, 500, 80, 440, 102, 74, 168, 500, 168, 500, 94, 92, 64, 500, 500, 60, 500, 500, 50, 124, 472, 500, 500, 72, 500, 46, 64, 202, 62, 64, 82, 80, 500, 44, 500, 68, 500, 500, 500, 500, 500, 500, 92, 240, 500, 38, 500, 34, 40, 70, 500, 500, 90, 68, 144, 118, 500, 500, 436, 500, 90, 134, 72]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40624240735659695, "mean_inference_ms": 1.2977566381711667, "mean_action_processing_ms": 0.1511369596945716, "mean_env_wait_ms": 0.09066408799435831, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02600240707397461, "StateBufferConnector_ms": 0.0029976367950439453, "ViewRequirementAgentConnector_ms": 0.12654924392700195}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.422999999999834, "episode_len_mean": 251.42, "episodes_this_iter": 57, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [37.90000000000003, 44.7, 24.299999999999905, 45.9, 33.70000000000004, 41.30000000000001, 20.099999999999845, -50.00000000000044, 7.09999999999966, 46.9, 29.69999999999998, 44.5, 46.699999999999996, -50.00000000000044, 37.70000000000003, -50.00000000000044, 25.099999999999916, -50.00000000000044, 40.70000000000002, 44.300000000000004, 41.500000000000014, -50.00000000000044, -50.00000000000044, 44.7, 41.30000000000001, 44.7, 42.500000000000014, 47.7, 38.50000000000003, -50.00000000000044, -50.00000000000044, 37.90000000000003, 44.900000000000006, 45.3, 40.10000000000002, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 42.10000000000001, 6.099999999999646, 39.90000000000002, 42.70000000000001, 33.30000000000003, -50.00000000000044, 33.30000000000003, -50.00000000000044, 40.70000000000002, 40.90000000000002, 43.7, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 45.1, 37.70000000000003, 2.8999999999996007, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 45.5, 43.7, 29.899999999999984, 43.900000000000006, 43.7, 41.90000000000001, 42.10000000000001, -50.00000000000044, 45.7, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, 26.09999999999993, -50.00000000000044, 46.3, -50.00000000000044, 46.699999999999996, 46.099999999999994, 43.10000000000001, -50.00000000000044, -50.00000000000044, 41.100000000000016, 43.30000000000001, 35.70000000000003, 38.300000000000026, -50.00000000000044, -50.00000000000044, 6.499999999999652, -50.00000000000044, 41.100000000000016, 36.70000000000003, 42.900000000000006], "episode_lengths": [122, 54, 258, 42, 164, 88, 300, 500, 430, 32, 204, 56, 34, 500, 124, 500, 250, 500, 94, 58, 86, 500, 500, 54, 88, 54, 76, 24, 116, 500, 500, 122, 52, 48, 100, 500, 500, 74, 500, 80, 440, 102, 74, 168, 500, 168, 500, 94, 92, 64, 500, 500, 60, 500, 500, 50, 124, 472, 500, 500, 72, 500, 46, 64, 202, 62, 64, 82, 80, 500, 44, 500, 68, 500, 500, 500, 500, 500, 500, 92, 240, 500, 38, 500, 34, 40, 70, 500, 500, 90, 68, 144, 118, 500, 500, 436, 500, 90, 134, 72]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40624240735659695, "mean_inference_ms": 1.2977566381711667, "mean_action_processing_ms": 0.1511369596945716, "mean_env_wait_ms": 0.09066408799435831, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02600240707397461, "StateBufferConnector_ms": 0.0029976367950439453, "ViewRequirementAgentConnector_ms": 0.12654924392700195}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1098000, "num_agent_steps_trained": 1098000, "num_env_steps_sampled": 1098000, "num_env_steps_trained": 1098000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5548.702927049826, "num_env_steps_trained_throughput_per_sec": 5548.702927049826, "timesteps_total": 1098000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1098000, "timers": {"training_iteration_time_ms": 3210.999, "sample_time_ms": 2851.294, "load_time_ms": 17.305, "load_throughput": 1040146.48, "learn_time_ms": 331.211, "learn_throughput": 54345.944, "synch_weights_time_ms": 9.088}, "counters": {"num_env_steps_sampled": 1098000, "num_env_steps_trained": 1098000, "num_agent_steps_sampled": 1098000, "num_agent_steps_trained": 1098000}, "done": false, "episodes_total": 4307, "training_iteration": 61, "trial_id": "9f288_00020", "date": "2023-10-25_17-15-20", "timestamp": 1698250520, "time_this_iter_s": 3.25, "time_total_s": 210.40793418884277, "pid": 9936, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 210.40793418884277, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 56.760000000000005, "ram_util_percent": 26.939999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.673617379884037e-20, "cur_lr": 0.0003, "total_loss": 6.958852732623065, "policy_loss": -0.00035893199620423493, "vf_loss": 6.959260622660319, "vf_explained_var": -9.205606248643663e-07, "kl": 0.0008002231705796072, "entropy": 0.48866170313623214, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1661.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 1116000, "num_env_steps_trained": 1116000, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.4089999999998064, "episode_len_mean": 281.5, "episode_media": {}, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.7, 41.90000000000001, 42.10000000000001, -50.00000000000044, 45.7, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, 26.09999999999993, -50.00000000000044, 46.3, -50.00000000000044, 46.699999999999996, 46.099999999999994, 43.10000000000001, -50.00000000000044, -50.00000000000044, 41.100000000000016, 43.30000000000001, 35.70000000000003, 38.300000000000026, -50.00000000000044, -50.00000000000044, 6.499999999999652, -50.00000000000044, 41.100000000000016, 36.70000000000003, 42.900000000000006, 30.9, 10.299999999999706, 22.699999999999882, 37.10000000000003, 45.1, 22.099999999999874, 29.49999999999998, -50.00000000000044, 43.7, -50.00000000000044, 30.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.499999999999922, -50.00000000000044, 47.3, -50.00000000000044, 29.899999999999984, 41.30000000000001, 44.7, 28.499999999999964, -50.00000000000044, 44.10000000000001, 40.30000000000002, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 42.500000000000014, 38.700000000000024, -50.00000000000044, -50.00000000000044, 32.30000000000002, 38.700000000000024, 39.90000000000002, -50.00000000000044, -50.00000000000044, 24.499999999999908, 43.900000000000006, 35.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 46.5, 44.10000000000001, 39.50000000000002, 43.7, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 25.29999999999992, 13.499999999999751, 27.899999999999956, -50.00000000000044, 47.5, 38.10000000000002, 19.69999999999984, -50.00000000000044], "episode_lengths": [64, 82, 80, 500, 44, 500, 68, 500, 500, 500, 500, 500, 500, 92, 240, 500, 38, 500, 34, 40, 70, 500, 500, 90, 68, 144, 118, 500, 500, 436, 500, 90, 134, 72, 192, 398, 274, 130, 50, 280, 206, 500, 64, 500, 194, 500, 500, 500, 246, 500, 28, 500, 202, 88, 54, 216, 500, 60, 98, 52, 500, 500, 500, 500, 500, 30, 76, 114, 500, 500, 178, 114, 102, 500, 500, 256, 62, 146, 500, 500, 500, 88, 36, 60, 106, 64, 500, 52, 500, 500, 500, 44, 248, 366, 222, 500, 26, 120, 304, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4061819944867257, "mean_inference_ms": 1.296298993959562, "mean_action_processing_ms": 0.1509829522869003, "mean_env_wait_ms": 0.0904847410462636, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019994258880615234, "StateBufferConnector_ms": 0.006992340087890625, "ViewRequirementAgentConnector_ms": 0.1270129680633545}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.4089999999998064, "episode_len_mean": 281.5, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.7, 41.90000000000001, 42.10000000000001, -50.00000000000044, 45.7, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, 26.09999999999993, -50.00000000000044, 46.3, -50.00000000000044, 46.699999999999996, 46.099999999999994, 43.10000000000001, -50.00000000000044, -50.00000000000044, 41.100000000000016, 43.30000000000001, 35.70000000000003, 38.300000000000026, -50.00000000000044, -50.00000000000044, 6.499999999999652, -50.00000000000044, 41.100000000000016, 36.70000000000003, 42.900000000000006, 30.9, 10.299999999999706, 22.699999999999882, 37.10000000000003, 45.1, 22.099999999999874, 29.49999999999998, -50.00000000000044, 43.7, -50.00000000000044, 30.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.499999999999922, -50.00000000000044, 47.3, -50.00000000000044, 29.899999999999984, 41.30000000000001, 44.7, 28.499999999999964, -50.00000000000044, 44.10000000000001, 40.30000000000002, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 42.500000000000014, 38.700000000000024, -50.00000000000044, -50.00000000000044, 32.30000000000002, 38.700000000000024, 39.90000000000002, -50.00000000000044, -50.00000000000044, 24.499999999999908, 43.900000000000006, 35.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 46.5, 44.10000000000001, 39.50000000000002, 43.7, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 25.29999999999992, 13.499999999999751, 27.899999999999956, -50.00000000000044, 47.5, 38.10000000000002, 19.69999999999984, -50.00000000000044], "episode_lengths": [64, 82, 80, 500, 44, 500, 68, 500, 500, 500, 500, 500, 500, 92, 240, 500, 38, 500, 34, 40, 70, 500, 500, 90, 68, 144, 118, 500, 500, 436, 500, 90, 134, 72, 192, 398, 274, 130, 50, 280, 206, 500, 64, 500, 194, 500, 500, 500, 246, 500, 28, 500, 202, 88, 54, 216, 500, 60, 98, 52, 500, 500, 500, 500, 500, 30, 76, 114, 500, 500, 178, 114, 102, 500, 500, 256, 62, 146, 500, 500, 500, 88, 36, 60, 106, 64, 500, 52, 500, 500, 500, 44, 248, 366, 222, 500, 26, 120, 304, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4061819944867257, "mean_inference_ms": 1.296298993959562, "mean_action_processing_ms": 0.1509829522869003, "mean_env_wait_ms": 0.0904847410462636, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019994258880615234, "StateBufferConnector_ms": 0.006992340087890625, "ViewRequirementAgentConnector_ms": 0.1270129680633545}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000, "num_env_steps_sampled": 1116000, "num_env_steps_trained": 1116000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5027.612974579271, "num_env_steps_trained_throughput_per_sec": 5027.612974579271, "timesteps_total": 1116000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1116000, "timers": {"training_iteration_time_ms": 3254.424, "sample_time_ms": 2874.518, "load_time_ms": 18.505, "load_throughput": 972684.958, "learn_time_ms": 350.314, "learn_throughput": 51382.415, "synch_weights_time_ms": 8.985}, "counters": {"num_env_steps_sampled": 1116000, "num_env_steps_trained": 1116000, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000}, "done": false, "episodes_total": 4373, "training_iteration": 62, "trial_id": "9f288_00020", "date": "2023-10-25_17-15-24", "timestamp": 1698250524, "time_this_iter_s": 3.585223436355591, "time_total_s": 213.99315762519836, "pid": 9936, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 213.99315762519836, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 61.86, "ram_util_percent": 27.02}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.3368086899420186e-20, "cur_lr": 0.0003, "total_loss": 6.902007897694905, "policy_loss": -9.177142271289119e-05, "vf_loss": 6.902152467657019, "vf_explained_var": -8.653711389612269e-07, "kl": 0.00026331113003750405, "entropy": 0.529641330242157, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1688.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 1134000, "num_env_steps_trained": 1134000, "num_agent_steps_sampled": 1134000, "num_agent_steps_trained": 1134000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.39799999999981, "episode_len_mean": 276.64, "episode_media": {}, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [47.1, 42.500000000000014, 38.700000000000024, -50.00000000000044, -50.00000000000044, 32.30000000000002, 38.700000000000024, 39.90000000000002, -50.00000000000044, -50.00000000000044, 24.499999999999908, 43.900000000000006, 35.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 46.5, 44.10000000000001, 39.50000000000002, 43.7, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 25.29999999999992, 13.499999999999751, 27.899999999999956, -50.00000000000044, 47.5, 38.10000000000002, 19.69999999999984, -50.00000000000044, -50.00000000000044, 17.69999999999981, -50.00000000000044, -50.00000000000044, 35.30000000000004, 44.900000000000006, 44.5, 3.499999999999609, 46.5, 24.69999999999991, -50.00000000000044, -50.00000000000044, 36.70000000000003, 43.900000000000006, 10.499999999999709, -50.00000000000044, 27.699999999999953, 32.100000000000016, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.50000000000003, 42.900000000000006, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 41.90000000000001, 28.699999999999967, 34.50000000000004, -50.00000000000044, 41.30000000000001, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 41.100000000000016, -50.00000000000044, -50.00000000000044, 38.50000000000003, 39.70000000000002, 41.30000000000001, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 43.50000000000001, 40.90000000000002, -50.00000000000044, -50.00000000000044, 41.30000000000001, 45.3, 42.500000000000014, 37.90000000000003, 44.5, 0.6999999999995694, 8.49999999999968, 0.49999999999956657, 47.5], "episode_lengths": [30, 76, 114, 500, 500, 178, 114, 102, 500, 500, 256, 62, 146, 500, 500, 500, 88, 36, 60, 106, 64, 500, 52, 500, 500, 500, 44, 248, 366, 222, 500, 26, 120, 304, 500, 500, 324, 500, 500, 148, 52, 56, 466, 36, 254, 500, 500, 134, 62, 396, 500, 224, 180, 68, 500, 500, 500, 126, 72, 500, 32, 500, 500, 70, 500, 82, 214, 156, 500, 88, 104, 500, 500, 500, 32, 90, 500, 500, 116, 104, 88, 60, 500, 500, 500, 36, 500, 66, 92, 500, 500, 88, 48, 76, 122, 56, 494, 416, 496, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40632216869843957, "mean_inference_ms": 1.2964416843669542, "mean_action_processing_ms": 0.15131442726349137, "mean_env_wait_ms": 0.0905642330209197, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021007299423217773, "StateBufferConnector_ms": 0.005001068115234375, "ViewRequirementAgentConnector_ms": 0.1420130729675293}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.39799999999981, "episode_len_mean": 276.64, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [47.1, 42.500000000000014, 38.700000000000024, -50.00000000000044, -50.00000000000044, 32.30000000000002, 38.700000000000024, 39.90000000000002, -50.00000000000044, -50.00000000000044, 24.499999999999908, 43.900000000000006, 35.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 46.5, 44.10000000000001, 39.50000000000002, 43.7, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 25.29999999999992, 13.499999999999751, 27.899999999999956, -50.00000000000044, 47.5, 38.10000000000002, 19.69999999999984, -50.00000000000044, -50.00000000000044, 17.69999999999981, -50.00000000000044, -50.00000000000044, 35.30000000000004, 44.900000000000006, 44.5, 3.499999999999609, 46.5, 24.69999999999991, -50.00000000000044, -50.00000000000044, 36.70000000000003, 43.900000000000006, 10.499999999999709, -50.00000000000044, 27.699999999999953, 32.100000000000016, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.50000000000003, 42.900000000000006, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 41.90000000000001, 28.699999999999967, 34.50000000000004, -50.00000000000044, 41.30000000000001, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 41.100000000000016, -50.00000000000044, -50.00000000000044, 38.50000000000003, 39.70000000000002, 41.30000000000001, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 43.50000000000001, 40.90000000000002, -50.00000000000044, -50.00000000000044, 41.30000000000001, 45.3, 42.500000000000014, 37.90000000000003, 44.5, 0.6999999999995694, 8.49999999999968, 0.49999999999956657, 47.5], "episode_lengths": [30, 76, 114, 500, 500, 178, 114, 102, 500, 500, 256, 62, 146, 500, 500, 500, 88, 36, 60, 106, 64, 500, 52, 500, 500, 500, 44, 248, 366, 222, 500, 26, 120, 304, 500, 500, 324, 500, 500, 148, 52, 56, 466, 36, 254, 500, 500, 134, 62, 396, 500, 224, 180, 68, 500, 500, 500, 126, 72, 500, 32, 500, 500, 70, 500, 82, 214, 156, 500, 88, 104, 500, 500, 500, 32, 90, 500, 500, 116, 104, 88, 60, 500, 500, 500, 36, 500, 66, 92, 500, 500, 88, 48, 76, 122, 56, 494, 416, 496, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40632216869843957, "mean_inference_ms": 1.2964416843669542, "mean_action_processing_ms": 0.15131442726349137, "mean_env_wait_ms": 0.0905642330209197, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021007299423217773, "StateBufferConnector_ms": 0.005001068115234375, "ViewRequirementAgentConnector_ms": 0.1420130729675293}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1134000, "num_agent_steps_trained": 1134000, "num_env_steps_sampled": 1134000, "num_env_steps_trained": 1134000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5081.872173240159, "num_env_steps_trained_throughput_per_sec": 5081.872173240159, "timesteps_total": 1134000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1134000, "timers": {"training_iteration_time_ms": 3275.624, "sample_time_ms": 2900.219, "load_time_ms": 18.005, "load_throughput": 999716.256, "learn_time_ms": 346.015, "learn_throughput": 52020.913, "synch_weights_time_ms": 9.185}, "counters": {"num_env_steps_sampled": 1134000, "num_env_steps_trained": 1134000, "num_agent_steps_sampled": 1134000, "num_agent_steps_trained": 1134000}, "done": false, "episodes_total": 4438, "training_iteration": 63, "trial_id": "9f288_00020", "date": "2023-10-25_17-15-27", "timestamp": 1698250527, "time_this_iter_s": 3.5490012168884277, "time_total_s": 217.5421588420868, "pid": 9936, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 217.5421588420868, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 65.72, "ram_util_percent": 27.02}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.1684043449710093e-20, "cur_lr": 0.0003, "total_loss": 6.9404242656849044, "policy_loss": -7.41162371856195e-05, "vf_loss": 6.940551475242332, "vf_explained_var": -8.079740736219618e-07, "kl": 0.00047288045728750887, "entropy": 0.5301219037285557, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1715.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 1152000, "num_env_steps_trained": 1152000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.980999999999844, "episode_len_mean": 245.86, "episode_media": {}, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 38.50000000000003, 39.70000000000002, 41.30000000000001, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 43.50000000000001, 40.90000000000002, -50.00000000000044, -50.00000000000044, 41.30000000000001, 45.3, 42.500000000000014, 37.90000000000003, 44.5, 0.6999999999995694, 8.49999999999968, 0.49999999999956657, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.299999999999947, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 40.10000000000002, 29.49999999999998, -50.00000000000044, 38.700000000000024, 36.30000000000003, 36.30000000000003, 45.5, -50.00000000000044, -50.00000000000044, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 45.3, 41.100000000000016, -50.00000000000044, 24.499999999999908, 45.3, 34.30000000000004, 38.700000000000024, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 30.699999999999996, 35.70000000000003, 44.5, 17.499999999999808, 46.699999999999996, 30.29999999999999, 28.29999999999996, 46.5, 45.1, 19.299999999999834, 44.10000000000001, -50.00000000000044, -50.00000000000044, 36.10000000000004, 28.09999999999996, 31.500000000000007, 42.500000000000014, 33.70000000000004, 46.3, 36.900000000000034, 42.500000000000014, 47.5, -50.00000000000044, -50.00000000000044, 45.1, 45.1, 42.70000000000001, 43.10000000000001, 41.70000000000002, 40.10000000000002, 46.5, 42.900000000000006, 42.30000000000001, -50.00000000000044, 46.5, 38.50000000000003, -50.00000000000044, -50.00000000000044, 42.500000000000014, 35.30000000000004, 45.7, -50.00000000000044], "episode_lengths": [500, 500, 116, 104, 88, 60, 500, 500, 500, 36, 500, 66, 92, 500, 500, 88, 48, 76, 122, 56, 494, 416, 496, 26, 500, 500, 500, 228, 500, 500, 52, 500, 100, 206, 500, 114, 138, 138, 46, 500, 500, 110, 500, 500, 500, 58, 500, 48, 90, 500, 256, 48, 158, 114, 500, 500, 82, 500, 194, 144, 56, 326, 34, 198, 218, 36, 50, 308, 60, 500, 500, 140, 220, 186, 76, 164, 38, 132, 76, 26, 500, 500, 50, 50, 74, 70, 84, 100, 36, 72, 78, 500, 36, 116, 500, 500, 76, 148, 44, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40646108067426995, "mean_inference_ms": 1.2971364160337138, "mean_action_processing_ms": 0.15090063768756934, "mean_env_wait_ms": 0.09063793383616957, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029000043869018555, "StateBufferConnector_ms": 0.004001140594482422, "ViewRequirementAgentConnector_ms": 0.12700867652893066}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.980999999999844, "episode_len_mean": 245.86, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 38.50000000000003, 39.70000000000002, 41.30000000000001, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 43.50000000000001, 40.90000000000002, -50.00000000000044, -50.00000000000044, 41.30000000000001, 45.3, 42.500000000000014, 37.90000000000003, 44.5, 0.6999999999995694, 8.49999999999968, 0.49999999999956657, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.299999999999947, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 40.10000000000002, 29.49999999999998, -50.00000000000044, 38.700000000000024, 36.30000000000003, 36.30000000000003, 45.5, -50.00000000000044, -50.00000000000044, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 45.3, 41.100000000000016, -50.00000000000044, 24.499999999999908, 45.3, 34.30000000000004, 38.700000000000024, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 30.699999999999996, 35.70000000000003, 44.5, 17.499999999999808, 46.699999999999996, 30.29999999999999, 28.29999999999996, 46.5, 45.1, 19.299999999999834, 44.10000000000001, -50.00000000000044, -50.00000000000044, 36.10000000000004, 28.09999999999996, 31.500000000000007, 42.500000000000014, 33.70000000000004, 46.3, 36.900000000000034, 42.500000000000014, 47.5, -50.00000000000044, -50.00000000000044, 45.1, 45.1, 42.70000000000001, 43.10000000000001, 41.70000000000002, 40.10000000000002, 46.5, 42.900000000000006, 42.30000000000001, -50.00000000000044, 46.5, 38.50000000000003, -50.00000000000044, -50.00000000000044, 42.500000000000014, 35.30000000000004, 45.7, -50.00000000000044], "episode_lengths": [500, 500, 116, 104, 88, 60, 500, 500, 500, 36, 500, 66, 92, 500, 500, 88, 48, 76, 122, 56, 494, 416, 496, 26, 500, 500, 500, 228, 500, 500, 52, 500, 100, 206, 500, 114, 138, 138, 46, 500, 500, 110, 500, 500, 500, 58, 500, 48, 90, 500, 256, 48, 158, 114, 500, 500, 82, 500, 194, 144, 56, 326, 34, 198, 218, 36, 50, 308, 60, 500, 500, 140, 220, 186, 76, 164, 38, 132, 76, 26, 500, 500, 50, 50, 74, 70, 84, 100, 36, 72, 78, 500, 36, 116, 500, 500, 76, 148, 44, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40646108067426995, "mean_inference_ms": 1.2971364160337138, "mean_action_processing_ms": 0.15090063768756934, "mean_env_wait_ms": 0.09063793383616957, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029000043869018555, "StateBufferConnector_ms": 0.004001140594482422, "ViewRequirementAgentConnector_ms": 0.12700867652893066}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000, "num_env_steps_sampled": 1152000, "num_env_steps_trained": 1152000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4995.522538567387, "num_env_steps_trained_throughput_per_sec": 4995.522538567387, "timesteps_total": 1152000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1152000, "timers": {"training_iteration_time_ms": 3327.347, "sample_time_ms": 2923.176, "load_time_ms": 19.308, "load_throughput": 932239.042, "learn_time_ms": 373.38, "learn_throughput": 48208.313, "synch_weights_time_ms": 9.282}, "counters": {"num_env_steps_sampled": 1152000, "num_env_steps_trained": 1152000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "done": false, "episodes_total": 4514, "training_iteration": 64, "trial_id": "9f288_00020", "date": "2023-10-25_17-15-31", "timestamp": 1698250531, "time_this_iter_s": 3.6092209815979004, "time_total_s": 221.1513798236847, "pid": 9936, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 221.1513798236847, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 64.0, "ram_util_percent": 27.119999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.0842021724855046e-20, "cur_lr": 0.0003, "total_loss": 6.85602401804041, "policy_loss": -0.0002547427322025652, "vf_loss": 6.856336346379033, "vf_explained_var": -1.099374559190538e-06, "kl": 0.00032993292105882373, "entropy": 0.5765008418648331, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1742.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 1170000, "num_env_steps_trained": 1170000, "num_agent_steps_sampled": 1170000, "num_agent_steps_trained": 1170000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.66799999999986, "episode_len_mean": 224.0, "episode_media": {}, "episodes_this_iter": 80, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 45.1, 45.1, 42.70000000000001, 43.10000000000001, 41.70000000000002, 40.10000000000002, 46.5, 42.900000000000006, 42.30000000000001, -50.00000000000044, 46.5, 38.50000000000003, -50.00000000000044, -50.00000000000044, 42.500000000000014, 35.30000000000004, 45.7, -50.00000000000044, 36.30000000000003, 36.900000000000034, 43.10000000000001, 40.10000000000002, 42.30000000000001, 37.70000000000003, -50.00000000000044, 47.5, 37.90000000000003, -50.00000000000044, 44.10000000000001, -50.00000000000044, 45.3, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 44.7, 44.7, 44.10000000000001, 30.9, 45.1, 5.899999999999643, -50.00000000000044, 43.50000000000001, -50.00000000000044, 44.300000000000004, 38.50000000000003, 39.50000000000002, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 41.500000000000014, 35.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 43.50000000000001, 40.500000000000014, 43.7, 35.900000000000034, -50.00000000000044, 15.699999999999783, 39.10000000000002, 42.500000000000014, 42.900000000000006, -50.00000000000044, 35.30000000000004, 33.30000000000003, -50.00000000000044, 35.900000000000034, 43.900000000000006, 39.10000000000002, 44.5, 42.900000000000006, 43.7, 32.100000000000016, -50.00000000000044, 45.1, 37.90000000000003, -50.00000000000044, 46.099999999999994, 37.300000000000026, 43.7, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 42.900000000000006, -50.00000000000044, 42.30000000000001, -50.00000000000044, 45.5, 43.50000000000001, 45.3, -50.00000000000044, 37.10000000000003], "episode_lengths": [500, 500, 50, 50, 74, 70, 84, 100, 36, 72, 78, 500, 36, 116, 500, 500, 76, 148, 44, 500, 138, 132, 70, 100, 78, 124, 500, 26, 122, 500, 60, 500, 48, 500, 42, 500, 500, 54, 54, 60, 192, 50, 442, 500, 66, 500, 58, 116, 106, 500, 500, 48, 500, 500, 86, 146, 500, 500, 500, 80, 66, 96, 64, 142, 500, 344, 110, 76, 72, 500, 148, 168, 500, 142, 62, 110, 56, 72, 64, 180, 500, 50, 122, 500, 40, 128, 64, 500, 500, 52, 500, 72, 500, 78, 500, 46, 66, 48, 500, 130]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40561023943670266, "mean_inference_ms": 1.2954157193960072, "mean_action_processing_ms": 0.1508166892303948, "mean_env_wait_ms": 0.09031138407808559, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02199101448059082, "StateBufferConnector_ms": 0.002998828887939453, "ViewRequirementAgentConnector_ms": 0.12595152854919434}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.66799999999986, "episode_len_mean": 224.0, "episodes_this_iter": 80, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 45.1, 45.1, 42.70000000000001, 43.10000000000001, 41.70000000000002, 40.10000000000002, 46.5, 42.900000000000006, 42.30000000000001, -50.00000000000044, 46.5, 38.50000000000003, -50.00000000000044, -50.00000000000044, 42.500000000000014, 35.30000000000004, 45.7, -50.00000000000044, 36.30000000000003, 36.900000000000034, 43.10000000000001, 40.10000000000002, 42.30000000000001, 37.70000000000003, -50.00000000000044, 47.5, 37.90000000000003, -50.00000000000044, 44.10000000000001, -50.00000000000044, 45.3, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 44.7, 44.7, 44.10000000000001, 30.9, 45.1, 5.899999999999643, -50.00000000000044, 43.50000000000001, -50.00000000000044, 44.300000000000004, 38.50000000000003, 39.50000000000002, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 41.500000000000014, 35.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 43.50000000000001, 40.500000000000014, 43.7, 35.900000000000034, -50.00000000000044, 15.699999999999783, 39.10000000000002, 42.500000000000014, 42.900000000000006, -50.00000000000044, 35.30000000000004, 33.30000000000003, -50.00000000000044, 35.900000000000034, 43.900000000000006, 39.10000000000002, 44.5, 42.900000000000006, 43.7, 32.100000000000016, -50.00000000000044, 45.1, 37.90000000000003, -50.00000000000044, 46.099999999999994, 37.300000000000026, 43.7, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 42.900000000000006, -50.00000000000044, 42.30000000000001, -50.00000000000044, 45.5, 43.50000000000001, 45.3, -50.00000000000044, 37.10000000000003], "episode_lengths": [500, 500, 50, 50, 74, 70, 84, 100, 36, 72, 78, 500, 36, 116, 500, 500, 76, 148, 44, 500, 138, 132, 70, 100, 78, 124, 500, 26, 122, 500, 60, 500, 48, 500, 42, 500, 500, 54, 54, 60, 192, 50, 442, 500, 66, 500, 58, 116, 106, 500, 500, 48, 500, 500, 86, 146, 500, 500, 500, 80, 66, 96, 64, 142, 500, 344, 110, 76, 72, 500, 148, 168, 500, 142, 62, 110, 56, 72, 64, 180, 500, 50, 122, 500, 40, 128, 64, 500, 500, 52, 500, 72, 500, 78, 500, 46, 66, 48, 500, 130]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40561023943670266, "mean_inference_ms": 1.2954157193960072, "mean_action_processing_ms": 0.1508166892303948, "mean_env_wait_ms": 0.09031138407808559, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02199101448059082, "StateBufferConnector_ms": 0.002998828887939453, "ViewRequirementAgentConnector_ms": 0.12595152854919434}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1170000, "num_agent_steps_trained": 1170000, "num_env_steps_sampled": 1170000, "num_env_steps_trained": 1170000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5591.841178689972, "num_env_steps_trained_throughput_per_sec": 5591.841178689972, "timesteps_total": 1170000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1170000, "timers": {"training_iteration_time_ms": 3324.145, "sample_time_ms": 2926.273, "load_time_ms": 17.908, "load_throughput": 1005111.891, "learn_time_ms": 368.58, "learn_throughput": 48836.129, "synch_weights_time_ms": 9.182}, "counters": {"num_env_steps_sampled": 1170000, "num_env_steps_trained": 1170000, "num_agent_steps_sampled": 1170000, "num_agent_steps_trained": 1170000}, "done": false, "episodes_total": 4594, "training_iteration": 65, "trial_id": "9f288_00020", "date": "2023-10-25_17-15-34", "timestamp": 1698250534, "time_this_iter_s": 3.2249717712402344, "time_total_s": 224.37635159492493, "pid": 9936, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 224.37635159492493, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 67.725, "ram_util_percent": 27.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.421010862427523e-21, "cur_lr": 0.0003, "total_loss": 6.8232528368632, "policy_loss": -0.00020018342399486788, "vf_loss": 6.823504871792263, "vf_explained_var": -9.845804285120081e-07, "kl": 0.0009308279485388219, "entropy": 0.5182686966878397, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1769.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 1188000, "num_env_steps_trained": 1188000, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.542999999999843, "episode_len_mean": 240.24, "episode_media": {}, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.900000000000006, 39.10000000000002, 44.5, 42.900000000000006, 43.7, 32.100000000000016, -50.00000000000044, 45.1, 37.90000000000003, -50.00000000000044, 46.099999999999994, 37.300000000000026, 43.7, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 42.900000000000006, -50.00000000000044, 42.30000000000001, -50.00000000000044, 45.5, 43.50000000000001, 45.3, -50.00000000000044, 37.10000000000003, 17.499999999999808, 45.3, -50.00000000000044, -50.00000000000044, 46.5, 21.09999999999986, -50.00000000000044, 44.10000000000001, -50.00000000000044, 34.10000000000004, 44.900000000000006, 17.099999999999802, 46.3, 41.30000000000001, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 30.099999999999987, 10.299999999999706, 44.5, -50.00000000000044, 39.90000000000002, 42.500000000000014, 46.3, 41.90000000000001, 45.5, 42.70000000000001, -50.00000000000044, -50.00000000000044, 42.10000000000001, 19.499999999999837, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 44.900000000000006, 35.500000000000036, 29.899999999999984, 35.30000000000004, 36.900000000000034, -50.00000000000044, 16.499999999999794, 34.70000000000004, 41.90000000000001, -50.00000000000044, 38.10000000000002, 24.499999999999908, 39.10000000000002, 41.500000000000014, 42.30000000000001, 45.3, -50.00000000000044, -50.00000000000044, 45.5, 5.299999999999635, 45.3, 37.70000000000003, -50.00000000000044, 41.70000000000002, 41.30000000000001, 46.3, 47.5, -50.00000000000044, 46.099999999999994], "episode_lengths": [62, 110, 56, 72, 64, 180, 500, 50, 122, 500, 40, 128, 64, 500, 500, 52, 500, 72, 500, 78, 500, 46, 66, 48, 500, 130, 326, 48, 500, 500, 36, 290, 500, 60, 500, 160, 52, 330, 38, 88, 500, 500, 76, 500, 500, 200, 398, 56, 500, 102, 76, 38, 82, 46, 74, 500, 500, 80, 306, 500, 94, 500, 500, 44, 500, 500, 36, 500, 56, 500, 500, 52, 146, 202, 148, 132, 500, 336, 154, 82, 500, 120, 256, 110, 86, 78, 48, 500, 500, 46, 448, 48, 124, 500, 84, 88, 38, 26, 500, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40631467216353706, "mean_inference_ms": 1.2959738233353773, "mean_action_processing_ms": 0.1512432658465676, "mean_env_wait_ms": 0.09036019705816825, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022994279861450195, "StateBufferConnector_ms": 0.0049991607666015625, "ViewRequirementAgentConnector_ms": 0.10164594650268555}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.542999999999843, "episode_len_mean": 240.24, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.900000000000006, 39.10000000000002, 44.5, 42.900000000000006, 43.7, 32.100000000000016, -50.00000000000044, 45.1, 37.90000000000003, -50.00000000000044, 46.099999999999994, 37.300000000000026, 43.7, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 42.900000000000006, -50.00000000000044, 42.30000000000001, -50.00000000000044, 45.5, 43.50000000000001, 45.3, -50.00000000000044, 37.10000000000003, 17.499999999999808, 45.3, -50.00000000000044, -50.00000000000044, 46.5, 21.09999999999986, -50.00000000000044, 44.10000000000001, -50.00000000000044, 34.10000000000004, 44.900000000000006, 17.099999999999802, 46.3, 41.30000000000001, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 30.099999999999987, 10.299999999999706, 44.5, -50.00000000000044, 39.90000000000002, 42.500000000000014, 46.3, 41.90000000000001, 45.5, 42.70000000000001, -50.00000000000044, -50.00000000000044, 42.10000000000001, 19.499999999999837, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 44.900000000000006, 35.500000000000036, 29.899999999999984, 35.30000000000004, 36.900000000000034, -50.00000000000044, 16.499999999999794, 34.70000000000004, 41.90000000000001, -50.00000000000044, 38.10000000000002, 24.499999999999908, 39.10000000000002, 41.500000000000014, 42.30000000000001, 45.3, -50.00000000000044, -50.00000000000044, 45.5, 5.299999999999635, 45.3, 37.70000000000003, -50.00000000000044, 41.70000000000002, 41.30000000000001, 46.3, 47.5, -50.00000000000044, 46.099999999999994], "episode_lengths": [62, 110, 56, 72, 64, 180, 500, 50, 122, 500, 40, 128, 64, 500, 500, 52, 500, 72, 500, 78, 500, 46, 66, 48, 500, 130, 326, 48, 500, 500, 36, 290, 500, 60, 500, 160, 52, 330, 38, 88, 500, 500, 76, 500, 500, 200, 398, 56, 500, 102, 76, 38, 82, 46, 74, 500, 500, 80, 306, 500, 94, 500, 500, 44, 500, 500, 36, 500, 56, 500, 500, 52, 146, 202, 148, 132, 500, 336, 154, 82, 500, 120, 256, 110, 86, 78, 48, 500, 500, 46, 448, 48, 124, 500, 84, 88, 38, 26, 500, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40631467216353706, "mean_inference_ms": 1.2959738233353773, "mean_action_processing_ms": 0.1512432658465676, "mean_env_wait_ms": 0.09036019705816825, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022994279861450195, "StateBufferConnector_ms": 0.0049991607666015625, "ViewRequirementAgentConnector_ms": 0.10164594650268555}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000, "num_env_steps_sampled": 1188000, "num_env_steps_trained": 1188000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5449.581097246014, "num_env_steps_trained_throughput_per_sec": 5449.581097246014, "timesteps_total": 1188000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1188000, "timers": {"training_iteration_time_ms": 3313.396, "sample_time_ms": 2926.372, "load_time_ms": 18.209, "load_throughput": 988529.686, "learn_time_ms": 357.331, "learn_throughput": 50373.498, "synch_weights_time_ms": 9.182}, "counters": {"num_env_steps_sampled": 1188000, "num_env_steps_trained": 1188000, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000}, "done": false, "episodes_total": 4668, "training_iteration": 66, "trial_id": "9f288_00020", "date": "2023-10-25_17-15-38", "timestamp": 1698250538, "time_this_iter_s": 3.307999610900879, "time_total_s": 227.6843512058258, "pid": 9936, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 227.6843512058258, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 59.260000000000005, "ram_util_percent": 27.080000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.7105054312137616e-21, "cur_lr": 0.0003, "total_loss": 6.827571339077419, "policy_loss": -5.9857171166826176e-05, "vf_loss": 6.82768115290889, "vf_explained_var": -1.0684684470847802e-06, "kl": 0.0004210685963033501, "entropy": 0.5002446461606909, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1796.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 1206000, "num_env_steps_trained": 1206000, "num_agent_steps_sampled": 1206000, "num_agent_steps_trained": 1206000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 15.39299999999987, "episode_len_mean": 211.8, "episode_media": {}, "episodes_this_iter": 78, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [34.70000000000004, 41.90000000000001, -50.00000000000044, 38.10000000000002, 24.499999999999908, 39.10000000000002, 41.500000000000014, 42.30000000000001, 45.3, -50.00000000000044, -50.00000000000044, 45.5, 5.299999999999635, 45.3, 37.70000000000003, -50.00000000000044, 41.70000000000002, 41.30000000000001, 46.3, 47.5, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 40.90000000000002, 46.3, 20.699999999999854, -50.00000000000044, 43.10000000000001, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, 41.500000000000014, 45.9, 36.70000000000003, 41.30000000000001, 42.10000000000001, 24.299999999999905, 28.29999999999996, 26.89999999999994, 41.70000000000002, 45.7, 47.5, 40.30000000000002, -50.00000000000044, 44.300000000000004, -50.00000000000044, 43.30000000000001, 44.10000000000001, 46.5, -50.00000000000044, 45.7, -50.00000000000044, 40.90000000000002, -50.00000000000044, 41.90000000000001, 45.1, -50.00000000000044, 46.9, -50.00000000000044, 47.5, 41.500000000000014, 43.50000000000001, 45.7, 39.300000000000026, 24.69999999999991, 22.899999999999885, 24.899999999999913, 44.5, 42.900000000000006, 42.30000000000001, 40.70000000000002, 41.30000000000001, 43.10000000000001, 34.70000000000004, -50.00000000000044, -50.00000000000044, 45.3, 35.70000000000003, -50.00000000000044, 43.30000000000001, 45.7, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.9, 46.699999999999996, 42.500000000000014, 3.2999999999996064, 41.90000000000001, -50.00000000000044, 45.1, -50.00000000000044, 31.900000000000013, 30.499999999999993, -50.00000000000044, 44.7, 42.500000000000014], "episode_lengths": [154, 82, 500, 120, 256, 110, 86, 78, 48, 500, 500, 46, 448, 48, 124, 500, 84, 88, 38, 26, 500, 40, 500, 500, 92, 38, 294, 500, 70, 500, 98, 500, 500, 86, 42, 134, 88, 80, 258, 218, 232, 84, 44, 26, 98, 500, 58, 500, 68, 60, 36, 500, 44, 500, 92, 500, 82, 50, 500, 32, 500, 26, 86, 66, 44, 108, 254, 272, 252, 56, 72, 78, 94, 88, 70, 154, 500, 500, 48, 144, 500, 68, 44, 36, 500, 500, 500, 22, 34, 76, 468, 82, 500, 50, 500, 182, 196, 500, 54, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4052542756862538, "mean_inference_ms": 1.2937109262500661, "mean_action_processing_ms": 0.1503679709457684, "mean_env_wait_ms": 0.09019235653317083, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027991533279418945, "StateBufferConnector_ms": 0.0060002803802490234, "ViewRequirementAgentConnector_ms": 0.1269702911376953}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 15.39299999999987, "episode_len_mean": 211.8, "episodes_this_iter": 78, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [34.70000000000004, 41.90000000000001, -50.00000000000044, 38.10000000000002, 24.499999999999908, 39.10000000000002, 41.500000000000014, 42.30000000000001, 45.3, -50.00000000000044, -50.00000000000044, 45.5, 5.299999999999635, 45.3, 37.70000000000003, -50.00000000000044, 41.70000000000002, 41.30000000000001, 46.3, 47.5, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 40.90000000000002, 46.3, 20.699999999999854, -50.00000000000044, 43.10000000000001, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, 41.500000000000014, 45.9, 36.70000000000003, 41.30000000000001, 42.10000000000001, 24.299999999999905, 28.29999999999996, 26.89999999999994, 41.70000000000002, 45.7, 47.5, 40.30000000000002, -50.00000000000044, 44.300000000000004, -50.00000000000044, 43.30000000000001, 44.10000000000001, 46.5, -50.00000000000044, 45.7, -50.00000000000044, 40.90000000000002, -50.00000000000044, 41.90000000000001, 45.1, -50.00000000000044, 46.9, -50.00000000000044, 47.5, 41.500000000000014, 43.50000000000001, 45.7, 39.300000000000026, 24.69999999999991, 22.899999999999885, 24.899999999999913, 44.5, 42.900000000000006, 42.30000000000001, 40.70000000000002, 41.30000000000001, 43.10000000000001, 34.70000000000004, -50.00000000000044, -50.00000000000044, 45.3, 35.70000000000003, -50.00000000000044, 43.30000000000001, 45.7, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.9, 46.699999999999996, 42.500000000000014, 3.2999999999996064, 41.90000000000001, -50.00000000000044, 45.1, -50.00000000000044, 31.900000000000013, 30.499999999999993, -50.00000000000044, 44.7, 42.500000000000014], "episode_lengths": [154, 82, 500, 120, 256, 110, 86, 78, 48, 500, 500, 46, 448, 48, 124, 500, 84, 88, 38, 26, 500, 40, 500, 500, 92, 38, 294, 500, 70, 500, 98, 500, 500, 86, 42, 134, 88, 80, 258, 218, 232, 84, 44, 26, 98, 500, 58, 500, 68, 60, 36, 500, 44, 500, 92, 500, 82, 50, 500, 32, 500, 26, 86, 66, 44, 108, 254, 272, 252, 56, 72, 78, 94, 88, 70, 154, 500, 500, 48, 144, 500, 68, 44, 36, 500, 500, 500, 22, 34, 76, 468, 82, 500, 50, 500, 182, 196, 500, 54, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4052542756862538, "mean_inference_ms": 1.2937109262500661, "mean_action_processing_ms": 0.1503679709457684, "mean_env_wait_ms": 0.09019235653317083, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027991533279418945, "StateBufferConnector_ms": 0.0060002803802490234, "ViewRequirementAgentConnector_ms": 0.1269702911376953}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1206000, "num_agent_steps_trained": 1206000, "num_env_steps_sampled": 1206000, "num_env_steps_trained": 1206000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5626.81602251875, "num_env_steps_trained_throughput_per_sec": 5626.81602251875, "timesteps_total": 1206000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1206000, "timers": {"training_iteration_time_ms": 3307.895, "sample_time_ms": 2927.672, "load_time_ms": 17.306, "load_throughput": 1040107.789, "learn_time_ms": 351.33, "learn_throughput": 51233.824, "synch_weights_time_ms": 9.285}, "counters": {"num_env_steps_sampled": 1206000, "num_env_steps_trained": 1206000, "num_agent_steps_sampled": 1206000, "num_agent_steps_trained": 1206000}, "done": false, "episodes_total": 4746, "training_iteration": 67, "trial_id": "9f288_00020", "date": "2023-10-25_17-15-41", "timestamp": 1698250541, "time_this_iter_s": 3.204965829849243, "time_total_s": 230.88931703567505, "pid": 9936, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 230.88931703567505, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 63.875, "ram_util_percent": 27.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.3552527156068808e-21, "cur_lr": 0.0003, "total_loss": 6.45158033017759, "policy_loss": -0.0004225142852023796, "vf_loss": 6.452052240018491, "vf_explained_var": -8.168043913664641e-07, "kl": 0.0008523803129955249, "entropy": 0.4940157885904665, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1823.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 1224000, "num_env_steps_trained": 1224000, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.9579999999998075, "episode_len_mean": 271.02, "episode_media": {}, "episodes_this_iter": 59, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.9, -50.00000000000044, 47.5, 41.500000000000014, 43.50000000000001, 45.7, 39.300000000000026, 24.69999999999991, 22.899999999999885, 24.899999999999913, 44.5, 42.900000000000006, 42.30000000000001, 40.70000000000002, 41.30000000000001, 43.10000000000001, 34.70000000000004, -50.00000000000044, -50.00000000000044, 45.3, 35.70000000000003, -50.00000000000044, 43.30000000000001, 45.7, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.9, 46.699999999999996, 42.500000000000014, 3.2999999999996064, 41.90000000000001, -50.00000000000044, 45.1, -50.00000000000044, 31.900000000000013, 30.499999999999993, -50.00000000000044, 44.7, 42.500000000000014, -50.00000000000044, -50.00000000000044, 40.90000000000002, 46.099999999999994, -50.00000000000044, 42.500000000000014, 10.299999999999706, 43.50000000000001, -50.00000000000044, -50.00000000000044, 45.7, 5.299999999999635, -50.00000000000044, 17.299999999999805, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.299999999999834, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 45.1, -50.00000000000044, -50.00000000000044, 41.100000000000016, 37.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 43.30000000000001, 44.300000000000004, 24.499999999999908, -50.00000000000044, 36.900000000000034, 46.099999999999994, 43.10000000000001, 30.099999999999987, -50.00000000000044, 41.70000000000002, 39.300000000000026, -50.00000000000044, 43.7, 24.69999999999991], "episode_lengths": [32, 500, 26, 86, 66, 44, 108, 254, 272, 252, 56, 72, 78, 94, 88, 70, 154, 500, 500, 48, 144, 500, 68, 44, 36, 500, 500, 500, 22, 34, 76, 468, 82, 500, 50, 500, 182, 196, 500, 54, 76, 500, 500, 92, 40, 500, 76, 398, 66, 500, 500, 44, 448, 500, 328, 500, 94, 500, 500, 500, 500, 308, 500, 500, 500, 500, 76, 500, 30, 500, 500, 500, 42, 50, 500, 500, 90, 128, 500, 500, 500, 92, 500, 34, 500, 500, 68, 58, 256, 500, 132, 40, 70, 200, 500, 84, 108, 500, 64, 254]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4048453941791983, "mean_inference_ms": 1.2941845295724652, "mean_action_processing_ms": 0.15058232443213235, "mean_env_wait_ms": 0.09032030292398517, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02799510955810547, "StateBufferConnector_ms": 0.0060024261474609375, "ViewRequirementAgentConnector_ms": 0.12499499320983887}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.9579999999998075, "episode_len_mean": 271.02, "episodes_this_iter": 59, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.9, -50.00000000000044, 47.5, 41.500000000000014, 43.50000000000001, 45.7, 39.300000000000026, 24.69999999999991, 22.899999999999885, 24.899999999999913, 44.5, 42.900000000000006, 42.30000000000001, 40.70000000000002, 41.30000000000001, 43.10000000000001, 34.70000000000004, -50.00000000000044, -50.00000000000044, 45.3, 35.70000000000003, -50.00000000000044, 43.30000000000001, 45.7, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.9, 46.699999999999996, 42.500000000000014, 3.2999999999996064, 41.90000000000001, -50.00000000000044, 45.1, -50.00000000000044, 31.900000000000013, 30.499999999999993, -50.00000000000044, 44.7, 42.500000000000014, -50.00000000000044, -50.00000000000044, 40.90000000000002, 46.099999999999994, -50.00000000000044, 42.500000000000014, 10.299999999999706, 43.50000000000001, -50.00000000000044, -50.00000000000044, 45.7, 5.299999999999635, -50.00000000000044, 17.299999999999805, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.299999999999834, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 45.1, -50.00000000000044, -50.00000000000044, 41.100000000000016, 37.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 43.30000000000001, 44.300000000000004, 24.499999999999908, -50.00000000000044, 36.900000000000034, 46.099999999999994, 43.10000000000001, 30.099999999999987, -50.00000000000044, 41.70000000000002, 39.300000000000026, -50.00000000000044, 43.7, 24.69999999999991], "episode_lengths": [32, 500, 26, 86, 66, 44, 108, 254, 272, 252, 56, 72, 78, 94, 88, 70, 154, 500, 500, 48, 144, 500, 68, 44, 36, 500, 500, 500, 22, 34, 76, 468, 82, 500, 50, 500, 182, 196, 500, 54, 76, 500, 500, 92, 40, 500, 76, 398, 66, 500, 500, 44, 448, 500, 328, 500, 94, 500, 500, 500, 500, 308, 500, 500, 500, 500, 76, 500, 30, 500, 500, 500, 42, 50, 500, 500, 90, 128, 500, 500, 500, 92, 500, 34, 500, 500, 68, 58, 256, 500, 132, 40, 70, 200, 500, 84, 108, 500, 64, 254]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4048453941791983, "mean_inference_ms": 1.2941845295724652, "mean_action_processing_ms": 0.15058232443213235, "mean_env_wait_ms": 0.09032030292398517, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02799510955810547, "StateBufferConnector_ms": 0.0060024261474609375, "ViewRequirementAgentConnector_ms": 0.12499499320983887}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000, "num_env_steps_sampled": 1224000, "num_env_steps_trained": 1224000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5080.782229776279, "num_env_steps_trained_throughput_per_sec": 5080.782229776279, "timesteps_total": 1224000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1224000, "timers": {"training_iteration_time_ms": 3343.317, "sample_time_ms": 2947.136, "load_time_ms": 17.806, "load_throughput": 1010900.307, "learn_time_ms": 366.586, "learn_throughput": 49101.706, "synch_weights_time_ms": 9.388}, "counters": {"num_env_steps_sampled": 1224000, "num_env_steps_trained": 1224000, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000}, "done": false, "episodes_total": 4805, "training_iteration": 68, "trial_id": "9f288_00020", "date": "2023-10-25_17-15-44", "timestamp": 1698250544, "time_this_iter_s": 3.5477612018585205, "time_total_s": 234.43707823753357, "pid": 9936, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 234.43707823753357, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 64.4, "ram_util_percent": 27.060000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.776263578034404e-22, "cur_lr": 0.0003, "total_loss": 6.655279795328776, "policy_loss": 0.00017098530575081154, "vf_loss": 6.655160427093506, "vf_explained_var": -1.0772987648292823e-06, "kl": 0.0009253345483557496, "entropy": 0.5148518549071418, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1850.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 1242000, "num_env_steps_trained": 1242000, "num_agent_steps_sampled": 1242000, "num_agent_steps_trained": 1242000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.886999999999816, "episode_len_mean": 266.74, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 45.1, -50.00000000000044, -50.00000000000044, 41.100000000000016, 37.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 43.30000000000001, 44.300000000000004, 24.499999999999908, -50.00000000000044, 36.900000000000034, 46.099999999999994, 43.10000000000001, 30.099999999999987, -50.00000000000044, 41.70000000000002, 39.300000000000026, -50.00000000000044, 43.7, 24.69999999999991, 14.499999999999766, -50.00000000000044, -50.00000000000044, 43.10000000000001, 42.70000000000001, 42.900000000000006, 47.1, 44.7, 45.3, 45.3, 45.9, -50.00000000000044, 42.70000000000001, 43.30000000000001, -50.00000000000044, 42.500000000000014, 33.500000000000036, 45.9, 3.0999999999996035, 31.1, 37.50000000000003, -50.00000000000044, 23.699999999999896, 36.900000000000034, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 43.7, 46.699999999999996, -50.00000000000044, 10.699999999999712, 44.10000000000001, -50.00000000000044, -50.00000000000044, 31.900000000000013, 38.90000000000002, -50.00000000000044, 39.300000000000026, 46.5, 35.10000000000004, 36.50000000000003, 20.299999999999848, 36.70000000000003, 43.900000000000006, 39.10000000000002, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 1.6999999999995836, 45.7, -50.00000000000044, 37.90000000000003, -50.00000000000044, -50.00000000000044, 44.10000000000001, 41.90000000000001, 41.500000000000014, -50.00000000000044, -50.00000000000044], "episode_lengths": [30, 500, 500, 500, 42, 50, 500, 500, 90, 128, 500, 500, 500, 92, 500, 34, 500, 500, 68, 58, 256, 500, 132, 40, 70, 200, 500, 84, 108, 500, 64, 254, 356, 500, 500, 70, 74, 72, 30, 54, 48, 48, 42, 500, 74, 68, 500, 76, 166, 42, 470, 190, 126, 500, 264, 132, 44, 500, 500, 500, 66, 500, 500, 500, 40, 64, 34, 500, 394, 60, 500, 500, 182, 112, 500, 108, 36, 150, 136, 298, 134, 62, 110, 500, 500, 64, 500, 500, 500, 484, 44, 500, 122, 500, 500, 60, 82, 86, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4047201011886748, "mean_inference_ms": 1.2941180918865711, "mean_action_processing_ms": 0.15054894727806312, "mean_env_wait_ms": 0.09029962291512839, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028000593185424805, "StateBufferConnector_ms": 0.00500178337097168, "ViewRequirementAgentConnector_ms": 0.12301278114318848}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.886999999999816, "episode_len_mean": 266.74, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 45.1, -50.00000000000044, -50.00000000000044, 41.100000000000016, 37.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 43.30000000000001, 44.300000000000004, 24.499999999999908, -50.00000000000044, 36.900000000000034, 46.099999999999994, 43.10000000000001, 30.099999999999987, -50.00000000000044, 41.70000000000002, 39.300000000000026, -50.00000000000044, 43.7, 24.69999999999991, 14.499999999999766, -50.00000000000044, -50.00000000000044, 43.10000000000001, 42.70000000000001, 42.900000000000006, 47.1, 44.7, 45.3, 45.3, 45.9, -50.00000000000044, 42.70000000000001, 43.30000000000001, -50.00000000000044, 42.500000000000014, 33.500000000000036, 45.9, 3.0999999999996035, 31.1, 37.50000000000003, -50.00000000000044, 23.699999999999896, 36.900000000000034, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 43.7, 46.699999999999996, -50.00000000000044, 10.699999999999712, 44.10000000000001, -50.00000000000044, -50.00000000000044, 31.900000000000013, 38.90000000000002, -50.00000000000044, 39.300000000000026, 46.5, 35.10000000000004, 36.50000000000003, 20.299999999999848, 36.70000000000003, 43.900000000000006, 39.10000000000002, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 1.6999999999995836, 45.7, -50.00000000000044, 37.90000000000003, -50.00000000000044, -50.00000000000044, 44.10000000000001, 41.90000000000001, 41.500000000000014, -50.00000000000044, -50.00000000000044], "episode_lengths": [30, 500, 500, 500, 42, 50, 500, 500, 90, 128, 500, 500, 500, 92, 500, 34, 500, 500, 68, 58, 256, 500, 132, 40, 70, 200, 500, 84, 108, 500, 64, 254, 356, 500, 500, 70, 74, 72, 30, 54, 48, 48, 42, 500, 74, 68, 500, 76, 166, 42, 470, 190, 126, 500, 264, 132, 44, 500, 500, 500, 66, 500, 500, 500, 40, 64, 34, 500, 394, 60, 500, 500, 182, 112, 500, 108, 36, 150, 136, 298, 134, 62, 110, 500, 500, 64, 500, 500, 500, 484, 44, 500, 122, 500, 500, 60, 82, 86, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4047201011886748, "mean_inference_ms": 1.2941180918865711, "mean_action_processing_ms": 0.15054894727806312, "mean_env_wait_ms": 0.09029962291512839, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028000593185424805, "StateBufferConnector_ms": 0.00500178337097168, "ViewRequirementAgentConnector_ms": 0.12301278114318848}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1242000, "num_agent_steps_trained": 1242000, "num_env_steps_sampled": 1242000, "num_env_steps_trained": 1242000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5469.515053659913, "num_env_steps_trained_throughput_per_sec": 5469.515053659913, "timesteps_total": 1242000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1242000, "timers": {"training_iteration_time_ms": 3371.514, "sample_time_ms": 2967.333, "load_time_ms": 18.106, "load_throughput": 994142.553, "learn_time_ms": 374.083, "learn_throughput": 48117.717, "synch_weights_time_ms": 9.491}, "counters": {"num_env_steps_sampled": 1242000, "num_env_steps_trained": 1242000, "num_agent_steps_sampled": 1242000, "num_agent_steps_trained": 1242000}, "done": false, "episodes_total": 4873, "training_iteration": 69, "trial_id": "9f288_00020", "date": "2023-10-25_17-15-48", "timestamp": 1698250548, "time_this_iter_s": 3.2959673404693604, "time_total_s": 237.73304557800293, "pid": 9936, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 237.73304557800293, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 61.14, "ram_util_percent": 27.080000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.388131789017202e-22, "cur_lr": 0.0003, "total_loss": 6.787618972637035, "policy_loss": -0.0003557648095819685, "vf_loss": 6.78802165278682, "vf_explained_var": -1.1965080543800636e-06, "kl": 0.00041340429410857487, "entropy": 0.4697192896295477, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1877.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 1260000, "num_env_steps_trained": 1260000, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.1819999999998037, "episode_len_mean": 278.78, "episode_media": {}, "episodes_this_iter": 63, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.099999999999994, 43.7, 46.699999999999996, -50.00000000000044, 10.699999999999712, 44.10000000000001, -50.00000000000044, -50.00000000000044, 31.900000000000013, 38.90000000000002, -50.00000000000044, 39.300000000000026, 46.5, 35.10000000000004, 36.50000000000003, 20.299999999999848, 36.70000000000003, 43.900000000000006, 39.10000000000002, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 1.6999999999995836, 45.7, -50.00000000000044, 37.90000000000003, -50.00000000000044, -50.00000000000044, 44.10000000000001, 41.90000000000001, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 47.7, -50.00000000000044, 9.499999999999694, -50.00000000000044, -50.00000000000044, -50.00000000000044, 4.299999999999621, 43.50000000000001, 46.699999999999996, 33.10000000000003, -50.00000000000044, -50.00000000000044, 33.30000000000003, 16.499999999999794, 43.10000000000001, 10.499999999999709, 43.50000000000001, 34.900000000000034, 26.299999999999933, 41.100000000000016, 46.099999999999994, 43.30000000000001, 46.099999999999994, -50.00000000000044, 44.900000000000006, 23.099999999999888, 30.499999999999993, 27.49999999999995, -50.00000000000044, 45.5, -50.00000000000044, 46.9, 23.699999999999896, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 46.3, 41.30000000000001, 45.1, -50.00000000000044, 42.500000000000014, 41.500000000000014, -50.00000000000044, 43.30000000000001, 39.300000000000026, -50.00000000000044, 40.90000000000002, 26.09999999999993, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 44.5, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 40, 64, 34, 500, 394, 60, 500, 500, 182, 112, 500, 108, 36, 150, 136, 298, 134, 62, 110, 500, 500, 64, 500, 500, 500, 484, 44, 500, 122, 500, 500, 60, 82, 86, 500, 500, 500, 64, 24, 500, 406, 500, 500, 500, 458, 66, 34, 170, 500, 500, 168, 336, 70, 396, 66, 152, 238, 90, 40, 68, 40, 500, 52, 270, 196, 226, 500, 46, 500, 32, 264, 500, 500, 500, 68, 38, 88, 50, 500, 76, 86, 500, 68, 108, 500, 92, 240, 500, 500, 500, 500, 500, 36, 56, 38, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40478299000746243, "mean_inference_ms": 1.2925360046533445, "mean_action_processing_ms": 0.15046469375502222, "mean_env_wait_ms": 0.09036168706196251, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027019500732421875, "StateBufferConnector_ms": 0.00700068473815918, "ViewRequirementAgentConnector_ms": 0.13700628280639648}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.1819999999998037, "episode_len_mean": 278.78, "episodes_this_iter": 63, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.099999999999994, 43.7, 46.699999999999996, -50.00000000000044, 10.699999999999712, 44.10000000000001, -50.00000000000044, -50.00000000000044, 31.900000000000013, 38.90000000000002, -50.00000000000044, 39.300000000000026, 46.5, 35.10000000000004, 36.50000000000003, 20.299999999999848, 36.70000000000003, 43.900000000000006, 39.10000000000002, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 1.6999999999995836, 45.7, -50.00000000000044, 37.90000000000003, -50.00000000000044, -50.00000000000044, 44.10000000000001, 41.90000000000001, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 47.7, -50.00000000000044, 9.499999999999694, -50.00000000000044, -50.00000000000044, -50.00000000000044, 4.299999999999621, 43.50000000000001, 46.699999999999996, 33.10000000000003, -50.00000000000044, -50.00000000000044, 33.30000000000003, 16.499999999999794, 43.10000000000001, 10.499999999999709, 43.50000000000001, 34.900000000000034, 26.299999999999933, 41.100000000000016, 46.099999999999994, 43.30000000000001, 46.099999999999994, -50.00000000000044, 44.900000000000006, 23.099999999999888, 30.499999999999993, 27.49999999999995, -50.00000000000044, 45.5, -50.00000000000044, 46.9, 23.699999999999896, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 46.3, 41.30000000000001, 45.1, -50.00000000000044, 42.500000000000014, 41.500000000000014, -50.00000000000044, 43.30000000000001, 39.300000000000026, -50.00000000000044, 40.90000000000002, 26.09999999999993, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 44.5, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 40, 64, 34, 500, 394, 60, 500, 500, 182, 112, 500, 108, 36, 150, 136, 298, 134, 62, 110, 500, 500, 64, 500, 500, 500, 484, 44, 500, 122, 500, 500, 60, 82, 86, 500, 500, 500, 64, 24, 500, 406, 500, 500, 500, 458, 66, 34, 170, 500, 500, 168, 336, 70, 396, 66, 152, 238, 90, 40, 68, 40, 500, 52, 270, 196, 226, 500, 46, 500, 32, 264, 500, 500, 500, 68, 38, 88, 50, 500, 76, 86, 500, 68, 108, 500, 92, 240, 500, 500, 500, 500, 500, 36, 56, 38, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40478299000746243, "mean_inference_ms": 1.2925360046533445, "mean_action_processing_ms": 0.15046469375502222, "mean_env_wait_ms": 0.09036168706196251, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027019500732421875, "StateBufferConnector_ms": 0.00700068473815918, "ViewRequirementAgentConnector_ms": 0.13700628280639648}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000, "num_env_steps_sampled": 1260000, "num_env_steps_trained": 1260000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5252.40399449307, "num_env_steps_trained_throughput_per_sec": 5252.40399449307, "timesteps_total": 1260000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1260000, "timers": {"training_iteration_time_ms": 3395.114, "sample_time_ms": 2983.033, "load_time_ms": 18.203, "load_throughput": 988855.967, "learn_time_ms": 381.882, "learn_throughput": 47134.949, "synch_weights_time_ms": 9.495}, "counters": {"num_env_steps_sampled": 1260000, "num_env_steps_trained": 1260000, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000}, "done": false, "episodes_total": 4936, "training_iteration": 70, "trial_id": "9f288_00020", "date": "2023-10-25_17-15-51", "timestamp": 1698250551, "time_this_iter_s": 3.4329988956451416, "time_total_s": 241.16604447364807, "pid": 9936, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 241.16604447364807, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 58.739999999999995, "ram_util_percent": 27.04}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.694065894508601e-22, "cur_lr": 0.0003, "total_loss": 6.604944211465341, "policy_loss": -0.00034036970248928775, "vf_loss": 6.605334017011854, "vf_explained_var": -7.947285970052084e-07, "kl": 0.0006266602054404723, "entropy": 0.4952624793405886, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1904.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 1278000, "num_env_steps_trained": 1278000, "num_agent_steps_sampled": 1278000, "num_agent_steps_trained": 1278000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.108999999999815, "episode_len_mean": 264.52, "episode_media": {}, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [23.699999999999896, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 46.3, 41.30000000000001, 45.1, -50.00000000000044, 42.500000000000014, 41.500000000000014, -50.00000000000044, 43.30000000000001, 39.300000000000026, -50.00000000000044, 40.90000000000002, 26.09999999999993, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 44.5, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, 30.099999999999987, -50.00000000000044, 45.5, 41.500000000000014, -50.00000000000044, 45.5, 46.9, 44.900000000000006, 45.7, 41.500000000000014, -50.00000000000044, 46.3, -50.00000000000044, 10.099999999999703, 46.099999999999994, 0.09999999999956088, 45.7, 38.90000000000002, -50.00000000000044, -50.00000000000044, 19.899999999999842, 47.5, 42.30000000000001, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 22.099999999999874, 40.90000000000002, 46.3, -50.00000000000044, 35.30000000000004, -50.00000000000044, 44.7, 43.10000000000001, -50.00000000000044, 32.50000000000002, 36.50000000000003, -50.00000000000044, 45.9, 45.7, 7.499999999999666, -50.00000000000044, 23.29999999999989, 42.70000000000001, -50.00000000000044, 43.30000000000001, 33.10000000000003, 42.10000000000001, 46.3, 34.10000000000004, 41.70000000000002, 46.099999999999994, 26.09999999999993, 44.7, 46.9, 34.10000000000004, -50.00000000000044, 28.699999999999967, 45.3, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 44.7], "episode_lengths": [264, 500, 500, 500, 68, 38, 88, 50, 500, 76, 86, 500, 68, 108, 500, 92, 240, 500, 500, 500, 500, 500, 36, 56, 38, 500, 500, 500, 500, 500, 500, 86, 500, 200, 500, 46, 86, 500, 46, 32, 52, 44, 86, 500, 38, 500, 400, 40, 500, 44, 112, 500, 500, 302, 26, 78, 500, 500, 80, 500, 500, 280, 92, 38, 500, 148, 500, 54, 70, 500, 176, 136, 500, 42, 44, 426, 500, 268, 74, 500, 68, 170, 80, 38, 160, 84, 40, 240, 54, 32, 160, 500, 214, 48, 500, 500, 56, 500, 500, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4049505239540185, "mean_inference_ms": 1.2928161027632301, "mean_action_processing_ms": 0.15062707162407865, "mean_env_wait_ms": 0.09040901414086008, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03101038932800293, "StateBufferConnector_ms": 0.006999015808105469, "ViewRequirementAgentConnector_ms": 0.11302590370178223}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.108999999999815, "episode_len_mean": 264.52, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [23.699999999999896, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 46.3, 41.30000000000001, 45.1, -50.00000000000044, 42.500000000000014, 41.500000000000014, -50.00000000000044, 43.30000000000001, 39.300000000000026, -50.00000000000044, 40.90000000000002, 26.09999999999993, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 44.5, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, 30.099999999999987, -50.00000000000044, 45.5, 41.500000000000014, -50.00000000000044, 45.5, 46.9, 44.900000000000006, 45.7, 41.500000000000014, -50.00000000000044, 46.3, -50.00000000000044, 10.099999999999703, 46.099999999999994, 0.09999999999956088, 45.7, 38.90000000000002, -50.00000000000044, -50.00000000000044, 19.899999999999842, 47.5, 42.30000000000001, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 22.099999999999874, 40.90000000000002, 46.3, -50.00000000000044, 35.30000000000004, -50.00000000000044, 44.7, 43.10000000000001, -50.00000000000044, 32.50000000000002, 36.50000000000003, -50.00000000000044, 45.9, 45.7, 7.499999999999666, -50.00000000000044, 23.29999999999989, 42.70000000000001, -50.00000000000044, 43.30000000000001, 33.10000000000003, 42.10000000000001, 46.3, 34.10000000000004, 41.70000000000002, 46.099999999999994, 26.09999999999993, 44.7, 46.9, 34.10000000000004, -50.00000000000044, 28.699999999999967, 45.3, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 44.7], "episode_lengths": [264, 500, 500, 500, 68, 38, 88, 50, 500, 76, 86, 500, 68, 108, 500, 92, 240, 500, 500, 500, 500, 500, 36, 56, 38, 500, 500, 500, 500, 500, 500, 86, 500, 200, 500, 46, 86, 500, 46, 32, 52, 44, 86, 500, 38, 500, 400, 40, 500, 44, 112, 500, 500, 302, 26, 78, 500, 500, 80, 500, 500, 280, 92, 38, 500, 148, 500, 54, 70, 500, 176, 136, 500, 42, 44, 426, 500, 268, 74, 500, 68, 170, 80, 38, 160, 84, 40, 240, 54, 32, 160, 500, 214, 48, 500, 500, 56, 500, 500, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4049505239540185, "mean_inference_ms": 1.2928161027632301, "mean_action_processing_ms": 0.15062707162407865, "mean_env_wait_ms": 0.09040901414086008, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03101038932800293, "StateBufferConnector_ms": 0.006999015808105469, "ViewRequirementAgentConnector_ms": 0.11302590370178223}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1278000, "num_agent_steps_trained": 1278000, "num_env_steps_sampled": 1278000, "num_env_steps_trained": 1278000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5579.6609743596755, "num_env_steps_trained_throughput_per_sec": 5579.6609743596755, "timesteps_total": 1278000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1278000, "timers": {"training_iteration_time_ms": 3393.314, "sample_time_ms": 2986.733, "load_time_ms": 18.203, "load_throughput": 988857.262, "learn_time_ms": 376.182, "learn_throughput": 47849.175, "synch_weights_time_ms": 9.695}, "counters": {"num_env_steps_sampled": 1278000, "num_env_steps_trained": 1278000, "num_agent_steps_sampled": 1278000, "num_agent_steps_trained": 1278000}, "done": false, "episodes_total": 5007, "training_iteration": 71, "trial_id": "9f288_00020", "date": "2023-10-25_17-15-54", "timestamp": 1698250554, "time_this_iter_s": 3.231999158859253, "time_total_s": 244.39804363250732, "pid": 9936, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 244.39804363250732, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 64.45, "ram_util_percent": 27.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.470329472543005e-23, "cur_lr": 0.0003, "total_loss": 6.718129811463533, "policy_loss": -0.000239844744404157, "vf_loss": 6.718423066315828, "vf_explained_var": -9.845804285120081e-07, "kl": 0.00036516793779831595, "entropy": 0.5345424016316732, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1931.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 1296000, "num_env_steps_trained": 1296000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.643999999999838, "episode_len_mean": 244.2, "episode_media": {}, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.9, 45.7, 7.499999999999666, -50.00000000000044, 23.29999999999989, 42.70000000000001, -50.00000000000044, 43.30000000000001, 33.10000000000003, 42.10000000000001, 46.3, 34.10000000000004, 41.70000000000002, 46.099999999999994, 26.09999999999993, 44.7, 46.9, 34.10000000000004, -50.00000000000044, 28.699999999999967, 45.3, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 34.10000000000004, -50.00000000000044, -50.00000000000044, 35.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 47.1, 42.10000000000001, 32.50000000000002, 46.3, -50.00000000000044, 44.5, 45.7, -50.00000000000044, -50.00000000000044, 46.099999999999994, 42.900000000000006, 45.9, 33.90000000000004, 41.500000000000014, 45.5, 44.300000000000004, 46.699999999999996, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 46.099999999999994, 42.500000000000014, 34.900000000000034, 20.899999999999856, -50.00000000000044, 42.70000000000001, 47.1, -50.00000000000044, 41.90000000000001, 46.5, 46.3, -50.00000000000044, -50.00000000000044, 5.099999999999632, -50.00000000000044, 44.900000000000006, 44.10000000000001, 36.70000000000003, -50.00000000000044, 42.500000000000014, 40.10000000000002, -50.00000000000044, -50.00000000000044, 44.300000000000004, 43.7, 29.299999999999976, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 43.900000000000006, 35.70000000000003, 44.7, 40.30000000000002, 39.300000000000026, 45.1, -50.00000000000044], "episode_lengths": [42, 44, 426, 500, 268, 74, 500, 68, 170, 80, 38, 160, 84, 40, 240, 54, 32, 160, 500, 214, 48, 500, 500, 56, 500, 500, 54, 500, 500, 160, 500, 500, 148, 500, 500, 500, 58, 500, 30, 80, 176, 38, 500, 56, 44, 500, 500, 40, 72, 42, 162, 86, 46, 58, 34, 500, 500, 66, 500, 500, 40, 76, 152, 292, 500, 74, 30, 500, 82, 36, 38, 500, 500, 450, 500, 52, 60, 134, 500, 76, 100, 500, 500, 58, 64, 208, 500, 56, 500, 500, 78, 500, 500, 62, 144, 54, 98, 108, 50, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4057418672594028, "mean_inference_ms": 1.2916646574949622, "mean_action_processing_ms": 0.15092122203226385, "mean_env_wait_ms": 0.0901866171286682, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02700042724609375, "StateBufferConnector_ms": 0.006995677947998047, "ViewRequirementAgentConnector_ms": 0.10000157356262207}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.643999999999838, "episode_len_mean": 244.2, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.9, 45.7, 7.499999999999666, -50.00000000000044, 23.29999999999989, 42.70000000000001, -50.00000000000044, 43.30000000000001, 33.10000000000003, 42.10000000000001, 46.3, 34.10000000000004, 41.70000000000002, 46.099999999999994, 26.09999999999993, 44.7, 46.9, 34.10000000000004, -50.00000000000044, 28.699999999999967, 45.3, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 34.10000000000004, -50.00000000000044, -50.00000000000044, 35.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 47.1, 42.10000000000001, 32.50000000000002, 46.3, -50.00000000000044, 44.5, 45.7, -50.00000000000044, -50.00000000000044, 46.099999999999994, 42.900000000000006, 45.9, 33.90000000000004, 41.500000000000014, 45.5, 44.300000000000004, 46.699999999999996, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 46.099999999999994, 42.500000000000014, 34.900000000000034, 20.899999999999856, -50.00000000000044, 42.70000000000001, 47.1, -50.00000000000044, 41.90000000000001, 46.5, 46.3, -50.00000000000044, -50.00000000000044, 5.099999999999632, -50.00000000000044, 44.900000000000006, 44.10000000000001, 36.70000000000003, -50.00000000000044, 42.500000000000014, 40.10000000000002, -50.00000000000044, -50.00000000000044, 44.300000000000004, 43.7, 29.299999999999976, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 43.900000000000006, 35.70000000000003, 44.7, 40.30000000000002, 39.300000000000026, 45.1, -50.00000000000044], "episode_lengths": [42, 44, 426, 500, 268, 74, 500, 68, 170, 80, 38, 160, 84, 40, 240, 54, 32, 160, 500, 214, 48, 500, 500, 56, 500, 500, 54, 500, 500, 160, 500, 500, 148, 500, 500, 500, 58, 500, 30, 80, 176, 38, 500, 56, 44, 500, 500, 40, 72, 42, 162, 86, 46, 58, 34, 500, 500, 66, 500, 500, 40, 76, 152, 292, 500, 74, 30, 500, 82, 36, 38, 500, 500, 450, 500, 52, 60, 134, 500, 76, 100, 500, 500, 58, 64, 208, 500, 56, 500, 500, 78, 500, 500, 62, 144, 54, 98, 108, 50, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4057418672594028, "mean_inference_ms": 1.2916646574949622, "mean_action_processing_ms": 0.15092122203226385, "mean_env_wait_ms": 0.0901866171286682, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02700042724609375, "StateBufferConnector_ms": 0.006995677947998047, "ViewRequirementAgentConnector_ms": 0.10000157356262207}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000, "num_env_steps_sampled": 1296000, "num_env_steps_trained": 1296000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5369.917709479147, "num_env_steps_trained_throughput_per_sec": 5369.917709479147, "timesteps_total": 1296000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1296000, "timers": {"training_iteration_time_ms": 3370.492, "sample_time_ms": 2972.511, "load_time_ms": 18.502, "load_throughput": 972841.63, "learn_time_ms": 367.279, "learn_throughput": 49009.079, "synch_weights_time_ms": 9.798}, "counters": {"num_env_steps_sampled": 1296000, "num_env_steps_trained": 1296000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "done": false, "episodes_total": 5080, "training_iteration": 72, "trial_id": "9f288_00020", "date": "2023-10-25_17-15-58", "timestamp": 1698250558, "time_this_iter_s": 3.357001543045044, "time_total_s": 247.75504517555237, "pid": 9936, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 247.75504517555237, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 62.3, "ram_util_percent": 27.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.2351647362715025e-23, "cur_lr": 0.0003, "total_loss": 6.742149794543231, "policy_loss": -0.00042198115476855527, "vf_loss": 6.742623488108317, "vf_explained_var": -9.58089475278501e-07, "kl": 0.0008131114844563517, "entropy": 0.5176364315880669, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1958.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 1314000, "num_env_steps_trained": 1314000, "num_agent_steps_sampled": 1314000, "num_agent_steps_trained": 1314000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.793999999999829, "episode_len_mean": 252.7, "episode_media": {}, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 5.099999999999632, -50.00000000000044, 44.900000000000006, 44.10000000000001, 36.70000000000003, -50.00000000000044, 42.500000000000014, 40.10000000000002, -50.00000000000044, -50.00000000000044, 44.300000000000004, 43.7, 29.299999999999976, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 43.900000000000006, 35.70000000000003, 44.7, 40.30000000000002, 39.300000000000026, 45.1, -50.00000000000044, 41.100000000000016, 43.50000000000001, 34.50000000000004, 40.500000000000014, 46.9, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 22.899999999999885, 43.900000000000006, -50.00000000000044, -50.00000000000044, 46.9, 13.499999999999751, 36.10000000000004, -50.00000000000044, 46.9, 20.699999999999854, 14.09999999999976, -50.00000000000044, 42.500000000000014, 44.7, 47.1, 35.900000000000034, 44.300000000000004, 30.099999999999987, -50.00000000000044, 46.099999999999994, 34.10000000000004, -50.00000000000044, 20.099999999999845, 40.500000000000014, -50.00000000000044, 45.9, 37.70000000000003, -50.00000000000044, 42.30000000000001, 47.1, 47.3, 46.5, 39.10000000000002, 39.10000000000002, 39.10000000000002, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 43.7, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044, 41.500000000000014, 33.90000000000004, 44.7, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, 16.499999999999794, -50.00000000000044, 44.900000000000006, 43.900000000000006, 44.7, -50.00000000000044, 12.099999999999731], "episode_lengths": [500, 500, 450, 500, 52, 60, 134, 500, 76, 100, 500, 500, 58, 64, 208, 500, 56, 500, 500, 78, 500, 500, 62, 144, 54, 98, 108, 50, 500, 90, 66, 156, 96, 32, 500, 38, 500, 500, 272, 62, 500, 500, 32, 366, 140, 500, 32, 294, 360, 500, 76, 54, 30, 142, 58, 200, 500, 40, 160, 500, 300, 96, 500, 42, 124, 500, 78, 30, 28, 36, 110, 110, 110, 28, 500, 500, 500, 500, 500, 60, 64, 500, 92, 500, 500, 86, 162, 54, 30, 500, 500, 500, 98, 336, 500, 52, 62, 54, 500, 380]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4047669456987758, "mean_inference_ms": 1.2912977851437402, "mean_action_processing_ms": 0.1508060679825317, "mean_env_wait_ms": 0.09008166230963525, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029995441436767578, "StateBufferConnector_ms": 0.008997201919555664, "ViewRequirementAgentConnector_ms": 0.12499356269836426}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.793999999999829, "episode_len_mean": 252.7, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 5.099999999999632, -50.00000000000044, 44.900000000000006, 44.10000000000001, 36.70000000000003, -50.00000000000044, 42.500000000000014, 40.10000000000002, -50.00000000000044, -50.00000000000044, 44.300000000000004, 43.7, 29.299999999999976, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 43.900000000000006, 35.70000000000003, 44.7, 40.30000000000002, 39.300000000000026, 45.1, -50.00000000000044, 41.100000000000016, 43.50000000000001, 34.50000000000004, 40.500000000000014, 46.9, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 22.899999999999885, 43.900000000000006, -50.00000000000044, -50.00000000000044, 46.9, 13.499999999999751, 36.10000000000004, -50.00000000000044, 46.9, 20.699999999999854, 14.09999999999976, -50.00000000000044, 42.500000000000014, 44.7, 47.1, 35.900000000000034, 44.300000000000004, 30.099999999999987, -50.00000000000044, 46.099999999999994, 34.10000000000004, -50.00000000000044, 20.099999999999845, 40.500000000000014, -50.00000000000044, 45.9, 37.70000000000003, -50.00000000000044, 42.30000000000001, 47.1, 47.3, 46.5, 39.10000000000002, 39.10000000000002, 39.10000000000002, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 43.7, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044, 41.500000000000014, 33.90000000000004, 44.7, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, 16.499999999999794, -50.00000000000044, 44.900000000000006, 43.900000000000006, 44.7, -50.00000000000044, 12.099999999999731], "episode_lengths": [500, 500, 450, 500, 52, 60, 134, 500, 76, 100, 500, 500, 58, 64, 208, 500, 56, 500, 500, 78, 500, 500, 62, 144, 54, 98, 108, 50, 500, 90, 66, 156, 96, 32, 500, 38, 500, 500, 272, 62, 500, 500, 32, 366, 140, 500, 32, 294, 360, 500, 76, 54, 30, 142, 58, 200, 500, 40, 160, 500, 300, 96, 500, 42, 124, 500, 78, 30, 28, 36, 110, 110, 110, 28, 500, 500, 500, 500, 500, 60, 64, 500, 92, 500, 500, 86, 162, 54, 30, 500, 500, 500, 98, 336, 500, 52, 62, 54, 500, 380]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4047669456987758, "mean_inference_ms": 1.2912977851437402, "mean_action_processing_ms": 0.1508060679825317, "mean_env_wait_ms": 0.09008166230963525, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029995441436767578, "StateBufferConnector_ms": 0.008997201919555664, "ViewRequirementAgentConnector_ms": 0.12499356269836426}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1314000, "num_agent_steps_trained": 1314000, "num_env_steps_sampled": 1314000, "num_env_steps_trained": 1314000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5665.718046118838, "num_env_steps_trained_throughput_per_sec": 5665.718046118838, "timesteps_total": 1314000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1314000, "timers": {"training_iteration_time_ms": 3333.992, "sample_time_ms": 2943.51, "load_time_ms": 18.103, "load_throughput": 994304.905, "learn_time_ms": 360.179, "learn_throughput": 49975.198, "synch_weights_time_ms": 9.798}, "counters": {"num_env_steps_sampled": 1314000, "num_env_steps_trained": 1314000, "num_agent_steps_sampled": 1314000, "num_agent_steps_trained": 1314000}, "done": false, "episodes_total": 5151, "training_iteration": 73, "trial_id": "9f288_00020", "date": "2023-10-25_17-16-01", "timestamp": 1698250561, "time_this_iter_s": 3.182002305984497, "time_total_s": 250.93704748153687, "pid": 9936, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 250.93704748153687, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 57.1, "ram_util_percent": 27.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.1175823681357513e-23, "cur_lr": 0.0003, "total_loss": 6.733890710053621, "policy_loss": -6.873546927063553e-05, "vf_loss": 6.734011031963207, "vf_explained_var": -9.801652696397569e-07, "kl": 0.00017531533788060102, "entropy": 0.5162745758339211, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1985.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 1332000, "num_env_steps_trained": 1332000, "num_agent_steps_sampled": 1332000, "num_agent_steps_trained": 1332000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.5039999999998117, "episode_len_mean": 265.56, "episode_media": {}, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 43.7, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044, 41.500000000000014, 33.90000000000004, 44.7, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, 16.499999999999794, -50.00000000000044, 44.900000000000006, 43.900000000000006, 44.7, -50.00000000000044, 12.099999999999731, -50.00000000000044, 46.699999999999996, 45.3, 46.5, -50.00000000000044, 39.50000000000002, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, 32.90000000000003, -50.00000000000044, 44.900000000000006, 46.099999999999994, -50.00000000000044, 43.50000000000001, -50.00000000000044, 45.9, 34.30000000000004, 45.5, 36.900000000000034, 33.30000000000003, 27.099999999999945, 45.3, 45.7, 10.499999999999709, -50.00000000000044, 43.900000000000006, -50.00000000000044, 37.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 44.7, -50.00000000000044, 37.70000000000003, -50.00000000000044, 44.900000000000006, -50.00000000000044, 45.9, 42.500000000000014, 44.900000000000006, -50.00000000000044, 37.70000000000003, 41.500000000000014, 46.699999999999996, 46.5, -50.00000000000044, 42.500000000000014, 3.0999999999996035, 41.500000000000014, -50.00000000000044, 42.30000000000001, 38.700000000000024, 47.3, 43.900000000000006, 22.099999999999874, 9.699999999999697, -50.00000000000044, 43.7, 37.90000000000003, 24.69999999999991, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 45.7, -50.00000000000044, -50.00000000000044], "episode_lengths": [28, 500, 500, 500, 500, 500, 60, 64, 500, 92, 500, 500, 86, 162, 54, 30, 500, 500, 500, 98, 336, 500, 52, 62, 54, 500, 380, 500, 34, 48, 36, 500, 106, 500, 500, 86, 500, 500, 172, 500, 52, 40, 500, 66, 500, 42, 158, 46, 132, 168, 230, 48, 44, 396, 500, 62, 500, 130, 500, 500, 500, 32, 54, 500, 124, 500, 52, 500, 42, 76, 52, 500, 124, 86, 34, 36, 500, 76, 470, 86, 500, 78, 114, 28, 62, 280, 404, 500, 64, 122, 254, 500, 64, 500, 500, 500, 44, 44, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4046134638400183, "mean_inference_ms": 1.2904668622695437, "mean_action_processing_ms": 0.15056529978759298, "mean_env_wait_ms": 0.09016742399983542, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02800130844116211, "StateBufferConnector_ms": 0.004998922348022461, "ViewRequirementAgentConnector_ms": 0.1210181713104248}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.5039999999998117, "episode_len_mean": 265.56, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 43.7, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044, 41.500000000000014, 33.90000000000004, 44.7, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, 16.499999999999794, -50.00000000000044, 44.900000000000006, 43.900000000000006, 44.7, -50.00000000000044, 12.099999999999731, -50.00000000000044, 46.699999999999996, 45.3, 46.5, -50.00000000000044, 39.50000000000002, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, 32.90000000000003, -50.00000000000044, 44.900000000000006, 46.099999999999994, -50.00000000000044, 43.50000000000001, -50.00000000000044, 45.9, 34.30000000000004, 45.5, 36.900000000000034, 33.30000000000003, 27.099999999999945, 45.3, 45.7, 10.499999999999709, -50.00000000000044, 43.900000000000006, -50.00000000000044, 37.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 44.7, -50.00000000000044, 37.70000000000003, -50.00000000000044, 44.900000000000006, -50.00000000000044, 45.9, 42.500000000000014, 44.900000000000006, -50.00000000000044, 37.70000000000003, 41.500000000000014, 46.699999999999996, 46.5, -50.00000000000044, 42.500000000000014, 3.0999999999996035, 41.500000000000014, -50.00000000000044, 42.30000000000001, 38.700000000000024, 47.3, 43.900000000000006, 22.099999999999874, 9.699999999999697, -50.00000000000044, 43.7, 37.90000000000003, 24.69999999999991, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 45.7, -50.00000000000044, -50.00000000000044], "episode_lengths": [28, 500, 500, 500, 500, 500, 60, 64, 500, 92, 500, 500, 86, 162, 54, 30, 500, 500, 500, 98, 336, 500, 52, 62, 54, 500, 380, 500, 34, 48, 36, 500, 106, 500, 500, 86, 500, 500, 172, 500, 52, 40, 500, 66, 500, 42, 158, 46, 132, 168, 230, 48, 44, 396, 500, 62, 500, 130, 500, 500, 500, 32, 54, 500, 124, 500, 52, 500, 42, 76, 52, 500, 124, 86, 34, 36, 500, 76, 470, 86, 500, 78, 114, 28, 62, 280, 404, 500, 64, 122, 254, 500, 64, 500, 500, 500, 44, 44, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4046134638400183, "mean_inference_ms": 1.2904668622695437, "mean_action_processing_ms": 0.15056529978759298, "mean_env_wait_ms": 0.09016742399983542, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02800130844116211, "StateBufferConnector_ms": 0.004998922348022461, "ViewRequirementAgentConnector_ms": 0.1210181713104248}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1332000, "num_agent_steps_trained": 1332000, "num_env_steps_sampled": 1332000, "num_env_steps_trained": 1332000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5579.655201236818, "num_env_steps_trained_throughput_per_sec": 5579.655201236818, "timesteps_total": 1332000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1332000, "timers": {"training_iteration_time_ms": 3296.27, "sample_time_ms": 2936.55, "load_time_ms": 16.7, "load_throughput": 1077853.187, "learn_time_ms": 330.817, "learn_throughput": 54410.781, "synch_weights_time_ms": 9.698}, "counters": {"num_env_steps_sampled": 1332000, "num_env_steps_trained": 1332000, "num_agent_steps_sampled": 1332000, "num_agent_steps_trained": 1332000}, "done": false, "episodes_total": 5224, "training_iteration": 74, "trial_id": "9f288_00020", "date": "2023-10-25_17-16-04", "timestamp": 1698250564, "time_this_iter_s": 3.231971263885498, "time_total_s": 254.16901874542236, "pid": 9936, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 254.16901874542236, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 69.5, "ram_util_percent": 26.975}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.0587911840678756e-23, "cur_lr": 0.0003, "total_loss": 6.422214737644902, "policy_loss": -0.0003195217362156621, "vf_loss": 6.422584710297762, "vf_explained_var": -9.58089475278501e-07, "kl": 0.0007561053918089379, "entropy": 0.5060341402336404, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 2012.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 1350000, "num_env_steps_trained": 1350000, "num_agent_steps_sampled": 1350000, "num_agent_steps_trained": 1350000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.614999999999825, "episode_len_mean": 249.48, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.900000000000006, -50.00000000000044, 37.70000000000003, 41.500000000000014, 46.699999999999996, 46.5, -50.00000000000044, 42.500000000000014, 3.0999999999996035, 41.500000000000014, -50.00000000000044, 42.30000000000001, 38.700000000000024, 47.3, 43.900000000000006, 22.099999999999874, 9.699999999999697, -50.00000000000044, 43.7, 37.90000000000003, 24.69999999999991, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 45.1, 46.099999999999994, -50.00000000000044, 18.899999999999828, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 45.9, 39.90000000000002, 46.5, 43.7, -50.00000000000044, 43.50000000000001, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 43.30000000000001, 45.7, -50.00000000000044, 41.70000000000002, 45.1, 34.10000000000004, 45.9, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 43.50000000000001, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 46.099999999999994, -50.00000000000044, 45.1, 45.9, 30.9, 14.09999999999976, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 47.1, 16.8999999999998, 33.70000000000004, 35.900000000000034, 31.70000000000001, 45.5, 43.7, 47.3, 43.30000000000001, 39.50000000000002, 43.30000000000001, -50.00000000000044, 37.50000000000003, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 30.499999999999993, 46.699999999999996], "episode_lengths": [52, 500, 124, 86, 34, 36, 500, 76, 470, 86, 500, 78, 114, 28, 62, 280, 404, 500, 64, 122, 254, 500, 64, 500, 500, 500, 44, 44, 500, 500, 500, 40, 50, 40, 500, 312, 40, 500, 500, 500, 46, 42, 102, 36, 64, 500, 66, 500, 56, 500, 500, 68, 44, 500, 84, 50, 160, 42, 500, 500, 46, 500, 66, 54, 500, 500, 500, 72, 40, 500, 50, 42, 192, 360, 500, 500, 500, 500, 40, 500, 500, 30, 332, 164, 142, 184, 46, 64, 28, 68, 106, 68, 500, 126, 500, 500, 34, 500, 196, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4040630018338437, "mean_inference_ms": 1.2904296791076455, "mean_action_processing_ms": 0.150404837864216, "mean_env_wait_ms": 0.09017996129161705, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026997089385986328, "StateBufferConnector_ms": 0.007002830505371094, "ViewRequirementAgentConnector_ms": 0.1260221004486084}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.614999999999825, "episode_len_mean": 249.48, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.900000000000006, -50.00000000000044, 37.70000000000003, 41.500000000000014, 46.699999999999996, 46.5, -50.00000000000044, 42.500000000000014, 3.0999999999996035, 41.500000000000014, -50.00000000000044, 42.30000000000001, 38.700000000000024, 47.3, 43.900000000000006, 22.099999999999874, 9.699999999999697, -50.00000000000044, 43.7, 37.90000000000003, 24.69999999999991, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 45.1, 46.099999999999994, -50.00000000000044, 18.899999999999828, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 45.9, 39.90000000000002, 46.5, 43.7, -50.00000000000044, 43.50000000000001, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 43.30000000000001, 45.7, -50.00000000000044, 41.70000000000002, 45.1, 34.10000000000004, 45.9, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 43.50000000000001, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 46.099999999999994, -50.00000000000044, 45.1, 45.9, 30.9, 14.09999999999976, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 47.1, 16.8999999999998, 33.70000000000004, 35.900000000000034, 31.70000000000001, 45.5, 43.7, 47.3, 43.30000000000001, 39.50000000000002, 43.30000000000001, -50.00000000000044, 37.50000000000003, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 30.499999999999993, 46.699999999999996], "episode_lengths": [52, 500, 124, 86, 34, 36, 500, 76, 470, 86, 500, 78, 114, 28, 62, 280, 404, 500, 64, 122, 254, 500, 64, 500, 500, 500, 44, 44, 500, 500, 500, 40, 50, 40, 500, 312, 40, 500, 500, 500, 46, 42, 102, 36, 64, 500, 66, 500, 56, 500, 500, 68, 44, 500, 84, 50, 160, 42, 500, 500, 46, 500, 66, 54, 500, 500, 500, 72, 40, 500, 50, 42, 192, 360, 500, 500, 500, 500, 40, 500, 500, 30, 332, 164, 142, 184, 46, 64, 28, 68, 106, 68, 500, 126, 500, 500, 34, 500, 196, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4040630018338437, "mean_inference_ms": 1.2904296791076455, "mean_action_processing_ms": 0.150404837864216, "mean_env_wait_ms": 0.09017996129161705, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026997089385986328, "StateBufferConnector_ms": 0.007002830505371094, "ViewRequirementAgentConnector_ms": 0.1260221004486084}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1350000, "num_agent_steps_trained": 1350000, "num_env_steps_sampled": 1350000, "num_env_steps_trained": 1350000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5442.9813829384575, "num_env_steps_trained_throughput_per_sec": 5442.9813829384575, "timesteps_total": 1350000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1350000, "timers": {"training_iteration_time_ms": 3305.073, "sample_time_ms": 2943.755, "load_time_ms": 17.9, "load_throughput": 1005611.259, "learn_time_ms": 331.217, "learn_throughput": 54345.067, "synch_weights_time_ms": 9.698}, "counters": {"num_env_steps_sampled": 1350000, "num_env_steps_trained": 1350000, "num_agent_steps_sampled": 1350000, "num_agent_steps_trained": 1350000}, "done": false, "episodes_total": 5294, "training_iteration": 75, "trial_id": "9f288_00020", "date": "2023-10-25_17-16-08", "timestamp": 1698250568, "time_this_iter_s": 3.3130104541778564, "time_total_s": 257.4820291996002, "pid": 9936, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 257.4820291996002, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 62.3, "ram_util_percent": 26.98}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.293955920339378e-24, "cur_lr": 0.0003, "total_loss": 6.817182187680845, "policy_loss": -0.0002972634543699247, "vf_loss": 6.817528848294859, "vf_explained_var": -1.0772987648292823e-06, "kl": 0.0005516107174588358, "entropy": 0.4931754293265166, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 2039.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 1368000, "num_env_steps_trained": 1368000, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.641999999999818, "episode_len_mean": 264.2, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.099999999999994, -50.00000000000044, 45.1, 45.9, 30.9, 14.09999999999976, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 47.1, 16.8999999999998, 33.70000000000004, 35.900000000000034, 31.70000000000001, 45.5, 43.7, 47.3, 43.30000000000001, 39.50000000000002, 43.30000000000001, -50.00000000000044, 37.50000000000003, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 30.499999999999993, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.70000000000003, 33.90000000000004, 47.5, -50.00000000000044, -50.00000000000044, 43.50000000000001, 40.70000000000002, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 11.29999999999972, 41.100000000000016, -50.00000000000044, 24.69999999999991, 29.299999999999976, 44.7, -50.00000000000044, 44.900000000000006, 35.500000000000036, 44.10000000000001, -50.00000000000044, 43.900000000000006, -50.00000000000044, 46.099999999999994, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.30000000000002, 43.10000000000001, 45.3, 36.70000000000003, -50.00000000000044, 46.5, 40.90000000000002, 9.499999999999694, -50.00000000000044, -50.00000000000044, 45.1, 40.30000000000002, 40.70000000000002, -50.00000000000044, 46.5, 13.699999999999754, 3.0999999999996035, -50.00000000000044, 46.5, 36.900000000000034, 46.5, 42.900000000000006, -50.00000000000044, 21.499999999999865, -50.00000000000044, 45.5, -50.00000000000044, 42.30000000000001, 43.900000000000006, 37.70000000000003, 38.10000000000002, -50.00000000000044], "episode_lengths": [40, 500, 50, 42, 192, 360, 500, 500, 500, 500, 40, 500, 500, 30, 332, 164, 142, 184, 46, 64, 28, 68, 106, 68, 500, 126, 500, 500, 34, 500, 196, 34, 500, 500, 500, 134, 162, 26, 500, 500, 66, 94, 58, 500, 500, 500, 500, 48, 500, 388, 90, 500, 254, 208, 54, 500, 52, 146, 60, 500, 62, 500, 40, 64, 500, 500, 500, 500, 178, 70, 48, 134, 500, 36, 92, 406, 500, 500, 50, 98, 94, 500, 36, 364, 470, 500, 36, 132, 36, 72, 500, 286, 500, 46, 500, 78, 62, 124, 120, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4039241624609551, "mean_inference_ms": 1.2904780668851783, "mean_action_processing_ms": 0.15025348815056966, "mean_env_wait_ms": 0.09016449323004608, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02700328826904297, "StateBufferConnector_ms": 0.0060002803802490234, "ViewRequirementAgentConnector_ms": 0.13599443435668945}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.641999999999818, "episode_len_mean": 264.2, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.099999999999994, -50.00000000000044, 45.1, 45.9, 30.9, 14.09999999999976, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 47.1, 16.8999999999998, 33.70000000000004, 35.900000000000034, 31.70000000000001, 45.5, 43.7, 47.3, 43.30000000000001, 39.50000000000002, 43.30000000000001, -50.00000000000044, 37.50000000000003, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 30.499999999999993, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.70000000000003, 33.90000000000004, 47.5, -50.00000000000044, -50.00000000000044, 43.50000000000001, 40.70000000000002, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 11.29999999999972, 41.100000000000016, -50.00000000000044, 24.69999999999991, 29.299999999999976, 44.7, -50.00000000000044, 44.900000000000006, 35.500000000000036, 44.10000000000001, -50.00000000000044, 43.900000000000006, -50.00000000000044, 46.099999999999994, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.30000000000002, 43.10000000000001, 45.3, 36.70000000000003, -50.00000000000044, 46.5, 40.90000000000002, 9.499999999999694, -50.00000000000044, -50.00000000000044, 45.1, 40.30000000000002, 40.70000000000002, -50.00000000000044, 46.5, 13.699999999999754, 3.0999999999996035, -50.00000000000044, 46.5, 36.900000000000034, 46.5, 42.900000000000006, -50.00000000000044, 21.499999999999865, -50.00000000000044, 45.5, -50.00000000000044, 42.30000000000001, 43.900000000000006, 37.70000000000003, 38.10000000000002, -50.00000000000044], "episode_lengths": [40, 500, 50, 42, 192, 360, 500, 500, 500, 500, 40, 500, 500, 30, 332, 164, 142, 184, 46, 64, 28, 68, 106, 68, 500, 126, 500, 500, 34, 500, 196, 34, 500, 500, 500, 134, 162, 26, 500, 500, 66, 94, 58, 500, 500, 500, 500, 48, 500, 388, 90, 500, 254, 208, 54, 500, 52, 146, 60, 500, 62, 500, 40, 64, 500, 500, 500, 500, 178, 70, 48, 134, 500, 36, 92, 406, 500, 500, 50, 98, 94, 500, 36, 364, 470, 500, 36, 132, 36, 72, 500, 286, 500, 46, 500, 78, 62, 124, 120, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4039241624609551, "mean_inference_ms": 1.2904780668851783, "mean_action_processing_ms": 0.15025348815056966, "mean_env_wait_ms": 0.09016449323004608, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02700328826904297, "StateBufferConnector_ms": 0.0060002803802490234, "ViewRequirementAgentConnector_ms": 0.13599443435668945}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000, "num_env_steps_sampled": 1368000, "num_env_steps_trained": 1368000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5205.366298723429, "num_env_steps_trained_throughput_per_sec": 5205.366298723429, "timesteps_total": 1368000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1368000, "timers": {"training_iteration_time_ms": 3320.57, "sample_time_ms": 2966.352, "load_time_ms": 16.899, "load_throughput": 1065138.91, "learn_time_ms": 325.22, "learn_throughput": 55347.188, "synch_weights_time_ms": 9.695}, "counters": {"num_env_steps_sampled": 1368000, "num_env_steps_trained": 1368000, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000}, "done": false, "episodes_total": 5362, "training_iteration": 76, "trial_id": "9f288_00020", "date": "2023-10-25_17-16-11", "timestamp": 1698250571, "time_this_iter_s": 3.463970184326172, "time_total_s": 260.9459993839264, "pid": 9936, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 260.9459993839264, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 65.78, "ram_util_percent": 26.98}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.646977960169689e-24, "cur_lr": 0.0003, "total_loss": 6.530951888472946, "policy_loss": 2.0340964612033633e-05, "vf_loss": 6.530982052838361, "vf_explained_var": -9.889955873842592e-07, "kl": 0.00023666906144239033, "entropy": 0.5051683540697451, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 2066.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 1386000, "num_env_steps_trained": 1386000, "num_agent_steps_sampled": 1386000, "num_agent_steps_trained": 1386000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.480999999999808, "episode_len_mean": 270.8, "episode_media": {}, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 32.30000000000002, 43.10000000000001, 45.3, 36.70000000000003, -50.00000000000044, 46.5, 40.90000000000002, 9.499999999999694, -50.00000000000044, -50.00000000000044, 45.1, 40.30000000000002, 40.70000000000002, -50.00000000000044, 46.5, 13.699999999999754, 3.0999999999996035, -50.00000000000044, 46.5, 36.900000000000034, 46.5, 42.900000000000006, -50.00000000000044, 21.499999999999865, -50.00000000000044, 45.5, -50.00000000000044, 42.30000000000001, 43.900000000000006, 37.70000000000003, 38.10000000000002, -50.00000000000044, 46.099999999999994, -50.00000000000044, 18.899999999999828, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, 44.300000000000004, 44.300000000000004, 44.300000000000004, 45.7, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 25.29999999999992, -50.00000000000044, 6.099999999999646, -50.00000000000044, 46.9, 38.700000000000024, 38.50000000000003, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 42.500000000000014, 39.90000000000002, 28.699999999999967, 44.7, 44.10000000000001, -50.00000000000044, -50.00000000000044, 46.099999999999994, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 47.3, 13.499999999999751, 45.3, 40.30000000000002, 47.7, 31.1, 45.5, -50.00000000000044, 5.899999999999643, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044, 21.09999999999986, -50.00000000000044, 46.099999999999994, 46.9, -50.00000000000044, -50.00000000000044, 40.500000000000014, 43.10000000000001, 32.700000000000024, -50.00000000000044, 40.500000000000014], "episode_lengths": [500, 500, 500, 178, 70, 48, 134, 500, 36, 92, 406, 500, 500, 50, 98, 94, 500, 36, 364, 470, 500, 36, 132, 36, 72, 500, 286, 500, 46, 500, 78, 62, 124, 120, 500, 40, 500, 312, 500, 500, 500, 100, 58, 58, 58, 44, 500, 38, 500, 500, 248, 500, 440, 500, 32, 114, 116, 500, 74, 500, 500, 76, 102, 214, 54, 60, 500, 500, 40, 52, 500, 500, 500, 50, 500, 500, 28, 366, 48, 98, 24, 190, 46, 500, 442, 500, 92, 500, 500, 290, 500, 40, 32, 500, 500, 96, 70, 174, 500, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4037251637182074, "mean_inference_ms": 1.2901186162011635, "mean_action_processing_ms": 0.15018309337814556, "mean_env_wait_ms": 0.09019486683092535, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.035007476806640625, "StateBufferConnector_ms": 0.006003379821777344, "ViewRequirementAgentConnector_ms": 0.12298727035522461}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.480999999999808, "episode_len_mean": 270.8, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 32.30000000000002, 43.10000000000001, 45.3, 36.70000000000003, -50.00000000000044, 46.5, 40.90000000000002, 9.499999999999694, -50.00000000000044, -50.00000000000044, 45.1, 40.30000000000002, 40.70000000000002, -50.00000000000044, 46.5, 13.699999999999754, 3.0999999999996035, -50.00000000000044, 46.5, 36.900000000000034, 46.5, 42.900000000000006, -50.00000000000044, 21.499999999999865, -50.00000000000044, 45.5, -50.00000000000044, 42.30000000000001, 43.900000000000006, 37.70000000000003, 38.10000000000002, -50.00000000000044, 46.099999999999994, -50.00000000000044, 18.899999999999828, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, 44.300000000000004, 44.300000000000004, 44.300000000000004, 45.7, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 25.29999999999992, -50.00000000000044, 6.099999999999646, -50.00000000000044, 46.9, 38.700000000000024, 38.50000000000003, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 42.500000000000014, 39.90000000000002, 28.699999999999967, 44.7, 44.10000000000001, -50.00000000000044, -50.00000000000044, 46.099999999999994, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 47.3, 13.499999999999751, 45.3, 40.30000000000002, 47.7, 31.1, 45.5, -50.00000000000044, 5.899999999999643, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044, 21.09999999999986, -50.00000000000044, 46.099999999999994, 46.9, -50.00000000000044, -50.00000000000044, 40.500000000000014, 43.10000000000001, 32.700000000000024, -50.00000000000044, 40.500000000000014], "episode_lengths": [500, 500, 500, 178, 70, 48, 134, 500, 36, 92, 406, 500, 500, 50, 98, 94, 500, 36, 364, 470, 500, 36, 132, 36, 72, 500, 286, 500, 46, 500, 78, 62, 124, 120, 500, 40, 500, 312, 500, 500, 500, 100, 58, 58, 58, 44, 500, 38, 500, 500, 248, 500, 440, 500, 32, 114, 116, 500, 74, 500, 500, 76, 102, 214, 54, 60, 500, 500, 40, 52, 500, 500, 500, 50, 500, 500, 28, 366, 48, 98, 24, 190, 46, 500, 442, 500, 92, 500, 500, 290, 500, 40, 32, 500, 500, 96, 70, 174, 500, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4037251637182074, "mean_inference_ms": 1.2901186162011635, "mean_action_processing_ms": 0.15018309337814556, "mean_env_wait_ms": 0.09019486683092535, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.035007476806640625, "StateBufferConnector_ms": 0.006003379821777344, "ViewRequirementAgentConnector_ms": 0.12298727035522461}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1386000, "num_agent_steps_trained": 1386000, "num_env_steps_sampled": 1386000, "num_env_steps_trained": 1386000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5518.136529408596, "num_env_steps_trained_throughput_per_sec": 5518.136529408596, "timesteps_total": 1386000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1386000, "timers": {"training_iteration_time_ms": 3326.87, "sample_time_ms": 2971.452, "load_time_ms": 17.3, "load_throughput": 1040489.088, "learn_time_ms": 326.02, "learn_throughput": 55211.357, "synch_weights_time_ms": 9.695}, "counters": {"num_env_steps_sampled": 1386000, "num_env_steps_trained": 1386000, "num_agent_steps_sampled": 1386000, "num_agent_steps_trained": 1386000}, "done": false, "episodes_total": 5427, "training_iteration": 77, "trial_id": "9f288_00020", "date": "2023-10-25_17-16-14", "timestamp": 1698250574, "time_this_iter_s": 3.2669684886932373, "time_total_s": 264.21296787261963, "pid": 9936, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 264.21296787261963, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 66.025, "ram_util_percent": 26.975}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.3234889800848445e-24, "cur_lr": 0.0003, "total_loss": 6.592570393173783, "policy_loss": -0.0006087276118773001, "vf_loss": 6.593230706674081, "vf_explained_var": -1.0287320172345197e-06, "kl": 0.0011274115602954336, "entropy": 0.5159896380371518, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 2093.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 1404000, "num_env_steps_trained": 1404000, "num_agent_steps_sampled": 1404000, "num_agent_steps_trained": 1404000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.859999999999816, "episode_len_mean": 262.02, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.099999999999994, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 47.3, 13.499999999999751, 45.3, 40.30000000000002, 47.7, 31.1, 45.5, -50.00000000000044, 5.899999999999643, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044, 21.09999999999986, -50.00000000000044, 46.099999999999994, 46.9, -50.00000000000044, -50.00000000000044, 40.500000000000014, 43.10000000000001, 32.700000000000024, -50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, 47.5, 43.10000000000001, 47.1, 42.500000000000014, -50.00000000000044, -50.00000000000044, 40.500000000000014, 45.5, 43.900000000000006, 32.50000000000002, 36.50000000000003, -50.00000000000044, 41.100000000000016, 45.7, 43.900000000000006, 29.69999999999998, 37.70000000000003, 43.50000000000001, 46.699999999999996, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 45.3, 43.50000000000001, -50.00000000000044, -50.00000000000044, 9.8999999999997, -50.00000000000044, 44.900000000000006, 46.9, 43.10000000000001, 45.1, 41.30000000000001, 43.7, -50.00000000000044, 32.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.900000000000034, -50.00000000000044, 38.50000000000003, 42.500000000000014, 47.5, 44.5, -50.00000000000044, 15.49999999999978, 45.5, -50.00000000000044, -50.00000000000044, 39.300000000000026, 43.30000000000001, -50.00000000000044, 18.499999999999822, -50.00000000000044, 18.699999999999825, -50.00000000000044, -50.00000000000044, 40.30000000000002, 47.3, 45.5, 3.699999999999612, 24.69999999999991], "episode_lengths": [40, 52, 500, 500, 500, 50, 500, 500, 28, 366, 48, 98, 24, 190, 46, 500, 442, 500, 92, 500, 500, 290, 500, 40, 32, 500, 500, 96, 70, 174, 500, 96, 500, 500, 26, 70, 30, 76, 500, 500, 96, 46, 62, 176, 136, 500, 90, 44, 62, 204, 124, 66, 34, 500, 500, 42, 500, 500, 48, 66, 500, 500, 402, 500, 52, 32, 70, 50, 88, 64, 500, 178, 500, 500, 500, 500, 132, 500, 116, 76, 26, 56, 500, 346, 46, 500, 500, 108, 68, 500, 316, 500, 314, 500, 500, 98, 28, 46, 464, 254]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40415054707326165, "mean_inference_ms": 1.2897263896383806, "mean_action_processing_ms": 0.15062591720278912, "mean_env_wait_ms": 0.09004829331384996, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02598428726196289, "StateBufferConnector_ms": 0.0070002079010009766, "ViewRequirementAgentConnector_ms": 0.13500738143920898}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.859999999999816, "episode_len_mean": 262.02, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.099999999999994, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 47.3, 13.499999999999751, 45.3, 40.30000000000002, 47.7, 31.1, 45.5, -50.00000000000044, 5.899999999999643, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044, 21.09999999999986, -50.00000000000044, 46.099999999999994, 46.9, -50.00000000000044, -50.00000000000044, 40.500000000000014, 43.10000000000001, 32.700000000000024, -50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, 47.5, 43.10000000000001, 47.1, 42.500000000000014, -50.00000000000044, -50.00000000000044, 40.500000000000014, 45.5, 43.900000000000006, 32.50000000000002, 36.50000000000003, -50.00000000000044, 41.100000000000016, 45.7, 43.900000000000006, 29.69999999999998, 37.70000000000003, 43.50000000000001, 46.699999999999996, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 45.3, 43.50000000000001, -50.00000000000044, -50.00000000000044, 9.8999999999997, -50.00000000000044, 44.900000000000006, 46.9, 43.10000000000001, 45.1, 41.30000000000001, 43.7, -50.00000000000044, 32.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.900000000000034, -50.00000000000044, 38.50000000000003, 42.500000000000014, 47.5, 44.5, -50.00000000000044, 15.49999999999978, 45.5, -50.00000000000044, -50.00000000000044, 39.300000000000026, 43.30000000000001, -50.00000000000044, 18.499999999999822, -50.00000000000044, 18.699999999999825, -50.00000000000044, -50.00000000000044, 40.30000000000002, 47.3, 45.5, 3.699999999999612, 24.69999999999991], "episode_lengths": [40, 52, 500, 500, 500, 50, 500, 500, 28, 366, 48, 98, 24, 190, 46, 500, 442, 500, 92, 500, 500, 290, 500, 40, 32, 500, 500, 96, 70, 174, 500, 96, 500, 500, 26, 70, 30, 76, 500, 500, 96, 46, 62, 176, 136, 500, 90, 44, 62, 204, 124, 66, 34, 500, 500, 42, 500, 500, 48, 66, 500, 500, 402, 500, 52, 32, 70, 50, 88, 64, 500, 178, 500, 500, 500, 500, 132, 500, 116, 76, 26, 56, 500, 346, 46, 500, 500, 108, 68, 500, 316, 500, 314, 500, 500, 98, 28, 46, 464, 254]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40415054707326165, "mean_inference_ms": 1.2897263896383806, "mean_action_processing_ms": 0.15062591720278912, "mean_env_wait_ms": 0.09004829331384996, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02598428726196289, "StateBufferConnector_ms": 0.0070002079010009766, "ViewRequirementAgentConnector_ms": 0.13500738143920898}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1404000, "num_agent_steps_trained": 1404000, "num_env_steps_sampled": 1404000, "num_env_steps_trained": 1404000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5347.5387606837485, "num_env_steps_trained_throughput_per_sec": 5347.5387606837485, "timesteps_total": 1404000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1404000, "timers": {"training_iteration_time_ms": 3309.197, "sample_time_ms": 2965.693, "load_time_ms": 16.7, "load_throughput": 1077856.265, "learn_time_ms": 315.009, "learn_throughput": 57141.311, "synch_weights_time_ms": 9.492}, "counters": {"num_env_steps_sampled": 1404000, "num_env_steps_trained": 1404000, "num_agent_steps_sampled": 1404000, "num_agent_steps_trained": 1404000}, "done": false, "episodes_total": 5495, "training_iteration": 78, "trial_id": "9f288_00020", "date": "2023-10-25_17-16-18", "timestamp": 1698250578, "time_this_iter_s": 3.37203311920166, "time_total_s": 267.5850009918213, "pid": 9936, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 267.5850009918213, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 61.5, "ram_util_percent": 26.959999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.617444900424223e-25, "cur_lr": 0.0003, "total_loss": 6.424096584320068, "policy_loss": -5.420745798835048e-05, "vf_loss": 6.424199846055773, "vf_explained_var": -9.669197930230034e-07, "kl": 9.572886961943065e-05, "entropy": 0.49142829908265007, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 2120.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 1422000, "num_env_steps_trained": 1422000, "num_agent_steps_sampled": 1422000, "num_agent_steps_trained": 1422000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.8949999999997977, "episode_len_mean": 276.62, "episode_media": {}, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.7, -50.00000000000044, 32.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.900000000000034, -50.00000000000044, 38.50000000000003, 42.500000000000014, 47.5, 44.5, -50.00000000000044, 15.49999999999978, 45.5, -50.00000000000044, -50.00000000000044, 39.300000000000026, 43.30000000000001, -50.00000000000044, 18.499999999999822, -50.00000000000044, 18.699999999999825, -50.00000000000044, -50.00000000000044, 40.30000000000002, 47.3, 45.5, 3.699999999999612, 24.69999999999991, -50.00000000000044, 30.29999999999999, -50.00000000000044, 43.50000000000001, 37.300000000000026, 1.8999999999995865, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 46.099999999999994, -50.00000000000044, 45.7, 45.1, 45.7, 45.9, 44.7, 38.700000000000024, 43.30000000000001, 38.300000000000026, 41.500000000000014, 42.30000000000001, -50.00000000000044, 44.900000000000006, 45.5, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, 30.499999999999993, -50.00000000000044, -50.00000000000044, 44.300000000000004, 44.5, 41.500000000000014, 45.7, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 47.5, -50.00000000000044, 45.9, 44.7, 45.5, -50.00000000000044, -50.00000000000044, 47.1, 45.5, -50.00000000000044, 33.500000000000036, -50.00000000000044, -50.00000000000044, 45.1, 47.1, 44.300000000000004, -50.00000000000044, -50.00000000000044, 24.69999999999991, -50.00000000000044, 34.900000000000034, -50.00000000000044], "episode_lengths": [64, 500, 178, 500, 500, 500, 500, 132, 500, 116, 76, 26, 56, 500, 346, 46, 500, 500, 108, 68, 500, 316, 500, 314, 500, 500, 98, 28, 46, 464, 254, 500, 198, 500, 66, 128, 482, 500, 500, 54, 500, 40, 500, 44, 50, 44, 42, 54, 114, 68, 118, 86, 78, 500, 52, 46, 500, 500, 42, 500, 500, 500, 142, 196, 500, 500, 58, 56, 86, 44, 500, 50, 500, 500, 500, 500, 500, 34, 26, 500, 42, 54, 46, 500, 500, 30, 46, 500, 166, 500, 500, 50, 30, 58, 500, 500, 254, 500, 152, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40487512459081043, "mean_inference_ms": 1.289616156833378, "mean_action_processing_ms": 0.15093004921713238, "mean_env_wait_ms": 0.09016504233866934, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.036002397537231445, "StateBufferConnector_ms": 0.0060002803802490234, "ViewRequirementAgentConnector_ms": 0.13002943992614746}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.8949999999997977, "episode_len_mean": 276.62, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.7, -50.00000000000044, 32.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.900000000000034, -50.00000000000044, 38.50000000000003, 42.500000000000014, 47.5, 44.5, -50.00000000000044, 15.49999999999978, 45.5, -50.00000000000044, -50.00000000000044, 39.300000000000026, 43.30000000000001, -50.00000000000044, 18.499999999999822, -50.00000000000044, 18.699999999999825, -50.00000000000044, -50.00000000000044, 40.30000000000002, 47.3, 45.5, 3.699999999999612, 24.69999999999991, -50.00000000000044, 30.29999999999999, -50.00000000000044, 43.50000000000001, 37.300000000000026, 1.8999999999995865, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 46.099999999999994, -50.00000000000044, 45.7, 45.1, 45.7, 45.9, 44.7, 38.700000000000024, 43.30000000000001, 38.300000000000026, 41.500000000000014, 42.30000000000001, -50.00000000000044, 44.900000000000006, 45.5, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, 30.499999999999993, -50.00000000000044, -50.00000000000044, 44.300000000000004, 44.5, 41.500000000000014, 45.7, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 47.5, -50.00000000000044, 45.9, 44.7, 45.5, -50.00000000000044, -50.00000000000044, 47.1, 45.5, -50.00000000000044, 33.500000000000036, -50.00000000000044, -50.00000000000044, 45.1, 47.1, 44.300000000000004, -50.00000000000044, -50.00000000000044, 24.69999999999991, -50.00000000000044, 34.900000000000034, -50.00000000000044], "episode_lengths": [64, 500, 178, 500, 500, 500, 500, 132, 500, 116, 76, 26, 56, 500, 346, 46, 500, 500, 108, 68, 500, 316, 500, 314, 500, 500, 98, 28, 46, 464, 254, 500, 198, 500, 66, 128, 482, 500, 500, 54, 500, 40, 500, 44, 50, 44, 42, 54, 114, 68, 118, 86, 78, 500, 52, 46, 500, 500, 42, 500, 500, 500, 142, 196, 500, 500, 58, 56, 86, 44, 500, 50, 500, 500, 500, 500, 500, 34, 26, 500, 42, 54, 46, 500, 500, 30, 46, 500, 166, 500, 500, 50, 30, 58, 500, 500, 254, 500, 152, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40487512459081043, "mean_inference_ms": 1.289616156833378, "mean_action_processing_ms": 0.15093004921713238, "mean_env_wait_ms": 0.09016504233866934, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.036002397537231445, "StateBufferConnector_ms": 0.0060002803802490234, "ViewRequirementAgentConnector_ms": 0.13002943992614746}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1422000, "num_agent_steps_trained": 1422000, "num_env_steps_sampled": 1422000, "num_env_steps_trained": 1422000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5621.479625958792, "num_env_steps_trained_throughput_per_sec": 5621.479625958792, "timesteps_total": 1422000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1422000, "timers": {"training_iteration_time_ms": 3300.301, "sample_time_ms": 2965.296, "load_time_ms": 16.5, "load_throughput": 1090929.836, "learn_time_ms": 306.708, "learn_throughput": 58687.669, "synch_weights_time_ms": 9.493}, "counters": {"num_env_steps_sampled": 1422000, "num_env_steps_trained": 1422000, "num_agent_steps_sampled": 1422000, "num_agent_steps_trained": 1422000}, "done": false, "episodes_total": 5564, "training_iteration": 79, "trial_id": "9f288_00020", "date": "2023-10-25_17-16-21", "timestamp": 1698250581, "time_this_iter_s": 3.2079994678497314, "time_total_s": 270.793000459671, "pid": 9936, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 270.793000459671, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 62.839999999999996, "ram_util_percent": 27.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.3087224502121113e-25, "cur_lr": 0.0003, "total_loss": 6.521053137602629, "policy_loss": -9.691494482534904e-05, "vf_loss": 6.521196135768184, "vf_explained_var": -9.757501107675058e-07, "kl": 0.00039896264710221816, "entropy": 0.461400118139055, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 2147.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 1440000, "num_env_steps_trained": 1440000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.6520000000002049, "episode_len_mean": 277.06, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.500000000000014, 45.7, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 47.5, -50.00000000000044, 45.9, 44.7, 45.5, -50.00000000000044, -50.00000000000044, 47.1, 45.5, -50.00000000000044, 33.500000000000036, -50.00000000000044, -50.00000000000044, 45.1, 47.1, 44.300000000000004, -50.00000000000044, -50.00000000000044, 24.69999999999991, -50.00000000000044, 34.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 46.5, 40.70000000000002, 44.900000000000006, 43.900000000000006, 44.10000000000001, 42.900000000000006, 34.10000000000004, -50.00000000000044, 43.50000000000001, 17.69999999999981, 42.900000000000006, -50.00000000000044, 41.500000000000014, -50.00000000000044, 27.899999999999956, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 34.900000000000034, 44.5, 42.70000000000001, -50.00000000000044, 45.7, 39.10000000000002, -50.00000000000044, 43.7, 45.9, -50.00000000000044, 46.699999999999996, 46.5, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 14.09999999999976, 47.5, 40.10000000000002, 37.50000000000003, 40.90000000000002, -50.00000000000044, 43.30000000000001, -50.00000000000044, 37.10000000000003, -50.00000000000044, 43.50000000000001, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 41.30000000000001, 31.900000000000013, -50.00000000000044, -50.00000000000044], "episode_lengths": [86, 44, 500, 50, 500, 500, 500, 500, 500, 34, 26, 500, 42, 54, 46, 500, 500, 30, 46, 500, 166, 500, 500, 50, 30, 58, 500, 500, 254, 500, 152, 500, 500, 500, 500, 74, 500, 500, 36, 94, 52, 62, 60, 72, 160, 500, 66, 324, 72, 500, 86, 500, 222, 500, 500, 500, 30, 152, 56, 74, 500, 44, 110, 500, 64, 42, 500, 34, 36, 500, 500, 58, 500, 500, 34, 500, 360, 26, 100, 126, 92, 500, 68, 500, 130, 500, 66, 38, 500, 500, 500, 70, 500, 500, 78, 500, 88, 182, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4040522753643203, "mean_inference_ms": 1.2888240740093522, "mean_action_processing_ms": 0.15062406537881745, "mean_env_wait_ms": 0.09010484319253856, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.036997079849243164, "StateBufferConnector_ms": 0.007002830505371094, "ViewRequirementAgentConnector_ms": 0.13199806213378906}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.6520000000002049, "episode_len_mean": 277.06, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [41.500000000000014, 45.7, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 47.5, -50.00000000000044, 45.9, 44.7, 45.5, -50.00000000000044, -50.00000000000044, 47.1, 45.5, -50.00000000000044, 33.500000000000036, -50.00000000000044, -50.00000000000044, 45.1, 47.1, 44.300000000000004, -50.00000000000044, -50.00000000000044, 24.69999999999991, -50.00000000000044, 34.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 46.5, 40.70000000000002, 44.900000000000006, 43.900000000000006, 44.10000000000001, 42.900000000000006, 34.10000000000004, -50.00000000000044, 43.50000000000001, 17.69999999999981, 42.900000000000006, -50.00000000000044, 41.500000000000014, -50.00000000000044, 27.899999999999956, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 34.900000000000034, 44.5, 42.70000000000001, -50.00000000000044, 45.7, 39.10000000000002, -50.00000000000044, 43.7, 45.9, -50.00000000000044, 46.699999999999996, 46.5, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 14.09999999999976, 47.5, 40.10000000000002, 37.50000000000003, 40.90000000000002, -50.00000000000044, 43.30000000000001, -50.00000000000044, 37.10000000000003, -50.00000000000044, 43.50000000000001, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 41.30000000000001, 31.900000000000013, -50.00000000000044, -50.00000000000044], "episode_lengths": [86, 44, 500, 50, 500, 500, 500, 500, 500, 34, 26, 500, 42, 54, 46, 500, 500, 30, 46, 500, 166, 500, 500, 50, 30, 58, 500, 500, 254, 500, 152, 500, 500, 500, 500, 74, 500, 500, 36, 94, 52, 62, 60, 72, 160, 500, 66, 324, 72, 500, 86, 500, 222, 500, 500, 500, 30, 152, 56, 74, 500, 44, 110, 500, 64, 42, 500, 34, 36, 500, 500, 58, 500, 500, 34, 500, 360, 26, 100, 126, 92, 500, 68, 500, 130, 500, 66, 38, 500, 500, 500, 70, 500, 500, 78, 500, 88, 182, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4040522753643203, "mean_inference_ms": 1.2888240740093522, "mean_action_processing_ms": 0.15062406537881745, "mean_env_wait_ms": 0.09010484319253856, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.036997079849243164, "StateBufferConnector_ms": 0.007002830505371094, "ViewRequirementAgentConnector_ms": 0.13199806213378906}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000, "num_env_steps_sampled": 1440000, "num_env_steps_trained": 1440000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5397.301673441162, "num_env_steps_trained_throughput_per_sec": 5397.301673441162, "timesteps_total": 1440000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1440000, "timers": {"training_iteration_time_ms": 3291.101, "sample_time_ms": 2962.896, "load_time_ms": 16.5, "load_throughput": 1090918.801, "learn_time_ms": 299.908, "learn_throughput": 60018.316, "synch_weights_time_ms": 9.393}, "counters": {"num_env_steps_sampled": 1440000, "num_env_steps_trained": 1440000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "done": false, "episodes_total": 5632, "training_iteration": 80, "trial_id": "9f288_00020", "date": "2023-10-25_17-16-24", "timestamp": 1698250584, "time_this_iter_s": 3.339999198913574, "time_total_s": 274.1329996585846, "pid": 9936, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 274.1329996585846, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 70.17500000000001, "ram_util_percent": 27.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.6543612251060557e-25, "cur_lr": 0.0003, "total_loss": 6.680365703724049, "policy_loss": -6.374840935071309e-05, "vf_loss": 6.680482811397976, "vf_explained_var": -1.0331471761067708e-06, "kl": 0.00018918772927818323, "entropy": 0.5341020204402782, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 2174.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 1458000, "num_env_steps_trained": 1458000, "num_agent_steps_sampled": 1458000, "num_agent_steps_trained": 1458000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.7489999999998105, "episode_len_mean": 268.12, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.5, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 14.09999999999976, 47.5, 40.10000000000002, 37.50000000000003, 40.90000000000002, -50.00000000000044, 43.30000000000001, -50.00000000000044, 37.10000000000003, -50.00000000000044, 43.50000000000001, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 41.30000000000001, 31.900000000000013, -50.00000000000044, -50.00000000000044, 44.7, 25.499999999999922, -50.00000000000044, 29.299999999999976, 12.69999999999974, -50.00000000000044, 44.900000000000006, 43.7, -50.00000000000044, 44.7, 39.90000000000002, 45.9, 38.10000000000002, 45.5, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, 44.300000000000004, 46.9, 44.10000000000001, -50.00000000000044, 31.70000000000001, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 5.899999999999643, -50.00000000000044, 45.9, 42.10000000000001, 42.900000000000006, 39.300000000000026, 10.299999999999706, 15.699999999999783, 47.1, -50.00000000000044, 40.30000000000002, 47.5, -50.00000000000044, 27.49999999999995, 46.3, 44.5, -50.00000000000044, -50.00000000000044, 41.90000000000001, 41.70000000000002, 45.5, 14.09999999999976, -50.00000000000044, 44.5, 39.70000000000002, 35.500000000000036, 31.70000000000001, 42.500000000000014, 36.30000000000003, -50.00000000000044, 45.9, -50.00000000000044, 3.899999999999615, -50.00000000000044, 43.30000000000001, 45.3, -50.00000000000044, -50.00000000000044], "episode_lengths": [36, 500, 500, 58, 500, 500, 34, 500, 360, 26, 100, 126, 92, 500, 68, 500, 130, 500, 66, 38, 500, 500, 500, 70, 500, 500, 78, 500, 88, 182, 500, 500, 54, 246, 500, 208, 374, 500, 52, 64, 500, 54, 102, 42, 120, 46, 76, 500, 500, 500, 500, 86, 500, 58, 32, 60, 500, 184, 500, 500, 46, 500, 442, 500, 42, 80, 72, 108, 398, 344, 30, 500, 98, 26, 500, 226, 38, 56, 500, 500, 82, 84, 46, 360, 500, 56, 104, 146, 184, 76, 138, 500, 42, 500, 462, 500, 68, 48, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40392497600506305, "mean_inference_ms": 1.2889989162988251, "mean_action_processing_ms": 0.15060319451754625, "mean_env_wait_ms": 0.09005746631960519, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02399444580078125, "StateBufferConnector_ms": 0.004000186920166016, "ViewRequirementAgentConnector_ms": 0.11899566650390625}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.7489999999998105, "episode_len_mean": 268.12, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.5, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 14.09999999999976, 47.5, 40.10000000000002, 37.50000000000003, 40.90000000000002, -50.00000000000044, 43.30000000000001, -50.00000000000044, 37.10000000000003, -50.00000000000044, 43.50000000000001, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 41.30000000000001, 31.900000000000013, -50.00000000000044, -50.00000000000044, 44.7, 25.499999999999922, -50.00000000000044, 29.299999999999976, 12.69999999999974, -50.00000000000044, 44.900000000000006, 43.7, -50.00000000000044, 44.7, 39.90000000000002, 45.9, 38.10000000000002, 45.5, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, 44.300000000000004, 46.9, 44.10000000000001, -50.00000000000044, 31.70000000000001, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 5.899999999999643, -50.00000000000044, 45.9, 42.10000000000001, 42.900000000000006, 39.300000000000026, 10.299999999999706, 15.699999999999783, 47.1, -50.00000000000044, 40.30000000000002, 47.5, -50.00000000000044, 27.49999999999995, 46.3, 44.5, -50.00000000000044, -50.00000000000044, 41.90000000000001, 41.70000000000002, 45.5, 14.09999999999976, -50.00000000000044, 44.5, 39.70000000000002, 35.500000000000036, 31.70000000000001, 42.500000000000014, 36.30000000000003, -50.00000000000044, 45.9, -50.00000000000044, 3.899999999999615, -50.00000000000044, 43.30000000000001, 45.3, -50.00000000000044, -50.00000000000044], "episode_lengths": [36, 500, 500, 58, 500, 500, 34, 500, 360, 26, 100, 126, 92, 500, 68, 500, 130, 500, 66, 38, 500, 500, 500, 70, 500, 500, 78, 500, 88, 182, 500, 500, 54, 246, 500, 208, 374, 500, 52, 64, 500, 54, 102, 42, 120, 46, 76, 500, 500, 500, 500, 86, 500, 58, 32, 60, 500, 184, 500, 500, 46, 500, 442, 500, 42, 80, 72, 108, 398, 344, 30, 500, 98, 26, 500, 226, 38, 56, 500, 500, 82, 84, 46, 360, 500, 56, 104, 146, 184, 76, 138, 500, 42, 500, 462, 500, 68, 48, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40392497600506305, "mean_inference_ms": 1.2889989162988251, "mean_action_processing_ms": 0.15060319451754625, "mean_env_wait_ms": 0.09005746631960519, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02399444580078125, "StateBufferConnector_ms": 0.004000186920166016, "ViewRequirementAgentConnector_ms": 0.11899566650390625}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1458000, "num_agent_steps_trained": 1458000, "num_env_steps_sampled": 1458000, "num_env_steps_trained": 1458000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5442.140968136676, "num_env_steps_trained_throughput_per_sec": 5442.140968136676, "timesteps_total": 1458000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1458000, "timers": {"training_iteration_time_ms": 3299.253, "sample_time_ms": 2963.348, "load_time_ms": 16.7, "load_throughput": 1077862.42, "learn_time_ms": 307.511, "learn_throughput": 58534.401, "synch_weights_time_ms": 9.29}, "counters": {"num_env_steps_sampled": 1458000, "num_env_steps_trained": 1458000, "num_agent_steps_sampled": 1458000, "num_agent_steps_trained": 1458000}, "done": false, "episodes_total": 5700, "training_iteration": 81, "trial_id": "9f288_00020", "date": "2023-10-25_17-16-28", "timestamp": 1698250588, "time_this_iter_s": 3.3125216960906982, "time_total_s": 277.4455213546753, "pid": 9936, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 277.4455213546753, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 60.2, "ram_util_percent": 27.02}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.271806125530278e-26, "cur_lr": 0.0003, "total_loss": 6.6032650382430464, "policy_loss": -0.0007251534369532708, "vf_loss": 6.604041805973759, "vf_explained_var": -9.492591575339988e-07, "kl": 0.0009994805722399747, "entropy": 0.5176234742005666, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 2201.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 1476000, "num_env_steps_trained": 1476000, "num_agent_steps_sampled": 1476000, "num_agent_steps_trained": 1476000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.368999999999818, "episode_len_mean": 261.94, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.9, 42.10000000000001, 42.900000000000006, 39.300000000000026, 10.299999999999706, 15.699999999999783, 47.1, -50.00000000000044, 40.30000000000002, 47.5, -50.00000000000044, 27.49999999999995, 46.3, 44.5, -50.00000000000044, -50.00000000000044, 41.90000000000001, 41.70000000000002, 45.5, 14.09999999999976, -50.00000000000044, 44.5, 39.70000000000002, 35.500000000000036, 31.70000000000001, 42.500000000000014, 36.30000000000003, -50.00000000000044, 45.9, -50.00000000000044, 3.899999999999615, -50.00000000000044, 43.30000000000001, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, 39.90000000000002, 41.100000000000016, 46.3, -50.00000000000044, 45.3, -50.00000000000044, 42.500000000000014, 45.1, 32.100000000000016, 44.7, 42.30000000000001, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 43.50000000000001, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 44.7, -50.00000000000044, 6.099999999999646, 45.3, 37.90000000000003, 44.10000000000001, 28.29999999999996, -50.00000000000044, -50.00000000000044, 45.7, 35.10000000000004, 27.49999999999995, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, -50.00000000000044, 39.300000000000026, 45.5, 33.70000000000004, 26.89999999999994, 7.699999999999669, 44.5, 40.30000000000002, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 15.899999999999785, 46.3, -50.00000000000044], "episode_lengths": [42, 80, 72, 108, 398, 344, 30, 500, 98, 26, 500, 226, 38, 56, 500, 500, 82, 84, 46, 360, 500, 56, 104, 146, 184, 76, 138, 500, 42, 500, 462, 500, 68, 48, 500, 500, 500, 112, 102, 90, 38, 500, 48, 500, 76, 50, 180, 54, 78, 58, 500, 500, 500, 500, 44, 58, 500, 500, 500, 82, 500, 66, 50, 500, 500, 500, 54, 54, 500, 440, 48, 122, 60, 218, 500, 500, 44, 150, 226, 500, 500, 500, 500, 112, 500, 108, 46, 164, 232, 424, 56, 98, 500, 500, 58, 500, 500, 342, 38, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40372092857844455, "mean_inference_ms": 1.2884986867395594, "mean_action_processing_ms": 0.15056137403653508, "mean_env_wait_ms": 0.08999483209962922, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026000022888183594, "StateBufferConnector_ms": 0.0029993057250976562, "ViewRequirementAgentConnector_ms": 0.13201904296875}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.368999999999818, "episode_len_mean": 261.94, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.9, 42.10000000000001, 42.900000000000006, 39.300000000000026, 10.299999999999706, 15.699999999999783, 47.1, -50.00000000000044, 40.30000000000002, 47.5, -50.00000000000044, 27.49999999999995, 46.3, 44.5, -50.00000000000044, -50.00000000000044, 41.90000000000001, 41.70000000000002, 45.5, 14.09999999999976, -50.00000000000044, 44.5, 39.70000000000002, 35.500000000000036, 31.70000000000001, 42.500000000000014, 36.30000000000003, -50.00000000000044, 45.9, -50.00000000000044, 3.899999999999615, -50.00000000000044, 43.30000000000001, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, 39.90000000000002, 41.100000000000016, 46.3, -50.00000000000044, 45.3, -50.00000000000044, 42.500000000000014, 45.1, 32.100000000000016, 44.7, 42.30000000000001, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 43.50000000000001, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 44.7, -50.00000000000044, 6.099999999999646, 45.3, 37.90000000000003, 44.10000000000001, 28.29999999999996, -50.00000000000044, -50.00000000000044, 45.7, 35.10000000000004, 27.49999999999995, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, -50.00000000000044, 39.300000000000026, 45.5, 33.70000000000004, 26.89999999999994, 7.699999999999669, 44.5, 40.30000000000002, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 15.899999999999785, 46.3, -50.00000000000044], "episode_lengths": [42, 80, 72, 108, 398, 344, 30, 500, 98, 26, 500, 226, 38, 56, 500, 500, 82, 84, 46, 360, 500, 56, 104, 146, 184, 76, 138, 500, 42, 500, 462, 500, 68, 48, 500, 500, 500, 112, 102, 90, 38, 500, 48, 500, 76, 50, 180, 54, 78, 58, 500, 500, 500, 500, 44, 58, 500, 500, 500, 82, 500, 66, 50, 500, 500, 500, 54, 54, 500, 440, 48, 122, 60, 218, 500, 500, 44, 150, 226, 500, 500, 500, 500, 112, 500, 108, 46, 164, 232, 424, 56, 98, 500, 500, 58, 500, 500, 342, 38, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40372092857844455, "mean_inference_ms": 1.2884986867395594, "mean_action_processing_ms": 0.15056137403653508, "mean_env_wait_ms": 0.08999483209962922, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026000022888183594, "StateBufferConnector_ms": 0.0029993057250976562, "ViewRequirementAgentConnector_ms": 0.13201904296875}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1476000, "num_agent_steps_trained": 1476000, "num_env_steps_sampled": 1476000, "num_env_steps_trained": 1476000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5330.172682197403, "num_env_steps_trained_throughput_per_sec": 5330.172682197403, "timesteps_total": 1476000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1476000, "timers": {"training_iteration_time_ms": 3301.752, "sample_time_ms": 2965.548, "load_time_ms": 16.503, "load_throughput": 1090720.217, "learn_time_ms": 307.909, "learn_throughput": 58458.91, "synch_weights_time_ms": 9.289}, "counters": {"num_env_steps_sampled": 1476000, "num_env_steps_trained": 1476000, "num_agent_steps_sampled": 1476000, "num_agent_steps_trained": 1476000}, "done": false, "episodes_total": 5764, "training_iteration": 82, "trial_id": "9f288_00020", "date": "2023-10-25_17-16-31", "timestamp": 1698250591, "time_this_iter_s": 3.382999897003174, "time_total_s": 280.82852125167847, "pid": 9936, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 280.82852125167847, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 55.18000000000001, "ram_util_percent": 27.02}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.135903062765139e-26, "cur_lr": 0.0003, "total_loss": 6.570200849462439, "policy_loss": -0.0005957553232157672, "vf_loss": 6.570844456001565, "vf_explained_var": -1.0199016994900173e-06, "kl": 0.0007874678888886896, "entropy": 0.47891373104519314, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 2228.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 1494000, "num_env_steps_trained": 1494000, "num_agent_steps_sampled": 1494000, "num_agent_steps_trained": 1494000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.4469999999998004, "episode_len_mean": 281.12, "episode_media": {}, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.7, 44.7, -50.00000000000044, 6.099999999999646, 45.3, 37.90000000000003, 44.10000000000001, 28.29999999999996, -50.00000000000044, -50.00000000000044, 45.7, 35.10000000000004, 27.49999999999995, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, -50.00000000000044, 39.300000000000026, 45.5, 33.70000000000004, 26.89999999999994, 7.699999999999669, 44.5, 40.30000000000002, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 15.899999999999785, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.69999999999998, 46.5, -50.00000000000044, 41.90000000000001, 31.300000000000004, -50.00000000000044, -50.00000000000044, 36.30000000000003, 43.10000000000001, 37.90000000000003, 46.099999999999994, -50.00000000000044, 28.89999999999997, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.70000000000003, 46.5, 45.9, 44.10000000000001, 46.3, 45.1, 34.70000000000004, 43.10000000000001, -50.00000000000044, 5.6999999999996405, 44.5, 37.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 44.5, 38.700000000000024, 45.3, 5.499999999999638, 18.099999999999817, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 43.50000000000001, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.30000000000004, 45.7, -50.00000000000044, 44.7, -50.00000000000044, 1.6999999999995836, 45.9, 46.3, 40.30000000000002, 43.30000000000001, -50.00000000000044], "episode_lengths": [54, 54, 500, 440, 48, 122, 60, 218, 500, 500, 44, 150, 226, 500, 500, 500, 500, 112, 500, 108, 46, 164, 232, 424, 56, 98, 500, 500, 58, 500, 500, 342, 38, 500, 500, 500, 500, 204, 36, 500, 82, 188, 500, 500, 138, 70, 122, 40, 500, 212, 54, 500, 500, 500, 500, 134, 36, 42, 60, 38, 50, 154, 70, 500, 444, 56, 128, 500, 500, 500, 56, 56, 114, 48, 446, 320, 500, 500, 500, 500, 500, 40, 500, 66, 28, 500, 500, 500, 500, 158, 44, 500, 54, 500, 484, 42, 38, 98, 68, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4034299667641826, "mean_inference_ms": 1.2864941197355009, "mean_action_processing_ms": 0.15024620437968028, "mean_env_wait_ms": 0.0897666688742774, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03400897979736328, "StateBufferConnector_ms": 0.0070002079010009766, "ViewRequirementAgentConnector_ms": 0.1299879550933838}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.4469999999998004, "episode_len_mean": 281.12, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.7, 44.7, -50.00000000000044, 6.099999999999646, 45.3, 37.90000000000003, 44.10000000000001, 28.29999999999996, -50.00000000000044, -50.00000000000044, 45.7, 35.10000000000004, 27.49999999999995, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, -50.00000000000044, 39.300000000000026, 45.5, 33.70000000000004, 26.89999999999994, 7.699999999999669, 44.5, 40.30000000000002, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 15.899999999999785, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.69999999999998, 46.5, -50.00000000000044, 41.90000000000001, 31.300000000000004, -50.00000000000044, -50.00000000000044, 36.30000000000003, 43.10000000000001, 37.90000000000003, 46.099999999999994, -50.00000000000044, 28.89999999999997, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.70000000000003, 46.5, 45.9, 44.10000000000001, 46.3, 45.1, 34.70000000000004, 43.10000000000001, -50.00000000000044, 5.6999999999996405, 44.5, 37.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 44.5, 38.700000000000024, 45.3, 5.499999999999638, 18.099999999999817, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 43.50000000000001, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.30000000000004, 45.7, -50.00000000000044, 44.7, -50.00000000000044, 1.6999999999995836, 45.9, 46.3, 40.30000000000002, 43.30000000000001, -50.00000000000044], "episode_lengths": [54, 54, 500, 440, 48, 122, 60, 218, 500, 500, 44, 150, 226, 500, 500, 500, 500, 112, 500, 108, 46, 164, 232, 424, 56, 98, 500, 500, 58, 500, 500, 342, 38, 500, 500, 500, 500, 204, 36, 500, 82, 188, 500, 500, 138, 70, 122, 40, 500, 212, 54, 500, 500, 500, 500, 134, 36, 42, 60, 38, 50, 154, 70, 500, 444, 56, 128, 500, 500, 500, 56, 56, 114, 48, 446, 320, 500, 500, 500, 500, 500, 40, 500, 66, 28, 500, 500, 500, 500, 158, 44, 500, 54, 500, 484, 42, 38, 98, 68, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4034299667641826, "mean_inference_ms": 1.2864941197355009, "mean_action_processing_ms": 0.15024620437968028, "mean_env_wait_ms": 0.0897666688742774, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03400897979736328, "StateBufferConnector_ms": 0.0070002079010009766, "ViewRequirementAgentConnector_ms": 0.1299879550933838}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1494000, "num_agent_steps_trained": 1494000, "num_env_steps_sampled": 1494000, "num_env_steps_trained": 1494000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5574.595532938102, "num_env_steps_trained_throughput_per_sec": 5574.595532938102, "timesteps_total": 1494000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1494000, "timers": {"training_iteration_time_ms": 3306.945, "sample_time_ms": 2963.648, "load_time_ms": 17.206, "load_throughput": 1046168.36, "learn_time_ms": 314.399, "learn_throughput": 57252.151, "synch_weights_time_ms": 9.289}, "counters": {"num_env_steps_sampled": 1494000, "num_env_steps_trained": 1494000, "num_agent_steps_sampled": 1494000, "num_agent_steps_trained": 1494000}, "done": false, "episodes_total": 5830, "training_iteration": 83, "trial_id": "9f288_00020", "date": "2023-10-25_17-16-34", "timestamp": 1698250594, "time_this_iter_s": 3.2359306812286377, "time_total_s": 284.0644519329071, "pid": 9936, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 284.0644519329071, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 67.4, "ram_util_percent": 27.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.0679515313825696e-26, "cur_lr": 0.0003, "total_loss": 6.871918007179543, "policy_loss": -0.00030101973701406406, "vf_loss": 6.8722708666766135, "vf_explained_var": -1.0463926527235244e-06, "kl": 0.0006425832783723654, "entropy": 0.5183145403862, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 2255.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 1512000, "num_env_steps_trained": 1512000, "num_agent_steps_sampled": 1512000, "num_agent_steps_trained": 1512000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.953999999999843, "episode_len_mean": 231.14, "episode_media": {}, "episodes_this_iter": 81, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.099999999999994, -50.00000000000044, 43.50000000000001, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.30000000000004, 45.7, -50.00000000000044, 44.7, -50.00000000000044, 1.6999999999995836, 45.9, 46.3, 40.30000000000002, 43.30000000000001, -50.00000000000044, 24.299999999999905, -50.00000000000044, 7.299999999999663, 46.9, 46.9, 45.5, -50.00000000000044, 42.70000000000001, -50.00000000000044, 35.900000000000034, -50.00000000000044, -50.00000000000044, 46.3, 46.9, 46.099999999999994, -50.00000000000044, 46.5, 46.9, 43.7, 46.5, 45.5, 40.90000000000002, -50.00000000000044, 42.900000000000006, 44.7, 45.9, -50.00000000000044, 29.299999999999976, 44.5, -50.00000000000044, 44.10000000000001, 32.50000000000002, -50.00000000000044, 46.099999999999994, 43.900000000000006, 44.10000000000001, 46.5, 6.699999999999655, 46.3, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, 45.5, 41.30000000000001, 33.70000000000004, 41.90000000000001, -50.00000000000044, 9.299999999999692, 42.500000000000014, 39.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 46.9, -50.00000000000044, -50.00000000000044, 45.1, 23.499999999999893, 40.70000000000002, 16.8999999999998, 46.699999999999996, 39.300000000000026, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 35.70000000000003, 46.5, -50.00000000000044, 40.30000000000002, 45.9, 34.30000000000004, 44.10000000000001, 26.499999999999936, 47.1, 45.3, 34.30000000000004, 40.500000000000014], "episode_lengths": [40, 500, 66, 28, 500, 500, 500, 500, 158, 44, 500, 54, 500, 484, 42, 38, 98, 68, 500, 258, 500, 428, 32, 32, 46, 500, 74, 500, 142, 500, 500, 38, 32, 40, 500, 36, 32, 64, 36, 46, 92, 500, 72, 54, 42, 500, 208, 56, 500, 60, 176, 500, 40, 62, 60, 36, 434, 38, 500, 500, 118, 500, 500, 46, 88, 164, 82, 500, 408, 76, 106, 500, 500, 500, 70, 32, 500, 500, 50, 266, 94, 332, 34, 108, 500, 500, 48, 500, 144, 36, 500, 98, 42, 158, 60, 236, 30, 48, 158, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4032828806428473, "mean_inference_ms": 1.285709074037684, "mean_action_processing_ms": 0.14984758228867615, "mean_env_wait_ms": 0.08956934556407367, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030004024505615234, "StateBufferConnector_ms": 0.00400090217590332, "ViewRequirementAgentConnector_ms": 0.12102079391479492}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.953999999999843, "episode_len_mean": 231.14, "episodes_this_iter": 81, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.099999999999994, -50.00000000000044, 43.50000000000001, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.30000000000004, 45.7, -50.00000000000044, 44.7, -50.00000000000044, 1.6999999999995836, 45.9, 46.3, 40.30000000000002, 43.30000000000001, -50.00000000000044, 24.299999999999905, -50.00000000000044, 7.299999999999663, 46.9, 46.9, 45.5, -50.00000000000044, 42.70000000000001, -50.00000000000044, 35.900000000000034, -50.00000000000044, -50.00000000000044, 46.3, 46.9, 46.099999999999994, -50.00000000000044, 46.5, 46.9, 43.7, 46.5, 45.5, 40.90000000000002, -50.00000000000044, 42.900000000000006, 44.7, 45.9, -50.00000000000044, 29.299999999999976, 44.5, -50.00000000000044, 44.10000000000001, 32.50000000000002, -50.00000000000044, 46.099999999999994, 43.900000000000006, 44.10000000000001, 46.5, 6.699999999999655, 46.3, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, 45.5, 41.30000000000001, 33.70000000000004, 41.90000000000001, -50.00000000000044, 9.299999999999692, 42.500000000000014, 39.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 46.9, -50.00000000000044, -50.00000000000044, 45.1, 23.499999999999893, 40.70000000000002, 16.8999999999998, 46.699999999999996, 39.300000000000026, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 35.70000000000003, 46.5, -50.00000000000044, 40.30000000000002, 45.9, 34.30000000000004, 44.10000000000001, 26.499999999999936, 47.1, 45.3, 34.30000000000004, 40.500000000000014], "episode_lengths": [40, 500, 66, 28, 500, 500, 500, 500, 158, 44, 500, 54, 500, 484, 42, 38, 98, 68, 500, 258, 500, 428, 32, 32, 46, 500, 74, 500, 142, 500, 500, 38, 32, 40, 500, 36, 32, 64, 36, 46, 92, 500, 72, 54, 42, 500, 208, 56, 500, 60, 176, 500, 40, 62, 60, 36, 434, 38, 500, 500, 118, 500, 500, 46, 88, 164, 82, 500, 408, 76, 106, 500, 500, 500, 70, 32, 500, 500, 50, 266, 94, 332, 34, 108, 500, 500, 48, 500, 144, 36, 500, 98, 42, 158, 60, 236, 30, 48, 158, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4032828806428473, "mean_inference_ms": 1.285709074037684, "mean_action_processing_ms": 0.14984758228867615, "mean_env_wait_ms": 0.08956934556407367, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030004024505615234, "StateBufferConnector_ms": 0.00400090217590332, "ViewRequirementAgentConnector_ms": 0.12102079391479492}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1512000, "num_agent_steps_trained": 1512000, "num_env_steps_sampled": 1512000, "num_env_steps_trained": 1512000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5696.200228066896, "num_env_steps_trained_throughput_per_sec": 5696.200228066896, "timesteps_total": 1512000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1512000, "timers": {"training_iteration_time_ms": 3300.345, "sample_time_ms": 2946.851, "load_time_ms": 17.509, "load_throughput": 1028060.482, "learn_time_ms": 324.396, "learn_throughput": 55487.784, "synch_weights_time_ms": 9.29}, "counters": {"num_env_steps_sampled": 1512000, "num_env_steps_trained": 1512000, "num_agent_steps_sampled": 1512000, "num_agent_steps_trained": 1512000}, "done": true, "episodes_total": 5911, "training_iteration": 84, "trial_id": "9f288_00020", "date": "2023-10-25_17-16-38", "timestamp": 1698250598, "time_this_iter_s": 3.16499924659729, "time_total_s": 287.2294511795044, "pid": 9936, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 287.2294511795044, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 57.48, "ram_util_percent": 27.0}}
