{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0003, "total_loss": 9.373546679814657, "policy_loss": 0.045657154793540634, "vf_loss": 9.327254295349121, "vf_explained_var": 0.0001284132401148478, "kl": 0.003539400919401419, "entropy": 0.7271404067675272, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 6.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 18000, "num_env_steps_trained": 18000, "num_agent_steps_sampled": 18000, "num_agent_steps_trained": 18000}, "sampler_results": {"episode_reward_max": 44.900000000000006, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -18.18571428571459, "episode_len_mean": 396.57142857142856, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 17.299999999999805, 8.099999999999675, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.699999999999896, 30.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.499999999999908, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.499999999999837, -50.00000000000044, 36.30000000000003, -50.00000000000044, 22.49999999999988, 7.09999999999966, -50.00000000000044, 44.900000000000006, 0.8999999999995723, 23.499999999999893, 5.099999999999632, 39.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.499999999999964, 30.099999999999987, -50.00000000000044, 32.50000000000002, 41.500000000000014, -50.00000000000044], "episode_lengths": [500, 500, 328, 420, 500, 500, 500, 264, 192, 500, 500, 500, 500, 500, 500, 256, 500, 500, 500, 306, 500, 138, 500, 276, 430, 500, 52, 492, 266, 450, 108, 500, 500, 500, 500, 500, 216, 200, 500, 176, 86, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36863479164665464, "mean_inference_ms": 1.176927969436885, "mean_action_processing_ms": 0.13783985102359333, "mean_env_wait_ms": 0.08452795607831658, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02859376725696382, "StateBufferConnector_ms": 0.007142907097226097, "ViewRequirementAgentConnector_ms": 0.14762367521013534}}, "episode_reward_max": 44.900000000000006, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -18.18571428571459, "episode_len_mean": 396.57142857142856, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 17.299999999999805, 8.099999999999675, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.699999999999896, 30.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.499999999999908, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.499999999999837, -50.00000000000044, 36.30000000000003, -50.00000000000044, 22.49999999999988, 7.09999999999966, -50.00000000000044, 44.900000000000006, 0.8999999999995723, 23.499999999999893, 5.099999999999632, 39.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.499999999999964, 30.099999999999987, -50.00000000000044, 32.50000000000002, 41.500000000000014, -50.00000000000044], "episode_lengths": [500, 500, 328, 420, 500, 500, 500, 264, 192, 500, 500, 500, 500, 500, 500, 256, 500, 500, 500, 306, 500, 138, 500, 276, 430, 500, 52, 492, 266, 450, 108, 500, 500, 500, 500, 500, 216, 200, 500, 176, 86, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36863479164665464, "mean_inference_ms": 1.176927969436885, "mean_action_processing_ms": 0.13783985102359333, "mean_env_wait_ms": 0.08452795607831658, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02859376725696382, "StateBufferConnector_ms": 0.007142907097226097, "ViewRequirementAgentConnector_ms": 0.14762367521013534}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18000, "num_agent_steps_trained": 18000, "num_env_steps_sampled": 18000, "num_env_steps_trained": 18000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 6197.904824577822, "num_env_steps_trained_throughput_per_sec": 6197.904824577822, "timesteps_total": 18000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 18000, "timers": {"training_iteration_time_ms": 2904.207, "sample_time_ms": 2792.094, "load_time_ms": 11.047, "load_throughput": 1629348.066, "learn_time_ms": 87.182, "learn_throughput": 206464.531, "synch_weights_time_ms": 10.881}, "counters": {"num_env_steps_sampled": 18000, "num_env_steps_trained": 18000, "num_agent_steps_sampled": 18000, "num_agent_steps_trained": 18000}, "done": false, "episodes_total": 42, "training_iteration": 1, "trial_id": "9f288_00014", "date": "2023-10-25_16-41-56", "timestamp": 1698248516, "time_this_iter_s": 2.909198760986328, "time_total_s": 2.909198760986328, "pid": 9504, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 2.909198760986328, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 60.5, "ram_util_percent": 27.24}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0003, "total_loss": 9.127614180246988, "policy_loss": -0.05390806713451942, "vf_loss": 9.181559085845947, "vf_explained_var": 0.00010744730631510417, "kl": 0.00032083398559734633, "entropy": 0.6895863165458044, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 18.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "sampler_results": {"episode_reward_max": 44.900000000000006, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -9.670652173913302, "episode_len_mean": 363.54347826086956, "episode_media": {}, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 17.299999999999805, 8.099999999999675, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.699999999999896, 30.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.499999999999908, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.499999999999837, -50.00000000000044, 36.30000000000003, -50.00000000000044, 22.49999999999988, 7.09999999999966, -50.00000000000044, 44.900000000000006, 0.8999999999995723, 23.499999999999893, 5.099999999999632, 39.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.499999999999964, 30.099999999999987, -50.00000000000044, 32.50000000000002, 41.500000000000014, -50.00000000000044, 23.8999999999999, 29.49999999999998, 36.10000000000004, -50.00000000000044, -50.00000000000044, 37.70000000000003, 17.899999999999814, 38.10000000000002, 15.699999999999783, 8.699999999999683, 13.099999999999746, 28.29999999999996, 22.099999999999874, 34.70000000000004, 17.899999999999814, 32.100000000000016, 20.899999999999856, 28.89999999999997, -50.00000000000044, -50.00000000000044, 22.299999999999876, -50.00000000000044, 19.69999999999984, 32.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.29999999999989, 40.500000000000014, -50.00000000000044, -50.00000000000044, 37.50000000000003, -50.00000000000044, 31.500000000000007, -50.00000000000044, -50.00000000000044, 11.499999999999723, 42.10000000000001, 36.10000000000004, -50.00000000000044, 41.100000000000016, -50.00000000000044, 28.09999999999996, 16.8999999999998, 23.29999999999989, -50.00000000000044, 11.899999999999729, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 328, 420, 500, 500, 500, 264, 192, 500, 500, 500, 500, 500, 500, 256, 500, 500, 500, 306, 500, 138, 500, 276, 430, 500, 52, 492, 266, 450, 108, 500, 500, 500, 500, 500, 216, 200, 500, 176, 86, 500, 262, 206, 140, 500, 500, 124, 322, 120, 344, 414, 370, 218, 280, 154, 322, 180, 292, 212, 500, 500, 278, 500, 304, 174, 500, 500, 500, 500, 268, 96, 500, 500, 126, 500, 186, 500, 500, 386, 80, 140, 500, 90, 500, 220, 332, 268, 500, 382, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36870973160940346, "mean_inference_ms": 1.1775085815496111, "mean_action_processing_ms": 0.1367831521230773, "mean_env_wait_ms": 0.08254051389006878, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026094654332036556, "StateBufferConnector_ms": 0.005435943603515625, "ViewRequirementAgentConnector_ms": 0.1413125058879023}}, "episode_reward_max": 44.900000000000006, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -9.670652173913302, "episode_len_mean": 363.54347826086956, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 17.299999999999805, 8.099999999999675, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.699999999999896, 30.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.499999999999908, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.499999999999837, -50.00000000000044, 36.30000000000003, -50.00000000000044, 22.49999999999988, 7.09999999999966, -50.00000000000044, 44.900000000000006, 0.8999999999995723, 23.499999999999893, 5.099999999999632, 39.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.499999999999964, 30.099999999999987, -50.00000000000044, 32.50000000000002, 41.500000000000014, -50.00000000000044, 23.8999999999999, 29.49999999999998, 36.10000000000004, -50.00000000000044, -50.00000000000044, 37.70000000000003, 17.899999999999814, 38.10000000000002, 15.699999999999783, 8.699999999999683, 13.099999999999746, 28.29999999999996, 22.099999999999874, 34.70000000000004, 17.899999999999814, 32.100000000000016, 20.899999999999856, 28.89999999999997, -50.00000000000044, -50.00000000000044, 22.299999999999876, -50.00000000000044, 19.69999999999984, 32.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.29999999999989, 40.500000000000014, -50.00000000000044, -50.00000000000044, 37.50000000000003, -50.00000000000044, 31.500000000000007, -50.00000000000044, -50.00000000000044, 11.499999999999723, 42.10000000000001, 36.10000000000004, -50.00000000000044, 41.100000000000016, -50.00000000000044, 28.09999999999996, 16.8999999999998, 23.29999999999989, -50.00000000000044, 11.899999999999729, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 328, 420, 500, 500, 500, 264, 192, 500, 500, 500, 500, 500, 500, 256, 500, 500, 500, 306, 500, 138, 500, 276, 430, 500, 52, 492, 266, 450, 108, 500, 500, 500, 500, 500, 216, 200, 500, 176, 86, 500, 262, 206, 140, 500, 500, 124, 322, 120, 344, 414, 370, 218, 280, 154, 322, 180, 292, 212, 500, 500, 278, 500, 304, 174, 500, 500, 500, 500, 268, 96, 500, 500, 126, 500, 186, 500, 500, 386, 80, 140, 500, 90, 500, 220, 332, 268, 500, 382, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36870973160940346, "mean_inference_ms": 1.1775085815496111, "mean_action_processing_ms": 0.1367831521230773, "mean_env_wait_ms": 0.08254051389006878, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026094654332036556, "StateBufferConnector_ms": 0.005435943603515625, "ViewRequirementAgentConnector_ms": 0.1413125058879023}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 6071.7048116534315, "num_env_steps_trained_throughput_per_sec": 6071.7048116534315, "timesteps_total": 36000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 2934.389, "sample_time_ms": 2780.983, "load_time_ms": 13.027, "load_throughput": 1381725.329, "learn_time_ms": 126.95, "learn_throughput": 141788.21, "synch_weights_time_ms": 10.926}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "episodes_total": 92, "training_iteration": 2, "trial_id": "9f288_00014", "date": "2023-10-25_16-41-59", "timestamp": 1698248519, "time_this_iter_s": 2.969931125640869, "time_total_s": 5.879129886627197, "pid": 9504, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 5.879129886627197, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 64.575, "ram_util_percent": 27.325000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.05000000000000001, "cur_lr": 0.0003, "total_loss": 9.138484954833984, "policy_loss": -0.054949795827269554, "vf_loss": 9.19336462020874, "vf_explained_var": -6.243586540222168e-06, "kl": 0.0027743634930536367, "entropy": 0.6832374384005865, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 30.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 54000, "num_env_steps_trained": 54000, "num_agent_steps_sampled": 54000, "num_agent_steps_trained": 54000}, "sampler_results": {"episode_reward_max": 42.500000000000014, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.7760000000002172, "episode_len_mean": 328.38, "episode_media": {}, "episodes_this_iter": 54, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 37.70000000000003, 17.899999999999814, 38.10000000000002, 15.699999999999783, 8.699999999999683, 13.099999999999746, 28.29999999999996, 22.099999999999874, 34.70000000000004, 17.899999999999814, 32.100000000000016, 20.899999999999856, 28.89999999999997, -50.00000000000044, -50.00000000000044, 22.299999999999876, -50.00000000000044, 19.69999999999984, 32.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.29999999999989, 40.500000000000014, -50.00000000000044, -50.00000000000044, 37.50000000000003, -50.00000000000044, 31.500000000000007, -50.00000000000044, -50.00000000000044, 11.499999999999723, 42.10000000000001, 36.10000000000004, -50.00000000000044, 41.100000000000016, -50.00000000000044, 28.09999999999996, 16.8999999999998, 23.29999999999989, -50.00000000000044, 11.899999999999729, -50.00000000000044, -50.00000000000044, 37.50000000000003, -50.00000000000044, 21.499999999999865, 35.30000000000004, 24.69999999999991, 42.10000000000001, 15.899999999999785, -50.00000000000044, -50.00000000000044, 29.899999999999984, 36.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.50000000000003, 4.099999999999618, 39.90000000000002, 0.09999999999956088, -50.00000000000044, 41.30000000000001, 40.10000000000002, 37.90000000000003, 18.899999999999828, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 0.49999999999956657, -50.00000000000044, 28.89999999999997, 30.29999999999999, 17.69999999999981, 39.70000000000002, 32.50000000000002, -50.00000000000044, 38.700000000000024, 26.69999999999994, -50.00000000000044, 18.499999999999822, 27.099999999999945, -50.00000000000044, -50.00000000000044, 41.500000000000014, 24.499999999999908, 22.699999999999882, 36.900000000000034, 19.299999999999834, 38.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002], "episode_lengths": [500, 124, 322, 120, 344, 414, 370, 218, 280, 154, 322, 180, 292, 212, 500, 500, 278, 500, 304, 174, 500, 500, 500, 500, 268, 96, 500, 500, 126, 500, 186, 500, 500, 386, 80, 140, 500, 90, 500, 220, 332, 268, 500, 382, 500, 500, 126, 500, 286, 148, 254, 80, 342, 500, 500, 202, 140, 500, 500, 500, 500, 136, 460, 102, 500, 500, 88, 100, 122, 312, 76, 500, 500, 500, 496, 500, 212, 198, 324, 104, 176, 500, 114, 234, 500, 316, 230, 500, 500, 86, 256, 274, 132, 308, 116, 500, 500, 500, 500, 106]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3689102855991283, "mean_inference_ms": 1.1817732887727619, "mean_action_processing_ms": 0.13732672230358461, "mean_env_wait_ms": 0.08042772536869372, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024999618530273438, "StateBufferConnector_ms": 0.003000974655151367, "ViewRequirementAgentConnector_ms": 0.12099742889404297}}, "episode_reward_max": 42.500000000000014, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.7760000000002172, "episode_len_mean": 328.38, "episodes_this_iter": 54, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 37.70000000000003, 17.899999999999814, 38.10000000000002, 15.699999999999783, 8.699999999999683, 13.099999999999746, 28.29999999999996, 22.099999999999874, 34.70000000000004, 17.899999999999814, 32.100000000000016, 20.899999999999856, 28.89999999999997, -50.00000000000044, -50.00000000000044, 22.299999999999876, -50.00000000000044, 19.69999999999984, 32.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.29999999999989, 40.500000000000014, -50.00000000000044, -50.00000000000044, 37.50000000000003, -50.00000000000044, 31.500000000000007, -50.00000000000044, -50.00000000000044, 11.499999999999723, 42.10000000000001, 36.10000000000004, -50.00000000000044, 41.100000000000016, -50.00000000000044, 28.09999999999996, 16.8999999999998, 23.29999999999989, -50.00000000000044, 11.899999999999729, -50.00000000000044, -50.00000000000044, 37.50000000000003, -50.00000000000044, 21.499999999999865, 35.30000000000004, 24.69999999999991, 42.10000000000001, 15.899999999999785, -50.00000000000044, -50.00000000000044, 29.899999999999984, 36.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.50000000000003, 4.099999999999618, 39.90000000000002, 0.09999999999956088, -50.00000000000044, 41.30000000000001, 40.10000000000002, 37.90000000000003, 18.899999999999828, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 0.49999999999956657, -50.00000000000044, 28.89999999999997, 30.29999999999999, 17.69999999999981, 39.70000000000002, 32.50000000000002, -50.00000000000044, 38.700000000000024, 26.69999999999994, -50.00000000000044, 18.499999999999822, 27.099999999999945, -50.00000000000044, -50.00000000000044, 41.500000000000014, 24.499999999999908, 22.699999999999882, 36.900000000000034, 19.299999999999834, 38.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002], "episode_lengths": [500, 124, 322, 120, 344, 414, 370, 218, 280, 154, 322, 180, 292, 212, 500, 500, 278, 500, 304, 174, 500, 500, 500, 500, 268, 96, 500, 500, 126, 500, 186, 500, 500, 386, 80, 140, 500, 90, 500, 220, 332, 268, 500, 382, 500, 500, 126, 500, 286, 148, 254, 80, 342, 500, 500, 202, 140, 500, 500, 500, 500, 136, 460, 102, 500, 500, 88, 100, 122, 312, 76, 500, 500, 500, 496, 500, 212, 198, 324, 104, 176, 500, 114, 234, 500, 316, 230, 500, 500, 86, 256, 274, 132, 308, 116, 500, 500, 500, 500, 106]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3689102855991283, "mean_inference_ms": 1.1817732887727619, "mean_action_processing_ms": 0.13732672230358461, "mean_env_wait_ms": 0.08042772536869372, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024999618530273438, "StateBufferConnector_ms": 0.003000974655151367, "ViewRequirementAgentConnector_ms": 0.12099742889404297}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 54000, "num_agent_steps_trained": 54000, "num_env_steps_sampled": 54000, "num_env_steps_trained": 54000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5830.365436374605, "num_env_steps_trained_throughput_per_sec": 5830.365436374605, "timesteps_total": 54000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 54000, "timers": {"training_iteration_time_ms": 2985.354, "sample_time_ms": 2797.388, "load_time_ms": 17.018, "load_throughput": 1057703.59, "learn_time_ms": 157.995, "learn_throughput": 113927.494, "synch_weights_time_ms": 10.617}, "counters": {"num_env_steps_sampled": 54000, "num_env_steps_trained": 54000, "num_agent_steps_sampled": 54000, "num_agent_steps_trained": 54000}, "done": false, "episodes_total": 146, "training_iteration": 3, "trial_id": "9f288_00014", "date": "2023-10-25_16-42-02", "timestamp": 1698248522, "time_this_iter_s": 3.0922813415527344, "time_total_s": 8.971411228179932, "pid": 9504, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 8.971411228179932, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 63.775000000000006, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.0003, "total_loss": 9.04787810643514, "policy_loss": -0.011091308939891556, "vf_loss": 9.059019486109415, "vf_explained_var": -7.405877113342285e-06, "kl": 0.0007039196796275368, "entropy": 0.6771200696627299, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 42.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "sampler_results": {"episode_reward_max": 45.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.305999999999815, "episode_len_mean": 297.62, "episode_media": {}, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.30000000000001, 40.10000000000002, 37.90000000000003, 18.899999999999828, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 0.49999999999956657, -50.00000000000044, 28.89999999999997, 30.29999999999999, 17.69999999999981, 39.70000000000002, 32.50000000000002, -50.00000000000044, 38.700000000000024, 26.69999999999994, -50.00000000000044, 18.499999999999822, 27.099999999999945, -50.00000000000044, -50.00000000000044, 41.500000000000014, 24.499999999999908, 22.699999999999882, 36.900000000000034, 19.299999999999834, 38.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002, -50.00000000000044, 27.899999999999956, 45.5, 9.8999999999997, 29.899999999999984, 8.299999999999677, -50.00000000000044, -50.00000000000044, 23.29999999999989, 0.49999999999956657, 33.10000000000003, -50.00000000000044, 40.30000000000002, 30.29999999999999, 16.29999999999979, -50.00000000000044, -50.00000000000044, 43.30000000000001, 30.099999999999987, 39.70000000000002, -50.00000000000044, -50.00000000000044, 15.099999999999774, 31.1, 33.500000000000036, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.70000000000003, 35.500000000000036, 21.09999999999986, 35.70000000000003, -50.00000000000044, 40.10000000000002, 41.30000000000001, 25.499999999999922, 43.900000000000006, -50.00000000000044, 42.500000000000014, 14.499999999999766, 29.69999999999998, 41.500000000000014, 36.50000000000003, 41.100000000000016, 16.29999999999979, -50.00000000000044, 8.699999999999683, 39.50000000000002, 10.299999999999706, -50.00000000000044, 23.499999999999893, 18.499999999999822, 28.09999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 35.900000000000034, -50.00000000000044, 35.30000000000004, 18.099999999999817, -50.00000000000044, 17.499999999999808, 39.300000000000026, 44.10000000000001], "episode_lengths": [88, 100, 122, 312, 76, 500, 500, 500, 496, 500, 212, 198, 324, 104, 176, 500, 114, 234, 500, 316, 230, 500, 500, 86, 256, 274, 132, 308, 116, 500, 500, 500, 500, 106, 500, 222, 46, 402, 202, 418, 500, 500, 268, 496, 170, 500, 98, 198, 338, 500, 500, 68, 200, 104, 500, 500, 350, 190, 166, 48, 500, 500, 500, 124, 146, 290, 144, 500, 100, 88, 246, 62, 500, 76, 356, 204, 86, 136, 90, 338, 500, 414, 106, 398, 500, 266, 316, 220, 500, 500, 500, 88, 142, 500, 148, 320, 500, 326, 108, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36991938255313156, "mean_inference_ms": 1.1855239595269624, "mean_action_processing_ms": 0.13955301031222098, "mean_env_wait_ms": 0.08038683089182505, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026006221771240234, "StateBufferConnector_ms": 0.0040035247802734375, "ViewRequirementAgentConnector_ms": 0.1125650405883789}}, "episode_reward_max": 45.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.305999999999815, "episode_len_mean": 297.62, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [41.30000000000001, 40.10000000000002, 37.90000000000003, 18.899999999999828, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 0.49999999999956657, -50.00000000000044, 28.89999999999997, 30.29999999999999, 17.69999999999981, 39.70000000000002, 32.50000000000002, -50.00000000000044, 38.700000000000024, 26.69999999999994, -50.00000000000044, 18.499999999999822, 27.099999999999945, -50.00000000000044, -50.00000000000044, 41.500000000000014, 24.499999999999908, 22.699999999999882, 36.900000000000034, 19.299999999999834, 38.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002, -50.00000000000044, 27.899999999999956, 45.5, 9.8999999999997, 29.899999999999984, 8.299999999999677, -50.00000000000044, -50.00000000000044, 23.29999999999989, 0.49999999999956657, 33.10000000000003, -50.00000000000044, 40.30000000000002, 30.29999999999999, 16.29999999999979, -50.00000000000044, -50.00000000000044, 43.30000000000001, 30.099999999999987, 39.70000000000002, -50.00000000000044, -50.00000000000044, 15.099999999999774, 31.1, 33.500000000000036, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.70000000000003, 35.500000000000036, 21.09999999999986, 35.70000000000003, -50.00000000000044, 40.10000000000002, 41.30000000000001, 25.499999999999922, 43.900000000000006, -50.00000000000044, 42.500000000000014, 14.499999999999766, 29.69999999999998, 41.500000000000014, 36.50000000000003, 41.100000000000016, 16.29999999999979, -50.00000000000044, 8.699999999999683, 39.50000000000002, 10.299999999999706, -50.00000000000044, 23.499999999999893, 18.499999999999822, 28.09999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 35.900000000000034, -50.00000000000044, 35.30000000000004, 18.099999999999817, -50.00000000000044, 17.499999999999808, 39.300000000000026, 44.10000000000001], "episode_lengths": [88, 100, 122, 312, 76, 500, 500, 500, 496, 500, 212, 198, 324, 104, 176, 500, 114, 234, 500, 316, 230, 500, 500, 86, 256, 274, 132, 308, 116, 500, 500, 500, 500, 106, 500, 222, 46, 402, 202, 418, 500, 500, 268, 496, 170, 500, 98, 198, 338, 500, 500, 68, 200, 104, 500, 500, 350, 190, 166, 48, 500, 500, 500, 124, 146, 290, 144, 500, 100, 88, 246, 62, 500, 76, 356, 204, 86, 136, 90, 338, 500, 414, 106, 398, 500, 266, 316, 220, 500, 500, 500, 88, 142, 500, 148, 320, 500, 326, 108, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36991938255313156, "mean_inference_ms": 1.1855239595269624, "mean_action_processing_ms": 0.13955301031222098, "mean_env_wait_ms": 0.08038683089182505, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026006221771240234, "StateBufferConnector_ms": 0.0040035247802734375, "ViewRequirementAgentConnector_ms": 0.1125650405883789}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5990.50120670984, "num_env_steps_trained_throughput_per_sec": 5990.50120670984, "timesteps_total": 72000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 2990.205, "sample_time_ms": 2796.67, "load_time_ms": 16.717, "load_throughput": 1076739.467, "learn_time_ms": 164.103, "learn_throughput": 109687.467, "synch_weights_time_ms": 10.463}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "episodes_total": 212, "training_iteration": 4, "trial_id": "9f288_00014", "date": "2023-10-25_16-42-05", "timestamp": 1698248525, "time_this_iter_s": 3.009753942489624, "time_total_s": 11.981165170669556, "pid": 9504, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 11.981165170669556, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 60.1, "ram_util_percent": 27.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0003, "total_loss": 9.126975297927856, "policy_loss": 0.06411006604321301, "vf_loss": 9.062927484512329, "vf_explained_var": 3.875295321146647e-05, "kl": 0.00032915791825871565, "entropy": 0.6646824429432551, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 54.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 90000, "num_env_steps_trained": 90000, "num_agent_steps_sampled": 90000, "num_agent_steps_trained": 90000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.898999999999823, "episode_len_mean": 286.7, "episode_media": {}, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 37.70000000000003, 35.500000000000036, 21.09999999999986, 35.70000000000003, -50.00000000000044, 40.10000000000002, 41.30000000000001, 25.499999999999922, 43.900000000000006, -50.00000000000044, 42.500000000000014, 14.499999999999766, 29.69999999999998, 41.500000000000014, 36.50000000000003, 41.100000000000016, 16.29999999999979, -50.00000000000044, 8.699999999999683, 39.50000000000002, 10.299999999999706, -50.00000000000044, 23.499999999999893, 18.499999999999822, 28.09999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 35.900000000000034, -50.00000000000044, 35.30000000000004, 18.099999999999817, -50.00000000000044, 17.499999999999808, 39.300000000000026, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.699999999999967, -50.00000000000044, 35.30000000000004, -50.00000000000044, -50.00000000000044, 6.299999999999649, -50.00000000000044, 24.69999999999991, 19.09999999999983, 11.499999999999723, -50.00000000000044, 38.300000000000026, 1.299999999999578, 28.89999999999997, 39.10000000000002, 6.499999999999652, -50.00000000000044, 43.10000000000001, -50.00000000000044, 35.70000000000003, 40.500000000000014, 40.70000000000002, 40.90000000000002, -50.00000000000044, 43.50000000000001, 30.699999999999996, 40.90000000000002, -50.00000000000044, -50.00000000000044, 39.300000000000026, 34.30000000000004, 46.699999999999996, 38.90000000000002, -50.00000000000044, 20.899999999999856, 32.100000000000016, 32.100000000000016, 39.10000000000002, 34.900000000000034, -50.00000000000044, 44.5, 39.10000000000002, -50.00000000000044, 35.900000000000034, 40.10000000000002, -50.00000000000044, 36.900000000000034, -50.00000000000044, 35.70000000000003, -50.00000000000044, 13.499999999999751, -50.00000000000044, 31.900000000000013, 0.6999999999995694, 38.300000000000026, 45.9, 38.10000000000002, 2.299999999999592], "episode_lengths": [500, 500, 124, 146, 290, 144, 500, 100, 88, 246, 62, 500, 76, 356, 204, 86, 136, 90, 338, 500, 414, 106, 398, 500, 266, 316, 220, 500, 500, 500, 88, 142, 500, 148, 320, 500, 326, 108, 60, 500, 500, 500, 214, 500, 148, 500, 500, 438, 500, 254, 310, 386, 500, 118, 488, 212, 110, 436, 500, 70, 500, 144, 96, 94, 92, 500, 66, 194, 92, 500, 500, 108, 158, 34, 112, 500, 292, 180, 180, 110, 152, 500, 56, 110, 500, 142, 100, 500, 132, 500, 144, 500, 366, 500, 182, 494, 118, 42, 120, 478]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3708554782673756, "mean_inference_ms": 1.187090395824336, "mean_action_processing_ms": 0.14020107418912967, "mean_env_wait_ms": 0.08108199181478513, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029010772705078125, "StateBufferConnector_ms": 0.0050046443939208984, "ViewRequirementAgentConnector_ms": 0.12800359725952148}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.898999999999823, "episode_len_mean": 286.7, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 37.70000000000003, 35.500000000000036, 21.09999999999986, 35.70000000000003, -50.00000000000044, 40.10000000000002, 41.30000000000001, 25.499999999999922, 43.900000000000006, -50.00000000000044, 42.500000000000014, 14.499999999999766, 29.69999999999998, 41.500000000000014, 36.50000000000003, 41.100000000000016, 16.29999999999979, -50.00000000000044, 8.699999999999683, 39.50000000000002, 10.299999999999706, -50.00000000000044, 23.499999999999893, 18.499999999999822, 28.09999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 35.900000000000034, -50.00000000000044, 35.30000000000004, 18.099999999999817, -50.00000000000044, 17.499999999999808, 39.300000000000026, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.699999999999967, -50.00000000000044, 35.30000000000004, -50.00000000000044, -50.00000000000044, 6.299999999999649, -50.00000000000044, 24.69999999999991, 19.09999999999983, 11.499999999999723, -50.00000000000044, 38.300000000000026, 1.299999999999578, 28.89999999999997, 39.10000000000002, 6.499999999999652, -50.00000000000044, 43.10000000000001, -50.00000000000044, 35.70000000000003, 40.500000000000014, 40.70000000000002, 40.90000000000002, -50.00000000000044, 43.50000000000001, 30.699999999999996, 40.90000000000002, -50.00000000000044, -50.00000000000044, 39.300000000000026, 34.30000000000004, 46.699999999999996, 38.90000000000002, -50.00000000000044, 20.899999999999856, 32.100000000000016, 32.100000000000016, 39.10000000000002, 34.900000000000034, -50.00000000000044, 44.5, 39.10000000000002, -50.00000000000044, 35.900000000000034, 40.10000000000002, -50.00000000000044, 36.900000000000034, -50.00000000000044, 35.70000000000003, -50.00000000000044, 13.499999999999751, -50.00000000000044, 31.900000000000013, 0.6999999999995694, 38.300000000000026, 45.9, 38.10000000000002, 2.299999999999592], "episode_lengths": [500, 500, 124, 146, 290, 144, 500, 100, 88, 246, 62, 500, 76, 356, 204, 86, 136, 90, 338, 500, 414, 106, 398, 500, 266, 316, 220, 500, 500, 500, 88, 142, 500, 148, 320, 500, 326, 108, 60, 500, 500, 500, 214, 500, 148, 500, 500, 438, 500, 254, 310, 386, 500, 118, 488, 212, 110, 436, 500, 70, 500, 144, 96, 94, 92, 500, 66, 194, 92, 500, 500, 108, 158, 34, 112, 500, 292, 180, 180, 110, 152, 500, 56, 110, 500, 142, 100, 500, 132, 500, 144, 500, 366, 500, 182, 494, 118, 42, 120, 478]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3708554782673756, "mean_inference_ms": 1.187090395824336, "mean_action_processing_ms": 0.14020107418912967, "mean_env_wait_ms": 0.08108199181478513, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029010772705078125, "StateBufferConnector_ms": 0.0050046443939208984, "ViewRequirementAgentConnector_ms": 0.12800359725952148}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 90000, "num_agent_steps_trained": 90000, "num_env_steps_sampled": 90000, "num_env_steps_trained": 90000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5708.804905229909, "num_env_steps_trained_throughput_per_sec": 5708.804905229909, "timesteps_total": 90000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 90000, "timers": {"training_iteration_time_ms": 3022.769, "sample_time_ms": 2807.639, "load_time_ms": 19.611, "load_throughput": 917857.758, "learn_time_ms": 183.006, "learn_throughput": 98357.379, "synch_weights_time_ms": 10.31}, "counters": {"num_env_steps_sampled": 90000, "num_env_steps_trained": 90000, "num_agent_steps_sampled": 90000, "num_agent_steps_trained": 90000}, "done": false, "episodes_total": 273, "training_iteration": 5, "trial_id": "9f288_00014", "date": "2023-10-25_16-42-08", "timestamp": 1698248528, "time_this_iter_s": 3.158813238143921, "time_total_s": 15.139978408813477, "pid": 9504, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 15.139978408813477, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 59.4, "ram_util_percent": 27.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.006250000000000001, "cur_lr": 0.0003, "total_loss": 9.072256644566854, "policy_loss": -0.049246156588196754, "vf_loss": 9.121564944585165, "vf_explained_var": 4.380941390991211e-06, "kl": 0.0006502190434455694, "entropy": 0.6608329912026724, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 66.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.249999999999854, "episode_len_mean": 258.24, "episode_media": {}, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 39.300000000000026, 34.30000000000004, 46.699999999999996, 38.90000000000002, -50.00000000000044, 20.899999999999856, 32.100000000000016, 32.100000000000016, 39.10000000000002, 34.900000000000034, -50.00000000000044, 44.5, 39.10000000000002, -50.00000000000044, 35.900000000000034, 40.10000000000002, -50.00000000000044, 36.900000000000034, -50.00000000000044, 35.70000000000003, -50.00000000000044, 13.499999999999751, -50.00000000000044, 31.900000000000013, 0.6999999999995694, 38.300000000000026, 45.9, 38.10000000000002, 2.299999999999592, 24.499999999999908, 27.49999999999995, -50.00000000000044, 44.10000000000001, 39.90000000000002, 39.10000000000002, 34.10000000000004, -50.00000000000044, -50.00000000000044, 42.30000000000001, 46.5, 42.30000000000001, 39.10000000000002, 24.099999999999902, 23.499999999999893, 0.6999999999995694, 19.299999999999834, 31.300000000000004, 30.699999999999996, 43.10000000000001, 42.500000000000014, 3.0999999999996035, 40.30000000000002, 39.50000000000002, 38.700000000000024, 27.299999999999947, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 8.899999999999686, 37.70000000000003, -50.00000000000044, 27.49999999999995, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 14.299999999999763, 20.299999999999848, 40.30000000000002, 44.5, 30.499999999999993, -50.00000000000044, 25.699999999999925, 34.10000000000004, 29.099999999999973, 32.90000000000003, 22.49999999999988, 26.89999999999994, 43.7, 31.900000000000013, 32.100000000000016, 29.69999999999998, 40.500000000000014, 32.30000000000002, -50.00000000000044, 36.10000000000004, 41.30000000000001, 43.50000000000001, 40.10000000000002, 39.70000000000002, 24.899999999999913, 42.10000000000001, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 108, 158, 34, 112, 500, 292, 180, 180, 110, 152, 500, 56, 110, 500, 142, 100, 500, 132, 500, 144, 500, 366, 500, 182, 494, 118, 42, 120, 478, 256, 226, 500, 60, 102, 110, 160, 500, 500, 78, 36, 78, 110, 260, 266, 494, 308, 188, 194, 70, 76, 470, 98, 106, 114, 228, 500, 500, 62, 500, 500, 500, 500, 412, 124, 500, 226, 500, 68, 500, 500, 358, 298, 98, 56, 196, 500, 244, 160, 210, 172, 276, 232, 64, 182, 180, 204, 96, 178, 500, 140, 88, 66, 100, 104, 252, 80, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3707943906461355, "mean_inference_ms": 1.18957484792961, "mean_action_processing_ms": 0.13909876905441537, "mean_env_wait_ms": 0.08097435829947741, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028996944427490234, "StateBufferConnector_ms": 0.007000446319580078, "ViewRequirementAgentConnector_ms": 0.10200834274291992}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.249999999999854, "episode_len_mean": 258.24, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 39.300000000000026, 34.30000000000004, 46.699999999999996, 38.90000000000002, -50.00000000000044, 20.899999999999856, 32.100000000000016, 32.100000000000016, 39.10000000000002, 34.900000000000034, -50.00000000000044, 44.5, 39.10000000000002, -50.00000000000044, 35.900000000000034, 40.10000000000002, -50.00000000000044, 36.900000000000034, -50.00000000000044, 35.70000000000003, -50.00000000000044, 13.499999999999751, -50.00000000000044, 31.900000000000013, 0.6999999999995694, 38.300000000000026, 45.9, 38.10000000000002, 2.299999999999592, 24.499999999999908, 27.49999999999995, -50.00000000000044, 44.10000000000001, 39.90000000000002, 39.10000000000002, 34.10000000000004, -50.00000000000044, -50.00000000000044, 42.30000000000001, 46.5, 42.30000000000001, 39.10000000000002, 24.099999999999902, 23.499999999999893, 0.6999999999995694, 19.299999999999834, 31.300000000000004, 30.699999999999996, 43.10000000000001, 42.500000000000014, 3.0999999999996035, 40.30000000000002, 39.50000000000002, 38.700000000000024, 27.299999999999947, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 8.899999999999686, 37.70000000000003, -50.00000000000044, 27.49999999999995, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 14.299999999999763, 20.299999999999848, 40.30000000000002, 44.5, 30.499999999999993, -50.00000000000044, 25.699999999999925, 34.10000000000004, 29.099999999999973, 32.90000000000003, 22.49999999999988, 26.89999999999994, 43.7, 31.900000000000013, 32.100000000000016, 29.69999999999998, 40.500000000000014, 32.30000000000002, -50.00000000000044, 36.10000000000004, 41.30000000000001, 43.50000000000001, 40.10000000000002, 39.70000000000002, 24.899999999999913, 42.10000000000001, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 108, 158, 34, 112, 500, 292, 180, 180, 110, 152, 500, 56, 110, 500, 142, 100, 500, 132, 500, 144, 500, 366, 500, 182, 494, 118, 42, 120, 478, 256, 226, 500, 60, 102, 110, 160, 500, 500, 78, 36, 78, 110, 260, 266, 494, 308, 188, 194, 70, 76, 470, 98, 106, 114, 228, 500, 500, 62, 500, 500, 500, 500, 412, 124, 500, 226, 500, 68, 500, 500, 358, 298, 98, 56, 196, 500, 244, 160, 210, 172, 276, 232, 64, 182, 180, 204, 96, 178, 500, 140, 88, 66, 100, 104, 252, 80, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3707943906461355, "mean_inference_ms": 1.18957484792961, "mean_action_processing_ms": 0.13909876905441537, "mean_env_wait_ms": 0.08097435829947741, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028996944427490234, "StateBufferConnector_ms": 0.007000446319580078, "ViewRequirementAgentConnector_ms": 0.10200834274291992}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5380.659253319087, "num_env_steps_trained_throughput_per_sec": 5380.659253319087, "timesteps_total": 108000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 3076.527, "sample_time_ms": 2849.452, "load_time_ms": 19.978, "load_throughput": 900974.66, "learn_time_ms": 194.822, "learn_throughput": 92391.939, "synch_weights_time_ms": 10.092}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "done": false, "episodes_total": 342, "training_iteration": 6, "trial_id": "9f288_00014", "date": "2023-10-25_16-42-12", "timestamp": 1698248532, "time_this_iter_s": 3.3550219535827637, "time_total_s": 18.49500036239624, "pid": 9504, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 18.49500036239624, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 52.92, "ram_util_percent": 27.32}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0031250000000000006, "cur_lr": 0.0003, "total_loss": 8.930504639943441, "policy_loss": -0.03416092383364836, "vf_loss": 8.964721202850342, "vf_explained_var": 6.4820051193237305e-06, "kl": 0.0014775362565634016, "entropy": 0.6023977100849152, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 78.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 126000, "num_env_steps_trained": 126000, "num_agent_steps_sampled": 126000, "num_agent_steps_trained": 126000}, "sampler_results": {"episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.085999999999844, "episode_len_mean": 259.86, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 14.299999999999763, 20.299999999999848, 40.30000000000002, 44.5, 30.499999999999993, -50.00000000000044, 25.699999999999925, 34.10000000000004, 29.099999999999973, 32.90000000000003, 22.49999999999988, 26.89999999999994, 43.7, 31.900000000000013, 32.100000000000016, 29.69999999999998, 40.500000000000014, 32.30000000000002, -50.00000000000044, 36.10000000000004, 41.30000000000001, 43.50000000000001, 40.10000000000002, 39.70000000000002, 24.899999999999913, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 21.09999999999986, 42.500000000000014, -50.00000000000044, 46.3, 19.899999999999842, -50.00000000000044, 23.699999999999896, 44.10000000000001, -50.00000000000044, 45.7, 12.499999999999737, 7.699999999999669, 16.699999999999797, -50.00000000000044, 16.699999999999797, -50.00000000000044, 30.499999999999993, 19.499999999999837, 21.299999999999862, 43.900000000000006, -50.00000000000044, -50.00000000000044, 31.70000000000001, 22.099999999999874, 34.900000000000034, 34.10000000000004, -50.00000000000044, 45.5, 45.1, 33.30000000000003, -50.00000000000044, 17.899999999999814, 13.699999999999754, 9.099999999999689, -50.00000000000044, -50.00000000000044, 44.300000000000004, 42.900000000000006, 44.10000000000001, 43.10000000000001, 43.10000000000001, 35.10000000000004, 43.50000000000001, -50.00000000000044, -50.00000000000044, 43.30000000000001, 39.70000000000002, -50.00000000000044, 44.900000000000006, 42.30000000000001, 38.50000000000003, 38.700000000000024, 38.90000000000002, -50.00000000000044, 3.499999999999609, -50.00000000000044, -50.00000000000044, 37.10000000000003, 39.300000000000026, 42.10000000000001, -50.00000000000044, 31.70000000000001, 42.70000000000001, 45.9, 42.10000000000001, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 68, 500, 500, 358, 298, 98, 56, 196, 500, 244, 160, 210, 172, 276, 232, 64, 182, 180, 204, 96, 178, 500, 140, 88, 66, 100, 104, 252, 80, 500, 500, 500, 290, 76, 500, 38, 302, 500, 264, 60, 500, 44, 376, 424, 334, 500, 334, 500, 196, 306, 288, 62, 500, 500, 184, 280, 152, 160, 500, 46, 50, 168, 500, 322, 364, 410, 500, 500, 58, 72, 60, 70, 70, 150, 66, 500, 500, 68, 104, 500, 52, 78, 116, 114, 112, 500, 466, 500, 500, 130, 108, 80, 500, 184, 74, 42, 80, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37291718116019057, "mean_inference_ms": 1.191372078677357, "mean_action_processing_ms": 0.13981006868837353, "mean_env_wait_ms": 0.08138749769613711, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025004148483276367, "StateBufferConnector_ms": 0.006999015808105469, "ViewRequirementAgentConnector_ms": 0.10998010635375977}}, "episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.085999999999844, "episode_len_mean": 259.86, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 14.299999999999763, 20.299999999999848, 40.30000000000002, 44.5, 30.499999999999993, -50.00000000000044, 25.699999999999925, 34.10000000000004, 29.099999999999973, 32.90000000000003, 22.49999999999988, 26.89999999999994, 43.7, 31.900000000000013, 32.100000000000016, 29.69999999999998, 40.500000000000014, 32.30000000000002, -50.00000000000044, 36.10000000000004, 41.30000000000001, 43.50000000000001, 40.10000000000002, 39.70000000000002, 24.899999999999913, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 21.09999999999986, 42.500000000000014, -50.00000000000044, 46.3, 19.899999999999842, -50.00000000000044, 23.699999999999896, 44.10000000000001, -50.00000000000044, 45.7, 12.499999999999737, 7.699999999999669, 16.699999999999797, -50.00000000000044, 16.699999999999797, -50.00000000000044, 30.499999999999993, 19.499999999999837, 21.299999999999862, 43.900000000000006, -50.00000000000044, -50.00000000000044, 31.70000000000001, 22.099999999999874, 34.900000000000034, 34.10000000000004, -50.00000000000044, 45.5, 45.1, 33.30000000000003, -50.00000000000044, 17.899999999999814, 13.699999999999754, 9.099999999999689, -50.00000000000044, -50.00000000000044, 44.300000000000004, 42.900000000000006, 44.10000000000001, 43.10000000000001, 43.10000000000001, 35.10000000000004, 43.50000000000001, -50.00000000000044, -50.00000000000044, 43.30000000000001, 39.70000000000002, -50.00000000000044, 44.900000000000006, 42.30000000000001, 38.50000000000003, 38.700000000000024, 38.90000000000002, -50.00000000000044, 3.499999999999609, -50.00000000000044, -50.00000000000044, 37.10000000000003, 39.300000000000026, 42.10000000000001, -50.00000000000044, 31.70000000000001, 42.70000000000001, 45.9, 42.10000000000001, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 68, 500, 500, 358, 298, 98, 56, 196, 500, 244, 160, 210, 172, 276, 232, 64, 182, 180, 204, 96, 178, 500, 140, 88, 66, 100, 104, 252, 80, 500, 500, 500, 290, 76, 500, 38, 302, 500, 264, 60, 500, 44, 376, 424, 334, 500, 334, 500, 196, 306, 288, 62, 500, 500, 184, 280, 152, 160, 500, 46, 50, 168, 500, 322, 364, 410, 500, 500, 58, 72, 60, 70, 70, 150, 66, 500, 500, 68, 104, 500, 52, 78, 116, 114, 112, 500, 466, 500, 500, 130, 108, 80, 500, 184, 74, 42, 80, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37291718116019057, "mean_inference_ms": 1.191372078677357, "mean_action_processing_ms": 0.13981006868837353, "mean_env_wait_ms": 0.08138749769613711, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025004148483276367, "StateBufferConnector_ms": 0.006999015808105469, "ViewRequirementAgentConnector_ms": 0.10998010635375977}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 126000, "num_agent_steps_trained": 126000, "num_env_steps_sampled": 126000, "num_env_steps_trained": 126000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5797.971333255512, "num_env_steps_trained_throughput_per_sec": 5797.971333255512, "timesteps_total": 126000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 126000, "timers": {"training_iteration_time_ms": 3080.528, "sample_time_ms": 2852.493, "load_time_ms": 19.126, "load_throughput": 941133.644, "learn_time_ms": 196.446, "learn_throughput": 91628.086, "synch_weights_time_ms": 10.163}, "counters": {"num_env_steps_sampled": 126000, "num_env_steps_trained": 126000, "num_agent_steps_sampled": 126000, "num_agent_steps_trained": 126000}, "done": false, "episodes_total": 410, "training_iteration": 7, "trial_id": "9f288_00014", "date": "2023-10-25_16-42-15", "timestamp": 1698248535, "time_this_iter_s": 3.1105356216430664, "time_total_s": 21.605535984039307, "pid": 9504, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 21.605535984039307, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 68.725, "ram_util_percent": 27.325000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0015625000000000003, "cur_lr": 0.0003, "total_loss": 8.833706299463907, "policy_loss": 0.029346969909965992, "vf_loss": 8.804410378138224, "vf_explained_var": 1.0728836059570312e-06, "kl": 0.00044969709584089895, "entropy": 0.5187348077694575, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 90.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.600999999999808, "episode_len_mean": 279.6, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.899999999999814, 13.699999999999754, 9.099999999999689, -50.00000000000044, -50.00000000000044, 44.300000000000004, 42.900000000000006, 44.10000000000001, 43.10000000000001, 43.10000000000001, 35.10000000000004, 43.50000000000001, -50.00000000000044, -50.00000000000044, 43.30000000000001, 39.70000000000002, -50.00000000000044, 44.900000000000006, 42.30000000000001, 38.50000000000003, 38.700000000000024, 38.90000000000002, -50.00000000000044, 3.499999999999609, -50.00000000000044, -50.00000000000044, 37.10000000000003, 39.300000000000026, 42.10000000000001, -50.00000000000044, 31.70000000000001, 42.70000000000001, 45.9, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 18.499999999999822, -50.00000000000044, -50.00000000000044, 20.899999999999856, 43.30000000000001, 44.10000000000001, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 11.099999999999717, 39.90000000000002, 38.10000000000002, -50.00000000000044, 33.70000000000004, 41.100000000000016, -50.00000000000044, -50.00000000000044, 40.500000000000014, 44.900000000000006, 45.5, 27.49999999999995, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.90000000000003, 19.299999999999834, -50.00000000000044, 35.70000000000003, 37.300000000000026, 45.5, -50.00000000000044, 20.49999999999985, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.10000000000003, 25.099999999999916, -50.00000000000044, 24.69999999999991, 46.699999999999996, 47.3, 41.500000000000014, -50.00000000000044, -50.00000000000044, 46.699999999999996, 40.70000000000002, 43.7, 29.299999999999976, 17.099999999999802, -50.00000000000044, 40.500000000000014, 45.9, -50.00000000000044], "episode_lengths": [322, 364, 410, 500, 500, 58, 72, 60, 70, 70, 150, 66, 500, 500, 68, 104, 500, 52, 78, 116, 114, 112, 500, 466, 500, 500, 130, 108, 80, 500, 184, 74, 42, 80, 500, 500, 500, 500, 500, 58, 500, 500, 500, 316, 500, 500, 292, 68, 60, 500, 72, 500, 500, 500, 390, 102, 120, 500, 164, 90, 500, 500, 96, 52, 46, 226, 32, 500, 500, 500, 172, 308, 500, 144, 128, 46, 500, 296, 82, 500, 500, 500, 130, 250, 500, 254, 34, 28, 86, 500, 500, 34, 94, 64, 208, 330, 500, 96, 42, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37607209257010604, "mean_inference_ms": 1.2016803306160946, "mean_action_processing_ms": 0.14059823757613915, "mean_env_wait_ms": 0.08234814381100794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027002573013305664, "StateBufferConnector_ms": 0.012003421783447266, "ViewRequirementAgentConnector_ms": 0.13311433792114258}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.600999999999808, "episode_len_mean": 279.6, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [17.899999999999814, 13.699999999999754, 9.099999999999689, -50.00000000000044, -50.00000000000044, 44.300000000000004, 42.900000000000006, 44.10000000000001, 43.10000000000001, 43.10000000000001, 35.10000000000004, 43.50000000000001, -50.00000000000044, -50.00000000000044, 43.30000000000001, 39.70000000000002, -50.00000000000044, 44.900000000000006, 42.30000000000001, 38.50000000000003, 38.700000000000024, 38.90000000000002, -50.00000000000044, 3.499999999999609, -50.00000000000044, -50.00000000000044, 37.10000000000003, 39.300000000000026, 42.10000000000001, -50.00000000000044, 31.70000000000001, 42.70000000000001, 45.9, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 18.499999999999822, -50.00000000000044, -50.00000000000044, 20.899999999999856, 43.30000000000001, 44.10000000000001, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 11.099999999999717, 39.90000000000002, 38.10000000000002, -50.00000000000044, 33.70000000000004, 41.100000000000016, -50.00000000000044, -50.00000000000044, 40.500000000000014, 44.900000000000006, 45.5, 27.49999999999995, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.90000000000003, 19.299999999999834, -50.00000000000044, 35.70000000000003, 37.300000000000026, 45.5, -50.00000000000044, 20.49999999999985, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.10000000000003, 25.099999999999916, -50.00000000000044, 24.69999999999991, 46.699999999999996, 47.3, 41.500000000000014, -50.00000000000044, -50.00000000000044, 46.699999999999996, 40.70000000000002, 43.7, 29.299999999999976, 17.099999999999802, -50.00000000000044, 40.500000000000014, 45.9, -50.00000000000044], "episode_lengths": [322, 364, 410, 500, 500, 58, 72, 60, 70, 70, 150, 66, 500, 500, 68, 104, 500, 52, 78, 116, 114, 112, 500, 466, 500, 500, 130, 108, 80, 500, 184, 74, 42, 80, 500, 500, 500, 500, 500, 58, 500, 500, 500, 316, 500, 500, 292, 68, 60, 500, 72, 500, 500, 500, 390, 102, 120, 500, 164, 90, 500, 500, 96, 52, 46, 226, 32, 500, 500, 500, 172, 308, 500, 144, 128, 46, 500, 296, 82, 500, 500, 500, 130, 250, 500, 254, 34, 28, 86, 500, 500, 34, 94, 64, 208, 330, 500, 96, 42, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37607209257010604, "mean_inference_ms": 1.2016803306160946, "mean_action_processing_ms": 0.14059823757613915, "mean_env_wait_ms": 0.08234814381100794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027002573013305664, "StateBufferConnector_ms": 0.012003421783447266, "ViewRequirementAgentConnector_ms": 0.13311433792114258}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5201.126512166221, "num_env_steps_trained_throughput_per_sec": 5201.126512166221, "timesteps_total": 144000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 3128.06, "sample_time_ms": 2884.011, "load_time_ms": 19.832, "load_throughput": 907634.265, "learn_time_ms": 211.844, "learn_throughput": 84967.994, "synch_weights_time_ms": 10.107}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "episodes_total": 474, "training_iteration": 8, "trial_id": "9f288_00014", "date": "2023-10-25_16-42-18", "timestamp": 1698248538, "time_this_iter_s": 3.4658987522125244, "time_total_s": 25.07143473625183, "pid": 9504, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 25.07143473625183, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 63.94, "ram_util_percent": 27.32}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0007812500000000002, "cur_lr": 0.0003, "total_loss": 8.926613410313925, "policy_loss": -0.005867060298138919, "vf_loss": 8.932536204655966, "vf_explained_var": 2.076228459676107e-06, "kl": 8.425529497557704e-05, "entropy": 0.5549744615952173, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 102.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 162000, "num_env_steps_trained": 162000, "num_agent_steps_sampled": 162000, "num_agent_steps_trained": 162000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.903999999999844, "episode_len_mean": 251.66, "episode_media": {}, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 32.90000000000003, 19.299999999999834, -50.00000000000044, 35.70000000000003, 37.300000000000026, 45.5, -50.00000000000044, 20.49999999999985, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.10000000000003, 25.099999999999916, -50.00000000000044, 24.69999999999991, 46.699999999999996, 47.3, 41.500000000000014, -50.00000000000044, -50.00000000000044, 46.699999999999996, 40.70000000000002, 43.7, 29.299999999999976, 17.099999999999802, -50.00000000000044, 40.500000000000014, 45.9, -50.00000000000044, -50.00000000000044, 46.099999999999994, 45.1, -50.00000000000044, 42.900000000000006, 45.5, 36.70000000000003, 35.30000000000004, -50.00000000000044, 21.09999999999986, 44.10000000000001, -50.00000000000044, -50.00000000000044, 39.90000000000002, 1.099999999999575, 38.10000000000002, 37.70000000000003, -50.00000000000044, -50.00000000000044, 14.09999999999976, 45.5, 37.300000000000026, 40.90000000000002, 21.89999999999987, 35.30000000000004, 44.7, -50.00000000000044, 44.7, 42.30000000000001, 2.699999999999598, 43.30000000000001, -50.00000000000044, -50.00000000000044, 24.299999999999905, 34.50000000000004, 28.699999999999967, 43.50000000000001, -50.00000000000044, 40.90000000000002, 43.30000000000001, 47.1, 41.500000000000014, 24.899999999999913, 45.5, 45.3, -50.00000000000044, 42.70000000000001, 25.499999999999922, -50.00000000000044, 16.699999999999797, -50.00000000000044, 42.30000000000001, 43.10000000000001, 40.90000000000002, 22.49999999999988, 40.70000000000002, -50.00000000000044, 43.50000000000001, 37.90000000000003, 43.7, 38.50000000000003, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.299999999999777, 34.70000000000004, 11.899999999999729], "episode_lengths": [500, 172, 308, 500, 144, 128, 46, 500, 296, 82, 500, 500, 500, 130, 250, 500, 254, 34, 28, 86, 500, 500, 34, 94, 64, 208, 330, 500, 96, 42, 500, 500, 40, 50, 500, 72, 46, 134, 148, 500, 290, 60, 500, 500, 102, 490, 120, 124, 500, 500, 360, 46, 128, 92, 282, 148, 54, 500, 54, 78, 474, 68, 500, 500, 258, 156, 214, 66, 500, 92, 68, 30, 86, 252, 46, 48, 500, 74, 246, 500, 334, 500, 78, 70, 92, 276, 94, 500, 66, 122, 64, 116, 500, 48, 500, 500, 500, 348, 154, 382]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37910543045770995, "mean_inference_ms": 1.212204128025507, "mean_action_processing_ms": 0.14089598881777068, "mean_env_wait_ms": 0.0830488534339636, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023994922637939453, "StateBufferConnector_ms": 0.010005712509155273, "ViewRequirementAgentConnector_ms": 0.1311187744140625}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.903999999999844, "episode_len_mean": 251.66, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 32.90000000000003, 19.299999999999834, -50.00000000000044, 35.70000000000003, 37.300000000000026, 45.5, -50.00000000000044, 20.49999999999985, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.10000000000003, 25.099999999999916, -50.00000000000044, 24.69999999999991, 46.699999999999996, 47.3, 41.500000000000014, -50.00000000000044, -50.00000000000044, 46.699999999999996, 40.70000000000002, 43.7, 29.299999999999976, 17.099999999999802, -50.00000000000044, 40.500000000000014, 45.9, -50.00000000000044, -50.00000000000044, 46.099999999999994, 45.1, -50.00000000000044, 42.900000000000006, 45.5, 36.70000000000003, 35.30000000000004, -50.00000000000044, 21.09999999999986, 44.10000000000001, -50.00000000000044, -50.00000000000044, 39.90000000000002, 1.099999999999575, 38.10000000000002, 37.70000000000003, -50.00000000000044, -50.00000000000044, 14.09999999999976, 45.5, 37.300000000000026, 40.90000000000002, 21.89999999999987, 35.30000000000004, 44.7, -50.00000000000044, 44.7, 42.30000000000001, 2.699999999999598, 43.30000000000001, -50.00000000000044, -50.00000000000044, 24.299999999999905, 34.50000000000004, 28.699999999999967, 43.50000000000001, -50.00000000000044, 40.90000000000002, 43.30000000000001, 47.1, 41.500000000000014, 24.899999999999913, 45.5, 45.3, -50.00000000000044, 42.70000000000001, 25.499999999999922, -50.00000000000044, 16.699999999999797, -50.00000000000044, 42.30000000000001, 43.10000000000001, 40.90000000000002, 22.49999999999988, 40.70000000000002, -50.00000000000044, 43.50000000000001, 37.90000000000003, 43.7, 38.50000000000003, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.299999999999777, 34.70000000000004, 11.899999999999729], "episode_lengths": [500, 172, 308, 500, 144, 128, 46, 500, 296, 82, 500, 500, 500, 130, 250, 500, 254, 34, 28, 86, 500, 500, 34, 94, 64, 208, 330, 500, 96, 42, 500, 500, 40, 50, 500, 72, 46, 134, 148, 500, 290, 60, 500, 500, 102, 490, 120, 124, 500, 500, 360, 46, 128, 92, 282, 148, 54, 500, 54, 78, 474, 68, 500, 500, 258, 156, 214, 66, 500, 92, 68, 30, 86, 252, 46, 48, 500, 74, 246, 500, 334, 500, 78, 70, 92, 276, 94, 500, 66, 122, 64, 116, 500, 48, 500, 500, 500, 348, 154, 382]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37910543045770995, "mean_inference_ms": 1.212204128025507, "mean_action_processing_ms": 0.14089598881777068, "mean_env_wait_ms": 0.0830488534339636, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023994922637939453, "StateBufferConnector_ms": 0.010005712509155273, "ViewRequirementAgentConnector_ms": 0.1311187744140625}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 162000, "num_agent_steps_trained": 162000, "num_env_steps_sampled": 162000, "num_env_steps_trained": 162000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5652.777838092732, "num_env_steps_trained_throughput_per_sec": 5652.777838092732, "timesteps_total": 162000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 162000, "timers": {"training_iteration_time_ms": 3134.306, "sample_time_ms": 2892.145, "load_time_ms": 19.368, "load_throughput": 929359.791, "learn_time_ms": 210.464, "learn_throughput": 85525.326, "synch_weights_time_ms": 10.092}, "counters": {"num_env_steps_sampled": 162000, "num_env_steps_trained": 162000, "num_agent_steps_sampled": 162000, "num_agent_steps_trained": 162000}, "done": false, "episodes_total": 543, "training_iteration": 9, "trial_id": "9f288_00014", "date": "2023-10-25_16-42-21", "timestamp": 1698248541, "time_this_iter_s": 3.1892688274383545, "time_total_s": 28.260703563690186, "pid": 9504, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 28.260703563690186, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 67.5, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0003906250000000001, "cur_lr": 0.0003, "total_loss": 8.679425716400146, "policy_loss": -0.0002563924839099248, "vf_loss": 8.679739157358805, "vf_explained_var": -1.2020270029703777e-06, "kl": 0.0005288410750239336, "entropy": 0.5693835467100143, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 114.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.461999999999843, "episode_len_mean": 246.08, "episode_media": {}, "episodes_this_iter": 77, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.70000000000001, 25.499999999999922, -50.00000000000044, 16.699999999999797, -50.00000000000044, 42.30000000000001, 43.10000000000001, 40.90000000000002, 22.49999999999988, 40.70000000000002, -50.00000000000044, 43.50000000000001, 37.90000000000003, 43.7, 38.50000000000003, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.299999999999777, 34.70000000000004, 11.899999999999729, -50.00000000000044, -50.00000000000044, 23.499999999999893, 41.100000000000016, 28.499999999999964, 42.30000000000001, 46.5, -50.00000000000044, 46.5, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.099999999999888, 45.7, -50.00000000000044, 3.2999999999996064, 46.3, -50.00000000000044, 38.90000000000002, 43.10000000000001, 43.30000000000001, 32.100000000000016, 41.100000000000016, 44.900000000000006, 44.300000000000004, -50.00000000000044, 39.300000000000026, -50.00000000000044, 41.500000000000014, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 2.299999999999592, -50.00000000000044, 44.7, 35.10000000000004, 43.900000000000006, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 7.499999999999666, 29.099999999999973, 47.3, 43.50000000000001, -50.00000000000044, 46.099999999999994, 43.10000000000001, 43.50000000000001, 31.300000000000004, 35.900000000000034, 31.70000000000001, 42.10000000000001, 43.900000000000006, 29.69999999999998, -50.00000000000044, -50.00000000000044, 45.7, 24.899999999999913, 34.30000000000004, 44.5, 18.099999999999817, 46.5, 46.5, 12.099999999999731, 41.100000000000016, -50.00000000000044, -50.00000000000044, 42.900000000000006, 31.500000000000007, 40.90000000000002, 44.10000000000001, 40.10000000000002, 36.10000000000004], "episode_lengths": [74, 246, 500, 334, 500, 78, 70, 92, 276, 94, 500, 66, 122, 64, 116, 500, 48, 500, 500, 500, 348, 154, 382, 500, 500, 266, 90, 216, 78, 36, 500, 36, 38, 500, 500, 500, 270, 44, 500, 468, 38, 500, 112, 70, 68, 180, 90, 52, 58, 500, 108, 500, 86, 56, 500, 500, 500, 500, 478, 500, 54, 150, 62, 500, 52, 500, 500, 426, 210, 28, 66, 500, 40, 70, 66, 188, 142, 184, 80, 62, 204, 500, 500, 44, 252, 158, 56, 320, 36, 36, 380, 90, 500, 500, 72, 186, 92, 60, 100, 140]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38229769443476863, "mean_inference_ms": 1.21841323779197, "mean_action_processing_ms": 0.14240493708478577, "mean_env_wait_ms": 0.08400532711300962, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023288965225219727, "StateBufferConnector_ms": 0.0060007572174072266, "ViewRequirementAgentConnector_ms": 0.12299895286560059}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.461999999999843, "episode_len_mean": 246.08, "episodes_this_iter": 77, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.70000000000001, 25.499999999999922, -50.00000000000044, 16.699999999999797, -50.00000000000044, 42.30000000000001, 43.10000000000001, 40.90000000000002, 22.49999999999988, 40.70000000000002, -50.00000000000044, 43.50000000000001, 37.90000000000003, 43.7, 38.50000000000003, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.299999999999777, 34.70000000000004, 11.899999999999729, -50.00000000000044, -50.00000000000044, 23.499999999999893, 41.100000000000016, 28.499999999999964, 42.30000000000001, 46.5, -50.00000000000044, 46.5, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.099999999999888, 45.7, -50.00000000000044, 3.2999999999996064, 46.3, -50.00000000000044, 38.90000000000002, 43.10000000000001, 43.30000000000001, 32.100000000000016, 41.100000000000016, 44.900000000000006, 44.300000000000004, -50.00000000000044, 39.300000000000026, -50.00000000000044, 41.500000000000014, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 2.299999999999592, -50.00000000000044, 44.7, 35.10000000000004, 43.900000000000006, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 7.499999999999666, 29.099999999999973, 47.3, 43.50000000000001, -50.00000000000044, 46.099999999999994, 43.10000000000001, 43.50000000000001, 31.300000000000004, 35.900000000000034, 31.70000000000001, 42.10000000000001, 43.900000000000006, 29.69999999999998, -50.00000000000044, -50.00000000000044, 45.7, 24.899999999999913, 34.30000000000004, 44.5, 18.099999999999817, 46.5, 46.5, 12.099999999999731, 41.100000000000016, -50.00000000000044, -50.00000000000044, 42.900000000000006, 31.500000000000007, 40.90000000000002, 44.10000000000001, 40.10000000000002, 36.10000000000004], "episode_lengths": [74, 246, 500, 334, 500, 78, 70, 92, 276, 94, 500, 66, 122, 64, 116, 500, 48, 500, 500, 500, 348, 154, 382, 500, 500, 266, 90, 216, 78, 36, 500, 36, 38, 500, 500, 500, 270, 44, 500, 468, 38, 500, 112, 70, 68, 180, 90, 52, 58, 500, 108, 500, 86, 56, 500, 500, 500, 500, 478, 500, 54, 150, 62, 500, 52, 500, 500, 426, 210, 28, 66, 500, 40, 70, 66, 188, 142, 184, 80, 62, 204, 500, 500, 44, 252, 158, 56, 320, 36, 36, 380, 90, 500, 500, 72, 186, 92, 60, 100, 140]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38229769443476863, "mean_inference_ms": 1.21841323779197, "mean_action_processing_ms": 0.14240493708478577, "mean_env_wait_ms": 0.08400532711300962, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023288965225219727, "StateBufferConnector_ms": 0.0060007572174072266, "ViewRequirementAgentConnector_ms": 0.12299895286560059}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5393.039445939862, "num_env_steps_trained_throughput_per_sec": 5393.039445939862, "timesteps_total": 180000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 180000, "timers": {"training_iteration_time_ms": 3154.639, "sample_time_ms": 2905.792, "load_time_ms": 20.349, "load_throughput": 884543.543, "learn_time_ms": 215.901, "learn_throughput": 83371.401, "synch_weights_time_ms": 10.183}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "done": false, "episodes_total": 620, "training_iteration": 10, "trial_id": "9f288_00014", "date": "2023-10-25_16-42-25", "timestamp": 1698248545, "time_this_iter_s": 3.3436317443847656, "time_total_s": 31.60433530807495, "pid": 9504, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 31.60433530807495, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 65.6, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.00019531250000000004, "cur_lr": 0.0003, "total_loss": 8.806360165278116, "policy_loss": -0.03307679543892542, "vf_loss": 8.839492082595825, "vf_explained_var": -3.670652707417806e-06, "kl": 0.00018313779112114995, "entropy": 0.5535068437457085, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 126.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 198000, "num_env_steps_trained": 198000, "num_agent_steps_sampled": 198000, "num_agent_steps_trained": 198000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 15.060999999999872, "episode_len_mean": 225.14, "episode_media": {}, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.900000000000034, 31.70000000000001, 42.10000000000001, 43.900000000000006, 29.69999999999998, -50.00000000000044, -50.00000000000044, 45.7, 24.899999999999913, 34.30000000000004, 44.5, 18.099999999999817, 46.5, 46.5, 12.099999999999731, 41.100000000000016, -50.00000000000044, -50.00000000000044, 42.900000000000006, 31.500000000000007, 40.90000000000002, 44.10000000000001, 40.10000000000002, 36.10000000000004, -50.00000000000044, 38.50000000000003, 14.699999999999768, 38.700000000000024, 43.7, -50.00000000000044, 45.3, 45.9, -50.00000000000044, 15.899999999999785, 39.70000000000002, 44.300000000000004, 40.90000000000002, 32.50000000000002, 39.90000000000002, 43.10000000000001, -50.00000000000044, 39.10000000000002, 38.50000000000003, -50.00000000000044, -50.00000000000044, 33.10000000000003, 45.9, 33.90000000000004, 47.1, 46.099999999999994, 20.699999999999854, -50.00000000000044, 33.30000000000003, -50.00000000000044, 40.500000000000014, 18.899999999999828, 46.099999999999994, 40.70000000000002, 9.099999999999689, 32.30000000000002, 38.50000000000003, -50.00000000000044, 40.10000000000002, 46.099999999999994, 46.099999999999994, 37.70000000000003, -50.00000000000044, 43.900000000000006, 33.10000000000003, 46.9, 17.899999999999814, 41.70000000000002, 43.50000000000001, 44.5, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 25.699999999999925, -50.00000000000044, -50.00000000000044, 45.1, 22.49999999999988, 43.30000000000001, -50.00000000000044, -50.00000000000044, 26.89999999999994, 39.300000000000026, 39.300000000000026, 15.49999999999978, 30.499999999999993, -50.00000000000044, -50.00000000000044, 39.300000000000026, -50.00000000000044, 41.70000000000002, 37.50000000000003, 46.3, -50.00000000000044], "episode_lengths": [142, 184, 80, 62, 204, 500, 500, 44, 252, 158, 56, 320, 36, 36, 380, 90, 500, 500, 72, 186, 92, 60, 100, 140, 500, 116, 354, 114, 64, 500, 48, 42, 500, 342, 104, 58, 92, 176, 102, 70, 500, 110, 116, 500, 500, 170, 42, 162, 30, 40, 294, 500, 168, 500, 96, 312, 40, 94, 410, 178, 116, 500, 100, 40, 40, 124, 500, 62, 170, 32, 322, 84, 66, 56, 94, 500, 500, 500, 86, 244, 500, 500, 50, 276, 68, 500, 500, 232, 108, 108, 346, 196, 500, 500, 108, 500, 84, 126, 38, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3828600321412662, "mean_inference_ms": 1.2204812556422338, "mean_action_processing_ms": 0.14219080801012285, "mean_env_wait_ms": 0.08418143599079196, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020000219345092773, "StateBufferConnector_ms": 0.009001493453979492, "ViewRequirementAgentConnector_ms": 0.12274622917175293}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 15.060999999999872, "episode_len_mean": 225.14, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [35.900000000000034, 31.70000000000001, 42.10000000000001, 43.900000000000006, 29.69999999999998, -50.00000000000044, -50.00000000000044, 45.7, 24.899999999999913, 34.30000000000004, 44.5, 18.099999999999817, 46.5, 46.5, 12.099999999999731, 41.100000000000016, -50.00000000000044, -50.00000000000044, 42.900000000000006, 31.500000000000007, 40.90000000000002, 44.10000000000001, 40.10000000000002, 36.10000000000004, -50.00000000000044, 38.50000000000003, 14.699999999999768, 38.700000000000024, 43.7, -50.00000000000044, 45.3, 45.9, -50.00000000000044, 15.899999999999785, 39.70000000000002, 44.300000000000004, 40.90000000000002, 32.50000000000002, 39.90000000000002, 43.10000000000001, -50.00000000000044, 39.10000000000002, 38.50000000000003, -50.00000000000044, -50.00000000000044, 33.10000000000003, 45.9, 33.90000000000004, 47.1, 46.099999999999994, 20.699999999999854, -50.00000000000044, 33.30000000000003, -50.00000000000044, 40.500000000000014, 18.899999999999828, 46.099999999999994, 40.70000000000002, 9.099999999999689, 32.30000000000002, 38.50000000000003, -50.00000000000044, 40.10000000000002, 46.099999999999994, 46.099999999999994, 37.70000000000003, -50.00000000000044, 43.900000000000006, 33.10000000000003, 46.9, 17.899999999999814, 41.70000000000002, 43.50000000000001, 44.5, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 25.699999999999925, -50.00000000000044, -50.00000000000044, 45.1, 22.49999999999988, 43.30000000000001, -50.00000000000044, -50.00000000000044, 26.89999999999994, 39.300000000000026, 39.300000000000026, 15.49999999999978, 30.499999999999993, -50.00000000000044, -50.00000000000044, 39.300000000000026, -50.00000000000044, 41.70000000000002, 37.50000000000003, 46.3, -50.00000000000044], "episode_lengths": [142, 184, 80, 62, 204, 500, 500, 44, 252, 158, 56, 320, 36, 36, 380, 90, 500, 500, 72, 186, 92, 60, 100, 140, 500, 116, 354, 114, 64, 500, 48, 42, 500, 342, 104, 58, 92, 176, 102, 70, 500, 110, 116, 500, 500, 170, 42, 162, 30, 40, 294, 500, 168, 500, 96, 312, 40, 94, 410, 178, 116, 500, 100, 40, 40, 124, 500, 62, 170, 32, 322, 84, 66, 56, 94, 500, 500, 500, 86, 244, 500, 500, 50, 276, 68, 500, 500, 232, 108, 108, 346, 196, 500, 500, 108, 500, 84, 126, 38, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3828600321412662, "mean_inference_ms": 1.2204812556422338, "mean_action_processing_ms": 0.14219080801012285, "mean_env_wait_ms": 0.08418143599079196, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020000219345092773, "StateBufferConnector_ms": 0.009001493453979492, "ViewRequirementAgentConnector_ms": 0.12274622917175293}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 198000, "num_agent_steps_trained": 198000, "num_env_steps_sampled": 198000, "num_env_steps_trained": 198000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5610.058733708643, "num_env_steps_trained_throughput_per_sec": 5610.058733708643, "timesteps_total": 198000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 198000, "timers": {"training_iteration_time_ms": 3185.071, "sample_time_ms": 2925.581, "load_time_ms": 20.327, "load_throughput": 885542.674, "learn_time_ms": 226.689, "learn_throughput": 79403.898, "synch_weights_time_ms": 10.102}, "counters": {"num_env_steps_sampled": 198000, "num_env_steps_trained": 198000, "num_agent_steps_sampled": 198000, "num_agent_steps_trained": 198000}, "done": false, "episodes_total": 696, "training_iteration": 11, "trial_id": "9f288_00014", "date": "2023-10-25_16-42-28", "timestamp": 1698248548, "time_this_iter_s": 3.2175142765045166, "time_total_s": 34.82184958457947, "pid": 9504, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 34.82184958457947, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 58.64000000000001, "ram_util_percent": 27.380000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.765625000000002e-05, "cur_lr": 0.0003, "total_loss": 8.193665305773417, "policy_loss": -0.00561591621953994, "vf_loss": 8.19933545589447, "vf_explained_var": 7.996956507364909e-07, "kl": 0.0003634807750548437, "entropy": 0.5433622847000757, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 138.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.675999999999822, "episode_len_mean": 263.86, "episode_media": {}, "episodes_this_iter": 63, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.099999999999994, 46.099999999999994, 37.70000000000003, -50.00000000000044, 43.900000000000006, 33.10000000000003, 46.9, 17.899999999999814, 41.70000000000002, 43.50000000000001, 44.5, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 25.699999999999925, -50.00000000000044, -50.00000000000044, 45.1, 22.49999999999988, 43.30000000000001, -50.00000000000044, -50.00000000000044, 26.89999999999994, 39.300000000000026, 39.300000000000026, 15.49999999999978, 30.499999999999993, -50.00000000000044, -50.00000000000044, 39.300000000000026, -50.00000000000044, 41.70000000000002, 37.50000000000003, 46.3, -50.00000000000044, 44.7, 40.30000000000002, -50.00000000000044, 39.90000000000002, 24.499999999999908, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 41.70000000000002, -50.00000000000044, 44.10000000000001, 35.900000000000034, 34.50000000000004, 36.30000000000003, -50.00000000000044, 47.5, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 1.099999999999575, 44.900000000000006, 34.900000000000034, -50.00000000000044, 46.699999999999996, -50.00000000000044, 41.70000000000002, 40.90000000000002, -50.00000000000044, 46.099999999999994, -50.00000000000044, 46.699999999999996, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.7, 42.70000000000001, -50.00000000000044, 38.300000000000026, 32.100000000000016, -50.00000000000044, 7.899999999999672, -50.00000000000044, 26.69999999999994, 45.9, -50.00000000000044, 37.10000000000003, -50.00000000000044, 39.300000000000026, 33.30000000000003, -50.00000000000044, 41.500000000000014, 42.900000000000006, 36.900000000000034, 46.3, -50.00000000000044, 41.90000000000001, -50.00000000000044], "episode_lengths": [40, 40, 124, 500, 62, 170, 32, 322, 84, 66, 56, 94, 500, 500, 500, 86, 244, 500, 500, 50, 276, 68, 500, 500, 232, 108, 108, 346, 196, 500, 500, 108, 500, 84, 126, 38, 500, 54, 98, 500, 102, 256, 52, 500, 500, 500, 64, 500, 84, 500, 60, 142, 156, 138, 500, 26, 58, 500, 500, 500, 500, 490, 52, 152, 500, 34, 500, 84, 92, 500, 40, 500, 34, 48, 500, 500, 500, 24, 74, 500, 118, 180, 500, 422, 500, 234, 42, 500, 130, 500, 108, 168, 500, 86, 72, 132, 38, 500, 82, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3835368844448469, "mean_inference_ms": 1.2257085388178515, "mean_action_processing_ms": 0.14373631265158868, "mean_env_wait_ms": 0.08456368845685674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019999265670776367, "StateBufferConnector_ms": 0.006000518798828125, "ViewRequirementAgentConnector_ms": 0.12667274475097656}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.675999999999822, "episode_len_mean": 263.86, "episodes_this_iter": 63, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.099999999999994, 46.099999999999994, 37.70000000000003, -50.00000000000044, 43.900000000000006, 33.10000000000003, 46.9, 17.899999999999814, 41.70000000000002, 43.50000000000001, 44.5, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 25.699999999999925, -50.00000000000044, -50.00000000000044, 45.1, 22.49999999999988, 43.30000000000001, -50.00000000000044, -50.00000000000044, 26.89999999999994, 39.300000000000026, 39.300000000000026, 15.49999999999978, 30.499999999999993, -50.00000000000044, -50.00000000000044, 39.300000000000026, -50.00000000000044, 41.70000000000002, 37.50000000000003, 46.3, -50.00000000000044, 44.7, 40.30000000000002, -50.00000000000044, 39.90000000000002, 24.499999999999908, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 41.70000000000002, -50.00000000000044, 44.10000000000001, 35.900000000000034, 34.50000000000004, 36.30000000000003, -50.00000000000044, 47.5, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 1.099999999999575, 44.900000000000006, 34.900000000000034, -50.00000000000044, 46.699999999999996, -50.00000000000044, 41.70000000000002, 40.90000000000002, -50.00000000000044, 46.099999999999994, -50.00000000000044, 46.699999999999996, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.7, 42.70000000000001, -50.00000000000044, 38.300000000000026, 32.100000000000016, -50.00000000000044, 7.899999999999672, -50.00000000000044, 26.69999999999994, 45.9, -50.00000000000044, 37.10000000000003, -50.00000000000044, 39.300000000000026, 33.30000000000003, -50.00000000000044, 41.500000000000014, 42.900000000000006, 36.900000000000034, 46.3, -50.00000000000044, 41.90000000000001, -50.00000000000044], "episode_lengths": [40, 40, 124, 500, 62, 170, 32, 322, 84, 66, 56, 94, 500, 500, 500, 86, 244, 500, 500, 50, 276, 68, 500, 500, 232, 108, 108, 346, 196, 500, 500, 108, 500, 84, 126, 38, 500, 54, 98, 500, 102, 256, 52, 500, 500, 500, 64, 500, 84, 500, 60, 142, 156, 138, 500, 26, 58, 500, 500, 500, 500, 490, 52, 152, 500, 34, 500, 84, 92, 500, 40, 500, 34, 48, 500, 500, 500, 24, 74, 500, 118, 180, 500, 422, 500, 234, 42, 500, 130, 500, 108, 168, 500, 86, 72, 132, 38, 500, 82, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3835368844448469, "mean_inference_ms": 1.2257085388178515, "mean_action_processing_ms": 0.14373631265158868, "mean_env_wait_ms": 0.08456368845685674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019999265670776367, "StateBufferConnector_ms": 0.006000518798828125, "ViewRequirementAgentConnector_ms": 0.12667274475097656}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5437.674493074727, "num_env_steps_trained_throughput_per_sec": 5437.674493074727, "timesteps_total": 216000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 216000, "timers": {"training_iteration_time_ms": 3219.638, "sample_time_ms": 2946.863, "load_time_ms": 21.201, "load_throughput": 849014.065, "learn_time_ms": 239.225, "learn_throughput": 75243.06, "synch_weights_time_ms": 9.977}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "done": false, "episodes_total": 759, "training_iteration": 12, "trial_id": "9f288_00014", "date": "2023-10-25_16-42-31", "timestamp": 1698248551, "time_this_iter_s": 3.3162336349487305, "time_total_s": 38.1380832195282, "pid": 9504, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 38.1380832195282, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 70.35, "ram_util_percent": 27.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.882812500000001e-05, "cur_lr": 0.0003, "total_loss": 8.032021363576254, "policy_loss": -0.01937891022923092, "vf_loss": 8.051452358563742, "vf_explained_var": 2.2202730178833008e-06, "kl": 0.00031746326293576505, "entropy": 0.519157831867536, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 150.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 234000, "num_env_steps_trained": 234000, "num_agent_steps_sampled": 234000, "num_agent_steps_trained": 234000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.7730000000002095, "episode_len_mean": 293.28, "episode_media": {}, "episodes_this_iter": 60, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 1.099999999999575, 44.900000000000006, 34.900000000000034, -50.00000000000044, 46.699999999999996, -50.00000000000044, 41.70000000000002, 40.90000000000002, -50.00000000000044, 46.099999999999994, -50.00000000000044, 46.699999999999996, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.7, 42.70000000000001, -50.00000000000044, 38.300000000000026, 32.100000000000016, -50.00000000000044, 7.899999999999672, -50.00000000000044, 26.69999999999994, 45.9, -50.00000000000044, 37.10000000000003, -50.00000000000044, 39.300000000000026, 33.30000000000003, -50.00000000000044, 41.500000000000014, 42.900000000000006, 36.900000000000034, 46.3, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 38.700000000000024, 45.9, 37.90000000000003, -50.00000000000044, 44.5, 28.699999999999967, -50.00000000000044, -50.00000000000044, 23.099999999999888, -50.00000000000044, 40.90000000000002, 29.69999999999998, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.50000000000003, 27.899999999999956, 43.50000000000001, -50.00000000000044, -50.00000000000044, 33.70000000000004, 44.7, -50.00000000000044, 34.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 44.7, -50.00000000000044, 4.899999999999629, -50.00000000000044, 24.69999999999991, 43.10000000000001, 41.100000000000016, 45.5, -50.00000000000044, 38.300000000000026, 38.700000000000024, 45.3, 45.7, -50.00000000000044, -50.00000000000044, 19.499999999999837, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 490, 52, 152, 500, 34, 500, 84, 92, 500, 40, 500, 34, 48, 500, 500, 500, 24, 74, 500, 118, 180, 500, 422, 500, 234, 42, 500, 130, 500, 108, 168, 500, 86, 72, 132, 38, 500, 82, 500, 500, 98, 500, 500, 42, 500, 500, 54, 500, 114, 42, 122, 500, 56, 214, 500, 500, 270, 500, 92, 204, 60, 500, 500, 500, 98, 500, 500, 500, 126, 222, 66, 500, 500, 164, 54, 500, 160, 500, 500, 500, 38, 54, 500, 452, 500, 254, 70, 90, 46, 500, 118, 114, 48, 44, 500, 500, 306, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38486577093980356, "mean_inference_ms": 1.2292195733419364, "mean_action_processing_ms": 0.14433014002630123, "mean_env_wait_ms": 0.0850689389593338, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027998685836791992, "StateBufferConnector_ms": 0.0029997825622558594, "ViewRequirementAgentConnector_ms": 0.13201165199279785}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.7730000000002095, "episode_len_mean": 293.28, "episodes_this_iter": 60, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 1.099999999999575, 44.900000000000006, 34.900000000000034, -50.00000000000044, 46.699999999999996, -50.00000000000044, 41.70000000000002, 40.90000000000002, -50.00000000000044, 46.099999999999994, -50.00000000000044, 46.699999999999996, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.7, 42.70000000000001, -50.00000000000044, 38.300000000000026, 32.100000000000016, -50.00000000000044, 7.899999999999672, -50.00000000000044, 26.69999999999994, 45.9, -50.00000000000044, 37.10000000000003, -50.00000000000044, 39.300000000000026, 33.30000000000003, -50.00000000000044, 41.500000000000014, 42.900000000000006, 36.900000000000034, 46.3, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 38.700000000000024, 45.9, 37.90000000000003, -50.00000000000044, 44.5, 28.699999999999967, -50.00000000000044, -50.00000000000044, 23.099999999999888, -50.00000000000044, 40.90000000000002, 29.69999999999998, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.50000000000003, 27.899999999999956, 43.50000000000001, -50.00000000000044, -50.00000000000044, 33.70000000000004, 44.7, -50.00000000000044, 34.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 44.7, -50.00000000000044, 4.899999999999629, -50.00000000000044, 24.69999999999991, 43.10000000000001, 41.100000000000016, 45.5, -50.00000000000044, 38.300000000000026, 38.700000000000024, 45.3, 45.7, -50.00000000000044, -50.00000000000044, 19.499999999999837, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 490, 52, 152, 500, 34, 500, 84, 92, 500, 40, 500, 34, 48, 500, 500, 500, 24, 74, 500, 118, 180, 500, 422, 500, 234, 42, 500, 130, 500, 108, 168, 500, 86, 72, 132, 38, 500, 82, 500, 500, 98, 500, 500, 42, 500, 500, 54, 500, 114, 42, 122, 500, 56, 214, 500, 500, 270, 500, 92, 204, 60, 500, 500, 500, 98, 500, 500, 500, 126, 222, 66, 500, 500, 164, 54, 500, 160, 500, 500, 500, 38, 54, 500, 452, 500, 254, 70, 90, 46, 500, 118, 114, 48, 44, 500, 500, 306, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38486577093980356, "mean_inference_ms": 1.2292195733419364, "mean_action_processing_ms": 0.14433014002630123, "mean_env_wait_ms": 0.0850689389593338, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027998685836791992, "StateBufferConnector_ms": 0.0029997825622558594, "ViewRequirementAgentConnector_ms": 0.13201165199279785}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 234000, "num_agent_steps_trained": 234000, "num_env_steps_sampled": 234000, "num_env_steps_trained": 234000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5462.306148563206, "num_env_steps_trained_throughput_per_sec": 5462.306148563206, "timesteps_total": 234000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 234000, "timers": {"training_iteration_time_ms": 3240.44, "sample_time_ms": 2969.638, "load_time_ms": 20.201, "load_throughput": 891055.883, "learn_time_ms": 238.297, "learn_throughput": 75535.859, "synch_weights_time_ms": 9.932}, "counters": {"num_env_steps_sampled": 234000, "num_env_steps_trained": 234000, "num_agent_steps_sampled": 234000, "num_agent_steps_trained": 234000}, "done": false, "episodes_total": 819, "training_iteration": 13, "trial_id": "9f288_00014", "date": "2023-10-25_16-42-35", "timestamp": 1698248555, "time_this_iter_s": 3.301945447921753, "time_total_s": 41.44002866744995, "pid": 9504, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 41.44002866744995, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 64.42, "ram_util_percent": 27.339999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.4414062500000005e-05, "cur_lr": 0.0003, "total_loss": 7.499443809191386, "policy_loss": 0.03554104578991731, "vf_loss": 7.463954567909241, "vf_explained_var": -3.9736429850260414e-08, "kl": 0.00018085429139584144, "entropy": 0.519463007648786, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 162.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.6799999999998114, "episode_len_mean": 273.82, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 37.50000000000003, 27.899999999999956, 43.50000000000001, -50.00000000000044, -50.00000000000044, 33.70000000000004, 44.7, -50.00000000000044, 34.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 44.7, -50.00000000000044, 4.899999999999629, -50.00000000000044, 24.69999999999991, 43.10000000000001, 41.100000000000016, 45.5, -50.00000000000044, 38.300000000000026, 38.700000000000024, 45.3, 45.7, -50.00000000000044, -50.00000000000044, 19.499999999999837, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.50000000000004, 45.3, 44.7, 28.89999999999997, -50.00000000000044, 26.09999999999993, 40.30000000000002, 32.50000000000002, 46.5, 45.3, -50.00000000000044, -50.00000000000044, 47.5, 45.3, -50.00000000000044, 16.499999999999794, 30.9, 30.29999999999999, 44.7, -50.00000000000044, 43.900000000000006, 41.500000000000014, -50.00000000000044, -50.00000000000044, 46.3, 46.099999999999994, 15.49999999999978, -50.00000000000044, -50.00000000000044, 45.3, 47.1, -50.00000000000044, 28.699999999999967, 5.499999999999638, 43.7, 41.100000000000016, 45.9, -50.00000000000044, 41.30000000000001, -50.00000000000044, 46.3, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 13.699999999999754, -50.00000000000044, 22.49999999999988, 38.50000000000003, 45.5, 43.30000000000001, -50.00000000000044, -50.00000000000044, 44.10000000000001, 37.90000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, 14.09999999999976, 47.3, 0.8999999999995723, 38.50000000000003, 40.10000000000002], "episode_lengths": [500, 126, 222, 66, 500, 500, 164, 54, 500, 160, 500, 500, 500, 38, 54, 500, 452, 500, 254, 70, 90, 46, 500, 118, 114, 48, 44, 500, 500, 306, 500, 500, 500, 156, 48, 54, 212, 500, 240, 98, 176, 36, 48, 500, 500, 26, 48, 500, 336, 192, 198, 54, 500, 62, 86, 500, 500, 38, 40, 346, 500, 500, 48, 30, 500, 214, 446, 64, 90, 42, 500, 88, 500, 38, 500, 50, 500, 500, 62, 500, 500, 364, 500, 276, 116, 46, 68, 500, 500, 60, 122, 500, 500, 500, 142, 360, 28, 492, 116, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38706276122462957, "mean_inference_ms": 1.248020484746796, "mean_action_processing_ms": 0.14507443808056536, "mean_env_wait_ms": 0.08681695775512345, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.034824371337890625, "StateBufferConnector_ms": 0.003999471664428711, "ViewRequirementAgentConnector_ms": 0.14178204536437988}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.6799999999998114, "episode_len_mean": 273.82, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 37.50000000000003, 27.899999999999956, 43.50000000000001, -50.00000000000044, -50.00000000000044, 33.70000000000004, 44.7, -50.00000000000044, 34.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 44.7, -50.00000000000044, 4.899999999999629, -50.00000000000044, 24.69999999999991, 43.10000000000001, 41.100000000000016, 45.5, -50.00000000000044, 38.300000000000026, 38.700000000000024, 45.3, 45.7, -50.00000000000044, -50.00000000000044, 19.499999999999837, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.50000000000004, 45.3, 44.7, 28.89999999999997, -50.00000000000044, 26.09999999999993, 40.30000000000002, 32.50000000000002, 46.5, 45.3, -50.00000000000044, -50.00000000000044, 47.5, 45.3, -50.00000000000044, 16.499999999999794, 30.9, 30.29999999999999, 44.7, -50.00000000000044, 43.900000000000006, 41.500000000000014, -50.00000000000044, -50.00000000000044, 46.3, 46.099999999999994, 15.49999999999978, -50.00000000000044, -50.00000000000044, 45.3, 47.1, -50.00000000000044, 28.699999999999967, 5.499999999999638, 43.7, 41.100000000000016, 45.9, -50.00000000000044, 41.30000000000001, -50.00000000000044, 46.3, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 13.699999999999754, -50.00000000000044, 22.49999999999988, 38.50000000000003, 45.5, 43.30000000000001, -50.00000000000044, -50.00000000000044, 44.10000000000001, 37.90000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, 14.09999999999976, 47.3, 0.8999999999995723, 38.50000000000003, 40.10000000000002], "episode_lengths": [500, 126, 222, 66, 500, 500, 164, 54, 500, 160, 500, 500, 500, 38, 54, 500, 452, 500, 254, 70, 90, 46, 500, 118, 114, 48, 44, 500, 500, 306, 500, 500, 500, 156, 48, 54, 212, 500, 240, 98, 176, 36, 48, 500, 500, 26, 48, 500, 336, 192, 198, 54, 500, 62, 86, 500, 500, 38, 40, 346, 500, 500, 48, 30, 500, 214, 446, 64, 90, 42, 500, 88, 500, 38, 500, 50, 500, 500, 62, 500, 500, 364, 500, 276, 116, 46, 68, 500, 500, 60, 122, 500, 500, 500, 142, 360, 28, 492, 116, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38706276122462957, "mean_inference_ms": 1.248020484746796, "mean_action_processing_ms": 0.14507443808056536, "mean_env_wait_ms": 0.08681695775512345, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.034824371337890625, "StateBufferConnector_ms": 0.003999471664428711, "ViewRequirementAgentConnector_ms": 0.14178204536437988}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4856.0707000675175, "num_env_steps_trained_throughput_per_sec": 4856.0707000675175, "timesteps_total": 252000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 252000, "timers": {"training_iteration_time_ms": 3310.635, "sample_time_ms": 3033.431, "load_time_ms": 21.822, "load_throughput": 824845.754, "learn_time_ms": 243.053, "learn_throughput": 74058.072, "synch_weights_time_ms": 9.856}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "done": false, "episodes_total": 887, "training_iteration": 14, "trial_id": "9f288_00014", "date": "2023-10-25_16-42-38", "timestamp": 1698248558, "time_this_iter_s": 3.7140321731567383, "time_total_s": 45.15406084060669, "pid": 9504, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 45.15406084060669, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 69.62, "ram_util_percent": 27.380000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.2207031250000002e-05, "cur_lr": 0.0003, "total_loss": 6.802450656890869, "policy_loss": 0.019407110909620922, "vf_loss": 6.783098379770915, "vf_explained_var": 4.520018895467122e-07, "kl": 4.6012684379093116e-05, "entropy": 0.5482486536105474, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 174.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 270000, "num_env_steps_trained": 270000, "num_agent_steps_sampled": 270000, "num_agent_steps_trained": 270000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.78699999999985, "episode_len_mean": 237.84, "episode_media": {}, "episodes_this_iter": 79, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 13.699999999999754, -50.00000000000044, 22.49999999999988, 38.50000000000003, 45.5, 43.30000000000001, -50.00000000000044, -50.00000000000044, 44.10000000000001, 37.90000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, 14.09999999999976, 47.3, 0.8999999999995723, 38.50000000000003, 40.10000000000002, -50.00000000000044, 22.699999999999882, 42.500000000000014, 1.6999999999995836, -50.00000000000044, 34.50000000000004, 35.900000000000034, 46.099999999999994, 44.7, 44.5, 44.5, 35.900000000000034, -50.00000000000044, 24.499999999999908, 25.699999999999925, 46.099999999999994, 38.50000000000003, 47.5, -50.00000000000044, 31.500000000000007, 24.69999999999991, 45.9, 41.70000000000002, 33.90000000000004, 43.50000000000001, 44.900000000000006, -50.00000000000044, 46.099999999999994, 44.300000000000004, -50.00000000000044, -50.00000000000044, 38.50000000000003, 43.30000000000001, 47.3, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 26.09999999999993, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 45.9, 44.7, -50.00000000000044, -50.00000000000044, 38.300000000000026, 44.5, 40.10000000000002, 37.300000000000026, 26.69999999999994, 45.3, 33.500000000000036, 46.9, 45.1, 42.900000000000006, 33.10000000000003, 37.300000000000026, -50.00000000000044, 42.900000000000006, 34.900000000000034, 45.7, 37.300000000000026, -50.00000000000044, 46.099999999999994, 27.299999999999947, 45.1, 41.90000000000001, -50.00000000000044, -50.00000000000044, 19.09999999999983, -50.00000000000044, 32.100000000000016, 46.3, 45.1, 38.10000000000002, 3.2999999999996064], "episode_lengths": [500, 500, 364, 500, 276, 116, 46, 68, 500, 500, 60, 122, 500, 500, 500, 142, 360, 28, 492, 116, 100, 500, 274, 76, 484, 500, 156, 142, 40, 54, 56, 56, 142, 500, 256, 244, 40, 116, 26, 500, 186, 254, 42, 84, 162, 66, 52, 500, 40, 58, 500, 500, 116, 68, 28, 500, 50, 500, 500, 240, 500, 500, 26, 500, 500, 42, 54, 500, 500, 118, 56, 100, 128, 234, 48, 166, 32, 50, 72, 170, 128, 500, 72, 152, 44, 128, 500, 40, 228, 50, 82, 500, 500, 310, 500, 180, 38, 50, 120, 468]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3885980624455631, "mean_inference_ms": 1.2582717758482551, "mean_action_processing_ms": 0.14575340939860645, "mean_env_wait_ms": 0.08731483074220925, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02600717544555664, "StateBufferConnector_ms": 0.0060007572174072266, "ViewRequirementAgentConnector_ms": 0.1319890022277832}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.78699999999985, "episode_len_mean": 237.84, "episodes_this_iter": 79, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 13.699999999999754, -50.00000000000044, 22.49999999999988, 38.50000000000003, 45.5, 43.30000000000001, -50.00000000000044, -50.00000000000044, 44.10000000000001, 37.90000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, 14.09999999999976, 47.3, 0.8999999999995723, 38.50000000000003, 40.10000000000002, -50.00000000000044, 22.699999999999882, 42.500000000000014, 1.6999999999995836, -50.00000000000044, 34.50000000000004, 35.900000000000034, 46.099999999999994, 44.7, 44.5, 44.5, 35.900000000000034, -50.00000000000044, 24.499999999999908, 25.699999999999925, 46.099999999999994, 38.50000000000003, 47.5, -50.00000000000044, 31.500000000000007, 24.69999999999991, 45.9, 41.70000000000002, 33.90000000000004, 43.50000000000001, 44.900000000000006, -50.00000000000044, 46.099999999999994, 44.300000000000004, -50.00000000000044, -50.00000000000044, 38.50000000000003, 43.30000000000001, 47.3, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 26.09999999999993, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 45.9, 44.7, -50.00000000000044, -50.00000000000044, 38.300000000000026, 44.5, 40.10000000000002, 37.300000000000026, 26.69999999999994, 45.3, 33.500000000000036, 46.9, 45.1, 42.900000000000006, 33.10000000000003, 37.300000000000026, -50.00000000000044, 42.900000000000006, 34.900000000000034, 45.7, 37.300000000000026, -50.00000000000044, 46.099999999999994, 27.299999999999947, 45.1, 41.90000000000001, -50.00000000000044, -50.00000000000044, 19.09999999999983, -50.00000000000044, 32.100000000000016, 46.3, 45.1, 38.10000000000002, 3.2999999999996064], "episode_lengths": [500, 500, 364, 500, 276, 116, 46, 68, 500, 500, 60, 122, 500, 500, 500, 142, 360, 28, 492, 116, 100, 500, 274, 76, 484, 500, 156, 142, 40, 54, 56, 56, 142, 500, 256, 244, 40, 116, 26, 500, 186, 254, 42, 84, 162, 66, 52, 500, 40, 58, 500, 500, 116, 68, 28, 500, 50, 500, 500, 240, 500, 500, 26, 500, 500, 42, 54, 500, 500, 118, 56, 100, 128, 234, 48, 166, 32, 50, 72, 170, 128, 500, 72, 152, 44, 128, 500, 40, 228, 50, 82, 500, 500, 310, 500, 180, 38, 50, 120, 468]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3885980624455631, "mean_inference_ms": 1.2582717758482551, "mean_action_processing_ms": 0.14575340939860645, "mean_env_wait_ms": 0.08731483074220925, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02600717544555664, "StateBufferConnector_ms": 0.0060007572174072266, "ViewRequirementAgentConnector_ms": 0.1319890022277832}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 270000, "num_agent_steps_trained": 270000, "num_env_steps_sampled": 270000, "num_env_steps_trained": 270000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5500.08417960365, "num_env_steps_trained_throughput_per_sec": 5500.08417960365, "timesteps_total": 270000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 270000, "timers": {"training_iteration_time_ms": 3322.6, "sample_time_ms": 3054.219, "load_time_ms": 20.185, "load_throughput": 891767.377, "learn_time_ms": 235.86, "learn_throughput": 76316.362, "synch_weights_time_ms": 9.763}, "counters": {"num_env_steps_sampled": 270000, "num_env_steps_trained": 270000, "num_agent_steps_sampled": 270000, "num_agent_steps_trained": 270000}, "done": false, "episodes_total": 966, "training_iteration": 15, "trial_id": "9f288_00014", "date": "2023-10-25_16-42-42", "timestamp": 1698248562, "time_this_iter_s": 3.278684377670288, "time_total_s": 48.43274521827698, "pid": 9504, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 48.43274521827698, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 64.5, "ram_util_percent": 27.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.103515625000001e-06, "cur_lr": 0.0003, "total_loss": 7.267163872718811, "policy_loss": -0.00713737200324734, "vf_loss": 7.274353822072347, "vf_explained_var": -2.602736155192057e-06, "kl": 0.00010161250156855613, "entropy": 0.5259723464647929, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 186.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 14.145999999999871, "episode_len_mean": 219.26, "episode_media": {}, "episodes_this_iter": 90, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.90000000000001, -50.00000000000044, -50.00000000000044, 19.09999999999983, -50.00000000000044, 32.100000000000016, 46.3, 45.1, 38.10000000000002, 3.2999999999996064, -50.00000000000044, 35.70000000000003, -50.00000000000044, -50.00000000000044, 38.90000000000002, 45.1, 45.9, 44.900000000000006, -50.00000000000044, 37.10000000000003, 44.5, 38.700000000000024, -50.00000000000044, 40.10000000000002, 28.09999999999996, -50.00000000000044, 45.7, 21.499999999999865, 43.10000000000001, 43.10000000000001, -50.00000000000044, 45.1, 44.300000000000004, -50.00000000000044, 44.300000000000004, 37.50000000000003, 47.1, 37.300000000000026, 41.500000000000014, -50.00000000000044, 34.70000000000004, 44.300000000000004, 30.699999999999996, 46.699999999999996, 39.70000000000002, 44.300000000000004, 45.7, 46.099999999999994, 44.900000000000006, -50.00000000000044, 44.10000000000001, 45.3, 46.099999999999994, -50.00000000000044, 33.70000000000004, 38.700000000000024, 40.30000000000002, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 44.300000000000004, 45.3, 42.70000000000001, 46.9, 46.099999999999994, -50.00000000000044, 37.50000000000003, 32.50000000000002, 44.7, -50.00000000000044, 43.900000000000006, 32.700000000000024, -50.00000000000044, 14.899999999999771, 44.5, 40.10000000000002, 20.49999999999985, -50.00000000000044, 24.099999999999902, 47.3, 16.8999999999998, -50.00000000000044, 46.099999999999994, -50.00000000000044, 43.30000000000001, -50.00000000000044, 33.30000000000003, 33.70000000000004, -50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, 44.5, 34.900000000000034, 42.900000000000006, -50.00000000000044, 44.300000000000004, 46.699999999999996, 32.90000000000003], "episode_lengths": [82, 500, 500, 310, 500, 180, 38, 50, 120, 468, 500, 144, 500, 500, 112, 50, 42, 52, 500, 130, 56, 114, 500, 100, 220, 500, 44, 286, 70, 70, 500, 50, 58, 500, 58, 126, 30, 128, 86, 500, 154, 58, 194, 34, 104, 58, 44, 40, 52, 500, 60, 48, 40, 500, 164, 114, 98, 500, 500, 36, 500, 58, 48, 74, 32, 40, 500, 126, 176, 54, 500, 62, 174, 500, 352, 56, 100, 296, 500, 260, 28, 332, 500, 40, 500, 68, 500, 168, 164, 500, 500, 102, 500, 56, 152, 72, 500, 58, 34, 172]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3880664284042831, "mean_inference_ms": 1.2566258552765646, "mean_action_processing_ms": 0.14455235612242226, "mean_env_wait_ms": 0.08730882796145138, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017999649047851562, "StateBufferConnector_ms": 0.004000186920166016, "ViewRequirementAgentConnector_ms": 0.12501049041748047}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 14.145999999999871, "episode_len_mean": 219.26, "episodes_this_iter": 90, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [41.90000000000001, -50.00000000000044, -50.00000000000044, 19.09999999999983, -50.00000000000044, 32.100000000000016, 46.3, 45.1, 38.10000000000002, 3.2999999999996064, -50.00000000000044, 35.70000000000003, -50.00000000000044, -50.00000000000044, 38.90000000000002, 45.1, 45.9, 44.900000000000006, -50.00000000000044, 37.10000000000003, 44.5, 38.700000000000024, -50.00000000000044, 40.10000000000002, 28.09999999999996, -50.00000000000044, 45.7, 21.499999999999865, 43.10000000000001, 43.10000000000001, -50.00000000000044, 45.1, 44.300000000000004, -50.00000000000044, 44.300000000000004, 37.50000000000003, 47.1, 37.300000000000026, 41.500000000000014, -50.00000000000044, 34.70000000000004, 44.300000000000004, 30.699999999999996, 46.699999999999996, 39.70000000000002, 44.300000000000004, 45.7, 46.099999999999994, 44.900000000000006, -50.00000000000044, 44.10000000000001, 45.3, 46.099999999999994, -50.00000000000044, 33.70000000000004, 38.700000000000024, 40.30000000000002, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 44.300000000000004, 45.3, 42.70000000000001, 46.9, 46.099999999999994, -50.00000000000044, 37.50000000000003, 32.50000000000002, 44.7, -50.00000000000044, 43.900000000000006, 32.700000000000024, -50.00000000000044, 14.899999999999771, 44.5, 40.10000000000002, 20.49999999999985, -50.00000000000044, 24.099999999999902, 47.3, 16.8999999999998, -50.00000000000044, 46.099999999999994, -50.00000000000044, 43.30000000000001, -50.00000000000044, 33.30000000000003, 33.70000000000004, -50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, 44.5, 34.900000000000034, 42.900000000000006, -50.00000000000044, 44.300000000000004, 46.699999999999996, 32.90000000000003], "episode_lengths": [82, 500, 500, 310, 500, 180, 38, 50, 120, 468, 500, 144, 500, 500, 112, 50, 42, 52, 500, 130, 56, 114, 500, 100, 220, 500, 44, 286, 70, 70, 500, 50, 58, 500, 58, 126, 30, 128, 86, 500, 154, 58, 194, 34, 104, 58, 44, 40, 52, 500, 60, 48, 40, 500, 164, 114, 98, 500, 500, 36, 500, 58, 48, 74, 32, 40, 500, 126, 176, 54, 500, 62, 174, 500, 352, 56, 100, 296, 500, 260, 28, 332, 500, 40, 500, 68, 500, 168, 164, 500, 500, 102, 500, 56, 152, 72, 500, 58, 34, 172]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3880664284042831, "mean_inference_ms": 1.2566258552765646, "mean_action_processing_ms": 0.14455235612242226, "mean_env_wait_ms": 0.08730882796145138, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017999649047851562, "StateBufferConnector_ms": 0.004000186920166016, "ViewRequirementAgentConnector_ms": 0.12501049041748047}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5614.808001347004, "num_env_steps_trained_throughput_per_sec": 5614.808001347004, "timesteps_total": 288000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 3308.649, "sample_time_ms": 3040.525, "load_time_ms": 20.265, "load_throughput": 888232.722, "learn_time_ms": 235.502, "learn_throughput": 76432.447, "synch_weights_time_ms": 9.793}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "episodes_total": 1056, "training_iteration": 16, "trial_id": "9f288_00014", "date": "2023-10-25_16-42-45", "timestamp": 1698248565, "time_this_iter_s": 3.2111339569091797, "time_total_s": 51.64387917518616, "pid": 9504, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 51.64387917518616, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 68.75, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.0517578125000006e-06, "cur_lr": 0.0003, "total_loss": 6.364210287729899, "policy_loss": -0.04146222801258167, "vf_loss": 6.405724962552388, "vf_explained_var": 1.276532808939616e-06, "kl": 0.00017643421230162382, "entropy": 0.5245707109570503, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 198.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 306000, "num_env_steps_trained": 306000, "num_agent_steps_sampled": 306000, "num_agent_steps_trained": 306000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.8609999999998177, "episode_len_mean": 267.0, "episode_media": {}, "episodes_this_iter": 58, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.5, -50.00000000000044, 44.300000000000004, 45.3, 42.70000000000001, 46.9, 46.099999999999994, -50.00000000000044, 37.50000000000003, 32.50000000000002, 44.7, -50.00000000000044, 43.900000000000006, 32.700000000000024, -50.00000000000044, 14.899999999999771, 44.5, 40.10000000000002, 20.49999999999985, -50.00000000000044, 24.099999999999902, 47.3, 16.8999999999998, -50.00000000000044, 46.099999999999994, -50.00000000000044, 43.30000000000001, -50.00000000000044, 33.30000000000003, 33.70000000000004, -50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, 44.5, 34.900000000000034, 42.900000000000006, -50.00000000000044, 44.300000000000004, 46.699999999999996, 32.90000000000003, -50.00000000000044, 37.70000000000003, -50.00000000000044, 46.699999999999996, 44.10000000000001, 45.3, 46.699999999999996, 33.500000000000036, 36.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 45.7, -50.00000000000044, 45.1, 46.5, 42.500000000000014, 42.70000000000001, 36.900000000000034, 45.7, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, 7.499999999999666, 36.10000000000004, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, -50.00000000000044, 39.10000000000002, 36.30000000000003, 40.70000000000002, -50.00000000000044, 46.699999999999996, 43.50000000000001, 20.299999999999848, 23.699999999999896, 44.7, 12.69999999999974, -50.00000000000044, -50.00000000000044, 46.9, 30.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.10000000000002, -50.00000000000044], "episode_lengths": [500, 36, 500, 58, 48, 74, 32, 40, 500, 126, 176, 54, 500, 62, 174, 500, 352, 56, 100, 296, 500, 260, 28, 332, 500, 40, 500, 68, 500, 168, 164, 500, 500, 102, 500, 56, 152, 72, 500, 58, 34, 172, 500, 124, 500, 34, 60, 48, 34, 166, 140, 500, 500, 500, 500, 62, 500, 44, 500, 50, 36, 76, 74, 132, 44, 500, 98, 500, 500, 426, 140, 500, 500, 130, 500, 500, 110, 138, 94, 500, 34, 66, 298, 264, 54, 374, 500, 500, 32, 194, 500, 500, 500, 114, 500, 500, 500, 500, 120, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3875819831786459, "mean_inference_ms": 1.2579580335413056, "mean_action_processing_ms": 0.14592130033177692, "mean_env_wait_ms": 0.08661354795554088, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017005443572998047, "StateBufferConnector_ms": 0.005983114242553711, "ViewRequirementAgentConnector_ms": 0.11700773239135742}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.8609999999998177, "episode_len_mean": 267.0, "episodes_this_iter": 58, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.5, -50.00000000000044, 44.300000000000004, 45.3, 42.70000000000001, 46.9, 46.099999999999994, -50.00000000000044, 37.50000000000003, 32.50000000000002, 44.7, -50.00000000000044, 43.900000000000006, 32.700000000000024, -50.00000000000044, 14.899999999999771, 44.5, 40.10000000000002, 20.49999999999985, -50.00000000000044, 24.099999999999902, 47.3, 16.8999999999998, -50.00000000000044, 46.099999999999994, -50.00000000000044, 43.30000000000001, -50.00000000000044, 33.30000000000003, 33.70000000000004, -50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, 44.5, 34.900000000000034, 42.900000000000006, -50.00000000000044, 44.300000000000004, 46.699999999999996, 32.90000000000003, -50.00000000000044, 37.70000000000003, -50.00000000000044, 46.699999999999996, 44.10000000000001, 45.3, 46.699999999999996, 33.500000000000036, 36.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 45.7, -50.00000000000044, 45.1, 46.5, 42.500000000000014, 42.70000000000001, 36.900000000000034, 45.7, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, 7.499999999999666, 36.10000000000004, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, -50.00000000000044, 39.10000000000002, 36.30000000000003, 40.70000000000002, -50.00000000000044, 46.699999999999996, 43.50000000000001, 20.299999999999848, 23.699999999999896, 44.7, 12.69999999999974, -50.00000000000044, -50.00000000000044, 46.9, 30.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.10000000000002, -50.00000000000044], "episode_lengths": [500, 36, 500, 58, 48, 74, 32, 40, 500, 126, 176, 54, 500, 62, 174, 500, 352, 56, 100, 296, 500, 260, 28, 332, 500, 40, 500, 68, 500, 168, 164, 500, 500, 102, 500, 56, 152, 72, 500, 58, 34, 172, 500, 124, 500, 34, 60, 48, 34, 166, 140, 500, 500, 500, 500, 62, 500, 44, 500, 50, 36, 76, 74, 132, 44, 500, 98, 500, 500, 426, 140, 500, 500, 130, 500, 500, 110, 138, 94, 500, 34, 66, 298, 264, 54, 374, 500, 500, 32, 194, 500, 500, 500, 114, 500, 500, 500, 500, 120, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3875819831786459, "mean_inference_ms": 1.2579580335413056, "mean_action_processing_ms": 0.14592130033177692, "mean_env_wait_ms": 0.08661354795554088, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017005443572998047, "StateBufferConnector_ms": 0.005983114242553711, "ViewRequirementAgentConnector_ms": 0.11700773239135742}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 306000, "num_agent_steps_trained": 306000, "num_env_steps_sampled": 306000, "num_env_steps_trained": 306000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 6009.1113914042, "num_env_steps_trained_throughput_per_sec": 6009.1113914042, "timesteps_total": 306000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 306000, "timers": {"training_iteration_time_ms": 3297.741, "sample_time_ms": 3030.244, "load_time_ms": 20.164, "load_throughput": 892691.063, "learn_time_ms": 235.159, "learn_throughput": 76543.974, "synch_weights_time_ms": 9.709}, "counters": {"num_env_steps_sampled": 306000, "num_env_steps_trained": 306000, "num_agent_steps_sampled": 306000, "num_agent_steps_trained": 306000}, "done": false, "episodes_total": 1114, "training_iteration": 17, "trial_id": "9f288_00014", "date": "2023-10-25_16-42-48", "timestamp": 1698248568, "time_this_iter_s": 3.0010054111480713, "time_total_s": 54.64488458633423, "pid": 9504, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 54.64488458633423, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 60.975, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.5258789062500003e-06, "cur_lr": 0.0003, "total_loss": 6.428973237673442, "policy_loss": 0.027000488713383675, "vf_loss": 6.4020233154296875, "vf_explained_var": -1.817941665649414e-06, "kl": 0.0003756234621784908, "entropy": 0.5057877153158188, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 210.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.6760000000002093, "episode_len_mean": 297.32, "episode_media": {}, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, 7.499999999999666, 36.10000000000004, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, -50.00000000000044, 39.10000000000002, 36.30000000000003, 40.70000000000002, -50.00000000000044, 46.699999999999996, 43.50000000000001, 20.299999999999848, 23.699999999999896, 44.7, 12.69999999999974, -50.00000000000044, -50.00000000000044, 46.9, 30.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 43.10000000000001, -50.00000000000044, -50.00000000000044, 23.699999999999896, 18.099999999999817, 44.5, -50.00000000000044, 43.50000000000001, -50.00000000000044, 45.1, -50.00000000000044, 45.9, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.099999999999973, -50.00000000000044, 37.50000000000003, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 44.10000000000001, 25.899999999999928, 38.50000000000003, -50.00000000000044, 35.500000000000036, 25.29999999999992, 44.900000000000006, 46.5, 40.500000000000014, -50.00000000000044, 41.70000000000002, 38.90000000000002, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 45.5, 41.30000000000001, 41.500000000000014, 34.10000000000004, -50.00000000000044, 6.499999999999652, -50.00000000000044, 40.10000000000002, 44.10000000000001, 26.69999999999994, 43.900000000000006, -50.00000000000044, 33.30000000000003, 45.9, -50.00000000000044, 1.299999999999578, -50.00000000000044, 44.7, 29.899999999999984], "episode_lengths": [500, 98, 500, 500, 426, 140, 500, 500, 130, 500, 500, 110, 138, 94, 500, 34, 66, 298, 264, 54, 374, 500, 500, 32, 194, 500, 500, 500, 114, 500, 500, 500, 500, 120, 500, 500, 500, 70, 70, 500, 500, 264, 320, 56, 500, 66, 500, 50, 500, 42, 64, 500, 500, 500, 210, 500, 126, 72, 500, 500, 500, 64, 500, 60, 242, 116, 500, 146, 248, 52, 36, 96, 500, 84, 112, 88, 500, 500, 500, 500, 66, 46, 88, 86, 160, 500, 436, 500, 100, 60, 234, 62, 500, 168, 42, 500, 488, 500, 54, 202]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3853016652320184, "mean_inference_ms": 1.251604411552043, "mean_action_processing_ms": 0.14475688768661804, "mean_env_wait_ms": 0.08695182474382747, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029029369354248047, "StateBufferConnector_ms": 0.003983736038208008, "ViewRequirementAgentConnector_ms": 0.12198328971862793}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.6760000000002093, "episode_len_mean": 297.32, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, 7.499999999999666, 36.10000000000004, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, -50.00000000000044, 39.10000000000002, 36.30000000000003, 40.70000000000002, -50.00000000000044, 46.699999999999996, 43.50000000000001, 20.299999999999848, 23.699999999999896, 44.7, 12.69999999999974, -50.00000000000044, -50.00000000000044, 46.9, 30.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 43.10000000000001, -50.00000000000044, -50.00000000000044, 23.699999999999896, 18.099999999999817, 44.5, -50.00000000000044, 43.50000000000001, -50.00000000000044, 45.1, -50.00000000000044, 45.9, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.099999999999973, -50.00000000000044, 37.50000000000003, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 44.10000000000001, 25.899999999999928, 38.50000000000003, -50.00000000000044, 35.500000000000036, 25.29999999999992, 44.900000000000006, 46.5, 40.500000000000014, -50.00000000000044, 41.70000000000002, 38.90000000000002, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 45.5, 41.30000000000001, 41.500000000000014, 34.10000000000004, -50.00000000000044, 6.499999999999652, -50.00000000000044, 40.10000000000002, 44.10000000000001, 26.69999999999994, 43.900000000000006, -50.00000000000044, 33.30000000000003, 45.9, -50.00000000000044, 1.299999999999578, -50.00000000000044, 44.7, 29.899999999999984], "episode_lengths": [500, 98, 500, 500, 426, 140, 500, 500, 130, 500, 500, 110, 138, 94, 500, 34, 66, 298, 264, 54, 374, 500, 500, 32, 194, 500, 500, 500, 114, 500, 500, 500, 500, 120, 500, 500, 500, 70, 70, 500, 500, 264, 320, 56, 500, 66, 500, 50, 500, 42, 64, 500, 500, 500, 210, 500, 126, 72, 500, 500, 500, 64, 500, 60, 242, 116, 500, 146, 248, 52, 36, 96, 500, 84, 112, 88, 500, 500, 500, 500, 66, 46, 88, 86, 160, 500, 436, 500, 100, 60, 234, 62, 500, 168, 42, 500, 488, 500, 54, 202]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3853016652320184, "mean_inference_ms": 1.251604411552043, "mean_action_processing_ms": 0.14475688768661804, "mean_env_wait_ms": 0.08695182474382747, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029029369354248047, "StateBufferConnector_ms": 0.003983736038208008, "ViewRequirementAgentConnector_ms": 0.12198328971862793}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5697.269701478729, "num_env_steps_trained_throughput_per_sec": 5697.269701478729, "timesteps_total": 324000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 324000, "timers": {"training_iteration_time_ms": 3267.603, "sample_time_ms": 3000.989, "load_time_ms": 20.117, "load_throughput": 894761.523, "learn_time_ms": 234.438, "learn_throughput": 76779.334, "synch_weights_time_ms": 9.598}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "done": false, "episodes_total": 1179, "training_iteration": 18, "trial_id": "9f288_00014", "date": "2023-10-25_16-42-51", "timestamp": 1698248571, "time_this_iter_s": 3.165403366088867, "time_total_s": 57.810287952423096, "pid": 9504, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 57.810287952423096, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 57.17999999999999, "ram_util_percent": 27.32}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.629394531250001e-07, "cur_lr": 0.0003, "total_loss": 7.03134028116862, "policy_loss": -0.029424008292456467, "vf_loss": 7.060824155807495, "vf_explained_var": -7.003545761108398e-07, "kl": 0.00016477801897470576, "entropy": 0.5984635502099991, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 222.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 342000, "num_env_steps_trained": 342000, "num_agent_steps_sampled": 342000, "num_agent_steps_trained": 342000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.76999999999985, "episode_len_mean": 243.02, "episode_media": {}, "episodes_this_iter": 78, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 43.50000000000001, 45.5, 41.30000000000001, 41.500000000000014, 34.10000000000004, -50.00000000000044, 6.499999999999652, -50.00000000000044, 40.10000000000002, 44.10000000000001, 26.69999999999994, 43.900000000000006, -50.00000000000044, 33.30000000000003, 45.9, -50.00000000000044, 1.299999999999578, -50.00000000000044, 44.7, 29.899999999999984, -50.00000000000044, 43.30000000000001, 45.7, 42.500000000000014, 31.300000000000004, 39.300000000000026, 34.50000000000004, -50.00000000000044, 5.499999999999638, 44.300000000000004, -50.00000000000044, 47.5, 39.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 42.30000000000001, 45.5, 37.10000000000003, 46.3, 13.699999999999754, -50.00000000000044, 46.099999999999994, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.90000000000003, 30.499999999999993, 3.499999999999609, 39.50000000000002, 33.500000000000036, -50.00000000000044, 23.29999999999989, 43.50000000000001, 46.699999999999996, 43.50000000000001, 42.70000000000001, -50.00000000000044, 26.89999999999994, 41.30000000000001, 6.8999999999996575, 18.29999999999982, 10.299999999999706, 35.70000000000003, 43.900000000000006, 41.30000000000001, 35.500000000000036, 45.7, -50.00000000000044, 31.500000000000007, -50.00000000000044, 39.70000000000002, -50.00000000000044, 43.10000000000001, 47.5, -50.00000000000044, 45.9, 20.299999999999848, 39.90000000000002, 40.90000000000002, 27.299999999999947, 39.90000000000002, 43.50000000000001, 19.09999999999983, 40.10000000000002, 38.50000000000003, -50.00000000000044, 43.10000000000001, -50.00000000000044, 37.50000000000003, -50.00000000000044, 45.9, 47.1, -50.00000000000044, 24.099999999999902], "episode_lengths": [500, 500, 66, 46, 88, 86, 160, 500, 436, 500, 100, 60, 234, 62, 500, 168, 42, 500, 488, 500, 54, 202, 500, 68, 44, 76, 188, 108, 156, 500, 446, 58, 500, 26, 106, 500, 500, 500, 66, 78, 46, 130, 38, 364, 500, 40, 500, 36, 500, 500, 500, 172, 196, 466, 106, 166, 500, 268, 66, 34, 66, 74, 500, 232, 88, 432, 318, 398, 144, 62, 88, 146, 44, 500, 186, 500, 104, 500, 70, 26, 500, 42, 298, 102, 92, 228, 102, 66, 310, 100, 116, 500, 70, 500, 126, 500, 42, 30, 500, 260]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3849063131289542, "mean_inference_ms": 1.2477225365198643, "mean_action_processing_ms": 0.14440686921496276, "mean_env_wait_ms": 0.08674446076436382, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023006200790405273, "StateBufferConnector_ms": 0.0019991397857666016, "ViewRequirementAgentConnector_ms": 0.11299443244934082}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.76999999999985, "episode_len_mean": 243.02, "episodes_this_iter": 78, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 43.50000000000001, 45.5, 41.30000000000001, 41.500000000000014, 34.10000000000004, -50.00000000000044, 6.499999999999652, -50.00000000000044, 40.10000000000002, 44.10000000000001, 26.69999999999994, 43.900000000000006, -50.00000000000044, 33.30000000000003, 45.9, -50.00000000000044, 1.299999999999578, -50.00000000000044, 44.7, 29.899999999999984, -50.00000000000044, 43.30000000000001, 45.7, 42.500000000000014, 31.300000000000004, 39.300000000000026, 34.50000000000004, -50.00000000000044, 5.499999999999638, 44.300000000000004, -50.00000000000044, 47.5, 39.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 42.30000000000001, 45.5, 37.10000000000003, 46.3, 13.699999999999754, -50.00000000000044, 46.099999999999994, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.90000000000003, 30.499999999999993, 3.499999999999609, 39.50000000000002, 33.500000000000036, -50.00000000000044, 23.29999999999989, 43.50000000000001, 46.699999999999996, 43.50000000000001, 42.70000000000001, -50.00000000000044, 26.89999999999994, 41.30000000000001, 6.8999999999996575, 18.29999999999982, 10.299999999999706, 35.70000000000003, 43.900000000000006, 41.30000000000001, 35.500000000000036, 45.7, -50.00000000000044, 31.500000000000007, -50.00000000000044, 39.70000000000002, -50.00000000000044, 43.10000000000001, 47.5, -50.00000000000044, 45.9, 20.299999999999848, 39.90000000000002, 40.90000000000002, 27.299999999999947, 39.90000000000002, 43.50000000000001, 19.09999999999983, 40.10000000000002, 38.50000000000003, -50.00000000000044, 43.10000000000001, -50.00000000000044, 37.50000000000003, -50.00000000000044, 45.9, 47.1, -50.00000000000044, 24.099999999999902], "episode_lengths": [500, 500, 66, 46, 88, 86, 160, 500, 436, 500, 100, 60, 234, 62, 500, 168, 42, 500, 488, 500, 54, 202, 500, 68, 44, 76, 188, 108, 156, 500, 446, 58, 500, 26, 106, 500, 500, 500, 66, 78, 46, 130, 38, 364, 500, 40, 500, 36, 500, 500, 500, 172, 196, 466, 106, 166, 500, 268, 66, 34, 66, 74, 500, 232, 88, 432, 318, 398, 144, 62, 88, 146, 44, 500, 186, 500, 104, 500, 70, 26, 500, 42, 298, 102, 92, 228, 102, 66, 310, 100, 116, 500, 70, 500, 126, 500, 42, 30, 500, 260]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3849063131289542, "mean_inference_ms": 1.2477225365198643, "mean_action_processing_ms": 0.14440686921496276, "mean_env_wait_ms": 0.08674446076436382, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023006200790405273, "StateBufferConnector_ms": 0.0019991397857666016, "ViewRequirementAgentConnector_ms": 0.11299443244934082}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 342000, "num_agent_steps_trained": 342000, "num_env_steps_sampled": 342000, "num_env_steps_trained": 342000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5808.10859111108, "num_env_steps_trained_throughput_per_sec": 5808.10859111108, "timesteps_total": 342000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 342000, "timers": {"training_iteration_time_ms": 3259.087, "sample_time_ms": 2992.271, "load_time_ms": 19.925, "load_throughput": 903381.296, "learn_time_ms": 234.829, "learn_throughput": 76651.436, "synch_weights_time_ms": 9.601}, "counters": {"num_env_steps_sampled": 342000, "num_env_steps_trained": 342000, "num_agent_steps_sampled": 342000, "num_agent_steps_trained": 342000}, "done": false, "episodes_total": 1257, "training_iteration": 19, "trial_id": "9f288_00014", "date": "2023-10-25_16-42-54", "timestamp": 1698248574, "time_this_iter_s": 3.103949785232544, "time_total_s": 60.91423773765564, "pid": 9504, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 60.91423773765564, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 64.7, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.814697265625001e-07, "cur_lr": 0.0003, "total_loss": 7.196290373802185, "policy_loss": 0.05538129402945439, "vf_loss": 7.140970667203267, "vf_explained_var": 2.88089116414388e-07, "kl": 8.041765617624226e-05, "entropy": 0.6166326055924097, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 234.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.15499999999986, "episode_len_mean": 244.14, "episode_media": {}, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 39.70000000000002, -50.00000000000044, 43.10000000000001, 47.5, -50.00000000000044, 45.9, 20.299999999999848, 39.90000000000002, 40.90000000000002, 27.299999999999947, 39.90000000000002, 43.50000000000001, 19.09999999999983, 40.10000000000002, 38.50000000000003, -50.00000000000044, 43.10000000000001, -50.00000000000044, 37.50000000000003, -50.00000000000044, 45.9, 47.1, -50.00000000000044, 24.099999999999902, -50.00000000000044, 30.9, 39.70000000000002, -50.00000000000044, 35.500000000000036, 35.30000000000004, 42.70000000000001, -50.00000000000044, -50.00000000000044, 41.100000000000016, 22.299999999999876, -50.00000000000044, 37.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.500000000000007, 39.90000000000002, 36.900000000000034, 27.899999999999956, -50.00000000000044, -50.00000000000044, 39.90000000000002, 35.500000000000036, 25.099999999999916, -50.00000000000044, 43.10000000000001, 30.699999999999996, 43.7, 43.50000000000001, -50.00000000000044, 22.899999999999885, -50.00000000000044, 40.10000000000002, -50.00000000000044, 34.900000000000034, 26.499999999999936, 41.100000000000016, 40.30000000000002, -50.00000000000044, -50.00000000000044, 40.30000000000002, 35.10000000000004, -50.00000000000044, -50.00000000000044, 46.099999999999994, 39.90000000000002, 44.10000000000001, 38.50000000000003, 33.70000000000004, -50.00000000000044, -50.00000000000044, 45.5, 46.699999999999996, 32.50000000000002, 45.3, 28.29999999999996, 28.699999999999967, 42.900000000000006, 37.70000000000003, 42.70000000000001, 41.100000000000016, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, 26.299999999999933, 40.70000000000002, 43.10000000000001, 45.3, 44.5, 30.29999999999999, 34.900000000000034, 18.099999999999817], "episode_lengths": [500, 104, 500, 70, 26, 500, 42, 298, 102, 92, 228, 102, 66, 310, 100, 116, 500, 70, 500, 126, 500, 42, 30, 500, 260, 500, 192, 104, 500, 146, 148, 74, 500, 500, 90, 278, 500, 126, 500, 500, 500, 500, 186, 102, 132, 222, 500, 500, 102, 146, 250, 500, 70, 194, 64, 66, 500, 272, 500, 100, 500, 152, 236, 90, 98, 500, 500, 98, 150, 500, 500, 40, 102, 60, 116, 164, 500, 500, 46, 34, 176, 48, 218, 214, 72, 124, 74, 90, 500, 500, 88, 500, 238, 94, 70, 48, 56, 198, 152, 320]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3844592405307231, "mean_inference_ms": 1.2442738908818718, "mean_action_processing_ms": 0.14405953581485226, "mean_env_wait_ms": 0.08624671720182539, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01898479461669922, "StateBufferConnector_ms": 0.005998373031616211, "ViewRequirementAgentConnector_ms": 0.10281634330749512}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.15499999999986, "episode_len_mean": 244.14, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 39.70000000000002, -50.00000000000044, 43.10000000000001, 47.5, -50.00000000000044, 45.9, 20.299999999999848, 39.90000000000002, 40.90000000000002, 27.299999999999947, 39.90000000000002, 43.50000000000001, 19.09999999999983, 40.10000000000002, 38.50000000000003, -50.00000000000044, 43.10000000000001, -50.00000000000044, 37.50000000000003, -50.00000000000044, 45.9, 47.1, -50.00000000000044, 24.099999999999902, -50.00000000000044, 30.9, 39.70000000000002, -50.00000000000044, 35.500000000000036, 35.30000000000004, 42.70000000000001, -50.00000000000044, -50.00000000000044, 41.100000000000016, 22.299999999999876, -50.00000000000044, 37.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.500000000000007, 39.90000000000002, 36.900000000000034, 27.899999999999956, -50.00000000000044, -50.00000000000044, 39.90000000000002, 35.500000000000036, 25.099999999999916, -50.00000000000044, 43.10000000000001, 30.699999999999996, 43.7, 43.50000000000001, -50.00000000000044, 22.899999999999885, -50.00000000000044, 40.10000000000002, -50.00000000000044, 34.900000000000034, 26.499999999999936, 41.100000000000016, 40.30000000000002, -50.00000000000044, -50.00000000000044, 40.30000000000002, 35.10000000000004, -50.00000000000044, -50.00000000000044, 46.099999999999994, 39.90000000000002, 44.10000000000001, 38.50000000000003, 33.70000000000004, -50.00000000000044, -50.00000000000044, 45.5, 46.699999999999996, 32.50000000000002, 45.3, 28.29999999999996, 28.699999999999967, 42.900000000000006, 37.70000000000003, 42.70000000000001, 41.100000000000016, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, 26.299999999999933, 40.70000000000002, 43.10000000000001, 45.3, 44.5, 30.29999999999999, 34.900000000000034, 18.099999999999817], "episode_lengths": [500, 104, 500, 70, 26, 500, 42, 298, 102, 92, 228, 102, 66, 310, 100, 116, 500, 70, 500, 126, 500, 42, 30, 500, 260, 500, 192, 104, 500, 146, 148, 74, 500, 500, 90, 278, 500, 126, 500, 500, 500, 500, 186, 102, 132, 222, 500, 500, 102, 146, 250, 500, 70, 194, 64, 66, 500, 272, 500, 100, 500, 152, 236, 90, 98, 500, 500, 98, 150, 500, 500, 40, 102, 60, 116, 164, 500, 500, 46, 34, 176, 48, 218, 214, 72, 124, 74, 90, 500, 500, 88, 500, 238, 94, 70, 48, 56, 198, 152, 320]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3844592405307231, "mean_inference_ms": 1.2442738908818718, "mean_action_processing_ms": 0.14405953581485226, "mean_env_wait_ms": 0.08624671720182539, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01898479461669922, "StateBufferConnector_ms": 0.005998373031616211, "ViewRequirementAgentConnector_ms": 0.10281634330749512}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5602.5937538264025, "num_env_steps_trained_throughput_per_sec": 5602.5937538264025, "timesteps_total": 360000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 360000, "timers": {"training_iteration_time_ms": 3246.603, "sample_time_ms": 2971.084, "load_time_ms": 19.56, "load_throughput": 920231.784, "learn_time_ms": 244.304, "learn_throughput": 73678.612, "synch_weights_time_ms": 9.371}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "done": false, "episodes_total": 1332, "training_iteration": 20, "trial_id": "9f288_00014", "date": "2023-10-25_16-42-58", "timestamp": 1698248578, "time_this_iter_s": 3.2177960872650146, "time_total_s": 64.13203382492065, "pid": 9504, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 64.13203382492065, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 53.54, "ram_util_percent": 27.32}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.9073486328125004e-07, "cur_lr": 0.0003, "total_loss": 7.0841115315755205, "policy_loss": -0.023544110357761383, "vf_loss": 7.107711315155029, "vf_explained_var": -7.152557373046875e-07, "kl": 0.0003466682667176239, "entropy": 0.5570913851261139, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 246.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 378000, "num_env_steps_trained": 378000, "num_agent_steps_sampled": 378000, "num_agent_steps_trained": 378000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.678999999999876, "episode_len_mean": 228.94, "episode_media": {}, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.099999999999994, 39.90000000000002, 44.10000000000001, 38.50000000000003, 33.70000000000004, -50.00000000000044, -50.00000000000044, 45.5, 46.699999999999996, 32.50000000000002, 45.3, 28.29999999999996, 28.699999999999967, 42.900000000000006, 37.70000000000003, 42.70000000000001, 41.100000000000016, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, 26.299999999999933, 40.70000000000002, 43.10000000000001, 45.3, 44.5, 30.29999999999999, 34.900000000000034, 18.099999999999817, -50.00000000000044, 42.900000000000006, 34.10000000000004, 46.3, -50.00000000000044, 38.90000000000002, -50.00000000000044, 45.9, 39.300000000000026, 29.299999999999976, 41.30000000000001, 31.1, 43.30000000000001, 39.70000000000002, -50.00000000000044, -50.00000000000044, 40.500000000000014, 30.29999999999999, 46.9, 5.299999999999635, 34.30000000000004, 45.7, 43.900000000000006, 35.10000000000004, 34.900000000000034, -50.00000000000044, 33.500000000000036, -50.00000000000044, -50.00000000000044, 34.70000000000004, -50.00000000000044, 36.10000000000004, -50.00000000000044, 28.09999999999996, 14.699999999999768, 46.699999999999996, 40.30000000000002, 44.5, -50.00000000000044, 42.900000000000006, 45.9, 41.500000000000014, 26.89999999999994, 29.099999999999973, 27.699999999999953, 43.10000000000001, 21.09999999999986, -50.00000000000044, -50.00000000000044, 39.90000000000002, 32.100000000000016, 43.7, 32.50000000000002, 33.10000000000003, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 41.70000000000002, 40.30000000000002, -50.00000000000044, 32.30000000000002, 27.299999999999947, -50.00000000000044, 37.10000000000003, -50.00000000000044], "episode_lengths": [40, 102, 60, 116, 164, 500, 500, 46, 34, 176, 48, 218, 214, 72, 124, 74, 90, 500, 500, 88, 500, 238, 94, 70, 48, 56, 198, 152, 320, 500, 72, 160, 38, 500, 112, 500, 42, 108, 208, 88, 190, 68, 104, 500, 500, 96, 198, 32, 448, 158, 44, 62, 150, 152, 500, 166, 500, 500, 154, 500, 140, 500, 220, 354, 34, 98, 56, 500, 72, 42, 86, 232, 210, 224, 70, 290, 500, 500, 102, 180, 64, 176, 170, 500, 44, 500, 500, 48, 500, 500, 500, 72, 84, 98, 500, 178, 228, 500, 130, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3841848501554888, "mean_inference_ms": 1.242066670617449, "mean_action_processing_ms": 0.14345601471851638, "mean_env_wait_ms": 0.08640621908223726, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02005314826965332, "StateBufferConnector_ms": 0.004999637603759766, "ViewRequirementAgentConnector_ms": 0.11983466148376465}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.678999999999876, "episode_len_mean": 228.94, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.099999999999994, 39.90000000000002, 44.10000000000001, 38.50000000000003, 33.70000000000004, -50.00000000000044, -50.00000000000044, 45.5, 46.699999999999996, 32.50000000000002, 45.3, 28.29999999999996, 28.699999999999967, 42.900000000000006, 37.70000000000003, 42.70000000000001, 41.100000000000016, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, 26.299999999999933, 40.70000000000002, 43.10000000000001, 45.3, 44.5, 30.29999999999999, 34.900000000000034, 18.099999999999817, -50.00000000000044, 42.900000000000006, 34.10000000000004, 46.3, -50.00000000000044, 38.90000000000002, -50.00000000000044, 45.9, 39.300000000000026, 29.299999999999976, 41.30000000000001, 31.1, 43.30000000000001, 39.70000000000002, -50.00000000000044, -50.00000000000044, 40.500000000000014, 30.29999999999999, 46.9, 5.299999999999635, 34.30000000000004, 45.7, 43.900000000000006, 35.10000000000004, 34.900000000000034, -50.00000000000044, 33.500000000000036, -50.00000000000044, -50.00000000000044, 34.70000000000004, -50.00000000000044, 36.10000000000004, -50.00000000000044, 28.09999999999996, 14.699999999999768, 46.699999999999996, 40.30000000000002, 44.5, -50.00000000000044, 42.900000000000006, 45.9, 41.500000000000014, 26.89999999999994, 29.099999999999973, 27.699999999999953, 43.10000000000001, 21.09999999999986, -50.00000000000044, -50.00000000000044, 39.90000000000002, 32.100000000000016, 43.7, 32.50000000000002, 33.10000000000003, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 41.70000000000002, 40.30000000000002, -50.00000000000044, 32.30000000000002, 27.299999999999947, -50.00000000000044, 37.10000000000003, -50.00000000000044], "episode_lengths": [40, 102, 60, 116, 164, 500, 500, 46, 34, 176, 48, 218, 214, 72, 124, 74, 90, 500, 500, 88, 500, 238, 94, 70, 48, 56, 198, 152, 320, 500, 72, 160, 38, 500, 112, 500, 42, 108, 208, 88, 190, 68, 104, 500, 500, 96, 198, 32, 448, 158, 44, 62, 150, 152, 500, 166, 500, 500, 154, 500, 140, 500, 220, 354, 34, 98, 56, 500, 72, 42, 86, 232, 210, 224, 70, 290, 500, 500, 102, 180, 64, 176, 170, 500, 44, 500, 500, 48, 500, 500, 500, 72, 84, 98, 500, 178, 228, 500, 130, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3841848501554888, "mean_inference_ms": 1.242066670617449, "mean_action_processing_ms": 0.14345601471851638, "mean_env_wait_ms": 0.08640621908223726, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02005314826965332, "StateBufferConnector_ms": 0.004999637603759766, "ViewRequirementAgentConnector_ms": 0.11983466148376465}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 378000, "num_agent_steps_trained": 378000, "num_env_steps_sampled": 378000, "num_env_steps_trained": 378000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5919.515107265205, "num_env_steps_trained_throughput_per_sec": 5919.515107265205, "timesteps_total": 378000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 378000, "timers": {"training_iteration_time_ms": 3229.83, "sample_time_ms": 2953.894, "load_time_ms": 19.93, "load_throughput": 903175.96, "learn_time_ms": 244.272, "learn_throughput": 73688.205, "synch_weights_time_ms": 9.544}, "counters": {"num_env_steps_sampled": 378000, "num_env_steps_trained": 378000, "num_agent_steps_sampled": 378000, "num_agent_steps_trained": 378000}, "done": false, "episodes_total": 1403, "training_iteration": 21, "trial_id": "9f288_00014", "date": "2023-10-25_16-43-01", "timestamp": 1698248581, "time_this_iter_s": 3.0457863807678223, "time_total_s": 67.17782020568848, "pid": 9504, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 67.17782020568848, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 65.675, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.536743164062502e-08, "cur_lr": 0.0003, "total_loss": 6.762286305427551, "policy_loss": -0.0037800812472899756, "vf_loss": 6.76611868540446, "vf_explained_var": 9.934107462565105e-07, "kl": 0.00035502470355671295, "entropy": 0.523814802368482, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 258.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.792999999999844, "episode_len_mean": 247.72, "episode_media": {}, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.10000000000001, 21.09999999999986, -50.00000000000044, -50.00000000000044, 39.90000000000002, 32.100000000000016, 43.7, 32.50000000000002, 33.10000000000003, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 41.70000000000002, 40.30000000000002, -50.00000000000044, 32.30000000000002, 27.299999999999947, -50.00000000000044, 37.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 45.1, 40.90000000000002, 43.7, 42.500000000000014, 45.7, -50.00000000000044, 45.5, 43.30000000000001, -50.00000000000044, 40.500000000000014, 46.099999999999994, 41.30000000000001, 42.900000000000006, 41.100000000000016, 41.30000000000001, 46.699999999999996, 43.30000000000001, -50.00000000000044, 39.70000000000002, -50.00000000000044, 37.70000000000003, -50.00000000000044, 32.90000000000003, -50.00000000000044, 23.099999999999888, 44.5, 43.900000000000006, 46.099999999999994, -50.00000000000044, 43.10000000000001, 41.30000000000001, 21.499999999999865, -50.00000000000044, -50.00000000000044, 27.49999999999995, 41.90000000000001, -50.00000000000044, 43.50000000000001, 29.099999999999973, -50.00000000000044, 28.29999999999996, 46.3, 43.10000000000001, 36.30000000000003, -50.00000000000044, 33.30000000000003, 46.5, 38.90000000000002, 45.5, -50.00000000000044, 36.900000000000034, 40.70000000000002, 31.300000000000004, -50.00000000000044, 43.30000000000001, 36.900000000000034, -50.00000000000044, 33.70000000000004, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.300000000000026, -50.00000000000044, 37.70000000000003, -50.00000000000044, 9.699999999999697, 43.900000000000006, 44.10000000000001], "episode_lengths": [70, 290, 500, 500, 102, 180, 64, 176, 170, 500, 44, 500, 500, 48, 500, 500, 500, 72, 84, 98, 500, 178, 228, 500, 130, 500, 500, 500, 46, 50, 92, 64, 76, 44, 500, 46, 68, 500, 96, 40, 88, 72, 90, 88, 34, 68, 500, 104, 500, 124, 500, 172, 500, 270, 56, 62, 40, 500, 70, 88, 286, 500, 500, 226, 82, 500, 66, 210, 500, 218, 38, 70, 138, 500, 168, 36, 112, 46, 500, 132, 94, 188, 500, 68, 132, 500, 164, 58, 500, 500, 500, 500, 500, 108, 500, 124, 500, 404, 62, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38349476562436424, "mean_inference_ms": 1.2401881013745992, "mean_action_processing_ms": 0.14347970902586615, "mean_env_wait_ms": 0.08615945559304759, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026041030883789062, "StateBufferConnector_ms": 0.005002737045288086, "ViewRequirementAgentConnector_ms": 0.1098473072052002}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.792999999999844, "episode_len_mean": 247.72, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.10000000000001, 21.09999999999986, -50.00000000000044, -50.00000000000044, 39.90000000000002, 32.100000000000016, 43.7, 32.50000000000002, 33.10000000000003, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 41.70000000000002, 40.30000000000002, -50.00000000000044, 32.30000000000002, 27.299999999999947, -50.00000000000044, 37.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 45.1, 40.90000000000002, 43.7, 42.500000000000014, 45.7, -50.00000000000044, 45.5, 43.30000000000001, -50.00000000000044, 40.500000000000014, 46.099999999999994, 41.30000000000001, 42.900000000000006, 41.100000000000016, 41.30000000000001, 46.699999999999996, 43.30000000000001, -50.00000000000044, 39.70000000000002, -50.00000000000044, 37.70000000000003, -50.00000000000044, 32.90000000000003, -50.00000000000044, 23.099999999999888, 44.5, 43.900000000000006, 46.099999999999994, -50.00000000000044, 43.10000000000001, 41.30000000000001, 21.499999999999865, -50.00000000000044, -50.00000000000044, 27.49999999999995, 41.90000000000001, -50.00000000000044, 43.50000000000001, 29.099999999999973, -50.00000000000044, 28.29999999999996, 46.3, 43.10000000000001, 36.30000000000003, -50.00000000000044, 33.30000000000003, 46.5, 38.90000000000002, 45.5, -50.00000000000044, 36.900000000000034, 40.70000000000002, 31.300000000000004, -50.00000000000044, 43.30000000000001, 36.900000000000034, -50.00000000000044, 33.70000000000004, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.300000000000026, -50.00000000000044, 37.70000000000003, -50.00000000000044, 9.699999999999697, 43.900000000000006, 44.10000000000001], "episode_lengths": [70, 290, 500, 500, 102, 180, 64, 176, 170, 500, 44, 500, 500, 48, 500, 500, 500, 72, 84, 98, 500, 178, 228, 500, 130, 500, 500, 500, 46, 50, 92, 64, 76, 44, 500, 46, 68, 500, 96, 40, 88, 72, 90, 88, 34, 68, 500, 104, 500, 124, 500, 172, 500, 270, 56, 62, 40, 500, 70, 88, 286, 500, 500, 226, 82, 500, 66, 210, 500, 218, 38, 70, 138, 500, 168, 36, 112, 46, 500, 132, 94, 188, 500, 68, 132, 500, 164, 58, 500, 500, 500, 500, 500, 108, 500, 124, 500, 404, 62, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38349476562436424, "mean_inference_ms": 1.2401881013745992, "mean_action_processing_ms": 0.14347970902586615, "mean_env_wait_ms": 0.08615945559304759, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026041030883789062, "StateBufferConnector_ms": 0.005002737045288086, "ViewRequirementAgentConnector_ms": 0.1098473072052002}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5785.316941002045, "num_env_steps_trained_throughput_per_sec": 5785.316941002045, "timesteps_total": 396000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 396000, "timers": {"training_iteration_time_ms": 3209.938, "sample_time_ms": 2937.709, "load_time_ms": 19.846, "load_throughput": 906996.384, "learn_time_ms": 240.721, "learn_throughput": 74775.359, "synch_weights_time_ms": 9.473}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "done": false, "episodes_total": 1477, "training_iteration": 22, "trial_id": "9f288_00014", "date": "2023-10-25_16-43-04", "timestamp": 1698248584, "time_this_iter_s": 3.1163201332092285, "time_total_s": 70.2941403388977, "pid": 9504, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 70.2941403388977, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 61.65, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.768371582031251e-08, "cur_lr": 0.0003, "total_loss": 6.996949911117554, "policy_loss": 0.051458168774843216, "vf_loss": 6.945542812347412, "vf_explained_var": -9.884436925252278e-07, "kl": 6.816211242721693e-05, "entropy": 0.5123418544729551, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 270.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 414000, "num_env_steps_trained": 414000, "num_agent_steps_sampled": 414000, "num_agent_steps_trained": 414000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.323999999999813, "episode_len_mean": 277.36, "episode_media": {}, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.10000000000001, 36.30000000000003, -50.00000000000044, 33.30000000000003, 46.5, 38.90000000000002, 45.5, -50.00000000000044, 36.900000000000034, 40.70000000000002, 31.300000000000004, -50.00000000000044, 43.30000000000001, 36.900000000000034, -50.00000000000044, 33.70000000000004, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.300000000000026, -50.00000000000044, 37.70000000000003, -50.00000000000044, 9.699999999999697, 43.900000000000006, 44.10000000000001, -50.00000000000044, 45.5, 37.300000000000026, -50.00000000000044, 41.500000000000014, -50.00000000000044, 39.90000000000002, 40.90000000000002, -50.00000000000044, -50.00000000000044, 26.09999999999993, 11.699999999999726, -50.00000000000044, -50.00000000000044, 42.70000000000001, 47.1, -50.00000000000044, -50.00000000000044, 20.099999999999845, 28.09999999999996, 41.100000000000016, 41.100000000000016, -50.00000000000044, -50.00000000000044, 40.90000000000002, 34.70000000000004, -50.00000000000044, 47.3, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 14.09999999999976, -50.00000000000044, 42.70000000000001, -50.00000000000044, 28.499999999999964, 45.7, -50.00000000000044, 45.7, 42.900000000000006, 45.9, 45.5, 45.3, 31.1, -50.00000000000044, 40.70000000000002, 45.1, -50.00000000000044, -50.00000000000044, 1.8999999999995865, -50.00000000000044, -50.00000000000044, 43.50000000000001, 37.300000000000026, 44.5, 41.30000000000001, 23.699999999999896, -50.00000000000044, 41.70000000000002, 44.5, 43.50000000000001, -50.00000000000044, 26.09999999999993, 40.70000000000002, -50.00000000000044, 24.69999999999991, 32.700000000000024], "episode_lengths": [70, 138, 500, 168, 36, 112, 46, 500, 132, 94, 188, 500, 68, 132, 500, 164, 58, 500, 500, 500, 500, 500, 108, 500, 124, 500, 404, 62, 60, 500, 46, 128, 500, 86, 500, 102, 92, 500, 500, 240, 384, 500, 500, 74, 30, 500, 500, 300, 220, 90, 90, 500, 500, 92, 154, 500, 28, 500, 84, 500, 500, 500, 500, 500, 360, 500, 74, 500, 216, 44, 500, 44, 72, 42, 46, 48, 190, 500, 94, 50, 500, 500, 482, 500, 500, 66, 128, 56, 88, 264, 500, 84, 56, 66, 500, 240, 94, 500, 254, 174]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38282162378469364, "mean_inference_ms": 1.2384554728194268, "mean_action_processing_ms": 0.14399054749306248, "mean_env_wait_ms": 0.08578912478033612, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028006553649902344, "StateBufferConnector_ms": 0.0110015869140625, "ViewRequirementAgentConnector_ms": 0.11585378646850586}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.323999999999813, "episode_len_mean": 277.36, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.10000000000001, 36.30000000000003, -50.00000000000044, 33.30000000000003, 46.5, 38.90000000000002, 45.5, -50.00000000000044, 36.900000000000034, 40.70000000000002, 31.300000000000004, -50.00000000000044, 43.30000000000001, 36.900000000000034, -50.00000000000044, 33.70000000000004, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.300000000000026, -50.00000000000044, 37.70000000000003, -50.00000000000044, 9.699999999999697, 43.900000000000006, 44.10000000000001, -50.00000000000044, 45.5, 37.300000000000026, -50.00000000000044, 41.500000000000014, -50.00000000000044, 39.90000000000002, 40.90000000000002, -50.00000000000044, -50.00000000000044, 26.09999999999993, 11.699999999999726, -50.00000000000044, -50.00000000000044, 42.70000000000001, 47.1, -50.00000000000044, -50.00000000000044, 20.099999999999845, 28.09999999999996, 41.100000000000016, 41.100000000000016, -50.00000000000044, -50.00000000000044, 40.90000000000002, 34.70000000000004, -50.00000000000044, 47.3, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 14.09999999999976, -50.00000000000044, 42.70000000000001, -50.00000000000044, 28.499999999999964, 45.7, -50.00000000000044, 45.7, 42.900000000000006, 45.9, 45.5, 45.3, 31.1, -50.00000000000044, 40.70000000000002, 45.1, -50.00000000000044, -50.00000000000044, 1.8999999999995865, -50.00000000000044, -50.00000000000044, 43.50000000000001, 37.300000000000026, 44.5, 41.30000000000001, 23.699999999999896, -50.00000000000044, 41.70000000000002, 44.5, 43.50000000000001, -50.00000000000044, 26.09999999999993, 40.70000000000002, -50.00000000000044, 24.69999999999991, 32.700000000000024], "episode_lengths": [70, 138, 500, 168, 36, 112, 46, 500, 132, 94, 188, 500, 68, 132, 500, 164, 58, 500, 500, 500, 500, 500, 108, 500, 124, 500, 404, 62, 60, 500, 46, 128, 500, 86, 500, 102, 92, 500, 500, 240, 384, 500, 500, 74, 30, 500, 500, 300, 220, 90, 90, 500, 500, 92, 154, 500, 28, 500, 84, 500, 500, 500, 500, 500, 360, 500, 74, 500, 216, 44, 500, 44, 72, 42, 46, 48, 190, 500, 94, 50, 500, 500, 482, 500, 500, 66, 128, 56, 88, 264, 500, 84, 56, 66, 500, 240, 94, 500, 254, 174]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38282162378469364, "mean_inference_ms": 1.2384554728194268, "mean_action_processing_ms": 0.14399054749306248, "mean_env_wait_ms": 0.08578912478033612, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028006553649902344, "StateBufferConnector_ms": 0.0110015869140625, "ViewRequirementAgentConnector_ms": 0.11585378646850586}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 414000, "num_agent_steps_trained": 414000, "num_env_steps_sampled": 414000, "num_env_steps_trained": 414000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5979.786535857822, "num_env_steps_trained_throughput_per_sec": 5979.786535857822, "timesteps_total": 414000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 414000, "timers": {"training_iteration_time_ms": 3181.421, "sample_time_ms": 2910.381, "load_time_ms": 19.88, "load_throughput": 905450.66, "learn_time_ms": 239.452, "learn_throughput": 75171.663, "synch_weights_time_ms": 9.511}, "counters": {"num_env_steps_sampled": 414000, "num_env_steps_trained": 414000, "num_agent_steps_sampled": 414000, "num_agent_steps_trained": 414000}, "done": false, "episodes_total": 1548, "training_iteration": 23, "trial_id": "9f288_00014", "date": "2023-10-25_16-43-07", "timestamp": 1698248587, "time_this_iter_s": 3.0151360034942627, "time_total_s": 73.30927634239197, "pid": 9504, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 73.30927634239197, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 56.36, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.3841857910156255e-08, "cur_lr": 0.0003, "total_loss": 6.724093357721965, "policy_loss": 0.03297200193628669, "vf_loss": 6.6911734739939375, "vf_explained_var": -1.1622905731201172e-06, "kl": 0.0003176996331328101, "entropy": 0.5216977323095003, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 282.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.791999999999861, "episode_len_mean": 222.8, "episode_media": {}, "episodes_this_iter": 79, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.1, -50.00000000000044, -50.00000000000044, 1.8999999999995865, -50.00000000000044, -50.00000000000044, 43.50000000000001, 37.300000000000026, 44.5, 41.30000000000001, 23.699999999999896, -50.00000000000044, 41.70000000000002, 44.5, 43.50000000000001, -50.00000000000044, 26.09999999999993, 40.70000000000002, -50.00000000000044, 24.69999999999991, 32.700000000000024, 46.099999999999994, 39.10000000000002, -50.00000000000044, 24.499999999999908, -50.00000000000044, 8.699999999999683, 47.5, 46.099999999999994, 45.3, -50.00000000000044, 45.5, 40.70000000000002, -50.00000000000044, 44.300000000000004, 42.70000000000001, 44.10000000000001, -50.00000000000044, 39.90000000000002, 6.499999999999652, 44.300000000000004, 43.7, -50.00000000000044, 45.9, -50.00000000000044, 34.900000000000034, -50.00000000000044, 31.300000000000004, 45.3, 33.10000000000003, 33.30000000000003, -50.00000000000044, 43.900000000000006, 42.900000000000006, 20.299999999999848, -50.00000000000044, 45.3, 45.1, 36.900000000000034, 46.099999999999994, 44.900000000000006, 37.10000000000003, 40.70000000000002, 41.90000000000001, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 41.30000000000001, -50.00000000000044, 44.5, 40.500000000000014, -50.00000000000044, 36.10000000000004, -50.00000000000044, 45.1, -50.00000000000044, 34.10000000000004, 45.9, 37.10000000000003, -50.00000000000044, 40.500000000000014, 42.500000000000014, 46.699999999999996, 45.5, 47.3, 13.099999999999746, 38.300000000000026, 45.7, 38.300000000000026, 44.900000000000006, 20.49999999999985, 42.10000000000001, -50.00000000000044, 41.70000000000002, 44.10000000000001, 44.5], "episode_lengths": [50, 500, 500, 482, 500, 500, 66, 128, 56, 88, 264, 500, 84, 56, 66, 500, 240, 94, 500, 254, 174, 40, 110, 500, 256, 500, 414, 26, 40, 48, 500, 46, 94, 500, 58, 74, 60, 500, 102, 436, 58, 64, 500, 42, 500, 152, 500, 188, 48, 170, 168, 500, 62, 72, 298, 500, 48, 50, 132, 40, 52, 130, 94, 82, 500, 54, 500, 500, 500, 500, 50, 88, 500, 56, 96, 500, 140, 500, 50, 500, 160, 42, 130, 500, 96, 76, 34, 46, 28, 370, 118, 44, 118, 52, 296, 80, 500, 84, 60, 56]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38307587164796486, "mean_inference_ms": 1.2343860923169832, "mean_action_processing_ms": 0.14253515102494194, "mean_env_wait_ms": 0.08612882705976578, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027239084243774414, "StateBufferConnector_ms": 0.00700688362121582, "ViewRequirementAgentConnector_ms": 0.12498354911804199}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.791999999999861, "episode_len_mean": 222.8, "episodes_this_iter": 79, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.1, -50.00000000000044, -50.00000000000044, 1.8999999999995865, -50.00000000000044, -50.00000000000044, 43.50000000000001, 37.300000000000026, 44.5, 41.30000000000001, 23.699999999999896, -50.00000000000044, 41.70000000000002, 44.5, 43.50000000000001, -50.00000000000044, 26.09999999999993, 40.70000000000002, -50.00000000000044, 24.69999999999991, 32.700000000000024, 46.099999999999994, 39.10000000000002, -50.00000000000044, 24.499999999999908, -50.00000000000044, 8.699999999999683, 47.5, 46.099999999999994, 45.3, -50.00000000000044, 45.5, 40.70000000000002, -50.00000000000044, 44.300000000000004, 42.70000000000001, 44.10000000000001, -50.00000000000044, 39.90000000000002, 6.499999999999652, 44.300000000000004, 43.7, -50.00000000000044, 45.9, -50.00000000000044, 34.900000000000034, -50.00000000000044, 31.300000000000004, 45.3, 33.10000000000003, 33.30000000000003, -50.00000000000044, 43.900000000000006, 42.900000000000006, 20.299999999999848, -50.00000000000044, 45.3, 45.1, 36.900000000000034, 46.099999999999994, 44.900000000000006, 37.10000000000003, 40.70000000000002, 41.90000000000001, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 41.30000000000001, -50.00000000000044, 44.5, 40.500000000000014, -50.00000000000044, 36.10000000000004, -50.00000000000044, 45.1, -50.00000000000044, 34.10000000000004, 45.9, 37.10000000000003, -50.00000000000044, 40.500000000000014, 42.500000000000014, 46.699999999999996, 45.5, 47.3, 13.099999999999746, 38.300000000000026, 45.7, 38.300000000000026, 44.900000000000006, 20.49999999999985, 42.10000000000001, -50.00000000000044, 41.70000000000002, 44.10000000000001, 44.5], "episode_lengths": [50, 500, 500, 482, 500, 500, 66, 128, 56, 88, 264, 500, 84, 56, 66, 500, 240, 94, 500, 254, 174, 40, 110, 500, 256, 500, 414, 26, 40, 48, 500, 46, 94, 500, 58, 74, 60, 500, 102, 436, 58, 64, 500, 42, 500, 152, 500, 188, 48, 170, 168, 500, 62, 72, 298, 500, 48, 50, 132, 40, 52, 130, 94, 82, 500, 54, 500, 500, 500, 500, 50, 88, 500, 56, 96, 500, 140, 500, 50, 500, 160, 42, 130, 500, 96, 76, 34, 46, 28, 370, 118, 44, 118, 52, 296, 80, 500, 84, 60, 56]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38307587164796486, "mean_inference_ms": 1.2343860923169832, "mean_action_processing_ms": 0.14253515102494194, "mean_env_wait_ms": 0.08612882705976578, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027239084243774414, "StateBufferConnector_ms": 0.00700688362121582, "ViewRequirementAgentConnector_ms": 0.12498354911804199}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5209.660814883098, "num_env_steps_trained_throughput_per_sec": 5209.660814883098, "timesteps_total": 432000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 432000, "timers": {"training_iteration_time_ms": 3156.263, "sample_time_ms": 2854.235, "load_time_ms": 19.061, "load_throughput": 944322.767, "learn_time_ms": 240.12, "learn_throughput": 74962.644, "synch_weights_time_ms": 40.65}, "counters": {"num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "done": false, "episodes_total": 1627, "training_iteration": 24, "trial_id": "9f288_00014", "date": "2023-10-25_16-43-10", "timestamp": 1698248590, "time_this_iter_s": 3.461130142211914, "time_total_s": 76.77040648460388, "pid": 9504, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 76.77040648460388, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 66.30000000000001, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1920928955078127e-08, "cur_lr": 0.0003, "total_loss": 6.339209953943889, "policy_loss": -0.018328585661947727, "vf_loss": 6.357586026191711, "vf_explained_var": -5.910793940226237e-07, "kl": 0.0001786712973933883, "entropy": 0.475912111500899, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 294.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 450000, "num_env_steps_trained": 450000, "num_agent_steps_sampled": 450000, "num_agent_steps_trained": 450000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.012999999999823, "episode_len_mean": 255.5, "episode_media": {}, "episodes_this_iter": 62, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.70000000000002, 41.90000000000001, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 41.30000000000001, -50.00000000000044, 44.5, 40.500000000000014, -50.00000000000044, 36.10000000000004, -50.00000000000044, 45.1, -50.00000000000044, 34.10000000000004, 45.9, 37.10000000000003, -50.00000000000044, 40.500000000000014, 42.500000000000014, 46.699999999999996, 45.5, 47.3, 13.099999999999746, 38.300000000000026, 45.7, 38.300000000000026, 44.900000000000006, 20.49999999999985, 42.10000000000001, -50.00000000000044, 41.70000000000002, 44.10000000000001, 44.5, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 45.7, 46.099999999999994, 44.900000000000006, 7.899999999999672, 38.700000000000024, -50.00000000000044, 44.10000000000001, -50.00000000000044, 43.900000000000006, 44.300000000000004, -50.00000000000044, 42.70000000000001, -50.00000000000044, 37.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 46.5, -50.00000000000044, 35.30000000000004, -50.00000000000044, 44.7, 46.9, -50.00000000000044, -50.00000000000044, 26.09999999999993, 44.5, -50.00000000000044, 47.9, 26.69999999999994, 18.29999999999982, 41.30000000000001, -50.00000000000044, -50.00000000000044, 43.7, 47.3, 28.89999999999997, 16.29999999999979, 15.699999999999783, 44.300000000000004, -50.00000000000044, 43.900000000000006, 37.90000000000003, -50.00000000000044, 34.50000000000004, 42.70000000000001, 25.499999999999922, -50.00000000000044, 26.299999999999933, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044], "episode_lengths": [94, 82, 500, 54, 500, 500, 500, 500, 50, 88, 500, 56, 96, 500, 140, 500, 50, 500, 160, 42, 130, 500, 96, 76, 34, 46, 28, 370, 118, 44, 118, 52, 296, 80, 500, 84, 60, 56, 500, 500, 62, 500, 500, 44, 500, 44, 40, 52, 422, 114, 500, 60, 500, 62, 58, 500, 74, 500, 130, 500, 500, 500, 60, 500, 36, 500, 148, 500, 54, 32, 500, 500, 240, 56, 500, 22, 234, 318, 88, 500, 500, 64, 28, 212, 338, 344, 58, 500, 62, 122, 500, 156, 74, 246, 500, 238, 500, 58, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38257462809333914, "mean_inference_ms": 1.2346941524217308, "mean_action_processing_ms": 0.14277730714789993, "mean_env_wait_ms": 0.08631285175926999, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02500295639038086, "StateBufferConnector_ms": 0.00502467155456543, "ViewRequirementAgentConnector_ms": 0.12197661399841309}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.012999999999823, "episode_len_mean": 255.5, "episodes_this_iter": 62, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [40.70000000000002, 41.90000000000001, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 41.30000000000001, -50.00000000000044, 44.5, 40.500000000000014, -50.00000000000044, 36.10000000000004, -50.00000000000044, 45.1, -50.00000000000044, 34.10000000000004, 45.9, 37.10000000000003, -50.00000000000044, 40.500000000000014, 42.500000000000014, 46.699999999999996, 45.5, 47.3, 13.099999999999746, 38.300000000000026, 45.7, 38.300000000000026, 44.900000000000006, 20.49999999999985, 42.10000000000001, -50.00000000000044, 41.70000000000002, 44.10000000000001, 44.5, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 45.7, 46.099999999999994, 44.900000000000006, 7.899999999999672, 38.700000000000024, -50.00000000000044, 44.10000000000001, -50.00000000000044, 43.900000000000006, 44.300000000000004, -50.00000000000044, 42.70000000000001, -50.00000000000044, 37.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 46.5, -50.00000000000044, 35.30000000000004, -50.00000000000044, 44.7, 46.9, -50.00000000000044, -50.00000000000044, 26.09999999999993, 44.5, -50.00000000000044, 47.9, 26.69999999999994, 18.29999999999982, 41.30000000000001, -50.00000000000044, -50.00000000000044, 43.7, 47.3, 28.89999999999997, 16.29999999999979, 15.699999999999783, 44.300000000000004, -50.00000000000044, 43.900000000000006, 37.90000000000003, -50.00000000000044, 34.50000000000004, 42.70000000000001, 25.499999999999922, -50.00000000000044, 26.299999999999933, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044], "episode_lengths": [94, 82, 500, 54, 500, 500, 500, 500, 50, 88, 500, 56, 96, 500, 140, 500, 50, 500, 160, 42, 130, 500, 96, 76, 34, 46, 28, 370, 118, 44, 118, 52, 296, 80, 500, 84, 60, 56, 500, 500, 62, 500, 500, 44, 500, 44, 40, 52, 422, 114, 500, 60, 500, 62, 58, 500, 74, 500, 130, 500, 500, 500, 60, 500, 36, 500, 148, 500, 54, 32, 500, 500, 240, 56, 500, 22, 234, 318, 88, 500, 500, 64, 28, 212, 338, 344, 58, 500, 62, 122, 500, 156, 74, 246, 500, 238, 500, 58, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38257462809333914, "mean_inference_ms": 1.2346941524217308, "mean_action_processing_ms": 0.14277730714789993, "mean_env_wait_ms": 0.08631285175926999, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02500295639038086, "StateBufferConnector_ms": 0.00502467155456543, "ViewRequirementAgentConnector_ms": 0.12197661399841309}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 450000, "num_agent_steps_trained": 450000, "num_env_steps_sampled": 450000, "num_env_steps_trained": 450000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5892.9800549119245, "num_env_steps_trained_throughput_per_sec": 5892.9800549119245, "timesteps_total": 450000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 450000, "timers": {"training_iteration_time_ms": 3134.444, "sample_time_ms": 2826.516, "load_time_ms": 19.761, "load_throughput": 910875.64, "learn_time_ms": 245.299, "learn_throughput": 73379.712, "synch_weights_time_ms": 40.77}, "counters": {"num_env_steps_sampled": 450000, "num_env_steps_trained": 450000, "num_agent_steps_sampled": 450000, "num_agent_steps_trained": 450000}, "done": false, "episodes_total": 1689, "training_iteration": 25, "trial_id": "9f288_00014", "date": "2023-10-25_16-43-13", "timestamp": 1698248593, "time_this_iter_s": 3.0594775676727295, "time_total_s": 79.82988405227661, "pid": 9504, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 79.82988405227661, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 53.18000000000001, "ram_util_percent": 27.32}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.960464477539064e-09, "cur_lr": 0.0003, "total_loss": 6.54370121161143, "policy_loss": -0.01665772387029089, "vf_loss": 6.560410300890605, "vf_explained_var": 2.384185791015625e-07, "kl": 0.0002609461575768061, "entropy": 0.5141049474477768, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 306.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.6459999999998107, "episode_len_mean": 274.14, "episode_media": {}, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.30000000000004, -50.00000000000044, 44.7, 46.9, -50.00000000000044, -50.00000000000044, 26.09999999999993, 44.5, -50.00000000000044, 47.9, 26.69999999999994, 18.29999999999982, 41.30000000000001, -50.00000000000044, -50.00000000000044, 43.7, 47.3, 28.89999999999997, 16.29999999999979, 15.699999999999783, 44.300000000000004, -50.00000000000044, 43.900000000000006, 37.90000000000003, -50.00000000000044, 34.50000000000004, 42.70000000000001, 25.499999999999922, -50.00000000000044, 26.299999999999933, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.70000000000001, -50.00000000000044, 42.10000000000001, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 32.90000000000003, 35.500000000000036, -50.00000000000044, 45.1, 45.1, 28.09999999999996, 41.90000000000001, 44.10000000000001, 44.900000000000006, 32.90000000000003, 45.9, -50.00000000000044, -50.00000000000044, 45.3, 20.49999999999985, 46.5, -50.00000000000044, 42.500000000000014, 46.3, 42.10000000000001, 2.699999999999598, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002, 35.10000000000004, 36.50000000000003, -50.00000000000044, 46.699999999999996, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 47.1, 30.9, -50.00000000000044, 42.70000000000001, 45.5, -50.00000000000044, -50.00000000000044, 11.099999999999717, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 35.70000000000003, -50.00000000000044, 46.099999999999994, 43.7, -50.00000000000044, 39.50000000000002, 45.1, -50.00000000000044], "episode_lengths": [148, 500, 54, 32, 500, 500, 240, 56, 500, 22, 234, 318, 88, 500, 500, 64, 28, 212, 338, 344, 58, 500, 62, 122, 500, 156, 74, 246, 500, 238, 500, 58, 500, 500, 500, 184, 500, 80, 52, 500, 500, 500, 74, 172, 146, 500, 50, 50, 220, 82, 60, 52, 172, 42, 500, 500, 48, 296, 36, 500, 76, 38, 80, 474, 500, 500, 500, 106, 150, 136, 500, 34, 500, 74, 500, 500, 500, 500, 56, 500, 30, 192, 500, 74, 46, 500, 500, 390, 500, 46, 500, 500, 144, 500, 40, 64, 500, 106, 50, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3816919040797543, "mean_inference_ms": 1.2315468374633312, "mean_action_processing_ms": 0.14230848175096195, "mean_env_wait_ms": 0.08603938765687165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025003671646118164, "StateBufferConnector_ms": 0.010019779205322266, "ViewRequirementAgentConnector_ms": 0.1241450309753418}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.6459999999998107, "episode_len_mean": 274.14, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [35.30000000000004, -50.00000000000044, 44.7, 46.9, -50.00000000000044, -50.00000000000044, 26.09999999999993, 44.5, -50.00000000000044, 47.9, 26.69999999999994, 18.29999999999982, 41.30000000000001, -50.00000000000044, -50.00000000000044, 43.7, 47.3, 28.89999999999997, 16.29999999999979, 15.699999999999783, 44.300000000000004, -50.00000000000044, 43.900000000000006, 37.90000000000003, -50.00000000000044, 34.50000000000004, 42.70000000000001, 25.499999999999922, -50.00000000000044, 26.299999999999933, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.70000000000001, -50.00000000000044, 42.10000000000001, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 32.90000000000003, 35.500000000000036, -50.00000000000044, 45.1, 45.1, 28.09999999999996, 41.90000000000001, 44.10000000000001, 44.900000000000006, 32.90000000000003, 45.9, -50.00000000000044, -50.00000000000044, 45.3, 20.49999999999985, 46.5, -50.00000000000044, 42.500000000000014, 46.3, 42.10000000000001, 2.699999999999598, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002, 35.10000000000004, 36.50000000000003, -50.00000000000044, 46.699999999999996, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 47.1, 30.9, -50.00000000000044, 42.70000000000001, 45.5, -50.00000000000044, -50.00000000000044, 11.099999999999717, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 35.70000000000003, -50.00000000000044, 46.099999999999994, 43.7, -50.00000000000044, 39.50000000000002, 45.1, -50.00000000000044], "episode_lengths": [148, 500, 54, 32, 500, 500, 240, 56, 500, 22, 234, 318, 88, 500, 500, 64, 28, 212, 338, 344, 58, 500, 62, 122, 500, 156, 74, 246, 500, 238, 500, 58, 500, 500, 500, 184, 500, 80, 52, 500, 500, 500, 74, 172, 146, 500, 50, 50, 220, 82, 60, 52, 172, 42, 500, 500, 48, 296, 36, 500, 76, 38, 80, 474, 500, 500, 500, 106, 150, 136, 500, 34, 500, 74, 500, 500, 500, 500, 56, 500, 30, 192, 500, 74, 46, 500, 500, 390, 500, 46, 500, 500, 144, 500, 40, 64, 500, 106, 50, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3816919040797543, "mean_inference_ms": 1.2315468374633312, "mean_action_processing_ms": 0.14230848175096195, "mean_env_wait_ms": 0.08603938765687165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025003671646118164, "StateBufferConnector_ms": 0.010019779205322266, "ViewRequirementAgentConnector_ms": 0.1241450309753418}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5971.574196841857, "num_env_steps_trained_throughput_per_sec": 5971.574196841857, "timesteps_total": 468000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 468000, "timers": {"training_iteration_time_ms": 3115.291, "sample_time_ms": 2813.284, "load_time_ms": 18.982, "load_throughput": 948243.894, "learn_time_ms": 240.087, "learn_throughput": 74972.812, "synch_weights_time_ms": 40.841}, "counters": {"num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000}, "done": false, "episodes_total": 1755, "training_iteration": 26, "trial_id": "9f288_00014", "date": "2023-10-25_16-43-16", "timestamp": 1698248596, "time_this_iter_s": 3.0202765464782715, "time_total_s": 82.85016059875488, "pid": 9504, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 82.85016059875488, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 64.0, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.980232238769532e-09, "cur_lr": 0.0003, "total_loss": 7.173386732737224, "policy_loss": -0.07682977678875129, "vf_loss": 7.250269810358684, "vf_explained_var": -1.2814998626708984e-06, "kl": 0.00032282489503169626, "entropy": 0.5329132601618767, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 318.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 486000, "num_env_steps_trained": 486000, "num_agent_steps_sampled": 486000, "num_agent_steps_trained": 486000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.219999999999817, "episode_len_mean": 268.42, "episode_media": {}, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 47.1, 30.9, -50.00000000000044, 42.70000000000001, 45.5, -50.00000000000044, -50.00000000000044, 11.099999999999717, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 35.70000000000003, -50.00000000000044, 46.099999999999994, 43.7, -50.00000000000044, 39.50000000000002, 45.1, -50.00000000000044, 26.299999999999933, 19.09999999999983, 42.70000000000001, 21.299999999999862, 43.7, 41.500000000000014, 46.9, 42.900000000000006, 45.7, -50.00000000000044, -50.00000000000044, 43.7, 44.7, 45.9, 26.499999999999936, 26.299999999999933, 38.50000000000003, 24.099999999999902, -50.00000000000044, 46.3, 41.500000000000014, 44.900000000000006, 39.90000000000002, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 6.499999999999652, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 12.69999999999974, -50.00000000000044, 44.300000000000004, -50.00000000000044, 43.7, 18.29999999999982, 28.29999999999996, 44.300000000000004, -50.00000000000044, 33.70000000000004, -50.00000000000044, 44.900000000000006, 43.50000000000001, 42.500000000000014, 41.500000000000014, -50.00000000000044, 38.50000000000003, -50.00000000000044, 42.10000000000001, 45.7, 43.50000000000001, 29.099999999999973, 38.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.099999999999973, 29.299999999999976, 30.29999999999999, 42.10000000000001, 44.10000000000001, 27.899999999999956, 38.700000000000024, 31.900000000000013, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 74, 500, 500, 500, 500, 56, 500, 30, 192, 500, 74, 46, 500, 500, 390, 500, 46, 500, 500, 144, 500, 40, 64, 500, 106, 50, 500, 238, 310, 74, 288, 64, 86, 32, 72, 44, 500, 500, 64, 54, 42, 236, 238, 116, 260, 500, 38, 86, 52, 102, 500, 500, 46, 500, 436, 52, 500, 500, 500, 500, 500, 62, 374, 500, 58, 500, 64, 318, 218, 58, 500, 164, 500, 52, 66, 76, 86, 500, 116, 500, 80, 44, 66, 210, 114, 500, 500, 500, 210, 208, 198, 80, 60, 222, 114, 182, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3814025073089131, "mean_inference_ms": 1.2312446550936378, "mean_action_processing_ms": 0.1423817717551371, "mean_env_wait_ms": 0.08571836901995997, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02199530601501465, "StateBufferConnector_ms": 0.008999347686767578, "ViewRequirementAgentConnector_ms": 0.10718846321105957}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.219999999999817, "episode_len_mean": 268.42, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 47.1, 30.9, -50.00000000000044, 42.70000000000001, 45.5, -50.00000000000044, -50.00000000000044, 11.099999999999717, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 35.70000000000003, -50.00000000000044, 46.099999999999994, 43.7, -50.00000000000044, 39.50000000000002, 45.1, -50.00000000000044, 26.299999999999933, 19.09999999999983, 42.70000000000001, 21.299999999999862, 43.7, 41.500000000000014, 46.9, 42.900000000000006, 45.7, -50.00000000000044, -50.00000000000044, 43.7, 44.7, 45.9, 26.499999999999936, 26.299999999999933, 38.50000000000003, 24.099999999999902, -50.00000000000044, 46.3, 41.500000000000014, 44.900000000000006, 39.90000000000002, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 6.499999999999652, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 12.69999999999974, -50.00000000000044, 44.300000000000004, -50.00000000000044, 43.7, 18.29999999999982, 28.29999999999996, 44.300000000000004, -50.00000000000044, 33.70000000000004, -50.00000000000044, 44.900000000000006, 43.50000000000001, 42.500000000000014, 41.500000000000014, -50.00000000000044, 38.50000000000003, -50.00000000000044, 42.10000000000001, 45.7, 43.50000000000001, 29.099999999999973, 38.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.099999999999973, 29.299999999999976, 30.29999999999999, 42.10000000000001, 44.10000000000001, 27.899999999999956, 38.700000000000024, 31.900000000000013, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 74, 500, 500, 500, 500, 56, 500, 30, 192, 500, 74, 46, 500, 500, 390, 500, 46, 500, 500, 144, 500, 40, 64, 500, 106, 50, 500, 238, 310, 74, 288, 64, 86, 32, 72, 44, 500, 500, 64, 54, 42, 236, 238, 116, 260, 500, 38, 86, 52, 102, 500, 500, 46, 500, 436, 52, 500, 500, 500, 500, 500, 62, 374, 500, 58, 500, 64, 318, 218, 58, 500, 164, 500, 52, 66, 76, 86, 500, 116, 500, 80, 44, 66, 210, 114, 500, 500, 500, 210, 208, 198, 80, 60, 222, 114, 182, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3814025073089131, "mean_inference_ms": 1.2312446550936378, "mean_action_processing_ms": 0.1423817717551371, "mean_env_wait_ms": 0.08571836901995997, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02199530601501465, "StateBufferConnector_ms": 0.008999347686767578, "ViewRequirementAgentConnector_ms": 0.10718846321105957}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 486000, "num_agent_steps_trained": 486000, "num_env_steps_sampled": 486000, "num_env_steps_trained": 486000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5738.950933291089, "num_env_steps_trained_throughput_per_sec": 5738.950933291089, "timesteps_total": 486000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 486000, "timers": {"training_iteration_time_ms": 3129.392, "sample_time_ms": 2825.282, "load_time_ms": 19.861, "load_throughput": 906309.349, "learn_time_ms": 241.305, "learn_throughput": 74594.255, "synch_weights_time_ms": 40.647}, "counters": {"num_env_steps_sampled": 486000, "num_env_steps_trained": 486000, "num_agent_steps_sampled": 486000, "num_agent_steps_trained": 486000}, "done": false, "episodes_total": 1827, "training_iteration": 27, "trial_id": "9f288_00014", "date": "2023-10-25_16-43-20", "timestamp": 1698248600, "time_this_iter_s": 3.1414546966552734, "time_total_s": 85.99161529541016, "pid": 9504, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 85.99161529541016, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 61.625, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.490116119384766e-09, "cur_lr": 0.0003, "total_loss": 7.082141836484273, "policy_loss": -0.02624940127134323, "vf_loss": 7.108449300130208, "vf_explained_var": -2.339482307434082e-06, "kl": 0.0006444328660961673, "entropy": 0.5822001248598099, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 330.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.80899999999987, "episode_len_mean": 227.64, "episode_media": {}, "episodes_this_iter": 81, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.10000000000001, 45.7, 43.50000000000001, 29.099999999999973, 38.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.099999999999973, 29.299999999999976, 30.29999999999999, 42.10000000000001, 44.10000000000001, 27.899999999999956, 38.700000000000024, 31.900000000000013, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 40.500000000000014, 33.70000000000004, 37.300000000000026, 10.299999999999706, -50.00000000000044, -50.00000000000044, 46.699999999999996, 28.699999999999967, -50.00000000000044, -50.00000000000044, 39.70000000000002, 46.699999999999996, 45.1, 30.699999999999996, 38.700000000000024, 44.5, 44.10000000000001, 42.10000000000001, -50.00000000000044, 44.5, 41.90000000000001, 42.500000000000014, 41.500000000000014, 45.1, -50.00000000000044, 43.30000000000001, 35.900000000000034, 39.10000000000002, 46.3, 43.30000000000001, -50.00000000000044, -50.00000000000044, 43.7, 40.90000000000002, 41.30000000000001, 43.900000000000006, 27.299999999999947, 39.90000000000002, 44.5, 38.700000000000024, 43.7, 43.50000000000001, 17.69999999999981, 40.30000000000002, 44.7, 21.89999999999987, -50.00000000000044, 12.099999999999731, 17.099999999999802, 41.70000000000002, 41.90000000000001, 34.900000000000034, 41.100000000000016, 33.90000000000004, 31.900000000000013, 42.70000000000001, 37.300000000000026, 43.10000000000001, 40.90000000000002, -50.00000000000044, 12.69999999999974, 35.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.50000000000003, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 43.50000000000001, 21.699999999999868, 36.10000000000004, -50.00000000000044, 41.100000000000016], "episode_lengths": [80, 44, 66, 210, 114, 500, 500, 500, 210, 208, 198, 80, 60, 222, 114, 182, 500, 500, 500, 50, 500, 96, 164, 128, 398, 500, 500, 34, 214, 500, 500, 104, 34, 50, 194, 114, 56, 60, 80, 500, 56, 82, 76, 86, 50, 500, 68, 142, 110, 38, 68, 500, 500, 64, 92, 88, 62, 228, 102, 56, 114, 64, 66, 324, 98, 54, 282, 500, 380, 330, 84, 82, 152, 90, 162, 182, 74, 128, 70, 92, 500, 374, 150, 500, 500, 500, 500, 136, 500, 500, 94, 500, 70, 500, 500, 66, 284, 140, 500, 90]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38083434061355786, "mean_inference_ms": 1.2278134081296999, "mean_action_processing_ms": 0.14157490061044942, "mean_env_wait_ms": 0.08547472459866708, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019002199172973633, "StateBufferConnector_ms": 0.004997730255126953, "ViewRequirementAgentConnector_ms": 0.11399340629577637}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.80899999999987, "episode_len_mean": 227.64, "episodes_this_iter": 81, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.10000000000001, 45.7, 43.50000000000001, 29.099999999999973, 38.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.099999999999973, 29.299999999999976, 30.29999999999999, 42.10000000000001, 44.10000000000001, 27.899999999999956, 38.700000000000024, 31.900000000000013, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 40.500000000000014, 33.70000000000004, 37.300000000000026, 10.299999999999706, -50.00000000000044, -50.00000000000044, 46.699999999999996, 28.699999999999967, -50.00000000000044, -50.00000000000044, 39.70000000000002, 46.699999999999996, 45.1, 30.699999999999996, 38.700000000000024, 44.5, 44.10000000000001, 42.10000000000001, -50.00000000000044, 44.5, 41.90000000000001, 42.500000000000014, 41.500000000000014, 45.1, -50.00000000000044, 43.30000000000001, 35.900000000000034, 39.10000000000002, 46.3, 43.30000000000001, -50.00000000000044, -50.00000000000044, 43.7, 40.90000000000002, 41.30000000000001, 43.900000000000006, 27.299999999999947, 39.90000000000002, 44.5, 38.700000000000024, 43.7, 43.50000000000001, 17.69999999999981, 40.30000000000002, 44.7, 21.89999999999987, -50.00000000000044, 12.099999999999731, 17.099999999999802, 41.70000000000002, 41.90000000000001, 34.900000000000034, 41.100000000000016, 33.90000000000004, 31.900000000000013, 42.70000000000001, 37.300000000000026, 43.10000000000001, 40.90000000000002, -50.00000000000044, 12.69999999999974, 35.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.50000000000003, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 43.50000000000001, 21.699999999999868, 36.10000000000004, -50.00000000000044, 41.100000000000016], "episode_lengths": [80, 44, 66, 210, 114, 500, 500, 500, 210, 208, 198, 80, 60, 222, 114, 182, 500, 500, 500, 50, 500, 96, 164, 128, 398, 500, 500, 34, 214, 500, 500, 104, 34, 50, 194, 114, 56, 60, 80, 500, 56, 82, 76, 86, 50, 500, 68, 142, 110, 38, 68, 500, 500, 64, 92, 88, 62, 228, 102, 56, 114, 64, 66, 324, 98, 54, 282, 500, 380, 330, 84, 82, 152, 90, 162, 182, 74, 128, 70, 92, 500, 374, 150, 500, 500, 500, 500, 136, 500, 500, 94, 500, 70, 500, 500, 66, 284, 140, 500, 90]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38083434061355786, "mean_inference_ms": 1.2278134081296999, "mean_action_processing_ms": 0.14157490061044942, "mean_env_wait_ms": 0.08547472459866708, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019002199172973633, "StateBufferConnector_ms": 0.004997730255126953, "ViewRequirementAgentConnector_ms": 0.11399340629577637}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5743.320218852931, "num_env_steps_trained_throughput_per_sec": 5743.320218852931, "timesteps_total": 504000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 504000, "timers": {"training_iteration_time_ms": 3126.859, "sample_time_ms": 2823.305, "load_time_ms": 19.779, "load_throughput": 910057.643, "learn_time_ms": 240.691, "learn_throughput": 74784.706, "synch_weights_time_ms": 40.686}, "counters": {"num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000}, "done": false, "episodes_total": 1908, "training_iteration": 28, "trial_id": "9f288_00014", "date": "2023-10-25_16-43-23", "timestamp": 1698248603, "time_this_iter_s": 3.140075922012329, "time_total_s": 89.13169121742249, "pid": 9504, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 89.13169121742249, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 57.080000000000005, "ram_util_percent": 27.32}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.45058059692383e-10, "cur_lr": 0.0003, "total_loss": 6.932804544766744, "policy_loss": 0.04335299382607142, "vf_loss": 6.889504472414653, "vf_explained_var": 5.265076955159506e-07, "kl": 0.0002293180343500012, "entropy": 0.5293558686971664, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 342.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 522000, "num_env_steps_trained": 522000, "num_agent_steps_sampled": 522000, "num_agent_steps_trained": 522000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.830999999999833, "episode_len_mean": 257.34, "episode_media": {}, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.70000000000001, 37.300000000000026, 43.10000000000001, 40.90000000000002, -50.00000000000044, 12.69999999999974, 35.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.50000000000003, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 43.50000000000001, 21.699999999999868, 36.10000000000004, -50.00000000000044, 41.100000000000016, 10.899999999999714, 21.09999999999986, 46.099999999999994, 43.7, -50.00000000000044, 24.299999999999905, 42.900000000000006, -50.00000000000044, 33.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 40.30000000000002, 46.099999999999994, -50.00000000000044, 43.30000000000001, 42.30000000000001, -50.00000000000044, 23.099999999999888, -50.00000000000044, 42.10000000000001, -50.00000000000044, 45.7, 40.90000000000002, 41.500000000000014, -50.00000000000044, 44.300000000000004, -50.00000000000044, 45.3, 45.7, 34.900000000000034, -50.00000000000044, 40.90000000000002, 36.10000000000004, 38.10000000000002, 41.100000000000016, 41.500000000000014, 25.099999999999916, 34.10000000000004, 43.10000000000001, 45.5, 43.7, 41.70000000000002, 6.499999999999652, -50.00000000000044, -50.00000000000044, 17.499999999999808, 37.70000000000003, 40.70000000000002, -50.00000000000044, 39.300000000000026, -50.00000000000044, 17.299999999999805, 46.3, 46.699999999999996, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 39.90000000000002, 47.3, 25.699999999999925, 35.10000000000004, 44.5, -50.00000000000044, 34.900000000000034, 44.10000000000001, 38.300000000000026, -50.00000000000044, 42.30000000000001, 29.49999999999998], "episode_lengths": [74, 128, 70, 92, 500, 374, 150, 500, 500, 500, 500, 136, 500, 500, 94, 500, 70, 500, 500, 66, 284, 140, 500, 90, 392, 290, 40, 64, 500, 258, 72, 500, 164, 500, 500, 500, 42, 500, 500, 98, 40, 500, 68, 78, 500, 270, 500, 80, 500, 44, 92, 86, 500, 58, 500, 48, 44, 152, 500, 92, 140, 120, 90, 86, 250, 160, 70, 46, 64, 84, 436, 500, 500, 326, 124, 94, 500, 108, 500, 328, 38, 34, 500, 56, 500, 500, 46, 500, 102, 28, 244, 150, 56, 500, 152, 60, 118, 500, 78, 206]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3808737850010395, "mean_inference_ms": 1.2291709704525968, "mean_action_processing_ms": 0.14211176007298892, "mean_env_wait_ms": 0.08566276920850971, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020014524459838867, "StateBufferConnector_ms": 0.009996414184570312, "ViewRequirementAgentConnector_ms": 0.11313080787658691}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.830999999999833, "episode_len_mean": 257.34, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.70000000000001, 37.300000000000026, 43.10000000000001, 40.90000000000002, -50.00000000000044, 12.69999999999974, 35.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.50000000000003, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 43.50000000000001, 21.699999999999868, 36.10000000000004, -50.00000000000044, 41.100000000000016, 10.899999999999714, 21.09999999999986, 46.099999999999994, 43.7, -50.00000000000044, 24.299999999999905, 42.900000000000006, -50.00000000000044, 33.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 40.30000000000002, 46.099999999999994, -50.00000000000044, 43.30000000000001, 42.30000000000001, -50.00000000000044, 23.099999999999888, -50.00000000000044, 42.10000000000001, -50.00000000000044, 45.7, 40.90000000000002, 41.500000000000014, -50.00000000000044, 44.300000000000004, -50.00000000000044, 45.3, 45.7, 34.900000000000034, -50.00000000000044, 40.90000000000002, 36.10000000000004, 38.10000000000002, 41.100000000000016, 41.500000000000014, 25.099999999999916, 34.10000000000004, 43.10000000000001, 45.5, 43.7, 41.70000000000002, 6.499999999999652, -50.00000000000044, -50.00000000000044, 17.499999999999808, 37.70000000000003, 40.70000000000002, -50.00000000000044, 39.300000000000026, -50.00000000000044, 17.299999999999805, 46.3, 46.699999999999996, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 39.90000000000002, 47.3, 25.699999999999925, 35.10000000000004, 44.5, -50.00000000000044, 34.900000000000034, 44.10000000000001, 38.300000000000026, -50.00000000000044, 42.30000000000001, 29.49999999999998], "episode_lengths": [74, 128, 70, 92, 500, 374, 150, 500, 500, 500, 500, 136, 500, 500, 94, 500, 70, 500, 500, 66, 284, 140, 500, 90, 392, 290, 40, 64, 500, 258, 72, 500, 164, 500, 500, 500, 42, 500, 500, 98, 40, 500, 68, 78, 500, 270, 500, 80, 500, 44, 92, 86, 500, 58, 500, 48, 44, 152, 500, 92, 140, 120, 90, 86, 250, 160, 70, 46, 64, 84, 436, 500, 500, 326, 124, 94, 500, 108, 500, 328, 38, 34, 500, 56, 500, 500, 46, 500, 102, 28, 244, 150, 56, 500, 152, 60, 118, 500, 78, 206]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3808737850010395, "mean_inference_ms": 1.2291709704525968, "mean_action_processing_ms": 0.14211176007298892, "mean_env_wait_ms": 0.08566276920850971, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020014524459838867, "StateBufferConnector_ms": 0.009996414184570312, "ViewRequirementAgentConnector_ms": 0.11313080787658691}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 522000, "num_agent_steps_trained": 522000, "num_env_steps_sampled": 522000, "num_env_steps_trained": 522000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5798.17349115338, "num_env_steps_trained_throughput_per_sec": 5798.17349115338, "timesteps_total": 522000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 522000, "timers": {"training_iteration_time_ms": 3127.39, "sample_time_ms": 2824.842, "load_time_ms": 20.005, "load_throughput": 899791.694, "learn_time_ms": 239.386, "learn_throughput": 75192.229, "synch_weights_time_ms": 40.758}, "counters": {"num_env_steps_sampled": 522000, "num_env_steps_trained": 522000, "num_agent_steps_sampled": 522000, "num_agent_steps_trained": 522000}, "done": false, "episodes_total": 1984, "training_iteration": 29, "trial_id": "9f288_00014", "date": "2023-10-25_16-43-26", "timestamp": 1698248606, "time_this_iter_s": 3.1094248294830322, "time_total_s": 92.24111604690552, "pid": 9504, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 92.24111604690552, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 65.07499999999999, "ram_util_percent": 27.35}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.725290298461915e-10, "cur_lr": 0.0003, "total_loss": 6.69630781809489, "policy_loss": 0.0057181694234410925, "vf_loss": 6.690643509229024, "vf_explained_var": -4.867712656656901e-07, "kl": 4.897954417278546e-05, "entropy": 0.5394440392653147, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 354.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.086999999999832, "episode_len_mean": 254.78, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.499999999999652, -50.00000000000044, -50.00000000000044, 17.499999999999808, 37.70000000000003, 40.70000000000002, -50.00000000000044, 39.300000000000026, -50.00000000000044, 17.299999999999805, 46.3, 46.699999999999996, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 39.90000000000002, 47.3, 25.699999999999925, 35.10000000000004, 44.5, -50.00000000000044, 34.900000000000034, 44.10000000000001, 38.300000000000026, -50.00000000000044, 42.30000000000001, 29.49999999999998, -50.00000000000044, 44.300000000000004, 43.50000000000001, 37.70000000000003, -50.00000000000044, 41.30000000000001, 47.7, 43.30000000000001, -50.00000000000044, 41.70000000000002, -50.00000000000044, 39.70000000000002, 39.70000000000002, 42.30000000000001, 44.5, 44.300000000000004, 37.300000000000026, 44.300000000000004, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.10000000000004, 44.300000000000004, 39.70000000000002, 42.10000000000001, 36.50000000000003, 23.499999999999893, -50.00000000000044, 41.90000000000001, 39.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 22.299999999999876, 45.3, 43.10000000000001, 46.5, 23.8999999999999, 45.5, -50.00000000000044, -50.00000000000044, 39.90000000000002, 44.900000000000006, -50.00000000000044, 26.299999999999933, 32.90000000000003, -50.00000000000044, -50.00000000000044, 39.70000000000002, 44.7, -50.00000000000044, 37.300000000000026, 3.699999999999612, -50.00000000000044, -50.00000000000044, 44.5, 46.3, -50.00000000000044, -50.00000000000044, 42.900000000000006, 43.10000000000001, -50.00000000000044, 44.5, 15.699999999999783, -50.00000000000044, -50.00000000000044, 22.099999999999874, 40.70000000000002], "episode_lengths": [436, 500, 500, 326, 124, 94, 500, 108, 500, 328, 38, 34, 500, 56, 500, 500, 46, 500, 102, 28, 244, 150, 56, 500, 152, 60, 118, 500, 78, 206, 500, 58, 66, 124, 500, 88, 24, 68, 500, 84, 500, 104, 104, 78, 56, 58, 128, 58, 40, 500, 500, 500, 500, 160, 58, 104, 80, 136, 266, 500, 82, 106, 500, 500, 500, 278, 48, 70, 36, 262, 46, 500, 500, 102, 52, 500, 238, 172, 500, 500, 104, 54, 500, 128, 464, 500, 500, 56, 38, 500, 500, 72, 70, 500, 56, 344, 500, 500, 280, 94]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3810110334526145, "mean_inference_ms": 1.2275064213324192, "mean_action_processing_ms": 0.14185796445411974, "mean_env_wait_ms": 0.08569252910166326, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019525527954101562, "StateBufferConnector_ms": 0.007996082305908203, "ViewRequirementAgentConnector_ms": 0.13770246505737305}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.086999999999832, "episode_len_mean": 254.78, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.499999999999652, -50.00000000000044, -50.00000000000044, 17.499999999999808, 37.70000000000003, 40.70000000000002, -50.00000000000044, 39.300000000000026, -50.00000000000044, 17.299999999999805, 46.3, 46.699999999999996, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 39.90000000000002, 47.3, 25.699999999999925, 35.10000000000004, 44.5, -50.00000000000044, 34.900000000000034, 44.10000000000001, 38.300000000000026, -50.00000000000044, 42.30000000000001, 29.49999999999998, -50.00000000000044, 44.300000000000004, 43.50000000000001, 37.70000000000003, -50.00000000000044, 41.30000000000001, 47.7, 43.30000000000001, -50.00000000000044, 41.70000000000002, -50.00000000000044, 39.70000000000002, 39.70000000000002, 42.30000000000001, 44.5, 44.300000000000004, 37.300000000000026, 44.300000000000004, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.10000000000004, 44.300000000000004, 39.70000000000002, 42.10000000000001, 36.50000000000003, 23.499999999999893, -50.00000000000044, 41.90000000000001, 39.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 22.299999999999876, 45.3, 43.10000000000001, 46.5, 23.8999999999999, 45.5, -50.00000000000044, -50.00000000000044, 39.90000000000002, 44.900000000000006, -50.00000000000044, 26.299999999999933, 32.90000000000003, -50.00000000000044, -50.00000000000044, 39.70000000000002, 44.7, -50.00000000000044, 37.300000000000026, 3.699999999999612, -50.00000000000044, -50.00000000000044, 44.5, 46.3, -50.00000000000044, -50.00000000000044, 42.900000000000006, 43.10000000000001, -50.00000000000044, 44.5, 15.699999999999783, -50.00000000000044, -50.00000000000044, 22.099999999999874, 40.70000000000002], "episode_lengths": [436, 500, 500, 326, 124, 94, 500, 108, 500, 328, 38, 34, 500, 56, 500, 500, 46, 500, 102, 28, 244, 150, 56, 500, 152, 60, 118, 500, 78, 206, 500, 58, 66, 124, 500, 88, 24, 68, 500, 84, 500, 104, 104, 78, 56, 58, 128, 58, 40, 500, 500, 500, 500, 160, 58, 104, 80, 136, 266, 500, 82, 106, 500, 500, 500, 278, 48, 70, 36, 262, 46, 500, 500, 102, 52, 500, 238, 172, 500, 500, 104, 54, 500, 128, 464, 500, 500, 56, 38, 500, 500, 72, 70, 500, 56, 344, 500, 500, 280, 94]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3810110334526145, "mean_inference_ms": 1.2275064213324192, "mean_action_processing_ms": 0.14185796445411974, "mean_env_wait_ms": 0.08569252910166326, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019525527954101562, "StateBufferConnector_ms": 0.007996082305908203, "ViewRequirementAgentConnector_ms": 0.13770246505737305}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5554.976314406589, "num_env_steps_trained_throughput_per_sec": 5554.976314406589, "timesteps_total": 540000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 540000, "timers": {"training_iteration_time_ms": 3130.144, "sample_time_ms": 2826.773, "load_time_ms": 19.843, "load_throughput": 907103.18, "learn_time_ms": 240.268, "learn_throughput": 74916.42, "synch_weights_time_ms": 40.785}, "counters": {"num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000}, "done": false, "episodes_total": 2054, "training_iteration": 30, "trial_id": "9f288_00014", "date": "2023-10-25_16-43-29", "timestamp": 1698248609, "time_this_iter_s": 3.245335578918457, "time_total_s": 95.48645162582397, "pid": 9504, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 95.48645162582397, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 56.74000000000001, "ram_util_percent": 27.380000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.8626451492309574e-10, "cur_lr": 0.0003, "total_loss": 6.538548270861308, "policy_loss": -0.0021440525694439807, "vf_loss": 6.540748715400696, "vf_explained_var": -1.5546878178914387e-06, "kl": 1.0336956105897835e-05, "entropy": 0.563202939927578, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 366.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 558000, "num_env_steps_trained": 558000, "num_agent_steps_sampled": 558000, "num_agent_steps_trained": 558000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.1519999999998043, "episode_len_mean": 279.08, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 22.299999999999876, 45.3, 43.10000000000001, 46.5, 23.8999999999999, 45.5, -50.00000000000044, -50.00000000000044, 39.90000000000002, 44.900000000000006, -50.00000000000044, 26.299999999999933, 32.90000000000003, -50.00000000000044, -50.00000000000044, 39.70000000000002, 44.7, -50.00000000000044, 37.300000000000026, 3.699999999999612, -50.00000000000044, -50.00000000000044, 44.5, 46.3, -50.00000000000044, -50.00000000000044, 42.900000000000006, 43.10000000000001, -50.00000000000044, 44.5, 15.699999999999783, -50.00000000000044, -50.00000000000044, 22.099999999999874, 40.70000000000002, -50.00000000000044, 26.09999999999993, -50.00000000000044, 47.1, 30.9, 43.50000000000001, 42.70000000000001, 2.8999999999996007, -50.00000000000044, 36.50000000000003, -50.00000000000044, 42.10000000000001, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 36.30000000000003, 43.7, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 38.700000000000024, 45.1, -50.00000000000044, 14.299999999999763, 42.30000000000001, -50.00000000000044, 44.300000000000004, -50.00000000000044, 42.500000000000014, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 43.900000000000006, 38.700000000000024, 41.70000000000002, 43.10000000000001, 19.899999999999842, 21.89999999999987, -50.00000000000044, -50.00000000000044, 47.7, -50.00000000000044, 38.90000000000002, -50.00000000000044, 45.5, 30.29999999999999, 8.299999999999677, 44.5, 38.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.300000000000026, 30.9, 43.50000000000001, -50.00000000000044, 44.7], "episode_lengths": [500, 278, 48, 70, 36, 262, 46, 500, 500, 102, 52, 500, 238, 172, 500, 500, 104, 54, 500, 128, 464, 500, 500, 56, 38, 500, 500, 72, 70, 500, 56, 344, 500, 500, 280, 94, 500, 240, 500, 30, 192, 66, 74, 472, 500, 136, 500, 80, 500, 52, 500, 500, 76, 500, 138, 64, 50, 500, 500, 500, 500, 60, 114, 50, 500, 358, 78, 500, 58, 500, 76, 500, 78, 500, 500, 62, 114, 84, 70, 302, 282, 500, 500, 24, 500, 112, 500, 46, 198, 418, 56, 114, 500, 500, 500, 108, 192, 66, 500, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38084760106704457, "mean_inference_ms": 1.2278107026372742, "mean_action_processing_ms": 0.1418473505333098, "mean_env_wait_ms": 0.08525404834122095, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02951955795288086, "StateBufferConnector_ms": 0.006001472473144531, "ViewRequirementAgentConnector_ms": 0.1275625228881836}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.1519999999998043, "episode_len_mean": 279.08, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 22.299999999999876, 45.3, 43.10000000000001, 46.5, 23.8999999999999, 45.5, -50.00000000000044, -50.00000000000044, 39.90000000000002, 44.900000000000006, -50.00000000000044, 26.299999999999933, 32.90000000000003, -50.00000000000044, -50.00000000000044, 39.70000000000002, 44.7, -50.00000000000044, 37.300000000000026, 3.699999999999612, -50.00000000000044, -50.00000000000044, 44.5, 46.3, -50.00000000000044, -50.00000000000044, 42.900000000000006, 43.10000000000001, -50.00000000000044, 44.5, 15.699999999999783, -50.00000000000044, -50.00000000000044, 22.099999999999874, 40.70000000000002, -50.00000000000044, 26.09999999999993, -50.00000000000044, 47.1, 30.9, 43.50000000000001, 42.70000000000001, 2.8999999999996007, -50.00000000000044, 36.50000000000003, -50.00000000000044, 42.10000000000001, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 36.30000000000003, 43.7, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 38.700000000000024, 45.1, -50.00000000000044, 14.299999999999763, 42.30000000000001, -50.00000000000044, 44.300000000000004, -50.00000000000044, 42.500000000000014, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 43.900000000000006, 38.700000000000024, 41.70000000000002, 43.10000000000001, 19.899999999999842, 21.89999999999987, -50.00000000000044, -50.00000000000044, 47.7, -50.00000000000044, 38.90000000000002, -50.00000000000044, 45.5, 30.29999999999999, 8.299999999999677, 44.5, 38.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.300000000000026, 30.9, 43.50000000000001, -50.00000000000044, 44.7], "episode_lengths": [500, 278, 48, 70, 36, 262, 46, 500, 500, 102, 52, 500, 238, 172, 500, 500, 104, 54, 500, 128, 464, 500, 500, 56, 38, 500, 500, 72, 70, 500, 56, 344, 500, 500, 280, 94, 500, 240, 500, 30, 192, 66, 74, 472, 500, 136, 500, 80, 500, 52, 500, 500, 76, 500, 138, 64, 50, 500, 500, 500, 500, 60, 114, 50, 500, 358, 78, 500, 58, 500, 76, 500, 78, 500, 500, 62, 114, 84, 70, 302, 282, 500, 500, 24, 500, 112, 500, 46, 198, 418, 56, 114, 500, 500, 500, 108, 192, 66, 500, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38084760106704457, "mean_inference_ms": 1.2278107026372742, "mean_action_processing_ms": 0.1418473505333098, "mean_env_wait_ms": 0.08525404834122095, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02951955795288086, "StateBufferConnector_ms": 0.006001472473144531, "ViewRequirementAgentConnector_ms": 0.1275625228881836}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 558000, "num_agent_steps_trained": 558000, "num_env_steps_sampled": 558000, "num_env_steps_trained": 558000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5657.259739935679, "num_env_steps_trained_throughput_per_sec": 5657.259739935679, "timesteps_total": 558000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 558000, "timers": {"training_iteration_time_ms": 3144.24, "sample_time_ms": 2831.872, "load_time_ms": 20.481, "load_throughput": 878853.518, "learn_time_ms": 248.807, "learn_throughput": 72345.342, "synch_weights_time_ms": 40.57}, "counters": {"num_env_steps_sampled": 558000, "num_env_steps_trained": 558000, "num_agent_steps_sampled": 558000, "num_agent_steps_trained": 558000}, "done": false, "episodes_total": 2118, "training_iteration": 31, "trial_id": "9f288_00014", "date": "2023-10-25_16-43-32", "timestamp": 1698248612, "time_this_iter_s": 3.1877498626708984, "time_total_s": 98.67420148849487, "pid": 9504, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 98.67420148849487, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 64.175, "ram_util_percent": 27.25}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.313225746154787e-11, "cur_lr": 0.0003, "total_loss": 6.637422323226929, "policy_loss": 0.0022405547400315604, "vf_loss": 6.635235826174418, "vf_explained_var": 7.748603820800781e-07, "kl": 5.8856287801371345e-05, "entropy": 0.5403996904691061, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 378.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.3229999999998066, "episode_len_mean": 282.36, "episode_media": {}, "episodes_this_iter": 62, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [38.700000000000024, 45.1, -50.00000000000044, 14.299999999999763, 42.30000000000001, -50.00000000000044, 44.300000000000004, -50.00000000000044, 42.500000000000014, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 43.900000000000006, 38.700000000000024, 41.70000000000002, 43.10000000000001, 19.899999999999842, 21.89999999999987, -50.00000000000044, -50.00000000000044, 47.7, -50.00000000000044, 38.90000000000002, -50.00000000000044, 45.5, 30.29999999999999, 8.299999999999677, 44.5, 38.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.300000000000026, 30.9, 43.50000000000001, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 41.90000000000001, 43.7, 39.50000000000002, 38.700000000000024, -50.00000000000044, 42.30000000000001, 36.70000000000003, 43.10000000000001, 46.099999999999994, -50.00000000000044, 31.1, 43.30000000000001, 26.09999999999993, 40.70000000000002, 39.50000000000002, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 20.899999999999856, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, 30.499999999999993, 33.70000000000004, -50.00000000000044, 45.1, 31.300000000000004, 42.30000000000001, -50.00000000000044, 37.10000000000003, -50.00000000000044, 44.10000000000001, -50.00000000000044, 24.69999999999991, 30.9, 39.50000000000002, 44.5, 8.099999999999675, -50.00000000000044, 4.099999999999618, 43.10000000000001, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 40.500000000000014], "episode_lengths": [114, 50, 500, 358, 78, 500, 58, 500, 76, 500, 78, 500, 500, 62, 114, 84, 70, 302, 282, 500, 500, 24, 500, 112, 500, 46, 198, 418, 56, 114, 500, 500, 500, 108, 192, 66, 500, 54, 500, 500, 500, 500, 40, 82, 64, 106, 114, 500, 78, 134, 70, 40, 500, 190, 68, 240, 94, 106, 500, 68, 500, 500, 500, 72, 500, 500, 500, 500, 292, 500, 500, 90, 500, 500, 90, 500, 196, 164, 500, 50, 188, 78, 500, 130, 500, 60, 500, 254, 192, 106, 56, 420, 500, 460, 70, 500, 64, 500, 500, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3809027875671076, "mean_inference_ms": 1.2278561466865558, "mean_action_processing_ms": 0.14131730160123698, "mean_env_wait_ms": 0.08541021513805944, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030992984771728516, "StateBufferConnector_ms": 0.0060007572174072266, "ViewRequirementAgentConnector_ms": 0.12299180030822754}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.3229999999998066, "episode_len_mean": 282.36, "episodes_this_iter": 62, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [38.700000000000024, 45.1, -50.00000000000044, 14.299999999999763, 42.30000000000001, -50.00000000000044, 44.300000000000004, -50.00000000000044, 42.500000000000014, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 43.900000000000006, 38.700000000000024, 41.70000000000002, 43.10000000000001, 19.899999999999842, 21.89999999999987, -50.00000000000044, -50.00000000000044, 47.7, -50.00000000000044, 38.90000000000002, -50.00000000000044, 45.5, 30.29999999999999, 8.299999999999677, 44.5, 38.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.300000000000026, 30.9, 43.50000000000001, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 41.90000000000001, 43.7, 39.50000000000002, 38.700000000000024, -50.00000000000044, 42.30000000000001, 36.70000000000003, 43.10000000000001, 46.099999999999994, -50.00000000000044, 31.1, 43.30000000000001, 26.09999999999993, 40.70000000000002, 39.50000000000002, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 20.899999999999856, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, 30.499999999999993, 33.70000000000004, -50.00000000000044, 45.1, 31.300000000000004, 42.30000000000001, -50.00000000000044, 37.10000000000003, -50.00000000000044, 44.10000000000001, -50.00000000000044, 24.69999999999991, 30.9, 39.50000000000002, 44.5, 8.099999999999675, -50.00000000000044, 4.099999999999618, 43.10000000000001, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 40.500000000000014], "episode_lengths": [114, 50, 500, 358, 78, 500, 58, 500, 76, 500, 78, 500, 500, 62, 114, 84, 70, 302, 282, 500, 500, 24, 500, 112, 500, 46, 198, 418, 56, 114, 500, 500, 500, 108, 192, 66, 500, 54, 500, 500, 500, 500, 40, 82, 64, 106, 114, 500, 78, 134, 70, 40, 500, 190, 68, 240, 94, 106, 500, 68, 500, 500, 500, 72, 500, 500, 500, 500, 292, 500, 500, 90, 500, 500, 90, 500, 196, 164, 500, 50, 188, 78, 500, 130, 500, 60, 500, 254, 192, 106, 56, 420, 500, 460, 70, 500, 64, 500, 500, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3809027875671076, "mean_inference_ms": 1.2278561466865558, "mean_action_processing_ms": 0.14131730160123698, "mean_env_wait_ms": 0.08541021513805944, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030992984771728516, "StateBufferConnector_ms": 0.0060007572174072266, "ViewRequirementAgentConnector_ms": 0.12299180030822754}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5844.289898871047, "num_env_steps_trained_throughput_per_sec": 5844.289898871047, "timesteps_total": 576000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 576000, "timers": {"training_iteration_time_ms": 3141.101, "sample_time_ms": 2836.289, "load_time_ms": 19.664, "load_throughput": 915362.75, "learn_time_ms": 241.991, "learn_throughput": 74382.933, "synch_weights_time_ms": 40.651}, "counters": {"num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "done": false, "episodes_total": 2180, "training_iteration": 32, "trial_id": "9f288_00014", "date": "2023-10-25_16-43-36", "timestamp": 1698248616, "time_this_iter_s": 3.0849225521087646, "time_total_s": 101.75912404060364, "pid": 9504, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 101.75912404060364, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 57.239999999999995, "ram_util_percent": 27.32}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.6566128730773935e-11, "cur_lr": 0.0003, "total_loss": 6.674493749936421, "policy_loss": -0.031626248421768345, "vf_loss": 6.7061757644017534, "vf_explained_var": 2.582867940266927e-07, "kl": 7.579631556560902e-05, "entropy": 0.5562856048345566, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 390.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 594000, "num_env_steps_trained": 594000, "num_agent_steps_sampled": 594000, "num_agent_steps_trained": 594000}, "sampler_results": {"episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.7439999999998133, "episode_len_mean": 283.16, "episode_media": {}, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 20.899999999999856, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, 30.499999999999993, 33.70000000000004, -50.00000000000044, 45.1, 31.300000000000004, 42.30000000000001, -50.00000000000044, 37.10000000000003, -50.00000000000044, 44.10000000000001, -50.00000000000044, 24.69999999999991, 30.9, 39.50000000000002, 44.5, 8.099999999999675, -50.00000000000044, 4.099999999999618, 43.10000000000001, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, 42.70000000000001, 34.900000000000034, 39.300000000000026, 15.099999999999774, -50.00000000000044, -50.00000000000044, 39.70000000000002, 25.699999999999925, 43.900000000000006, 46.3, -50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 23.099999999999888, -50.00000000000044, -50.00000000000044, 11.699999999999726, 39.10000000000002, 36.70000000000003, 44.10000000000001, 37.70000000000003, -50.00000000000044, 35.900000000000034, 33.30000000000003, 29.099999999999973, 42.30000000000001, -50.00000000000044, -50.00000000000044, 31.300000000000004, 45.7, 22.49999999999988, 43.10000000000001, -50.00000000000044, -50.00000000000044, 39.50000000000002, 45.1, 42.10000000000001, 39.70000000000002, -50.00000000000044, 40.90000000000002, 27.899999999999956, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.70000000000003, 45.7, 41.500000000000014, 45.9, 43.900000000000006, 45.1, -50.00000000000044, 37.70000000000003, 32.700000000000024, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, 37.50000000000003, -50.00000000000044], "episode_lengths": [500, 500, 500, 292, 500, 500, 90, 500, 500, 90, 500, 196, 164, 500, 50, 188, 78, 500, 130, 500, 60, 500, 254, 192, 106, 56, 420, 500, 460, 70, 500, 64, 500, 500, 96, 500, 74, 152, 108, 350, 500, 500, 104, 244, 62, 38, 500, 96, 500, 500, 500, 500, 88, 270, 500, 500, 384, 110, 134, 60, 124, 500, 142, 168, 210, 78, 500, 500, 188, 44, 276, 70, 500, 500, 106, 50, 80, 104, 500, 92, 222, 500, 500, 500, 134, 44, 86, 42, 62, 50, 500, 124, 174, 86, 500, 500, 500, 104, 126, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3808513617987545, "mean_inference_ms": 1.2277595957661565, "mean_action_processing_ms": 0.1415169452376579, "mean_env_wait_ms": 0.08498330617311275, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02500748634338379, "StateBufferConnector_ms": 0.007999181747436523, "ViewRequirementAgentConnector_ms": 0.13398456573486328}}, "episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.7439999999998133, "episode_len_mean": 283.16, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 20.899999999999856, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, 30.499999999999993, 33.70000000000004, -50.00000000000044, 45.1, 31.300000000000004, 42.30000000000001, -50.00000000000044, 37.10000000000003, -50.00000000000044, 44.10000000000001, -50.00000000000044, 24.69999999999991, 30.9, 39.50000000000002, 44.5, 8.099999999999675, -50.00000000000044, 4.099999999999618, 43.10000000000001, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, 42.70000000000001, 34.900000000000034, 39.300000000000026, 15.099999999999774, -50.00000000000044, -50.00000000000044, 39.70000000000002, 25.699999999999925, 43.900000000000006, 46.3, -50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 23.099999999999888, -50.00000000000044, -50.00000000000044, 11.699999999999726, 39.10000000000002, 36.70000000000003, 44.10000000000001, 37.70000000000003, -50.00000000000044, 35.900000000000034, 33.30000000000003, 29.099999999999973, 42.30000000000001, -50.00000000000044, -50.00000000000044, 31.300000000000004, 45.7, 22.49999999999988, 43.10000000000001, -50.00000000000044, -50.00000000000044, 39.50000000000002, 45.1, 42.10000000000001, 39.70000000000002, -50.00000000000044, 40.90000000000002, 27.899999999999956, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.70000000000003, 45.7, 41.500000000000014, 45.9, 43.900000000000006, 45.1, -50.00000000000044, 37.70000000000003, 32.700000000000024, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, 37.50000000000003, -50.00000000000044], "episode_lengths": [500, 500, 500, 292, 500, 500, 90, 500, 500, 90, 500, 196, 164, 500, 50, 188, 78, 500, 130, 500, 60, 500, 254, 192, 106, 56, 420, 500, 460, 70, 500, 64, 500, 500, 96, 500, 74, 152, 108, 350, 500, 500, 104, 244, 62, 38, 500, 96, 500, 500, 500, 500, 88, 270, 500, 500, 384, 110, 134, 60, 124, 500, 142, 168, 210, 78, 500, 500, 188, 44, 276, 70, 500, 500, 106, 50, 80, 104, 500, 92, 222, 500, 500, 500, 134, 44, 86, 42, 62, 50, 500, 124, 174, 86, 500, 500, 500, 104, 126, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3808513617987545, "mean_inference_ms": 1.2277595957661565, "mean_action_processing_ms": 0.1415169452376579, "mean_env_wait_ms": 0.08498330617311275, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02500748634338379, "StateBufferConnector_ms": 0.007999181747436523, "ViewRequirementAgentConnector_ms": 0.13398456573486328}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 594000, "num_agent_steps_trained": 594000, "num_env_steps_sampled": 594000, "num_env_steps_trained": 594000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5849.338615217622, "num_env_steps_trained_throughput_per_sec": 5849.338615217622, "timesteps_total": 594000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 594000, "timers": {"training_iteration_time_ms": 3147.814, "sample_time_ms": 2838.904, "load_time_ms": 20.39, "load_throughput": 882799.703, "learn_time_ms": 245.429, "learn_throughput": 73340.855, "synch_weights_time_ms": 40.594}, "counters": {"num_env_steps_sampled": 594000, "num_env_steps_trained": 594000, "num_agent_steps_sampled": 594000, "num_agent_steps_trained": 594000}, "done": false, "episodes_total": 2245, "training_iteration": 33, "trial_id": "9f288_00014", "date": "2023-10-25_16-43-39", "timestamp": 1698248619, "time_this_iter_s": 3.082054376602173, "time_total_s": 104.84117841720581, "pid": 9504, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 104.84117841720581, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 66.10000000000001, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.3283064365386967e-11, "cur_lr": 0.0003, "total_loss": 7.101180672645569, "policy_loss": -0.03505262973097464, "vf_loss": 7.136287013689677, "vf_explained_var": -1.6391277313232422e-07, "kl": 0.00025609488240174727, "entropy": 0.5364820087949435, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 402.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.8409999999998155, "episode_len_mean": 277.2, "episode_media": {}, "episodes_this_iter": 63, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [33.30000000000003, 29.099999999999973, 42.30000000000001, -50.00000000000044, -50.00000000000044, 31.300000000000004, 45.7, 22.49999999999988, 43.10000000000001, -50.00000000000044, -50.00000000000044, 39.50000000000002, 45.1, 42.10000000000001, 39.70000000000002, -50.00000000000044, 40.90000000000002, 27.899999999999956, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.70000000000003, 45.7, 41.500000000000014, 45.9, 43.900000000000006, 45.1, -50.00000000000044, 37.70000000000003, 32.700000000000024, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, 37.50000000000003, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 26.09999999999993, 47.1, -50.00000000000044, 37.50000000000003, 18.699999999999825, 39.10000000000002, 45.9, 42.30000000000001, 44.10000000000001, -50.00000000000044, 38.300000000000026, -50.00000000000044, 2.0999999999995893, -50.00000000000044, -50.00000000000044, 0.49999999999956657, -50.00000000000044, 39.10000000000002, -50.00000000000044, 42.30000000000001, -50.00000000000044, 43.50000000000001, 42.70000000000001, 46.5, 36.30000000000003, 41.500000000000014, 39.90000000000002, -50.00000000000044, 41.30000000000001, -50.00000000000044, 41.100000000000016, 29.299999999999976, 29.69999999999998, -50.00000000000044, 36.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 18.29999999999982, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 22.299999999999876, -50.00000000000044, 31.1, -50.00000000000044, -50.00000000000044, 42.10000000000001, 24.899999999999913, -50.00000000000044, 45.7, 44.900000000000006, 35.500000000000036, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 15.099999999999774], "episode_lengths": [168, 210, 78, 500, 500, 188, 44, 276, 70, 500, 500, 106, 50, 80, 104, 500, 92, 222, 500, 500, 500, 134, 44, 86, 42, 62, 50, 500, 124, 174, 86, 500, 500, 500, 104, 126, 500, 500, 76, 500, 240, 30, 500, 126, 314, 110, 42, 78, 60, 500, 118, 500, 480, 500, 500, 496, 500, 110, 500, 78, 500, 66, 74, 36, 138, 86, 102, 500, 88, 500, 90, 208, 204, 500, 136, 500, 500, 500, 68, 318, 500, 500, 500, 72, 278, 500, 190, 500, 500, 80, 252, 500, 44, 52, 146, 500, 500, 64, 500, 350]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3802439707946881, "mean_inference_ms": 1.2267841416764793, "mean_action_processing_ms": 0.1415924454271277, "mean_env_wait_ms": 0.08472097913987182, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0229952335357666, "StateBufferConnector_ms": 0.006998777389526367, "ViewRequirementAgentConnector_ms": 0.12898516654968262}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.8409999999998155, "episode_len_mean": 277.2, "episodes_this_iter": 63, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [33.30000000000003, 29.099999999999973, 42.30000000000001, -50.00000000000044, -50.00000000000044, 31.300000000000004, 45.7, 22.49999999999988, 43.10000000000001, -50.00000000000044, -50.00000000000044, 39.50000000000002, 45.1, 42.10000000000001, 39.70000000000002, -50.00000000000044, 40.90000000000002, 27.899999999999956, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.70000000000003, 45.7, 41.500000000000014, 45.9, 43.900000000000006, 45.1, -50.00000000000044, 37.70000000000003, 32.700000000000024, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, 37.50000000000003, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 26.09999999999993, 47.1, -50.00000000000044, 37.50000000000003, 18.699999999999825, 39.10000000000002, 45.9, 42.30000000000001, 44.10000000000001, -50.00000000000044, 38.300000000000026, -50.00000000000044, 2.0999999999995893, -50.00000000000044, -50.00000000000044, 0.49999999999956657, -50.00000000000044, 39.10000000000002, -50.00000000000044, 42.30000000000001, -50.00000000000044, 43.50000000000001, 42.70000000000001, 46.5, 36.30000000000003, 41.500000000000014, 39.90000000000002, -50.00000000000044, 41.30000000000001, -50.00000000000044, 41.100000000000016, 29.299999999999976, 29.69999999999998, -50.00000000000044, 36.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 18.29999999999982, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 22.299999999999876, -50.00000000000044, 31.1, -50.00000000000044, -50.00000000000044, 42.10000000000001, 24.899999999999913, -50.00000000000044, 45.7, 44.900000000000006, 35.500000000000036, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 15.099999999999774], "episode_lengths": [168, 210, 78, 500, 500, 188, 44, 276, 70, 500, 500, 106, 50, 80, 104, 500, 92, 222, 500, 500, 500, 134, 44, 86, 42, 62, 50, 500, 124, 174, 86, 500, 500, 500, 104, 126, 500, 500, 76, 500, 240, 30, 500, 126, 314, 110, 42, 78, 60, 500, 118, 500, 480, 500, 500, 496, 500, 110, 500, 78, 500, 66, 74, 36, 138, 86, 102, 500, 88, 500, 90, 208, 204, 500, 136, 500, 500, 500, 68, 318, 500, 500, 500, 72, 278, 500, 190, 500, 500, 80, 252, 500, 44, 52, 146, 500, 500, 64, 500, 350]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3802439707946881, "mean_inference_ms": 1.2267841416764793, "mean_action_processing_ms": 0.1415924454271277, "mean_env_wait_ms": 0.08472097913987182, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0229952335357666, "StateBufferConnector_ms": 0.006998777389526367, "ViewRequirementAgentConnector_ms": 0.12898516654968262}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000, "num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5909.795034400464, "num_env_steps_trained_throughput_per_sec": 5909.795034400464, "timesteps_total": 612000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 612000, "timers": {"training_iteration_time_ms": 3106.881, "sample_time_ms": 2835.112, "load_time_ms": 19.193, "load_throughput": 937836.99, "learn_time_ms": 240.675, "learn_throughput": 74789.5, "synch_weights_time_ms": 9.503}, "counters": {"num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000}, "done": false, "episodes_total": 2308, "training_iteration": 34, "trial_id": "9f288_00014", "date": "2023-10-25_16-43-42", "timestamp": 1698248622, "time_this_iter_s": 3.0517871379852295, "time_total_s": 107.89296555519104, "pid": 9504, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 107.89296555519104, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 61.85000000000001, "ram_util_percent": 27.225}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1641532182693484e-11, "cur_lr": 0.0003, "total_loss": 7.202444394429524, "policy_loss": -0.04280034910577039, "vf_loss": 7.245298703511556, "vf_explained_var": -1.2814998626708984e-06, "kl": 0.00027138896074182145, "entropy": 0.5403193359573683, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 414.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 630000, "num_env_steps_trained": 630000, "num_agent_steps_sampled": 630000, "num_agent_steps_trained": 630000}, "sampler_results": {"episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.53199999999982, "episode_len_mean": 275.3, "episode_media": {}, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [36.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 18.29999999999982, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 22.299999999999876, -50.00000000000044, 31.1, -50.00000000000044, -50.00000000000044, 42.10000000000001, 24.899999999999913, -50.00000000000044, 45.7, 44.900000000000006, 35.500000000000036, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 15.099999999999774, 41.90000000000001, 30.099999999999987, 29.099999999999973, 41.100000000000016, 40.10000000000002, 44.7, 20.699999999999854, 41.500000000000014, 37.10000000000003, 45.3, 38.10000000000002, 42.10000000000001, -50.00000000000044, 23.499999999999893, 46.5, 36.900000000000034, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 37.90000000000003, -50.00000000000044, 46.3, -50.00000000000044, 21.89999999999987, 24.899999999999913, -50.00000000000044, -50.00000000000044, 40.70000000000002, 41.90000000000001, -50.00000000000044, 44.10000000000001, 45.9, 45.7, 34.900000000000034, 35.10000000000004, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.50000000000004, -50.00000000000044, 28.09999999999996, 32.700000000000024, -50.00000000000044, -50.00000000000044, 40.70000000000002, 42.500000000000014, 11.099999999999717, 31.500000000000007, -50.00000000000044, 45.9, 39.90000000000002, 37.10000000000003, 41.90000000000001, 35.70000000000003, 42.70000000000001, -50.00000000000044, 31.900000000000013, -50.00000000000044, 42.10000000000001, 30.499999999999993, -50.00000000000044, -50.00000000000044, 45.7, 42.70000000000001, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 3.499999999999609], "episode_lengths": [136, 500, 500, 500, 68, 318, 500, 500, 500, 72, 278, 500, 190, 500, 500, 80, 252, 500, 44, 52, 146, 500, 500, 64, 500, 350, 82, 200, 210, 90, 100, 54, 294, 86, 130, 48, 120, 80, 500, 266, 36, 132, 48, 500, 500, 500, 66, 122, 500, 38, 500, 282, 252, 500, 500, 94, 82, 500, 60, 42, 44, 152, 150, 124, 500, 500, 500, 500, 156, 500, 220, 174, 500, 500, 94, 76, 390, 186, 500, 42, 102, 130, 82, 144, 74, 500, 182, 500, 80, 196, 500, 500, 44, 74, 500, 500, 84, 500, 500, 466]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.379677478279958, "mean_inference_ms": 1.2251958714658915, "mean_action_processing_ms": 0.14163441550189554, "mean_env_wait_ms": 0.08454460261683223, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020017385482788086, "StateBufferConnector_ms": 0.004998683929443359, "ViewRequirementAgentConnector_ms": 0.1200413703918457}}, "episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.53199999999982, "episode_len_mean": 275.3, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [36.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 18.29999999999982, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 22.299999999999876, -50.00000000000044, 31.1, -50.00000000000044, -50.00000000000044, 42.10000000000001, 24.899999999999913, -50.00000000000044, 45.7, 44.900000000000006, 35.500000000000036, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 15.099999999999774, 41.90000000000001, 30.099999999999987, 29.099999999999973, 41.100000000000016, 40.10000000000002, 44.7, 20.699999999999854, 41.500000000000014, 37.10000000000003, 45.3, 38.10000000000002, 42.10000000000001, -50.00000000000044, 23.499999999999893, 46.5, 36.900000000000034, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 37.90000000000003, -50.00000000000044, 46.3, -50.00000000000044, 21.89999999999987, 24.899999999999913, -50.00000000000044, -50.00000000000044, 40.70000000000002, 41.90000000000001, -50.00000000000044, 44.10000000000001, 45.9, 45.7, 34.900000000000034, 35.10000000000004, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.50000000000004, -50.00000000000044, 28.09999999999996, 32.700000000000024, -50.00000000000044, -50.00000000000044, 40.70000000000002, 42.500000000000014, 11.099999999999717, 31.500000000000007, -50.00000000000044, 45.9, 39.90000000000002, 37.10000000000003, 41.90000000000001, 35.70000000000003, 42.70000000000001, -50.00000000000044, 31.900000000000013, -50.00000000000044, 42.10000000000001, 30.499999999999993, -50.00000000000044, -50.00000000000044, 45.7, 42.70000000000001, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 3.499999999999609], "episode_lengths": [136, 500, 500, 500, 68, 318, 500, 500, 500, 72, 278, 500, 190, 500, 500, 80, 252, 500, 44, 52, 146, 500, 500, 64, 500, 350, 82, 200, 210, 90, 100, 54, 294, 86, 130, 48, 120, 80, 500, 266, 36, 132, 48, 500, 500, 500, 66, 122, 500, 38, 500, 282, 252, 500, 500, 94, 82, 500, 60, 42, 44, 152, 150, 124, 500, 500, 500, 500, 156, 500, 220, 174, 500, 500, 94, 76, 390, 186, 500, 42, 102, 130, 82, 144, 74, 500, 182, 500, 80, 196, 500, 500, 44, 74, 500, 500, 84, 500, 500, 466]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.379677478279958, "mean_inference_ms": 1.2251958714658915, "mean_action_processing_ms": 0.14163441550189554, "mean_env_wait_ms": 0.08454460261683223, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020017385482788086, "StateBufferConnector_ms": 0.004998683929443359, "ViewRequirementAgentConnector_ms": 0.1200413703918457}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 630000, "num_agent_steps_trained": 630000, "num_env_steps_sampled": 630000, "num_env_steps_trained": 630000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5181.388077892528, "num_env_steps_trained_throughput_per_sec": 5181.388077892528, "timesteps_total": 630000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 630000, "timers": {"training_iteration_time_ms": 3148.83, "sample_time_ms": 2871.879, "load_time_ms": 19.324, "load_throughput": 931501.754, "learn_time_ms": 245.66, "learn_throughput": 73271.89, "synch_weights_time_ms": 9.483}, "counters": {"num_env_steps_sampled": 630000, "num_env_steps_trained": 630000, "num_agent_steps_sampled": 630000, "num_agent_steps_trained": 630000}, "done": false, "episodes_total": 2382, "training_iteration": 35, "trial_id": "9f288_00014", "date": "2023-10-25_16-43-45", "timestamp": 1698248625, "time_this_iter_s": 3.4799723625183105, "time_total_s": 111.37293791770935, "pid": 9504, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 111.37293791770935, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 58.1, "ram_util_percent": 27.240000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.820766091346742e-12, "cur_lr": 0.0003, "total_loss": 6.563987851142883, "policy_loss": 0.040592070668935776, "vf_loss": 6.523452520370483, "vf_explained_var": -1.5348196029663086e-06, "kl": 0.00030601976204517695, "entropy": 0.5670000910758972, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 426.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000}, "sampler_results": {"episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.906999999999824, "episode_len_mean": 266.56, "episode_media": {}, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 34.50000000000004, -50.00000000000044, 28.09999999999996, 32.700000000000024, -50.00000000000044, -50.00000000000044, 40.70000000000002, 42.500000000000014, 11.099999999999717, 31.500000000000007, -50.00000000000044, 45.9, 39.90000000000002, 37.10000000000003, 41.90000000000001, 35.70000000000003, 42.70000000000001, -50.00000000000044, 31.900000000000013, -50.00000000000044, 42.10000000000001, 30.499999999999993, -50.00000000000044, -50.00000000000044, 45.7, 42.70000000000001, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 3.499999999999609, -50.00000000000044, 45.9, 42.900000000000006, 40.90000000000002, -50.00000000000044, 18.899999999999828, -50.00000000000044, -50.00000000000044, 39.50000000000002, 40.10000000000002, 44.7, -50.00000000000044, 34.70000000000004, 43.50000000000001, -50.00000000000044, 39.300000000000026, 43.50000000000001, -50.00000000000044, 44.300000000000004, 45.3, 30.9, 39.70000000000002, 45.1, 19.299999999999834, 43.900000000000006, 46.099999999999994, -50.00000000000044, -50.00000000000044, 43.7, 36.30000000000003, 41.500000000000014, -50.00000000000044, 43.50000000000001, 45.5, 43.10000000000001, 46.3, -50.00000000000044, 38.700000000000024, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.09999999999993, -50.00000000000044, -50.00000000000044, -50.00000000000044, 20.899999999999856, -50.00000000000044, -50.00000000000044, 36.30000000000003, 41.500000000000014, 43.10000000000001, 34.50000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.70000000000003, 40.70000000000002, 41.30000000000001, 44.7, 45.7, 11.499999999999723, 10.099999999999703, -50.00000000000044, 33.30000000000003, 43.50000000000001], "episode_lengths": [500, 156, 500, 220, 174, 500, 500, 94, 76, 390, 186, 500, 42, 102, 130, 82, 144, 74, 500, 182, 500, 80, 196, 500, 500, 44, 74, 500, 500, 84, 500, 500, 466, 500, 42, 72, 92, 500, 312, 500, 500, 106, 100, 54, 500, 154, 66, 500, 108, 66, 500, 58, 48, 192, 104, 50, 308, 62, 40, 500, 500, 64, 138, 86, 500, 66, 46, 70, 38, 500, 114, 88, 500, 500, 500, 240, 500, 500, 500, 292, 500, 500, 138, 86, 70, 156, 500, 500, 500, 500, 134, 94, 88, 54, 44, 386, 400, 500, 168, 66]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3801818736918278, "mean_inference_ms": 1.2226959447237602, "mean_action_processing_ms": 0.14123145040627322, "mean_env_wait_ms": 0.08467726861093511, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021000385284423828, "StateBufferConnector_ms": 0.005004405975341797, "ViewRequirementAgentConnector_ms": 0.12171196937561035}}, "episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.906999999999824, "episode_len_mean": 266.56, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 34.50000000000004, -50.00000000000044, 28.09999999999996, 32.700000000000024, -50.00000000000044, -50.00000000000044, 40.70000000000002, 42.500000000000014, 11.099999999999717, 31.500000000000007, -50.00000000000044, 45.9, 39.90000000000002, 37.10000000000003, 41.90000000000001, 35.70000000000003, 42.70000000000001, -50.00000000000044, 31.900000000000013, -50.00000000000044, 42.10000000000001, 30.499999999999993, -50.00000000000044, -50.00000000000044, 45.7, 42.70000000000001, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 3.499999999999609, -50.00000000000044, 45.9, 42.900000000000006, 40.90000000000002, -50.00000000000044, 18.899999999999828, -50.00000000000044, -50.00000000000044, 39.50000000000002, 40.10000000000002, 44.7, -50.00000000000044, 34.70000000000004, 43.50000000000001, -50.00000000000044, 39.300000000000026, 43.50000000000001, -50.00000000000044, 44.300000000000004, 45.3, 30.9, 39.70000000000002, 45.1, 19.299999999999834, 43.900000000000006, 46.099999999999994, -50.00000000000044, -50.00000000000044, 43.7, 36.30000000000003, 41.500000000000014, -50.00000000000044, 43.50000000000001, 45.5, 43.10000000000001, 46.3, -50.00000000000044, 38.700000000000024, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.09999999999993, -50.00000000000044, -50.00000000000044, -50.00000000000044, 20.899999999999856, -50.00000000000044, -50.00000000000044, 36.30000000000003, 41.500000000000014, 43.10000000000001, 34.50000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.70000000000003, 40.70000000000002, 41.30000000000001, 44.7, 45.7, 11.499999999999723, 10.099999999999703, -50.00000000000044, 33.30000000000003, 43.50000000000001], "episode_lengths": [500, 156, 500, 220, 174, 500, 500, 94, 76, 390, 186, 500, 42, 102, 130, 82, 144, 74, 500, 182, 500, 80, 196, 500, 500, 44, 74, 500, 500, 84, 500, 500, 466, 500, 42, 72, 92, 500, 312, 500, 500, 106, 100, 54, 500, 154, 66, 500, 108, 66, 500, 58, 48, 192, 104, 50, 308, 62, 40, 500, 500, 64, 138, 86, 500, 66, 46, 70, 38, 500, 114, 88, 500, 500, 500, 240, 500, 500, 500, 292, 500, 500, 138, 86, 70, 156, 500, 500, 500, 500, 134, 94, 88, 54, 44, 386, 400, 500, 168, 66]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3801818736918278, "mean_inference_ms": 1.2226959447237602, "mean_action_processing_ms": 0.14123145040627322, "mean_env_wait_ms": 0.08467726861093511, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021000385284423828, "StateBufferConnector_ms": 0.005004405975341797, "ViewRequirementAgentConnector_ms": 0.12171196937561035}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5392.163930700588, "num_env_steps_trained_throughput_per_sec": 5392.163930700588, "timesteps_total": 648000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 648000, "timers": {"training_iteration_time_ms": 3181.219, "sample_time_ms": 2903.807, "load_time_ms": 19.221, "load_throughput": 936453.859, "learn_time_ms": 246.41, "learn_throughput": 73048.959, "synch_weights_time_ms": 9.283}, "counters": {"num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000}, "done": false, "episodes_total": 2449, "training_iteration": 36, "trial_id": "9f288_00014", "date": "2023-10-25_16-43-49", "timestamp": 1698248629, "time_this_iter_s": 3.3430349826812744, "time_total_s": 114.71597290039062, "pid": 9504, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 114.71597290039062, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 54.14000000000001, "ram_util_percent": 27.240000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.910383045673371e-12, "cur_lr": 0.0003, "total_loss": 6.671836177508037, "policy_loss": 0.02298334623143698, "vf_loss": 6.648908058802287, "vf_explained_var": 8.443991343180338e-07, "kl": 0.0002133379067726556, "entropy": 0.5538611734906832, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 438.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 666000, "num_env_steps_trained": 666000, "num_agent_steps_sampled": 666000, "num_agent_steps_trained": 666000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.358999999999815, "episode_len_mean": 272.06, "episode_media": {}, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 38.700000000000024, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.09999999999993, -50.00000000000044, -50.00000000000044, -50.00000000000044, 20.899999999999856, -50.00000000000044, -50.00000000000044, 36.30000000000003, 41.500000000000014, 43.10000000000001, 34.50000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.70000000000003, 40.70000000000002, 41.30000000000001, 44.7, 45.7, 11.499999999999723, 10.099999999999703, -50.00000000000044, 33.30000000000003, 43.50000000000001, 13.899999999999757, -50.00000000000044, 40.90000000000002, 45.1, -50.00000000000044, 13.299999999999748, 43.900000000000006, -50.00000000000044, -50.00000000000044, 46.9, 12.299999999999734, -50.00000000000044, 42.70000000000001, 12.499999999999737, 44.900000000000006, 44.300000000000004, 45.3, -50.00000000000044, -50.00000000000044, 43.50000000000001, 42.900000000000006, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 28.499999999999964, 44.10000000000001, 45.9, 41.90000000000001, 0.8999999999995723, 43.900000000000006, -50.00000000000044, 24.499999999999908, 43.10000000000001, 43.10000000000001, -50.00000000000044, 43.7, 43.30000000000001, 41.100000000000016, 9.699999999999697, -50.00000000000044, 44.900000000000006, 23.699999999999896, 45.3, 46.699999999999996, -50.00000000000044, 43.50000000000001, 45.9, 41.90000000000001, -50.00000000000044, 26.89999999999994, 45.3, 33.90000000000004, 30.499999999999993, -50.00000000000044, 30.699999999999996, -50.00000000000044, 28.09999999999996, 9.099999999999689, -50.00000000000044, 44.5, -50.00000000000044, 36.10000000000004, 43.900000000000006, 37.70000000000003, -50.00000000000044, 14.09999999999976, 32.50000000000002, -50.00000000000044], "episode_lengths": [500, 114, 88, 500, 500, 500, 240, 500, 500, 500, 292, 500, 500, 138, 86, 70, 156, 500, 500, 500, 500, 134, 94, 88, 54, 44, 386, 400, 500, 168, 66, 362, 500, 92, 50, 500, 368, 62, 500, 500, 32, 378, 500, 74, 376, 52, 58, 48, 500, 500, 66, 72, 500, 54, 500, 500, 216, 60, 42, 82, 492, 62, 500, 256, 70, 70, 500, 64, 68, 90, 404, 500, 52, 264, 48, 34, 500, 66, 42, 82, 500, 232, 48, 162, 196, 500, 194, 500, 220, 410, 500, 56, 500, 140, 62, 124, 500, 360, 176, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3796436502972664, "mean_inference_ms": 1.222015208414571, "mean_action_processing_ms": 0.14137666439454716, "mean_env_wait_ms": 0.08483152629390724, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0189974308013916, "StateBufferConnector_ms": 0.006003141403198242, "ViewRequirementAgentConnector_ms": 0.1082618236541748}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.358999999999815, "episode_len_mean": 272.06, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 38.700000000000024, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.09999999999993, -50.00000000000044, -50.00000000000044, -50.00000000000044, 20.899999999999856, -50.00000000000044, -50.00000000000044, 36.30000000000003, 41.500000000000014, 43.10000000000001, 34.50000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.70000000000003, 40.70000000000002, 41.30000000000001, 44.7, 45.7, 11.499999999999723, 10.099999999999703, -50.00000000000044, 33.30000000000003, 43.50000000000001, 13.899999999999757, -50.00000000000044, 40.90000000000002, 45.1, -50.00000000000044, 13.299999999999748, 43.900000000000006, -50.00000000000044, -50.00000000000044, 46.9, 12.299999999999734, -50.00000000000044, 42.70000000000001, 12.499999999999737, 44.900000000000006, 44.300000000000004, 45.3, -50.00000000000044, -50.00000000000044, 43.50000000000001, 42.900000000000006, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 28.499999999999964, 44.10000000000001, 45.9, 41.90000000000001, 0.8999999999995723, 43.900000000000006, -50.00000000000044, 24.499999999999908, 43.10000000000001, 43.10000000000001, -50.00000000000044, 43.7, 43.30000000000001, 41.100000000000016, 9.699999999999697, -50.00000000000044, 44.900000000000006, 23.699999999999896, 45.3, 46.699999999999996, -50.00000000000044, 43.50000000000001, 45.9, 41.90000000000001, -50.00000000000044, 26.89999999999994, 45.3, 33.90000000000004, 30.499999999999993, -50.00000000000044, 30.699999999999996, -50.00000000000044, 28.09999999999996, 9.099999999999689, -50.00000000000044, 44.5, -50.00000000000044, 36.10000000000004, 43.900000000000006, 37.70000000000003, -50.00000000000044, 14.09999999999976, 32.50000000000002, -50.00000000000044], "episode_lengths": [500, 114, 88, 500, 500, 500, 240, 500, 500, 500, 292, 500, 500, 138, 86, 70, 156, 500, 500, 500, 500, 134, 94, 88, 54, 44, 386, 400, 500, 168, 66, 362, 500, 92, 50, 500, 368, 62, 500, 500, 32, 378, 500, 74, 376, 52, 58, 48, 500, 500, 66, 72, 500, 54, 500, 500, 216, 60, 42, 82, 492, 62, 500, 256, 70, 70, 500, 64, 68, 90, 404, 500, 52, 264, 48, 34, 500, 66, 42, 82, 500, 232, 48, 162, 196, 500, 194, 500, 220, 410, 500, 56, 500, 140, 62, 124, 500, 360, 176, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3796436502972664, "mean_inference_ms": 1.222015208414571, "mean_action_processing_ms": 0.14137666439454716, "mean_env_wait_ms": 0.08483152629390724, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0189974308013916, "StateBufferConnector_ms": 0.006003141403198242, "ViewRequirementAgentConnector_ms": 0.1082618236541748}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 666000, "num_agent_steps_trained": 666000, "num_env_steps_sampled": 666000, "num_env_steps_trained": 666000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5906.718910410929, "num_env_steps_trained_throughput_per_sec": 5906.718910410929, "timesteps_total": 666000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 666000, "timers": {"training_iteration_time_ms": 3172.311, "sample_time_ms": 2896.402, "load_time_ms": 18.256, "load_throughput": 985991.555, "learn_time_ms": 245.699, "learn_throughput": 73260.478, "synch_weights_time_ms": 9.457}, "counters": {"num_env_steps_sampled": 666000, "num_env_steps_trained": 666000, "num_agent_steps_sampled": 666000, "num_agent_steps_trained": 666000}, "done": false, "episodes_total": 2518, "training_iteration": 37, "trial_id": "9f288_00014", "date": "2023-10-25_16-43-52", "timestamp": 1698248632, "time_this_iter_s": 3.052764892578125, "time_total_s": 117.76873779296875, "pid": 9504, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 117.76873779296875, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 62.8, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.4551915228366855e-12, "cur_lr": 0.0003, "total_loss": 7.6405162413914995, "policy_loss": -0.0021914904355071485, "vf_loss": 7.64276647567749, "vf_explained_var": -1.2268622716267903e-06, "kl": 0.0001411156100038132, "entropy": 0.5893099854389826, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 450.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.622999999999854, "episode_len_mean": 249.48, "episode_media": {}, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 43.50000000000001, 45.9, 41.90000000000001, -50.00000000000044, 26.89999999999994, 45.3, 33.90000000000004, 30.499999999999993, -50.00000000000044, 30.699999999999996, -50.00000000000044, 28.09999999999996, 9.099999999999689, -50.00000000000044, 44.5, -50.00000000000044, 36.10000000000004, 43.900000000000006, 37.70000000000003, -50.00000000000044, 14.09999999999976, 32.50000000000002, -50.00000000000044, -50.00000000000044, 41.90000000000001, 45.7, 16.699999999999797, 46.3, 45.3, 46.099999999999994, 44.10000000000001, 42.70000000000001, 38.300000000000026, -50.00000000000044, -50.00000000000044, 16.29999999999979, 29.49999999999998, 47.1, 41.500000000000014, -50.00000000000044, 29.69999999999998, -50.00000000000044, 37.10000000000003, -50.00000000000044, 1.299999999999578, 33.70000000000004, 45.5, 42.500000000000014, 29.299999999999976, -50.00000000000044, -50.00000000000044, 40.70000000000002, 43.900000000000006, -50.00000000000044, 42.900000000000006, 39.70000000000002, -50.00000000000044, 45.3, 35.10000000000004, 41.30000000000001, 22.299999999999876, 20.899999999999856, -50.00000000000044, 46.9, -50.00000000000044, 34.50000000000004, 37.70000000000003, 34.70000000000004, 40.500000000000014, 42.10000000000001, 40.10000000000002, 44.5, -50.00000000000044, 39.10000000000002, 42.10000000000001, 33.500000000000036, -50.00000000000044, 23.499999999999893, -50.00000000000044, 26.09999999999993, -50.00000000000044, 7.09999999999966, -50.00000000000044, 14.299999999999763, -50.00000000000044, 40.10000000000002, 42.30000000000001, 40.10000000000002, -50.00000000000044, 34.10000000000004, 32.100000000000016, 42.900000000000006, 40.90000000000002, 32.90000000000003, 40.500000000000014, -50.00000000000044, 40.10000000000002, 22.299999999999876, -50.00000000000044], "episode_lengths": [500, 66, 42, 82, 500, 232, 48, 162, 196, 500, 194, 500, 220, 410, 500, 56, 500, 140, 62, 124, 500, 360, 176, 500, 500, 82, 44, 334, 38, 48, 40, 60, 74, 118, 500, 500, 338, 206, 30, 86, 500, 204, 500, 130, 500, 488, 164, 46, 76, 208, 500, 500, 94, 62, 500, 72, 104, 500, 48, 150, 88, 278, 292, 500, 32, 500, 156, 124, 154, 96, 80, 100, 56, 500, 110, 80, 166, 500, 266, 500, 240, 500, 430, 500, 358, 500, 100, 78, 100, 500, 160, 180, 72, 92, 172, 96, 500, 100, 278, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37975044049705303, "mean_inference_ms": 1.2207658855451793, "mean_action_processing_ms": 0.14097369887487432, "mean_env_wait_ms": 0.08449975147279887, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026005029678344727, "StateBufferConnector_ms": 0.005998134613037109, "ViewRequirementAgentConnector_ms": 0.1212468147277832}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.622999999999854, "episode_len_mean": 249.48, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 43.50000000000001, 45.9, 41.90000000000001, -50.00000000000044, 26.89999999999994, 45.3, 33.90000000000004, 30.499999999999993, -50.00000000000044, 30.699999999999996, -50.00000000000044, 28.09999999999996, 9.099999999999689, -50.00000000000044, 44.5, -50.00000000000044, 36.10000000000004, 43.900000000000006, 37.70000000000003, -50.00000000000044, 14.09999999999976, 32.50000000000002, -50.00000000000044, -50.00000000000044, 41.90000000000001, 45.7, 16.699999999999797, 46.3, 45.3, 46.099999999999994, 44.10000000000001, 42.70000000000001, 38.300000000000026, -50.00000000000044, -50.00000000000044, 16.29999999999979, 29.49999999999998, 47.1, 41.500000000000014, -50.00000000000044, 29.69999999999998, -50.00000000000044, 37.10000000000003, -50.00000000000044, 1.299999999999578, 33.70000000000004, 45.5, 42.500000000000014, 29.299999999999976, -50.00000000000044, -50.00000000000044, 40.70000000000002, 43.900000000000006, -50.00000000000044, 42.900000000000006, 39.70000000000002, -50.00000000000044, 45.3, 35.10000000000004, 41.30000000000001, 22.299999999999876, 20.899999999999856, -50.00000000000044, 46.9, -50.00000000000044, 34.50000000000004, 37.70000000000003, 34.70000000000004, 40.500000000000014, 42.10000000000001, 40.10000000000002, 44.5, -50.00000000000044, 39.10000000000002, 42.10000000000001, 33.500000000000036, -50.00000000000044, 23.499999999999893, -50.00000000000044, 26.09999999999993, -50.00000000000044, 7.09999999999966, -50.00000000000044, 14.299999999999763, -50.00000000000044, 40.10000000000002, 42.30000000000001, 40.10000000000002, -50.00000000000044, 34.10000000000004, 32.100000000000016, 42.900000000000006, 40.90000000000002, 32.90000000000003, 40.500000000000014, -50.00000000000044, 40.10000000000002, 22.299999999999876, -50.00000000000044], "episode_lengths": [500, 66, 42, 82, 500, 232, 48, 162, 196, 500, 194, 500, 220, 410, 500, 56, 500, 140, 62, 124, 500, 360, 176, 500, 500, 82, 44, 334, 38, 48, 40, 60, 74, 118, 500, 500, 338, 206, 30, 86, 500, 204, 500, 130, 500, 488, 164, 46, 76, 208, 500, 500, 94, 62, 500, 72, 104, 500, 48, 150, 88, 278, 292, 500, 32, 500, 156, 124, 154, 96, 80, 100, 56, 500, 110, 80, 166, 500, 266, 500, 240, 500, 430, 500, 358, 500, 100, 78, 100, 500, 160, 180, 72, 92, 172, 96, 500, 100, 278, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37975044049705303, "mean_inference_ms": 1.2207658855451793, "mean_action_processing_ms": 0.14097369887487432, "mean_env_wait_ms": 0.08449975147279887, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026005029678344727, "StateBufferConnector_ms": 0.005998134613037109, "ViewRequirementAgentConnector_ms": 0.1212468147277832}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000, "num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5745.827000978954, "num_env_steps_trained_throughput_per_sec": 5745.827000978954, "timesteps_total": 684000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 684000, "timers": {"training_iteration_time_ms": 3172.174, "sample_time_ms": 2898.109, "load_time_ms": 18.185, "load_throughput": 989839.995, "learn_time_ms": 243.926, "learn_throughput": 73792.929, "synch_weights_time_ms": 9.457}, "counters": {"num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000}, "done": false, "episodes_total": 2594, "training_iteration": 38, "trial_id": "9f288_00014", "date": "2023-10-25_16-43-55", "timestamp": 1698248635, "time_this_iter_s": 3.138474941253662, "time_total_s": 120.90721273422241, "pid": 9504, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 120.90721273422241, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 55.779999999999994, "ram_util_percent": 27.22}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.275957614183427e-13, "cur_lr": 0.0003, "total_loss": 6.896366993586223, "policy_loss": -0.014057161596914133, "vf_loss": 6.910478989283244, "vf_explained_var": 3.5762786865234375e-07, "kl": 0.00042762145326946666, "entropy": 0.5498539209365845, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 462.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 702000, "num_env_steps_trained": 702000, "num_agent_steps_sampled": 702000, "num_agent_steps_trained": 702000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.84999999999984, "episode_len_mean": 262.18, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.9, -50.00000000000044, 34.50000000000004, 37.70000000000003, 34.70000000000004, 40.500000000000014, 42.10000000000001, 40.10000000000002, 44.5, -50.00000000000044, 39.10000000000002, 42.10000000000001, 33.500000000000036, -50.00000000000044, 23.499999999999893, -50.00000000000044, 26.09999999999993, -50.00000000000044, 7.09999999999966, -50.00000000000044, 14.299999999999763, -50.00000000000044, 40.10000000000002, 42.30000000000001, 40.10000000000002, -50.00000000000044, 34.10000000000004, 32.100000000000016, 42.900000000000006, 40.90000000000002, 32.90000000000003, 40.500000000000014, -50.00000000000044, 40.10000000000002, 22.299999999999876, -50.00000000000044, -50.00000000000044, 45.7, 41.30000000000001, -50.00000000000044, 45.3, -50.00000000000044, 40.10000000000002, 42.500000000000014, 42.70000000000001, -50.00000000000044, -50.00000000000044, 38.10000000000002, 40.30000000000002, -50.00000000000044, -50.00000000000044, 23.499999999999893, 12.099999999999731, -50.00000000000044, 40.70000000000002, 8.099999999999675, -50.00000000000044, 33.30000000000003, 45.3, 43.30000000000001, 35.500000000000036, 41.30000000000001, 45.1, -50.00000000000044, 31.500000000000007, -50.00000000000044, 44.300000000000004, 42.900000000000006, 0.8999999999995723, -50.00000000000044, 0.8999999999995723, 42.70000000000001, -50.00000000000044, 42.70000000000001, -50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 37.90000000000003, -50.00000000000044, 26.09999999999993, -50.00000000000044, 35.900000000000034, 32.700000000000024, 41.90000000000001, 43.900000000000006, 23.29999999999989, 20.899999999999856, 36.10000000000004, 46.3, 42.30000000000001, -50.00000000000044, -50.00000000000044, 25.699999999999925, 30.29999999999999, 30.699999999999996, -50.00000000000044, 42.900000000000006], "episode_lengths": [32, 500, 156, 124, 154, 96, 80, 100, 56, 500, 110, 80, 166, 500, 266, 500, 240, 500, 430, 500, 358, 500, 100, 78, 100, 500, 160, 180, 72, 92, 172, 96, 500, 100, 278, 500, 500, 44, 88, 500, 48, 500, 100, 76, 74, 500, 500, 120, 98, 500, 500, 266, 380, 500, 94, 420, 500, 168, 48, 68, 146, 88, 50, 500, 186, 500, 58, 72, 492, 500, 492, 74, 500, 74, 500, 96, 500, 500, 76, 500, 122, 500, 240, 500, 142, 174, 82, 62, 268, 292, 140, 38, 78, 500, 500, 244, 198, 194, 500, 72]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37934198210438, "mean_inference_ms": 1.2220314568556585, "mean_action_processing_ms": 0.14120897928580387, "mean_env_wait_ms": 0.0845065542225651, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02701854705810547, "StateBufferConnector_ms": 0.0059969425201416016, "ViewRequirementAgentConnector_ms": 0.09701180458068848}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.84999999999984, "episode_len_mean": 262.18, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.9, -50.00000000000044, 34.50000000000004, 37.70000000000003, 34.70000000000004, 40.500000000000014, 42.10000000000001, 40.10000000000002, 44.5, -50.00000000000044, 39.10000000000002, 42.10000000000001, 33.500000000000036, -50.00000000000044, 23.499999999999893, -50.00000000000044, 26.09999999999993, -50.00000000000044, 7.09999999999966, -50.00000000000044, 14.299999999999763, -50.00000000000044, 40.10000000000002, 42.30000000000001, 40.10000000000002, -50.00000000000044, 34.10000000000004, 32.100000000000016, 42.900000000000006, 40.90000000000002, 32.90000000000003, 40.500000000000014, -50.00000000000044, 40.10000000000002, 22.299999999999876, -50.00000000000044, -50.00000000000044, 45.7, 41.30000000000001, -50.00000000000044, 45.3, -50.00000000000044, 40.10000000000002, 42.500000000000014, 42.70000000000001, -50.00000000000044, -50.00000000000044, 38.10000000000002, 40.30000000000002, -50.00000000000044, -50.00000000000044, 23.499999999999893, 12.099999999999731, -50.00000000000044, 40.70000000000002, 8.099999999999675, -50.00000000000044, 33.30000000000003, 45.3, 43.30000000000001, 35.500000000000036, 41.30000000000001, 45.1, -50.00000000000044, 31.500000000000007, -50.00000000000044, 44.300000000000004, 42.900000000000006, 0.8999999999995723, -50.00000000000044, 0.8999999999995723, 42.70000000000001, -50.00000000000044, 42.70000000000001, -50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 37.90000000000003, -50.00000000000044, 26.09999999999993, -50.00000000000044, 35.900000000000034, 32.700000000000024, 41.90000000000001, 43.900000000000006, 23.29999999999989, 20.899999999999856, 36.10000000000004, 46.3, 42.30000000000001, -50.00000000000044, -50.00000000000044, 25.699999999999925, 30.29999999999999, 30.699999999999996, -50.00000000000044, 42.900000000000006], "episode_lengths": [32, 500, 156, 124, 154, 96, 80, 100, 56, 500, 110, 80, 166, 500, 266, 500, 240, 500, 430, 500, 358, 500, 100, 78, 100, 500, 160, 180, 72, 92, 172, 96, 500, 100, 278, 500, 500, 44, 88, 500, 48, 500, 100, 76, 74, 500, 500, 120, 98, 500, 500, 266, 380, 500, 94, 420, 500, 168, 48, 68, 146, 88, 50, 500, 186, 500, 58, 72, 492, 500, 492, 74, 500, 74, 500, 96, 500, 500, 76, 500, 122, 500, 240, 500, 142, 174, 82, 62, 268, 292, 140, 38, 78, 500, 500, 244, 198, 194, 500, 72]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37934198210438, "mean_inference_ms": 1.2220314568556585, "mean_action_processing_ms": 0.14120897928580387, "mean_env_wait_ms": 0.0845065542225651, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02701854705810547, "StateBufferConnector_ms": 0.0059969425201416016, "ViewRequirementAgentConnector_ms": 0.09701180458068848}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 702000, "num_agent_steps_trained": 702000, "num_env_steps_sampled": 702000, "num_env_steps_trained": 702000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5930.783320099257, "num_env_steps_trained_throughput_per_sec": 5930.783320099257, "timesteps_total": 702000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 702000, "timers": {"training_iteration_time_ms": 3165.233, "sample_time_ms": 2890.356, "load_time_ms": 17.977, "load_throughput": 1001282.108, "learn_time_ms": 245.022, "learn_throughput": 73462.681, "synch_weights_time_ms": 9.38}, "counters": {"num_env_steps_sampled": 702000, "num_env_steps_trained": 702000, "num_agent_steps_sampled": 702000, "num_agent_steps_trained": 702000}, "done": false, "episodes_total": 2658, "training_iteration": 39, "trial_id": "9f288_00014", "date": "2023-10-25_16-43-58", "timestamp": 1698248638, "time_this_iter_s": 3.0400073528289795, "time_total_s": 123.94722008705139, "pid": 9504, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 123.94722008705139, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 65.30000000000001, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.6379788070917137e-13, "cur_lr": 0.0003, "total_loss": 6.415539781252543, "policy_loss": 0.03178029631574949, "vf_loss": 6.383809049924214, "vf_explained_var": -1.619259516398112e-06, "kl": 0.0003779729047816242, "entropy": 0.49553092072407406, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 474.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.089999999999809, "episode_len_mean": 279.7, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [31.500000000000007, -50.00000000000044, 44.300000000000004, 42.900000000000006, 0.8999999999995723, -50.00000000000044, 0.8999999999995723, 42.70000000000001, -50.00000000000044, 42.70000000000001, -50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 37.90000000000003, -50.00000000000044, 26.09999999999993, -50.00000000000044, 35.900000000000034, 32.700000000000024, 41.90000000000001, 43.900000000000006, 23.29999999999989, 20.899999999999856, 36.10000000000004, 46.3, 42.30000000000001, -50.00000000000044, -50.00000000000044, 25.699999999999925, 30.29999999999999, 30.699999999999996, -50.00000000000044, 42.900000000000006, 44.900000000000006, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 46.699999999999996, -50.00000000000044, 46.099999999999994, 28.699999999999967, -50.00000000000044, -50.00000000000044, 36.10000000000004, 33.70000000000004, 43.7, -50.00000000000044, 39.300000000000026, 45.5, 41.100000000000016, 10.699999999999712, 44.900000000000006, -50.00000000000044, 44.7, 30.9, -50.00000000000044, 46.9, -50.00000000000044, 40.70000000000002, -50.00000000000044, 44.5, 34.900000000000034, -50.00000000000044, 29.899999999999984, -50.00000000000044, 42.70000000000001, 36.10000000000004, 43.50000000000001, 46.099999999999994, 43.30000000000001, -50.00000000000044, 10.299999999999706, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 38.90000000000002, 40.500000000000014, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 43.900000000000006, 42.900000000000006, 25.699999999999925, 35.10000000000004, -50.00000000000044, 43.7], "episode_lengths": [186, 500, 58, 72, 492, 500, 492, 74, 500, 74, 500, 96, 500, 500, 76, 500, 122, 500, 240, 500, 142, 174, 82, 62, 268, 292, 140, 38, 78, 500, 500, 244, 198, 194, 500, 72, 52, 500, 500, 52, 500, 34, 500, 40, 214, 500, 500, 140, 164, 64, 500, 108, 46, 90, 394, 52, 500, 54, 192, 500, 32, 500, 94, 500, 56, 152, 500, 202, 500, 74, 140, 66, 40, 68, 500, 398, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 54, 112, 96, 70, 500, 500, 500, 62, 62, 72, 244, 150, 500, 64]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37943205800503804, "mean_inference_ms": 1.2197028234579048, "mean_action_processing_ms": 0.14038234246252013, "mean_env_wait_ms": 0.08463935199732042, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022016286849975586, "StateBufferConnector_ms": 0.0039958953857421875, "ViewRequirementAgentConnector_ms": 0.11199164390563965}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.089999999999809, "episode_len_mean": 279.7, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [31.500000000000007, -50.00000000000044, 44.300000000000004, 42.900000000000006, 0.8999999999995723, -50.00000000000044, 0.8999999999995723, 42.70000000000001, -50.00000000000044, 42.70000000000001, -50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 37.90000000000003, -50.00000000000044, 26.09999999999993, -50.00000000000044, 35.900000000000034, 32.700000000000024, 41.90000000000001, 43.900000000000006, 23.29999999999989, 20.899999999999856, 36.10000000000004, 46.3, 42.30000000000001, -50.00000000000044, -50.00000000000044, 25.699999999999925, 30.29999999999999, 30.699999999999996, -50.00000000000044, 42.900000000000006, 44.900000000000006, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 46.699999999999996, -50.00000000000044, 46.099999999999994, 28.699999999999967, -50.00000000000044, -50.00000000000044, 36.10000000000004, 33.70000000000004, 43.7, -50.00000000000044, 39.300000000000026, 45.5, 41.100000000000016, 10.699999999999712, 44.900000000000006, -50.00000000000044, 44.7, 30.9, -50.00000000000044, 46.9, -50.00000000000044, 40.70000000000002, -50.00000000000044, 44.5, 34.900000000000034, -50.00000000000044, 29.899999999999984, -50.00000000000044, 42.70000000000001, 36.10000000000004, 43.50000000000001, 46.099999999999994, 43.30000000000001, -50.00000000000044, 10.299999999999706, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 38.90000000000002, 40.500000000000014, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 43.900000000000006, 42.900000000000006, 25.699999999999925, 35.10000000000004, -50.00000000000044, 43.7], "episode_lengths": [186, 500, 58, 72, 492, 500, 492, 74, 500, 74, 500, 96, 500, 500, 76, 500, 122, 500, 240, 500, 142, 174, 82, 62, 268, 292, 140, 38, 78, 500, 500, 244, 198, 194, 500, 72, 52, 500, 500, 52, 500, 34, 500, 40, 214, 500, 500, 140, 164, 64, 500, 108, 46, 90, 394, 52, 500, 54, 192, 500, 32, 500, 94, 500, 56, 152, 500, 202, 500, 74, 140, 66, 40, 68, 500, 398, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 54, 112, 96, 70, 500, 500, 500, 62, 62, 72, 244, 150, 500, 64]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37943205800503804, "mean_inference_ms": 1.2197028234579048, "mean_action_processing_ms": 0.14038234246252013, "mean_env_wait_ms": 0.08463935199732042, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022016286849975586, "StateBufferConnector_ms": 0.0039958953857421875, "ViewRequirementAgentConnector_ms": 0.11199164390563965}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5491.967419539983, "num_env_steps_trained_throughput_per_sec": 5491.967419539983, "timesteps_total": 720000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 720000, "timers": {"training_iteration_time_ms": 3168.949, "sample_time_ms": 2896.29, "load_time_ms": 17.855, "load_throughput": 1008104.793, "learn_time_ms": 243.023, "learn_throughput": 74066.943, "synch_weights_time_ms": 9.383}, "counters": {"num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "done": false, "episodes_total": 2722, "training_iteration": 40, "trial_id": "9f288_00014", "date": "2023-10-25_16-44-01", "timestamp": 1698248641, "time_this_iter_s": 3.283372163772583, "time_total_s": 127.23059225082397, "pid": 9504, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 127.23059225082397, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 62.55, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.8189894035458568e-13, "cur_lr": 0.0003, "total_loss": 6.882617115974426, "policy_loss": 0.04262256001432737, "vf_loss": 6.840045928955078, "vf_explained_var": -1.6689300537109375e-06, "kl": 4.684214626612023e-05, "entropy": 0.5121696119507154, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 486.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 738000, "num_env_steps_trained": 738000, "num_agent_steps_sampled": 738000, "num_agent_steps_trained": 738000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.80299999999983, "episode_len_mean": 257.6, "episode_media": {}, "episodes_this_iter": 78, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 38.90000000000002, 40.500000000000014, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 43.900000000000006, 42.900000000000006, 25.699999999999925, 35.10000000000004, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 24.299999999999905, 28.09999999999996, 35.30000000000004, 13.899999999999757, -50.00000000000044, 42.70000000000001, 44.900000000000006, -50.00000000000044, -50.00000000000044, 26.69999999999994, 34.10000000000004, 43.50000000000001, -50.00000000000044, 46.3, 42.30000000000001, -50.00000000000044, 39.90000000000002, 45.5, -50.00000000000044, 45.5, 19.09999999999983, 44.300000000000004, 29.299999999999976, -50.00000000000044, 44.5, 43.30000000000001, 35.10000000000004, 11.29999999999972, -50.00000000000044, 36.30000000000003, 40.30000000000002, 15.49999999999978, 41.90000000000001, -50.00000000000044, 45.5, 40.90000000000002, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.10000000000002, 43.50000000000001, 43.900000000000006, 47.1, 45.5, 43.7, 40.10000000000002, -50.00000000000044, 41.70000000000002, 43.900000000000006, -50.00000000000044, 44.7, 45.3, -50.00000000000044, 38.90000000000002, -50.00000000000044, 29.49999999999998, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, 44.10000000000001, 20.099999999999845, 44.900000000000006, 44.7, 37.300000000000026, 44.10000000000001, 46.5, -50.00000000000044, 32.30000000000002, 43.7, 27.899999999999956, -50.00000000000044], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 54, 112, 96, 70, 500, 500, 500, 62, 62, 72, 244, 150, 500, 64, 500, 500, 500, 500, 62, 258, 220, 148, 362, 500, 74, 52, 500, 500, 234, 160, 66, 500, 38, 78, 500, 102, 46, 500, 46, 310, 58, 208, 500, 56, 68, 150, 388, 500, 138, 98, 346, 82, 500, 46, 92, 52, 500, 500, 500, 120, 66, 62, 30, 46, 64, 100, 500, 84, 62, 500, 54, 48, 500, 112, 500, 206, 500, 28, 500, 500, 60, 300, 52, 54, 128, 60, 36, 500, 178, 64, 222, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37965445379073154, "mean_inference_ms": 1.2201675342676923, "mean_action_processing_ms": 0.14079179428958072, "mean_env_wait_ms": 0.08470360945361105, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019177675247192383, "StateBufferConnector_ms": 0.0049991607666015625, "ViewRequirementAgentConnector_ms": 0.1284346580505371}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.80299999999983, "episode_len_mean": 257.6, "episodes_this_iter": 78, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 38.90000000000002, 40.500000000000014, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 43.900000000000006, 42.900000000000006, 25.699999999999925, 35.10000000000004, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 24.299999999999905, 28.09999999999996, 35.30000000000004, 13.899999999999757, -50.00000000000044, 42.70000000000001, 44.900000000000006, -50.00000000000044, -50.00000000000044, 26.69999999999994, 34.10000000000004, 43.50000000000001, -50.00000000000044, 46.3, 42.30000000000001, -50.00000000000044, 39.90000000000002, 45.5, -50.00000000000044, 45.5, 19.09999999999983, 44.300000000000004, 29.299999999999976, -50.00000000000044, 44.5, 43.30000000000001, 35.10000000000004, 11.29999999999972, -50.00000000000044, 36.30000000000003, 40.30000000000002, 15.49999999999978, 41.90000000000001, -50.00000000000044, 45.5, 40.90000000000002, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.10000000000002, 43.50000000000001, 43.900000000000006, 47.1, 45.5, 43.7, 40.10000000000002, -50.00000000000044, 41.70000000000002, 43.900000000000006, -50.00000000000044, 44.7, 45.3, -50.00000000000044, 38.90000000000002, -50.00000000000044, 29.49999999999998, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, 44.10000000000001, 20.099999999999845, 44.900000000000006, 44.7, 37.300000000000026, 44.10000000000001, 46.5, -50.00000000000044, 32.30000000000002, 43.7, 27.899999999999956, -50.00000000000044], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 54, 112, 96, 70, 500, 500, 500, 62, 62, 72, 244, 150, 500, 64, 500, 500, 500, 500, 62, 258, 220, 148, 362, 500, 74, 52, 500, 500, 234, 160, 66, 500, 38, 78, 500, 102, 46, 500, 46, 310, 58, 208, 500, 56, 68, 150, 388, 500, 138, 98, 346, 82, 500, 46, 92, 52, 500, 500, 500, 120, 66, 62, 30, 46, 64, 100, 500, 84, 62, 500, 54, 48, 500, 112, 500, 206, 500, 28, 500, 500, 60, 300, 52, 54, 128, 60, 36, 500, 178, 64, 222, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37965445379073154, "mean_inference_ms": 1.2201675342676923, "mean_action_processing_ms": 0.14079179428958072, "mean_env_wait_ms": 0.08470360945361105, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019177675247192383, "StateBufferConnector_ms": 0.0049991607666015625, "ViewRequirementAgentConnector_ms": 0.1284346580505371}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 738000, "num_agent_steps_trained": 738000, "num_env_steps_sampled": 738000, "num_env_steps_trained": 738000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5862.594964600001, "num_env_steps_trained_throughput_per_sec": 5862.594964600001, "timesteps_total": 738000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 738000, "timers": {"training_iteration_time_ms": 3157.805, "sample_time_ms": 2894.107, "load_time_ms": 17.241, "load_throughput": 1044012.794, "learn_time_ms": 234.641, "learn_throughput": 76712.904, "synch_weights_time_ms": 9.417}, "counters": {"num_env_steps_sampled": 738000, "num_env_steps_trained": 738000, "num_agent_steps_sampled": 738000, "num_agent_steps_trained": 738000}, "done": false, "episodes_total": 2800, "training_iteration": 41, "trial_id": "9f288_00014", "date": "2023-10-25_16-44-04", "timestamp": 1698248644, "time_this_iter_s": 3.0753045082092285, "time_total_s": 130.3058967590332, "pid": 9504, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 130.3058967590332, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 58.8, "ram_util_percent": 27.22}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.094947017729284e-14, "cur_lr": 0.0003, "total_loss": 6.519429127375285, "policy_loss": 0.03388911656414469, "vf_loss": 6.4855903784434, "vf_explained_var": -1.062949498494466e-06, "kl": 0.00021679885736839802, "entropy": 0.504644917945067, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 498.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.187999999999853, "episode_len_mean": 228.8, "episode_media": {}, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.70000000000002, 43.900000000000006, -50.00000000000044, 44.7, 45.3, -50.00000000000044, 38.90000000000002, -50.00000000000044, 29.49999999999998, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, 44.10000000000001, 20.099999999999845, 44.900000000000006, 44.7, 37.300000000000026, 44.10000000000001, 46.5, -50.00000000000044, 32.30000000000002, 43.7, 27.899999999999956, -50.00000000000044, -50.00000000000044, 44.300000000000004, 45.1, -50.00000000000044, 16.699999999999797, -50.00000000000044, 45.1, 43.900000000000006, 46.5, 45.5, 47.1, 37.50000000000003, 46.5, 34.50000000000004, 26.299999999999933, 41.30000000000001, 46.5, -50.00000000000044, 25.29999999999992, 44.900000000000006, 45.1, 45.1, -50.00000000000044, 38.300000000000026, 44.900000000000006, -50.00000000000044, 32.50000000000002, 43.7, 45.9, 33.70000000000004, 38.700000000000024, -50.00000000000044, 42.900000000000006, -50.00000000000044, 42.70000000000001, 44.10000000000001, 43.10000000000001, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.499999999999964, -50.00000000000044, -50.00000000000044, 43.10000000000001, 35.70000000000003, 39.300000000000026, -50.00000000000044, 42.70000000000001, 45.3, 40.70000000000002, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.299999999999933, -50.00000000000044, -50.00000000000044, 45.7, 40.10000000000002, 43.30000000000001, 42.900000000000006, 42.70000000000001, 44.7, -50.00000000000044, -50.00000000000044, 40.70000000000002, 44.300000000000004, -50.00000000000044, 29.899999999999984, 33.30000000000003, -50.00000000000044, 43.30000000000001, 20.699999999999854], "episode_lengths": [84, 62, 500, 54, 48, 500, 112, 500, 206, 500, 28, 500, 500, 60, 300, 52, 54, 128, 60, 36, 500, 178, 64, 222, 500, 500, 58, 50, 500, 334, 500, 50, 62, 36, 46, 30, 126, 36, 156, 238, 88, 36, 500, 248, 52, 50, 50, 500, 118, 52, 500, 176, 64, 42, 164, 114, 500, 72, 500, 74, 60, 70, 46, 500, 500, 500, 216, 500, 500, 70, 144, 108, 500, 74, 48, 94, 500, 46, 500, 500, 500, 238, 500, 500, 44, 100, 68, 72, 74, 54, 500, 500, 94, 58, 500, 202, 168, 500, 68, 294]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37927775147510673, "mean_inference_ms": 1.2187406520577913, "mean_action_processing_ms": 0.14027561586375079, "mean_env_wait_ms": 0.08478362757476052, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024909496307373047, "StateBufferConnector_ms": 0.0060024261474609375, "ViewRequirementAgentConnector_ms": 0.11231231689453125}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.187999999999853, "episode_len_mean": 228.8, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [41.70000000000002, 43.900000000000006, -50.00000000000044, 44.7, 45.3, -50.00000000000044, 38.90000000000002, -50.00000000000044, 29.49999999999998, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, 44.10000000000001, 20.099999999999845, 44.900000000000006, 44.7, 37.300000000000026, 44.10000000000001, 46.5, -50.00000000000044, 32.30000000000002, 43.7, 27.899999999999956, -50.00000000000044, -50.00000000000044, 44.300000000000004, 45.1, -50.00000000000044, 16.699999999999797, -50.00000000000044, 45.1, 43.900000000000006, 46.5, 45.5, 47.1, 37.50000000000003, 46.5, 34.50000000000004, 26.299999999999933, 41.30000000000001, 46.5, -50.00000000000044, 25.29999999999992, 44.900000000000006, 45.1, 45.1, -50.00000000000044, 38.300000000000026, 44.900000000000006, -50.00000000000044, 32.50000000000002, 43.7, 45.9, 33.70000000000004, 38.700000000000024, -50.00000000000044, 42.900000000000006, -50.00000000000044, 42.70000000000001, 44.10000000000001, 43.10000000000001, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.499999999999964, -50.00000000000044, -50.00000000000044, 43.10000000000001, 35.70000000000003, 39.300000000000026, -50.00000000000044, 42.70000000000001, 45.3, 40.70000000000002, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.299999999999933, -50.00000000000044, -50.00000000000044, 45.7, 40.10000000000002, 43.30000000000001, 42.900000000000006, 42.70000000000001, 44.7, -50.00000000000044, -50.00000000000044, 40.70000000000002, 44.300000000000004, -50.00000000000044, 29.899999999999984, 33.30000000000003, -50.00000000000044, 43.30000000000001, 20.699999999999854], "episode_lengths": [84, 62, 500, 54, 48, 500, 112, 500, 206, 500, 28, 500, 500, 60, 300, 52, 54, 128, 60, 36, 500, 178, 64, 222, 500, 500, 58, 50, 500, 334, 500, 50, 62, 36, 46, 30, 126, 36, 156, 238, 88, 36, 500, 248, 52, 50, 50, 500, 118, 52, 500, 176, 64, 42, 164, 114, 500, 72, 500, 74, 60, 70, 46, 500, 500, 500, 216, 500, 500, 70, 144, 108, 500, 74, 48, 94, 500, 46, 500, 500, 500, 238, 500, 500, 44, 100, 68, 72, 74, 54, 500, 500, 94, 58, 500, 202, 168, 500, 68, 294]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37927775147510673, "mean_inference_ms": 1.2187406520577913, "mean_action_processing_ms": 0.14027561586375079, "mean_env_wait_ms": 0.08478362757476052, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024909496307373047, "StateBufferConnector_ms": 0.0060024261474609375, "ViewRequirementAgentConnector_ms": 0.11231231689453125}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000, "num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5800.719482334143, "num_env_steps_trained_throughput_per_sec": 5800.719482334143, "timesteps_total": 756000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 756000, "timers": {"training_iteration_time_ms": 3160.119, "sample_time_ms": 2887.942, "load_time_ms": 18.132, "load_throughput": 992732.064, "learn_time_ms": 242.304, "learn_throughput": 74286.798, "synch_weights_time_ms": 9.337}, "counters": {"num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000}, "done": false, "episodes_total": 2875, "training_iteration": 42, "trial_id": "9f288_00014", "date": "2023-10-25_16-44-07", "timestamp": 1698248647, "time_this_iter_s": 3.109299659729004, "time_total_s": 133.4151964187622, "pid": 9504, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 133.4151964187622, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 62.425, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.547473508864642e-14, "cur_lr": 0.0003, "total_loss": 6.644653757413228, "policy_loss": 0.021753483762343723, "vf_loss": 6.6229539314905805, "vf_explained_var": -1.5099843343098958e-06, "kl": 5.6137270246855074e-05, "entropy": 0.5376404176155726, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 510.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 774000, "num_env_steps_trained": 774000, "num_agent_steps_sampled": 774000, "num_agent_steps_trained": 774000}, "sampler_results": {"episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.947999999999812, "episode_len_mean": 271.12, "episode_media": {}, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 43.10000000000001, 35.70000000000003, 39.300000000000026, -50.00000000000044, 42.70000000000001, 45.3, 40.70000000000002, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.299999999999933, -50.00000000000044, -50.00000000000044, 45.7, 40.10000000000002, 43.30000000000001, 42.900000000000006, 42.70000000000001, 44.7, -50.00000000000044, -50.00000000000044, 40.70000000000002, 44.300000000000004, -50.00000000000044, 29.899999999999984, 33.30000000000003, -50.00000000000044, 43.30000000000001, 20.699999999999854, -50.00000000000044, 7.899999999999672, 40.30000000000002, 45.5, -50.00000000000044, -50.00000000000044, 17.099999999999802, 45.7, 37.10000000000003, 42.30000000000001, 45.1, 45.3, 46.099999999999994, -50.00000000000044, 45.9, -50.00000000000044, 42.70000000000001, 24.899999999999913, 38.90000000000002, 46.099999999999994, -50.00000000000044, -50.00000000000044, 10.099999999999703, 45.3, 29.69999999999998, -50.00000000000044, 45.7, -50.00000000000044, 24.099999999999902, -50.00000000000044, -50.00000000000044, 46.3, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 43.30000000000001, 2.8999999999996007, 42.30000000000001, -50.00000000000044, -50.00000000000044, 20.299999999999848, 44.300000000000004, 45.1, 43.900000000000006, 36.30000000000003, -50.00000000000044, 39.50000000000002, -50.00000000000044, 45.3, 43.30000000000001, 35.30000000000004, 42.500000000000014, -50.00000000000044, 32.90000000000003, 45.1], "episode_lengths": [500, 500, 70, 144, 108, 500, 74, 48, 94, 500, 46, 500, 500, 500, 238, 500, 500, 44, 100, 68, 72, 74, 54, 500, 500, 94, 58, 500, 202, 168, 500, 68, 294, 500, 422, 98, 46, 500, 500, 330, 44, 130, 78, 50, 48, 40, 500, 42, 500, 74, 252, 112, 40, 500, 500, 400, 48, 204, 500, 44, 500, 260, 500, 500, 38, 94, 500, 500, 500, 92, 500, 500, 500, 78, 500, 500, 500, 500, 500, 38, 68, 472, 78, 500, 500, 298, 58, 50, 62, 138, 500, 106, 500, 48, 68, 148, 76, 500, 172, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37959679408226793, "mean_inference_ms": 1.2202546800652818, "mean_action_processing_ms": 0.140676346875661, "mean_env_wait_ms": 0.0846816962232244, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028720855712890625, "StateBufferConnector_ms": 0.0030007362365722656, "ViewRequirementAgentConnector_ms": 0.12343692779541016}}, "episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.947999999999812, "episode_len_mean": 271.12, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 43.10000000000001, 35.70000000000003, 39.300000000000026, -50.00000000000044, 42.70000000000001, 45.3, 40.70000000000002, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.299999999999933, -50.00000000000044, -50.00000000000044, 45.7, 40.10000000000002, 43.30000000000001, 42.900000000000006, 42.70000000000001, 44.7, -50.00000000000044, -50.00000000000044, 40.70000000000002, 44.300000000000004, -50.00000000000044, 29.899999999999984, 33.30000000000003, -50.00000000000044, 43.30000000000001, 20.699999999999854, -50.00000000000044, 7.899999999999672, 40.30000000000002, 45.5, -50.00000000000044, -50.00000000000044, 17.099999999999802, 45.7, 37.10000000000003, 42.30000000000001, 45.1, 45.3, 46.099999999999994, -50.00000000000044, 45.9, -50.00000000000044, 42.70000000000001, 24.899999999999913, 38.90000000000002, 46.099999999999994, -50.00000000000044, -50.00000000000044, 10.099999999999703, 45.3, 29.69999999999998, -50.00000000000044, 45.7, -50.00000000000044, 24.099999999999902, -50.00000000000044, -50.00000000000044, 46.3, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 43.30000000000001, 2.8999999999996007, 42.30000000000001, -50.00000000000044, -50.00000000000044, 20.299999999999848, 44.300000000000004, 45.1, 43.900000000000006, 36.30000000000003, -50.00000000000044, 39.50000000000002, -50.00000000000044, 45.3, 43.30000000000001, 35.30000000000004, 42.500000000000014, -50.00000000000044, 32.90000000000003, 45.1], "episode_lengths": [500, 500, 70, 144, 108, 500, 74, 48, 94, 500, 46, 500, 500, 500, 238, 500, 500, 44, 100, 68, 72, 74, 54, 500, 500, 94, 58, 500, 202, 168, 500, 68, 294, 500, 422, 98, 46, 500, 500, 330, 44, 130, 78, 50, 48, 40, 500, 42, 500, 74, 252, 112, 40, 500, 500, 400, 48, 204, 500, 44, 500, 260, 500, 500, 38, 94, 500, 500, 500, 92, 500, 500, 500, 78, 500, 500, 500, 500, 500, 38, 68, 472, 78, 500, 500, 298, 58, 50, 62, 138, 500, 106, 500, 48, 68, 148, 76, 500, 172, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37959679408226793, "mean_inference_ms": 1.2202546800652818, "mean_action_processing_ms": 0.140676346875661, "mean_env_wait_ms": 0.0846816962232244, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028720855712890625, "StateBufferConnector_ms": 0.0030007362365722656, "ViewRequirementAgentConnector_ms": 0.12343692779541016}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 774000, "num_agent_steps_trained": 774000, "num_env_steps_sampled": 774000, "num_env_steps_trained": 774000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5735.002561087229, "num_env_steps_trained_throughput_per_sec": 5735.002561087229, "timesteps_total": 774000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 774000, "timers": {"training_iteration_time_ms": 3166.254, "sample_time_ms": 2897.816, "load_time_ms": 17.093, "load_throughput": 1053035.312, "learn_time_ms": 239.658, "learn_throughput": 75106.983, "synch_weights_time_ms": 9.282}, "counters": {"num_env_steps_sampled": 774000, "num_env_steps_trained": 774000, "num_agent_steps_sampled": 774000, "num_agent_steps_trained": 774000}, "done": false, "episodes_total": 2942, "training_iteration": 43, "trial_id": "9f288_00014", "date": "2023-10-25_16-44-11", "timestamp": 1698248651, "time_this_iter_s": 3.144200563430786, "time_total_s": 136.559396982193, "pid": 9504, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 136.559396982193, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 58.04, "ram_util_percent": 27.22}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.273736754432321e-14, "cur_lr": 0.0003, "total_loss": 6.836033940315247, "policy_loss": -0.026083288714289665, "vf_loss": 6.862173597017924, "vf_explained_var": -8.344650268554688e-07, "kl": 0.00022119447006237655, "entropy": 0.5628194411595663, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 522.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.8409999999998056, "episode_len_mean": 277.16, "episode_media": {}, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 43.30000000000001, 2.8999999999996007, 42.30000000000001, -50.00000000000044, -50.00000000000044, 20.299999999999848, 44.300000000000004, 45.1, 43.900000000000006, 36.30000000000003, -50.00000000000044, 39.50000000000002, -50.00000000000044, 45.3, 43.30000000000001, 35.30000000000004, 42.500000000000014, -50.00000000000044, 32.90000000000003, 45.1, -50.00000000000044, -50.00000000000044, 19.499999999999837, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, 35.10000000000004, 43.10000000000001, 44.300000000000004, 43.7, -50.00000000000044, 41.90000000000001, 40.10000000000002, 35.10000000000004, 44.900000000000006, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 33.500000000000036, -50.00000000000044, 44.5, -50.00000000000044, 40.10000000000002, 31.1, 44.10000000000001, 30.099999999999987, 45.1, 43.50000000000001, -50.00000000000044, 44.900000000000006, 45.9, -50.00000000000044, 45.3, 37.300000000000026, -50.00000000000044, 23.699999999999896, 17.299999999999805, 35.900000000000034, 45.5, 44.10000000000001, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.300000000000026, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, 44.900000000000006, -50.00000000000044, 42.500000000000014, 45.9, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 36.50000000000003, -50.00000000000044, 30.699999999999996], "episode_lengths": [500, 500, 92, 500, 500, 500, 78, 500, 500, 500, 500, 500, 38, 68, 472, 78, 500, 500, 298, 58, 50, 62, 138, 500, 106, 500, 48, 68, 148, 76, 500, 172, 50, 500, 500, 306, 500, 70, 500, 500, 28, 500, 500, 150, 70, 58, 64, 500, 82, 100, 150, 52, 500, 84, 500, 500, 166, 500, 56, 500, 100, 190, 60, 200, 50, 66, 500, 52, 42, 500, 48, 128, 500, 264, 328, 142, 46, 60, 50, 500, 500, 500, 108, 102, 500, 500, 500, 110, 52, 500, 76, 42, 500, 500, 34, 500, 500, 136, 500, 194]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37891336043047347, "mean_inference_ms": 1.2192872960591725, "mean_action_processing_ms": 0.1405210164115457, "mean_env_wait_ms": 0.08475660165417011, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024995088577270508, "StateBufferConnector_ms": 0.004001617431640625, "ViewRequirementAgentConnector_ms": 0.12463855743408203}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.8409999999998056, "episode_len_mean": 277.16, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 43.30000000000001, 2.8999999999996007, 42.30000000000001, -50.00000000000044, -50.00000000000044, 20.299999999999848, 44.300000000000004, 45.1, 43.900000000000006, 36.30000000000003, -50.00000000000044, 39.50000000000002, -50.00000000000044, 45.3, 43.30000000000001, 35.30000000000004, 42.500000000000014, -50.00000000000044, 32.90000000000003, 45.1, -50.00000000000044, -50.00000000000044, 19.499999999999837, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, 35.10000000000004, 43.10000000000001, 44.300000000000004, 43.7, -50.00000000000044, 41.90000000000001, 40.10000000000002, 35.10000000000004, 44.900000000000006, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 33.500000000000036, -50.00000000000044, 44.5, -50.00000000000044, 40.10000000000002, 31.1, 44.10000000000001, 30.099999999999987, 45.1, 43.50000000000001, -50.00000000000044, 44.900000000000006, 45.9, -50.00000000000044, 45.3, 37.300000000000026, -50.00000000000044, 23.699999999999896, 17.299999999999805, 35.900000000000034, 45.5, 44.10000000000001, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.300000000000026, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, 44.900000000000006, -50.00000000000044, 42.500000000000014, 45.9, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 36.50000000000003, -50.00000000000044, 30.699999999999996], "episode_lengths": [500, 500, 92, 500, 500, 500, 78, 500, 500, 500, 500, 500, 38, 68, 472, 78, 500, 500, 298, 58, 50, 62, 138, 500, 106, 500, 48, 68, 148, 76, 500, 172, 50, 500, 500, 306, 500, 70, 500, 500, 28, 500, 500, 150, 70, 58, 64, 500, 82, 100, 150, 52, 500, 84, 500, 500, 166, 500, 56, 500, 100, 190, 60, 200, 50, 66, 500, 52, 42, 500, 48, 128, 500, 264, 328, 142, 46, 60, 50, 500, 500, 500, 108, 102, 500, 500, 500, 110, 52, 500, 76, 42, 500, 500, 34, 500, 500, 136, 500, 194]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37891336043047347, "mean_inference_ms": 1.2192872960591725, "mean_action_processing_ms": 0.1405210164115457, "mean_env_wait_ms": 0.08475660165417011, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024995088577270508, "StateBufferConnector_ms": 0.004001617431640625, "ViewRequirementAgentConnector_ms": 0.12463855743408203}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000, "num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5650.132105260322, "num_env_steps_trained_throughput_per_sec": 5650.132105260322, "timesteps_total": 792000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 792000, "timers": {"training_iteration_time_ms": 3180.251, "sample_time_ms": 2898.277, "load_time_ms": 18.205, "load_throughput": 988719.99, "learn_time_ms": 252.147, "learn_throughput": 71386.988, "synch_weights_time_ms": 9.209}, "counters": {"num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000}, "done": false, "episodes_total": 3009, "training_iteration": 44, "trial_id": "9f288_00014", "date": "2023-10-25_16-44-14", "timestamp": 1698248654, "time_this_iter_s": 3.190669536590576, "time_total_s": 139.75006651878357, "pid": 9504, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 139.75006651878357, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 62.925, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1368683772161605e-14, "cur_lr": 0.0003, "total_loss": 6.330930630366008, "policy_loss": -0.010054687057466557, "vf_loss": 6.341036915779114, "vf_explained_var": -1.087784767150879e-06, "kl": 0.0001849672602626621, "entropy": 0.5160784150163332, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 534.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 810000, "num_env_steps_trained": 810000, "num_agent_steps_sampled": 810000, "num_agent_steps_trained": 810000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.749999999999809, "episode_len_mean": 273.08, "episode_media": {}, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [31.1, 44.10000000000001, 30.099999999999987, 45.1, 43.50000000000001, -50.00000000000044, 44.900000000000006, 45.9, -50.00000000000044, 45.3, 37.300000000000026, -50.00000000000044, 23.699999999999896, 17.299999999999805, 35.900000000000034, 45.5, 44.10000000000001, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.300000000000026, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, 44.900000000000006, -50.00000000000044, 42.500000000000014, 45.9, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 36.50000000000003, -50.00000000000044, 30.699999999999996, 42.500000000000014, 41.500000000000014, -50.00000000000044, -50.00000000000044, 43.30000000000001, 45.9, 42.30000000000001, 47.9, -50.00000000000044, -50.00000000000044, 45.5, 40.500000000000014, -50.00000000000044, 38.10000000000002, -50.00000000000044, 44.900000000000006, 37.10000000000003, 46.3, -50.00000000000044, 46.3, -50.00000000000044, 19.299999999999834, 22.699999999999882, -50.00000000000044, 43.7, 40.90000000000002, 42.10000000000001, 44.300000000000004, 45.7, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 38.10000000000002, 17.69999999999981, -50.00000000000044, -50.00000000000044, 40.90000000000002, 28.29999999999996, -50.00000000000044, 36.30000000000003, -50.00000000000044, 34.70000000000004, 13.299999999999748, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 33.10000000000003, 44.7, 47.3], "episode_lengths": [190, 60, 200, 50, 66, 500, 52, 42, 500, 48, 128, 500, 264, 328, 142, 46, 60, 50, 500, 500, 500, 108, 102, 500, 500, 500, 110, 52, 500, 76, 42, 500, 500, 34, 500, 500, 136, 500, 194, 76, 86, 500, 500, 68, 42, 78, 22, 500, 500, 46, 96, 500, 120, 500, 52, 130, 38, 500, 38, 500, 308, 274, 500, 64, 92, 80, 58, 44, 66, 500, 500, 500, 500, 44, 500, 500, 500, 500, 64, 120, 324, 500, 500, 92, 218, 500, 138, 500, 154, 368, 500, 500, 500, 500, 500, 76, 500, 170, 54, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37825313258544285, "mean_inference_ms": 1.2192282872112548, "mean_action_processing_ms": 0.1402578123558235, "mean_env_wait_ms": 0.08422924591562579, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02499079704284668, "StateBufferConnector_ms": 0.009004831314086914, "ViewRequirementAgentConnector_ms": 0.11955666542053223}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.749999999999809, "episode_len_mean": 273.08, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [31.1, 44.10000000000001, 30.099999999999987, 45.1, 43.50000000000001, -50.00000000000044, 44.900000000000006, 45.9, -50.00000000000044, 45.3, 37.300000000000026, -50.00000000000044, 23.699999999999896, 17.299999999999805, 35.900000000000034, 45.5, 44.10000000000001, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.300000000000026, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, 44.900000000000006, -50.00000000000044, 42.500000000000014, 45.9, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 36.50000000000003, -50.00000000000044, 30.699999999999996, 42.500000000000014, 41.500000000000014, -50.00000000000044, -50.00000000000044, 43.30000000000001, 45.9, 42.30000000000001, 47.9, -50.00000000000044, -50.00000000000044, 45.5, 40.500000000000014, -50.00000000000044, 38.10000000000002, -50.00000000000044, 44.900000000000006, 37.10000000000003, 46.3, -50.00000000000044, 46.3, -50.00000000000044, 19.299999999999834, 22.699999999999882, -50.00000000000044, 43.7, 40.90000000000002, 42.10000000000001, 44.300000000000004, 45.7, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 38.10000000000002, 17.69999999999981, -50.00000000000044, -50.00000000000044, 40.90000000000002, 28.29999999999996, -50.00000000000044, 36.30000000000003, -50.00000000000044, 34.70000000000004, 13.299999999999748, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 33.10000000000003, 44.7, 47.3], "episode_lengths": [190, 60, 200, 50, 66, 500, 52, 42, 500, 48, 128, 500, 264, 328, 142, 46, 60, 50, 500, 500, 500, 108, 102, 500, 500, 500, 110, 52, 500, 76, 42, 500, 500, 34, 500, 500, 136, 500, 194, 76, 86, 500, 500, 68, 42, 78, 22, 500, 500, 46, 96, 500, 120, 500, 52, 130, 38, 500, 38, 500, 308, 274, 500, 64, 92, 80, 58, 44, 66, 500, 500, 500, 500, 44, 500, 500, 500, 500, 64, 120, 324, 500, 500, 92, 218, 500, 138, 500, 154, 368, 500, 500, 500, 500, 500, 76, 500, 170, 54, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37825313258544285, "mean_inference_ms": 1.2192282872112548, "mean_action_processing_ms": 0.1402578123558235, "mean_env_wait_ms": 0.08422924591562579, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02499079704284668, "StateBufferConnector_ms": 0.009004831314086914, "ViewRequirementAgentConnector_ms": 0.11955666542053223}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 810000, "num_agent_steps_trained": 810000, "num_env_steps_sampled": 810000, "num_env_steps_trained": 810000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5952.374051826021, "num_env_steps_trained_throughput_per_sec": 5952.374051826021, "timesteps_total": 810000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 810000, "timers": {"training_iteration_time_ms": 3135.255, "sample_time_ms": 2863.09, "load_time_ms": 17.194, "load_throughput": 1046871.925, "learn_time_ms": 243.512, "learn_throughput": 73918.26, "synch_weights_time_ms": 9.132}, "counters": {"num_env_steps_sampled": 810000, "num_env_steps_trained": 810000, "num_agent_steps_sampled": 810000, "num_agent_steps_trained": 810000}, "done": false, "episodes_total": 3070, "training_iteration": 45, "trial_id": "9f288_00014", "date": "2023-10-25_16-44-17", "timestamp": 1698248657, "time_this_iter_s": 3.0299997329711914, "time_total_s": 142.78006625175476, "pid": 9504, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 142.78006625175476, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 59.2, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.6843418860808026e-15, "cur_lr": 0.0003, "total_loss": 6.875865538914998, "policy_loss": -0.06859972327947617, "vf_loss": 6.944520990053813, "vf_explained_var": -8.940696716308594e-07, "kl": 0.00013102714434864993, "entropy": 0.5592061231533686, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 546.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 828000, "num_env_steps_trained": 828000, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.3409999999998305, "episode_len_mean": 262.26, "episode_media": {}, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 43.7, 38.10000000000002, 17.69999999999981, -50.00000000000044, -50.00000000000044, 40.90000000000002, 28.29999999999996, -50.00000000000044, 36.30000000000003, -50.00000000000044, 34.70000000000004, 13.299999999999748, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 33.10000000000003, 44.7, 47.3, -50.00000000000044, 46.5, 37.90000000000003, -50.00000000000044, 45.9, 39.70000000000002, 31.70000000000001, 28.09999999999996, 23.099999999999888, -50.00000000000044, 46.099999999999994, 40.30000000000002, 37.10000000000003, 45.7, 19.09999999999983, 41.70000000000002, 42.500000000000014, 43.30000000000001, -50.00000000000044, -50.00000000000044, 42.10000000000001, 0.8999999999995723, -50.00000000000044, 44.900000000000006, 40.90000000000002, 35.70000000000003, 45.3, 44.5, 32.50000000000002, 44.300000000000004, 17.499999999999808, 45.3, 3.2999999999996064, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, 20.699999999999854, -50.00000000000044, -50.00000000000044, 38.90000000000002, 29.49999999999998, 38.50000000000003, 36.50000000000003, 35.10000000000004, 35.500000000000036, 0.6999999999995694, 43.30000000000001, 47.1, 45.7, -50.00000000000044, -50.00000000000044, 35.10000000000004, 45.9, 43.10000000000001, 31.70000000000001, 42.500000000000014, 37.10000000000003, 45.1, 43.7, -50.00000000000044, 39.300000000000026, 42.70000000000001, 42.500000000000014, 20.299999999999848, -50.00000000000044, 6.8999999999996575, 41.100000000000016, -50.00000000000044, 25.899999999999928, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001], "episode_lengths": [500, 500, 64, 120, 324, 500, 500, 92, 218, 500, 138, 500, 154, 368, 500, 500, 500, 500, 500, 76, 500, 170, 54, 28, 500, 36, 122, 500, 42, 104, 184, 220, 270, 500, 40, 98, 130, 44, 310, 84, 76, 68, 500, 500, 80, 492, 500, 52, 92, 144, 48, 56, 176, 58, 326, 48, 468, 500, 500, 500, 100, 500, 294, 500, 500, 112, 206, 116, 136, 150, 146, 494, 68, 30, 44, 500, 500, 150, 42, 70, 184, 76, 130, 50, 64, 500, 108, 74, 76, 298, 500, 432, 90, 500, 242, 500, 500, 500, 500, 70]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3784261955655747, "mean_inference_ms": 1.2179535638037955, "mean_action_processing_ms": 0.1403918558793878, "mean_env_wait_ms": 0.08430920939241475, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022983074188232422, "StateBufferConnector_ms": 0.005001068115234375, "ViewRequirementAgentConnector_ms": 0.11203837394714355}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.3409999999998305, "episode_len_mean": 262.26, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 43.7, 38.10000000000002, 17.69999999999981, -50.00000000000044, -50.00000000000044, 40.90000000000002, 28.29999999999996, -50.00000000000044, 36.30000000000003, -50.00000000000044, 34.70000000000004, 13.299999999999748, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 33.10000000000003, 44.7, 47.3, -50.00000000000044, 46.5, 37.90000000000003, -50.00000000000044, 45.9, 39.70000000000002, 31.70000000000001, 28.09999999999996, 23.099999999999888, -50.00000000000044, 46.099999999999994, 40.30000000000002, 37.10000000000003, 45.7, 19.09999999999983, 41.70000000000002, 42.500000000000014, 43.30000000000001, -50.00000000000044, -50.00000000000044, 42.10000000000001, 0.8999999999995723, -50.00000000000044, 44.900000000000006, 40.90000000000002, 35.70000000000003, 45.3, 44.5, 32.50000000000002, 44.300000000000004, 17.499999999999808, 45.3, 3.2999999999996064, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, 20.699999999999854, -50.00000000000044, -50.00000000000044, 38.90000000000002, 29.49999999999998, 38.50000000000003, 36.50000000000003, 35.10000000000004, 35.500000000000036, 0.6999999999995694, 43.30000000000001, 47.1, 45.7, -50.00000000000044, -50.00000000000044, 35.10000000000004, 45.9, 43.10000000000001, 31.70000000000001, 42.500000000000014, 37.10000000000003, 45.1, 43.7, -50.00000000000044, 39.300000000000026, 42.70000000000001, 42.500000000000014, 20.299999999999848, -50.00000000000044, 6.8999999999996575, 41.100000000000016, -50.00000000000044, 25.899999999999928, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001], "episode_lengths": [500, 500, 64, 120, 324, 500, 500, 92, 218, 500, 138, 500, 154, 368, 500, 500, 500, 500, 500, 76, 500, 170, 54, 28, 500, 36, 122, 500, 42, 104, 184, 220, 270, 500, 40, 98, 130, 44, 310, 84, 76, 68, 500, 500, 80, 492, 500, 52, 92, 144, 48, 56, 176, 58, 326, 48, 468, 500, 500, 500, 100, 500, 294, 500, 500, 112, 206, 116, 136, 150, 146, 494, 68, 30, 44, 500, 500, 150, 42, 70, 184, 76, 130, 50, 64, 500, 108, 74, 76, 298, 500, 432, 90, 500, 242, 500, 500, 500, 500, 70]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3784261955655747, "mean_inference_ms": 1.2179535638037955, "mean_action_processing_ms": 0.1403918558793878, "mean_env_wait_ms": 0.08430920939241475, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022983074188232422, "StateBufferConnector_ms": 0.005001068115234375, "ViewRequirementAgentConnector_ms": 0.11203837394714355}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000, "num_env_steps_sampled": 828000, "num_env_steps_trained": 828000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5758.976256204456, "num_env_steps_trained_throughput_per_sec": 5758.976256204456, "timesteps_total": 828000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 828000, "timers": {"training_iteration_time_ms": 3113.992, "sample_time_ms": 2833.938, "load_time_ms": 18.088, "load_throughput": 995110.903, "learn_time_ms": 250.343, "learn_throughput": 71901.416, "synch_weights_time_ms": 9.232}, "counters": {"num_env_steps_sampled": 828000, "num_env_steps_trained": 828000, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000}, "done": false, "episodes_total": 3146, "training_iteration": 46, "trial_id": "9f288_00014", "date": "2023-10-25_16-44-20", "timestamp": 1698248660, "time_this_iter_s": 3.130556344985962, "time_total_s": 145.91062259674072, "pid": 9504, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 145.91062259674072, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 57.28000000000001, "ram_util_percent": 27.22}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.8421709430404013e-15, "cur_lr": 0.0003, "total_loss": 7.29703962802887, "policy_loss": -0.04082515804717938, "vf_loss": 7.337923804918925, "vf_explained_var": -6.159146626790365e-07, "kl": 8.863047413380325e-05, "entropy": 0.5896802246570587, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 558.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 846000, "num_env_steps_trained": 846000, "num_agent_steps_sampled": 846000, "num_agent_steps_trained": 846000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.122999999999859, "episode_len_mean": 234.5, "episode_media": {}, "episodes_this_iter": 80, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [31.70000000000001, 42.500000000000014, 37.10000000000003, 45.1, 43.7, -50.00000000000044, 39.300000000000026, 42.70000000000001, 42.500000000000014, 20.299999999999848, -50.00000000000044, 6.8999999999996575, 41.100000000000016, -50.00000000000044, 25.899999999999928, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 27.899999999999956, 29.49999999999998, 46.3, -50.00000000000044, -50.00000000000044, 0.2999999999995637, 43.50000000000001, 35.70000000000003, 43.50000000000001, 46.699999999999996, -50.00000000000044, 45.1, 38.300000000000026, 46.099999999999994, -50.00000000000044, 41.90000000000001, 44.10000000000001, 39.10000000000002, 25.499999999999922, 33.90000000000004, 42.10000000000001, 42.900000000000006, 4.299999999999621, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 16.09999999999979, 33.500000000000036, 31.1, 43.30000000000001, 35.500000000000036, -50.00000000000044, 39.10000000000002, -50.00000000000044, 39.90000000000002, 44.7, 17.099999999999802, 44.10000000000001, 43.900000000000006, -50.00000000000044, 28.89999999999997, 10.499999999999709, 46.3, -50.00000000000044, 40.70000000000002, 43.7, 47.1, 45.1, 26.299999999999933, 46.9, 12.099999999999731, 27.699999999999953, 42.30000000000001, 40.500000000000014, 44.5, 35.900000000000034, -50.00000000000044, 47.3, 42.500000000000014, 43.900000000000006, -50.00000000000044, 43.900000000000006, 44.5, -50.00000000000044, 33.30000000000003, 25.099999999999916, 26.09999999999993, 44.5, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.30000000000003, 47.5, 40.70000000000002, -50.00000000000044, 39.50000000000002], "episode_lengths": [184, 76, 130, 50, 64, 500, 108, 74, 76, 298, 500, 432, 90, 500, 242, 500, 500, 500, 500, 70, 222, 206, 38, 500, 500, 498, 66, 144, 66, 34, 500, 50, 118, 40, 500, 82, 60, 110, 246, 162, 80, 72, 458, 500, 76, 500, 500, 340, 166, 190, 68, 146, 500, 110, 500, 102, 54, 330, 60, 62, 500, 212, 396, 38, 500, 94, 64, 30, 50, 238, 32, 380, 224, 78, 96, 56, 142, 500, 28, 76, 62, 500, 62, 56, 500, 168, 250, 240, 56, 78, 500, 500, 500, 500, 500, 168, 26, 94, 500, 106]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37842871686919016, "mean_inference_ms": 1.2178088811305452, "mean_action_processing_ms": 0.13998547599033603, "mean_env_wait_ms": 0.08443718412515387, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025008678436279297, "StateBufferConnector_ms": 0.007994890213012695, "ViewRequirementAgentConnector_ms": 0.12198376655578613}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.122999999999859, "episode_len_mean": 234.5, "episodes_this_iter": 80, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [31.70000000000001, 42.500000000000014, 37.10000000000003, 45.1, 43.7, -50.00000000000044, 39.300000000000026, 42.70000000000001, 42.500000000000014, 20.299999999999848, -50.00000000000044, 6.8999999999996575, 41.100000000000016, -50.00000000000044, 25.899999999999928, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 27.899999999999956, 29.49999999999998, 46.3, -50.00000000000044, -50.00000000000044, 0.2999999999995637, 43.50000000000001, 35.70000000000003, 43.50000000000001, 46.699999999999996, -50.00000000000044, 45.1, 38.300000000000026, 46.099999999999994, -50.00000000000044, 41.90000000000001, 44.10000000000001, 39.10000000000002, 25.499999999999922, 33.90000000000004, 42.10000000000001, 42.900000000000006, 4.299999999999621, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 16.09999999999979, 33.500000000000036, 31.1, 43.30000000000001, 35.500000000000036, -50.00000000000044, 39.10000000000002, -50.00000000000044, 39.90000000000002, 44.7, 17.099999999999802, 44.10000000000001, 43.900000000000006, -50.00000000000044, 28.89999999999997, 10.499999999999709, 46.3, -50.00000000000044, 40.70000000000002, 43.7, 47.1, 45.1, 26.299999999999933, 46.9, 12.099999999999731, 27.699999999999953, 42.30000000000001, 40.500000000000014, 44.5, 35.900000000000034, -50.00000000000044, 47.3, 42.500000000000014, 43.900000000000006, -50.00000000000044, 43.900000000000006, 44.5, -50.00000000000044, 33.30000000000003, 25.099999999999916, 26.09999999999993, 44.5, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.30000000000003, 47.5, 40.70000000000002, -50.00000000000044, 39.50000000000002], "episode_lengths": [184, 76, 130, 50, 64, 500, 108, 74, 76, 298, 500, 432, 90, 500, 242, 500, 500, 500, 500, 70, 222, 206, 38, 500, 500, 498, 66, 144, 66, 34, 500, 50, 118, 40, 500, 82, 60, 110, 246, 162, 80, 72, 458, 500, 76, 500, 500, 340, 166, 190, 68, 146, 500, 110, 500, 102, 54, 330, 60, 62, 500, 212, 396, 38, 500, 94, 64, 30, 50, 238, 32, 380, 224, 78, 96, 56, 142, 500, 28, 76, 62, 500, 62, 56, 500, 168, 250, 240, 56, 78, 500, 500, 500, 500, 500, 168, 26, 94, 500, 106]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37842871686919016, "mean_inference_ms": 1.2178088811305452, "mean_action_processing_ms": 0.13998547599033603, "mean_env_wait_ms": 0.08443718412515387, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025008678436279297, "StateBufferConnector_ms": 0.007994890213012695, "ViewRequirementAgentConnector_ms": 0.12198376655578613}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 846000, "num_agent_steps_trained": 846000, "num_env_steps_sampled": 846000, "num_env_steps_trained": 846000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5783.491462859434, "num_env_steps_trained_throughput_per_sec": 5783.491462859434, "timesteps_total": 846000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 846000, "timers": {"training_iteration_time_ms": 3120.485, "sample_time_ms": 2840.484, "load_time_ms": 18.076, "load_throughput": 995799.984, "learn_time_ms": 250.396, "learn_throughput": 71886.115, "synch_weights_time_ms": 9.238}, "counters": {"num_env_steps_sampled": 846000, "num_env_steps_trained": 846000, "num_agent_steps_sampled": 846000, "num_agent_steps_trained": 846000}, "done": false, "episodes_total": 3226, "training_iteration": 47, "trial_id": "9f288_00014", "date": "2023-10-25_16-44-23", "timestamp": 1698248663, "time_this_iter_s": 3.1173059940338135, "time_total_s": 149.02792859077454, "pid": 9504, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 149.02792859077454, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 65.2, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.4210854715202006e-15, "cur_lr": 0.0003, "total_loss": 7.141539176305135, "policy_loss": 0.014016438586016497, "vf_loss": 7.1275778611501055, "vf_explained_var": -1.5497207641601562e-06, "kl": 0.00010648797645274044, "entropy": 0.551068477332592, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 570.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 864000, "num_env_steps_trained": 864000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.320999999999842, "episode_len_mean": 252.46, "episode_media": {}, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [27.699999999999953, 42.30000000000001, 40.500000000000014, 44.5, 35.900000000000034, -50.00000000000044, 47.3, 42.500000000000014, 43.900000000000006, -50.00000000000044, 43.900000000000006, 44.5, -50.00000000000044, 33.30000000000003, 25.099999999999916, 26.09999999999993, 44.5, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.30000000000003, 47.5, 40.70000000000002, -50.00000000000044, 39.50000000000002, 22.299999999999876, 35.70000000000003, -50.00000000000044, 45.9, -50.00000000000044, 21.699999999999868, 40.10000000000002, 43.50000000000001, 35.30000000000004, 37.70000000000003, 39.10000000000002, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 38.10000000000002, -50.00000000000044, -50.00000000000044, 45.1, 27.299999999999947, 38.50000000000003, 45.3, 41.30000000000001, 21.499999999999865, -50.00000000000044, -50.00000000000044, 35.900000000000034, 40.70000000000002, -50.00000000000044, 11.29999999999972, 39.10000000000002, 8.699999999999683, -50.00000000000044, 46.9, 43.50000000000001, 44.900000000000006, 44.10000000000001, 11.099999999999717, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 29.899999999999984, 33.90000000000004, 43.900000000000006, 42.500000000000014, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 22.099999999999874, 41.100000000000016, -50.00000000000044, 46.5, 23.8999999999999, 39.10000000000002, 42.900000000000006, 38.700000000000024, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 45.1, 34.10000000000004, 44.5, -50.00000000000044, 41.100000000000016, 39.300000000000026, -50.00000000000044, 34.900000000000034, 10.899999999999714], "episode_lengths": [224, 78, 96, 56, 142, 500, 28, 76, 62, 500, 62, 56, 500, 168, 250, 240, 56, 78, 500, 500, 500, 500, 500, 168, 26, 94, 500, 106, 278, 144, 500, 42, 500, 284, 100, 66, 148, 124, 110, 500, 500, 62, 500, 120, 500, 500, 50, 228, 116, 48, 88, 286, 500, 500, 142, 94, 500, 388, 110, 414, 500, 32, 66, 52, 60, 390, 500, 500, 500, 56, 500, 202, 162, 62, 76, 500, 50, 500, 500, 280, 90, 500, 36, 262, 110, 72, 114, 500, 500, 58, 500, 50, 160, 56, 500, 90, 108, 500, 152, 392]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37856124611634284, "mean_inference_ms": 1.2178384503733732, "mean_action_processing_ms": 0.1400792415409351, "mean_env_wait_ms": 0.08427047039221361, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022008895874023438, "StateBufferConnector_ms": 0.00599217414855957, "ViewRequirementAgentConnector_ms": 0.12401604652404785}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.320999999999842, "episode_len_mean": 252.46, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [27.699999999999953, 42.30000000000001, 40.500000000000014, 44.5, 35.900000000000034, -50.00000000000044, 47.3, 42.500000000000014, 43.900000000000006, -50.00000000000044, 43.900000000000006, 44.5, -50.00000000000044, 33.30000000000003, 25.099999999999916, 26.09999999999993, 44.5, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.30000000000003, 47.5, 40.70000000000002, -50.00000000000044, 39.50000000000002, 22.299999999999876, 35.70000000000003, -50.00000000000044, 45.9, -50.00000000000044, 21.699999999999868, 40.10000000000002, 43.50000000000001, 35.30000000000004, 37.70000000000003, 39.10000000000002, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 38.10000000000002, -50.00000000000044, -50.00000000000044, 45.1, 27.299999999999947, 38.50000000000003, 45.3, 41.30000000000001, 21.499999999999865, -50.00000000000044, -50.00000000000044, 35.900000000000034, 40.70000000000002, -50.00000000000044, 11.29999999999972, 39.10000000000002, 8.699999999999683, -50.00000000000044, 46.9, 43.50000000000001, 44.900000000000006, 44.10000000000001, 11.099999999999717, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 29.899999999999984, 33.90000000000004, 43.900000000000006, 42.500000000000014, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 22.099999999999874, 41.100000000000016, -50.00000000000044, 46.5, 23.8999999999999, 39.10000000000002, 42.900000000000006, 38.700000000000024, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 45.1, 34.10000000000004, 44.5, -50.00000000000044, 41.100000000000016, 39.300000000000026, -50.00000000000044, 34.900000000000034, 10.899999999999714], "episode_lengths": [224, 78, 96, 56, 142, 500, 28, 76, 62, 500, 62, 56, 500, 168, 250, 240, 56, 78, 500, 500, 500, 500, 500, 168, 26, 94, 500, 106, 278, 144, 500, 42, 500, 284, 100, 66, 148, 124, 110, 500, 500, 62, 500, 120, 500, 500, 50, 228, 116, 48, 88, 286, 500, 500, 142, 94, 500, 388, 110, 414, 500, 32, 66, 52, 60, 390, 500, 500, 500, 56, 500, 202, 162, 62, 76, 500, 50, 500, 500, 280, 90, 500, 36, 262, 110, 72, 114, 500, 500, 58, 500, 50, 160, 56, 500, 90, 108, 500, 152, 392]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37856124611634284, "mean_inference_ms": 1.2178384503733732, "mean_action_processing_ms": 0.1400792415409351, "mean_env_wait_ms": 0.08427047039221361, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022008895874023438, "StateBufferConnector_ms": 0.00599217414855957, "ViewRequirementAgentConnector_ms": 0.12401604652404785}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000, "num_env_steps_sampled": 864000, "num_env_steps_trained": 864000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5583.499857856344, "num_env_steps_trained_throughput_per_sec": 5583.499857856344, "timesteps_total": 864000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 864000, "timers": {"training_iteration_time_ms": 3129.593, "sample_time_ms": 2848.689, "load_time_ms": 17.97, "load_throughput": 1001667.361, "learn_time_ms": 251.483, "learn_throughput": 71575.323, "synch_weights_time_ms": 9.138}, "counters": {"num_env_steps_sampled": 864000, "num_env_steps_trained": 864000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "done": false, "episodes_total": 3298, "training_iteration": 48, "trial_id": "9f288_00014", "date": "2023-10-25_16-44-26", "timestamp": 1698248666, "time_this_iter_s": 3.2287802696228027, "time_total_s": 152.25670886039734, "pid": 9504, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 152.25670886039734, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 58.94, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.105427357601003e-16, "cur_lr": 0.0003, "total_loss": 6.474403699239095, "policy_loss": 0.05004062503576279, "vf_loss": 6.4244199593861895, "vf_explained_var": -6.804863611857096e-07, "kl": 0.00019812014789977184, "entropy": 0.5698380420605341, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 582.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 882000, "num_env_steps_trained": 882000, "num_agent_steps_sampled": 882000, "num_agent_steps_trained": 882000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.4490000000002141, "episode_len_mean": 300.06, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 35.900000000000034, 40.70000000000002, -50.00000000000044, 11.29999999999972, 39.10000000000002, 8.699999999999683, -50.00000000000044, 46.9, 43.50000000000001, 44.900000000000006, 44.10000000000001, 11.099999999999717, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 29.899999999999984, 33.90000000000004, 43.900000000000006, 42.500000000000014, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 22.099999999999874, 41.100000000000016, -50.00000000000044, 46.5, 23.8999999999999, 39.10000000000002, 42.900000000000006, 38.700000000000024, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 45.1, 34.10000000000004, 44.5, -50.00000000000044, 41.100000000000016, 39.300000000000026, -50.00000000000044, 34.900000000000034, 10.899999999999714, -50.00000000000044, 31.900000000000013, 42.900000000000006, 22.899999999999885, 33.30000000000003, -50.00000000000044, -50.00000000000044, 35.900000000000034, 44.900000000000006, 43.7, 44.7, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 43.7, -50.00000000000044, 41.500000000000014, 39.300000000000026, -50.00000000000044, 8.49999999999968, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 21.89999999999987, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 42.900000000000006, 17.499999999999808, -50.00000000000044, 46.099999999999994, 8.099999999999675, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 6.699999999999655, 16.499999999999794, 38.300000000000026, 43.10000000000001, 41.70000000000002, -50.00000000000044], "episode_lengths": [500, 142, 94, 500, 388, 110, 414, 500, 32, 66, 52, 60, 390, 500, 500, 500, 56, 500, 202, 162, 62, 76, 500, 50, 500, 500, 280, 90, 500, 36, 262, 110, 72, 114, 500, 500, 58, 500, 50, 160, 56, 500, 90, 108, 500, 152, 392, 500, 182, 72, 272, 168, 500, 500, 142, 52, 64, 54, 500, 500, 34, 500, 64, 500, 86, 108, 500, 416, 500, 500, 500, 500, 282, 500, 500, 500, 500, 54, 500, 500, 72, 326, 500, 40, 420, 96, 500, 500, 500, 500, 500, 500, 74, 500, 434, 336, 118, 70, 84, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37854552548516224, "mean_inference_ms": 1.2178902725839027, "mean_action_processing_ms": 0.1401289635936985, "mean_env_wait_ms": 0.0841816038808204, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02000284194946289, "StateBufferConnector_ms": 0.007001638412475586, "ViewRequirementAgentConnector_ms": 0.1278519630432129}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.4490000000002141, "episode_len_mean": 300.06, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 35.900000000000034, 40.70000000000002, -50.00000000000044, 11.29999999999972, 39.10000000000002, 8.699999999999683, -50.00000000000044, 46.9, 43.50000000000001, 44.900000000000006, 44.10000000000001, 11.099999999999717, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 29.899999999999984, 33.90000000000004, 43.900000000000006, 42.500000000000014, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 22.099999999999874, 41.100000000000016, -50.00000000000044, 46.5, 23.8999999999999, 39.10000000000002, 42.900000000000006, 38.700000000000024, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 45.1, 34.10000000000004, 44.5, -50.00000000000044, 41.100000000000016, 39.300000000000026, -50.00000000000044, 34.900000000000034, 10.899999999999714, -50.00000000000044, 31.900000000000013, 42.900000000000006, 22.899999999999885, 33.30000000000003, -50.00000000000044, -50.00000000000044, 35.900000000000034, 44.900000000000006, 43.7, 44.7, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 43.7, -50.00000000000044, 41.500000000000014, 39.300000000000026, -50.00000000000044, 8.49999999999968, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 21.89999999999987, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 42.900000000000006, 17.499999999999808, -50.00000000000044, 46.099999999999994, 8.099999999999675, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 6.699999999999655, 16.499999999999794, 38.300000000000026, 43.10000000000001, 41.70000000000002, -50.00000000000044], "episode_lengths": [500, 142, 94, 500, 388, 110, 414, 500, 32, 66, 52, 60, 390, 500, 500, 500, 56, 500, 202, 162, 62, 76, 500, 50, 500, 500, 280, 90, 500, 36, 262, 110, 72, 114, 500, 500, 58, 500, 50, 160, 56, 500, 90, 108, 500, 152, 392, 500, 182, 72, 272, 168, 500, 500, 142, 52, 64, 54, 500, 500, 34, 500, 64, 500, 86, 108, 500, 416, 500, 500, 500, 500, 282, 500, 500, 500, 500, 54, 500, 500, 72, 326, 500, 40, 420, 96, 500, 500, 500, 500, 500, 500, 74, 500, 434, 336, 118, 70, 84, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37854552548516224, "mean_inference_ms": 1.2178902725839027, "mean_action_processing_ms": 0.1401289635936985, "mean_env_wait_ms": 0.0841816038808204, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02000284194946289, "StateBufferConnector_ms": 0.007001638412475586, "ViewRequirementAgentConnector_ms": 0.1278519630432129}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 882000, "num_agent_steps_trained": 882000, "num_env_steps_sampled": 882000, "num_env_steps_trained": 882000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5811.956063528116, "num_env_steps_trained_throughput_per_sec": 5811.956063528116, "timesteps_total": 882000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 882000, "timers": {"training_iteration_time_ms": 3135.798, "sample_time_ms": 2855.485, "load_time_ms": 18.161, "load_throughput": 991121.252, "learn_time_ms": 250.562, "learn_throughput": 71838.439, "synch_weights_time_ms": 9.277}, "counters": {"num_env_steps_sampled": 882000, "num_env_steps_trained": 882000, "num_agent_steps_sampled": 882000, "num_agent_steps_trained": 882000}, "done": false, "episodes_total": 3351, "training_iteration": 49, "trial_id": "9f288_00014", "date": "2023-10-25_16-44-30", "timestamp": 1698248670, "time_this_iter_s": 3.102062463760376, "time_total_s": 155.35877132415771, "pid": 9504, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 155.35877132415771, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 63.775000000000006, "ram_util_percent": 27.150000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.5527136788005016e-16, "cur_lr": 0.0003, "total_loss": 6.709208091100057, "policy_loss": -0.026722993701696396, "vf_loss": 6.735988060633342, "vf_explained_var": -1.0530153910319011e-06, "kl": 8.325263042744761e-05, "entropy": 0.5677569260199865, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 594.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 900000, "num_env_steps_trained": 900000, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.4839999999998041, "episode_len_mean": 285.76, "episode_media": {}, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 21.89999999999987, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 42.900000000000006, 17.499999999999808, -50.00000000000044, 46.099999999999994, 8.099999999999675, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 6.699999999999655, 16.499999999999794, 38.300000000000026, 43.10000000000001, 41.70000000000002, -50.00000000000044, -50.00000000000044, 29.69999999999998, -50.00000000000044, 43.7, 38.10000000000002, 41.70000000000002, 40.30000000000002, 30.9, 30.9, 41.90000000000001, -50.00000000000044, 31.300000000000004, -50.00000000000044, 41.90000000000001, 29.899999999999984, 46.9, -50.00000000000044, 41.90000000000001, 41.500000000000014, -50.00000000000044, 35.10000000000004, 26.499999999999936, -50.00000000000044, 42.900000000000006, 42.10000000000001, -50.00000000000044, 43.50000000000001, 37.70000000000003, 32.90000000000003, -50.00000000000044, 11.29999999999972, 39.70000000000002, 20.099999999999845, 34.30000000000004, 14.09999999999976, -50.00000000000044, 44.5, -50.00000000000044, 39.90000000000002, -50.00000000000044, 44.300000000000004, 43.7, -50.00000000000044, 44.5, 45.1, 3.2999999999996064, 43.900000000000006, -50.00000000000044, 35.70000000000003, 43.50000000000001, 43.900000000000006, -50.00000000000044, 37.300000000000026, -50.00000000000044, 45.5, 41.90000000000001, -50.00000000000044, 36.50000000000003, 38.10000000000002, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, 45.1, 22.299999999999876, 44.5, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 500, 282, 500, 500, 500, 500, 54, 500, 500, 72, 326, 500, 40, 420, 96, 500, 500, 500, 500, 500, 500, 74, 500, 434, 336, 118, 70, 84, 500, 500, 204, 500, 64, 120, 84, 98, 192, 192, 82, 500, 188, 500, 82, 202, 32, 500, 82, 86, 500, 150, 236, 500, 72, 80, 500, 66, 124, 172, 500, 388, 104, 300, 158, 360, 500, 56, 500, 102, 500, 58, 64, 500, 56, 50, 468, 62, 500, 144, 66, 62, 500, 128, 500, 46, 82, 500, 136, 120, 64, 500, 500, 500, 104, 50, 278, 56, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3783413544717834, "mean_inference_ms": 1.2172636507805052, "mean_action_processing_ms": 0.14023852435647238, "mean_env_wait_ms": 0.08425716717540982, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025842905044555664, "StateBufferConnector_ms": 0.0040051937103271484, "ViewRequirementAgentConnector_ms": 0.11383795738220215}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.4839999999998041, "episode_len_mean": 285.76, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 21.89999999999987, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 42.900000000000006, 17.499999999999808, -50.00000000000044, 46.099999999999994, 8.099999999999675, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 6.699999999999655, 16.499999999999794, 38.300000000000026, 43.10000000000001, 41.70000000000002, -50.00000000000044, -50.00000000000044, 29.69999999999998, -50.00000000000044, 43.7, 38.10000000000002, 41.70000000000002, 40.30000000000002, 30.9, 30.9, 41.90000000000001, -50.00000000000044, 31.300000000000004, -50.00000000000044, 41.90000000000001, 29.899999999999984, 46.9, -50.00000000000044, 41.90000000000001, 41.500000000000014, -50.00000000000044, 35.10000000000004, 26.499999999999936, -50.00000000000044, 42.900000000000006, 42.10000000000001, -50.00000000000044, 43.50000000000001, 37.70000000000003, 32.90000000000003, -50.00000000000044, 11.29999999999972, 39.70000000000002, 20.099999999999845, 34.30000000000004, 14.09999999999976, -50.00000000000044, 44.5, -50.00000000000044, 39.90000000000002, -50.00000000000044, 44.300000000000004, 43.7, -50.00000000000044, 44.5, 45.1, 3.2999999999996064, 43.900000000000006, -50.00000000000044, 35.70000000000003, 43.50000000000001, 43.900000000000006, -50.00000000000044, 37.300000000000026, -50.00000000000044, 45.5, 41.90000000000001, -50.00000000000044, 36.50000000000003, 38.10000000000002, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, 45.1, 22.299999999999876, 44.5, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 500, 282, 500, 500, 500, 500, 54, 500, 500, 72, 326, 500, 40, 420, 96, 500, 500, 500, 500, 500, 500, 74, 500, 434, 336, 118, 70, 84, 500, 500, 204, 500, 64, 120, 84, 98, 192, 192, 82, 500, 188, 500, 82, 202, 32, 500, 82, 86, 500, 150, 236, 500, 72, 80, 500, 66, 124, 172, 500, 388, 104, 300, 158, 360, 500, 56, 500, 102, 500, 58, 64, 500, 56, 50, 468, 62, 500, 144, 66, 62, 500, 128, 500, 46, 82, 500, 136, 120, 64, 500, 500, 500, 104, 50, 278, 56, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3783413544717834, "mean_inference_ms": 1.2172636507805052, "mean_action_processing_ms": 0.14023852435647238, "mean_env_wait_ms": 0.08425716717540982, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025842905044555664, "StateBufferConnector_ms": 0.0040051937103271484, "ViewRequirementAgentConnector_ms": 0.11383795738220215}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000, "num_env_steps_sampled": 900000, "num_env_steps_trained": 900000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5865.543717982673, "num_env_steps_trained_throughput_per_sec": 5865.543717982673, "timesteps_total": 900000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 900000, "timers": {"training_iteration_time_ms": 3114.925, "sample_time_ms": 2848.306, "load_time_ms": 18.198, "load_throughput": 989135.807, "learn_time_ms": 236.875, "learn_throughput": 75989.29, "synch_weights_time_ms": 9.234}, "counters": {"num_env_steps_sampled": 900000, "num_env_steps_trained": 900000, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000}, "done": false, "episodes_total": 3420, "training_iteration": 50, "trial_id": "9f288_00014", "date": "2023-10-25_16-44-33", "timestamp": 1698248673, "time_this_iter_s": 3.0752642154693604, "time_total_s": 158.43403553962708, "pid": 9504, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 158.43403553962708, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 60.625, "ram_util_percent": 27.125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.7763568394002508e-16, "cur_lr": 0.0003, "total_loss": 7.024775544802348, "policy_loss": 0.024506631462524336, "vf_loss": 7.0003247658411665, "vf_explained_var": -1.0530153910319011e-06, "kl": 0.00021167565545709977, "entropy": 0.5579928060372671, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 606.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 918000, "num_env_steps_trained": 918000, "num_agent_steps_sampled": 918000, "num_agent_steps_trained": 918000}, "sampler_results": {"episode_reward_max": 45.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.8209999999998265, "episode_len_mean": 267.44, "episode_media": {}, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.300000000000004, 43.7, -50.00000000000044, 44.5, 45.1, 3.2999999999996064, 43.900000000000006, -50.00000000000044, 35.70000000000003, 43.50000000000001, 43.900000000000006, -50.00000000000044, 37.300000000000026, -50.00000000000044, 45.5, 41.90000000000001, -50.00000000000044, 36.50000000000003, 38.10000000000002, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, 45.1, 22.299999999999876, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.899999999999814, -50.00000000000044, 33.70000000000004, 41.100000000000016, 23.699999999999896, 9.099999999999689, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.699999999999925, 29.099999999999973, 43.900000000000006, -50.00000000000044, 29.899999999999984, -50.00000000000044, 33.90000000000004, 17.499999999999808, 43.7, 38.700000000000024, -50.00000000000044, 14.09999999999976, -50.00000000000044, -50.00000000000044, 43.50000000000001, 29.899999999999984, 37.90000000000003, -50.00000000000044, -50.00000000000044, 45.3, 39.50000000000002, 42.70000000000001, -50.00000000000044, 44.5, 33.30000000000003, 28.699999999999967, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 44.300000000000004, -50.00000000000044, 29.099999999999973, 45.3, 32.30000000000002, 42.70000000000001, 43.30000000000001, -50.00000000000044, 44.5, -50.00000000000044, 22.099999999999874, -50.00000000000044, 44.300000000000004, 42.70000000000001, -50.00000000000044, 39.90000000000002, 43.7, -50.00000000000044, 41.30000000000001, 43.7, 25.699999999999925, -50.00000000000044, 17.69999999999981, 13.899999999999757, 41.70000000000002, -50.00000000000044, 40.70000000000002, -50.00000000000044, 35.10000000000004, 45.1, 20.49999999999985], "episode_lengths": [58, 64, 500, 56, 50, 468, 62, 500, 144, 66, 62, 500, 128, 500, 46, 82, 500, 136, 120, 64, 500, 500, 500, 104, 50, 278, 56, 500, 500, 500, 322, 500, 164, 90, 264, 410, 500, 500, 500, 244, 210, 62, 500, 202, 500, 162, 326, 64, 114, 500, 360, 500, 500, 66, 202, 122, 500, 500, 48, 106, 74, 500, 56, 168, 214, 500, 500, 500, 74, 58, 500, 210, 48, 178, 74, 68, 500, 56, 500, 280, 500, 58, 74, 500, 102, 64, 500, 88, 64, 244, 500, 324, 362, 84, 500, 94, 500, 150, 50, 296]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37865308929340175, "mean_inference_ms": 1.2175347195808162, "mean_action_processing_ms": 0.14007814590549456, "mean_env_wait_ms": 0.08435289383947055, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.033994436264038086, "StateBufferConnector_ms": 0.0050013065338134766, "ViewRequirementAgentConnector_ms": 0.11609172821044922}}, "episode_reward_max": 45.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.8209999999998265, "episode_len_mean": 267.44, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.300000000000004, 43.7, -50.00000000000044, 44.5, 45.1, 3.2999999999996064, 43.900000000000006, -50.00000000000044, 35.70000000000003, 43.50000000000001, 43.900000000000006, -50.00000000000044, 37.300000000000026, -50.00000000000044, 45.5, 41.90000000000001, -50.00000000000044, 36.50000000000003, 38.10000000000002, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, 45.1, 22.299999999999876, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.899999999999814, -50.00000000000044, 33.70000000000004, 41.100000000000016, 23.699999999999896, 9.099999999999689, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.699999999999925, 29.099999999999973, 43.900000000000006, -50.00000000000044, 29.899999999999984, -50.00000000000044, 33.90000000000004, 17.499999999999808, 43.7, 38.700000000000024, -50.00000000000044, 14.09999999999976, -50.00000000000044, -50.00000000000044, 43.50000000000001, 29.899999999999984, 37.90000000000003, -50.00000000000044, -50.00000000000044, 45.3, 39.50000000000002, 42.70000000000001, -50.00000000000044, 44.5, 33.30000000000003, 28.699999999999967, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 44.300000000000004, -50.00000000000044, 29.099999999999973, 45.3, 32.30000000000002, 42.70000000000001, 43.30000000000001, -50.00000000000044, 44.5, -50.00000000000044, 22.099999999999874, -50.00000000000044, 44.300000000000004, 42.70000000000001, -50.00000000000044, 39.90000000000002, 43.7, -50.00000000000044, 41.30000000000001, 43.7, 25.699999999999925, -50.00000000000044, 17.69999999999981, 13.899999999999757, 41.70000000000002, -50.00000000000044, 40.70000000000002, -50.00000000000044, 35.10000000000004, 45.1, 20.49999999999985], "episode_lengths": [58, 64, 500, 56, 50, 468, 62, 500, 144, 66, 62, 500, 128, 500, 46, 82, 500, 136, 120, 64, 500, 500, 500, 104, 50, 278, 56, 500, 500, 500, 322, 500, 164, 90, 264, 410, 500, 500, 500, 244, 210, 62, 500, 202, 500, 162, 326, 64, 114, 500, 360, 500, 500, 66, 202, 122, 500, 500, 48, 106, 74, 500, 56, 168, 214, 500, 500, 500, 74, 58, 500, 210, 48, 178, 74, 68, 500, 56, 500, 280, 500, 58, 74, 500, 102, 64, 500, 88, 64, 244, 500, 324, 362, 84, 500, 94, 500, 150, 50, 296]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37865308929340175, "mean_inference_ms": 1.2175347195808162, "mean_action_processing_ms": 0.14007814590549456, "mean_env_wait_ms": 0.08435289383947055, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.033994436264038086, "StateBufferConnector_ms": 0.0050013065338134766, "ViewRequirementAgentConnector_ms": 0.11609172821044922}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 918000, "num_agent_steps_trained": 918000, "num_env_steps_sampled": 918000, "num_env_steps_trained": 918000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5950.929436245243, "num_env_steps_trained_throughput_per_sec": 5950.929436245243, "timesteps_total": 918000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 918000, "timers": {"training_iteration_time_ms": 3110.367, "sample_time_ms": 2844.568, "load_time_ms": 18.123, "load_throughput": 993219.204, "learn_time_ms": 235.947, "learn_throughput": 76288.292, "synch_weights_time_ms": 9.215}, "counters": {"num_env_steps_sampled": 918000, "num_env_steps_trained": 918000, "num_agent_steps_sampled": 918000, "num_agent_steps_trained": 918000}, "done": false, "episodes_total": 3491, "training_iteration": 51, "trial_id": "9f288_00014", "date": "2023-10-25_16-44-36", "timestamp": 1698248676, "time_this_iter_s": 3.0297231674194336, "time_total_s": 161.4637587070465, "pid": 9504, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 161.4637587070465, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 60.2, "ram_util_percent": 27.119999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.881784197001254e-17, "cur_lr": 0.0003, "total_loss": 7.326767206192017, "policy_loss": -0.019444012199528515, "vf_loss": 7.346268614133199, "vf_explained_var": -1.4106432596842449e-06, "kl": 0.0001626434611144608, "entropy": 0.5726153900225958, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 618.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 936000, "num_env_steps_trained": 936000, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.324999999999843, "episode_len_mean": 252.46, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 29.099999999999973, 45.3, 32.30000000000002, 42.70000000000001, 43.30000000000001, -50.00000000000044, 44.5, -50.00000000000044, 22.099999999999874, -50.00000000000044, 44.300000000000004, 42.70000000000001, -50.00000000000044, 39.90000000000002, 43.7, -50.00000000000044, 41.30000000000001, 43.7, 25.699999999999925, -50.00000000000044, 17.69999999999981, 13.899999999999757, 41.70000000000002, -50.00000000000044, 40.70000000000002, -50.00000000000044, 35.10000000000004, 45.1, 20.49999999999985, -50.00000000000044, -50.00000000000044, 44.5, 42.900000000000006, 45.1, 18.699999999999825, -50.00000000000044, 43.30000000000001, 41.100000000000016, 9.499999999999694, 43.50000000000001, -50.00000000000044, -50.00000000000044, 40.70000000000002, 19.09999999999983, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, 25.899999999999928, -50.00000000000044, 45.5, 42.70000000000001, 42.30000000000001, 16.8999999999998, 32.100000000000016, 46.099999999999994, -50.00000000000044, 31.900000000000013, 30.699999999999996, 47.1, 15.099999999999774, -50.00000000000044, -50.00000000000044, 44.300000000000004, 42.30000000000001, -50.00000000000044, 24.299999999999905, 41.30000000000001, 5.299999999999635, 40.90000000000002, 41.100000000000016, 40.500000000000014, 39.10000000000002, 42.10000000000001, 10.099999999999703, 34.70000000000004, 33.90000000000004, 43.30000000000001, 40.10000000000002, -50.00000000000044, 41.30000000000001, 42.70000000000001, -50.00000000000044, -50.00000000000044, 0.8999999999995723, 41.30000000000001, 25.899999999999928, 39.10000000000002, -50.00000000000044, 32.100000000000016, 44.5, 43.7, -50.00000000000044, 43.30000000000001, 17.299999999999805, -50.00000000000044, 39.70000000000002, -50.00000000000044, 26.299999999999933], "episode_lengths": [500, 210, 48, 178, 74, 68, 500, 56, 500, 280, 500, 58, 74, 500, 102, 64, 500, 88, 64, 244, 500, 324, 362, 84, 500, 94, 500, 150, 50, 296, 500, 500, 56, 72, 50, 314, 500, 68, 90, 406, 66, 500, 500, 94, 310, 500, 90, 500, 500, 242, 500, 46, 74, 78, 332, 180, 40, 500, 182, 194, 30, 350, 500, 500, 58, 78, 500, 258, 88, 448, 92, 90, 96, 110, 80, 400, 154, 162, 68, 100, 500, 88, 74, 500, 500, 492, 88, 242, 110, 500, 180, 56, 64, 500, 68, 328, 500, 104, 500, 238]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3787238742127363, "mean_inference_ms": 1.2173975658415876, "mean_action_processing_ms": 0.1401998676652383, "mean_env_wait_ms": 0.08430417470211755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025991201400756836, "StateBufferConnector_ms": 0.004000425338745117, "ViewRequirementAgentConnector_ms": 0.1180887222290039}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.324999999999843, "episode_len_mean": 252.46, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 29.099999999999973, 45.3, 32.30000000000002, 42.70000000000001, 43.30000000000001, -50.00000000000044, 44.5, -50.00000000000044, 22.099999999999874, -50.00000000000044, 44.300000000000004, 42.70000000000001, -50.00000000000044, 39.90000000000002, 43.7, -50.00000000000044, 41.30000000000001, 43.7, 25.699999999999925, -50.00000000000044, 17.69999999999981, 13.899999999999757, 41.70000000000002, -50.00000000000044, 40.70000000000002, -50.00000000000044, 35.10000000000004, 45.1, 20.49999999999985, -50.00000000000044, -50.00000000000044, 44.5, 42.900000000000006, 45.1, 18.699999999999825, -50.00000000000044, 43.30000000000001, 41.100000000000016, 9.499999999999694, 43.50000000000001, -50.00000000000044, -50.00000000000044, 40.70000000000002, 19.09999999999983, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, 25.899999999999928, -50.00000000000044, 45.5, 42.70000000000001, 42.30000000000001, 16.8999999999998, 32.100000000000016, 46.099999999999994, -50.00000000000044, 31.900000000000013, 30.699999999999996, 47.1, 15.099999999999774, -50.00000000000044, -50.00000000000044, 44.300000000000004, 42.30000000000001, -50.00000000000044, 24.299999999999905, 41.30000000000001, 5.299999999999635, 40.90000000000002, 41.100000000000016, 40.500000000000014, 39.10000000000002, 42.10000000000001, 10.099999999999703, 34.70000000000004, 33.90000000000004, 43.30000000000001, 40.10000000000002, -50.00000000000044, 41.30000000000001, 42.70000000000001, -50.00000000000044, -50.00000000000044, 0.8999999999995723, 41.30000000000001, 25.899999999999928, 39.10000000000002, -50.00000000000044, 32.100000000000016, 44.5, 43.7, -50.00000000000044, 43.30000000000001, 17.299999999999805, -50.00000000000044, 39.70000000000002, -50.00000000000044, 26.299999999999933], "episode_lengths": [500, 210, 48, 178, 74, 68, 500, 56, 500, 280, 500, 58, 74, 500, 102, 64, 500, 88, 64, 244, 500, 324, 362, 84, 500, 94, 500, 150, 50, 296, 500, 500, 56, 72, 50, 314, 500, 68, 90, 406, 66, 500, 500, 94, 310, 500, 90, 500, 500, 242, 500, 46, 74, 78, 332, 180, 40, 500, 182, 194, 30, 350, 500, 500, 58, 78, 500, 258, 88, 448, 92, 90, 96, 110, 80, 400, 154, 162, 68, 100, 500, 88, 74, 500, 500, 492, 88, 242, 110, 500, 180, 56, 64, 500, 68, 328, 500, 104, 500, 238]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3787238742127363, "mean_inference_ms": 1.2173975658415876, "mean_action_processing_ms": 0.1401998676652383, "mean_env_wait_ms": 0.08430417470211755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025991201400756836, "StateBufferConnector_ms": 0.004000425338745117, "ViewRequirementAgentConnector_ms": 0.1180887222290039}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000, "num_env_steps_sampled": 936000, "num_env_steps_trained": 936000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5787.026462620268, "num_env_steps_trained_throughput_per_sec": 5787.026462620268, "timesteps_total": 936000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 936000, "timers": {"training_iteration_time_ms": 3111.101, "sample_time_ms": 2850.086, "load_time_ms": 18.037, "load_throughput": 997923.087, "learn_time_ms": 231.252, "learn_throughput": 77837.212, "synch_weights_time_ms": 9.212}, "counters": {"num_env_steps_sampled": 936000, "num_env_steps_trained": 936000, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000}, "done": false, "episodes_total": 3561, "training_iteration": 52, "trial_id": "9f288_00014", "date": "2023-10-25_16-44-39", "timestamp": 1698248679, "time_this_iter_s": 3.1163828372955322, "time_total_s": 164.58014154434204, "pid": 9504, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 164.58014154434204, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 66.1, "ram_util_percent": 27.150000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.440892098500627e-17, "cur_lr": 0.0003, "total_loss": 7.291019241015117, "policy_loss": 0.002548293210566044, "vf_loss": 7.2885342836380005, "vf_explained_var": -6.556510925292969e-07, "kl": 0.0002827476340125183, "entropy": 0.6326068987449011, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 630.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 954000, "num_env_steps_trained": 954000, "num_agent_steps_sampled": 954000, "num_agent_steps_trained": 954000}, "sampler_results": {"episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.66799999999986, "episode_len_mean": 244.06, "episode_media": {}, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.500000000000014, 39.10000000000002, 42.10000000000001, 10.099999999999703, 34.70000000000004, 33.90000000000004, 43.30000000000001, 40.10000000000002, -50.00000000000044, 41.30000000000001, 42.70000000000001, -50.00000000000044, -50.00000000000044, 0.8999999999995723, 41.30000000000001, 25.899999999999928, 39.10000000000002, -50.00000000000044, 32.100000000000016, 44.5, 43.7, -50.00000000000044, 43.30000000000001, 17.299999999999805, -50.00000000000044, 39.70000000000002, -50.00000000000044, 26.299999999999933, -50.00000000000044, 46.3, 41.100000000000016, 30.29999999999999, 45.9, -50.00000000000044, -50.00000000000044, 39.300000000000026, 31.900000000000013, 40.30000000000002, 44.900000000000006, 4.499999999999623, 27.699999999999953, 44.7, 34.50000000000004, 40.30000000000002, -50.00000000000044, 14.499999999999766, 5.6999999999996405, 29.69999999999998, 44.10000000000001, 43.7, -50.00000000000044, 35.900000000000034, -50.00000000000044, 40.70000000000002, 39.50000000000002, 44.10000000000001, 35.900000000000034, 42.10000000000001, 44.5, -50.00000000000044, 30.29999999999999, -50.00000000000044, 36.900000000000034, 45.5, 42.70000000000001, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 22.899999999999885, 12.299999999999734, -50.00000000000044, 34.900000000000034, 25.499999999999922, 40.70000000000002, 30.699999999999996, 37.70000000000003, -50.00000000000044, 37.50000000000003, -50.00000000000044, 25.499999999999922, 43.30000000000001, -50.00000000000044, 27.899999999999956, 11.499999999999723, 35.10000000000004, 45.9, 43.7, 34.30000000000004, -50.00000000000044, 42.500000000000014, 26.299999999999933, 45.9, 37.300000000000026, 7.499999999999666, 39.90000000000002, -50.00000000000044], "episode_lengths": [96, 110, 80, 400, 154, 162, 68, 100, 500, 88, 74, 500, 500, 492, 88, 242, 110, 500, 180, 56, 64, 500, 68, 328, 500, 104, 500, 238, 500, 38, 90, 198, 42, 500, 500, 108, 182, 98, 52, 456, 224, 54, 156, 98, 500, 356, 444, 204, 60, 64, 500, 142, 500, 94, 106, 60, 142, 80, 56, 500, 198, 500, 132, 46, 74, 500, 500, 52, 500, 500, 500, 64, 272, 378, 500, 152, 246, 94, 194, 124, 500, 126, 500, 246, 68, 500, 222, 386, 150, 42, 64, 158, 500, 76, 238, 42, 128, 426, 102, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37873456635418307, "mean_inference_ms": 1.2156301422630127, "mean_action_processing_ms": 0.13996781528825644, "mean_env_wait_ms": 0.0842049277511262, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02151346206665039, "StateBufferConnector_ms": 0.009012699127197266, "ViewRequirementAgentConnector_ms": 0.10502004623413086}}, "episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.66799999999986, "episode_len_mean": 244.06, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [40.500000000000014, 39.10000000000002, 42.10000000000001, 10.099999999999703, 34.70000000000004, 33.90000000000004, 43.30000000000001, 40.10000000000002, -50.00000000000044, 41.30000000000001, 42.70000000000001, -50.00000000000044, -50.00000000000044, 0.8999999999995723, 41.30000000000001, 25.899999999999928, 39.10000000000002, -50.00000000000044, 32.100000000000016, 44.5, 43.7, -50.00000000000044, 43.30000000000001, 17.299999999999805, -50.00000000000044, 39.70000000000002, -50.00000000000044, 26.299999999999933, -50.00000000000044, 46.3, 41.100000000000016, 30.29999999999999, 45.9, -50.00000000000044, -50.00000000000044, 39.300000000000026, 31.900000000000013, 40.30000000000002, 44.900000000000006, 4.499999999999623, 27.699999999999953, 44.7, 34.50000000000004, 40.30000000000002, -50.00000000000044, 14.499999999999766, 5.6999999999996405, 29.69999999999998, 44.10000000000001, 43.7, -50.00000000000044, 35.900000000000034, -50.00000000000044, 40.70000000000002, 39.50000000000002, 44.10000000000001, 35.900000000000034, 42.10000000000001, 44.5, -50.00000000000044, 30.29999999999999, -50.00000000000044, 36.900000000000034, 45.5, 42.70000000000001, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 22.899999999999885, 12.299999999999734, -50.00000000000044, 34.900000000000034, 25.499999999999922, 40.70000000000002, 30.699999999999996, 37.70000000000003, -50.00000000000044, 37.50000000000003, -50.00000000000044, 25.499999999999922, 43.30000000000001, -50.00000000000044, 27.899999999999956, 11.499999999999723, 35.10000000000004, 45.9, 43.7, 34.30000000000004, -50.00000000000044, 42.500000000000014, 26.299999999999933, 45.9, 37.300000000000026, 7.499999999999666, 39.90000000000002, -50.00000000000044], "episode_lengths": [96, 110, 80, 400, 154, 162, 68, 100, 500, 88, 74, 500, 500, 492, 88, 242, 110, 500, 180, 56, 64, 500, 68, 328, 500, 104, 500, 238, 500, 38, 90, 198, 42, 500, 500, 108, 182, 98, 52, 456, 224, 54, 156, 98, 500, 356, 444, 204, 60, 64, 500, 142, 500, 94, 106, 60, 142, 80, 56, 500, 198, 500, 132, 46, 74, 500, 500, 52, 500, 500, 500, 64, 272, 378, 500, 152, 246, 94, 194, 124, 500, 126, 500, 246, 68, 500, 222, 386, 150, 42, 64, 158, 500, 76, 238, 42, 128, 426, 102, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37873456635418307, "mean_inference_ms": 1.2156301422630127, "mean_action_processing_ms": 0.13996781528825644, "mean_env_wait_ms": 0.0842049277511262, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02151346206665039, "StateBufferConnector_ms": 0.009012699127197266, "ViewRequirementAgentConnector_ms": 0.10502004623413086}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 954000, "num_agent_steps_trained": 954000, "num_env_steps_sampled": 954000, "num_env_steps_trained": 954000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5699.107829522881, "num_env_steps_trained_throughput_per_sec": 5699.107829522881, "timesteps_total": 954000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 954000, "timers": {"training_iteration_time_ms": 3113.078, "sample_time_ms": 2845.381, "load_time_ms": 18.32, "load_throughput": 982515.48, "learn_time_ms": 237.544, "learn_throughput": 75775.355, "synch_weights_time_ms": 9.119}, "counters": {"num_env_steps_sampled": 954000, "num_env_steps_trained": 954000, "num_agent_steps_sampled": 954000, "num_agent_steps_trained": 954000}, "done": false, "episodes_total": 3633, "training_iteration": 53, "trial_id": "9f288_00014", "date": "2023-10-25_16-44-42", "timestamp": 1698248682, "time_this_iter_s": 3.1629114151000977, "time_total_s": 167.74305295944214, "pid": 9504, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 167.74305295944214, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 61.475, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.2204460492503135e-17, "cur_lr": 0.0003, "total_loss": 6.749105771382649, "policy_loss": 0.10506636858917773, "vf_loss": 6.644096493721008, "vf_explained_var": -1.5894571940104167e-06, "kl": 0.00020609713117399528, "entropy": 0.5728691170612971, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 642.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 972000, "num_env_steps_trained": 972000, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000}, "sampler_results": {"episode_reward_max": 45.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.79299999999984, "episode_len_mean": 257.74, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 22.899999999999885, 12.299999999999734, -50.00000000000044, 34.900000000000034, 25.499999999999922, 40.70000000000002, 30.699999999999996, 37.70000000000003, -50.00000000000044, 37.50000000000003, -50.00000000000044, 25.499999999999922, 43.30000000000001, -50.00000000000044, 27.899999999999956, 11.499999999999723, 35.10000000000004, 45.9, 43.7, 34.30000000000004, -50.00000000000044, 42.500000000000014, 26.299999999999933, 45.9, 37.300000000000026, 7.499999999999666, 39.90000000000002, -50.00000000000044, 38.90000000000002, 44.5, 41.90000000000001, 40.90000000000002, 10.699999999999712, 41.90000000000001, -50.00000000000044, 36.10000000000004, -50.00000000000044, 42.900000000000006, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 42.30000000000001, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 42.500000000000014, 42.500000000000014, -50.00000000000044, 23.499999999999893, -50.00000000000044, 41.70000000000002, -50.00000000000044, 40.90000000000002, 41.30000000000001, 42.70000000000001, 44.10000000000001, 26.299999999999933, -50.00000000000044, 25.699999999999925, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.9, -50.00000000000044, -50.00000000000044, 42.500000000000014, 31.70000000000001, 43.7, 27.899999999999956, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 41.500000000000014, 37.10000000000003, 42.30000000000001, -50.00000000000044, -50.00000000000044, 20.49999999999985, -50.00000000000044, 29.899999999999984, -50.00000000000044, 42.70000000000001, 43.7, 41.30000000000001, 43.30000000000001, 42.70000000000001, 40.30000000000002, 44.900000000000006, 25.899999999999928, 35.500000000000036, 37.50000000000003, 41.100000000000016], "episode_lengths": [500, 500, 500, 64, 272, 378, 500, 152, 246, 94, 194, 124, 500, 126, 500, 246, 68, 500, 222, 386, 150, 42, 64, 158, 500, 76, 238, 42, 128, 426, 102, 500, 112, 56, 82, 92, 394, 82, 500, 140, 500, 72, 44, 500, 500, 500, 48, 78, 500, 52, 500, 500, 76, 76, 500, 266, 500, 84, 500, 92, 88, 74, 60, 238, 500, 244, 500, 500, 500, 192, 500, 500, 76, 184, 64, 222, 500, 500, 74, 500, 86, 130, 78, 500, 500, 296, 500, 202, 500, 74, 64, 88, 68, 74, 98, 52, 242, 146, 126, 90]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3787944996816275, "mean_inference_ms": 1.2167856018070293, "mean_action_processing_ms": 0.14035267783767727, "mean_env_wait_ms": 0.08419077586503225, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02251124382019043, "StateBufferConnector_ms": 0.005011558532714844, "ViewRequirementAgentConnector_ms": 0.11380386352539062}}, "episode_reward_max": 45.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.79299999999984, "episode_len_mean": 257.74, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 22.899999999999885, 12.299999999999734, -50.00000000000044, 34.900000000000034, 25.499999999999922, 40.70000000000002, 30.699999999999996, 37.70000000000003, -50.00000000000044, 37.50000000000003, -50.00000000000044, 25.499999999999922, 43.30000000000001, -50.00000000000044, 27.899999999999956, 11.499999999999723, 35.10000000000004, 45.9, 43.7, 34.30000000000004, -50.00000000000044, 42.500000000000014, 26.299999999999933, 45.9, 37.300000000000026, 7.499999999999666, 39.90000000000002, -50.00000000000044, 38.90000000000002, 44.5, 41.90000000000001, 40.90000000000002, 10.699999999999712, 41.90000000000001, -50.00000000000044, 36.10000000000004, -50.00000000000044, 42.900000000000006, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 42.30000000000001, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 42.500000000000014, 42.500000000000014, -50.00000000000044, 23.499999999999893, -50.00000000000044, 41.70000000000002, -50.00000000000044, 40.90000000000002, 41.30000000000001, 42.70000000000001, 44.10000000000001, 26.299999999999933, -50.00000000000044, 25.699999999999925, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.9, -50.00000000000044, -50.00000000000044, 42.500000000000014, 31.70000000000001, 43.7, 27.899999999999956, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 41.500000000000014, 37.10000000000003, 42.30000000000001, -50.00000000000044, -50.00000000000044, 20.49999999999985, -50.00000000000044, 29.899999999999984, -50.00000000000044, 42.70000000000001, 43.7, 41.30000000000001, 43.30000000000001, 42.70000000000001, 40.30000000000002, 44.900000000000006, 25.899999999999928, 35.500000000000036, 37.50000000000003, 41.100000000000016], "episode_lengths": [500, 500, 500, 64, 272, 378, 500, 152, 246, 94, 194, 124, 500, 126, 500, 246, 68, 500, 222, 386, 150, 42, 64, 158, 500, 76, 238, 42, 128, 426, 102, 500, 112, 56, 82, 92, 394, 82, 500, 140, 500, 72, 44, 500, 500, 500, 48, 78, 500, 52, 500, 500, 76, 76, 500, 266, 500, 84, 500, 92, 88, 74, 60, 238, 500, 244, 500, 500, 500, 192, 500, 500, 76, 184, 64, 222, 500, 500, 74, 500, 86, 130, 78, 500, 500, 296, 500, 202, 500, 74, 64, 88, 68, 74, 98, 52, 242, 146, 126, 90]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3787944996816275, "mean_inference_ms": 1.2167856018070293, "mean_action_processing_ms": 0.14035267783767727, "mean_env_wait_ms": 0.08419077586503225, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02251124382019043, "StateBufferConnector_ms": 0.005011558532714844, "ViewRequirementAgentConnector_ms": 0.11380386352539062}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000, "num_env_steps_sampled": 972000, "num_env_steps_trained": 972000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5832.213871276644, "num_env_steps_trained_throughput_per_sec": 5832.213871276644, "timesteps_total": 972000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 972000, "timers": {"training_iteration_time_ms": 3103.045, "sample_time_ms": 2847.839, "load_time_ms": 17.424, "load_throughput": 1033038.809, "learn_time_ms": 225.983, "learn_throughput": 79651.866, "synch_weights_time_ms": 9.194}, "counters": {"num_env_steps_sampled": 972000, "num_env_steps_trained": 972000, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000}, "done": false, "episodes_total": 3701, "training_iteration": 54, "trial_id": "9f288_00014", "date": "2023-10-25_16-44-45", "timestamp": 1698248685, "time_this_iter_s": 3.0923120975494385, "time_total_s": 170.83536505699158, "pid": 9504, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 170.83536505699158, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 58.8, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1102230246251568e-17, "cur_lr": 0.0003, "total_loss": 7.223104357719421, "policy_loss": 0.012334857601672411, "vf_loss": 7.210826714833577, "vf_explained_var": -4.221995671590169e-07, "kl": 0.00023125811264534946, "entropy": 0.5731135755777359, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 654.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 990000, "num_env_steps_trained": 990000, "num_agent_steps_sampled": 990000, "num_agent_steps_trained": 990000}, "sampler_results": {"episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.59299999999987, "episode_len_mean": 229.8, "episode_media": {}, "episodes_this_iter": 79, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 41.500000000000014, 37.10000000000003, 42.30000000000001, -50.00000000000044, -50.00000000000044, 20.49999999999985, -50.00000000000044, 29.899999999999984, -50.00000000000044, 42.70000000000001, 43.7, 41.30000000000001, 43.30000000000001, 42.70000000000001, 40.30000000000002, 44.900000000000006, 25.899999999999928, 35.500000000000036, 37.50000000000003, 41.100000000000016, -50.00000000000044, 32.90000000000003, 39.90000000000002, -50.00000000000044, 30.29999999999999, 37.90000000000003, 27.099999999999945, 42.10000000000001, 38.700000000000024, 29.099999999999973, -50.00000000000044, 45.1, 45.5, -50.00000000000044, 46.099999999999994, 38.90000000000002, -50.00000000000044, 39.70000000000002, 37.90000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.90000000000004, 41.90000000000001, 44.300000000000004, 39.70000000000002, 19.299999999999834, 41.70000000000002, 43.7, 43.10000000000001, -50.00000000000044, 13.699999999999754, 29.299999999999976, -50.00000000000044, 41.90000000000001, 35.70000000000003, -50.00000000000044, 41.30000000000001, 40.10000000000002, -50.00000000000044, 12.69999999999974, 42.70000000000001, 13.699999999999754, -50.00000000000044, 45.5, 19.09999999999983, 44.7, 39.70000000000002, 40.30000000000002, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 45.3, 43.30000000000001, 43.7, -50.00000000000044, 36.70000000000003, -50.00000000000044, -50.00000000000044, 42.70000000000001, 35.500000000000036, -50.00000000000044, 42.70000000000001, 41.90000000000001, 41.100000000000016, 39.70000000000002, 40.70000000000002, 36.10000000000004, 39.300000000000026, 36.50000000000003, 30.099999999999987, 40.30000000000002, 14.299999999999763, -50.00000000000044, 41.30000000000001, 20.699999999999854], "episode_lengths": [500, 86, 130, 78, 500, 500, 296, 500, 202, 500, 74, 64, 88, 68, 74, 98, 52, 242, 146, 126, 90, 500, 172, 102, 500, 198, 122, 230, 80, 114, 210, 500, 50, 46, 500, 40, 112, 500, 104, 122, 500, 500, 500, 500, 162, 82, 58, 104, 308, 84, 64, 70, 500, 364, 208, 500, 82, 144, 500, 88, 100, 500, 374, 74, 364, 500, 46, 310, 54, 104, 98, 36, 500, 500, 500, 86, 48, 68, 64, 500, 134, 500, 500, 74, 146, 500, 74, 82, 90, 104, 94, 140, 108, 136, 200, 98, 358, 500, 88, 294]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37892730824601456, "mean_inference_ms": 1.215153159668132, "mean_action_processing_ms": 0.13999812742547094, "mean_env_wait_ms": 0.08439385124687847, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02222609519958496, "StateBufferConnector_ms": 0.005003452301025391, "ViewRequirementAgentConnector_ms": 0.11081337928771973}}, "episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.59299999999987, "episode_len_mean": 229.8, "episodes_this_iter": 79, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 41.500000000000014, 37.10000000000003, 42.30000000000001, -50.00000000000044, -50.00000000000044, 20.49999999999985, -50.00000000000044, 29.899999999999984, -50.00000000000044, 42.70000000000001, 43.7, 41.30000000000001, 43.30000000000001, 42.70000000000001, 40.30000000000002, 44.900000000000006, 25.899999999999928, 35.500000000000036, 37.50000000000003, 41.100000000000016, -50.00000000000044, 32.90000000000003, 39.90000000000002, -50.00000000000044, 30.29999999999999, 37.90000000000003, 27.099999999999945, 42.10000000000001, 38.700000000000024, 29.099999999999973, -50.00000000000044, 45.1, 45.5, -50.00000000000044, 46.099999999999994, 38.90000000000002, -50.00000000000044, 39.70000000000002, 37.90000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.90000000000004, 41.90000000000001, 44.300000000000004, 39.70000000000002, 19.299999999999834, 41.70000000000002, 43.7, 43.10000000000001, -50.00000000000044, 13.699999999999754, 29.299999999999976, -50.00000000000044, 41.90000000000001, 35.70000000000003, -50.00000000000044, 41.30000000000001, 40.10000000000002, -50.00000000000044, 12.69999999999974, 42.70000000000001, 13.699999999999754, -50.00000000000044, 45.5, 19.09999999999983, 44.7, 39.70000000000002, 40.30000000000002, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 45.3, 43.30000000000001, 43.7, -50.00000000000044, 36.70000000000003, -50.00000000000044, -50.00000000000044, 42.70000000000001, 35.500000000000036, -50.00000000000044, 42.70000000000001, 41.90000000000001, 41.100000000000016, 39.70000000000002, 40.70000000000002, 36.10000000000004, 39.300000000000026, 36.50000000000003, 30.099999999999987, 40.30000000000002, 14.299999999999763, -50.00000000000044, 41.30000000000001, 20.699999999999854], "episode_lengths": [500, 86, 130, 78, 500, 500, 296, 500, 202, 500, 74, 64, 88, 68, 74, 98, 52, 242, 146, 126, 90, 500, 172, 102, 500, 198, 122, 230, 80, 114, 210, 500, 50, 46, 500, 40, 112, 500, 104, 122, 500, 500, 500, 500, 162, 82, 58, 104, 308, 84, 64, 70, 500, 364, 208, 500, 82, 144, 500, 88, 100, 500, 374, 74, 364, 500, 46, 310, 54, 104, 98, 36, 500, 500, 500, 86, 48, 68, 64, 500, 134, 500, 500, 74, 146, 500, 74, 82, 90, 104, 94, 140, 108, 136, 200, 98, 358, 500, 88, 294]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37892730824601456, "mean_inference_ms": 1.215153159668132, "mean_action_processing_ms": 0.13999812742547094, "mean_env_wait_ms": 0.08439385124687847, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02222609519958496, "StateBufferConnector_ms": 0.005003452301025391, "ViewRequirementAgentConnector_ms": 0.11081337928771973}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 990000, "num_agent_steps_trained": 990000, "num_env_steps_sampled": 990000, "num_env_steps_trained": 990000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5551.357363353726, "num_env_steps_trained_throughput_per_sec": 5551.357363353726, "timesteps_total": 990000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 990000, "timers": {"training_iteration_time_ms": 3124.89, "sample_time_ms": 2853.43, "load_time_ms": 18.512, "load_throughput": 972340.457, "learn_time_ms": 241.106, "learn_throughput": 74655.958, "synch_weights_time_ms": 9.238}, "counters": {"num_env_steps_sampled": 990000, "num_env_steps_trained": 990000, "num_agent_steps_sampled": 990000, "num_agent_steps_trained": 990000}, "done": false, "episodes_total": 3780, "training_iteration": 55, "trial_id": "9f288_00014", "date": "2023-10-25_16-44-48", "timestamp": 1698248688, "time_this_iter_s": 3.2484467029571533, "time_total_s": 174.08381175994873, "pid": 9504, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 174.08381175994873, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 62.175000000000004, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.551115123125784e-18, "cur_lr": 0.0003, "total_loss": 6.727823734283447, "policy_loss": -0.03755898121744394, "vf_loss": 6.765438477198283, "vf_explained_var": -1.4106432596842449e-06, "kl": 0.0002480058962580263, "entropy": 0.5556758493185043, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 666.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 1008000, "num_env_steps_trained": 1008000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.2399999999998395, "episode_len_mean": 248.24, "episode_media": {}, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 45.3, 43.30000000000001, 43.7, -50.00000000000044, 36.70000000000003, -50.00000000000044, -50.00000000000044, 42.70000000000001, 35.500000000000036, -50.00000000000044, 42.70000000000001, 41.90000000000001, 41.100000000000016, 39.70000000000002, 40.70000000000002, 36.10000000000004, 39.300000000000026, 36.50000000000003, 30.099999999999987, 40.30000000000002, 14.299999999999763, -50.00000000000044, 41.30000000000001, 20.699999999999854, -50.00000000000044, 43.30000000000001, 34.70000000000004, -50.00000000000044, 44.900000000000006, 38.90000000000002, 46.5, 45.3, 42.500000000000014, 44.900000000000006, 25.099999999999916, 46.9, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 44.10000000000001, 44.5, 34.900000000000034, 42.500000000000014, 44.900000000000006, 40.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.30000000000003, -50.00000000000044, 42.900000000000006, -50.00000000000044, 41.70000000000002, 43.50000000000001, 43.900000000000006, 39.50000000000002, 34.10000000000004, 45.5, -50.00000000000044, 38.700000000000024, 41.100000000000016, 36.50000000000003, -50.00000000000044, 25.499999999999922, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 30.099999999999987, 46.099999999999994, 29.299999999999976, 40.10000000000002, 41.500000000000014, -50.00000000000044, 39.70000000000002, 42.70000000000001, 45.3, -50.00000000000044, 41.100000000000016, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.899999999999785], "episode_lengths": [36, 500, 500, 500, 86, 48, 68, 64, 500, 134, 500, 500, 74, 146, 500, 74, 82, 90, 104, 94, 140, 108, 136, 200, 98, 358, 500, 88, 294, 500, 68, 154, 500, 52, 112, 36, 48, 76, 52, 250, 32, 500, 50, 500, 500, 60, 56, 152, 76, 52, 98, 500, 500, 500, 168, 500, 72, 500, 84, 66, 62, 106, 160, 46, 500, 114, 90, 136, 500, 246, 500, 500, 50, 500, 200, 40, 208, 100, 86, 500, 104, 74, 48, 500, 90, 68, 500, 500, 500, 36, 500, 500, 500, 500, 82, 500, 500, 500, 500, 342]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3780772303451293, "mean_inference_ms": 1.2144373294634627, "mean_action_processing_ms": 0.1402921718979692, "mean_env_wait_ms": 0.084049929364199, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014213323593139648, "StateBufferConnector_ms": 0.006003141403198242, "ViewRequirementAgentConnector_ms": 0.11577057838439941}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.2399999999998395, "episode_len_mean": 248.24, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 45.3, 43.30000000000001, 43.7, -50.00000000000044, 36.70000000000003, -50.00000000000044, -50.00000000000044, 42.70000000000001, 35.500000000000036, -50.00000000000044, 42.70000000000001, 41.90000000000001, 41.100000000000016, 39.70000000000002, 40.70000000000002, 36.10000000000004, 39.300000000000026, 36.50000000000003, 30.099999999999987, 40.30000000000002, 14.299999999999763, -50.00000000000044, 41.30000000000001, 20.699999999999854, -50.00000000000044, 43.30000000000001, 34.70000000000004, -50.00000000000044, 44.900000000000006, 38.90000000000002, 46.5, 45.3, 42.500000000000014, 44.900000000000006, 25.099999999999916, 46.9, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 44.10000000000001, 44.5, 34.900000000000034, 42.500000000000014, 44.900000000000006, 40.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.30000000000003, -50.00000000000044, 42.900000000000006, -50.00000000000044, 41.70000000000002, 43.50000000000001, 43.900000000000006, 39.50000000000002, 34.10000000000004, 45.5, -50.00000000000044, 38.700000000000024, 41.100000000000016, 36.50000000000003, -50.00000000000044, 25.499999999999922, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 30.099999999999987, 46.099999999999994, 29.299999999999976, 40.10000000000002, 41.500000000000014, -50.00000000000044, 39.70000000000002, 42.70000000000001, 45.3, -50.00000000000044, 41.100000000000016, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.899999999999785], "episode_lengths": [36, 500, 500, 500, 86, 48, 68, 64, 500, 134, 500, 500, 74, 146, 500, 74, 82, 90, 104, 94, 140, 108, 136, 200, 98, 358, 500, 88, 294, 500, 68, 154, 500, 52, 112, 36, 48, 76, 52, 250, 32, 500, 50, 500, 500, 60, 56, 152, 76, 52, 98, 500, 500, 500, 168, 500, 72, 500, 84, 66, 62, 106, 160, 46, 500, 114, 90, 136, 500, 246, 500, 500, 50, 500, 200, 40, 208, 100, 86, 500, 104, 74, 48, 500, 90, 68, 500, 500, 500, 36, 500, 500, 500, 500, 82, 500, 500, 500, 500, 342]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3780772303451293, "mean_inference_ms": 1.2144373294634627, "mean_action_processing_ms": 0.1402921718979692, "mean_env_wait_ms": 0.084049929364199, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014213323593139648, "StateBufferConnector_ms": 0.006003141403198242, "ViewRequirementAgentConnector_ms": 0.11577057838439941}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000, "num_env_steps_sampled": 1008000, "num_env_steps_trained": 1008000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5929.0558043355495, "num_env_steps_trained_throughput_per_sec": 5929.0558043355495, "timesteps_total": 1008000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1008000, "timers": {"training_iteration_time_ms": 3115.924, "sample_time_ms": 2846.574, "load_time_ms": 18.716, "load_throughput": 961759.812, "learn_time_ms": 238.8, "learn_throughput": 75376.914, "synch_weights_time_ms": 9.21}, "counters": {"num_env_steps_sampled": 1008000, "num_env_steps_trained": 1008000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "done": false, "episodes_total": 3851, "training_iteration": 56, "trial_id": "9f288_00014", "date": "2023-10-25_16-44-51", "timestamp": 1698248691, "time_this_iter_s": 3.041285991668701, "time_total_s": 177.12509775161743, "pid": 9504, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 177.12509775161743, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 54.54, "ram_util_percent": 27.22}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.775557561562892e-18, "cur_lr": 0.0003, "total_loss": 6.714125553766887, "policy_loss": 0.015458573587238789, "vf_loss": 6.6987229983011884, "vf_explained_var": 1.241763432820638e-07, "kl": 0.00019607387899137999, "entropy": 0.5603205313285192, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 678.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 1026000, "num_env_steps_trained": 1026000, "num_agent_steps_sampled": 1026000, "num_agent_steps_trained": 1026000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.342999999999815, "episode_len_mean": 272.16, "episode_media": {}, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.1, -50.00000000000044, 30.099999999999987, 46.099999999999994, 29.299999999999976, 40.10000000000002, 41.500000000000014, -50.00000000000044, 39.70000000000002, 42.70000000000001, 45.3, -50.00000000000044, 41.100000000000016, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.899999999999785, -50.00000000000044, 41.90000000000001, 44.7, 39.90000000000002, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 38.10000000000002, 44.7, 41.90000000000001, 42.10000000000001, 38.90000000000002, 46.099999999999994, 27.699999999999953, -50.00000000000044, 31.900000000000013, 38.90000000000002, -50.00000000000044, -50.00000000000044, 47.3, 43.900000000000006, 26.299999999999933, 39.50000000000002, 41.70000000000002, -50.00000000000044, -50.00000000000044, 38.10000000000002, -50.00000000000044, -50.00000000000044, 37.70000000000003, -50.00000000000044, 7.299999999999663, 43.30000000000001, 41.90000000000001, 42.70000000000001, 36.10000000000004, -50.00000000000044, 35.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 39.90000000000002, -50.00000000000044, 42.500000000000014, 45.3, 46.3, -50.00000000000044, -50.00000000000044, 46.5, 39.10000000000002, -50.00000000000044, 40.30000000000002, 41.90000000000001, -50.00000000000044, 44.300000000000004, -50.00000000000044, 32.50000000000002, 44.900000000000006, 25.099999999999916, 23.099999999999888, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, 43.10000000000001, 45.3, 18.899999999999828, 30.099999999999987, -50.00000000000044], "episode_lengths": [500, 50, 500, 200, 40, 208, 100, 86, 500, 104, 74, 48, 500, 90, 68, 500, 500, 500, 36, 500, 500, 500, 500, 82, 500, 500, 500, 500, 342, 500, 82, 54, 102, 500, 500, 40, 500, 120, 54, 82, 80, 112, 40, 224, 500, 182, 112, 500, 500, 28, 62, 238, 106, 84, 500, 500, 120, 500, 500, 124, 500, 428, 68, 82, 74, 140, 500, 150, 500, 500, 500, 76, 102, 500, 76, 48, 38, 500, 500, 36, 110, 500, 98, 82, 500, 58, 500, 176, 52, 250, 270, 500, 500, 98, 500, 70, 48, 312, 200, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37861238516257856, "mean_inference_ms": 1.2150003121098965, "mean_action_processing_ms": 0.14022396983385216, "mean_env_wait_ms": 0.08418003337974853, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020015954971313477, "StateBufferConnector_ms": 0.008001089096069336, "ViewRequirementAgentConnector_ms": 0.12551045417785645}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.342999999999815, "episode_len_mean": 272.16, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.1, -50.00000000000044, 30.099999999999987, 46.099999999999994, 29.299999999999976, 40.10000000000002, 41.500000000000014, -50.00000000000044, 39.70000000000002, 42.70000000000001, 45.3, -50.00000000000044, 41.100000000000016, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.899999999999785, -50.00000000000044, 41.90000000000001, 44.7, 39.90000000000002, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 38.10000000000002, 44.7, 41.90000000000001, 42.10000000000001, 38.90000000000002, 46.099999999999994, 27.699999999999953, -50.00000000000044, 31.900000000000013, 38.90000000000002, -50.00000000000044, -50.00000000000044, 47.3, 43.900000000000006, 26.299999999999933, 39.50000000000002, 41.70000000000002, -50.00000000000044, -50.00000000000044, 38.10000000000002, -50.00000000000044, -50.00000000000044, 37.70000000000003, -50.00000000000044, 7.299999999999663, 43.30000000000001, 41.90000000000001, 42.70000000000001, 36.10000000000004, -50.00000000000044, 35.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 39.90000000000002, -50.00000000000044, 42.500000000000014, 45.3, 46.3, -50.00000000000044, -50.00000000000044, 46.5, 39.10000000000002, -50.00000000000044, 40.30000000000002, 41.90000000000001, -50.00000000000044, 44.300000000000004, -50.00000000000044, 32.50000000000002, 44.900000000000006, 25.099999999999916, 23.099999999999888, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, 43.10000000000001, 45.3, 18.899999999999828, 30.099999999999987, -50.00000000000044], "episode_lengths": [500, 50, 500, 200, 40, 208, 100, 86, 500, 104, 74, 48, 500, 90, 68, 500, 500, 500, 36, 500, 500, 500, 500, 82, 500, 500, 500, 500, 342, 500, 82, 54, 102, 500, 500, 40, 500, 120, 54, 82, 80, 112, 40, 224, 500, 182, 112, 500, 500, 28, 62, 238, 106, 84, 500, 500, 120, 500, 500, 124, 500, 428, 68, 82, 74, 140, 500, 150, 500, 500, 500, 76, 102, 500, 76, 48, 38, 500, 500, 36, 110, 500, 98, 82, 500, 58, 500, 176, 52, 250, 270, 500, 500, 98, 500, 70, 48, 312, 200, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37861238516257856, "mean_inference_ms": 1.2150003121098965, "mean_action_processing_ms": 0.14022396983385216, "mean_env_wait_ms": 0.08418003337974853, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020015954971313477, "StateBufferConnector_ms": 0.008001089096069336, "ViewRequirementAgentConnector_ms": 0.12551045417785645}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1026000, "num_agent_steps_trained": 1026000, "num_env_steps_sampled": 1026000, "num_env_steps_trained": 1026000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5780.39667864895, "num_env_steps_trained_throughput_per_sec": 5780.39667864895, "timesteps_total": 1026000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1026000, "timers": {"training_iteration_time_ms": 3116.091, "sample_time_ms": 2838.527, "load_time_ms": 20.196, "load_throughput": 891261.005, "learn_time_ms": 245.643, "learn_throughput": 73277.103, "synch_weights_time_ms": 9.3}, "counters": {"num_env_steps_sampled": 1026000, "num_env_steps_trained": 1026000, "num_agent_steps_sampled": 1026000, "num_agent_steps_trained": 1026000}, "done": false, "episodes_total": 3922, "training_iteration": 57, "trial_id": "9f288_00014", "date": "2023-10-25_16-44-55", "timestamp": 1698248695, "time_this_iter_s": 3.1199679374694824, "time_total_s": 180.2450656890869, "pid": 9504, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 180.2450656890869, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 64.15, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.387778780781446e-18, "cur_lr": 0.0003, "total_loss": 6.8376766840616865, "policy_loss": 0.008836216603716215, "vf_loss": 6.8288951714833575, "vf_explained_var": -1.043081283569336e-06, "kl": 7.911157983582957e-05, "entropy": 0.5453295608361562, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 690.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 1044000, "num_env_steps_trained": 1044000, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.646999999999856, "episode_len_mean": 229.22, "episode_media": {}, "episodes_this_iter": 80, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.10000000000002, -50.00000000000044, 40.30000000000002, 41.90000000000001, -50.00000000000044, 44.300000000000004, -50.00000000000044, 32.50000000000002, 44.900000000000006, 25.099999999999916, 23.099999999999888, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, 43.10000000000001, 45.3, 18.899999999999828, 30.099999999999987, -50.00000000000044, -50.00000000000044, 46.699999999999996, 34.10000000000004, 38.700000000000024, 41.90000000000001, -50.00000000000044, 44.5, 39.90000000000002, 32.90000000000003, 22.099999999999874, -50.00000000000044, 46.3, -50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, 44.5, 41.70000000000002, 21.499999999999865, -50.00000000000044, 23.8999999999999, -50.00000000000044, 43.50000000000001, -50.00000000000044, 40.10000000000002, 45.3, 27.299999999999947, 23.099999999999888, 44.300000000000004, -50.00000000000044, 47.1, 46.099999999999994, 36.70000000000003, 43.50000000000001, 39.70000000000002, 45.9, -50.00000000000044, 44.900000000000006, 43.50000000000001, -50.00000000000044, 45.1, 42.10000000000001, 39.300000000000026, 44.7, -50.00000000000044, -50.00000000000044, 44.900000000000006, 46.3, 43.7, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 43.900000000000006, 34.30000000000004, 36.900000000000034, 41.90000000000001, 41.30000000000001, 36.10000000000004, 43.30000000000001, -50.00000000000044, 30.699999999999996, 44.900000000000006, 43.30000000000001, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 45.9, -50.00000000000044, 6.299999999999649, 42.500000000000014, -50.00000000000044, 41.30000000000001, 47.3, 45.9, 46.9], "episode_lengths": [110, 500, 98, 82, 500, 58, 500, 176, 52, 250, 270, 500, 500, 98, 500, 70, 48, 312, 200, 500, 500, 34, 160, 114, 82, 500, 56, 102, 172, 280, 500, 38, 500, 96, 500, 500, 56, 84, 286, 500, 262, 500, 66, 500, 100, 48, 228, 270, 58, 500, 30, 40, 134, 66, 104, 42, 500, 52, 66, 500, 50, 80, 108, 54, 500, 500, 52, 38, 64, 500, 56, 500, 500, 64, 500, 62, 158, 132, 82, 88, 140, 68, 500, 194, 52, 68, 36, 500, 500, 500, 80, 42, 500, 438, 76, 500, 88, 28, 42, 32]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37867478212128963, "mean_inference_ms": 1.2144567279645373, "mean_action_processing_ms": 0.1400227167807264, "mean_env_wait_ms": 0.08406983194196252, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015993833541870117, "StateBufferConnector_ms": 0.0030024051666259766, "ViewRequirementAgentConnector_ms": 0.09600615501403809}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.646999999999856, "episode_len_mean": 229.22, "episodes_this_iter": 80, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [39.10000000000002, -50.00000000000044, 40.30000000000002, 41.90000000000001, -50.00000000000044, 44.300000000000004, -50.00000000000044, 32.50000000000002, 44.900000000000006, 25.099999999999916, 23.099999999999888, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, 43.10000000000001, 45.3, 18.899999999999828, 30.099999999999987, -50.00000000000044, -50.00000000000044, 46.699999999999996, 34.10000000000004, 38.700000000000024, 41.90000000000001, -50.00000000000044, 44.5, 39.90000000000002, 32.90000000000003, 22.099999999999874, -50.00000000000044, 46.3, -50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, 44.5, 41.70000000000002, 21.499999999999865, -50.00000000000044, 23.8999999999999, -50.00000000000044, 43.50000000000001, -50.00000000000044, 40.10000000000002, 45.3, 27.299999999999947, 23.099999999999888, 44.300000000000004, -50.00000000000044, 47.1, 46.099999999999994, 36.70000000000003, 43.50000000000001, 39.70000000000002, 45.9, -50.00000000000044, 44.900000000000006, 43.50000000000001, -50.00000000000044, 45.1, 42.10000000000001, 39.300000000000026, 44.7, -50.00000000000044, -50.00000000000044, 44.900000000000006, 46.3, 43.7, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 43.900000000000006, 34.30000000000004, 36.900000000000034, 41.90000000000001, 41.30000000000001, 36.10000000000004, 43.30000000000001, -50.00000000000044, 30.699999999999996, 44.900000000000006, 43.30000000000001, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 45.9, -50.00000000000044, 6.299999999999649, 42.500000000000014, -50.00000000000044, 41.30000000000001, 47.3, 45.9, 46.9], "episode_lengths": [110, 500, 98, 82, 500, 58, 500, 176, 52, 250, 270, 500, 500, 98, 500, 70, 48, 312, 200, 500, 500, 34, 160, 114, 82, 500, 56, 102, 172, 280, 500, 38, 500, 96, 500, 500, 56, 84, 286, 500, 262, 500, 66, 500, 100, 48, 228, 270, 58, 500, 30, 40, 134, 66, 104, 42, 500, 52, 66, 500, 50, 80, 108, 54, 500, 500, 52, 38, 64, 500, 56, 500, 500, 64, 500, 62, 158, 132, 82, 88, 140, 68, 500, 194, 52, 68, 36, 500, 500, 500, 80, 42, 500, 438, 76, 500, 88, 28, 42, 32]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37867478212128963, "mean_inference_ms": 1.2144567279645373, "mean_action_processing_ms": 0.1400227167807264, "mean_env_wait_ms": 0.08406983194196252, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015993833541870117, "StateBufferConnector_ms": 0.0030024051666259766, "ViewRequirementAgentConnector_ms": 0.09600615501403809}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000, "num_env_steps_sampled": 1044000, "num_env_steps_trained": 1044000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5836.555361503993, "num_env_steps_trained_throughput_per_sec": 5836.555361503993, "timesteps_total": 1044000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1044000, "timers": {"training_iteration_time_ms": 3102.113, "sample_time_ms": 2834.866, "load_time_ms": 19.428, "load_throughput": 926495.998, "learn_time_ms": 235.964, "learn_throughput": 76282.711, "synch_weights_time_ms": 9.551}, "counters": {"num_env_steps_sampled": 1044000, "num_env_steps_trained": 1044000, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000}, "done": false, "episodes_total": 4002, "training_iteration": 58, "trial_id": "9f288_00014", "date": "2023-10-25_16-44-58", "timestamp": 1698248698, "time_this_iter_s": 3.0898187160491943, "time_total_s": 183.3348844051361, "pid": 9504, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 183.3348844051361, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 59.775000000000006, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.93889390390723e-19, "cur_lr": 0.0003, "total_loss": 7.000750621159871, "policy_loss": 0.06220028114815553, "vf_loss": 6.93860677878062, "vf_explained_var": -1.6391277313232422e-06, "kl": 0.0001090493811233273, "entropy": 0.5662870208422343, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 702.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 1062000, "num_env_steps_trained": 1062000, "num_agent_steps_sampled": 1062000, "num_agent_steps_trained": 1062000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.252999999999838, "episode_len_mean": 253.14, "episode_media": {}, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.900000000000006, 46.3, 43.7, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 43.900000000000006, 34.30000000000004, 36.900000000000034, 41.90000000000001, 41.30000000000001, 36.10000000000004, 43.30000000000001, -50.00000000000044, 30.699999999999996, 44.900000000000006, 43.30000000000001, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 45.9, -50.00000000000044, 6.299999999999649, 42.500000000000014, -50.00000000000044, 41.30000000000001, 47.3, 45.9, 46.9, -50.00000000000044, -50.00000000000044, 33.30000000000003, 44.7, -50.00000000000044, 27.299999999999947, 33.30000000000003, 37.90000000000003, 10.099999999999703, -50.00000000000044, 43.7, 11.29999999999972, 27.099999999999945, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, 41.90000000000001, -50.00000000000044, 42.10000000000001, 15.099999999999774, -50.00000000000044, 3.499999999999609, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, 39.10000000000002, -50.00000000000044, 37.10000000000003, -50.00000000000044, 46.699999999999996, -50.00000000000044, 4.499999999999623, 14.499999999999766, 45.9, -50.00000000000044, 37.10000000000003, 33.10000000000003, 39.300000000000026, 18.499999999999822, -50.00000000000044, 42.30000000000001, 31.900000000000013, -50.00000000000044, 38.700000000000024, -50.00000000000044, 43.7, 43.900000000000006, -50.00000000000044, 36.70000000000003, 37.300000000000026, 44.900000000000006, 40.10000000000002, 36.30000000000003, 35.900000000000034, 45.1, 39.10000000000002, 41.30000000000001, 41.100000000000016, 42.900000000000006, 46.3, -50.00000000000044, 35.30000000000004], "episode_lengths": [52, 38, 64, 500, 56, 500, 500, 64, 500, 62, 158, 132, 82, 88, 140, 68, 500, 194, 52, 68, 36, 500, 500, 500, 80, 42, 500, 438, 76, 500, 88, 28, 42, 32, 500, 500, 168, 54, 500, 228, 168, 122, 400, 500, 64, 388, 230, 500, 500, 500, 500, 100, 82, 500, 80, 350, 500, 466, 500, 500, 500, 500, 92, 110, 500, 130, 500, 34, 500, 456, 356, 42, 500, 130, 170, 108, 316, 500, 78, 182, 500, 114, 500, 64, 62, 500, 134, 128, 52, 100, 138, 142, 50, 110, 88, 90, 72, 38, 500, 148]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37890543988339276, "mean_inference_ms": 1.2138498842081713, "mean_action_processing_ms": 0.14022782748503146, "mean_env_wait_ms": 0.0843525922874852, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02098870277404785, "StateBufferConnector_ms": 0.007002115249633789, "ViewRequirementAgentConnector_ms": 0.13999032974243164}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.252999999999838, "episode_len_mean": 253.14, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.900000000000006, 46.3, 43.7, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 43.900000000000006, 34.30000000000004, 36.900000000000034, 41.90000000000001, 41.30000000000001, 36.10000000000004, 43.30000000000001, -50.00000000000044, 30.699999999999996, 44.900000000000006, 43.30000000000001, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 45.9, -50.00000000000044, 6.299999999999649, 42.500000000000014, -50.00000000000044, 41.30000000000001, 47.3, 45.9, 46.9, -50.00000000000044, -50.00000000000044, 33.30000000000003, 44.7, -50.00000000000044, 27.299999999999947, 33.30000000000003, 37.90000000000003, 10.099999999999703, -50.00000000000044, 43.7, 11.29999999999972, 27.099999999999945, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, 41.90000000000001, -50.00000000000044, 42.10000000000001, 15.099999999999774, -50.00000000000044, 3.499999999999609, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, 39.10000000000002, -50.00000000000044, 37.10000000000003, -50.00000000000044, 46.699999999999996, -50.00000000000044, 4.499999999999623, 14.499999999999766, 45.9, -50.00000000000044, 37.10000000000003, 33.10000000000003, 39.300000000000026, 18.499999999999822, -50.00000000000044, 42.30000000000001, 31.900000000000013, -50.00000000000044, 38.700000000000024, -50.00000000000044, 43.7, 43.900000000000006, -50.00000000000044, 36.70000000000003, 37.300000000000026, 44.900000000000006, 40.10000000000002, 36.30000000000003, 35.900000000000034, 45.1, 39.10000000000002, 41.30000000000001, 41.100000000000016, 42.900000000000006, 46.3, -50.00000000000044, 35.30000000000004], "episode_lengths": [52, 38, 64, 500, 56, 500, 500, 64, 500, 62, 158, 132, 82, 88, 140, 68, 500, 194, 52, 68, 36, 500, 500, 500, 80, 42, 500, 438, 76, 500, 88, 28, 42, 32, 500, 500, 168, 54, 500, 228, 168, 122, 400, 500, 64, 388, 230, 500, 500, 500, 500, 100, 82, 500, 80, 350, 500, 466, 500, 500, 500, 500, 92, 110, 500, 130, 500, 34, 500, 456, 356, 42, 500, 130, 170, 108, 316, 500, 78, 182, 500, 114, 500, 64, 62, 500, 134, 128, 52, 100, 138, 142, 50, 110, 88, 90, 72, 38, 500, 148]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37890543988339276, "mean_inference_ms": 1.2138498842081713, "mean_action_processing_ms": 0.14022782748503146, "mean_env_wait_ms": 0.0843525922874852, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02098870277404785, "StateBufferConnector_ms": 0.007002115249633789, "ViewRequirementAgentConnector_ms": 0.13999032974243164}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1062000, "num_agent_steps_trained": 1062000, "num_env_steps_sampled": 1062000, "num_env_steps_trained": 1062000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5556.882856766218, "num_env_steps_trained_throughput_per_sec": 5556.882856766218, "timesteps_total": 1062000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1062000, "timers": {"training_iteration_time_ms": 3116.33, "sample_time_ms": 2833.292, "load_time_ms": 20.046, "load_throughput": 897948.826, "learn_time_ms": 251.327, "learn_throughput": 71619.851, "synch_weights_time_ms": 9.361}, "counters": {"num_env_steps_sampled": 1062000, "num_env_steps_trained": 1062000, "num_agent_steps_sampled": 1062000, "num_agent_steps_trained": 1062000}, "done": false, "episodes_total": 4068, "training_iteration": 59, "trial_id": "9f288_00014", "date": "2023-10-25_16-45-01", "timestamp": 1698248701, "time_this_iter_s": 3.2442233562469482, "time_total_s": 186.57910776138306, "pid": 9504, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 186.57910776138306, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 59.36, "ram_util_percent": 27.22}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.469446951953615e-19, "cur_lr": 0.0003, "total_loss": 7.15824552377065, "policy_loss": 0.04606258807082971, "vf_loss": 7.112239718437195, "vf_explained_var": -1.1771917343139648e-06, "kl": 0.00027178190795969687, "entropy": 0.5684865961472193, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 714.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 1080000, "num_env_steps_trained": 1080000, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000}, "sampler_results": {"episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.569999999999844, "episode_len_mean": 255.0, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 4.499999999999623, 14.499999999999766, 45.9, -50.00000000000044, 37.10000000000003, 33.10000000000003, 39.300000000000026, 18.499999999999822, -50.00000000000044, 42.30000000000001, 31.900000000000013, -50.00000000000044, 38.700000000000024, -50.00000000000044, 43.7, 43.900000000000006, -50.00000000000044, 36.70000000000003, 37.300000000000026, 44.900000000000006, 40.10000000000002, 36.30000000000003, 35.900000000000034, 45.1, 39.10000000000002, 41.30000000000001, 41.100000000000016, 42.900000000000006, 46.3, -50.00000000000044, 35.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.699999999999996, -50.00000000000044, 43.30000000000001, -50.00000000000044, 44.10000000000001, 5.499999999999638, 27.49999999999995, 41.100000000000016, -50.00000000000044, 31.500000000000007, 39.10000000000002, 43.900000000000006, -50.00000000000044, 33.500000000000036, 12.299999999999734, 39.10000000000002, -50.00000000000044, 41.90000000000001, 13.299999999999748, 43.7, 5.899999999999643, -50.00000000000044, 24.69999999999991, 38.90000000000002, 37.70000000000003, 43.7, -50.00000000000044, 37.90000000000003, 46.099999999999994, 41.500000000000014, 10.299999999999706, 42.30000000000001, 12.299999999999734, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, 41.90000000000001, -50.00000000000044, 41.30000000000001, 17.899999999999814, -50.00000000000044, 43.30000000000001, 32.100000000000016, 44.5, 45.1, 28.09999999999996, -50.00000000000044, 39.50000000000002, 46.5, 28.699999999999967, 42.30000000000001, -50.00000000000044, 19.499999999999837, 36.30000000000003, -50.00000000000044, 26.09999999999993, 45.7], "episode_lengths": [500, 456, 356, 42, 500, 130, 170, 108, 316, 500, 78, 182, 500, 114, 500, 64, 62, 500, 134, 128, 52, 100, 138, 142, 50, 110, 88, 90, 72, 38, 500, 148, 500, 500, 500, 194, 500, 68, 500, 60, 446, 226, 90, 500, 186, 110, 62, 500, 166, 378, 110, 500, 82, 368, 64, 442, 500, 254, 112, 124, 64, 500, 122, 40, 86, 398, 78, 378, 52, 500, 500, 500, 500, 500, 56, 500, 500, 88, 500, 82, 500, 88, 322, 500, 68, 180, 56, 50, 220, 500, 106, 36, 214, 78, 500, 306, 138, 500, 240, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37900575125212543, "mean_inference_ms": 1.2106852183230004, "mean_action_processing_ms": 0.13943353065852435, "mean_env_wait_ms": 0.08446353498288701, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02299785614013672, "StateBufferConnector_ms": 0.007019758224487305, "ViewRequirementAgentConnector_ms": 0.13582897186279297}}, "episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.569999999999844, "episode_len_mean": 255.0, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 4.499999999999623, 14.499999999999766, 45.9, -50.00000000000044, 37.10000000000003, 33.10000000000003, 39.300000000000026, 18.499999999999822, -50.00000000000044, 42.30000000000001, 31.900000000000013, -50.00000000000044, 38.700000000000024, -50.00000000000044, 43.7, 43.900000000000006, -50.00000000000044, 36.70000000000003, 37.300000000000026, 44.900000000000006, 40.10000000000002, 36.30000000000003, 35.900000000000034, 45.1, 39.10000000000002, 41.30000000000001, 41.100000000000016, 42.900000000000006, 46.3, -50.00000000000044, 35.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.699999999999996, -50.00000000000044, 43.30000000000001, -50.00000000000044, 44.10000000000001, 5.499999999999638, 27.49999999999995, 41.100000000000016, -50.00000000000044, 31.500000000000007, 39.10000000000002, 43.900000000000006, -50.00000000000044, 33.500000000000036, 12.299999999999734, 39.10000000000002, -50.00000000000044, 41.90000000000001, 13.299999999999748, 43.7, 5.899999999999643, -50.00000000000044, 24.69999999999991, 38.90000000000002, 37.70000000000003, 43.7, -50.00000000000044, 37.90000000000003, 46.099999999999994, 41.500000000000014, 10.299999999999706, 42.30000000000001, 12.299999999999734, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, 41.90000000000001, -50.00000000000044, 41.30000000000001, 17.899999999999814, -50.00000000000044, 43.30000000000001, 32.100000000000016, 44.5, 45.1, 28.09999999999996, -50.00000000000044, 39.50000000000002, 46.5, 28.699999999999967, 42.30000000000001, -50.00000000000044, 19.499999999999837, 36.30000000000003, -50.00000000000044, 26.09999999999993, 45.7], "episode_lengths": [500, 456, 356, 42, 500, 130, 170, 108, 316, 500, 78, 182, 500, 114, 500, 64, 62, 500, 134, 128, 52, 100, 138, 142, 50, 110, 88, 90, 72, 38, 500, 148, 500, 500, 500, 194, 500, 68, 500, 60, 446, 226, 90, 500, 186, 110, 62, 500, 166, 378, 110, 500, 82, 368, 64, 442, 500, 254, 112, 124, 64, 500, 122, 40, 86, 398, 78, 378, 52, 500, 500, 500, 500, 500, 56, 500, 500, 88, 500, 82, 500, 88, 322, 500, 68, 180, 56, 50, 220, 500, 106, 36, 214, 78, 500, 306, 138, 500, 240, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37900575125212543, "mean_inference_ms": 1.2106852183230004, "mean_action_processing_ms": 0.13943353065852435, "mean_env_wait_ms": 0.08446353498288701, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02299785614013672, "StateBufferConnector_ms": 0.007019758224487305, "ViewRequirementAgentConnector_ms": 0.13582897186279297}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000, "num_env_steps_sampled": 1080000, "num_env_steps_trained": 1080000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5845.513921112341, "num_env_steps_trained_throughput_per_sec": 5845.513921112341, "timesteps_total": 1080000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1080000, "timers": {"training_iteration_time_ms": 3117.381, "sample_time_ms": 2830.56, "load_time_ms": 19.959, "load_throughput": 901862.941, "learn_time_ms": 255.076, "learn_throughput": 70567.071, "synch_weights_time_ms": 9.504}, "counters": {"num_env_steps_sampled": 1080000, "num_env_steps_trained": 1080000, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000}, "done": false, "episodes_total": 4136, "training_iteration": 60, "trial_id": "9f288_00014", "date": "2023-10-25_16-45-04", "timestamp": 1698248704, "time_this_iter_s": 3.0852837562561035, "time_total_s": 189.66439151763916, "pid": 9504, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 189.66439151763916, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 59.224999999999994, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.7347234759768074e-19, "cur_lr": 0.0003, "total_loss": 7.141069650650024, "policy_loss": -0.02265751672287782, "vf_loss": 7.163786609967549, "vf_explained_var": -1.2020270029703777e-06, "kl": 0.000367184350077802, "entropy": 0.594836230079333, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 726.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 1098000, "num_env_steps_trained": 1098000, "num_agent_steps_sampled": 1098000, "num_agent_steps_trained": 1098000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.4769999999998324, "episode_len_mean": 260.9, "episode_media": {}, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, 41.90000000000001, -50.00000000000044, 41.30000000000001, 17.899999999999814, -50.00000000000044, 43.30000000000001, 32.100000000000016, 44.5, 45.1, 28.09999999999996, -50.00000000000044, 39.50000000000002, 46.5, 28.699999999999967, 42.30000000000001, -50.00000000000044, 19.499999999999837, 36.30000000000003, -50.00000000000044, 26.09999999999993, 45.7, 9.699999999999697, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 45.3, 12.899999999999743, -50.00000000000044, 42.500000000000014, 8.699999999999683, 31.300000000000004, 20.899999999999856, 34.50000000000004, 33.70000000000004, 44.5, 39.90000000000002, 24.099999999999902, -50.00000000000044, -50.00000000000044, 35.900000000000034, 37.10000000000003, -50.00000000000044, 41.70000000000002, 47.9, 39.70000000000002, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 40.90000000000002, 38.700000000000024, 37.90000000000003, 42.30000000000001, -50.00000000000044, 35.900000000000034, -50.00000000000044, 27.49999999999995, 31.500000000000007, -50.00000000000044, 43.10000000000001, 43.900000000000006, 43.30000000000001, 39.300000000000026, 43.50000000000001, 0.6999999999995694, -50.00000000000044, 47.5, -50.00000000000044, 46.3, 40.70000000000002, 38.700000000000024, 39.10000000000002, -50.00000000000044, 43.900000000000006, 3.0999999999996035, -50.00000000000044, 43.7, 43.30000000000001, 22.49999999999988, 37.50000000000003, 35.70000000000003, -50.00000000000044, 36.900000000000034, 16.29999999999979, -50.00000000000044, 42.30000000000001, 44.300000000000004, 44.300000000000004, -50.00000000000044], "episode_lengths": [500, 500, 500, 500, 500, 56, 500, 500, 88, 500, 82, 500, 88, 322, 500, 68, 180, 56, 50, 220, 500, 106, 36, 214, 78, 500, 306, 138, 500, 240, 44, 404, 500, 38, 500, 500, 48, 372, 500, 76, 414, 188, 292, 156, 164, 56, 102, 260, 500, 500, 142, 130, 500, 84, 22, 104, 500, 82, 500, 500, 92, 114, 122, 78, 500, 142, 500, 226, 186, 500, 70, 62, 68, 108, 66, 494, 500, 26, 500, 38, 94, 114, 110, 500, 62, 470, 500, 64, 68, 276, 126, 144, 500, 132, 338, 500, 78, 58, 58, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3785862317473621, "mean_inference_ms": 1.212235756953676, "mean_action_processing_ms": 0.13993143252748225, "mean_env_wait_ms": 0.08443106719530609, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017008304595947266, "StateBufferConnector_ms": 0.0049991607666015625, "ViewRequirementAgentConnector_ms": 0.1190032958984375}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.4769999999998324, "episode_len_mean": 260.9, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, 41.90000000000001, -50.00000000000044, 41.30000000000001, 17.899999999999814, -50.00000000000044, 43.30000000000001, 32.100000000000016, 44.5, 45.1, 28.09999999999996, -50.00000000000044, 39.50000000000002, 46.5, 28.699999999999967, 42.30000000000001, -50.00000000000044, 19.499999999999837, 36.30000000000003, -50.00000000000044, 26.09999999999993, 45.7, 9.699999999999697, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 45.3, 12.899999999999743, -50.00000000000044, 42.500000000000014, 8.699999999999683, 31.300000000000004, 20.899999999999856, 34.50000000000004, 33.70000000000004, 44.5, 39.90000000000002, 24.099999999999902, -50.00000000000044, -50.00000000000044, 35.900000000000034, 37.10000000000003, -50.00000000000044, 41.70000000000002, 47.9, 39.70000000000002, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 40.90000000000002, 38.700000000000024, 37.90000000000003, 42.30000000000001, -50.00000000000044, 35.900000000000034, -50.00000000000044, 27.49999999999995, 31.500000000000007, -50.00000000000044, 43.10000000000001, 43.900000000000006, 43.30000000000001, 39.300000000000026, 43.50000000000001, 0.6999999999995694, -50.00000000000044, 47.5, -50.00000000000044, 46.3, 40.70000000000002, 38.700000000000024, 39.10000000000002, -50.00000000000044, 43.900000000000006, 3.0999999999996035, -50.00000000000044, 43.7, 43.30000000000001, 22.49999999999988, 37.50000000000003, 35.70000000000003, -50.00000000000044, 36.900000000000034, 16.29999999999979, -50.00000000000044, 42.30000000000001, 44.300000000000004, 44.300000000000004, -50.00000000000044], "episode_lengths": [500, 500, 500, 500, 500, 56, 500, 500, 88, 500, 82, 500, 88, 322, 500, 68, 180, 56, 50, 220, 500, 106, 36, 214, 78, 500, 306, 138, 500, 240, 44, 404, 500, 38, 500, 500, 48, 372, 500, 76, 414, 188, 292, 156, 164, 56, 102, 260, 500, 500, 142, 130, 500, 84, 22, 104, 500, 82, 500, 500, 92, 114, 122, 78, 500, 142, 500, 226, 186, 500, 70, 62, 68, 108, 66, 494, 500, 26, 500, 38, 94, 114, 110, 500, 62, 470, 500, 64, 68, 276, 126, 144, 500, 132, 338, 500, 78, 58, 58, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3785862317473621, "mean_inference_ms": 1.212235756953676, "mean_action_processing_ms": 0.13993143252748225, "mean_env_wait_ms": 0.08443106719530609, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017008304595947266, "StateBufferConnector_ms": 0.0049991607666015625, "ViewRequirementAgentConnector_ms": 0.1190032958984375}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1098000, "num_agent_steps_trained": 1098000, "num_env_steps_sampled": 1098000, "num_env_steps_trained": 1098000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5815.671100847114, "num_env_steps_trained_throughput_per_sec": 5815.671100847114, "timesteps_total": 1098000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1098000, "timers": {"training_iteration_time_ms": 3124.416, "sample_time_ms": 2833.564, "load_time_ms": 20.897, "load_throughput": 861382.114, "learn_time_ms": 258.452, "learn_throughput": 69645.367, "synch_weights_time_ms": 9.423}, "counters": {"num_env_steps_sampled": 1098000, "num_env_steps_trained": 1098000, "num_agent_steps_sampled": 1098000, "num_agent_steps_trained": 1098000}, "done": false, "episodes_total": 4205, "training_iteration": 61, "trial_id": "9f288_00014", "date": "2023-10-25_16-45-07", "timestamp": 1698248707, "time_this_iter_s": 3.1010851860046387, "time_total_s": 192.7654767036438, "pid": 9504, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 192.7654767036438, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 57.580000000000005, "ram_util_percent": 27.22}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.673617379884037e-20, "cur_lr": 0.0003, "total_loss": 7.02741535504659, "policy_loss": -0.0387164152537783, "vf_loss": 7.066192189852397, "vf_explained_var": -1.4702479044596355e-06, "kl": 0.0009751684116755163, "entropy": 0.6030089209477106, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 738.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 1116000, "num_env_steps_trained": 1116000, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.13699999999986, "episode_len_mean": 234.34, "episode_media": {}, "episodes_this_iter": 77, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [47.5, -50.00000000000044, 46.3, 40.70000000000002, 38.700000000000024, 39.10000000000002, -50.00000000000044, 43.900000000000006, 3.0999999999996035, -50.00000000000044, 43.7, 43.30000000000001, 22.49999999999988, 37.50000000000003, 35.70000000000003, -50.00000000000044, 36.900000000000034, 16.29999999999979, -50.00000000000044, 42.30000000000001, 44.300000000000004, 44.300000000000004, -50.00000000000044, 21.699999999999868, 27.699999999999953, 42.10000000000001, 42.10000000000001, -50.00000000000044, 37.70000000000003, 32.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 26.09999999999993, 45.3, 41.100000000000016, 1.299999999999578, 26.299999999999933, 46.9, 44.10000000000001, 43.50000000000001, 37.10000000000003, 44.5, 42.500000000000014, 35.10000000000004, 18.699999999999825, -50.00000000000044, 39.70000000000002, -50.00000000000044, 32.90000000000003, 31.500000000000007, -50.00000000000044, 45.7, 44.10000000000001, -50.00000000000044, -50.00000000000044, 33.90000000000004, 42.70000000000001, 36.30000000000003, 43.900000000000006, 33.90000000000004, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, 43.30000000000001, -50.00000000000044, 32.30000000000002, 44.7, 42.10000000000001, 29.299999999999976, 28.29999999999996, -50.00000000000044, 43.10000000000001, -50.00000000000044, 41.100000000000016, -50.00000000000044, 45.7, 46.099999999999994, -50.00000000000044, 42.30000000000001, 45.5, 40.70000000000002, 41.100000000000016, 20.699999999999854, 41.30000000000001, 44.900000000000006, 44.10000000000001, -50.00000000000044, 37.70000000000003, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.50000000000003, 38.50000000000003, 37.50000000000003], "episode_lengths": [26, 500, 38, 94, 114, 110, 500, 62, 470, 500, 64, 68, 276, 126, 144, 500, 132, 338, 500, 78, 58, 58, 500, 284, 224, 80, 80, 500, 124, 178, 500, 500, 500, 68, 240, 48, 90, 488, 238, 32, 60, 66, 130, 56, 76, 150, 314, 500, 104, 500, 172, 186, 500, 44, 60, 500, 500, 162, 74, 138, 62, 162, 500, 500, 90, 500, 68, 500, 178, 54, 80, 208, 218, 500, 70, 500, 90, 500, 44, 40, 500, 78, 46, 94, 90, 294, 88, 52, 60, 500, 124, 500, 64, 500, 500, 500, 500, 116, 116, 126]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3782255326535438, "mean_inference_ms": 1.21194464341919, "mean_action_processing_ms": 0.13944642059104104, "mean_env_wait_ms": 0.08422165008351935, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018047571182250977, "StateBufferConnector_ms": 0.007059335708618164, "ViewRequirementAgentConnector_ms": 0.10798287391662598}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.13699999999986, "episode_len_mean": 234.34, "episodes_this_iter": 77, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [47.5, -50.00000000000044, 46.3, 40.70000000000002, 38.700000000000024, 39.10000000000002, -50.00000000000044, 43.900000000000006, 3.0999999999996035, -50.00000000000044, 43.7, 43.30000000000001, 22.49999999999988, 37.50000000000003, 35.70000000000003, -50.00000000000044, 36.900000000000034, 16.29999999999979, -50.00000000000044, 42.30000000000001, 44.300000000000004, 44.300000000000004, -50.00000000000044, 21.699999999999868, 27.699999999999953, 42.10000000000001, 42.10000000000001, -50.00000000000044, 37.70000000000003, 32.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 26.09999999999993, 45.3, 41.100000000000016, 1.299999999999578, 26.299999999999933, 46.9, 44.10000000000001, 43.50000000000001, 37.10000000000003, 44.5, 42.500000000000014, 35.10000000000004, 18.699999999999825, -50.00000000000044, 39.70000000000002, -50.00000000000044, 32.90000000000003, 31.500000000000007, -50.00000000000044, 45.7, 44.10000000000001, -50.00000000000044, -50.00000000000044, 33.90000000000004, 42.70000000000001, 36.30000000000003, 43.900000000000006, 33.90000000000004, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, 43.30000000000001, -50.00000000000044, 32.30000000000002, 44.7, 42.10000000000001, 29.299999999999976, 28.29999999999996, -50.00000000000044, 43.10000000000001, -50.00000000000044, 41.100000000000016, -50.00000000000044, 45.7, 46.099999999999994, -50.00000000000044, 42.30000000000001, 45.5, 40.70000000000002, 41.100000000000016, 20.699999999999854, 41.30000000000001, 44.900000000000006, 44.10000000000001, -50.00000000000044, 37.70000000000003, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.50000000000003, 38.50000000000003, 37.50000000000003], "episode_lengths": [26, 500, 38, 94, 114, 110, 500, 62, 470, 500, 64, 68, 276, 126, 144, 500, 132, 338, 500, 78, 58, 58, 500, 284, 224, 80, 80, 500, 124, 178, 500, 500, 500, 68, 240, 48, 90, 488, 238, 32, 60, 66, 130, 56, 76, 150, 314, 500, 104, 500, 172, 186, 500, 44, 60, 500, 500, 162, 74, 138, 62, 162, 500, 500, 90, 500, 68, 500, 178, 54, 80, 208, 218, 500, 70, 500, 90, 500, 44, 40, 500, 78, 46, 94, 90, 294, 88, 52, 60, 500, 124, 500, 64, 500, 500, 500, 500, 116, 116, 126]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3782255326535438, "mean_inference_ms": 1.21194464341919, "mean_action_processing_ms": 0.13944642059104104, "mean_env_wait_ms": 0.08422165008351935, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018047571182250977, "StateBufferConnector_ms": 0.007059335708618164, "ViewRequirementAgentConnector_ms": 0.10798287391662598}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000, "num_env_steps_sampled": 1116000, "num_env_steps_trained": 1116000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5973.256636787252, "num_env_steps_trained_throughput_per_sec": 5973.256636787252, "timesteps_total": 1116000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1116000, "timers": {"training_iteration_time_ms": 3114.719, "sample_time_ms": 2828.614, "load_time_ms": 19.918, "load_throughput": 903725.172, "learn_time_ms": 254.584, "learn_throughput": 70703.519, "synch_weights_time_ms": 9.523}, "counters": {"num_env_steps_sampled": 1116000, "num_env_steps_trained": 1116000, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000}, "done": false, "episodes_total": 4282, "training_iteration": 62, "trial_id": "9f288_00014", "date": "2023-10-25_16-45-10", "timestamp": 1698248710, "time_this_iter_s": 3.0194292068481445, "time_total_s": 195.78490591049194, "pid": 9504, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 195.78490591049194, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 63.475, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.3368086899420186e-20, "cur_lr": 0.0003, "total_loss": 6.88432530562083, "policy_loss": -0.00033850735053420067, "vf_loss": 6.88471535841624, "vf_explained_var": -6.953875223795573e-07, "kl": 0.00010124937498782553, "entropy": 0.5147071952621142, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 750.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 1134000, "num_env_steps_trained": 1134000, "num_agent_steps_sampled": 1134000, "num_agent_steps_trained": 1134000}, "sampler_results": {"episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.812999999999841, "episode_len_mean": 247.52, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.10000000000001, 29.299999999999976, 28.29999999999996, -50.00000000000044, 43.10000000000001, -50.00000000000044, 41.100000000000016, -50.00000000000044, 45.7, 46.099999999999994, -50.00000000000044, 42.30000000000001, 45.5, 40.70000000000002, 41.100000000000016, 20.699999999999854, 41.30000000000001, 44.900000000000006, 44.10000000000001, -50.00000000000044, 37.70000000000003, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.50000000000003, 38.50000000000003, 37.50000000000003, -50.00000000000044, 38.300000000000026, -50.00000000000044, 45.9, 24.299999999999905, 42.10000000000001, 46.3, 41.90000000000001, 42.70000000000001, -50.00000000000044, 44.5, 42.70000000000001, 42.10000000000001, 39.50000000000002, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 27.099999999999945, 29.69999999999998, 37.300000000000026, 29.49999999999998, -50.00000000000044, 34.10000000000004, 45.5, -50.00000000000044, 44.300000000000004, 30.499999999999993, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 44.5, 45.9, -50.00000000000044, 44.300000000000004, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 40.70000000000002, 30.9, -50.00000000000044, 42.70000000000001, 23.099999999999888, 42.70000000000001, -50.00000000000044, 45.3, -50.00000000000044, 9.699999999999697, 45.5, 44.5, 43.50000000000001, -50.00000000000044, 14.299999999999763, 35.70000000000003, 43.50000000000001, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, 39.90000000000002, -50.00000000000044, 43.50000000000001, 40.90000000000002, 43.7, 33.500000000000036, -50.00000000000044], "episode_lengths": [80, 208, 218, 500, 70, 500, 90, 500, 44, 40, 500, 78, 46, 94, 90, 294, 88, 52, 60, 500, 124, 500, 64, 500, 500, 500, 500, 116, 116, 126, 500, 118, 500, 42, 258, 80, 38, 82, 74, 500, 56, 74, 80, 106, 500, 500, 72, 500, 230, 204, 128, 206, 500, 160, 46, 500, 58, 196, 500, 76, 500, 500, 500, 66, 56, 42, 500, 58, 500, 78, 500, 500, 94, 192, 500, 74, 270, 74, 500, 48, 500, 404, 46, 56, 66, 500, 358, 144, 66, 500, 500, 88, 500, 102, 500, 66, 92, 64, 166, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3782014356091005, "mean_inference_ms": 1.2120745385727028, "mean_action_processing_ms": 0.13941673914121708, "mean_env_wait_ms": 0.0841251015499153, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02701115608215332, "StateBufferConnector_ms": 0.0040018558502197266, "ViewRequirementAgentConnector_ms": 0.13101482391357422}}, "episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.812999999999841, "episode_len_mean": 247.52, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.10000000000001, 29.299999999999976, 28.29999999999996, -50.00000000000044, 43.10000000000001, -50.00000000000044, 41.100000000000016, -50.00000000000044, 45.7, 46.099999999999994, -50.00000000000044, 42.30000000000001, 45.5, 40.70000000000002, 41.100000000000016, 20.699999999999854, 41.30000000000001, 44.900000000000006, 44.10000000000001, -50.00000000000044, 37.70000000000003, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.50000000000003, 38.50000000000003, 37.50000000000003, -50.00000000000044, 38.300000000000026, -50.00000000000044, 45.9, 24.299999999999905, 42.10000000000001, 46.3, 41.90000000000001, 42.70000000000001, -50.00000000000044, 44.5, 42.70000000000001, 42.10000000000001, 39.50000000000002, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 27.099999999999945, 29.69999999999998, 37.300000000000026, 29.49999999999998, -50.00000000000044, 34.10000000000004, 45.5, -50.00000000000044, 44.300000000000004, 30.499999999999993, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 44.5, 45.9, -50.00000000000044, 44.300000000000004, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 40.70000000000002, 30.9, -50.00000000000044, 42.70000000000001, 23.099999999999888, 42.70000000000001, -50.00000000000044, 45.3, -50.00000000000044, 9.699999999999697, 45.5, 44.5, 43.50000000000001, -50.00000000000044, 14.299999999999763, 35.70000000000003, 43.50000000000001, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, 39.90000000000002, -50.00000000000044, 43.50000000000001, 40.90000000000002, 43.7, 33.500000000000036, -50.00000000000044], "episode_lengths": [80, 208, 218, 500, 70, 500, 90, 500, 44, 40, 500, 78, 46, 94, 90, 294, 88, 52, 60, 500, 124, 500, 64, 500, 500, 500, 500, 116, 116, 126, 500, 118, 500, 42, 258, 80, 38, 82, 74, 500, 56, 74, 80, 106, 500, 500, 72, 500, 230, 204, 128, 206, 500, 160, 46, 500, 58, 196, 500, 76, 500, 500, 500, 66, 56, 42, 500, 58, 500, 78, 500, 500, 94, 192, 500, 74, 270, 74, 500, 48, 500, 404, 46, 56, 66, 500, 358, 144, 66, 500, 500, 88, 500, 102, 500, 66, 92, 64, 166, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3782014356091005, "mean_inference_ms": 1.2120745385727028, "mean_action_processing_ms": 0.13941673914121708, "mean_env_wait_ms": 0.0841251015499153, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02701115608215332, "StateBufferConnector_ms": 0.0040018558502197266, "ViewRequirementAgentConnector_ms": 0.13101482391357422}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1134000, "num_agent_steps_trained": 1134000, "num_env_steps_sampled": 1134000, "num_env_steps_trained": 1134000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5783.164514172253, "num_env_steps_trained_throughput_per_sec": 5783.164514172253, "timesteps_total": 1134000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1134000, "timers": {"training_iteration_time_ms": 3110.028, "sample_time_ms": 2824.887, "load_time_ms": 20.783, "load_throughput": 866083.736, "learn_time_ms": 252.877, "learn_throughput": 71180.858, "synch_weights_time_ms": 9.601}, "counters": {"num_env_steps_sampled": 1134000, "num_env_steps_trained": 1134000, "num_agent_steps_sampled": 1134000, "num_agent_steps_trained": 1134000}, "done": false, "episodes_total": 4352, "training_iteration": 63, "trial_id": "9f288_00014", "date": "2023-10-25_16-45-13", "timestamp": 1698248713, "time_this_iter_s": 3.1165518760681152, "time_total_s": 198.90145778656006, "pid": 9504, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 198.90145778656006, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 61.150000000000006, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.1684043449710093e-20, "cur_lr": 0.0003, "total_loss": 6.620897690455119, "policy_loss": 0.009737669179836908, "vf_loss": 6.611216227213542, "vf_explained_var": -1.4901161193847656e-06, "kl": 0.0004007866709277626, "entropy": 0.5628749380509058, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 762.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 1152000, "num_env_steps_trained": 1152000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.271999999999817, "episode_len_mean": 267.9, "episode_media": {}, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.9, -50.00000000000044, 44.300000000000004, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 40.70000000000002, 30.9, -50.00000000000044, 42.70000000000001, 23.099999999999888, 42.70000000000001, -50.00000000000044, 45.3, -50.00000000000044, 9.699999999999697, 45.5, 44.5, 43.50000000000001, -50.00000000000044, 14.299999999999763, 35.70000000000003, 43.50000000000001, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, 39.90000000000002, -50.00000000000044, 43.50000000000001, 40.90000000000002, 43.7, 33.500000000000036, -50.00000000000044, -50.00000000000044, 31.70000000000001, -50.00000000000044, 46.3, 46.099999999999994, 40.70000000000002, 43.7, -50.00000000000044, 43.10000000000001, 45.9, 13.699999999999754, -50.00000000000044, 38.50000000000003, -50.00000000000044, 42.10000000000001, -50.00000000000044, 36.70000000000003, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.10000000000002, -50.00000000000044, 47.5, -50.00000000000044, 46.699999999999996, 19.499999999999837, 36.50000000000003, 47.3, 31.900000000000013, 27.49999999999995, 30.9, -50.00000000000044, -50.00000000000044, 45.5, 42.900000000000006, -50.00000000000044, 16.699999999999797, 35.500000000000036, 38.90000000000002, 11.29999999999972, -50.00000000000044, 44.5, 42.30000000000001, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 45.1, 35.30000000000004, -50.00000000000044, 46.3, -50.00000000000044, 43.7, 10.499999999999709, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, 47.5, 19.499999999999837, 45.1, 39.90000000000002], "episode_lengths": [42, 500, 58, 500, 78, 500, 500, 94, 192, 500, 74, 270, 74, 500, 48, 500, 404, 46, 56, 66, 500, 358, 144, 66, 500, 500, 88, 500, 102, 500, 66, 92, 64, 166, 500, 500, 184, 500, 38, 40, 94, 64, 500, 70, 42, 364, 500, 116, 500, 80, 500, 134, 52, 500, 500, 500, 500, 120, 500, 26, 500, 34, 306, 136, 28, 182, 226, 192, 500, 500, 46, 72, 500, 334, 146, 112, 388, 500, 56, 78, 500, 500, 88, 500, 500, 50, 148, 500, 38, 500, 64, 396, 500, 500, 500, 114, 26, 306, 50, 102]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37835410972030475, "mean_inference_ms": 1.2121272309603792, "mean_action_processing_ms": 0.1396550002507484, "mean_env_wait_ms": 0.08411284515058473, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030993938446044922, "StateBufferConnector_ms": 0.0049991607666015625, "ViewRequirementAgentConnector_ms": 0.14101433753967285}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.271999999999817, "episode_len_mean": 267.9, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.9, -50.00000000000044, 44.300000000000004, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 40.70000000000002, 30.9, -50.00000000000044, 42.70000000000001, 23.099999999999888, 42.70000000000001, -50.00000000000044, 45.3, -50.00000000000044, 9.699999999999697, 45.5, 44.5, 43.50000000000001, -50.00000000000044, 14.299999999999763, 35.70000000000003, 43.50000000000001, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, 39.90000000000002, -50.00000000000044, 43.50000000000001, 40.90000000000002, 43.7, 33.500000000000036, -50.00000000000044, -50.00000000000044, 31.70000000000001, -50.00000000000044, 46.3, 46.099999999999994, 40.70000000000002, 43.7, -50.00000000000044, 43.10000000000001, 45.9, 13.699999999999754, -50.00000000000044, 38.50000000000003, -50.00000000000044, 42.10000000000001, -50.00000000000044, 36.70000000000003, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.10000000000002, -50.00000000000044, 47.5, -50.00000000000044, 46.699999999999996, 19.499999999999837, 36.50000000000003, 47.3, 31.900000000000013, 27.49999999999995, 30.9, -50.00000000000044, -50.00000000000044, 45.5, 42.900000000000006, -50.00000000000044, 16.699999999999797, 35.500000000000036, 38.90000000000002, 11.29999999999972, -50.00000000000044, 44.5, 42.30000000000001, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 45.1, 35.30000000000004, -50.00000000000044, 46.3, -50.00000000000044, 43.7, 10.499999999999709, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, 47.5, 19.499999999999837, 45.1, 39.90000000000002], "episode_lengths": [42, 500, 58, 500, 78, 500, 500, 94, 192, 500, 74, 270, 74, 500, 48, 500, 404, 46, 56, 66, 500, 358, 144, 66, 500, 500, 88, 500, 102, 500, 66, 92, 64, 166, 500, 500, 184, 500, 38, 40, 94, 64, 500, 70, 42, 364, 500, 116, 500, 80, 500, 134, 52, 500, 500, 500, 500, 120, 500, 26, 500, 34, 306, 136, 28, 182, 226, 192, 500, 500, 46, 72, 500, 334, 146, 112, 388, 500, 56, 78, 500, 500, 88, 500, 500, 50, 148, 500, 38, 500, 64, 396, 500, 500, 500, 114, 26, 306, 50, 102]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37835410972030475, "mean_inference_ms": 1.2121272309603792, "mean_action_processing_ms": 0.1396550002507484, "mean_env_wait_ms": 0.08411284515058473, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030993938446044922, "StateBufferConnector_ms": 0.0049991607666015625, "ViewRequirementAgentConnector_ms": 0.14101433753967285}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000, "num_env_steps_sampled": 1152000, "num_env_steps_trained": 1152000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5800.81575262342, "num_env_steps_trained_throughput_per_sec": 5800.81575262342, "timesteps_total": 1152000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1152000, "timers": {"training_iteration_time_ms": 3111.785, "sample_time_ms": 2826.659, "load_time_ms": 20.888, "load_throughput": 861754.751, "learn_time_ms": 252.633, "learn_throughput": 71249.559, "synch_weights_time_ms": 9.626}, "counters": {"num_env_steps_sampled": 1152000, "num_env_steps_trained": 1152000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "done": false, "episodes_total": 4417, "training_iteration": 64, "trial_id": "9f288_00014", "date": "2023-10-25_16-45-17", "timestamp": 1698248717, "time_this_iter_s": 3.107701063156128, "time_total_s": 202.0091588497162, "pid": 9504, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 202.0091588497162, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 57.779999999999994, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.0842021724855046e-20, "cur_lr": 0.0003, "total_loss": 6.907355904579163, "policy_loss": -0.016181451889375847, "vf_loss": 6.923596302668254, "vf_explained_var": -7.748603820800781e-07, "kl": 0.0002079101879098507, "entropy": 0.5904251883427302, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 774.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 1170000, "num_env_steps_trained": 1170000, "num_agent_steps_sampled": 1170000, "num_agent_steps_trained": 1170000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.719999999999839, "episode_len_mean": 253.46, "episode_media": {}, "episodes_this_iter": 77, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.5, 42.30000000000001, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 45.1, 35.30000000000004, -50.00000000000044, 46.3, -50.00000000000044, 43.7, 10.499999999999709, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, 47.5, 19.499999999999837, 45.1, 39.90000000000002, 30.699999999999996, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 45.5, 42.70000000000001, -50.00000000000044, 39.50000000000002, 42.10000000000001, -50.00000000000044, -50.00000000000044, 24.299999999999905, 8.699999999999683, 38.300000000000026, 44.5, -50.00000000000044, -50.00000000000044, 44.7, 44.10000000000001, 44.300000000000004, 29.899999999999984, 25.099999999999916, -50.00000000000044, 39.70000000000002, 41.70000000000002, 40.90000000000002, -50.00000000000044, 43.30000000000001, 31.70000000000001, 24.69999999999991, 43.30000000000001, 43.30000000000001, -50.00000000000044, 45.9, -50.00000000000044, 43.50000000000001, -50.00000000000044, 46.3, 0.2999999999995637, 32.100000000000016, 47.5, -50.00000000000044, 30.29999999999999, 41.90000000000001, 46.699999999999996, 36.70000000000003, 29.49999999999998, 37.300000000000026, 43.30000000000001, 41.90000000000001, -50.00000000000044, 38.300000000000026, -50.00000000000044, 36.50000000000003, -50.00000000000044, -50.00000000000044, 1.6999999999995836, -50.00000000000044, 41.30000000000001, 43.30000000000001, 33.10000000000003, 41.70000000000002, 45.9, 30.099999999999987, -50.00000000000044, 43.900000000000006, -50.00000000000044, 43.30000000000001, -50.00000000000044, 34.900000000000034, 40.90000000000002, -50.00000000000044, 38.300000000000026, 36.10000000000004, -50.00000000000044, 40.70000000000002], "episode_lengths": [500, 56, 78, 500, 500, 88, 500, 500, 50, 148, 500, 38, 500, 64, 396, 500, 500, 500, 114, 26, 306, 50, 102, 194, 500, 40, 500, 500, 46, 74, 500, 106, 80, 500, 500, 258, 414, 118, 56, 500, 500, 54, 60, 58, 202, 250, 500, 104, 84, 92, 500, 68, 184, 254, 68, 68, 500, 42, 500, 66, 500, 38, 498, 180, 26, 500, 198, 82, 34, 134, 206, 128, 68, 82, 500, 118, 500, 136, 500, 500, 484, 500, 88, 68, 170, 84, 42, 200, 500, 62, 500, 68, 500, 152, 92, 500, 118, 140, 500, 94]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3782069391833855, "mean_inference_ms": 1.2108661005188903, "mean_action_processing_ms": 0.13944055684588352, "mean_env_wait_ms": 0.08417281913574876, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024863004684448242, "StateBufferConnector_ms": 0.008997440338134766, "ViewRequirementAgentConnector_ms": 0.11793780326843262}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.719999999999839, "episode_len_mean": 253.46, "episodes_this_iter": 77, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.5, 42.30000000000001, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 45.1, 35.30000000000004, -50.00000000000044, 46.3, -50.00000000000044, 43.7, 10.499999999999709, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, 47.5, 19.499999999999837, 45.1, 39.90000000000002, 30.699999999999996, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 45.5, 42.70000000000001, -50.00000000000044, 39.50000000000002, 42.10000000000001, -50.00000000000044, -50.00000000000044, 24.299999999999905, 8.699999999999683, 38.300000000000026, 44.5, -50.00000000000044, -50.00000000000044, 44.7, 44.10000000000001, 44.300000000000004, 29.899999999999984, 25.099999999999916, -50.00000000000044, 39.70000000000002, 41.70000000000002, 40.90000000000002, -50.00000000000044, 43.30000000000001, 31.70000000000001, 24.69999999999991, 43.30000000000001, 43.30000000000001, -50.00000000000044, 45.9, -50.00000000000044, 43.50000000000001, -50.00000000000044, 46.3, 0.2999999999995637, 32.100000000000016, 47.5, -50.00000000000044, 30.29999999999999, 41.90000000000001, 46.699999999999996, 36.70000000000003, 29.49999999999998, 37.300000000000026, 43.30000000000001, 41.90000000000001, -50.00000000000044, 38.300000000000026, -50.00000000000044, 36.50000000000003, -50.00000000000044, -50.00000000000044, 1.6999999999995836, -50.00000000000044, 41.30000000000001, 43.30000000000001, 33.10000000000003, 41.70000000000002, 45.9, 30.099999999999987, -50.00000000000044, 43.900000000000006, -50.00000000000044, 43.30000000000001, -50.00000000000044, 34.900000000000034, 40.90000000000002, -50.00000000000044, 38.300000000000026, 36.10000000000004, -50.00000000000044, 40.70000000000002], "episode_lengths": [500, 56, 78, 500, 500, 88, 500, 500, 50, 148, 500, 38, 500, 64, 396, 500, 500, 500, 114, 26, 306, 50, 102, 194, 500, 40, 500, 500, 46, 74, 500, 106, 80, 500, 500, 258, 414, 118, 56, 500, 500, 54, 60, 58, 202, 250, 500, 104, 84, 92, 500, 68, 184, 254, 68, 68, 500, 42, 500, 66, 500, 38, 498, 180, 26, 500, 198, 82, 34, 134, 206, 128, 68, 82, 500, 118, 500, 136, 500, 500, 484, 500, 88, 68, 170, 84, 42, 200, 500, 62, 500, 68, 500, 152, 92, 500, 118, 140, 500, 94]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3782069391833855, "mean_inference_ms": 1.2108661005188903, "mean_action_processing_ms": 0.13944055684588352, "mean_env_wait_ms": 0.08417281913574876, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024863004684448242, "StateBufferConnector_ms": 0.008997440338134766, "ViewRequirementAgentConnector_ms": 0.11793780326843262}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1170000, "num_agent_steps_trained": 1170000, "num_env_steps_sampled": 1170000, "num_env_steps_trained": 1170000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5921.796257817131, "num_env_steps_trained_throughput_per_sec": 5921.796257817131, "timesteps_total": 1170000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1170000, "timers": {"training_iteration_time_ms": 3091.402, "sample_time_ms": 2819.11, "load_time_ms": 20.808, "load_throughput": 865038.796, "learn_time_ms": 239.866, "learn_throughput": 75041.878, "synch_weights_time_ms": 9.637}, "counters": {"num_env_steps_sampled": 1170000, "num_env_steps_trained": 1170000, "num_agent_steps_sampled": 1170000, "num_agent_steps_trained": 1170000}, "done": false, "episodes_total": 4494, "training_iteration": 65, "trial_id": "9f288_00014", "date": "2023-10-25_16-45-20", "timestamp": 1698248720, "time_this_iter_s": 3.0493931770324707, "time_total_s": 205.05855202674866, "pid": 9504, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 205.05855202674866, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 63.675, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.421010862427523e-21, "cur_lr": 0.0003, "total_loss": 6.8674620389938354, "policy_loss": -0.007069986313581467, "vf_loss": 6.8745895226796465, "vf_explained_var": -4.0729840596516925e-07, "kl": 0.00022826816675092232, "entropy": 0.5751915574073792, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 786.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 1188000, "num_env_steps_trained": 1188000, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.106999999999817, "episode_len_mean": 274.56, "episode_media": {}, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.3, 0.2999999999995637, 32.100000000000016, 47.5, -50.00000000000044, 30.29999999999999, 41.90000000000001, 46.699999999999996, 36.70000000000003, 29.49999999999998, 37.300000000000026, 43.30000000000001, 41.90000000000001, -50.00000000000044, 38.300000000000026, -50.00000000000044, 36.50000000000003, -50.00000000000044, -50.00000000000044, 1.6999999999995836, -50.00000000000044, 41.30000000000001, 43.30000000000001, 33.10000000000003, 41.70000000000002, 45.9, 30.099999999999987, -50.00000000000044, 43.900000000000006, -50.00000000000044, 43.30000000000001, -50.00000000000044, 34.900000000000034, 40.90000000000002, -50.00000000000044, 38.300000000000026, 36.10000000000004, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, 38.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.69999999999981, -50.00000000000044, 39.300000000000026, -50.00000000000044, 43.50000000000001, -50.00000000000044, 44.300000000000004, 47.1, 45.9, -50.00000000000044, 44.10000000000001, 43.900000000000006, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 42.70000000000001, -50.00000000000044, -50.00000000000044, 34.10000000000004, -50.00000000000044, -50.00000000000044, 44.5, 27.899999999999956, 42.900000000000006, -50.00000000000044, 45.3, 18.099999999999817, -50.00000000000044, 10.099999999999703, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 11.099999999999717, 46.699999999999996, 38.10000000000002, 15.699999999999783, 37.300000000000026, 41.30000000000001, 33.30000000000003, 19.69999999999984, 27.099999999999945, 41.90000000000001, 25.499999999999922, 25.29999999999992, 42.500000000000014, 30.499999999999993, -50.00000000000044, -50.00000000000044, 42.500000000000014], "episode_lengths": [38, 498, 180, 26, 500, 198, 82, 34, 134, 206, 128, 68, 82, 500, 118, 500, 136, 500, 500, 484, 500, 88, 68, 170, 84, 42, 200, 500, 62, 500, 68, 500, 152, 92, 500, 118, 140, 500, 94, 500, 500, 114, 500, 500, 500, 500, 324, 500, 108, 500, 66, 500, 58, 30, 42, 500, 60, 62, 102, 500, 500, 500, 66, 74, 500, 500, 160, 500, 500, 56, 222, 72, 500, 48, 320, 500, 400, 500, 500, 52, 500, 500, 500, 390, 34, 120, 344, 128, 88, 168, 304, 230, 82, 246, 248, 76, 196, 500, 500, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37810892225980036, "mean_inference_ms": 1.2115132808629365, "mean_action_processing_ms": 0.14013628862942595, "mean_env_wait_ms": 0.08416242868102693, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021862030029296875, "StateBufferConnector_ms": 0.005999326705932617, "ViewRequirementAgentConnector_ms": 0.12393021583557129}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.106999999999817, "episode_len_mean": 274.56, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.3, 0.2999999999995637, 32.100000000000016, 47.5, -50.00000000000044, 30.29999999999999, 41.90000000000001, 46.699999999999996, 36.70000000000003, 29.49999999999998, 37.300000000000026, 43.30000000000001, 41.90000000000001, -50.00000000000044, 38.300000000000026, -50.00000000000044, 36.50000000000003, -50.00000000000044, -50.00000000000044, 1.6999999999995836, -50.00000000000044, 41.30000000000001, 43.30000000000001, 33.10000000000003, 41.70000000000002, 45.9, 30.099999999999987, -50.00000000000044, 43.900000000000006, -50.00000000000044, 43.30000000000001, -50.00000000000044, 34.900000000000034, 40.90000000000002, -50.00000000000044, 38.300000000000026, 36.10000000000004, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, 38.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.69999999999981, -50.00000000000044, 39.300000000000026, -50.00000000000044, 43.50000000000001, -50.00000000000044, 44.300000000000004, 47.1, 45.9, -50.00000000000044, 44.10000000000001, 43.900000000000006, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 42.70000000000001, -50.00000000000044, -50.00000000000044, 34.10000000000004, -50.00000000000044, -50.00000000000044, 44.5, 27.899999999999956, 42.900000000000006, -50.00000000000044, 45.3, 18.099999999999817, -50.00000000000044, 10.099999999999703, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 11.099999999999717, 46.699999999999996, 38.10000000000002, 15.699999999999783, 37.300000000000026, 41.30000000000001, 33.30000000000003, 19.69999999999984, 27.099999999999945, 41.90000000000001, 25.499999999999922, 25.29999999999992, 42.500000000000014, 30.499999999999993, -50.00000000000044, -50.00000000000044, 42.500000000000014], "episode_lengths": [38, 498, 180, 26, 500, 198, 82, 34, 134, 206, 128, 68, 82, 500, 118, 500, 136, 500, 500, 484, 500, 88, 68, 170, 84, 42, 200, 500, 62, 500, 68, 500, 152, 92, 500, 118, 140, 500, 94, 500, 500, 114, 500, 500, 500, 500, 324, 500, 108, 500, 66, 500, 58, 30, 42, 500, 60, 62, 102, 500, 500, 500, 66, 74, 500, 500, 160, 500, 500, 56, 222, 72, 500, 48, 320, 500, 400, 500, 500, 52, 500, 500, 500, 390, 34, 120, 344, 128, 88, 168, 304, 230, 82, 246, 248, 76, 196, 500, 500, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37810892225980036, "mean_inference_ms": 1.2115132808629365, "mean_action_processing_ms": 0.14013628862942595, "mean_env_wait_ms": 0.08416242868102693, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021862030029296875, "StateBufferConnector_ms": 0.005999326705932617, "ViewRequirementAgentConnector_ms": 0.12393021583557129}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000, "num_env_steps_sampled": 1188000, "num_env_steps_trained": 1188000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5357.897311856459, "num_env_steps_trained_throughput_per_sec": 5357.897311856459, "timesteps_total": 1188000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1188000, "timers": {"training_iteration_time_ms": 3123.765, "sample_time_ms": 2853.085, "load_time_ms": 20.799, "load_throughput": 865419.565, "learn_time_ms": 238.36, "learn_throughput": 75515.958, "synch_weights_time_ms": 9.64}, "counters": {"num_env_steps_sampled": 1188000, "num_env_steps_trained": 1188000, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000}, "done": false, "episodes_total": 4555, "training_iteration": 66, "trial_id": "9f288_00014", "date": "2023-10-25_16-45-23", "timestamp": 1698248723, "time_this_iter_s": 3.3645212650299072, "time_total_s": 208.42307329177856, "pid": 9504, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 208.42307329177856, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 53.839999999999996, "ram_util_percent": 27.22}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.7105054312137616e-21, "cur_lr": 0.0003, "total_loss": 6.58013919989268, "policy_loss": -0.01324030632774035, "vf_loss": 6.593433578809102, "vf_explained_var": -8.443991343180339e-08, "kl": 0.00046790125930821586, "entropy": 0.5407679006457329, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 798.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 1206000, "num_env_steps_trained": 1206000, "num_agent_steps_sampled": 1206000, "num_agent_steps_trained": 1206000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.227999999999823, "episode_len_mean": 268.36, "episode_media": {}, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 44.5, 27.899999999999956, 42.900000000000006, -50.00000000000044, 45.3, 18.099999999999817, -50.00000000000044, 10.099999999999703, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 11.099999999999717, 46.699999999999996, 38.10000000000002, 15.699999999999783, 37.300000000000026, 41.30000000000001, 33.30000000000003, 19.69999999999984, 27.099999999999945, 41.90000000000001, 25.499999999999922, 25.29999999999992, 42.500000000000014, 30.499999999999993, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 45.7, -50.00000000000044, 16.09999999999979, 45.3, 9.499999999999694, -50.00000000000044, -50.00000000000044, 44.5, 28.499999999999964, -50.00000000000044, -50.00000000000044, 37.90000000000003, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, 30.29999999999999, 45.7, 44.5, 39.300000000000026, -50.00000000000044, -50.00000000000044, 41.90000000000001, 38.90000000000002, 27.099999999999945, 45.1, 43.10000000000001, 23.29999999999989, 44.7, 42.70000000000001, 37.90000000000003, -50.00000000000044, 45.3, 44.300000000000004, 36.10000000000004, 46.099999999999994, 43.900000000000006, -50.00000000000044, 46.699999999999996, 24.899999999999913, 42.70000000000001, 31.900000000000013, -50.00000000000044, 40.500000000000014, -50.00000000000044, 19.09999999999983, 29.299999999999976, -50.00000000000044, 45.7, -50.00000000000044, 39.10000000000002, 45.3, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 44.10000000000001, 41.500000000000014, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, 44.5], "episode_lengths": [500, 500, 56, 222, 72, 500, 48, 320, 500, 400, 500, 500, 52, 500, 500, 500, 390, 34, 120, 344, 128, 88, 168, 304, 230, 82, 246, 248, 76, 196, 500, 500, 76, 500, 44, 500, 340, 48, 406, 500, 500, 56, 216, 500, 500, 122, 500, 74, 500, 500, 500, 88, 500, 198, 44, 56, 108, 500, 500, 82, 112, 230, 50, 70, 268, 54, 74, 122, 500, 48, 58, 140, 40, 62, 500, 34, 252, 74, 182, 500, 96, 500, 310, 208, 500, 44, 500, 110, 48, 500, 500, 68, 500, 60, 86, 500, 98, 500, 500, 56]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37799898932294873, "mean_inference_ms": 1.211487672946666, "mean_action_processing_ms": 0.14025389241201772, "mean_env_wait_ms": 0.08404077361247986, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02399730682373047, "StateBufferConnector_ms": 0.005002021789550781, "ViewRequirementAgentConnector_ms": 0.10000467300415039}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.227999999999823, "episode_len_mean": 268.36, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 44.5, 27.899999999999956, 42.900000000000006, -50.00000000000044, 45.3, 18.099999999999817, -50.00000000000044, 10.099999999999703, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 11.099999999999717, 46.699999999999996, 38.10000000000002, 15.699999999999783, 37.300000000000026, 41.30000000000001, 33.30000000000003, 19.69999999999984, 27.099999999999945, 41.90000000000001, 25.499999999999922, 25.29999999999992, 42.500000000000014, 30.499999999999993, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 45.7, -50.00000000000044, 16.09999999999979, 45.3, 9.499999999999694, -50.00000000000044, -50.00000000000044, 44.5, 28.499999999999964, -50.00000000000044, -50.00000000000044, 37.90000000000003, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, 30.29999999999999, 45.7, 44.5, 39.300000000000026, -50.00000000000044, -50.00000000000044, 41.90000000000001, 38.90000000000002, 27.099999999999945, 45.1, 43.10000000000001, 23.29999999999989, 44.7, 42.70000000000001, 37.90000000000003, -50.00000000000044, 45.3, 44.300000000000004, 36.10000000000004, 46.099999999999994, 43.900000000000006, -50.00000000000044, 46.699999999999996, 24.899999999999913, 42.70000000000001, 31.900000000000013, -50.00000000000044, 40.500000000000014, -50.00000000000044, 19.09999999999983, 29.299999999999976, -50.00000000000044, 45.7, -50.00000000000044, 39.10000000000002, 45.3, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 44.10000000000001, 41.500000000000014, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, 44.5], "episode_lengths": [500, 500, 56, 222, 72, 500, 48, 320, 500, 400, 500, 500, 52, 500, 500, 500, 390, 34, 120, 344, 128, 88, 168, 304, 230, 82, 246, 248, 76, 196, 500, 500, 76, 500, 44, 500, 340, 48, 406, 500, 500, 56, 216, 500, 500, 122, 500, 74, 500, 500, 500, 88, 500, 198, 44, 56, 108, 500, 500, 82, 112, 230, 50, 70, 268, 54, 74, 122, 500, 48, 58, 140, 40, 62, 500, 34, 252, 74, 182, 500, 96, 500, 310, 208, 500, 44, 500, 110, 48, 500, 500, 68, 500, 60, 86, 500, 98, 500, 500, 56]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37799898932294873, "mean_inference_ms": 1.211487672946666, "mean_action_processing_ms": 0.14025389241201772, "mean_env_wait_ms": 0.08404077361247986, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02399730682373047, "StateBufferConnector_ms": 0.005002021789550781, "ViewRequirementAgentConnector_ms": 0.10000467300415039}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1206000, "num_agent_steps_trained": 1206000, "num_env_steps_sampled": 1206000, "num_env_steps_trained": 1206000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5860.809118389126, "num_env_steps_trained_throughput_per_sec": 5860.809118389126, "timesteps_total": 1206000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1206000, "timers": {"training_iteration_time_ms": 3119.493, "sample_time_ms": 2857.515, "load_time_ms": 19.569, "load_throughput": 919799.026, "learn_time_ms": 230.83, "learn_throughput": 77979.537, "synch_weights_time_ms": 9.528}, "counters": {"num_env_steps_sampled": 1206000, "num_env_steps_trained": 1206000, "num_agent_steps_sampled": 1206000, "num_agent_steps_trained": 1206000}, "done": false, "episodes_total": 4622, "training_iteration": 67, "trial_id": "9f288_00014", "date": "2023-10-25_16-45-26", "timestamp": 1698248726, "time_this_iter_s": 3.0780997276306152, "time_total_s": 211.50117301940918, "pid": 9504, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 211.50117301940918, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 64.875, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.3552527156068808e-21, "cur_lr": 0.0003, "total_loss": 7.02457610766093, "policy_loss": 0.009572396675745646, "vf_loss": 7.015056252479553, "vf_explained_var": -1.3907750447591145e-06, "kl": 0.000600417403774145, "entropy": 0.5251517941554388, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 810.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 1224000, "num_env_steps_trained": 1224000, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.052999999999834, "episode_len_mean": 255.12, "episode_media": {}, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [24.899999999999913, 42.70000000000001, 31.900000000000013, -50.00000000000044, 40.500000000000014, -50.00000000000044, 19.09999999999983, 29.299999999999976, -50.00000000000044, 45.7, -50.00000000000044, 39.10000000000002, 45.3, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 44.10000000000001, 41.500000000000014, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, 7.499999999999666, 47.3, 42.900000000000006, 46.699999999999996, -50.00000000000044, -50.00000000000044, 19.299999999999834, -50.00000000000044, 38.50000000000003, 25.29999999999992, -50.00000000000044, 45.1, -50.00000000000044, 33.10000000000003, 33.30000000000003, 43.7, -50.00000000000044, 39.10000000000002, 18.899999999999828, 46.099999999999994, 24.499999999999908, 38.90000000000002, 43.50000000000001, -50.00000000000044, 38.50000000000003, -50.00000000000044, 27.899999999999956, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.10000000000004, -50.00000000000044, -50.00000000000044, 45.5, 46.3, 44.900000000000006, 10.699999999999712, 26.09999999999993, 36.10000000000004, 46.699999999999996, 32.90000000000003, 46.3, 46.099999999999994, 42.900000000000006, -50.00000000000044, 37.10000000000003, 37.90000000000003, 46.3, 32.50000000000002, -50.00000000000044, 37.70000000000003, -50.00000000000044, -50.00000000000044, 31.900000000000013, -50.00000000000044, 30.099999999999987, 46.9, 39.50000000000002, 20.699999999999854, 41.30000000000001, 44.900000000000006, 47.3, 43.7, -50.00000000000044, 43.7, 47.1, -50.00000000000044, 46.3, 43.7], "episode_lengths": [252, 74, 182, 500, 96, 500, 310, 208, 500, 44, 500, 110, 48, 500, 500, 68, 500, 60, 86, 500, 98, 500, 500, 56, 500, 500, 500, 100, 426, 28, 72, 34, 500, 500, 308, 500, 116, 248, 500, 50, 500, 170, 168, 64, 500, 110, 312, 40, 256, 112, 66, 500, 116, 500, 222, 54, 500, 500, 500, 500, 500, 150, 500, 500, 46, 38, 52, 394, 240, 140, 34, 172, 38, 40, 72, 500, 130, 122, 38, 176, 500, 124, 500, 500, 182, 500, 200, 32, 106, 294, 88, 52, 28, 64, 500, 64, 30, 500, 38, 64]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37800713290394955, "mean_inference_ms": 1.2094221531797695, "mean_action_processing_ms": 0.13954628343114703, "mean_env_wait_ms": 0.08423443239272106, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02400493621826172, "StateBufferConnector_ms": 0.004000425338745117, "ViewRequirementAgentConnector_ms": 0.11028075218200684}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.052999999999834, "episode_len_mean": 255.12, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [24.899999999999913, 42.70000000000001, 31.900000000000013, -50.00000000000044, 40.500000000000014, -50.00000000000044, 19.09999999999983, 29.299999999999976, -50.00000000000044, 45.7, -50.00000000000044, 39.10000000000002, 45.3, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 44.10000000000001, 41.500000000000014, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, 7.499999999999666, 47.3, 42.900000000000006, 46.699999999999996, -50.00000000000044, -50.00000000000044, 19.299999999999834, -50.00000000000044, 38.50000000000003, 25.29999999999992, -50.00000000000044, 45.1, -50.00000000000044, 33.10000000000003, 33.30000000000003, 43.7, -50.00000000000044, 39.10000000000002, 18.899999999999828, 46.099999999999994, 24.499999999999908, 38.90000000000002, 43.50000000000001, -50.00000000000044, 38.50000000000003, -50.00000000000044, 27.899999999999956, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.10000000000004, -50.00000000000044, -50.00000000000044, 45.5, 46.3, 44.900000000000006, 10.699999999999712, 26.09999999999993, 36.10000000000004, 46.699999999999996, 32.90000000000003, 46.3, 46.099999999999994, 42.900000000000006, -50.00000000000044, 37.10000000000003, 37.90000000000003, 46.3, 32.50000000000002, -50.00000000000044, 37.70000000000003, -50.00000000000044, -50.00000000000044, 31.900000000000013, -50.00000000000044, 30.099999999999987, 46.9, 39.50000000000002, 20.699999999999854, 41.30000000000001, 44.900000000000006, 47.3, 43.7, -50.00000000000044, 43.7, 47.1, -50.00000000000044, 46.3, 43.7], "episode_lengths": [252, 74, 182, 500, 96, 500, 310, 208, 500, 44, 500, 110, 48, 500, 500, 68, 500, 60, 86, 500, 98, 500, 500, 56, 500, 500, 500, 100, 426, 28, 72, 34, 500, 500, 308, 500, 116, 248, 500, 50, 500, 170, 168, 64, 500, 110, 312, 40, 256, 112, 66, 500, 116, 500, 222, 54, 500, 500, 500, 500, 500, 150, 500, 500, 46, 38, 52, 394, 240, 140, 34, 172, 38, 40, 72, 500, 130, 122, 38, 176, 500, 124, 500, 500, 182, 500, 200, 32, 106, 294, 88, 52, 28, 64, 500, 64, 30, 500, 38, 64]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37800713290394955, "mean_inference_ms": 1.2094221531797695, "mean_action_processing_ms": 0.13954628343114703, "mean_env_wait_ms": 0.08423443239272106, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02400493621826172, "StateBufferConnector_ms": 0.004000425338745117, "ViewRequirementAgentConnector_ms": 0.11028075218200684}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000, "num_env_steps_sampled": 1224000, "num_env_steps_trained": 1224000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5539.504704737815, "num_env_steps_trained_throughput_per_sec": 5539.504704737815, "timesteps_total": 1224000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1224000, "timers": {"training_iteration_time_ms": 3135.93, "sample_time_ms": 2857.65, "load_time_ms": 20.666, "load_throughput": 871013.79, "learn_time_ms": 246.224, "learn_throughput": 73104.116, "synch_weights_time_ms": 9.341}, "counters": {"num_env_steps_sampled": 1224000, "num_env_steps_trained": 1224000, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000}, "done": false, "episodes_total": 4698, "training_iteration": 68, "trial_id": "9f288_00014", "date": "2023-10-25_16-45-29", "timestamp": 1698248729, "time_this_iter_s": 3.2543540000915527, "time_total_s": 214.75552701950073, "pid": 9504, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 214.75552701950073, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 57.760000000000005, "ram_util_percent": 27.22}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.776263578034404e-22, "cur_lr": 0.0003, "total_loss": 6.521713217099507, "policy_loss": -0.030013406028350193, "vf_loss": 6.551779747009277, "vf_explained_var": -3.0795733133951825e-07, "kl": 0.0001477881674532, "entropy": 0.5284707571069399, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 822.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 1242000, "num_env_steps_trained": 1242000, "num_agent_steps_sampled": 1242000, "num_agent_steps_trained": 1242000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.759999999999863, "episode_len_mean": 223.1, "episode_media": {}, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.3, 46.099999999999994, 42.900000000000006, -50.00000000000044, 37.10000000000003, 37.90000000000003, 46.3, 32.50000000000002, -50.00000000000044, 37.70000000000003, -50.00000000000044, -50.00000000000044, 31.900000000000013, -50.00000000000044, 30.099999999999987, 46.9, 39.50000000000002, 20.699999999999854, 41.30000000000001, 44.900000000000006, 47.3, 43.7, -50.00000000000044, 43.7, 47.1, -50.00000000000044, 46.3, 43.7, 19.899999999999842, 47.5, 40.10000000000002, 39.10000000000002, 44.10000000000001, -50.00000000000044, 18.29999999999982, -50.00000000000044, 34.30000000000004, 43.30000000000001, 40.10000000000002, -50.00000000000044, -50.00000000000044, 40.500000000000014, 31.300000000000004, 32.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 35.30000000000004, 42.500000000000014, 45.7, 38.50000000000003, -50.00000000000044, 43.900000000000006, 36.50000000000003, -50.00000000000044, 47.1, 44.900000000000006, 41.30000000000001, 46.9, 45.9, 29.69999999999998, 45.7, 41.30000000000001, -50.00000000000044, 47.9, 40.500000000000014, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 46.099999999999994, 41.90000000000001, 29.099999999999973, 46.099999999999994, 31.900000000000013, 41.100000000000016, -50.00000000000044, 17.099999999999802, -50.00000000000044, 37.10000000000003, -50.00000000000044, 37.50000000000003, 44.900000000000006, 31.300000000000004, 43.900000000000006, 11.699999999999726, 45.5, -50.00000000000044, -50.00000000000044, 46.3, 39.10000000000002, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.900000000000006], "episode_lengths": [38, 40, 72, 500, 130, 122, 38, 176, 500, 124, 500, 500, 182, 500, 200, 32, 106, 294, 88, 52, 28, 64, 500, 64, 30, 500, 38, 64, 302, 26, 100, 110, 60, 500, 318, 500, 158, 68, 100, 500, 500, 96, 188, 178, 500, 500, 500, 500, 500, 38, 500, 148, 76, 44, 116, 500, 62, 136, 500, 30, 52, 88, 32, 42, 204, 44, 88, 500, 22, 96, 62, 500, 500, 500, 42, 40, 82, 210, 40, 182, 90, 500, 330, 500, 130, 500, 126, 52, 188, 62, 384, 46, 500, 500, 38, 110, 40, 500, 500, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3779602899398815, "mean_inference_ms": 1.2103353802176904, "mean_action_processing_ms": 0.14008478157475537, "mean_env_wait_ms": 0.08393411646446422, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027001619338989258, "StateBufferConnector_ms": 0.0019996166229248047, "ViewRequirementAgentConnector_ms": 0.11700749397277832}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.759999999999863, "episode_len_mean": 223.1, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.3, 46.099999999999994, 42.900000000000006, -50.00000000000044, 37.10000000000003, 37.90000000000003, 46.3, 32.50000000000002, -50.00000000000044, 37.70000000000003, -50.00000000000044, -50.00000000000044, 31.900000000000013, -50.00000000000044, 30.099999999999987, 46.9, 39.50000000000002, 20.699999999999854, 41.30000000000001, 44.900000000000006, 47.3, 43.7, -50.00000000000044, 43.7, 47.1, -50.00000000000044, 46.3, 43.7, 19.899999999999842, 47.5, 40.10000000000002, 39.10000000000002, 44.10000000000001, -50.00000000000044, 18.29999999999982, -50.00000000000044, 34.30000000000004, 43.30000000000001, 40.10000000000002, -50.00000000000044, -50.00000000000044, 40.500000000000014, 31.300000000000004, 32.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 35.30000000000004, 42.500000000000014, 45.7, 38.50000000000003, -50.00000000000044, 43.900000000000006, 36.50000000000003, -50.00000000000044, 47.1, 44.900000000000006, 41.30000000000001, 46.9, 45.9, 29.69999999999998, 45.7, 41.30000000000001, -50.00000000000044, 47.9, 40.500000000000014, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 46.099999999999994, 41.90000000000001, 29.099999999999973, 46.099999999999994, 31.900000000000013, 41.100000000000016, -50.00000000000044, 17.099999999999802, -50.00000000000044, 37.10000000000003, -50.00000000000044, 37.50000000000003, 44.900000000000006, 31.300000000000004, 43.900000000000006, 11.699999999999726, 45.5, -50.00000000000044, -50.00000000000044, 46.3, 39.10000000000002, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.900000000000006], "episode_lengths": [38, 40, 72, 500, 130, 122, 38, 176, 500, 124, 500, 500, 182, 500, 200, 32, 106, 294, 88, 52, 28, 64, 500, 64, 30, 500, 38, 64, 302, 26, 100, 110, 60, 500, 318, 500, 158, 68, 100, 500, 500, 96, 188, 178, 500, 500, 500, 500, 500, 38, 500, 148, 76, 44, 116, 500, 62, 136, 500, 30, 52, 88, 32, 42, 204, 44, 88, 500, 22, 96, 62, 500, 500, 500, 42, 40, 82, 210, 40, 182, 90, 500, 330, 500, 130, 500, 126, 52, 188, 62, 384, 46, 500, 500, 38, 110, 40, 500, 500, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3779602899398815, "mean_inference_ms": 1.2103353802176904, "mean_action_processing_ms": 0.14008478157475537, "mean_env_wait_ms": 0.08393411646446422, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027001619338989258, "StateBufferConnector_ms": 0.0019996166229248047, "ViewRequirementAgentConnector_ms": 0.11700749397277832}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1242000, "num_agent_steps_trained": 1242000, "num_env_steps_sampled": 1242000, "num_env_steps_trained": 1242000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5925.804248826181, "num_env_steps_trained_throughput_per_sec": 5925.804248826181, "timesteps_total": 1242000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1242000, "timers": {"training_iteration_time_ms": 3115.764, "sample_time_ms": 2852.995, "load_time_ms": 19.965, "load_throughput": 901581.845, "learn_time_ms": 231.457, "learn_throughput": 77768.098, "synch_weights_time_ms": 9.297}, "counters": {"num_env_steps_sampled": 1242000, "num_env_steps_trained": 1242000, "num_agent_steps_sampled": 1242000, "num_agent_steps_trained": 1242000}, "done": false, "episodes_total": 4770, "training_iteration": 69, "trial_id": "9f288_00014", "date": "2023-10-25_16-45-32", "timestamp": 1698248732, "time_this_iter_s": 3.0425612926483154, "time_total_s": 217.79808831214905, "pid": 9504, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 217.79808831214905, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 64.575, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.388131789017202e-22, "cur_lr": 0.0003, "total_loss": 6.537231524785359, "policy_loss": 0.017410604283213615, "vf_loss": 6.519875605901082, "vf_explained_var": -7.748603820800781e-07, "kl": 0.00021482053202840726, "entropy": 0.5487762838602066, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 834.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 1260000, "num_env_steps_trained": 1260000, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000}, "sampler_results": {"episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.859999999999831, "episode_len_mean": 252.04, "episode_media": {}, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.9, 46.099999999999994, 41.90000000000001, 29.099999999999973, 46.099999999999994, 31.900000000000013, 41.100000000000016, -50.00000000000044, 17.099999999999802, -50.00000000000044, 37.10000000000003, -50.00000000000044, 37.50000000000003, 44.900000000000006, 31.300000000000004, 43.900000000000006, 11.699999999999726, 45.5, -50.00000000000044, -50.00000000000044, 46.3, 39.10000000000002, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.900000000000006, 7.499999999999666, 44.5, 43.900000000000006, 42.500000000000014, 46.099999999999994, -50.00000000000044, -50.00000000000044, 42.500000000000014, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 45.5, 29.49999999999998, 36.30000000000003, -50.00000000000044, 44.10000000000001, 39.90000000000002, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 45.1, 46.5, -50.00000000000044, 38.90000000000002, 41.70000000000002, -50.00000000000044, 40.30000000000002, -50.00000000000044, 43.900000000000006, 44.7, -50.00000000000044, -50.00000000000044, 43.7, 42.900000000000006, 45.5, -50.00000000000044, 37.70000000000003, 41.90000000000001, -50.00000000000044, 45.9, 44.10000000000001, 39.50000000000002, 42.70000000000001, 31.300000000000004, -50.00000000000044, -50.00000000000044, 34.50000000000004, 38.90000000000002, -50.00000000000044, -50.00000000000044, 38.50000000000003, -50.00000000000044, 44.300000000000004, -50.00000000000044, 44.10000000000001, -50.00000000000044, 45.3, 35.30000000000004, 39.300000000000026, -50.00000000000044, -50.00000000000044, 27.899999999999956, 0.49999999999956657, -50.00000000000044, 39.90000000000002, -50.00000000000044, 42.500000000000014, 11.899999999999729], "episode_lengths": [500, 42, 40, 82, 210, 40, 182, 90, 500, 330, 500, 130, 500, 126, 52, 188, 62, 384, 46, 500, 500, 38, 110, 40, 500, 500, 52, 426, 56, 62, 76, 40, 500, 500, 76, 54, 500, 500, 500, 60, 46, 206, 138, 500, 60, 102, 500, 46, 500, 500, 500, 74, 50, 36, 500, 112, 84, 500, 98, 500, 62, 54, 500, 500, 64, 72, 46, 500, 124, 82, 500, 42, 60, 106, 74, 188, 500, 500, 156, 112, 500, 500, 116, 500, 58, 500, 60, 500, 48, 148, 108, 500, 500, 222, 496, 500, 102, 500, 76, 382]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37785512230549756, "mean_inference_ms": 1.210706480261657, "mean_action_processing_ms": 0.13969340760493407, "mean_env_wait_ms": 0.08382220998118338, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03502321243286133, "StateBufferConnector_ms": 0.00400090217590332, "ViewRequirementAgentConnector_ms": 0.13100385665893555}}, "episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.859999999999831, "episode_len_mean": 252.04, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.9, 46.099999999999994, 41.90000000000001, 29.099999999999973, 46.099999999999994, 31.900000000000013, 41.100000000000016, -50.00000000000044, 17.099999999999802, -50.00000000000044, 37.10000000000003, -50.00000000000044, 37.50000000000003, 44.900000000000006, 31.300000000000004, 43.900000000000006, 11.699999999999726, 45.5, -50.00000000000044, -50.00000000000044, 46.3, 39.10000000000002, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.900000000000006, 7.499999999999666, 44.5, 43.900000000000006, 42.500000000000014, 46.099999999999994, -50.00000000000044, -50.00000000000044, 42.500000000000014, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 45.5, 29.49999999999998, 36.30000000000003, -50.00000000000044, 44.10000000000001, 39.90000000000002, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 45.1, 46.5, -50.00000000000044, 38.90000000000002, 41.70000000000002, -50.00000000000044, 40.30000000000002, -50.00000000000044, 43.900000000000006, 44.7, -50.00000000000044, -50.00000000000044, 43.7, 42.900000000000006, 45.5, -50.00000000000044, 37.70000000000003, 41.90000000000001, -50.00000000000044, 45.9, 44.10000000000001, 39.50000000000002, 42.70000000000001, 31.300000000000004, -50.00000000000044, -50.00000000000044, 34.50000000000004, 38.90000000000002, -50.00000000000044, -50.00000000000044, 38.50000000000003, -50.00000000000044, 44.300000000000004, -50.00000000000044, 44.10000000000001, -50.00000000000044, 45.3, 35.30000000000004, 39.300000000000026, -50.00000000000044, -50.00000000000044, 27.899999999999956, 0.49999999999956657, -50.00000000000044, 39.90000000000002, -50.00000000000044, 42.500000000000014, 11.899999999999729], "episode_lengths": [500, 42, 40, 82, 210, 40, 182, 90, 500, 330, 500, 130, 500, 126, 52, 188, 62, 384, 46, 500, 500, 38, 110, 40, 500, 500, 52, 426, 56, 62, 76, 40, 500, 500, 76, 54, 500, 500, 500, 60, 46, 206, 138, 500, 60, 102, 500, 46, 500, 500, 500, 74, 50, 36, 500, 112, 84, 500, 98, 500, 62, 54, 500, 500, 64, 72, 46, 500, 124, 82, 500, 42, 60, 106, 74, 188, 500, 500, 156, 112, 500, 500, 116, 500, 58, 500, 60, 500, 48, 148, 108, 500, 500, 222, 496, 500, 102, 500, 76, 382]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37785512230549756, "mean_inference_ms": 1.210706480261657, "mean_action_processing_ms": 0.13969340760493407, "mean_env_wait_ms": 0.08382220998118338, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03502321243286133, "StateBufferConnector_ms": 0.00400090217590332, "ViewRequirementAgentConnector_ms": 0.13100385665893555}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000, "num_env_steps_sampled": 1260000, "num_env_steps_trained": 1260000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5741.272707113652, "num_env_steps_trained_throughput_per_sec": 5741.272707113652, "timesteps_total": 1260000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1260000, "timers": {"training_iteration_time_ms": 3121.355, "sample_time_ms": 2860.446, "load_time_ms": 19.945, "load_throughput": 902478.516, "learn_time_ms": 229.608, "learn_throughput": 78394.412, "synch_weights_time_ms": 9.184}, "counters": {"num_env_steps_sampled": 1260000, "num_env_steps_trained": 1260000, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000}, "done": false, "episodes_total": 4843, "training_iteration": 70, "trial_id": "9f288_00014", "date": "2023-10-25_16-45-36", "timestamp": 1698248736, "time_this_iter_s": 3.141188144683838, "time_total_s": 220.93927645683289, "pid": 9504, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 220.93927645683289, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 61.64999999999999, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.694065894508601e-22, "cur_lr": 0.0003, "total_loss": 6.797464966773987, "policy_loss": -0.044626293859134115, "vf_loss": 6.842142740885417, "vf_explained_var": -1.4106432596842449e-06, "kl": 0.00016291639703780447, "entropy": 0.5136493022243181, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 846.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 1278000, "num_env_steps_trained": 1278000, "num_agent_steps_sampled": 1278000, "num_agent_steps_trained": 1278000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.9829999999998105, "episode_len_mean": 275.78, "episode_media": {}, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.5, -50.00000000000044, 37.70000000000003, 41.90000000000001, -50.00000000000044, 45.9, 44.10000000000001, 39.50000000000002, 42.70000000000001, 31.300000000000004, -50.00000000000044, -50.00000000000044, 34.50000000000004, 38.90000000000002, -50.00000000000044, -50.00000000000044, 38.50000000000003, -50.00000000000044, 44.300000000000004, -50.00000000000044, 44.10000000000001, -50.00000000000044, 45.3, 35.30000000000004, 39.300000000000026, -50.00000000000044, -50.00000000000044, 27.899999999999956, 0.49999999999956657, -50.00000000000044, 39.90000000000002, -50.00000000000044, 42.500000000000014, 11.899999999999729, 45.3, 44.7, 30.9, -50.00000000000044, 40.90000000000002, 45.9, -50.00000000000044, 45.3, 13.899999999999757, 7.899999999999672, 43.30000000000001, 31.1, -50.00000000000044, 33.500000000000036, 40.500000000000014, 45.9, 40.90000000000002, 13.299999999999748, 44.10000000000001, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 45.9, 47.5, 42.500000000000014, 39.90000000000002, -50.00000000000044, 42.30000000000001, 39.90000000000002, 40.30000000000002, 38.10000000000002, 11.899999999999729, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 20.899999999999856, 35.900000000000034, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 39.50000000000002, 13.299999999999748, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.50000000000003, 25.899999999999928, 35.10000000000004, -50.00000000000044, 36.30000000000003, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001], "episode_lengths": [46, 500, 124, 82, 500, 42, 60, 106, 74, 188, 500, 500, 156, 112, 500, 500, 116, 500, 58, 500, 60, 500, 48, 148, 108, 500, 500, 222, 496, 500, 102, 500, 76, 382, 48, 54, 192, 500, 92, 42, 500, 48, 362, 422, 68, 190, 500, 166, 96, 42, 92, 368, 60, 500, 500, 34, 500, 500, 500, 36, 42, 26, 76, 102, 500, 78, 102, 98, 120, 382, 500, 500, 500, 500, 500, 500, 86, 292, 142, 500, 500, 50, 500, 106, 368, 40, 500, 500, 500, 116, 242, 150, 500, 138, 500, 38, 500, 500, 500, 66]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3775296729558686, "mean_inference_ms": 1.210885307902722, "mean_action_processing_ms": 0.1399761304346423, "mean_env_wait_ms": 0.08380985327282547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027017593383789062, "StateBufferConnector_ms": 0.005999565124511719, "ViewRequirementAgentConnector_ms": 0.11299371719360352}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.9829999999998105, "episode_len_mean": 275.78, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.5, -50.00000000000044, 37.70000000000003, 41.90000000000001, -50.00000000000044, 45.9, 44.10000000000001, 39.50000000000002, 42.70000000000001, 31.300000000000004, -50.00000000000044, -50.00000000000044, 34.50000000000004, 38.90000000000002, -50.00000000000044, -50.00000000000044, 38.50000000000003, -50.00000000000044, 44.300000000000004, -50.00000000000044, 44.10000000000001, -50.00000000000044, 45.3, 35.30000000000004, 39.300000000000026, -50.00000000000044, -50.00000000000044, 27.899999999999956, 0.49999999999956657, -50.00000000000044, 39.90000000000002, -50.00000000000044, 42.500000000000014, 11.899999999999729, 45.3, 44.7, 30.9, -50.00000000000044, 40.90000000000002, 45.9, -50.00000000000044, 45.3, 13.899999999999757, 7.899999999999672, 43.30000000000001, 31.1, -50.00000000000044, 33.500000000000036, 40.500000000000014, 45.9, 40.90000000000002, 13.299999999999748, 44.10000000000001, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 45.9, 47.5, 42.500000000000014, 39.90000000000002, -50.00000000000044, 42.30000000000001, 39.90000000000002, 40.30000000000002, 38.10000000000002, 11.899999999999729, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 20.899999999999856, 35.900000000000034, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 39.50000000000002, 13.299999999999748, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.50000000000003, 25.899999999999928, 35.10000000000004, -50.00000000000044, 36.30000000000003, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001], "episode_lengths": [46, 500, 124, 82, 500, 42, 60, 106, 74, 188, 500, 500, 156, 112, 500, 500, 116, 500, 58, 500, 60, 500, 48, 148, 108, 500, 500, 222, 496, 500, 102, 500, 76, 382, 48, 54, 192, 500, 92, 42, 500, 48, 362, 422, 68, 190, 500, 166, 96, 42, 92, 368, 60, 500, 500, 34, 500, 500, 500, 36, 42, 26, 76, 102, 500, 78, 102, 98, 120, 382, 500, 500, 500, 500, 500, 500, 86, 292, 142, 500, 500, 50, 500, 106, 368, 40, 500, 500, 500, 116, 242, 150, 500, 138, 500, 38, 500, 500, 500, 66]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3775296729558686, "mean_inference_ms": 1.210885307902722, "mean_action_processing_ms": 0.1399761304346423, "mean_env_wait_ms": 0.08380985327282547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027017593383789062, "StateBufferConnector_ms": 0.005999565124511719, "ViewRequirementAgentConnector_ms": 0.11299371719360352}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1278000, "num_agent_steps_trained": 1278000, "num_env_steps_sampled": 1278000, "num_env_steps_trained": 1278000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5956.5838076800055, "num_env_steps_trained_throughput_per_sec": 5956.5838076800055, "timesteps_total": 1278000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1278000, "timers": {"training_iteration_time_ms": 3114.033, "sample_time_ms": 2855.781, "load_time_ms": 19.01, "load_throughput": 946861.982, "learn_time_ms": 227.786, "learn_throughput": 79021.408, "synch_weights_time_ms": 9.184}, "counters": {"num_env_steps_sampled": 1278000, "num_env_steps_trained": 1278000, "num_agent_steps_sampled": 1278000, "num_agent_steps_trained": 1278000}, "done": false, "episodes_total": 4909, "training_iteration": 71, "trial_id": "9f288_00014", "date": "2023-10-25_16-45-39", "timestamp": 1698248739, "time_this_iter_s": 3.0268642902374268, "time_total_s": 223.9661407470703, "pid": 9504, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 223.9661407470703, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 58.1, "ram_util_percent": 27.22}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.470329472543005e-23, "cur_lr": 0.0003, "total_loss": 6.803499261538188, "policy_loss": 0.01944597804200991, "vf_loss": 6.784102082252502, "vf_explained_var": -7.202227910359701e-07, "kl": 0.0007596369086879662, "entropy": 0.4855177228649457, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 858.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 1296000, "num_env_steps_trained": 1296000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.060999999999817, "episode_len_mean": 265.02, "episode_media": {}, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 20.899999999999856, 35.900000000000034, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 39.50000000000002, 13.299999999999748, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.50000000000003, 25.899999999999928, 35.10000000000004, -50.00000000000044, 36.30000000000003, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 6.099999999999646, 43.30000000000001, 5.6999999999996405, 46.099999999999994, -50.00000000000044, -50.00000000000044, 45.5, 46.5, 42.10000000000001, 41.30000000000001, 25.899999999999928, 23.699999999999896, 42.10000000000001, 40.500000000000014, 14.299999999999763, 45.9, -50.00000000000044, 40.10000000000002, 34.900000000000034, 2.699999999999598, -50.00000000000044, 42.70000000000001, 43.50000000000001, 41.100000000000016, -50.00000000000044, 46.9, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 45.1, 18.499999999999822, 40.30000000000002, 46.699999999999996, 40.500000000000014, 42.900000000000006, 37.10000000000003, -50.00000000000044, 47.3, 46.9, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 44.5, 34.50000000000004, 14.699999999999768, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 17.69999999999981, -50.00000000000044, 41.30000000000001, -50.00000000000044, 38.10000000000002, -50.00000000000044, 46.3, 44.7, 38.700000000000024, 38.90000000000002, 44.300000000000004, -50.00000000000044, -50.00000000000044, 45.5, 37.70000000000003, 44.5, 45.9], "episode_lengths": [500, 500, 500, 500, 86, 292, 142, 500, 500, 50, 500, 106, 368, 40, 500, 500, 500, 116, 242, 150, 500, 138, 500, 38, 500, 500, 500, 66, 440, 68, 444, 40, 500, 500, 46, 36, 80, 88, 242, 264, 80, 96, 358, 42, 500, 100, 152, 474, 500, 74, 66, 90, 500, 32, 50, 500, 500, 500, 40, 500, 50, 316, 98, 34, 96, 72, 130, 500, 28, 32, 36, 500, 500, 500, 72, 500, 56, 156, 354, 500, 60, 500, 500, 324, 500, 88, 500, 120, 500, 38, 54, 114, 112, 58, 500, 500, 46, 124, 56, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3780660658175245, "mean_inference_ms": 1.2097452736208896, "mean_action_processing_ms": 0.13973438756986453, "mean_env_wait_ms": 0.08397772661599251, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020001649856567383, "StateBufferConnector_ms": 0.006997823715209961, "ViewRequirementAgentConnector_ms": 0.13698410987854004}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.060999999999817, "episode_len_mean": 265.02, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 20.899999999999856, 35.900000000000034, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 39.50000000000002, 13.299999999999748, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.50000000000003, 25.899999999999928, 35.10000000000004, -50.00000000000044, 36.30000000000003, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 6.099999999999646, 43.30000000000001, 5.6999999999996405, 46.099999999999994, -50.00000000000044, -50.00000000000044, 45.5, 46.5, 42.10000000000001, 41.30000000000001, 25.899999999999928, 23.699999999999896, 42.10000000000001, 40.500000000000014, 14.299999999999763, 45.9, -50.00000000000044, 40.10000000000002, 34.900000000000034, 2.699999999999598, -50.00000000000044, 42.70000000000001, 43.50000000000001, 41.100000000000016, -50.00000000000044, 46.9, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 45.1, 18.499999999999822, 40.30000000000002, 46.699999999999996, 40.500000000000014, 42.900000000000006, 37.10000000000003, -50.00000000000044, 47.3, 46.9, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 44.5, 34.50000000000004, 14.699999999999768, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 17.69999999999981, -50.00000000000044, 41.30000000000001, -50.00000000000044, 38.10000000000002, -50.00000000000044, 46.3, 44.7, 38.700000000000024, 38.90000000000002, 44.300000000000004, -50.00000000000044, -50.00000000000044, 45.5, 37.70000000000003, 44.5, 45.9], "episode_lengths": [500, 500, 500, 500, 86, 292, 142, 500, 500, 50, 500, 106, 368, 40, 500, 500, 500, 116, 242, 150, 500, 138, 500, 38, 500, 500, 500, 66, 440, 68, 444, 40, 500, 500, 46, 36, 80, 88, 242, 264, 80, 96, 358, 42, 500, 100, 152, 474, 500, 74, 66, 90, 500, 32, 50, 500, 500, 500, 40, 500, 50, 316, 98, 34, 96, 72, 130, 500, 28, 32, 36, 500, 500, 500, 72, 500, 56, 156, 354, 500, 60, 500, 500, 324, 500, 88, 500, 120, 500, 38, 54, 114, 112, 58, 500, 500, 46, 124, 56, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3780660658175245, "mean_inference_ms": 1.2097452736208896, "mean_action_processing_ms": 0.13973438756986453, "mean_env_wait_ms": 0.08397772661599251, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020001649856567383, "StateBufferConnector_ms": 0.006997823715209961, "ViewRequirementAgentConnector_ms": 0.13698410987854004}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000, "num_env_steps_sampled": 1296000, "num_env_steps_trained": 1296000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5491.9730126321065, "num_env_steps_trained_throughput_per_sec": 5491.9730126321065, "timesteps_total": 1296000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1296000, "timers": {"training_iteration_time_ms": 3140.44, "sample_time_ms": 2863.948, "load_time_ms": 19.91, "load_throughput": 904084.467, "learn_time_ms": 245.103, "learn_throughput": 73438.485, "synch_weights_time_ms": 9.108}, "counters": {"num_env_steps_sampled": 1296000, "num_env_steps_trained": 1296000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "done": false, "episodes_total": 4981, "training_iteration": 72, "trial_id": "9f288_00014", "date": "2023-10-25_16-45-42", "timestamp": 1698248742, "time_this_iter_s": 3.2825095653533936, "time_total_s": 227.2486503124237, "pid": 9504, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 227.2486503124237, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 66.05, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.2351647362715025e-23, "cur_lr": 0.0003, "total_loss": 7.263839364051819, "policy_loss": -0.06578496641789873, "vf_loss": 7.329672376314799, "vf_explained_var": -6.258487701416016e-07, "kl": 0.00031110753436299393, "entropy": 0.48055464526017505, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 870.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 1314000, "num_env_steps_trained": 1314000, "num_agent_steps_sampled": 1314000, "num_agent_steps_trained": 1314000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.328999999999846, "episode_len_mean": 242.4, "episode_media": {}, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.5, 34.50000000000004, 14.699999999999768, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 17.69999999999981, -50.00000000000044, 41.30000000000001, -50.00000000000044, 38.10000000000002, -50.00000000000044, 46.3, 44.7, 38.700000000000024, 38.90000000000002, 44.300000000000004, -50.00000000000044, -50.00000000000044, 45.5, 37.70000000000003, 44.5, 45.9, 40.30000000000002, 0.6999999999995694, -50.00000000000044, 23.499999999999893, 36.70000000000003, 21.499999999999865, 5.6999999999996405, 45.3, 39.300000000000026, 21.299999999999862, 40.90000000000002, 32.50000000000002, 32.100000000000016, 9.699999999999697, -50.00000000000044, 28.89999999999997, 40.70000000000002, -50.00000000000044, 44.300000000000004, -50.00000000000044, 7.499999999999666, -50.00000000000044, -50.00000000000044, 46.699999999999996, 45.9, 42.30000000000001, 33.30000000000003, 44.10000000000001, 33.10000000000003, -50.00000000000044, 40.70000000000002, 38.50000000000003, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 44.10000000000001, 33.10000000000003, 47.3, -50.00000000000044, 36.30000000000003, -50.00000000000044, 34.900000000000034, 29.69999999999998, 42.10000000000001, 44.7, -50.00000000000044, -50.00000000000044, 45.7, 42.70000000000001, 44.900000000000006, -50.00000000000044, 44.7, -50.00000000000044, 44.10000000000001, 46.9, 17.299999999999805, 45.5, -50.00000000000044, 46.9, 30.099999999999987, -50.00000000000044, 46.3, 46.3, -50.00000000000044, 46.3, 46.099999999999994, 41.70000000000002, -50.00000000000044, 42.10000000000001, 43.900000000000006, -50.00000000000044, 46.9, 41.500000000000014, -50.00000000000044], "episode_lengths": [500, 56, 156, 354, 500, 60, 500, 500, 324, 500, 88, 500, 120, 500, 38, 54, 114, 112, 58, 500, 500, 46, 124, 56, 42, 98, 494, 500, 266, 134, 286, 444, 48, 108, 288, 92, 176, 180, 404, 500, 212, 94, 500, 58, 500, 426, 500, 500, 34, 42, 78, 168, 60, 170, 500, 94, 116, 500, 62, 500, 500, 60, 170, 28, 500, 138, 500, 152, 204, 80, 54, 500, 500, 44, 74, 52, 500, 54, 500, 60, 32, 328, 46, 500, 32, 200, 500, 38, 38, 500, 38, 40, 84, 500, 80, 62, 500, 32, 86, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37779176530243036, "mean_inference_ms": 1.2100531116558106, "mean_action_processing_ms": 0.1396348505941947, "mean_env_wait_ms": 0.08392317559019798, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03200030326843262, "StateBufferConnector_ms": 0.005001068115234375, "ViewRequirementAgentConnector_ms": 0.1140139102935791}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.328999999999846, "episode_len_mean": 242.4, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.5, 34.50000000000004, 14.699999999999768, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 17.69999999999981, -50.00000000000044, 41.30000000000001, -50.00000000000044, 38.10000000000002, -50.00000000000044, 46.3, 44.7, 38.700000000000024, 38.90000000000002, 44.300000000000004, -50.00000000000044, -50.00000000000044, 45.5, 37.70000000000003, 44.5, 45.9, 40.30000000000002, 0.6999999999995694, -50.00000000000044, 23.499999999999893, 36.70000000000003, 21.499999999999865, 5.6999999999996405, 45.3, 39.300000000000026, 21.299999999999862, 40.90000000000002, 32.50000000000002, 32.100000000000016, 9.699999999999697, -50.00000000000044, 28.89999999999997, 40.70000000000002, -50.00000000000044, 44.300000000000004, -50.00000000000044, 7.499999999999666, -50.00000000000044, -50.00000000000044, 46.699999999999996, 45.9, 42.30000000000001, 33.30000000000003, 44.10000000000001, 33.10000000000003, -50.00000000000044, 40.70000000000002, 38.50000000000003, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 44.10000000000001, 33.10000000000003, 47.3, -50.00000000000044, 36.30000000000003, -50.00000000000044, 34.900000000000034, 29.69999999999998, 42.10000000000001, 44.7, -50.00000000000044, -50.00000000000044, 45.7, 42.70000000000001, 44.900000000000006, -50.00000000000044, 44.7, -50.00000000000044, 44.10000000000001, 46.9, 17.299999999999805, 45.5, -50.00000000000044, 46.9, 30.099999999999987, -50.00000000000044, 46.3, 46.3, -50.00000000000044, 46.3, 46.099999999999994, 41.70000000000002, -50.00000000000044, 42.10000000000001, 43.900000000000006, -50.00000000000044, 46.9, 41.500000000000014, -50.00000000000044], "episode_lengths": [500, 56, 156, 354, 500, 60, 500, 500, 324, 500, 88, 500, 120, 500, 38, 54, 114, 112, 58, 500, 500, 46, 124, 56, 42, 98, 494, 500, 266, 134, 286, 444, 48, 108, 288, 92, 176, 180, 404, 500, 212, 94, 500, 58, 500, 426, 500, 500, 34, 42, 78, 168, 60, 170, 500, 94, 116, 500, 62, 500, 500, 60, 170, 28, 500, 138, 500, 152, 204, 80, 54, 500, 500, 44, 74, 52, 500, 54, 500, 60, 32, 328, 46, 500, 32, 200, 500, 38, 38, 500, 38, 40, 84, 500, 80, 62, 500, 32, 86, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37779176530243036, "mean_inference_ms": 1.2100531116558106, "mean_action_processing_ms": 0.1396348505941947, "mean_env_wait_ms": 0.08392317559019798, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03200030326843262, "StateBufferConnector_ms": 0.005001068115234375, "ViewRequirementAgentConnector_ms": 0.1140139102935791}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1314000, "num_agent_steps_trained": 1314000, "num_env_steps_sampled": 1314000, "num_env_steps_trained": 1314000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5891.849644639334, "num_env_steps_trained_throughput_per_sec": 5891.849644639334, "timesteps_total": 1314000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1314000, "timers": {"training_iteration_time_ms": 3134.799, "sample_time_ms": 2863.835, "load_time_ms": 18.917, "load_throughput": 951500.485, "learn_time_ms": 240.351, "learn_throughput": 74890.611, "synch_weights_time_ms": 9.225}, "counters": {"num_env_steps_sampled": 1314000, "num_env_steps_trained": 1314000, "num_agent_steps_sampled": 1314000, "num_agent_steps_trained": 1314000}, "done": false, "episodes_total": 5056, "training_iteration": 73, "trial_id": "9f288_00014", "date": "2023-10-25_16-45-45", "timestamp": 1698248745, "time_this_iter_s": 3.0600223541259766, "time_total_s": 230.30867266654968, "pid": 9504, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 230.30867266654968, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 55.06, "ram_util_percent": 27.22}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.1175823681357513e-23, "cur_lr": 0.0003, "total_loss": 6.581138054529826, "policy_loss": 0.051263914443552494, "vf_loss": 6.52992582321167, "vf_explained_var": -9.139378865559896e-07, "kl": 0.00031658198601765736, "entropy": 0.5165028100212415, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 882.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 1332000, "num_env_steps_trained": 1332000, "num_agent_steps_sampled": 1332000, "num_agent_steps_trained": 1332000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.539999999999843, "episode_len_mean": 235.26, "episode_media": {}, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.70000000000001, 44.900000000000006, -50.00000000000044, 44.7, -50.00000000000044, 44.10000000000001, 46.9, 17.299999999999805, 45.5, -50.00000000000044, 46.9, 30.099999999999987, -50.00000000000044, 46.3, 46.3, -50.00000000000044, 46.3, 46.099999999999994, 41.70000000000002, -50.00000000000044, 42.10000000000001, 43.900000000000006, -50.00000000000044, 46.9, 41.500000000000014, -50.00000000000044, 24.099999999999902, -50.00000000000044, 18.699999999999825, 43.900000000000006, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 43.30000000000001, 33.90000000000004, 28.09999999999996, 42.10000000000001, 46.099999999999994, 41.90000000000001, 43.10000000000001, 44.10000000000001, -50.00000000000044, 46.699999999999996, 44.300000000000004, 24.499999999999908, 44.300000000000004, 27.899999999999956, -50.00000000000044, -50.00000000000044, 39.50000000000002, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002, -50.00000000000044, -50.00000000000044, 35.70000000000003, 46.099999999999994, 43.7, 46.5, 42.70000000000001, 32.50000000000002, 42.500000000000014, -50.00000000000044, 43.900000000000006, 40.500000000000014, -50.00000000000044, -50.00000000000044, 10.099999999999703, -50.00000000000044, 36.10000000000004, 45.7, 46.3, 44.300000000000004, 46.5, 46.5, 34.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 45.5, -50.00000000000044, -50.00000000000044, 43.50000000000001, 39.300000000000026, 45.3, 27.299999999999947, 42.900000000000006, 44.900000000000006, 22.699999999999882], "episode_lengths": [74, 52, 500, 54, 500, 60, 32, 328, 46, 500, 32, 200, 500, 38, 38, 500, 38, 40, 84, 500, 80, 62, 500, 32, 86, 500, 260, 500, 314, 62, 84, 500, 500, 500, 38, 500, 62, 500, 500, 68, 162, 220, 80, 40, 82, 70, 60, 500, 34, 58, 256, 58, 222, 500, 500, 106, 70, 500, 500, 500, 500, 106, 500, 500, 144, 40, 64, 36, 74, 176, 76, 500, 62, 96, 500, 500, 400, 500, 140, 44, 38, 58, 36, 36, 158, 500, 500, 500, 500, 66, 46, 500, 500, 66, 108, 48, 228, 72, 52, 274]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37768234866584066, "mean_inference_ms": 1.209742424393105, "mean_action_processing_ms": 0.13956585107037525, "mean_env_wait_ms": 0.08401149965294681, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03499746322631836, "StateBufferConnector_ms": 0.009004831314086914, "ViewRequirementAgentConnector_ms": 0.11482453346252441}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.539999999999843, "episode_len_mean": 235.26, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.70000000000001, 44.900000000000006, -50.00000000000044, 44.7, -50.00000000000044, 44.10000000000001, 46.9, 17.299999999999805, 45.5, -50.00000000000044, 46.9, 30.099999999999987, -50.00000000000044, 46.3, 46.3, -50.00000000000044, 46.3, 46.099999999999994, 41.70000000000002, -50.00000000000044, 42.10000000000001, 43.900000000000006, -50.00000000000044, 46.9, 41.500000000000014, -50.00000000000044, 24.099999999999902, -50.00000000000044, 18.699999999999825, 43.900000000000006, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 43.30000000000001, 33.90000000000004, 28.09999999999996, 42.10000000000001, 46.099999999999994, 41.90000000000001, 43.10000000000001, 44.10000000000001, -50.00000000000044, 46.699999999999996, 44.300000000000004, 24.499999999999908, 44.300000000000004, 27.899999999999956, -50.00000000000044, -50.00000000000044, 39.50000000000002, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002, -50.00000000000044, -50.00000000000044, 35.70000000000003, 46.099999999999994, 43.7, 46.5, 42.70000000000001, 32.50000000000002, 42.500000000000014, -50.00000000000044, 43.900000000000006, 40.500000000000014, -50.00000000000044, -50.00000000000044, 10.099999999999703, -50.00000000000044, 36.10000000000004, 45.7, 46.3, 44.300000000000004, 46.5, 46.5, 34.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 45.5, -50.00000000000044, -50.00000000000044, 43.50000000000001, 39.300000000000026, 45.3, 27.299999999999947, 42.900000000000006, 44.900000000000006, 22.699999999999882], "episode_lengths": [74, 52, 500, 54, 500, 60, 32, 328, 46, 500, 32, 200, 500, 38, 38, 500, 38, 40, 84, 500, 80, 62, 500, 32, 86, 500, 260, 500, 314, 62, 84, 500, 500, 500, 38, 500, 62, 500, 500, 68, 162, 220, 80, 40, 82, 70, 60, 500, 34, 58, 256, 58, 222, 500, 500, 106, 70, 500, 500, 500, 500, 106, 500, 500, 144, 40, 64, 36, 74, 176, 76, 500, 62, 96, 500, 500, 400, 500, 140, 44, 38, 58, 36, 36, 158, 500, 500, 500, 500, 66, 46, 500, 500, 66, 108, 48, 228, 72, 52, 274]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37768234866584066, "mean_inference_ms": 1.209742424393105, "mean_action_processing_ms": 0.13956585107037525, "mean_env_wait_ms": 0.08401149965294681, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03499746322631836, "StateBufferConnector_ms": 0.009004831314086914, "ViewRequirementAgentConnector_ms": 0.11482453346252441}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1332000, "num_agent_steps_trained": 1332000, "num_env_steps_sampled": 1332000, "num_env_steps_trained": 1332000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5766.683918922139, "num_env_steps_trained_throughput_per_sec": 5766.683918922139, "timesteps_total": 1332000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1332000, "timers": {"training_iteration_time_ms": 3136.636, "sample_time_ms": 2856.851, "load_time_ms": 19.609, "load_throughput": 917940.34, "learn_time_ms": 248.527, "learn_throughput": 72426.793, "synch_weights_time_ms": 9.078}, "counters": {"num_env_steps_sampled": 1332000, "num_env_steps_trained": 1332000, "num_agent_steps_sampled": 1332000, "num_agent_steps_trained": 1332000}, "done": false, "episodes_total": 5130, "training_iteration": 74, "trial_id": "9f288_00014", "date": "2023-10-25_16-45-48", "timestamp": 1698248748, "time_this_iter_s": 3.127166509628296, "time_total_s": 233.43583917617798, "pid": 9504, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 233.43583917617798, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 64.45, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.0587911840678756e-23, "cur_lr": 0.0003, "total_loss": 6.815588076909383, "policy_loss": 0.017543484767278034, "vf_loss": 6.79810090859731, "vf_explained_var": -3.973642985026042e-07, "kl": 7.49365773297465e-05, "entropy": 0.5626292526721954, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 894.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 1350000, "num_env_steps_trained": 1350000, "num_agent_steps_sampled": 1350000, "num_agent_steps_trained": 1350000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.00099999999984, "episode_len_mean": 245.66, "episode_media": {}, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.500000000000014, -50.00000000000044, -50.00000000000044, 10.099999999999703, -50.00000000000044, 36.10000000000004, 45.7, 46.3, 44.300000000000004, 46.5, 46.5, 34.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 45.5, -50.00000000000044, -50.00000000000044, 43.50000000000001, 39.300000000000026, 45.3, 27.299999999999947, 42.900000000000006, 44.900000000000006, 22.699999999999882, -50.00000000000044, 44.10000000000001, 33.500000000000036, 40.70000000000002, 22.099999999999874, 44.5, 29.69999999999998, -50.00000000000044, -50.00000000000044, 46.5, 44.300000000000004, 46.3, -50.00000000000044, -50.00000000000044, 43.7, 41.70000000000002, 46.099999999999994, 47.5, 16.499999999999794, 40.10000000000002, 32.50000000000002, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, 37.70000000000003, 16.699999999999797, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 0.6999999999995694, 45.9, 46.099999999999994, 30.29999999999999, -50.00000000000044, 38.90000000000002, 20.099999999999845, 39.50000000000002, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, 42.900000000000006, 44.7, 43.7, 40.30000000000002, 45.1, 45.5, -50.00000000000044, -50.00000000000044, 42.70000000000001, 28.699999999999967, -50.00000000000044, -50.00000000000044, 38.700000000000024, 25.29999999999992, -50.00000000000044, -50.00000000000044, 42.10000000000001, 20.899999999999856, -50.00000000000044, 43.900000000000006, -50.00000000000044, 39.70000000000002, 44.900000000000006, 44.5, 43.7, 20.299999999999848, 46.099999999999994, 33.70000000000004], "episode_lengths": [96, 500, 500, 400, 500, 140, 44, 38, 58, 36, 36, 158, 500, 500, 500, 500, 66, 46, 500, 500, 66, 108, 48, 228, 72, 52, 274, 500, 60, 166, 94, 280, 56, 204, 500, 500, 36, 58, 38, 500, 500, 64, 84, 40, 26, 336, 100, 176, 500, 94, 500, 500, 124, 334, 500, 50, 500, 500, 500, 38, 494, 42, 40, 198, 500, 112, 300, 106, 500, 104, 500, 500, 72, 54, 64, 98, 50, 46, 500, 500, 74, 214, 500, 500, 114, 248, 500, 500, 80, 292, 500, 62, 500, 104, 52, 56, 64, 298, 40, 164]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37765955253623973, "mean_inference_ms": 1.20973547056098, "mean_action_processing_ms": 0.13917545419411684, "mean_env_wait_ms": 0.08392343608417306, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02700018882751465, "StateBufferConnector_ms": 0.008017778396606445, "ViewRequirementAgentConnector_ms": 0.1189870834350586}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.00099999999984, "episode_len_mean": 245.66, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [40.500000000000014, -50.00000000000044, -50.00000000000044, 10.099999999999703, -50.00000000000044, 36.10000000000004, 45.7, 46.3, 44.300000000000004, 46.5, 46.5, 34.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 45.5, -50.00000000000044, -50.00000000000044, 43.50000000000001, 39.300000000000026, 45.3, 27.299999999999947, 42.900000000000006, 44.900000000000006, 22.699999999999882, -50.00000000000044, 44.10000000000001, 33.500000000000036, 40.70000000000002, 22.099999999999874, 44.5, 29.69999999999998, -50.00000000000044, -50.00000000000044, 46.5, 44.300000000000004, 46.3, -50.00000000000044, -50.00000000000044, 43.7, 41.70000000000002, 46.099999999999994, 47.5, 16.499999999999794, 40.10000000000002, 32.50000000000002, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, 37.70000000000003, 16.699999999999797, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 0.6999999999995694, 45.9, 46.099999999999994, 30.29999999999999, -50.00000000000044, 38.90000000000002, 20.099999999999845, 39.50000000000002, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, 42.900000000000006, 44.7, 43.7, 40.30000000000002, 45.1, 45.5, -50.00000000000044, -50.00000000000044, 42.70000000000001, 28.699999999999967, -50.00000000000044, -50.00000000000044, 38.700000000000024, 25.29999999999992, -50.00000000000044, -50.00000000000044, 42.10000000000001, 20.899999999999856, -50.00000000000044, 43.900000000000006, -50.00000000000044, 39.70000000000002, 44.900000000000006, 44.5, 43.7, 20.299999999999848, 46.099999999999994, 33.70000000000004], "episode_lengths": [96, 500, 500, 400, 500, 140, 44, 38, 58, 36, 36, 158, 500, 500, 500, 500, 66, 46, 500, 500, 66, 108, 48, 228, 72, 52, 274, 500, 60, 166, 94, 280, 56, 204, 500, 500, 36, 58, 38, 500, 500, 64, 84, 40, 26, 336, 100, 176, 500, 94, 500, 500, 124, 334, 500, 50, 500, 500, 500, 38, 494, 42, 40, 198, 500, 112, 300, 106, 500, 104, 500, 500, 72, 54, 64, 98, 50, 46, 500, 500, 74, 214, 500, 500, 114, 248, 500, 500, 80, 292, 500, 62, 500, 104, 52, 56, 64, 298, 40, 164]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37765955253623973, "mean_inference_ms": 1.20973547056098, "mean_action_processing_ms": 0.13917545419411684, "mean_env_wait_ms": 0.08392343608417306, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02700018882751465, "StateBufferConnector_ms": 0.008017778396606445, "ViewRequirementAgentConnector_ms": 0.1189870834350586}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1350000, "num_agent_steps_trained": 1350000, "num_env_steps_sampled": 1350000, "num_env_steps_trained": 1350000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5935.020901013508, "num_env_steps_trained_throughput_per_sec": 5935.020901013508, "timesteps_total": 1350000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1350000, "timers": {"training_iteration_time_ms": 3136.058, "sample_time_ms": 2858.809, "load_time_ms": 18.801, "load_throughput": 957419.067, "learn_time_ms": 246.671, "learn_throughput": 72971.604, "synch_weights_time_ms": 9.207}, "counters": {"num_env_steps_sampled": 1350000, "num_env_steps_trained": 1350000, "num_agent_steps_sampled": 1350000, "num_agent_steps_trained": 1350000}, "done": false, "episodes_total": 5203, "training_iteration": 75, "trial_id": "9f288_00014", "date": "2023-10-25_16-45-51", "timestamp": 1698248751, "time_this_iter_s": 3.038752794265747, "time_total_s": 236.47459197044373, "pid": 9504, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 236.47459197044373, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 60.050000000000004, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.293955920339378e-24, "cur_lr": 0.0003, "total_loss": 7.047277530034383, "policy_loss": -0.03823899322499832, "vf_loss": 7.085571885108948, "vf_explained_var": -9.735425313313801e-07, "kl": 0.00019639110937911633, "entropy": 0.5539693186680476, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 906.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 1368000, "num_env_steps_trained": 1368000, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000}, "sampler_results": {"episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.130999999999842, "episode_len_mean": 254.36, "episode_media": {}, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.70000000000002, -50.00000000000044, -50.00000000000044, 42.900000000000006, 44.7, 43.7, 40.30000000000002, 45.1, 45.5, -50.00000000000044, -50.00000000000044, 42.70000000000001, 28.699999999999967, -50.00000000000044, -50.00000000000044, 38.700000000000024, 25.29999999999992, -50.00000000000044, -50.00000000000044, 42.10000000000001, 20.899999999999856, -50.00000000000044, 43.900000000000006, -50.00000000000044, 39.70000000000002, 44.900000000000006, 44.5, 43.7, 20.299999999999848, 46.099999999999994, 33.70000000000004, 32.700000000000024, 26.499999999999936, 29.299999999999976, 24.899999999999913, 29.49999999999998, 39.90000000000002, 38.700000000000024, 36.10000000000004, 41.30000000000001, 28.29999999999996, 24.499999999999908, -50.00000000000044, 43.900000000000006, 44.300000000000004, 39.50000000000002, 44.900000000000006, 36.10000000000004, -50.00000000000044, -50.00000000000044, 30.9, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 35.70000000000003, 1.099999999999575, 20.099999999999845, -50.00000000000044, 39.300000000000026, 43.30000000000001, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 9.299999999999692, 42.900000000000006, -50.00000000000044, 44.7, 40.70000000000002, 38.90000000000002, -50.00000000000044, 24.299999999999905, -50.00000000000044, -50.00000000000044, 17.099999999999802, 39.50000000000002, 41.70000000000002, 43.50000000000001, -50.00000000000044, 41.90000000000001, 32.700000000000024, -50.00000000000044, 42.900000000000006, 41.500000000000014, -50.00000000000044, 41.90000000000001, 40.10000000000002, 39.50000000000002, 28.699999999999967, -50.00000000000044, 37.90000000000003, 42.10000000000001, -50.00000000000044], "episode_lengths": [104, 500, 500, 72, 54, 64, 98, 50, 46, 500, 500, 74, 214, 500, 500, 114, 248, 500, 500, 80, 292, 500, 62, 500, 104, 52, 56, 64, 298, 40, 164, 174, 236, 208, 252, 206, 102, 114, 140, 88, 218, 256, 500, 62, 58, 106, 52, 140, 500, 500, 192, 36, 500, 500, 500, 36, 500, 500, 500, 500, 42, 144, 490, 300, 500, 108, 68, 500, 500, 56, 500, 408, 72, 500, 54, 94, 112, 500, 258, 500, 500, 330, 106, 84, 66, 500, 82, 174, 500, 72, 86, 500, 82, 100, 106, 214, 500, 122, 80, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3774749813717602, "mean_inference_ms": 1.2103141060506348, "mean_action_processing_ms": 0.13979114671037343, "mean_env_wait_ms": 0.0839181703405782, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030051708221435547, "StateBufferConnector_ms": 0.0040204524993896484, "ViewRequirementAgentConnector_ms": 0.13921833038330078}}, "episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.130999999999842, "episode_len_mean": 254.36, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [39.70000000000002, -50.00000000000044, -50.00000000000044, 42.900000000000006, 44.7, 43.7, 40.30000000000002, 45.1, 45.5, -50.00000000000044, -50.00000000000044, 42.70000000000001, 28.699999999999967, -50.00000000000044, -50.00000000000044, 38.700000000000024, 25.29999999999992, -50.00000000000044, -50.00000000000044, 42.10000000000001, 20.899999999999856, -50.00000000000044, 43.900000000000006, -50.00000000000044, 39.70000000000002, 44.900000000000006, 44.5, 43.7, 20.299999999999848, 46.099999999999994, 33.70000000000004, 32.700000000000024, 26.499999999999936, 29.299999999999976, 24.899999999999913, 29.49999999999998, 39.90000000000002, 38.700000000000024, 36.10000000000004, 41.30000000000001, 28.29999999999996, 24.499999999999908, -50.00000000000044, 43.900000000000006, 44.300000000000004, 39.50000000000002, 44.900000000000006, 36.10000000000004, -50.00000000000044, -50.00000000000044, 30.9, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 35.70000000000003, 1.099999999999575, 20.099999999999845, -50.00000000000044, 39.300000000000026, 43.30000000000001, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 9.299999999999692, 42.900000000000006, -50.00000000000044, 44.7, 40.70000000000002, 38.90000000000002, -50.00000000000044, 24.299999999999905, -50.00000000000044, -50.00000000000044, 17.099999999999802, 39.50000000000002, 41.70000000000002, 43.50000000000001, -50.00000000000044, 41.90000000000001, 32.700000000000024, -50.00000000000044, 42.900000000000006, 41.500000000000014, -50.00000000000044, 41.90000000000001, 40.10000000000002, 39.50000000000002, 28.699999999999967, -50.00000000000044, 37.90000000000003, 42.10000000000001, -50.00000000000044], "episode_lengths": [104, 500, 500, 72, 54, 64, 98, 50, 46, 500, 500, 74, 214, 500, 500, 114, 248, 500, 500, 80, 292, 500, 62, 500, 104, 52, 56, 64, 298, 40, 164, 174, 236, 208, 252, 206, 102, 114, 140, 88, 218, 256, 500, 62, 58, 106, 52, 140, 500, 500, 192, 36, 500, 500, 500, 36, 500, 500, 500, 500, 42, 144, 490, 300, 500, 108, 68, 500, 500, 56, 500, 408, 72, 500, 54, 94, 112, 500, 258, 500, 500, 330, 106, 84, 66, 500, 82, 174, 500, 72, 86, 500, 82, 100, 106, 214, 500, 122, 80, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3774749813717602, "mean_inference_ms": 1.2103141060506348, "mean_action_processing_ms": 0.13979114671037343, "mean_env_wait_ms": 0.0839181703405782, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030051708221435547, "StateBufferConnector_ms": 0.0040204524993896484, "ViewRequirementAgentConnector_ms": 0.13921833038330078}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000, "num_env_steps_sampled": 1368000, "num_env_steps_trained": 1368000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5782.835830670139, "num_env_steps_trained_throughput_per_sec": 5782.835830670139, "timesteps_total": 1368000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1368000, "timers": {"training_iteration_time_ms": 3111.372, "sample_time_ms": 2828.755, "load_time_ms": 18.631, "load_throughput": 966145.042, "learn_time_ms": 252.083, "learn_throughput": 71404.974, "synch_weights_time_ms": 9.233}, "counters": {"num_env_steps_sampled": 1368000, "num_env_steps_trained": 1368000, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000}, "done": false, "episodes_total": 5272, "training_iteration": 76, "trial_id": "9f288_00014", "date": "2023-10-25_16-45-54", "timestamp": 1698248754, "time_this_iter_s": 3.11765718460083, "time_total_s": 239.59224915504456, "pid": 9504, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 239.59224915504456, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 58.1, "ram_util_percent": 27.22}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.646977960169689e-24, "cur_lr": 0.0003, "total_loss": 6.3588398694992065, "policy_loss": 0.054854944348335266, "vf_loss": 6.304039200146993, "vf_explained_var": -7.152557373046875e-07, "kl": 0.00027090745765434576, "entropy": 0.5426276524861654, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 918.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 1386000, "num_env_steps_trained": 1386000, "num_agent_steps_sampled": 1386000, "num_agent_steps_trained": 1386000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.954999999999831, "episode_len_mean": 246.08, "episode_media": {}, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.900000000000006, -50.00000000000044, 44.7, 40.70000000000002, 38.90000000000002, -50.00000000000044, 24.299999999999905, -50.00000000000044, -50.00000000000044, 17.099999999999802, 39.50000000000002, 41.70000000000002, 43.50000000000001, -50.00000000000044, 41.90000000000001, 32.700000000000024, -50.00000000000044, 42.900000000000006, 41.500000000000014, -50.00000000000044, 41.90000000000001, 40.10000000000002, 39.50000000000002, 28.699999999999967, -50.00000000000044, 37.90000000000003, 42.10000000000001, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.499999999999808, 37.90000000000003, 44.7, 43.50000000000001, 45.1, 44.5, -50.00000000000044, 44.900000000000006, 44.900000000000006, 16.699999999999797, 34.10000000000004, 37.10000000000003, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 46.3, 43.30000000000001, 23.29999999999989, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 19.69999999999984, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 45.3, 46.699999999999996, 45.5, 44.300000000000004, 43.50000000000001, -50.00000000000044, 35.10000000000004, 45.5, 46.3, 35.30000000000004, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 43.10000000000001, 42.500000000000014, -50.00000000000044, 44.5, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 39.300000000000026, -50.00000000000044, 44.7, 44.5, 43.900000000000006, 47.1, 45.5, -50.00000000000044, -50.00000000000044, 42.10000000000001, 43.900000000000006, 46.5, 43.30000000000001], "episode_lengths": [72, 500, 54, 94, 112, 500, 258, 500, 500, 330, 106, 84, 66, 500, 82, 174, 500, 72, 86, 500, 82, 100, 106, 214, 500, 122, 80, 500, 500, 32, 500, 500, 500, 326, 122, 54, 66, 50, 56, 500, 52, 52, 334, 160, 130, 500, 36, 500, 500, 38, 68, 268, 500, 48, 500, 500, 304, 500, 500, 500, 42, 500, 500, 48, 34, 46, 58, 66, 500, 150, 46, 38, 148, 500, 52, 500, 500, 70, 76, 500, 56, 500, 44, 500, 500, 500, 42, 108, 500, 54, 56, 62, 30, 46, 500, 500, 80, 62, 36, 68]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3775569299260199, "mean_inference_ms": 1.2098733561103472, "mean_action_processing_ms": 0.13953740534251108, "mean_env_wait_ms": 0.08408481821233435, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03303718566894531, "StateBufferConnector_ms": 0.011999130249023438, "ViewRequirementAgentConnector_ms": 0.10918450355529785}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.954999999999831, "episode_len_mean": 246.08, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.900000000000006, -50.00000000000044, 44.7, 40.70000000000002, 38.90000000000002, -50.00000000000044, 24.299999999999905, -50.00000000000044, -50.00000000000044, 17.099999999999802, 39.50000000000002, 41.70000000000002, 43.50000000000001, -50.00000000000044, 41.90000000000001, 32.700000000000024, -50.00000000000044, 42.900000000000006, 41.500000000000014, -50.00000000000044, 41.90000000000001, 40.10000000000002, 39.50000000000002, 28.699999999999967, -50.00000000000044, 37.90000000000003, 42.10000000000001, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.499999999999808, 37.90000000000003, 44.7, 43.50000000000001, 45.1, 44.5, -50.00000000000044, 44.900000000000006, 44.900000000000006, 16.699999999999797, 34.10000000000004, 37.10000000000003, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 46.3, 43.30000000000001, 23.29999999999989, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 19.69999999999984, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 45.3, 46.699999999999996, 45.5, 44.300000000000004, 43.50000000000001, -50.00000000000044, 35.10000000000004, 45.5, 46.3, 35.30000000000004, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 43.10000000000001, 42.500000000000014, -50.00000000000044, 44.5, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 39.300000000000026, -50.00000000000044, 44.7, 44.5, 43.900000000000006, 47.1, 45.5, -50.00000000000044, -50.00000000000044, 42.10000000000001, 43.900000000000006, 46.5, 43.30000000000001], "episode_lengths": [72, 500, 54, 94, 112, 500, 258, 500, 500, 330, 106, 84, 66, 500, 82, 174, 500, 72, 86, 500, 82, 100, 106, 214, 500, 122, 80, 500, 500, 32, 500, 500, 500, 326, 122, 54, 66, 50, 56, 500, 52, 52, 334, 160, 130, 500, 36, 500, 500, 38, 68, 268, 500, 48, 500, 500, 304, 500, 500, 500, 42, 500, 500, 48, 34, 46, 58, 66, 500, 150, 46, 38, 148, 500, 52, 500, 500, 70, 76, 500, 56, 500, 44, 500, 500, 500, 42, 108, 500, 54, 56, 62, 30, 46, 500, 500, 80, 62, 36, 68]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3775569299260199, "mean_inference_ms": 1.2098733561103472, "mean_action_processing_ms": 0.13953740534251108, "mean_env_wait_ms": 0.08408481821233435, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03303718566894531, "StateBufferConnector_ms": 0.011999130249023438, "ViewRequirementAgentConnector_ms": 0.10918450355529785}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1386000, "num_agent_steps_trained": 1386000, "num_env_steps_sampled": 1386000, "num_env_steps_trained": 1386000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5707.237919583912, "num_env_steps_trained_throughput_per_sec": 5707.237919583912, "timesteps_total": 1386000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1386000, "timers": {"training_iteration_time_ms": 3119.636, "sample_time_ms": 2828.732, "load_time_ms": 19.48, "load_throughput": 924026.246, "learn_time_ms": 259.546, "learn_throughput": 69351.965, "synch_weights_time_ms": 9.193}, "counters": {"num_env_steps_sampled": 1386000, "num_env_steps_trained": 1386000, "num_agent_steps_sampled": 1386000, "num_agent_steps_trained": 1386000}, "done": false, "episodes_total": 5344, "training_iteration": 77, "trial_id": "9f288_00014", "date": "2023-10-25_16-45-58", "timestamp": 1698248758, "time_this_iter_s": 3.1588892936706543, "time_total_s": 242.7511384487152, "pid": 9504, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 242.7511384487152, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 64.19999999999999, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.3234889800848445e-24, "cur_lr": 0.0003, "total_loss": 6.560401399930318, "policy_loss": -0.0574163980782032, "vf_loss": 6.6178669929504395, "vf_explained_var": -8.841355641682943e-07, "kl": 0.0002849654035799176, "entropy": 0.49191278715928394, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 930.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 1404000, "num_env_steps_trained": 1404000, "num_agent_steps_sampled": 1404000, "num_agent_steps_trained": 1404000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.622999999999827, "episode_len_mean": 249.38, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.5, 46.3, 35.30000000000004, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 43.10000000000001, 42.500000000000014, -50.00000000000044, 44.5, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 39.300000000000026, -50.00000000000044, 44.7, 44.5, 43.900000000000006, 47.1, 45.5, -50.00000000000044, -50.00000000000044, 42.10000000000001, 43.900000000000006, 46.5, 43.30000000000001, -50.00000000000044, -50.00000000000044, 42.70000000000001, 46.9, 35.500000000000036, 46.099999999999994, 25.29999999999992, -50.00000000000044, 45.3, 45.3, 46.9, -50.00000000000044, 44.900000000000006, 33.500000000000036, 44.5, -50.00000000000044, 44.10000000000001, 42.10000000000001, 44.10000000000001, 44.900000000000006, -50.00000000000044, 44.5, 42.500000000000014, 46.5, 45.3, -50.00000000000044, 7.899999999999672, -50.00000000000044, 43.10000000000001, 43.30000000000001, 42.10000000000001, 44.10000000000001, 17.69999999999981, 45.1, 36.50000000000003, -50.00000000000044, 43.30000000000001, 40.500000000000014, 30.499999999999993, -50.00000000000044, 45.1, -50.00000000000044, 34.70000000000004, 46.5, -50.00000000000044, 45.3, 41.90000000000001, -50.00000000000044, -50.00000000000044, 34.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, 27.299999999999947, -50.00000000000044, 40.90000000000002, 35.900000000000034, 39.10000000000002, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [46, 38, 148, 500, 52, 500, 500, 70, 76, 500, 56, 500, 44, 500, 500, 500, 42, 108, 500, 54, 56, 62, 30, 46, 500, 500, 80, 62, 36, 68, 500, 500, 74, 32, 146, 40, 248, 500, 48, 48, 32, 500, 52, 166, 56, 500, 60, 80, 60, 52, 500, 56, 76, 36, 48, 500, 422, 500, 70, 68, 80, 60, 324, 50, 136, 500, 68, 96, 196, 500, 50, 500, 154, 36, 500, 48, 82, 500, 500, 158, 500, 500, 500, 500, 500, 118, 228, 500, 92, 142, 110, 500, 66, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3770586869840182, "mean_inference_ms": 1.2081234579282334, "mean_action_processing_ms": 0.13915451763395237, "mean_env_wait_ms": 0.08380166598035928, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028998374938964844, "StateBufferConnector_ms": 0.008998394012451172, "ViewRequirementAgentConnector_ms": 0.10297846794128418}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.622999999999827, "episode_len_mean": 249.38, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.5, 46.3, 35.30000000000004, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 43.10000000000001, 42.500000000000014, -50.00000000000044, 44.5, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 39.300000000000026, -50.00000000000044, 44.7, 44.5, 43.900000000000006, 47.1, 45.5, -50.00000000000044, -50.00000000000044, 42.10000000000001, 43.900000000000006, 46.5, 43.30000000000001, -50.00000000000044, -50.00000000000044, 42.70000000000001, 46.9, 35.500000000000036, 46.099999999999994, 25.29999999999992, -50.00000000000044, 45.3, 45.3, 46.9, -50.00000000000044, 44.900000000000006, 33.500000000000036, 44.5, -50.00000000000044, 44.10000000000001, 42.10000000000001, 44.10000000000001, 44.900000000000006, -50.00000000000044, 44.5, 42.500000000000014, 46.5, 45.3, -50.00000000000044, 7.899999999999672, -50.00000000000044, 43.10000000000001, 43.30000000000001, 42.10000000000001, 44.10000000000001, 17.69999999999981, 45.1, 36.50000000000003, -50.00000000000044, 43.30000000000001, 40.500000000000014, 30.499999999999993, -50.00000000000044, 45.1, -50.00000000000044, 34.70000000000004, 46.5, -50.00000000000044, 45.3, 41.90000000000001, -50.00000000000044, -50.00000000000044, 34.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, 27.299999999999947, -50.00000000000044, 40.90000000000002, 35.900000000000034, 39.10000000000002, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [46, 38, 148, 500, 52, 500, 500, 70, 76, 500, 56, 500, 44, 500, 500, 500, 42, 108, 500, 54, 56, 62, 30, 46, 500, 500, 80, 62, 36, 68, 500, 500, 74, 32, 146, 40, 248, 500, 48, 48, 32, 500, 52, 166, 56, 500, 60, 80, 60, 52, 500, 56, 76, 36, 48, 500, 422, 500, 70, 68, 80, 60, 324, 50, 136, 500, 68, 96, 196, 500, 50, 500, 154, 36, 500, 48, 82, 500, 500, 158, 500, 500, 500, 500, 500, 118, 228, 500, 92, 142, 110, 500, 66, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3770586869840182, "mean_inference_ms": 1.2081234579282334, "mean_action_processing_ms": 0.13915451763395237, "mean_env_wait_ms": 0.08380166598035928, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028998374938964844, "StateBufferConnector_ms": 0.008998394012451172, "ViewRequirementAgentConnector_ms": 0.10297846794128418}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1404000, "num_agent_steps_trained": 1404000, "num_env_steps_sampled": 1404000, "num_env_steps_trained": 1404000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5991.922776370621, "num_env_steps_trained_throughput_per_sec": 5991.922776370621, "timesteps_total": 1404000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1404000, "timers": {"training_iteration_time_ms": 3095.202, "sample_time_ms": 2821.312, "load_time_ms": 18.38, "load_throughput": 979330.531, "learn_time_ms": 243.498, "learn_throughput": 73922.443, "synch_weights_time_ms": 9.326}, "counters": {"num_env_steps_sampled": 1404000, "num_env_steps_trained": 1404000, "num_agent_steps_sampled": 1404000, "num_agent_steps_trained": 1404000}, "done": false, "episodes_total": 5414, "training_iteration": 78, "trial_id": "9f288_00014", "date": "2023-10-25_16-46-01", "timestamp": 1698248761, "time_this_iter_s": 3.009007453918457, "time_total_s": 245.76014590263367, "pid": 9504, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 245.76014590263367, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 58.825, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.617444900424223e-25, "cur_lr": 0.0003, "total_loss": 6.4911370277404785, "policy_loss": -0.011503484410544237, "vf_loss": 6.502687335014343, "vf_explained_var": -1.2616316477457683e-06, "kl": 5.9086942224932194e-05, "entropy": 0.46700599044561386, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 942.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 1422000, "num_env_steps_trained": 1422000, "num_agent_steps_sampled": 1422000, "num_agent_steps_trained": 1422000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.9149999999998024, "episode_len_mean": 276.42, "episode_media": {}, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 34.70000000000004, 46.5, -50.00000000000044, 45.3, 41.90000000000001, -50.00000000000044, -50.00000000000044, 34.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, 27.299999999999947, -50.00000000000044, 40.90000000000002, 35.900000000000034, 39.10000000000002, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, 45.9, 47.1, -50.00000000000044, -50.00000000000044, 46.5, 44.900000000000006, 42.500000000000014, 45.3, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 9.8999999999997, 45.3, 46.3, 29.49999999999998, -50.00000000000044, 30.29999999999999, -50.00000000000044, -50.00000000000044, 43.900000000000006, 34.900000000000034, 46.3, 45.5, 39.70000000000002, 37.90000000000003, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, 41.90000000000001, 35.900000000000034, 45.1, 29.69999999999998, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 43.7, 44.900000000000006, 37.90000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 46.3, 42.30000000000001, 26.499999999999936, 46.5, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 45.1, 3.699999999999612, 43.900000000000006, 29.69999999999998, 46.3, 45.5, 38.700000000000024, 45.3, 9.099999999999689, 29.899999999999984, -50.00000000000044, -50.00000000000044, 43.30000000000001], "episode_lengths": [500, 154, 36, 500, 48, 82, 500, 500, 158, 500, 500, 500, 500, 500, 118, 228, 500, 92, 142, 110, 500, 66, 500, 500, 500, 500, 500, 500, 500, 500, 500, 94, 42, 30, 500, 500, 36, 52, 76, 48, 30, 500, 500, 500, 402, 48, 38, 206, 500, 198, 500, 500, 62, 152, 38, 46, 104, 122, 500, 94, 500, 500, 82, 142, 50, 204, 40, 500, 500, 500, 36, 500, 64, 52, 122, 500, 500, 500, 48, 38, 78, 236, 36, 500, 500, 56, 500, 50, 464, 62, 204, 38, 46, 114, 48, 410, 202, 500, 500, 68]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3768879496811839, "mean_inference_ms": 1.208338252876013, "mean_action_processing_ms": 0.1394787416307507, "mean_env_wait_ms": 0.08362263523965695, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022001981735229492, "StateBufferConnector_ms": 0.00699925422668457, "ViewRequirementAgentConnector_ms": 0.11401128768920898}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.9149999999998024, "episode_len_mean": 276.42, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 34.70000000000004, 46.5, -50.00000000000044, 45.3, 41.90000000000001, -50.00000000000044, -50.00000000000044, 34.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, 27.299999999999947, -50.00000000000044, 40.90000000000002, 35.900000000000034, 39.10000000000002, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, 45.9, 47.1, -50.00000000000044, -50.00000000000044, 46.5, 44.900000000000006, 42.500000000000014, 45.3, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 9.8999999999997, 45.3, 46.3, 29.49999999999998, -50.00000000000044, 30.29999999999999, -50.00000000000044, -50.00000000000044, 43.900000000000006, 34.900000000000034, 46.3, 45.5, 39.70000000000002, 37.90000000000003, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, 41.90000000000001, 35.900000000000034, 45.1, 29.69999999999998, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 43.7, 44.900000000000006, 37.90000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 46.3, 42.30000000000001, 26.499999999999936, 46.5, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 45.1, 3.699999999999612, 43.900000000000006, 29.69999999999998, 46.3, 45.5, 38.700000000000024, 45.3, 9.099999999999689, 29.899999999999984, -50.00000000000044, -50.00000000000044, 43.30000000000001], "episode_lengths": [500, 154, 36, 500, 48, 82, 500, 500, 158, 500, 500, 500, 500, 500, 118, 228, 500, 92, 142, 110, 500, 66, 500, 500, 500, 500, 500, 500, 500, 500, 500, 94, 42, 30, 500, 500, 36, 52, 76, 48, 30, 500, 500, 500, 402, 48, 38, 206, 500, 198, 500, 500, 62, 152, 38, 46, 104, 122, 500, 94, 500, 500, 82, 142, 50, 204, 40, 500, 500, 500, 36, 500, 64, 52, 122, 500, 500, 500, 48, 38, 78, 236, 36, 500, 500, 56, 500, 50, 464, 62, 204, 38, 46, 114, 48, 410, 202, 500, 500, 68]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3768879496811839, "mean_inference_ms": 1.208338252876013, "mean_action_processing_ms": 0.1394787416307507, "mean_env_wait_ms": 0.08362263523965695, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022001981735229492, "StateBufferConnector_ms": 0.00699925422668457, "ViewRequirementAgentConnector_ms": 0.11401128768920898}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1422000, "num_agent_steps_trained": 1422000, "num_env_steps_sampled": 1422000, "num_env_steps_trained": 1422000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5720.069228035279, "num_env_steps_trained_throughput_per_sec": 5720.069228035279, "timesteps_total": 1422000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1422000, "timers": {"training_iteration_time_ms": 3106.127, "sample_time_ms": 2822.256, "load_time_ms": 19.18, "load_throughput": 938482.839, "learn_time_ms": 252.578, "learn_throughput": 71265.102, "synch_weights_time_ms": 9.323}, "counters": {"num_env_steps_sampled": 1422000, "num_env_steps_trained": 1422000, "num_agent_steps_sampled": 1422000, "num_agent_steps_trained": 1422000}, "done": false, "episodes_total": 5485, "training_iteration": 79, "trial_id": "9f288_00014", "date": "2023-10-25_16-46-04", "timestamp": 1698248764, "time_this_iter_s": 3.1518101692199707, "time_total_s": 248.91195607185364, "pid": 9504, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 248.91195607185364, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 60.620000000000005, "ram_util_percent": 27.240000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.3087224502121113e-25, "cur_lr": 0.0003, "total_loss": 6.866414109865825, "policy_loss": -0.023927368844548862, "vf_loss": 6.890391866366069, "vf_explained_var": -1.241763432820638e-06, "kl": 0.00018365993810339395, "entropy": 0.5034612988432249, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 954.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 1440000, "num_env_steps_trained": 1440000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.633999999999833, "episode_len_mean": 244.32, "episode_media": {}, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 43.7, 44.900000000000006, 37.90000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 46.3, 42.30000000000001, 26.499999999999936, 46.5, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 45.1, 3.699999999999612, 43.900000000000006, 29.69999999999998, 46.3, 45.5, 38.700000000000024, 45.3, 9.099999999999689, 29.899999999999984, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 4.099999999999618, -50.00000000000044, -50.00000000000044, 37.50000000000003, 46.3, 42.900000000000006, -50.00000000000044, 43.50000000000001, 42.70000000000001, 38.10000000000002, -50.00000000000044, 44.5, 43.7, 44.5, 47.3, 44.7, -50.00000000000044, 44.7, 44.5, 6.699999999999655, -50.00000000000044, 46.099999999999994, 36.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, 43.50000000000001, -50.00000000000044, 44.7, 45.1, 27.699999999999953, 46.5, 46.099999999999994, -50.00000000000044, 46.3, 37.90000000000003, 44.900000000000006, 45.5, -50.00000000000044, 44.900000000000006, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 20.099999999999845, 40.500000000000014, 3.699999999999612, 36.30000000000003, 46.3, 42.30000000000001, 34.900000000000034, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, 45.7, -50.00000000000044, 43.7, 44.5, -50.00000000000044, 36.70000000000003, 35.500000000000036, -50.00000000000044, 32.50000000000002, -50.00000000000044, 42.70000000000001], "episode_lengths": [500, 64, 52, 122, 500, 500, 500, 48, 38, 78, 236, 36, 500, 500, 56, 500, 50, 464, 62, 204, 38, 46, 114, 48, 410, 202, 500, 500, 68, 500, 460, 500, 500, 126, 38, 72, 500, 66, 74, 120, 500, 56, 64, 56, 28, 54, 500, 54, 56, 434, 500, 40, 140, 500, 500, 500, 82, 66, 500, 54, 50, 224, 36, 40, 500, 38, 122, 52, 46, 500, 52, 54, 500, 500, 500, 300, 96, 464, 138, 38, 78, 152, 52, 500, 500, 500, 500, 130, 500, 44, 500, 64, 56, 500, 134, 146, 500, 176, 500, 74]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3769224897147925, "mean_inference_ms": 1.2071963936661394, "mean_action_processing_ms": 0.13909748900871174, "mean_env_wait_ms": 0.08389332848598169, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0189971923828125, "StateBufferConnector_ms": 0.0029985904693603516, "ViewRequirementAgentConnector_ms": 0.12197756767272949}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.633999999999833, "episode_len_mean": 244.32, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 43.7, 44.900000000000006, 37.90000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 46.3, 42.30000000000001, 26.499999999999936, 46.5, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 45.1, 3.699999999999612, 43.900000000000006, 29.69999999999998, 46.3, 45.5, 38.700000000000024, 45.3, 9.099999999999689, 29.899999999999984, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 4.099999999999618, -50.00000000000044, -50.00000000000044, 37.50000000000003, 46.3, 42.900000000000006, -50.00000000000044, 43.50000000000001, 42.70000000000001, 38.10000000000002, -50.00000000000044, 44.5, 43.7, 44.5, 47.3, 44.7, -50.00000000000044, 44.7, 44.5, 6.699999999999655, -50.00000000000044, 46.099999999999994, 36.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, 43.50000000000001, -50.00000000000044, 44.7, 45.1, 27.699999999999953, 46.5, 46.099999999999994, -50.00000000000044, 46.3, 37.90000000000003, 44.900000000000006, 45.5, -50.00000000000044, 44.900000000000006, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 20.099999999999845, 40.500000000000014, 3.699999999999612, 36.30000000000003, 46.3, 42.30000000000001, 34.900000000000034, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, 45.7, -50.00000000000044, 43.7, 44.5, -50.00000000000044, 36.70000000000003, 35.500000000000036, -50.00000000000044, 32.50000000000002, -50.00000000000044, 42.70000000000001], "episode_lengths": [500, 64, 52, 122, 500, 500, 500, 48, 38, 78, 236, 36, 500, 500, 56, 500, 50, 464, 62, 204, 38, 46, 114, 48, 410, 202, 500, 500, 68, 500, 460, 500, 500, 126, 38, 72, 500, 66, 74, 120, 500, 56, 64, 56, 28, 54, 500, 54, 56, 434, 500, 40, 140, 500, 500, 500, 82, 66, 500, 54, 50, 224, 36, 40, 500, 38, 122, 52, 46, 500, 52, 54, 500, 500, 500, 300, 96, 464, 138, 38, 78, 152, 52, 500, 500, 500, 500, 130, 500, 44, 500, 64, 56, 500, 134, 146, 500, 176, 500, 74]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3769224897147925, "mean_inference_ms": 1.2071963936661394, "mean_action_processing_ms": 0.13909748900871174, "mean_env_wait_ms": 0.08389332848598169, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0189971923828125, "StateBufferConnector_ms": 0.0029985904693603516, "ViewRequirementAgentConnector_ms": 0.12197756767272949}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000, "num_env_steps_sampled": 1440000, "num_env_steps_trained": 1440000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5989.409100811239, "num_env_steps_trained_throughput_per_sec": 5989.409100811239, "timesteps_total": 1440000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1440000, "timers": {"training_iteration_time_ms": 3093.138, "sample_time_ms": 2814.401, "load_time_ms": 18.18, "load_throughput": 990072.35, "learn_time_ms": 248.36, "learn_throughput": 72475.442, "synch_weights_time_ms": 9.407}, "counters": {"num_env_steps_sampled": 1440000, "num_env_steps_trained": 1440000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "done": false, "episodes_total": 5556, "training_iteration": 80, "trial_id": "9f288_00014", "date": "2023-10-25_16-46-07", "timestamp": 1698248767, "time_this_iter_s": 3.0103042125701904, "time_total_s": 251.92226028442383, "pid": 9504, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 251.92226028442383, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 63.150000000000006, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.6543612251060557e-25, "cur_lr": 0.0003, "total_loss": 6.996262113253276, "policy_loss": 0.026697817918223638, "vf_loss": 6.969615499178569, "vf_explained_var": -8.841355641682943e-07, "kl": 0.00040756890894044773, "entropy": 0.5086535414059957, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 966.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 1458000, "num_env_steps_trained": 1458000, "num_agent_steps_sampled": 1458000, "num_agent_steps_trained": 1458000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.307999999999827, "episode_len_mean": 257.58, "episode_media": {}, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 20.099999999999845, 40.500000000000014, 3.699999999999612, 36.30000000000003, 46.3, 42.30000000000001, 34.900000000000034, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, 45.7, -50.00000000000044, 43.7, 44.5, -50.00000000000044, 36.70000000000003, 35.500000000000036, -50.00000000000044, 32.50000000000002, -50.00000000000044, 42.70000000000001, -50.00000000000044, 43.30000000000001, 5.899999999999643, 45.5, 45.1, -50.00000000000044, -50.00000000000044, 9.699999999999697, 0.2999999999995637, 43.30000000000001, 42.70000000000001, -50.00000000000044, 41.30000000000001, 40.70000000000002, 40.30000000000002, -50.00000000000044, 46.099999999999994, 27.49999999999995, 46.9, 46.3, 44.900000000000006, -50.00000000000044, 44.7, 46.099999999999994, -50.00000000000044, -50.00000000000044, 46.3, 37.90000000000003, 43.30000000000001, 34.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 45.3, 39.50000000000002, -50.00000000000044, 46.3, 43.900000000000006, 35.10000000000004, 6.299999999999649, 39.50000000000002, 44.10000000000001, 40.10000000000002, 44.7, 45.7, 31.900000000000013, -50.00000000000044, 30.099999999999987, 43.7, 27.299999999999947, 2.0999999999995893, 44.10000000000001, 45.5, 42.30000000000001, 22.099999999999874, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 46.5, 38.10000000000002, 41.30000000000001, 29.899999999999984, -50.00000000000044, 14.299999999999763, 45.5], "episode_lengths": [500, 300, 96, 464, 138, 38, 78, 152, 52, 500, 500, 500, 500, 130, 500, 44, 500, 64, 56, 500, 134, 146, 500, 176, 500, 74, 500, 68, 442, 46, 50, 500, 500, 404, 498, 68, 74, 500, 88, 94, 98, 500, 40, 226, 32, 38, 52, 500, 54, 40, 500, 500, 38, 122, 68, 152, 500, 500, 500, 500, 500, 76, 500, 500, 48, 106, 500, 38, 62, 150, 438, 106, 60, 100, 54, 44, 182, 500, 200, 64, 228, 480, 60, 46, 78, 280, 500, 500, 500, 500, 500, 74, 500, 36, 120, 88, 202, 500, 358, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.377353977004829, "mean_inference_ms": 1.209731099962297, "mean_action_processing_ms": 0.13980990648094552, "mean_env_wait_ms": 0.08379029425557835, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02599358558654785, "StateBufferConnector_ms": 0.004998922348022461, "ViewRequirementAgentConnector_ms": 0.15301752090454102}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.307999999999827, "episode_len_mean": 257.58, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 20.099999999999845, 40.500000000000014, 3.699999999999612, 36.30000000000003, 46.3, 42.30000000000001, 34.900000000000034, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, 45.7, -50.00000000000044, 43.7, 44.5, -50.00000000000044, 36.70000000000003, 35.500000000000036, -50.00000000000044, 32.50000000000002, -50.00000000000044, 42.70000000000001, -50.00000000000044, 43.30000000000001, 5.899999999999643, 45.5, 45.1, -50.00000000000044, -50.00000000000044, 9.699999999999697, 0.2999999999995637, 43.30000000000001, 42.70000000000001, -50.00000000000044, 41.30000000000001, 40.70000000000002, 40.30000000000002, -50.00000000000044, 46.099999999999994, 27.49999999999995, 46.9, 46.3, 44.900000000000006, -50.00000000000044, 44.7, 46.099999999999994, -50.00000000000044, -50.00000000000044, 46.3, 37.90000000000003, 43.30000000000001, 34.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 45.3, 39.50000000000002, -50.00000000000044, 46.3, 43.900000000000006, 35.10000000000004, 6.299999999999649, 39.50000000000002, 44.10000000000001, 40.10000000000002, 44.7, 45.7, 31.900000000000013, -50.00000000000044, 30.099999999999987, 43.7, 27.299999999999947, 2.0999999999995893, 44.10000000000001, 45.5, 42.30000000000001, 22.099999999999874, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 46.5, 38.10000000000002, 41.30000000000001, 29.899999999999984, -50.00000000000044, 14.299999999999763, 45.5], "episode_lengths": [500, 300, 96, 464, 138, 38, 78, 152, 52, 500, 500, 500, 500, 130, 500, 44, 500, 64, 56, 500, 134, 146, 500, 176, 500, 74, 500, 68, 442, 46, 50, 500, 500, 404, 498, 68, 74, 500, 88, 94, 98, 500, 40, 226, 32, 38, 52, 500, 54, 40, 500, 500, 38, 122, 68, 152, 500, 500, 500, 500, 500, 76, 500, 500, 48, 106, 500, 38, 62, 150, 438, 106, 60, 100, 54, 44, 182, 500, 200, 64, 228, 480, 60, 46, 78, 280, 500, 500, 500, 500, 500, 74, 500, 36, 120, 88, 202, 500, 358, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.377353977004829, "mean_inference_ms": 1.209731099962297, "mean_action_processing_ms": 0.13980990648094552, "mean_env_wait_ms": 0.08379029425557835, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02599358558654785, "StateBufferConnector_ms": 0.004998922348022461, "ViewRequirementAgentConnector_ms": 0.15301752090454102}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1458000, "num_agent_steps_trained": 1458000, "num_env_steps_sampled": 1458000, "num_env_steps_trained": 1458000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5766.310421500091, "num_env_steps_trained_throughput_per_sec": 5766.310421500091, "timesteps_total": 1458000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1458000, "timers": {"training_iteration_time_ms": 3103.11, "sample_time_ms": 2815.109, "load_time_ms": 19.024, "load_throughput": 946161.863, "learn_time_ms": 256.799, "learn_throughput": 70093.612, "synch_weights_time_ms": 9.387}, "counters": {"num_env_steps_sampled": 1458000, "num_env_steps_trained": 1458000, "num_agent_steps_sampled": 1458000, "num_agent_steps_trained": 1458000}, "done": false, "episodes_total": 5630, "training_iteration": 81, "trial_id": "9f288_00014", "date": "2023-10-25_16-46-10", "timestamp": 1698248770, "time_this_iter_s": 3.1265807151794434, "time_total_s": 255.04884099960327, "pid": 9504, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 255.04884099960327, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 61.15, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.271806125530278e-26, "cur_lr": 0.0003, "total_loss": 7.081886728604634, "policy_loss": -0.013928898862407854, "vf_loss": 7.095868825912476, "vf_explained_var": -8.245309193929037e-07, "kl": 0.0005530518304131723, "entropy": 0.5328335811694463, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 978.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 1476000, "num_env_steps_trained": 1476000, "num_agent_steps_sampled": 1476000, "num_agent_steps_trained": 1476000}, "sampler_results": {"episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.638999999999819, "episode_len_mean": 269.26, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.3, 39.50000000000002, -50.00000000000044, 46.3, 43.900000000000006, 35.10000000000004, 6.299999999999649, 39.50000000000002, 44.10000000000001, 40.10000000000002, 44.7, 45.7, 31.900000000000013, -50.00000000000044, 30.099999999999987, 43.7, 27.299999999999947, 2.0999999999995893, 44.10000000000001, 45.5, 42.30000000000001, 22.099999999999874, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 46.5, 38.10000000000002, 41.30000000000001, 29.899999999999984, -50.00000000000044, 14.299999999999763, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 41.70000000000002, -50.00000000000044, 43.900000000000006, 41.70000000000002, 8.899999999999686, 45.1, 39.10000000000002, 2.8999999999996007, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.699999999999953, 45.7, -50.00000000000044, -50.00000000000044, 30.099999999999987, -50.00000000000044, 43.900000000000006, -50.00000000000044, 39.300000000000026, -50.00000000000044, 39.50000000000002, -50.00000000000044, 44.10000000000001, 43.900000000000006, 15.299999999999777, -50.00000000000044, 16.8999999999998, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 37.90000000000003, 43.10000000000001, 42.900000000000006, 39.50000000000002, 5.299999999999635, -50.00000000000044, 45.7, -50.00000000000044, 45.9, 15.699999999999783, 42.500000000000014, 34.70000000000004, 23.699999999999896, -50.00000000000044, -50.00000000000044, 25.099999999999916, 43.900000000000006, -50.00000000000044, 43.900000000000006, 43.30000000000001, -50.00000000000044, 39.50000000000002, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 34.50000000000004, 24.099999999999902], "episode_lengths": [48, 106, 500, 38, 62, 150, 438, 106, 60, 100, 54, 44, 182, 500, 200, 64, 228, 480, 60, 46, 78, 280, 500, 500, 500, 500, 500, 74, 500, 36, 120, 88, 202, 500, 358, 46, 500, 500, 500, 66, 84, 500, 62, 84, 412, 50, 110, 472, 500, 500, 500, 224, 44, 500, 500, 200, 500, 62, 500, 108, 500, 106, 500, 60, 62, 348, 500, 332, 500, 500, 38, 500, 122, 70, 72, 106, 448, 500, 44, 500, 42, 344, 76, 154, 264, 500, 500, 250, 62, 500, 62, 68, 500, 106, 500, 48, 500, 500, 156, 260]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3773583509358928, "mean_inference_ms": 1.2096251807512473, "mean_action_processing_ms": 0.13974293461162202, "mean_env_wait_ms": 0.08381244573598828, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024020910263061523, "StateBufferConnector_ms": 0.007001638412475586, "ViewRequirementAgentConnector_ms": 0.1490185260772705}}, "episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.638999999999819, "episode_len_mean": 269.26, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.3, 39.50000000000002, -50.00000000000044, 46.3, 43.900000000000006, 35.10000000000004, 6.299999999999649, 39.50000000000002, 44.10000000000001, 40.10000000000002, 44.7, 45.7, 31.900000000000013, -50.00000000000044, 30.099999999999987, 43.7, 27.299999999999947, 2.0999999999995893, 44.10000000000001, 45.5, 42.30000000000001, 22.099999999999874, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 46.5, 38.10000000000002, 41.30000000000001, 29.899999999999984, -50.00000000000044, 14.299999999999763, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 41.70000000000002, -50.00000000000044, 43.900000000000006, 41.70000000000002, 8.899999999999686, 45.1, 39.10000000000002, 2.8999999999996007, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.699999999999953, 45.7, -50.00000000000044, -50.00000000000044, 30.099999999999987, -50.00000000000044, 43.900000000000006, -50.00000000000044, 39.300000000000026, -50.00000000000044, 39.50000000000002, -50.00000000000044, 44.10000000000001, 43.900000000000006, 15.299999999999777, -50.00000000000044, 16.8999999999998, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 37.90000000000003, 43.10000000000001, 42.900000000000006, 39.50000000000002, 5.299999999999635, -50.00000000000044, 45.7, -50.00000000000044, 45.9, 15.699999999999783, 42.500000000000014, 34.70000000000004, 23.699999999999896, -50.00000000000044, -50.00000000000044, 25.099999999999916, 43.900000000000006, -50.00000000000044, 43.900000000000006, 43.30000000000001, -50.00000000000044, 39.50000000000002, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 34.50000000000004, 24.099999999999902], "episode_lengths": [48, 106, 500, 38, 62, 150, 438, 106, 60, 100, 54, 44, 182, 500, 200, 64, 228, 480, 60, 46, 78, 280, 500, 500, 500, 500, 500, 74, 500, 36, 120, 88, 202, 500, 358, 46, 500, 500, 500, 66, 84, 500, 62, 84, 412, 50, 110, 472, 500, 500, 500, 224, 44, 500, 500, 200, 500, 62, 500, 108, 500, 106, 500, 60, 62, 348, 500, 332, 500, 500, 38, 500, 122, 70, 72, 106, 448, 500, 44, 500, 42, 344, 76, 154, 264, 500, 500, 250, 62, 500, 62, 68, 500, 106, 500, 48, 500, 500, 156, 260]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3773583509358928, "mean_inference_ms": 1.2096251807512473, "mean_action_processing_ms": 0.13974293461162202, "mean_env_wait_ms": 0.08381244573598828, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024020910263061523, "StateBufferConnector_ms": 0.007001638412475586, "ViewRequirementAgentConnector_ms": 0.1490185260772705}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1476000, "num_agent_steps_trained": 1476000, "num_env_steps_sampled": 1476000, "num_env_steps_trained": 1476000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5662.01371048157, "num_env_steps_trained_throughput_per_sec": 5662.01371048157, "timesteps_total": 1476000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1476000, "timers": {"training_iteration_time_ms": 3093.267, "sample_time_ms": 2811.228, "load_time_ms": 18.924, "load_throughput": 951161.237, "learn_time_ms": 250.908, "learn_throughput": 71739.39, "synch_weights_time_ms": 9.416}, "counters": {"num_env_steps_sampled": 1476000, "num_env_steps_trained": 1476000, "num_agent_steps_sampled": 1476000, "num_agent_steps_trained": 1476000}, "done": false, "episodes_total": 5694, "training_iteration": 82, "trial_id": "9f288_00014", "date": "2023-10-25_16-46-13", "timestamp": 1698248773, "time_this_iter_s": 3.184077501296997, "time_total_s": 258.23291850090027, "pid": 9504, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 258.23291850090027, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 59.620000000000005, "ram_util_percent": 27.22}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.135903062765139e-26, "cur_lr": 0.0003, "total_loss": 6.733035882314046, "policy_loss": -0.03204279625788331, "vf_loss": 6.7651313940684, "vf_explained_var": -9.437402089436849e-07, "kl": 0.00036395013792874426, "entropy": 0.5274746517340342, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 990.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 1494000, "num_env_steps_trained": 1494000, "num_agent_steps_sampled": 1494000, "num_agent_steps_trained": 1494000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.2149999999998276, "episode_len_mean": 253.5, "episode_media": {}, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 37.90000000000003, 43.10000000000001, 42.900000000000006, 39.50000000000002, 5.299999999999635, -50.00000000000044, 45.7, -50.00000000000044, 45.9, 15.699999999999783, 42.500000000000014, 34.70000000000004, 23.699999999999896, -50.00000000000044, -50.00000000000044, 25.099999999999916, 43.900000000000006, -50.00000000000044, 43.900000000000006, 43.30000000000001, -50.00000000000044, 39.50000000000002, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 34.50000000000004, 24.099999999999902, 43.50000000000001, -50.00000000000044, 45.3, 41.500000000000014, 31.1, 41.90000000000001, 45.3, 34.70000000000004, -50.00000000000044, 42.10000000000001, 45.5, -50.00000000000044, 46.099999999999994, 44.5, 45.7, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 42.10000000000001, 46.3, 3.499999999999609, 44.10000000000001, 37.90000000000003, 41.500000000000014, -50.00000000000044, 26.69999999999994, -50.00000000000044, -50.00000000000044, 21.89999999999987, -50.00000000000044, 24.099999999999902, 45.7, -50.00000000000044, -50.00000000000044, 16.699999999999797, 41.30000000000001, 35.10000000000004, 43.7, -50.00000000000044, 44.5, 47.3, 6.699999999999655, -50.00000000000044, 37.10000000000003, 45.1, -50.00000000000044, 46.3, -50.00000000000044, 41.500000000000014, 44.900000000000006, 46.099999999999994, 45.9, 40.10000000000002, -50.00000000000044, 45.7, 41.70000000000002, -50.00000000000044, -50.00000000000044, 45.3, 45.1, 22.099999999999874, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, 43.7, 42.900000000000006, -50.00000000000044], "episode_lengths": [500, 122, 70, 72, 106, 448, 500, 44, 500, 42, 344, 76, 154, 264, 500, 500, 250, 62, 500, 62, 68, 500, 106, 500, 48, 500, 500, 156, 260, 66, 500, 48, 86, 190, 82, 48, 154, 500, 80, 46, 500, 40, 56, 44, 500, 50, 500, 500, 80, 38, 466, 60, 122, 86, 500, 234, 500, 500, 282, 500, 260, 44, 500, 500, 334, 88, 150, 64, 500, 56, 28, 434, 500, 130, 50, 500, 38, 500, 86, 52, 40, 42, 100, 500, 44, 84, 500, 500, 48, 50, 280, 500, 500, 500, 500, 500, 100, 64, 72, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3770384885144786, "mean_inference_ms": 1.2089878156377423, "mean_action_processing_ms": 0.13967989060910518, "mean_env_wait_ms": 0.0837117527905335, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025030851364135742, "StateBufferConnector_ms": 0.007575273513793945, "ViewRequirementAgentConnector_ms": 0.11501049995422363}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.2149999999998276, "episode_len_mean": 253.5, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 37.90000000000003, 43.10000000000001, 42.900000000000006, 39.50000000000002, 5.299999999999635, -50.00000000000044, 45.7, -50.00000000000044, 45.9, 15.699999999999783, 42.500000000000014, 34.70000000000004, 23.699999999999896, -50.00000000000044, -50.00000000000044, 25.099999999999916, 43.900000000000006, -50.00000000000044, 43.900000000000006, 43.30000000000001, -50.00000000000044, 39.50000000000002, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 34.50000000000004, 24.099999999999902, 43.50000000000001, -50.00000000000044, 45.3, 41.500000000000014, 31.1, 41.90000000000001, 45.3, 34.70000000000004, -50.00000000000044, 42.10000000000001, 45.5, -50.00000000000044, 46.099999999999994, 44.5, 45.7, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 42.10000000000001, 46.3, 3.499999999999609, 44.10000000000001, 37.90000000000003, 41.500000000000014, -50.00000000000044, 26.69999999999994, -50.00000000000044, -50.00000000000044, 21.89999999999987, -50.00000000000044, 24.099999999999902, 45.7, -50.00000000000044, -50.00000000000044, 16.699999999999797, 41.30000000000001, 35.10000000000004, 43.7, -50.00000000000044, 44.5, 47.3, 6.699999999999655, -50.00000000000044, 37.10000000000003, 45.1, -50.00000000000044, 46.3, -50.00000000000044, 41.500000000000014, 44.900000000000006, 46.099999999999994, 45.9, 40.10000000000002, -50.00000000000044, 45.7, 41.70000000000002, -50.00000000000044, -50.00000000000044, 45.3, 45.1, 22.099999999999874, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, 43.7, 42.900000000000006, -50.00000000000044], "episode_lengths": [500, 122, 70, 72, 106, 448, 500, 44, 500, 42, 344, 76, 154, 264, 500, 500, 250, 62, 500, 62, 68, 500, 106, 500, 48, 500, 500, 156, 260, 66, 500, 48, 86, 190, 82, 48, 154, 500, 80, 46, 500, 40, 56, 44, 500, 50, 500, 500, 80, 38, 466, 60, 122, 86, 500, 234, 500, 500, 282, 500, 260, 44, 500, 500, 334, 88, 150, 64, 500, 56, 28, 434, 500, 130, 50, 500, 38, 500, 86, 52, 40, 42, 100, 500, 44, 84, 500, 500, 48, 50, 280, 500, 500, 500, 500, 500, 100, 64, 72, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3770384885144786, "mean_inference_ms": 1.2089878156377423, "mean_action_processing_ms": 0.13967989060910518, "mean_env_wait_ms": 0.0837117527905335, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025030851364135742, "StateBufferConnector_ms": 0.007575273513793945, "ViewRequirementAgentConnector_ms": 0.11501049995422363}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1494000, "num_agent_steps_trained": 1494000, "num_env_steps_sampled": 1494000, "num_env_steps_trained": 1494000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5874.3209582793315, "num_env_steps_trained_throughput_per_sec": 5874.3209582793315, "timesteps_total": 1494000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1494000, "timers": {"training_iteration_time_ms": 3094.178, "sample_time_ms": 2812.572, "load_time_ms": 19.229, "load_throughput": 936079.987, "learn_time_ms": 250.19, "learn_throughput": 71945.186, "synch_weights_time_ms": 9.496}, "counters": {"num_env_steps_sampled": 1494000, "num_env_steps_trained": 1494000, "num_agent_steps_sampled": 1494000, "num_agent_steps_trained": 1494000}, "done": false, "episodes_total": 5765, "training_iteration": 83, "trial_id": "9f288_00014", "date": "2023-10-25_16-46-16", "timestamp": 1698248776, "time_this_iter_s": 3.069964647293091, "time_total_s": 261.30288314819336, "pid": 9504, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 261.30288314819336, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 61.300000000000004, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.0679515313825696e-26, "cur_lr": 0.0003, "total_loss": 6.373371918996175, "policy_loss": 0.006299422665809591, "vf_loss": 6.367122928301494, "vf_explained_var": -8.891026178995768e-07, "kl": 0.0007479330368151219, "entropy": 0.5037670011321703, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1002.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 1512000, "num_env_steps_trained": 1512000, "num_agent_steps_sampled": 1512000, "num_agent_steps_trained": 1512000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.2880000000002056, "episode_len_mean": 283.44, "episode_media": {}, "episodes_this_iter": 62, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 16.699999999999797, 41.30000000000001, 35.10000000000004, 43.7, -50.00000000000044, 44.5, 47.3, 6.699999999999655, -50.00000000000044, 37.10000000000003, 45.1, -50.00000000000044, 46.3, -50.00000000000044, 41.500000000000014, 44.900000000000006, 46.099999999999994, 45.9, 40.10000000000002, -50.00000000000044, 45.7, 41.70000000000002, -50.00000000000044, -50.00000000000044, 45.3, 45.1, 22.099999999999874, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, 43.7, 42.900000000000006, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.50000000000002, 29.899999999999984, 46.699999999999996, 41.90000000000001, 35.70000000000003, 30.499999999999993, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 29.299999999999976, 6.299999999999649, 19.69999999999984, 43.7, -50.00000000000044, 43.10000000000001, 36.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 35.70000000000003, 43.50000000000001, 43.7, 45.3, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 20.299999999999848, -50.00000000000044, 47.5, 43.900000000000006, -50.00000000000044, 38.300000000000026, -50.00000000000044, 43.10000000000001, -50.00000000000044, 47.3, 32.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 43.10000000000001, -50.00000000000044, 40.30000000000002, -50.00000000000044, 45.1, 26.89999999999994], "episode_lengths": [500, 500, 334, 88, 150, 64, 500, 56, 28, 434, 500, 130, 50, 500, 38, 500, 86, 52, 40, 42, 100, 500, 44, 84, 500, 500, 48, 50, 280, 500, 500, 500, 500, 500, 100, 64, 72, 500, 500, 48, 500, 60, 500, 500, 500, 500, 176, 202, 34, 82, 144, 196, 500, 500, 500, 60, 500, 208, 438, 304, 64, 500, 70, 140, 500, 500, 500, 500, 40, 144, 66, 64, 48, 500, 40, 500, 500, 298, 500, 26, 62, 500, 118, 500, 70, 500, 28, 180, 500, 500, 500, 500, 50, 500, 70, 500, 98, 500, 50, 232]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37704640909831844, "mean_inference_ms": 1.2097298989263576, "mean_action_processing_ms": 0.14031034646247023, "mean_env_wait_ms": 0.08369392554386672, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02600836753845215, "StateBufferConnector_ms": 0.007574796676635742, "ViewRequirementAgentConnector_ms": 0.11801028251647949}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.2880000000002056, "episode_len_mean": 283.44, "episodes_this_iter": 62, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 16.699999999999797, 41.30000000000001, 35.10000000000004, 43.7, -50.00000000000044, 44.5, 47.3, 6.699999999999655, -50.00000000000044, 37.10000000000003, 45.1, -50.00000000000044, 46.3, -50.00000000000044, 41.500000000000014, 44.900000000000006, 46.099999999999994, 45.9, 40.10000000000002, -50.00000000000044, 45.7, 41.70000000000002, -50.00000000000044, -50.00000000000044, 45.3, 45.1, 22.099999999999874, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, 43.7, 42.900000000000006, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.50000000000002, 29.899999999999984, 46.699999999999996, 41.90000000000001, 35.70000000000003, 30.499999999999993, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 29.299999999999976, 6.299999999999649, 19.69999999999984, 43.7, -50.00000000000044, 43.10000000000001, 36.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 35.70000000000003, 43.50000000000001, 43.7, 45.3, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 20.299999999999848, -50.00000000000044, 47.5, 43.900000000000006, -50.00000000000044, 38.300000000000026, -50.00000000000044, 43.10000000000001, -50.00000000000044, 47.3, 32.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 43.10000000000001, -50.00000000000044, 40.30000000000002, -50.00000000000044, 45.1, 26.89999999999994], "episode_lengths": [500, 500, 334, 88, 150, 64, 500, 56, 28, 434, 500, 130, 50, 500, 38, 500, 86, 52, 40, 42, 100, 500, 44, 84, 500, 500, 48, 50, 280, 500, 500, 500, 500, 500, 100, 64, 72, 500, 500, 48, 500, 60, 500, 500, 500, 500, 176, 202, 34, 82, 144, 196, 500, 500, 500, 60, 500, 208, 438, 304, 64, 500, 70, 140, 500, 500, 500, 500, 40, 144, 66, 64, 48, 500, 40, 500, 500, 298, 500, 26, 62, 500, 118, 500, 70, 500, 28, 180, 500, 500, 500, 500, 50, 500, 70, 500, 98, 500, 50, 232]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37704640909831844, "mean_inference_ms": 1.2097298989263576, "mean_action_processing_ms": 0.14031034646247023, "mean_env_wait_ms": 0.08369392554386672, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02600836753845215, "StateBufferConnector_ms": 0.007574796676635742, "ViewRequirementAgentConnector_ms": 0.11801028251647949}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1512000, "num_agent_steps_trained": 1512000, "num_env_steps_sampled": 1512000, "num_env_steps_trained": 1512000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5493.782576310831, "num_env_steps_trained_throughput_per_sec": 5493.782576310831, "timesteps_total": 1512000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1512000, "timers": {"training_iteration_time_ms": 3109.683, "sample_time_ms": 2822.569, "load_time_ms": 19.292, "load_throughput": 933010.933, "learn_time_ms": 255.411, "learn_throughput": 70474.737, "synch_weights_time_ms": 9.643}, "counters": {"num_env_steps_sampled": 1512000, "num_env_steps_trained": 1512000, "num_agent_steps_sampled": 1512000, "num_agent_steps_trained": 1512000}, "done": true, "episodes_total": 5827, "training_iteration": 84, "trial_id": "9f288_00014", "date": "2023-10-25_16-46-20", "timestamp": 1698248780, "time_this_iter_s": 3.281428575515747, "time_total_s": 264.5843117237091, "pid": 9504, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 264.5843117237091, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 56.11999999999999, "ram_util_percent": 27.22}}
