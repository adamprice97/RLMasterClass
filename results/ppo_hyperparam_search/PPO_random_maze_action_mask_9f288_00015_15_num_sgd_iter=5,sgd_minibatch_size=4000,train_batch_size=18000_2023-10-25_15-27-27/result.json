{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0003, "total_loss": 9.249333810806274, "policy_loss": -0.04843913409858942, "vf_loss": 9.29716091156006, "vf_explained_var": 0.0001963973045349121, "kl": 0.0034215266432076653, "entropy": 0.7213364750146866, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 10.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 18000, "num_env_steps_trained": 18000, "num_agent_steps_sampled": 18000, "num_agent_steps_trained": 18000}, "sampler_results": {"episode_reward_max": 39.300000000000026, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -29.808108108108474, "episode_len_mean": 447.02702702702703, "episode_media": {}, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.499999999999808, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.499999999999893, -50.00000000000044, -50.00000000000044, -50.00000000000044, 22.699999999999882, 17.499999999999808, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 4.099999999999618, 14.499999999999766, 39.300000000000026, 6.299999999999649, 7.899999999999672, -50.00000000000044, 32.700000000000024, 11.099999999999717, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 500, 500, 500, 326, 500, 500, 500, 500, 500, 500, 500, 266, 500, 500, 500, 274, 326, 500, 500, 500, 500, 500, 500, 460, 356, 108, 438, 422, 500, 174, 390, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3896709444680109, "mean_inference_ms": 1.2552884708704497, "mean_action_processing_ms": 0.15077148852509833, "mean_env_wait_ms": 0.08736736505661837, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.037821563514503276, "StateBufferConnector_ms": 0.004883070249815245, "ViewRequirementAgentConnector_ms": 0.13014496983708562}}, "episode_reward_max": 39.300000000000026, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -29.808108108108474, "episode_len_mean": 447.02702702702703, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.499999999999808, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.499999999999893, -50.00000000000044, -50.00000000000044, -50.00000000000044, 22.699999999999882, 17.499999999999808, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 4.099999999999618, 14.499999999999766, 39.300000000000026, 6.299999999999649, 7.899999999999672, -50.00000000000044, 32.700000000000024, 11.099999999999717, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 500, 500, 500, 326, 500, 500, 500, 500, 500, 500, 500, 266, 500, 500, 500, 274, 326, 500, 500, 500, 500, 500, 500, 460, 356, 108, 438, 422, 500, 174, 390, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3896709444680109, "mean_inference_ms": 1.2552884708704497, "mean_action_processing_ms": 0.15077148852509833, "mean_env_wait_ms": 0.08736736505661837, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.037821563514503276, "StateBufferConnector_ms": 0.004883070249815245, "ViewRequirementAgentConnector_ms": 0.13014496983708562}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18000, "num_agent_steps_trained": 18000, "num_env_steps_sampled": 18000, "num_env_steps_trained": 18000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5761.199077688899, "num_env_steps_trained_throughput_per_sec": 5761.199077688899, "timesteps_total": 18000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 18000, "timers": {"training_iteration_time_ms": 3124.35, "sample_time_ms": 2958.008, "load_time_ms": 9.779, "load_throughput": 1840728.319, "learn_time_ms": 143.56, "learn_throughput": 125383.382, "synch_weights_time_ms": 11.003}, "counters": {"num_env_steps_sampled": 18000, "num_env_steps_trained": 18000, "num_agent_steps_sampled": 18000, "num_agent_steps_trained": 18000}, "done": false, "episodes_total": 37, "training_iteration": 1, "trial_id": "9f288_00015", "date": "2023-10-25_16-46-44", "timestamp": 1698248804, "time_this_iter_s": 3.12945818901062, "time_total_s": 3.12945818901062, "pid": 4200, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 3.12945818901062, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 64.64, "ram_util_percent": 26.98}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0003, "total_loss": 8.995088529586791, "policy_loss": -0.014091587066650391, "vf_loss": 9.008844757080078, "vf_explained_var": 1.3518333435058594e-05, "kl": 0.004075160068532568, "entropy": 0.7200984418392181, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 30.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "sampler_results": {"episode_reward_max": 43.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -19.060975609756415, "episode_len_mean": 410.5609756097561, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.499999999999808, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.499999999999893, -50.00000000000044, -50.00000000000044, -50.00000000000044, 22.699999999999882, 17.499999999999808, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 4.099999999999618, 14.499999999999766, 39.300000000000026, 6.299999999999649, 7.899999999999672, -50.00000000000044, 32.700000000000024, 11.099999999999717, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 16.09999999999979, -50.00000000000044, 23.699999999999896, -50.00000000000044, -50.00000000000044, -50.00000000000044, 2.0999999999995893, 3.899999999999615, -50.00000000000044, 18.899999999999828, 12.899999999999743, 19.299999999999834, -50.00000000000044, 5.899999999999643, -50.00000000000044, -50.00000000000044, 10.899999999999714, 31.900000000000013, 38.90000000000002, -50.00000000000044, -50.00000000000044, 19.09999999999983, 22.699999999999882, 19.299999999999834, 33.70000000000004, 14.499999999999766, 32.700000000000024, 37.50000000000003, -50.00000000000044, 24.499999999999908, -50.00000000000044, 28.29999999999996, -50.00000000000044, 19.899999999999842, 23.29999999999989, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 23.699999999999896, -50.00000000000044, 12.499999999999737], "episode_lengths": [500, 500, 500, 500, 500, 326, 500, 500, 500, 500, 500, 500, 500, 266, 500, 500, 500, 274, 326, 500, 500, 500, 500, 500, 500, 460, 356, 108, 438, 422, 500, 174, 390, 500, 500, 500, 500, 340, 500, 264, 500, 500, 500, 480, 462, 500, 312, 372, 308, 500, 442, 500, 500, 392, 182, 112, 500, 500, 310, 274, 308, 164, 356, 174, 126, 500, 256, 500, 218, 500, 302, 268, 500, 500, 500, 500, 500, 64, 500, 264, 500, 376]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39069129166493977, "mean_inference_ms": 1.2559672441273568, "mean_action_processing_ms": 0.14864691807613511, "mean_env_wait_ms": 0.0875458742694596, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029254250410126477, "StateBufferConnector_ms": 0.004641602678996761, "ViewRequirementAgentConnector_ms": 0.12955520211196528}}, "episode_reward_max": 43.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -19.060975609756415, "episode_len_mean": 410.5609756097561, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.499999999999808, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.499999999999893, -50.00000000000044, -50.00000000000044, -50.00000000000044, 22.699999999999882, 17.499999999999808, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 4.099999999999618, 14.499999999999766, 39.300000000000026, 6.299999999999649, 7.899999999999672, -50.00000000000044, 32.700000000000024, 11.099999999999717, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 16.09999999999979, -50.00000000000044, 23.699999999999896, -50.00000000000044, -50.00000000000044, -50.00000000000044, 2.0999999999995893, 3.899999999999615, -50.00000000000044, 18.899999999999828, 12.899999999999743, 19.299999999999834, -50.00000000000044, 5.899999999999643, -50.00000000000044, -50.00000000000044, 10.899999999999714, 31.900000000000013, 38.90000000000002, -50.00000000000044, -50.00000000000044, 19.09999999999983, 22.699999999999882, 19.299999999999834, 33.70000000000004, 14.499999999999766, 32.700000000000024, 37.50000000000003, -50.00000000000044, 24.499999999999908, -50.00000000000044, 28.29999999999996, -50.00000000000044, 19.899999999999842, 23.29999999999989, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 23.699999999999896, -50.00000000000044, 12.499999999999737], "episode_lengths": [500, 500, 500, 500, 500, 326, 500, 500, 500, 500, 500, 500, 500, 266, 500, 500, 500, 274, 326, 500, 500, 500, 500, 500, 500, 460, 356, 108, 438, 422, 500, 174, 390, 500, 500, 500, 500, 340, 500, 264, 500, 500, 500, 480, 462, 500, 312, 372, 308, 500, 442, 500, 500, 392, 182, 112, 500, 500, 310, 274, 308, 164, 356, 174, 126, 500, 256, 500, 218, 500, 302, 268, 500, 500, 500, 500, 500, 64, 500, 264, 500, 376]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39069129166493977, "mean_inference_ms": 1.2559672441273568, "mean_action_processing_ms": 0.14864691807613511, "mean_env_wait_ms": 0.0875458742694596, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029254250410126477, "StateBufferConnector_ms": 0.004641602678996761, "ViewRequirementAgentConnector_ms": 0.12955520211196528}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5536.622426961071, "num_env_steps_trained_throughput_per_sec": 5536.622426961071, "timesteps_total": 36000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 3187.215, "sample_time_ms": 2957.744, "load_time_ms": 16.976, "load_throughput": 1060335.414, "learn_time_ms": 200.493, "learn_throughput": 89778.652, "synch_weights_time_ms": 10.003}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "episodes_total": 82, "training_iteration": 2, "trial_id": "9f288_00015", "date": "2023-10-25_16-46-47", "timestamp": 1698248807, "time_this_iter_s": 3.260089874267578, "time_total_s": 6.389548063278198, "pid": 4200, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 6.389548063278198, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 60.6, "ram_util_percent": 27.119999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.05000000000000001, "cur_lr": 0.0003, "total_loss": 9.087780046463013, "policy_loss": 0.035335438512265685, "vf_loss": 9.052404165267944, "vf_explained_var": 1.188814640045166e-05, "kl": 0.0021830312986253373, "entropy": 0.6860904276371003, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 50.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 54000, "num_env_steps_trained": 54000, "num_agent_steps_sampled": 54000, "num_agent_steps_trained": 54000}, "sampler_results": {"episode_reward_max": 45.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.09599999999979111, "episode_len_mean": 319.68, "episode_media": {}, "episodes_this_iter": 63, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 18.899999999999828, 12.899999999999743, 19.299999999999834, -50.00000000000044, 5.899999999999643, -50.00000000000044, -50.00000000000044, 10.899999999999714, 31.900000000000013, 38.90000000000002, -50.00000000000044, -50.00000000000044, 19.09999999999983, 22.699999999999882, 19.299999999999834, 33.70000000000004, 14.499999999999766, 32.700000000000024, 37.50000000000003, -50.00000000000044, 24.499999999999908, -50.00000000000044, 28.29999999999996, -50.00000000000044, 19.899999999999842, 23.29999999999989, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 23.699999999999896, -50.00000000000044, 12.499999999999737, -50.00000000000044, 25.499999999999922, 32.700000000000024, 16.8999999999998, 38.700000000000024, -50.00000000000044, 5.299999999999635, -50.00000000000044, -50.00000000000044, 42.10000000000001, 38.300000000000026, 37.90000000000003, 39.50000000000002, 32.90000000000003, -50.00000000000044, 45.1, 37.70000000000003, 39.300000000000026, 29.69999999999998, 43.50000000000001, 38.50000000000003, 25.499999999999922, 38.90000000000002, 17.299999999999805, -50.00000000000044, 20.699999999999854, 7.499999999999666, -50.00000000000044, 42.900000000000006, 7.299999999999663, -50.00000000000044, -50.00000000000044, 34.30000000000004, -50.00000000000044, -50.00000000000044, 41.500000000000014, 37.10000000000003, 36.50000000000003, 19.09999999999983, -50.00000000000044, 4.899999999999629, 35.500000000000036, 35.10000000000004, 45.7, -50.00000000000044, 23.8999999999999, -50.00000000000044, -50.00000000000044, 26.499999999999936, 36.70000000000003, 23.099999999999888, 30.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.299999999999933, 9.099999999999689, 36.10000000000004, 31.300000000000004, 34.70000000000004, 43.7], "episode_lengths": [500, 312, 372, 308, 500, 442, 500, 500, 392, 182, 112, 500, 500, 310, 274, 308, 164, 356, 174, 126, 500, 256, 500, 218, 500, 302, 268, 500, 500, 500, 500, 500, 64, 500, 264, 500, 376, 500, 246, 174, 332, 114, 500, 448, 500, 500, 80, 118, 122, 106, 172, 500, 50, 124, 108, 204, 66, 116, 246, 112, 328, 500, 294, 426, 500, 72, 428, 500, 500, 158, 500, 500, 86, 130, 136, 310, 500, 452, 146, 150, 44, 500, 262, 500, 500, 236, 134, 270, 194, 500, 500, 500, 500, 500, 238, 410, 140, 188, 154, 64]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3876384308525101, "mean_inference_ms": 1.2414400214724097, "mean_action_processing_ms": 0.14579540632354437, "mean_env_wait_ms": 0.08715050364104229, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026003599166870117, "StateBufferConnector_ms": 0.005724668502807617, "ViewRequirementAgentConnector_ms": 0.12390708923339844}}, "episode_reward_max": 45.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.09599999999979111, "episode_len_mean": 319.68, "episodes_this_iter": 63, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 18.899999999999828, 12.899999999999743, 19.299999999999834, -50.00000000000044, 5.899999999999643, -50.00000000000044, -50.00000000000044, 10.899999999999714, 31.900000000000013, 38.90000000000002, -50.00000000000044, -50.00000000000044, 19.09999999999983, 22.699999999999882, 19.299999999999834, 33.70000000000004, 14.499999999999766, 32.700000000000024, 37.50000000000003, -50.00000000000044, 24.499999999999908, -50.00000000000044, 28.29999999999996, -50.00000000000044, 19.899999999999842, 23.29999999999989, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 23.699999999999896, -50.00000000000044, 12.499999999999737, -50.00000000000044, 25.499999999999922, 32.700000000000024, 16.8999999999998, 38.700000000000024, -50.00000000000044, 5.299999999999635, -50.00000000000044, -50.00000000000044, 42.10000000000001, 38.300000000000026, 37.90000000000003, 39.50000000000002, 32.90000000000003, -50.00000000000044, 45.1, 37.70000000000003, 39.300000000000026, 29.69999999999998, 43.50000000000001, 38.50000000000003, 25.499999999999922, 38.90000000000002, 17.299999999999805, -50.00000000000044, 20.699999999999854, 7.499999999999666, -50.00000000000044, 42.900000000000006, 7.299999999999663, -50.00000000000044, -50.00000000000044, 34.30000000000004, -50.00000000000044, -50.00000000000044, 41.500000000000014, 37.10000000000003, 36.50000000000003, 19.09999999999983, -50.00000000000044, 4.899999999999629, 35.500000000000036, 35.10000000000004, 45.7, -50.00000000000044, 23.8999999999999, -50.00000000000044, -50.00000000000044, 26.499999999999936, 36.70000000000003, 23.099999999999888, 30.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.299999999999933, 9.099999999999689, 36.10000000000004, 31.300000000000004, 34.70000000000004, 43.7], "episode_lengths": [500, 312, 372, 308, 500, 442, 500, 500, 392, 182, 112, 500, 500, 310, 274, 308, 164, 356, 174, 126, 500, 256, 500, 218, 500, 302, 268, 500, 500, 500, 500, 500, 64, 500, 264, 500, 376, 500, 246, 174, 332, 114, 500, 448, 500, 500, 80, 118, 122, 106, 172, 500, 50, 124, 108, 204, 66, 116, 246, 112, 328, 500, 294, 426, 500, 72, 428, 500, 500, 158, 500, 500, 86, 130, 136, 310, 500, 452, 146, 150, 44, 500, 262, 500, 500, 236, 134, 270, 194, 500, 500, 500, 500, 500, 238, 410, 140, 188, 154, 64]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3876384308525101, "mean_inference_ms": 1.2414400214724097, "mean_action_processing_ms": 0.14579540632354437, "mean_env_wait_ms": 0.08715050364104229, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026003599166870117, "StateBufferConnector_ms": 0.005724668502807617, "ViewRequirementAgentConnector_ms": 0.12390708923339844}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 54000, "num_agent_steps_trained": 54000, "num_env_steps_sampled": 54000, "num_env_steps_trained": 54000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5708.331395838101, "num_env_steps_trained_throughput_per_sec": 5708.331395838101, "timesteps_total": 54000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 54000, "timers": {"training_iteration_time_ms": 3175.905, "sample_time_ms": 2911.308, "load_time_ms": 17.232, "load_throughput": 1044595.896, "learn_time_ms": 235.363, "learn_throughput": 76477.532, "synch_weights_time_ms": 9.669}, "counters": {"num_env_steps_sampled": 54000, "num_env_steps_trained": 54000, "num_agent_steps_sampled": 54000, "num_agent_steps_trained": 54000}, "done": false, "episodes_total": 145, "training_iteration": 3, "trial_id": "9f288_00015", "date": "2023-10-25_16-46-50", "timestamp": 1698248810, "time_this_iter_s": 3.15864634513855, "time_total_s": 9.548194408416748, "pid": 4200, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 9.548194408416748, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 64.95, "ram_util_percent": 27.125000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.0003, "total_loss": 8.93546633720398, "policy_loss": -0.057158382842317224, "vf_loss": 8.992648077011108, "vf_explained_var": 1.4269351959228516e-05, "kl": 0.0014707154469832061, "entropy": 0.6022519946098328, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 70.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "sampler_results": {"episode_reward_max": 46.099999999999994, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.549999999999844, "episode_len_mean": 265.22, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 41.500000000000014, 37.10000000000003, 36.50000000000003, 19.09999999999983, -50.00000000000044, 4.899999999999629, 35.500000000000036, 35.10000000000004, 45.7, -50.00000000000044, 23.8999999999999, -50.00000000000044, -50.00000000000044, 26.499999999999936, 36.70000000000003, 23.099999999999888, 30.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.299999999999933, 9.099999999999689, 36.10000000000004, 31.300000000000004, 34.70000000000004, 43.7, 36.70000000000003, 43.30000000000001, 25.899999999999928, 43.7, -50.00000000000044, 41.90000000000001, 24.499999999999908, 23.8999999999999, -50.00000000000044, 31.900000000000013, 37.300000000000026, 45.5, 39.300000000000026, 41.100000000000016, -50.00000000000044, -50.00000000000044, 35.30000000000004, 4.699999999999626, 45.1, -50.00000000000044, 44.7, 34.30000000000004, 41.30000000000001, 20.699999999999854, -50.00000000000044, 38.700000000000024, 45.7, 42.500000000000014, 43.10000000000001, -50.00000000000044, -50.00000000000044, 31.1, 46.099999999999994, 13.099999999999746, 34.30000000000004, 45.5, 37.90000000000003, -50.00000000000044, 37.90000000000003, 28.499999999999964, 42.70000000000001, 38.50000000000003, 34.70000000000004, 40.70000000000002, 3.2999999999996064, -50.00000000000044, 38.50000000000003, 7.299999999999663, 16.09999999999979, 6.099999999999646, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 43.30000000000001, 20.49999999999985, 45.7, 40.90000000000002, 38.10000000000002, 17.299999999999805, 18.899999999999828, -50.00000000000044, 37.300000000000026, 42.900000000000006, -50.00000000000044, 31.900000000000013, 38.10000000000002, -50.00000000000044, -50.00000000000044, 26.89999999999994], "episode_lengths": [500, 500, 86, 130, 136, 310, 500, 452, 146, 150, 44, 500, 262, 500, 500, 236, 134, 270, 194, 500, 500, 500, 500, 500, 238, 410, 140, 188, 154, 64, 134, 68, 242, 64, 500, 82, 256, 262, 500, 182, 128, 46, 108, 90, 500, 500, 148, 454, 50, 500, 54, 158, 88, 294, 500, 114, 44, 76, 70, 500, 500, 190, 40, 370, 158, 46, 122, 500, 122, 216, 74, 116, 154, 94, 468, 500, 116, 428, 340, 440, 500, 500, 78, 500, 68, 296, 44, 92, 120, 328, 312, 500, 128, 72, 500, 182, 120, 500, 500, 232]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3836076011205347, "mean_inference_ms": 1.223613904126571, "mean_action_processing_ms": 0.1425940507931375, "mean_env_wait_ms": 0.0855523289282717, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03200387954711914, "StateBufferConnector_ms": 0.005995035171508789, "ViewRequirementAgentConnector_ms": 0.12813806533813477}}, "episode_reward_max": 46.099999999999994, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.549999999999844, "episode_len_mean": 265.22, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 41.500000000000014, 37.10000000000003, 36.50000000000003, 19.09999999999983, -50.00000000000044, 4.899999999999629, 35.500000000000036, 35.10000000000004, 45.7, -50.00000000000044, 23.8999999999999, -50.00000000000044, -50.00000000000044, 26.499999999999936, 36.70000000000003, 23.099999999999888, 30.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.299999999999933, 9.099999999999689, 36.10000000000004, 31.300000000000004, 34.70000000000004, 43.7, 36.70000000000003, 43.30000000000001, 25.899999999999928, 43.7, -50.00000000000044, 41.90000000000001, 24.499999999999908, 23.8999999999999, -50.00000000000044, 31.900000000000013, 37.300000000000026, 45.5, 39.300000000000026, 41.100000000000016, -50.00000000000044, -50.00000000000044, 35.30000000000004, 4.699999999999626, 45.1, -50.00000000000044, 44.7, 34.30000000000004, 41.30000000000001, 20.699999999999854, -50.00000000000044, 38.700000000000024, 45.7, 42.500000000000014, 43.10000000000001, -50.00000000000044, -50.00000000000044, 31.1, 46.099999999999994, 13.099999999999746, 34.30000000000004, 45.5, 37.90000000000003, -50.00000000000044, 37.90000000000003, 28.499999999999964, 42.70000000000001, 38.50000000000003, 34.70000000000004, 40.70000000000002, 3.2999999999996064, -50.00000000000044, 38.50000000000003, 7.299999999999663, 16.09999999999979, 6.099999999999646, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 43.30000000000001, 20.49999999999985, 45.7, 40.90000000000002, 38.10000000000002, 17.299999999999805, 18.899999999999828, -50.00000000000044, 37.300000000000026, 42.900000000000006, -50.00000000000044, 31.900000000000013, 38.10000000000002, -50.00000000000044, -50.00000000000044, 26.89999999999994], "episode_lengths": [500, 500, 86, 130, 136, 310, 500, 452, 146, 150, 44, 500, 262, 500, 500, 236, 134, 270, 194, 500, 500, 500, 500, 500, 238, 410, 140, 188, 154, 64, 134, 68, 242, 64, 500, 82, 256, 262, 500, 182, 128, 46, 108, 90, 500, 500, 148, 454, 50, 500, 54, 158, 88, 294, 500, 114, 44, 76, 70, 500, 500, 190, 40, 370, 158, 46, 122, 500, 122, 216, 74, 116, 154, 94, 468, 500, 116, 428, 340, 440, 500, 500, 78, 500, 68, 296, 44, 92, 120, 328, 312, 500, 128, 72, 500, 182, 120, 500, 500, 232]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3836076011205347, "mean_inference_ms": 1.223613904126571, "mean_action_processing_ms": 0.1425940507931375, "mean_env_wait_ms": 0.0855523289282717, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03200387954711914, "StateBufferConnector_ms": 0.005995035171508789, "ViewRequirementAgentConnector_ms": 0.12813806533813477}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5686.554884586562, "num_env_steps_trained_throughput_per_sec": 5686.554884586562, "timesteps_total": 72000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 3173.269, "sample_time_ms": 2889.221, "load_time_ms": 20.171, "load_throughput": 892381.373, "learn_time_ms": 252.116, "learn_throughput": 71395.784, "synch_weights_time_ms": 9.504}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "episodes_total": 215, "training_iteration": 4, "trial_id": "9f288_00015", "date": "2023-10-25_16-46-53", "timestamp": 1698248813, "time_this_iter_s": 3.1703262329101562, "time_total_s": 12.718520641326904, "pid": 4200, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 12.718520641326904, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 60.275, "ram_util_percent": 27.125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0003, "total_loss": 8.910606098175048, "policy_loss": -0.002013638988137245, "vf_loss": 8.912675046920777, "vf_explained_var": 1.500248908996582e-05, "kl": 0.00037283691889911097, "entropy": 0.6005567878484726, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 90.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 90000, "num_env_steps_trained": 90000, "num_agent_steps_sampled": 90000, "num_agent_steps_trained": 90000}, "sampler_results": {"episode_reward_max": 45.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.591999999999826, "episode_len_mean": 274.74, "episode_media": {}, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [37.90000000000003, -50.00000000000044, 37.90000000000003, 28.499999999999964, 42.70000000000001, 38.50000000000003, 34.70000000000004, 40.70000000000002, 3.2999999999996064, -50.00000000000044, 38.50000000000003, 7.299999999999663, 16.09999999999979, 6.099999999999646, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 43.30000000000001, 20.49999999999985, 45.7, 40.90000000000002, 38.10000000000002, 17.299999999999805, 18.899999999999828, -50.00000000000044, 37.300000000000026, 42.900000000000006, -50.00000000000044, 31.900000000000013, 38.10000000000002, -50.00000000000044, -50.00000000000044, 26.89999999999994, -50.00000000000044, -50.00000000000044, 40.10000000000002, 39.70000000000002, 44.5, -50.00000000000044, 40.30000000000002, 43.30000000000001, 24.099999999999902, 44.5, -50.00000000000044, 14.09999999999976, 42.900000000000006, 38.700000000000024, -50.00000000000044, -50.00000000000044, 44.10000000000001, 45.7, 37.50000000000003, -50.00000000000044, 39.70000000000002, 30.9, 38.50000000000003, -50.00000000000044, 41.30000000000001, 37.300000000000026, 29.899999999999984, 40.90000000000002, 40.70000000000002, 33.30000000000003, 28.29999999999996, -50.00000000000044, 29.299999999999976, 25.899999999999928, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 40.70000000000002, 44.300000000000004, -50.00000000000044, 30.699999999999996, 27.099999999999945, 42.10000000000001, 44.900000000000006, 28.09999999999996, -50.00000000000044, 43.50000000000001, 25.099999999999916, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 39.70000000000002, -50.00000000000044, 20.299999999999848, -50.00000000000044, -50.00000000000044, -50.00000000000044, 20.099999999999845, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, 31.300000000000004], "episode_lengths": [122, 500, 122, 216, 74, 116, 154, 94, 468, 500, 116, 428, 340, 440, 500, 500, 78, 500, 68, 296, 44, 92, 120, 328, 312, 500, 128, 72, 500, 182, 120, 500, 500, 232, 500, 500, 100, 104, 56, 500, 98, 68, 260, 56, 500, 360, 72, 114, 500, 500, 60, 44, 126, 500, 104, 192, 116, 500, 88, 128, 202, 92, 94, 168, 218, 500, 208, 242, 500, 500, 500, 76, 500, 94, 58, 500, 194, 230, 80, 52, 220, 500, 66, 250, 500, 500, 500, 42, 104, 500, 298, 500, 500, 500, 300, 500, 90, 500, 500, 188]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38133108858741094, "mean_inference_ms": 1.2185707811909199, "mean_action_processing_ms": 0.14278805419053556, "mean_env_wait_ms": 0.08457635359242573, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03603816032409668, "StateBufferConnector_ms": 0.0049991607666015625, "ViewRequirementAgentConnector_ms": 0.13158035278320312}}, "episode_reward_max": 45.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.591999999999826, "episode_len_mean": 274.74, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [37.90000000000003, -50.00000000000044, 37.90000000000003, 28.499999999999964, 42.70000000000001, 38.50000000000003, 34.70000000000004, 40.70000000000002, 3.2999999999996064, -50.00000000000044, 38.50000000000003, 7.299999999999663, 16.09999999999979, 6.099999999999646, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 43.30000000000001, 20.49999999999985, 45.7, 40.90000000000002, 38.10000000000002, 17.299999999999805, 18.899999999999828, -50.00000000000044, 37.300000000000026, 42.900000000000006, -50.00000000000044, 31.900000000000013, 38.10000000000002, -50.00000000000044, -50.00000000000044, 26.89999999999994, -50.00000000000044, -50.00000000000044, 40.10000000000002, 39.70000000000002, 44.5, -50.00000000000044, 40.30000000000002, 43.30000000000001, 24.099999999999902, 44.5, -50.00000000000044, 14.09999999999976, 42.900000000000006, 38.700000000000024, -50.00000000000044, -50.00000000000044, 44.10000000000001, 45.7, 37.50000000000003, -50.00000000000044, 39.70000000000002, 30.9, 38.50000000000003, -50.00000000000044, 41.30000000000001, 37.300000000000026, 29.899999999999984, 40.90000000000002, 40.70000000000002, 33.30000000000003, 28.29999999999996, -50.00000000000044, 29.299999999999976, 25.899999999999928, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 40.70000000000002, 44.300000000000004, -50.00000000000044, 30.699999999999996, 27.099999999999945, 42.10000000000001, 44.900000000000006, 28.09999999999996, -50.00000000000044, 43.50000000000001, 25.099999999999916, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 39.70000000000002, -50.00000000000044, 20.299999999999848, -50.00000000000044, -50.00000000000044, -50.00000000000044, 20.099999999999845, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, 31.300000000000004], "episode_lengths": [122, 500, 122, 216, 74, 116, 154, 94, 468, 500, 116, 428, 340, 440, 500, 500, 78, 500, 68, 296, 44, 92, 120, 328, 312, 500, 128, 72, 500, 182, 120, 500, 500, 232, 500, 500, 100, 104, 56, 500, 98, 68, 260, 56, 500, 360, 72, 114, 500, 500, 60, 44, 126, 500, 104, 192, 116, 500, 88, 128, 202, 92, 94, 168, 218, 500, 208, 242, 500, 500, 500, 76, 500, 94, 58, 500, 194, 230, 80, 52, 220, 500, 66, 250, 500, 500, 500, 42, 104, 500, 298, 500, 500, 500, 300, 500, 90, 500, 500, 188]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38133108858741094, "mean_inference_ms": 1.2185707811909199, "mean_action_processing_ms": 0.14278805419053556, "mean_env_wait_ms": 0.08457635359242573, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03603816032409668, "StateBufferConnector_ms": 0.0049991607666015625, "ViewRequirementAgentConnector_ms": 0.13158035278320312}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 90000, "num_agent_steps_trained": 90000, "num_env_steps_sampled": 90000, "num_env_steps_trained": 90000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5615.80744291229, "num_env_steps_trained_throughput_per_sec": 5615.80744291229, "timesteps_total": 90000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 90000, "timers": {"training_iteration_time_ms": 3179.464, "sample_time_ms": 2884.926, "load_time_ms": 19.425, "load_throughput": 926649.516, "learn_time_ms": 263.29, "learn_throughput": 68365.711, "synch_weights_time_ms": 9.416}, "counters": {"num_env_steps_sampled": 90000, "num_env_steps_trained": 90000, "num_agent_steps_sampled": 90000, "num_agent_steps_trained": 90000}, "done": false, "episodes_total": 281, "training_iteration": 5, "trial_id": "9f288_00015", "date": "2023-10-25_16-46-57", "timestamp": 1698248817, "time_this_iter_s": 3.2112321853637695, "time_total_s": 15.929752826690674, "pid": 4200, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 15.929752826690674, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 57.6, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.006250000000000001, "cur_lr": 0.0003, "total_loss": 8.931460618972778, "policy_loss": -0.03485480113886297, "vf_loss": 8.966366338729859, "vf_explained_var": -4.348158836364746e-06, "kl": 0.0014075046876959776, "entropy": 0.5964088052511215, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 110.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "sampler_results": {"episode_reward_max": 46.099999999999994, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.447999999999857, "episode_len_mean": 246.24, "episode_media": {}, "episodes_this_iter": 78, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.10000000000001, 44.900000000000006, 28.09999999999996, -50.00000000000044, 43.50000000000001, 25.099999999999916, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 39.70000000000002, -50.00000000000044, 20.299999999999848, -50.00000000000044, -50.00000000000044, -50.00000000000044, 20.099999999999845, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, 31.300000000000004, 40.500000000000014, 41.70000000000002, 32.50000000000002, 30.29999999999999, 42.500000000000014, 43.10000000000001, 43.50000000000001, 43.10000000000001, 37.300000000000026, 43.900000000000006, 6.099999999999646, 41.500000000000014, 37.90000000000003, 40.500000000000014, 43.30000000000001, 37.300000000000026, 41.100000000000016, 19.69999999999984, 22.699999999999882, 31.70000000000001, -50.00000000000044, 44.5, 44.300000000000004, 41.100000000000016, -50.00000000000044, -50.00000000000044, 45.3, 32.50000000000002, 40.30000000000002, 44.7, 39.70000000000002, 43.30000000000001, 41.70000000000002, -50.00000000000044, 14.09999999999976, 30.499999999999993, 7.09999999999966, 24.499999999999908, 42.500000000000014, 38.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 35.900000000000034, -50.00000000000044, 40.500000000000014, -50.00000000000044, 44.10000000000001, 37.90000000000003, 31.500000000000007, -50.00000000000044, 30.099999999999987, 17.099999999999802, 6.299999999999649, 21.699999999999868, -50.00000000000044, -50.00000000000044, 43.30000000000001, 42.900000000000006, 44.900000000000006, 41.100000000000016, -50.00000000000044, -50.00000000000044, 13.899999999999757, 28.89999999999997, 46.099999999999994, 37.300000000000026, 32.100000000000016, 35.70000000000003, 42.10000000000001, -50.00000000000044, -50.00000000000044, 44.300000000000004, 27.099999999999945, 40.500000000000014, 37.50000000000003, -50.00000000000044], "episode_lengths": [80, 52, 220, 500, 66, 250, 500, 500, 500, 42, 104, 500, 298, 500, 500, 500, 300, 500, 90, 500, 500, 188, 96, 84, 176, 198, 76, 70, 66, 70, 128, 62, 440, 86, 122, 96, 68, 128, 90, 304, 274, 184, 500, 56, 58, 90, 500, 500, 48, 176, 98, 54, 104, 68, 84, 500, 360, 196, 430, 256, 76, 114, 500, 500, 500, 52, 142, 500, 96, 500, 60, 122, 186, 500, 200, 330, 438, 284, 500, 500, 68, 72, 52, 90, 500, 500, 362, 212, 40, 128, 180, 144, 80, 500, 500, 58, 230, 96, 126, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37930693625073014, "mean_inference_ms": 1.2131940038665943, "mean_action_processing_ms": 0.14220594932471653, "mean_env_wait_ms": 0.08415091004441771, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023027420043945312, "StateBufferConnector_ms": 0.009996652603149414, "ViewRequirementAgentConnector_ms": 0.1243443489074707}}, "episode_reward_max": 46.099999999999994, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.447999999999857, "episode_len_mean": 246.24, "episodes_this_iter": 78, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.10000000000001, 44.900000000000006, 28.09999999999996, -50.00000000000044, 43.50000000000001, 25.099999999999916, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 39.70000000000002, -50.00000000000044, 20.299999999999848, -50.00000000000044, -50.00000000000044, -50.00000000000044, 20.099999999999845, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, 31.300000000000004, 40.500000000000014, 41.70000000000002, 32.50000000000002, 30.29999999999999, 42.500000000000014, 43.10000000000001, 43.50000000000001, 43.10000000000001, 37.300000000000026, 43.900000000000006, 6.099999999999646, 41.500000000000014, 37.90000000000003, 40.500000000000014, 43.30000000000001, 37.300000000000026, 41.100000000000016, 19.69999999999984, 22.699999999999882, 31.70000000000001, -50.00000000000044, 44.5, 44.300000000000004, 41.100000000000016, -50.00000000000044, -50.00000000000044, 45.3, 32.50000000000002, 40.30000000000002, 44.7, 39.70000000000002, 43.30000000000001, 41.70000000000002, -50.00000000000044, 14.09999999999976, 30.499999999999993, 7.09999999999966, 24.499999999999908, 42.500000000000014, 38.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 35.900000000000034, -50.00000000000044, 40.500000000000014, -50.00000000000044, 44.10000000000001, 37.90000000000003, 31.500000000000007, -50.00000000000044, 30.099999999999987, 17.099999999999802, 6.299999999999649, 21.699999999999868, -50.00000000000044, -50.00000000000044, 43.30000000000001, 42.900000000000006, 44.900000000000006, 41.100000000000016, -50.00000000000044, -50.00000000000044, 13.899999999999757, 28.89999999999997, 46.099999999999994, 37.300000000000026, 32.100000000000016, 35.70000000000003, 42.10000000000001, -50.00000000000044, -50.00000000000044, 44.300000000000004, 27.099999999999945, 40.500000000000014, 37.50000000000003, -50.00000000000044], "episode_lengths": [80, 52, 220, 500, 66, 250, 500, 500, 500, 42, 104, 500, 298, 500, 500, 500, 300, 500, 90, 500, 500, 188, 96, 84, 176, 198, 76, 70, 66, 70, 128, 62, 440, 86, 122, 96, 68, 128, 90, 304, 274, 184, 500, 56, 58, 90, 500, 500, 48, 176, 98, 54, 104, 68, 84, 500, 360, 196, 430, 256, 76, 114, 500, 500, 500, 52, 142, 500, 96, 500, 60, 122, 186, 500, 200, 330, 438, 284, 500, 500, 68, 72, 52, 90, 500, 500, 362, 212, 40, 128, 180, 144, 80, 500, 500, 58, 230, 96, 126, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37930693625073014, "mean_inference_ms": 1.2131940038665943, "mean_action_processing_ms": 0.14220594932471653, "mean_env_wait_ms": 0.08415091004441771, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023027420043945312, "StateBufferConnector_ms": 0.009996652603149414, "ViewRequirementAgentConnector_ms": 0.1243443489074707}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5436.612164304962, "num_env_steps_trained_throughput_per_sec": 5436.612164304962, "timesteps_total": 108000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 3201.368, "sample_time_ms": 2881.406, "load_time_ms": 21.354, "load_throughput": 842941.26, "learn_time_ms": 286.594, "learn_throughput": 62806.681, "synch_weights_time_ms": 9.507}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "done": false, "episodes_total": 359, "training_iteration": 6, "trial_id": "9f288_00015", "date": "2023-10-25_16-47-00", "timestamp": 1698248820, "time_this_iter_s": 3.3168840408325195, "time_total_s": 19.246636867523193, "pid": 4200, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 19.246636867523193, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 54.04, "ram_util_percent": 27.22}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0031250000000000006, "cur_lr": 0.0003, "total_loss": 8.346302700042724, "policy_loss": 0.040864181518554685, "vf_loss": 8.305490970611572, "vf_explained_var": 2.3514032363891603e-06, "kl": 0.001700911652335435, "entropy": 0.577357292175293, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 130.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 126000, "num_env_steps_trained": 126000, "num_agent_steps_sampled": 126000, "num_agent_steps_trained": 126000}, "sampler_results": {"episode_reward_max": 46.099999999999994, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.1559999999998039, "episode_len_mean": 289.04, "episode_media": {}, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [38.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 35.900000000000034, -50.00000000000044, 40.500000000000014, -50.00000000000044, 44.10000000000001, 37.90000000000003, 31.500000000000007, -50.00000000000044, 30.099999999999987, 17.099999999999802, 6.299999999999649, 21.699999999999868, -50.00000000000044, -50.00000000000044, 43.30000000000001, 42.900000000000006, 44.900000000000006, 41.100000000000016, -50.00000000000044, -50.00000000000044, 13.899999999999757, 28.89999999999997, 46.099999999999994, 37.300000000000026, 32.100000000000016, 35.70000000000003, 42.10000000000001, -50.00000000000044, -50.00000000000044, 44.300000000000004, 27.099999999999945, 40.500000000000014, 37.50000000000003, -50.00000000000044, 1.099999999999575, 32.700000000000024, -50.00000000000044, 16.499999999999794, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.30000000000004, 43.7, 44.10000000000001, -50.00000000000044, 44.900000000000006, 44.7, -50.00000000000044, 35.70000000000003, 45.9, 12.499999999999737, 39.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, 3.699999999999612, 42.900000000000006, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, 35.500000000000036, 44.7, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 34.70000000000004, 41.100000000000016, -50.00000000000044, 34.10000000000004, -50.00000000000044, 42.900000000000006, 32.700000000000024, -50.00000000000044, 41.100000000000016, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 4.099999999999618, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 46.099999999999994, 43.7, 28.89999999999997, 43.30000000000001, 44.5, 35.500000000000036], "episode_lengths": [114, 500, 500, 500, 52, 142, 500, 96, 500, 60, 122, 186, 500, 200, 330, 438, 284, 500, 500, 68, 72, 52, 90, 500, 500, 362, 212, 40, 128, 180, 144, 80, 500, 500, 58, 230, 96, 126, 500, 490, 174, 500, 336, 500, 500, 500, 158, 64, 60, 500, 52, 54, 500, 144, 42, 376, 108, 500, 500, 500, 92, 464, 72, 500, 104, 500, 500, 146, 54, 500, 500, 50, 500, 154, 90, 500, 160, 500, 72, 174, 500, 90, 62, 500, 500, 500, 500, 460, 500, 500, 500, 54, 500, 500, 40, 64, 212, 68, 56, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3770886957833284, "mean_inference_ms": 1.211380559345005, "mean_action_processing_ms": 0.141795425880974, "mean_env_wait_ms": 0.08403386160694082, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01900792121887207, "StateBufferConnector_ms": 0.0049974918365478516, "ViewRequirementAgentConnector_ms": 0.12879109382629395}}, "episode_reward_max": 46.099999999999994, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.1559999999998039, "episode_len_mean": 289.04, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [38.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 35.900000000000034, -50.00000000000044, 40.500000000000014, -50.00000000000044, 44.10000000000001, 37.90000000000003, 31.500000000000007, -50.00000000000044, 30.099999999999987, 17.099999999999802, 6.299999999999649, 21.699999999999868, -50.00000000000044, -50.00000000000044, 43.30000000000001, 42.900000000000006, 44.900000000000006, 41.100000000000016, -50.00000000000044, -50.00000000000044, 13.899999999999757, 28.89999999999997, 46.099999999999994, 37.300000000000026, 32.100000000000016, 35.70000000000003, 42.10000000000001, -50.00000000000044, -50.00000000000044, 44.300000000000004, 27.099999999999945, 40.500000000000014, 37.50000000000003, -50.00000000000044, 1.099999999999575, 32.700000000000024, -50.00000000000044, 16.499999999999794, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.30000000000004, 43.7, 44.10000000000001, -50.00000000000044, 44.900000000000006, 44.7, -50.00000000000044, 35.70000000000003, 45.9, 12.499999999999737, 39.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, 3.699999999999612, 42.900000000000006, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, 35.500000000000036, 44.7, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 34.70000000000004, 41.100000000000016, -50.00000000000044, 34.10000000000004, -50.00000000000044, 42.900000000000006, 32.700000000000024, -50.00000000000044, 41.100000000000016, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 4.099999999999618, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 46.099999999999994, 43.7, 28.89999999999997, 43.30000000000001, 44.5, 35.500000000000036], "episode_lengths": [114, 500, 500, 500, 52, 142, 500, 96, 500, 60, 122, 186, 500, 200, 330, 438, 284, 500, 500, 68, 72, 52, 90, 500, 500, 362, 212, 40, 128, 180, 144, 80, 500, 500, 58, 230, 96, 126, 500, 490, 174, 500, 336, 500, 500, 500, 158, 64, 60, 500, 52, 54, 500, 144, 42, 376, 108, 500, 500, 500, 92, 464, 72, 500, 104, 500, 500, 146, 54, 500, 500, 50, 500, 154, 90, 500, 160, 500, 72, 174, 500, 90, 62, 500, 500, 500, 500, 460, 500, 500, 500, 54, 500, 500, 40, 64, 212, 68, 56, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3770886957833284, "mean_inference_ms": 1.211380559345005, "mean_action_processing_ms": 0.141795425880974, "mean_env_wait_ms": 0.08403386160694082, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01900792121887207, "StateBufferConnector_ms": 0.0049974918365478516, "ViewRequirementAgentConnector_ms": 0.12879109382629395}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 126000, "num_agent_steps_trained": 126000, "num_env_steps_sampled": 126000, "num_env_steps_trained": 126000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5788.428536236815, "num_env_steps_trained_throughput_per_sec": 5788.428536236815, "timesteps_total": 126000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 126000, "timers": {"training_iteration_time_ms": 3188.265, "sample_time_ms": 2866.263, "load_time_ms": 20.16, "load_throughput": 892836.297, "learn_time_ms": 289.687, "learn_throughput": 62135.989, "synch_weights_time_ms": 9.577}, "counters": {"num_env_steps_sampled": 126000, "num_env_steps_trained": 126000, "num_agent_steps_sampled": 126000, "num_agent_steps_trained": 126000}, "done": false, "episodes_total": 420, "training_iteration": 7, "trial_id": "9f288_00015", "date": "2023-10-25_16-47-03", "timestamp": 1698248823, "time_this_iter_s": 3.1146485805511475, "time_total_s": 22.36128544807434, "pid": 4200, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 22.36128544807434, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 64.875, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0015625000000000003, "cur_lr": 0.0003, "total_loss": 8.216723752021789, "policy_loss": -0.012050789128988982, "vf_loss": 8.228830075263977, "vf_explained_var": -1.2367963790893555e-06, "kl": 0.0012247877699394394, "entropy": 0.5739888727664948, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 150.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.913999999999842, "episode_len_mean": 241.52, "episode_media": {}, "episodes_this_iter": 83, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 4.099999999999618, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 46.099999999999994, 43.7, 28.89999999999997, 43.30000000000001, 44.5, 35.500000000000036, -50.00000000000044, 46.099999999999994, 12.499999999999737, 45.3, 47.1, 43.900000000000006, 44.7, -50.00000000000044, -50.00000000000044, 35.900000000000034, 43.7, 41.70000000000002, -50.00000000000044, 11.499999999999723, 45.5, 47.1, 40.30000000000002, 42.30000000000001, 46.3, 46.3, -50.00000000000044, -50.00000000000044, 39.300000000000026, -50.00000000000044, 36.50000000000003, 42.30000000000001, 40.70000000000002, 35.70000000000003, -50.00000000000044, 38.300000000000026, 37.50000000000003, -50.00000000000044, -50.00000000000044, 42.70000000000001, 45.5, -50.00000000000044, -50.00000000000044, 45.7, 46.099999999999994, 40.30000000000002, -50.00000000000044, 43.50000000000001, 40.90000000000002, -50.00000000000044, 39.70000000000002, -50.00000000000044, 30.099999999999987, 44.5, 43.7, 41.500000000000014, 46.9, 45.9, -50.00000000000044, 39.300000000000026, 31.300000000000004, 46.099999999999994, 46.099999999999994, 34.50000000000004, 40.500000000000014, -50.00000000000044, 32.50000000000002, 35.30000000000004, -50.00000000000044, 15.899999999999785, -50.00000000000044, -50.00000000000044, 42.900000000000006, 44.10000000000001, 44.900000000000006, -50.00000000000044, 46.3, -50.00000000000044, 38.700000000000024, 25.499999999999922, 43.900000000000006, 44.900000000000006, -50.00000000000044, 35.500000000000036, -50.00000000000044, 43.7, 44.5, 16.699999999999797, -50.00000000000044], "episode_lengths": [500, 500, 500, 500, 460, 500, 500, 500, 54, 500, 500, 40, 64, 212, 68, 56, 146, 500, 40, 376, 48, 30, 62, 54, 500, 500, 142, 64, 84, 500, 386, 46, 30, 98, 78, 38, 38, 500, 500, 108, 500, 136, 78, 94, 144, 500, 118, 126, 500, 500, 74, 46, 500, 500, 44, 40, 98, 500, 66, 92, 500, 104, 500, 200, 56, 64, 86, 32, 42, 500, 108, 188, 40, 40, 156, 96, 500, 176, 148, 500, 342, 500, 500, 72, 60, 52, 500, 38, 500, 114, 246, 62, 52, 500, 146, 500, 64, 56, 334, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37709499072205416, "mean_inference_ms": 1.2074582202991992, "mean_action_processing_ms": 0.14174627620877545, "mean_env_wait_ms": 0.08318268233605484, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028998374938964844, "StateBufferConnector_ms": 0.0059986114501953125, "ViewRequirementAgentConnector_ms": 0.11821746826171875}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.913999999999842, "episode_len_mean": 241.52, "episodes_this_iter": 83, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 4.099999999999618, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 46.099999999999994, 43.7, 28.89999999999997, 43.30000000000001, 44.5, 35.500000000000036, -50.00000000000044, 46.099999999999994, 12.499999999999737, 45.3, 47.1, 43.900000000000006, 44.7, -50.00000000000044, -50.00000000000044, 35.900000000000034, 43.7, 41.70000000000002, -50.00000000000044, 11.499999999999723, 45.5, 47.1, 40.30000000000002, 42.30000000000001, 46.3, 46.3, -50.00000000000044, -50.00000000000044, 39.300000000000026, -50.00000000000044, 36.50000000000003, 42.30000000000001, 40.70000000000002, 35.70000000000003, -50.00000000000044, 38.300000000000026, 37.50000000000003, -50.00000000000044, -50.00000000000044, 42.70000000000001, 45.5, -50.00000000000044, -50.00000000000044, 45.7, 46.099999999999994, 40.30000000000002, -50.00000000000044, 43.50000000000001, 40.90000000000002, -50.00000000000044, 39.70000000000002, -50.00000000000044, 30.099999999999987, 44.5, 43.7, 41.500000000000014, 46.9, 45.9, -50.00000000000044, 39.300000000000026, 31.300000000000004, 46.099999999999994, 46.099999999999994, 34.50000000000004, 40.500000000000014, -50.00000000000044, 32.50000000000002, 35.30000000000004, -50.00000000000044, 15.899999999999785, -50.00000000000044, -50.00000000000044, 42.900000000000006, 44.10000000000001, 44.900000000000006, -50.00000000000044, 46.3, -50.00000000000044, 38.700000000000024, 25.499999999999922, 43.900000000000006, 44.900000000000006, -50.00000000000044, 35.500000000000036, -50.00000000000044, 43.7, 44.5, 16.699999999999797, -50.00000000000044], "episode_lengths": [500, 500, 500, 500, 460, 500, 500, 500, 54, 500, 500, 40, 64, 212, 68, 56, 146, 500, 40, 376, 48, 30, 62, 54, 500, 500, 142, 64, 84, 500, 386, 46, 30, 98, 78, 38, 38, 500, 500, 108, 500, 136, 78, 94, 144, 500, 118, 126, 500, 500, 74, 46, 500, 500, 44, 40, 98, 500, 66, 92, 500, 104, 500, 200, 56, 64, 86, 32, 42, 500, 108, 188, 40, 40, 156, 96, 500, 176, 148, 500, 342, 500, 500, 72, 60, 52, 500, 38, 500, 114, 246, 62, 52, 500, 146, 500, 64, 56, 334, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37709499072205416, "mean_inference_ms": 1.2074582202991992, "mean_action_processing_ms": 0.14174627620877545, "mean_env_wait_ms": 0.08318268233605484, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028998374938964844, "StateBufferConnector_ms": 0.0059986114501953125, "ViewRequirementAgentConnector_ms": 0.11821746826171875}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5520.136120147336, "num_env_steps_trained_throughput_per_sec": 5520.136120147336, "timesteps_total": 144000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 3197.331, "sample_time_ms": 2858.898, "load_time_ms": 20.82, "load_throughput": 864553.654, "learn_time_ms": 305.731, "learn_throughput": 58875.349, "synch_weights_time_ms": 9.376}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "episodes_total": 503, "training_iteration": 8, "trial_id": "9f288_00015", "date": "2023-10-25_16-47-06", "timestamp": 1698248826, "time_this_iter_s": 3.26678729057312, "time_total_s": 25.62807273864746, "pid": 4200, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 25.62807273864746, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 54.3, "ram_util_percent": 27.22}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0007812500000000002, "cur_lr": 0.0003, "total_loss": 7.177773809432983, "policy_loss": -0.018373116664588452, "vf_loss": 7.196201419830322, "vf_explained_var": -4.345178604125977e-06, "kl": 0.00031300388121735523, "entropy": 0.546919533610344, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 170.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 162000, "num_env_steps_trained": 162000, "num_agent_steps_sampled": 162000, "num_agent_steps_trained": 162000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.850999999999834, "episode_len_mean": 257.16, "episode_media": {}, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.9, 45.9, -50.00000000000044, 39.300000000000026, 31.300000000000004, 46.099999999999994, 46.099999999999994, 34.50000000000004, 40.500000000000014, -50.00000000000044, 32.50000000000002, 35.30000000000004, -50.00000000000044, 15.899999999999785, -50.00000000000044, -50.00000000000044, 42.900000000000006, 44.10000000000001, 44.900000000000006, -50.00000000000044, 46.3, -50.00000000000044, 38.700000000000024, 25.499999999999922, 43.900000000000006, 44.900000000000006, -50.00000000000044, 35.500000000000036, -50.00000000000044, 43.7, 44.5, 16.699999999999797, -50.00000000000044, 4.299999999999621, 39.90000000000002, 39.10000000000002, 44.900000000000006, 40.10000000000002, -50.00000000000044, -50.00000000000044, 43.10000000000001, 27.699999999999953, 32.90000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 15.099999999999774, 44.300000000000004, -50.00000000000044, -50.00000000000044, 24.899999999999913, -50.00000000000044, 43.30000000000001, 39.70000000000002, 27.699999999999953, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 45.7, -50.00000000000044, -50.00000000000044, 40.10000000000002, 45.3, 5.6999999999996405, -50.00000000000044, 41.30000000000001, 40.90000000000002, 37.300000000000026, 38.700000000000024, 40.10000000000002, 43.900000000000006, 18.099999999999817, 46.5, -50.00000000000044, 41.500000000000014, 19.299999999999834, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 42.900000000000006, 30.29999999999999, -50.00000000000044, 3.499999999999609, 32.30000000000002, 46.9, 29.899999999999984, 36.900000000000034, -50.00000000000044, 43.10000000000001, 43.30000000000001, 45.9, -50.00000000000044, 11.899999999999729, 41.30000000000001, -50.00000000000044, 34.30000000000004], "episode_lengths": [32, 42, 500, 108, 188, 40, 40, 156, 96, 500, 176, 148, 500, 342, 500, 500, 72, 60, 52, 500, 38, 500, 114, 246, 62, 52, 500, 146, 500, 64, 56, 334, 500, 458, 102, 110, 52, 100, 500, 500, 70, 224, 172, 500, 500, 500, 40, 500, 350, 58, 500, 500, 252, 500, 68, 104, 224, 500, 500, 500, 54, 44, 500, 500, 100, 48, 444, 500, 88, 92, 128, 114, 100, 62, 320, 36, 500, 86, 308, 500, 500, 500, 56, 72, 198, 500, 466, 178, 32, 202, 132, 500, 70, 68, 42, 500, 382, 88, 500, 158]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3762754959086395, "mean_inference_ms": 1.2051702900691643, "mean_action_processing_ms": 0.1410511469216851, "mean_env_wait_ms": 0.08238855323430717, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02598714828491211, "StateBufferConnector_ms": 0.009368181228637695, "ViewRequirementAgentConnector_ms": 0.11902904510498047}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.850999999999834, "episode_len_mean": 257.16, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.9, 45.9, -50.00000000000044, 39.300000000000026, 31.300000000000004, 46.099999999999994, 46.099999999999994, 34.50000000000004, 40.500000000000014, -50.00000000000044, 32.50000000000002, 35.30000000000004, -50.00000000000044, 15.899999999999785, -50.00000000000044, -50.00000000000044, 42.900000000000006, 44.10000000000001, 44.900000000000006, -50.00000000000044, 46.3, -50.00000000000044, 38.700000000000024, 25.499999999999922, 43.900000000000006, 44.900000000000006, -50.00000000000044, 35.500000000000036, -50.00000000000044, 43.7, 44.5, 16.699999999999797, -50.00000000000044, 4.299999999999621, 39.90000000000002, 39.10000000000002, 44.900000000000006, 40.10000000000002, -50.00000000000044, -50.00000000000044, 43.10000000000001, 27.699999999999953, 32.90000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 15.099999999999774, 44.300000000000004, -50.00000000000044, -50.00000000000044, 24.899999999999913, -50.00000000000044, 43.30000000000001, 39.70000000000002, 27.699999999999953, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 45.7, -50.00000000000044, -50.00000000000044, 40.10000000000002, 45.3, 5.6999999999996405, -50.00000000000044, 41.30000000000001, 40.90000000000002, 37.300000000000026, 38.700000000000024, 40.10000000000002, 43.900000000000006, 18.099999999999817, 46.5, -50.00000000000044, 41.500000000000014, 19.299999999999834, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 42.900000000000006, 30.29999999999999, -50.00000000000044, 3.499999999999609, 32.30000000000002, 46.9, 29.899999999999984, 36.900000000000034, -50.00000000000044, 43.10000000000001, 43.30000000000001, 45.9, -50.00000000000044, 11.899999999999729, 41.30000000000001, -50.00000000000044, 34.30000000000004], "episode_lengths": [32, 42, 500, 108, 188, 40, 40, 156, 96, 500, 176, 148, 500, 342, 500, 500, 72, 60, 52, 500, 38, 500, 114, 246, 62, 52, 500, 146, 500, 64, 56, 334, 500, 458, 102, 110, 52, 100, 500, 500, 70, 224, 172, 500, 500, 500, 40, 500, 350, 58, 500, 500, 252, 500, 68, 104, 224, 500, 500, 500, 54, 44, 500, 500, 100, 48, 444, 500, 88, 92, 128, 114, 100, 62, 320, 36, 500, 86, 308, 500, 500, 500, 56, 72, 198, 500, 466, 178, 32, 202, 132, 500, 70, 68, 42, 500, 382, 88, 500, 158]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3762754959086395, "mean_inference_ms": 1.2051702900691643, "mean_action_processing_ms": 0.1410511469216851, "mean_env_wait_ms": 0.08238855323430717, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02598714828491211, "StateBufferConnector_ms": 0.009368181228637695, "ViewRequirementAgentConnector_ms": 0.11902904510498047}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 162000, "num_agent_steps_trained": 162000, "num_env_steps_sampled": 162000, "num_env_steps_trained": 162000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5692.756399777289, "num_env_steps_trained_throughput_per_sec": 5692.756399777289, "timesteps_total": 162000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 162000, "timers": {"training_iteration_time_ms": 3193.396, "sample_time_ms": 2852.842, "load_time_ms": 20.173, "load_throughput": 892266.825, "learn_time_ms": 308.595, "learn_throughput": 58328.924, "synch_weights_time_ms": 9.335}, "counters": {"num_env_steps_sampled": 162000, "num_env_steps_trained": 162000, "num_agent_steps_sampled": 162000, "num_agent_steps_trained": 162000}, "done": false, "episodes_total": 570, "training_iteration": 9, "trial_id": "9f288_00015", "date": "2023-10-25_16-47-10", "timestamp": 1698248830, "time_this_iter_s": 3.16790509223938, "time_total_s": 28.79597783088684, "pid": 4200, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 28.79597783088684, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 64.175, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0003906250000000001, "cur_lr": 0.0003, "total_loss": 6.754526138305664, "policy_loss": 0.03462592307478189, "vf_loss": 6.7199551820755, "vf_explained_var": -6.377696990966796e-07, "kl": 4.3197936025762826e-05, "entropy": 0.5494300246238708, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 190.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.97099999999986, "episode_len_mean": 236.0, "episode_media": {}, "episodes_this_iter": 77, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.500000000000014, 19.299999999999834, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 42.900000000000006, 30.29999999999999, -50.00000000000044, 3.499999999999609, 32.30000000000002, 46.9, 29.899999999999984, 36.900000000000034, -50.00000000000044, 43.10000000000001, 43.30000000000001, 45.9, -50.00000000000044, 11.899999999999729, 41.30000000000001, -50.00000000000044, 34.30000000000004, 39.10000000000002, -50.00000000000044, -50.00000000000044, 45.3, 47.3, -50.00000000000044, 35.900000000000034, 41.100000000000016, -50.00000000000044, 30.9, -50.00000000000044, -50.00000000000044, 38.90000000000002, 41.90000000000001, 37.70000000000003, 11.499999999999723, 44.10000000000001, 37.50000000000003, 44.7, 40.500000000000014, 24.69999999999991, 47.3, 46.099999999999994, 43.10000000000001, 33.90000000000004, 35.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 29.099999999999973, 30.9, 25.099999999999916, -50.00000000000044, 35.900000000000034, 42.30000000000001, 43.10000000000001, 40.70000000000002, -50.00000000000044, 8.699999999999683, -50.00000000000044, -50.00000000000044, 2.699999999999598, 46.699999999999996, -50.00000000000044, 39.50000000000002, 26.69999999999994, 42.900000000000006, -50.00000000000044, 44.5, 30.9, 35.500000000000036, 37.300000000000026, 44.300000000000004, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 35.10000000000004, 44.5, 45.1, -50.00000000000044, 46.699999999999996, 46.3, -50.00000000000044, 42.70000000000001, 42.500000000000014, 43.10000000000001, -50.00000000000044, 39.90000000000002, 45.5, -50.00000000000044, 37.10000000000003, 42.70000000000001, 45.7, 46.9, 31.500000000000007], "episode_lengths": [86, 308, 500, 500, 500, 56, 72, 198, 500, 466, 178, 32, 202, 132, 500, 70, 68, 42, 500, 382, 88, 500, 158, 110, 500, 500, 48, 28, 500, 142, 90, 500, 192, 500, 500, 112, 82, 124, 386, 60, 126, 54, 96, 254, 28, 40, 70, 162, 146, 500, 500, 500, 38, 210, 192, 250, 500, 142, 78, 70, 94, 500, 414, 500, 500, 474, 34, 500, 106, 234, 72, 500, 56, 192, 146, 128, 58, 500, 500, 62, 500, 150, 56, 50, 500, 34, 38, 500, 74, 76, 70, 500, 102, 46, 500, 130, 74, 44, 32, 186]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.375436310387354, "mean_inference_ms": 1.2040759982076867, "mean_action_processing_ms": 0.13946393113751518, "mean_env_wait_ms": 0.08261445238939755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023988962173461914, "StateBufferConnector_ms": 0.009000778198242188, "ViewRequirementAgentConnector_ms": 0.09801578521728516}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.97099999999986, "episode_len_mean": 236.0, "episodes_this_iter": 77, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [41.500000000000014, 19.299999999999834, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 42.900000000000006, 30.29999999999999, -50.00000000000044, 3.499999999999609, 32.30000000000002, 46.9, 29.899999999999984, 36.900000000000034, -50.00000000000044, 43.10000000000001, 43.30000000000001, 45.9, -50.00000000000044, 11.899999999999729, 41.30000000000001, -50.00000000000044, 34.30000000000004, 39.10000000000002, -50.00000000000044, -50.00000000000044, 45.3, 47.3, -50.00000000000044, 35.900000000000034, 41.100000000000016, -50.00000000000044, 30.9, -50.00000000000044, -50.00000000000044, 38.90000000000002, 41.90000000000001, 37.70000000000003, 11.499999999999723, 44.10000000000001, 37.50000000000003, 44.7, 40.500000000000014, 24.69999999999991, 47.3, 46.099999999999994, 43.10000000000001, 33.90000000000004, 35.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 29.099999999999973, 30.9, 25.099999999999916, -50.00000000000044, 35.900000000000034, 42.30000000000001, 43.10000000000001, 40.70000000000002, -50.00000000000044, 8.699999999999683, -50.00000000000044, -50.00000000000044, 2.699999999999598, 46.699999999999996, -50.00000000000044, 39.50000000000002, 26.69999999999994, 42.900000000000006, -50.00000000000044, 44.5, 30.9, 35.500000000000036, 37.300000000000026, 44.300000000000004, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 35.10000000000004, 44.5, 45.1, -50.00000000000044, 46.699999999999996, 46.3, -50.00000000000044, 42.70000000000001, 42.500000000000014, 43.10000000000001, -50.00000000000044, 39.90000000000002, 45.5, -50.00000000000044, 37.10000000000003, 42.70000000000001, 45.7, 46.9, 31.500000000000007], "episode_lengths": [86, 308, 500, 500, 500, 56, 72, 198, 500, 466, 178, 32, 202, 132, 500, 70, 68, 42, 500, 382, 88, 500, 158, 110, 500, 500, 48, 28, 500, 142, 90, 500, 192, 500, 500, 112, 82, 124, 386, 60, 126, 54, 96, 254, 28, 40, 70, 162, 146, 500, 500, 500, 38, 210, 192, 250, 500, 142, 78, 70, 94, 500, 414, 500, 500, 474, 34, 500, 106, 234, 72, 500, 56, 192, 146, 128, 58, 500, 500, 62, 500, 150, 56, 50, 500, 34, 38, 500, 74, 76, 70, 500, 102, 46, 500, 130, 74, 44, 32, 186]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.375436310387354, "mean_inference_ms": 1.2040759982076867, "mean_action_processing_ms": 0.13946393113751518, "mean_env_wait_ms": 0.08261445238939755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023988962173461914, "StateBufferConnector_ms": 0.009000778198242188, "ViewRequirementAgentConnector_ms": 0.09801578521728516}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5623.382255169477, "num_env_steps_trained_throughput_per_sec": 5623.382255169477, "timesteps_total": 180000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 180000, "timers": {"training_iteration_time_ms": 3194.148, "sample_time_ms": 2855.341, "load_time_ms": 19.756, "load_throughput": 911114.179, "learn_time_ms": 307.144, "learn_throughput": 58604.356, "synch_weights_time_ms": 9.501}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "done": false, "episodes_total": 647, "training_iteration": 10, "trial_id": "9f288_00015", "date": "2023-10-25_16-47-13", "timestamp": 1698248833, "time_this_iter_s": 3.206918716430664, "time_total_s": 32.002896547317505, "pid": 4200, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 32.002896547317505, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 55.2, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.00019531250000000004, "cur_lr": 0.0003, "total_loss": 7.275999641418457, "policy_loss": 0.049519803002476694, "vf_loss": 7.226536512374878, "vf_explained_var": -9.894371032714845e-07, "kl": 0.00022091358784734894, "entropy": 0.566776767373085, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 210.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 198000, "num_env_steps_trained": 198000, "num_agent_steps_sampled": 198000, "num_agent_steps_trained": 198000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 15.28299999999987, "episode_len_mean": 212.9, "episode_media": {}, "episodes_this_iter": 82, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.5, 45.1, -50.00000000000044, 46.699999999999996, 46.3, -50.00000000000044, 42.70000000000001, 42.500000000000014, 43.10000000000001, -50.00000000000044, 39.90000000000002, 45.5, -50.00000000000044, 37.10000000000003, 42.70000000000001, 45.7, 46.9, 31.500000000000007, -50.00000000000044, -50.00000000000044, 40.10000000000002, 42.10000000000001, 14.299999999999763, 37.70000000000003, 34.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 41.70000000000002, -50.00000000000044, 14.899999999999771, 42.500000000000014, 45.9, 45.1, 43.900000000000006, -50.00000000000044, -50.00000000000044, 44.300000000000004, 13.299999999999748, 32.700000000000024, -50.00000000000044, 37.50000000000003, 45.5, 46.3, -50.00000000000044, 46.099999999999994, -50.00000000000044, 46.3, -50.00000000000044, 36.70000000000003, 38.90000000000002, -50.00000000000044, 42.500000000000014, 30.9, 40.70000000000002, 46.099999999999994, 28.499999999999964, 45.5, 36.900000000000034, 45.9, 41.70000000000002, 44.10000000000001, 44.5, 24.299999999999905, 43.7, 43.30000000000001, 42.30000000000001, 42.900000000000006, -50.00000000000044, 38.90000000000002, 42.10000000000001, -50.00000000000044, 46.3, 46.5, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.100000000000016, -50.00000000000044, -50.00000000000044, 43.900000000000006, 45.7, 44.900000000000006, 40.30000000000002, 41.30000000000001, 43.50000000000001, 28.699999999999967, 32.100000000000016, 43.50000000000001, -50.00000000000044, 44.5, 24.899999999999913, 21.09999999999986, 8.699999999999683, 47.3, 42.500000000000014], "episode_lengths": [56, 50, 500, 34, 38, 500, 74, 76, 70, 500, 102, 46, 500, 130, 74, 44, 32, 186, 500, 500, 100, 80, 358, 124, 160, 500, 500, 500, 84, 500, 84, 500, 352, 76, 42, 50, 62, 500, 500, 58, 368, 174, 500, 126, 46, 38, 500, 40, 500, 38, 500, 134, 112, 500, 76, 192, 94, 40, 216, 46, 132, 42, 84, 60, 56, 258, 64, 68, 78, 72, 500, 112, 80, 500, 38, 36, 62, 500, 500, 500, 500, 180, 500, 500, 62, 44, 52, 98, 88, 66, 214, 180, 66, 500, 56, 252, 290, 414, 28, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37575386306290876, "mean_inference_ms": 1.202829523663907, "mean_action_processing_ms": 0.13969456952749934, "mean_env_wait_ms": 0.08272782455251985, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019001007080078125, "StateBufferConnector_ms": 0.0069959163665771484, "ViewRequirementAgentConnector_ms": 0.11799192428588867}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 15.28299999999987, "episode_len_mean": 212.9, "episodes_this_iter": 82, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.5, 45.1, -50.00000000000044, 46.699999999999996, 46.3, -50.00000000000044, 42.70000000000001, 42.500000000000014, 43.10000000000001, -50.00000000000044, 39.90000000000002, 45.5, -50.00000000000044, 37.10000000000003, 42.70000000000001, 45.7, 46.9, 31.500000000000007, -50.00000000000044, -50.00000000000044, 40.10000000000002, 42.10000000000001, 14.299999999999763, 37.70000000000003, 34.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 41.70000000000002, -50.00000000000044, 14.899999999999771, 42.500000000000014, 45.9, 45.1, 43.900000000000006, -50.00000000000044, -50.00000000000044, 44.300000000000004, 13.299999999999748, 32.700000000000024, -50.00000000000044, 37.50000000000003, 45.5, 46.3, -50.00000000000044, 46.099999999999994, -50.00000000000044, 46.3, -50.00000000000044, 36.70000000000003, 38.90000000000002, -50.00000000000044, 42.500000000000014, 30.9, 40.70000000000002, 46.099999999999994, 28.499999999999964, 45.5, 36.900000000000034, 45.9, 41.70000000000002, 44.10000000000001, 44.5, 24.299999999999905, 43.7, 43.30000000000001, 42.30000000000001, 42.900000000000006, -50.00000000000044, 38.90000000000002, 42.10000000000001, -50.00000000000044, 46.3, 46.5, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.100000000000016, -50.00000000000044, -50.00000000000044, 43.900000000000006, 45.7, 44.900000000000006, 40.30000000000002, 41.30000000000001, 43.50000000000001, 28.699999999999967, 32.100000000000016, 43.50000000000001, -50.00000000000044, 44.5, 24.899999999999913, 21.09999999999986, 8.699999999999683, 47.3, 42.500000000000014], "episode_lengths": [56, 50, 500, 34, 38, 500, 74, 76, 70, 500, 102, 46, 500, 130, 74, 44, 32, 186, 500, 500, 100, 80, 358, 124, 160, 500, 500, 500, 84, 500, 84, 500, 352, 76, 42, 50, 62, 500, 500, 58, 368, 174, 500, 126, 46, 38, 500, 40, 500, 38, 500, 134, 112, 500, 76, 192, 94, 40, 216, 46, 132, 42, 84, 60, 56, 258, 64, 68, 78, 72, 500, 112, 80, 500, 38, 36, 62, 500, 500, 500, 500, 180, 500, 500, 62, 44, 52, 98, 88, 66, 214, 180, 66, 500, 56, 252, 290, 414, 28, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37575386306290876, "mean_inference_ms": 1.202829523663907, "mean_action_processing_ms": 0.13969456952749934, "mean_env_wait_ms": 0.08272782455251985, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019001007080078125, "StateBufferConnector_ms": 0.0069959163665771484, "ViewRequirementAgentConnector_ms": 0.11799192428588867}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 198000, "num_agent_steps_trained": 198000, "num_env_steps_sampled": 198000, "num_env_steps_trained": 198000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5696.578452509996, "num_env_steps_trained_throughput_per_sec": 5696.578452509996, "timesteps_total": 198000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 198000, "timers": {"training_iteration_time_ms": 3197.692, "sample_time_ms": 2843.108, "load_time_ms": 21.182, "load_throughput": 849791.001, "learn_time_ms": 321.696, "learn_throughput": 55953.485, "synch_weights_time_ms": 9.301}, "counters": {"num_env_steps_sampled": 198000, "num_env_steps_trained": 198000, "num_agent_steps_sampled": 198000, "num_agent_steps_trained": 198000}, "done": false, "episodes_total": 729, "training_iteration": 11, "trial_id": "9f288_00015", "date": "2023-10-25_16-47-16", "timestamp": 1698248836, "time_this_iter_s": 3.164792060852051, "time_total_s": 35.167688608169556, "pid": 4200, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 35.167688608169556, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 65.25, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.765625000000002e-05, "cur_lr": 0.0003, "total_loss": 6.360572099685669, "policy_loss": 0.0008783581666648388, "vf_loss": 6.359750151634216, "vf_explained_var": -8.493661880493164e-07, "kl": 0.0009284008304959457, "entropy": 0.5628823339939117, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 230.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.395999999999828, "episode_len_mean": 256.68, "episode_media": {}, "episodes_this_iter": 62, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.70000000000002, 44.10000000000001, 44.5, 24.299999999999905, 43.7, 43.30000000000001, 42.30000000000001, 42.900000000000006, -50.00000000000044, 38.90000000000002, 42.10000000000001, -50.00000000000044, 46.3, 46.5, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.100000000000016, -50.00000000000044, -50.00000000000044, 43.900000000000006, 45.7, 44.900000000000006, 40.30000000000002, 41.30000000000001, 43.50000000000001, 28.699999999999967, 32.100000000000016, 43.50000000000001, -50.00000000000044, 44.5, 24.899999999999913, 21.09999999999986, 8.699999999999683, 47.3, 42.500000000000014, -50.00000000000044, -50.00000000000044, 45.9, 4.099999999999618, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.299999999999805, 45.1, 43.7, 31.70000000000001, -50.00000000000044, 42.70000000000001, 42.500000000000014, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 13.299999999999748, 41.70000000000002, -50.00000000000044, 42.70000000000001, 42.10000000000001, 33.30000000000003, 43.30000000000001, 44.900000000000006, 42.10000000000001, 42.10000000000001, 43.10000000000001, 45.5, 36.70000000000003, -50.00000000000044, 40.10000000000002, 37.70000000000003, 28.29999999999996, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 32.700000000000024, 46.099999999999994, 45.1, 40.70000000000002, -50.00000000000044, 31.500000000000007, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 4.299999999999621, -50.00000000000044, 38.300000000000026], "episode_lengths": [84, 60, 56, 258, 64, 68, 78, 72, 500, 112, 80, 500, 38, 36, 62, 500, 500, 500, 500, 180, 500, 500, 62, 44, 52, 98, 88, 66, 214, 180, 66, 500, 56, 252, 290, 414, 28, 76, 500, 500, 42, 460, 500, 500, 500, 328, 50, 64, 184, 500, 74, 76, 500, 70, 500, 500, 368, 84, 500, 74, 80, 168, 68, 52, 80, 80, 70, 46, 134, 500, 100, 124, 218, 500, 500, 46, 500, 500, 500, 500, 80, 500, 500, 174, 40, 50, 94, 500, 186, 40, 500, 500, 500, 500, 500, 54, 500, 458, 500, 118]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37541752391010713, "mean_inference_ms": 1.2011980006966376, "mean_action_processing_ms": 0.13949355999421345, "mean_env_wait_ms": 0.08242681919621654, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0250089168548584, "StateBufferConnector_ms": 0.007994651794433594, "ViewRequirementAgentConnector_ms": 0.12901806831359863}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.395999999999828, "episode_len_mean": 256.68, "episodes_this_iter": 62, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [41.70000000000002, 44.10000000000001, 44.5, 24.299999999999905, 43.7, 43.30000000000001, 42.30000000000001, 42.900000000000006, -50.00000000000044, 38.90000000000002, 42.10000000000001, -50.00000000000044, 46.3, 46.5, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.100000000000016, -50.00000000000044, -50.00000000000044, 43.900000000000006, 45.7, 44.900000000000006, 40.30000000000002, 41.30000000000001, 43.50000000000001, 28.699999999999967, 32.100000000000016, 43.50000000000001, -50.00000000000044, 44.5, 24.899999999999913, 21.09999999999986, 8.699999999999683, 47.3, 42.500000000000014, -50.00000000000044, -50.00000000000044, 45.9, 4.099999999999618, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.299999999999805, 45.1, 43.7, 31.70000000000001, -50.00000000000044, 42.70000000000001, 42.500000000000014, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 13.299999999999748, 41.70000000000002, -50.00000000000044, 42.70000000000001, 42.10000000000001, 33.30000000000003, 43.30000000000001, 44.900000000000006, 42.10000000000001, 42.10000000000001, 43.10000000000001, 45.5, 36.70000000000003, -50.00000000000044, 40.10000000000002, 37.70000000000003, 28.29999999999996, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 32.700000000000024, 46.099999999999994, 45.1, 40.70000000000002, -50.00000000000044, 31.500000000000007, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 4.299999999999621, -50.00000000000044, 38.300000000000026], "episode_lengths": [84, 60, 56, 258, 64, 68, 78, 72, 500, 112, 80, 500, 38, 36, 62, 500, 500, 500, 500, 180, 500, 500, 62, 44, 52, 98, 88, 66, 214, 180, 66, 500, 56, 252, 290, 414, 28, 76, 500, 500, 42, 460, 500, 500, 500, 328, 50, 64, 184, 500, 74, 76, 500, 70, 500, 500, 368, 84, 500, 74, 80, 168, 68, 52, 80, 80, 70, 46, 134, 500, 100, 124, 218, 500, 500, 46, 500, 500, 500, 500, 80, 500, 500, 174, 40, 50, 94, 500, 186, 40, 500, 500, 500, 500, 500, 54, 500, 458, 500, 118]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37541752391010713, "mean_inference_ms": 1.2011980006966376, "mean_action_processing_ms": 0.13949355999421345, "mean_env_wait_ms": 0.08242681919621654, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0250089168548584, "StateBufferConnector_ms": 0.007994651794433594, "ViewRequirementAgentConnector_ms": 0.12901806831359863}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5711.166718472339, "num_env_steps_trained_throughput_per_sec": 5711.166718472339, "timesteps_total": 216000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 216000, "timers": {"training_iteration_time_ms": 3187.856, "sample_time_ms": 2825.132, "load_time_ms": 20.264, "load_throughput": 888259.894, "learn_time_ms": 330.253, "learn_throughput": 54503.648, "synch_weights_time_ms": 9.701}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "done": false, "episodes_total": 791, "training_iteration": 12, "trial_id": "9f288_00015", "date": "2023-10-25_16-47-19", "timestamp": 1698248839, "time_this_iter_s": 3.1567201614379883, "time_total_s": 38.324408769607544, "pid": 4200, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 38.324408769607544, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 53.56, "ram_util_percent": 27.22}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.882812500000001e-05, "cur_lr": 0.0003, "total_loss": 6.129748916625976, "policy_loss": 0.016978898644447328, "vf_loss": 6.112827229499817, "vf_explained_var": 2.0861625671386717e-08, "kl": 0.0005088593120785134, "entropy": 0.5723101079463959, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 250.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 234000, "num_env_steps_trained": 234000, "num_agent_steps_sampled": 234000, "num_agent_steps_trained": 234000}, "sampler_results": {"episode_reward_max": 46.099999999999994, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.9460000000002071, "episode_len_mean": 290.0, "episode_media": {}, "episodes_this_iter": 58, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 42.70000000000001, 42.10000000000001, 33.30000000000003, 43.30000000000001, 44.900000000000006, 42.10000000000001, 42.10000000000001, 43.10000000000001, 45.5, 36.70000000000003, -50.00000000000044, 40.10000000000002, 37.70000000000003, 28.29999999999996, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 32.700000000000024, 46.099999999999994, 45.1, 40.70000000000002, -50.00000000000044, 31.500000000000007, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 4.299999999999621, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, 29.49999999999998, 42.500000000000014, -50.00000000000044, 42.500000000000014, -50.00000000000044, 38.90000000000002, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044, 41.30000000000001, 43.10000000000001, -50.00000000000044, 45.7, -50.00000000000044, 44.5, 36.70000000000003, 41.90000000000001, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 33.10000000000003, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 16.29999999999979, 29.49999999999998, 44.7, 45.9, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 44.300000000000004, 24.69999999999991, -50.00000000000044, -50.00000000000044, 41.70000000000002, 45.3, 26.69999999999994, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.899999999999928, 45.3, -50.00000000000044, 41.90000000000001, 41.500000000000014], "episode_lengths": [500, 74, 80, 168, 68, 52, 80, 80, 70, 46, 134, 500, 100, 124, 218, 500, 500, 46, 500, 500, 500, 500, 80, 500, 500, 174, 40, 50, 94, 500, 186, 40, 500, 500, 500, 500, 500, 54, 500, 458, 500, 118, 500, 500, 206, 76, 500, 76, 500, 112, 500, 92, 500, 500, 88, 70, 500, 44, 500, 56, 134, 82, 64, 500, 500, 500, 500, 500, 68, 500, 500, 170, 500, 40, 500, 500, 338, 206, 54, 42, 500, 88, 500, 500, 58, 254, 500, 500, 84, 48, 234, 124, 500, 500, 500, 242, 48, 500, 82, 86]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3751787279729605, "mean_inference_ms": 1.1997020278980006, "mean_action_processing_ms": 0.1390337010763781, "mean_env_wait_ms": 0.08247433991314017, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030011415481567383, "StateBufferConnector_ms": 0.001998424530029297, "ViewRequirementAgentConnector_ms": 0.12598204612731934}}, "episode_reward_max": 46.099999999999994, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.9460000000002071, "episode_len_mean": 290.0, "episodes_this_iter": 58, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 42.70000000000001, 42.10000000000001, 33.30000000000003, 43.30000000000001, 44.900000000000006, 42.10000000000001, 42.10000000000001, 43.10000000000001, 45.5, 36.70000000000003, -50.00000000000044, 40.10000000000002, 37.70000000000003, 28.29999999999996, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 32.700000000000024, 46.099999999999994, 45.1, 40.70000000000002, -50.00000000000044, 31.500000000000007, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 4.299999999999621, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, 29.49999999999998, 42.500000000000014, -50.00000000000044, 42.500000000000014, -50.00000000000044, 38.90000000000002, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044, 41.30000000000001, 43.10000000000001, -50.00000000000044, 45.7, -50.00000000000044, 44.5, 36.70000000000003, 41.90000000000001, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 33.10000000000003, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 16.29999999999979, 29.49999999999998, 44.7, 45.9, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 44.300000000000004, 24.69999999999991, -50.00000000000044, -50.00000000000044, 41.70000000000002, 45.3, 26.69999999999994, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.899999999999928, 45.3, -50.00000000000044, 41.90000000000001, 41.500000000000014], "episode_lengths": [500, 74, 80, 168, 68, 52, 80, 80, 70, 46, 134, 500, 100, 124, 218, 500, 500, 46, 500, 500, 500, 500, 80, 500, 500, 174, 40, 50, 94, 500, 186, 40, 500, 500, 500, 500, 500, 54, 500, 458, 500, 118, 500, 500, 206, 76, 500, 76, 500, 112, 500, 92, 500, 500, 88, 70, 500, 44, 500, 56, 134, 82, 64, 500, 500, 500, 500, 500, 68, 500, 500, 170, 500, 40, 500, 500, 338, 206, 54, 42, 500, 88, 500, 500, 58, 254, 500, 500, 84, 48, 234, 124, 500, 500, 500, 242, 48, 500, 82, 86]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3751787279729605, "mean_inference_ms": 1.1997020278980006, "mean_action_processing_ms": 0.1390337010763781, "mean_env_wait_ms": 0.08247433991314017, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030011415481567383, "StateBufferConnector_ms": 0.001998424530029297, "ViewRequirementAgentConnector_ms": 0.12598204612731934}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 234000, "num_agent_steps_trained": 234000, "num_env_steps_sampled": 234000, "num_env_steps_trained": 234000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5775.184356941904, "num_env_steps_trained_throughput_per_sec": 5775.184356941904, "timesteps_total": 234000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 234000, "timers": {"training_iteration_time_ms": 3184.206, "sample_time_ms": 2826.072, "load_time_ms": 19.79, "load_throughput": 909546.729, "learn_time_ms": 326.18, "learn_throughput": 55184.318, "synch_weights_time_ms": 9.759}, "counters": {"num_env_steps_sampled": 234000, "num_env_steps_trained": 234000, "num_agent_steps_sampled": 234000, "num_agent_steps_trained": 234000}, "done": false, "episodes_total": 849, "training_iteration": 13, "trial_id": "9f288_00015", "date": "2023-10-25_16-47-22", "timestamp": 1698248842, "time_this_iter_s": 3.122781276702881, "time_total_s": 41.447190046310425, "pid": 4200, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 41.447190046310425, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 66.625, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.4414062500000005e-05, "cur_lr": 0.0003, "total_loss": 6.895824408531189, "policy_loss": 0.01719840532168746, "vf_loss": 6.878682494163513, "vf_explained_var": 1.1056661605834961e-06, "kl": 0.0012320045858928096, "entropy": 0.5650622129440308, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 270.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.163999999999829, "episode_len_mean": 259.0, "episode_media": {}, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 16.29999999999979, 29.49999999999998, 44.7, 45.9, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 44.300000000000004, 24.69999999999991, -50.00000000000044, -50.00000000000044, 41.70000000000002, 45.3, 26.69999999999994, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.899999999999928, 45.3, -50.00000000000044, 41.90000000000001, 41.500000000000014, -50.00000000000044, -50.00000000000044, 27.49999999999995, 45.1, 23.099999999999888, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.09999999999993, -50.00000000000044, 41.90000000000001, 45.1, 38.50000000000003, 35.30000000000004, 41.30000000000001, 34.10000000000004, 44.10000000000001, 43.900000000000006, -50.00000000000044, 38.90000000000002, 39.70000000000002, -50.00000000000044, 41.30000000000001, -50.00000000000044, 42.70000000000001, 44.7, -50.00000000000044, 43.10000000000001, -50.00000000000044, 35.70000000000003, -50.00000000000044, 44.10000000000001, -50.00000000000044, 3.2999999999996064, 42.10000000000001, 35.70000000000003, -50.00000000000044, 41.30000000000001, 40.30000000000002, -50.00000000000044, 41.70000000000002, 41.90000000000001, 41.500000000000014, 44.900000000000006, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, 41.100000000000016, 43.10000000000001, 47.1, 36.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, 10.499999999999709, -50.00000000000044, 40.500000000000014, 46.699999999999996, 12.299999999999734, -50.00000000000044, 18.499999999999822, 43.30000000000001, 45.1, -50.00000000000044, 34.10000000000004, 44.300000000000004, 41.30000000000001, 41.100000000000016, 44.10000000000001], "episode_lengths": [500, 500, 338, 206, 54, 42, 500, 88, 500, 500, 58, 254, 500, 500, 84, 48, 234, 124, 500, 500, 500, 242, 48, 500, 82, 86, 500, 500, 226, 50, 270, 56, 500, 500, 500, 240, 500, 82, 50, 116, 148, 88, 160, 60, 62, 500, 112, 104, 500, 88, 500, 74, 54, 500, 70, 500, 144, 500, 60, 500, 468, 80, 144, 500, 88, 98, 500, 84, 82, 86, 52, 82, 500, 500, 500, 500, 100, 90, 70, 30, 136, 500, 500, 500, 114, 396, 500, 96, 34, 378, 500, 316, 68, 50, 500, 160, 58, 88, 90, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37527722381388867, "mean_inference_ms": 1.2008727311604497, "mean_action_processing_ms": 0.13886447392446413, "mean_env_wait_ms": 0.08312485156683014, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.036002397537231445, "StateBufferConnector_ms": 0.0039980411529541016, "ViewRequirementAgentConnector_ms": 0.11547994613647461}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.163999999999829, "episode_len_mean": 259.0, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 16.29999999999979, 29.49999999999998, 44.7, 45.9, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 44.300000000000004, 24.69999999999991, -50.00000000000044, -50.00000000000044, 41.70000000000002, 45.3, 26.69999999999994, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.899999999999928, 45.3, -50.00000000000044, 41.90000000000001, 41.500000000000014, -50.00000000000044, -50.00000000000044, 27.49999999999995, 45.1, 23.099999999999888, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.09999999999993, -50.00000000000044, 41.90000000000001, 45.1, 38.50000000000003, 35.30000000000004, 41.30000000000001, 34.10000000000004, 44.10000000000001, 43.900000000000006, -50.00000000000044, 38.90000000000002, 39.70000000000002, -50.00000000000044, 41.30000000000001, -50.00000000000044, 42.70000000000001, 44.7, -50.00000000000044, 43.10000000000001, -50.00000000000044, 35.70000000000003, -50.00000000000044, 44.10000000000001, -50.00000000000044, 3.2999999999996064, 42.10000000000001, 35.70000000000003, -50.00000000000044, 41.30000000000001, 40.30000000000002, -50.00000000000044, 41.70000000000002, 41.90000000000001, 41.500000000000014, 44.900000000000006, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, 41.100000000000016, 43.10000000000001, 47.1, 36.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, 10.499999999999709, -50.00000000000044, 40.500000000000014, 46.699999999999996, 12.299999999999734, -50.00000000000044, 18.499999999999822, 43.30000000000001, 45.1, -50.00000000000044, 34.10000000000004, 44.300000000000004, 41.30000000000001, 41.100000000000016, 44.10000000000001], "episode_lengths": [500, 500, 338, 206, 54, 42, 500, 88, 500, 500, 58, 254, 500, 500, 84, 48, 234, 124, 500, 500, 500, 242, 48, 500, 82, 86, 500, 500, 226, 50, 270, 56, 500, 500, 500, 240, 500, 82, 50, 116, 148, 88, 160, 60, 62, 500, 112, 104, 500, 88, 500, 74, 54, 500, 70, 500, 144, 500, 60, 500, 468, 80, 144, 500, 88, 98, 500, 84, 82, 86, 52, 82, 500, 500, 500, 500, 100, 90, 70, 30, 136, 500, 500, 500, 114, 396, 500, 96, 34, 378, 500, 316, 68, 50, 500, 160, 58, 88, 90, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37527722381388867, "mean_inference_ms": 1.2008727311604497, "mean_action_processing_ms": 0.13886447392446413, "mean_env_wait_ms": 0.08312485156683014, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.036002397537231445, "StateBufferConnector_ms": 0.0039980411529541016, "ViewRequirementAgentConnector_ms": 0.11547994613647461}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5709.30957918862, "num_env_steps_trained_throughput_per_sec": 5709.30957918862, "timesteps_total": 252000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 252000, "timers": {"training_iteration_time_ms": 3182.945, "sample_time_ms": 2827.957, "load_time_ms": 18.391, "load_throughput": 978738.901, "learn_time_ms": 324.404, "learn_throughput": 55486.291, "synch_weights_time_ms": 9.79}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "done": false, "episodes_total": 923, "training_iteration": 14, "trial_id": "9f288_00015", "date": "2023-10-25_16-47-26", "timestamp": 1698248846, "time_this_iter_s": 3.1585466861724854, "time_total_s": 44.60573673248291, "pid": 4200, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 44.60573673248291, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 61.2, "ram_util_percent": 27.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.2207031250000002e-05, "cur_lr": 0.0003, "total_loss": 7.073363304138184, "policy_loss": 0.020115815475583075, "vf_loss": 7.053302311897278, "vf_explained_var": -3.8743019104003906e-07, "kl": 0.0006836495867503344, "entropy": 0.5481864184141159, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 290.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 270000, "num_env_steps_trained": 270000, "num_agent_steps_sampled": 270000, "num_agent_steps_trained": 270000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.973999999999827, "episode_len_mean": 260.94, "episode_media": {}, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.70000000000002, 41.90000000000001, 41.500000000000014, 44.900000000000006, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, 41.100000000000016, 43.10000000000001, 47.1, 36.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, 10.499999999999709, -50.00000000000044, 40.500000000000014, 46.699999999999996, 12.299999999999734, -50.00000000000044, 18.499999999999822, 43.30000000000001, 45.1, -50.00000000000044, 34.10000000000004, 44.300000000000004, 41.30000000000001, 41.100000000000016, 44.10000000000001, -50.00000000000044, 42.900000000000006, 45.3, -50.00000000000044, -50.00000000000044, 3.699999999999612, -50.00000000000044, 39.50000000000002, 43.900000000000006, -50.00000000000044, 44.5, 43.10000000000001, -50.00000000000044, 43.10000000000001, 43.50000000000001, 31.500000000000007, 33.10000000000003, 30.699999999999996, 41.90000000000001, 21.699999999999868, 43.900000000000006, 14.299999999999763, 44.5, 35.10000000000004, 31.900000000000013, 40.70000000000002, 40.90000000000002, 46.5, 43.900000000000006, -50.00000000000044, 33.30000000000003, 45.5, -50.00000000000044, 41.100000000000016, 6.699999999999655, 40.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 13.099999999999746, 47.1, -50.00000000000044, 39.300000000000026, 46.699999999999996, 23.8999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, 7.499999999999666, 39.70000000000002, 46.3, 41.30000000000001, -50.00000000000044, 19.899999999999842, 33.10000000000003, 33.90000000000004, -50.00000000000044, 2.0999999999995893, -50.00000000000044, 43.900000000000006, 11.699999999999726, 43.30000000000001, 7.299999999999663], "episode_lengths": [84, 82, 86, 52, 82, 500, 500, 500, 500, 100, 90, 70, 30, 136, 500, 500, 500, 114, 396, 500, 96, 34, 378, 500, 316, 68, 50, 500, 160, 58, 88, 90, 60, 500, 72, 48, 500, 500, 464, 500, 106, 62, 500, 56, 70, 500, 70, 66, 186, 170, 194, 82, 284, 62, 358, 56, 150, 182, 94, 92, 36, 62, 500, 168, 46, 500, 90, 434, 98, 500, 500, 500, 500, 500, 500, 500, 370, 30, 500, 108, 34, 262, 500, 500, 500, 426, 104, 38, 88, 500, 302, 170, 162, 500, 480, 500, 62, 384, 68, 428]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3751471563366722, "mean_inference_ms": 1.2009653394429682, "mean_action_processing_ms": 0.13876559483299203, "mean_env_wait_ms": 0.0830547074777564, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0319981575012207, "StateBufferConnector_ms": 0.0060002803802490234, "ViewRequirementAgentConnector_ms": 0.1312572956085205}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.973999999999827, "episode_len_mean": 260.94, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [41.70000000000002, 41.90000000000001, 41.500000000000014, 44.900000000000006, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, 41.100000000000016, 43.10000000000001, 47.1, 36.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, 10.499999999999709, -50.00000000000044, 40.500000000000014, 46.699999999999996, 12.299999999999734, -50.00000000000044, 18.499999999999822, 43.30000000000001, 45.1, -50.00000000000044, 34.10000000000004, 44.300000000000004, 41.30000000000001, 41.100000000000016, 44.10000000000001, -50.00000000000044, 42.900000000000006, 45.3, -50.00000000000044, -50.00000000000044, 3.699999999999612, -50.00000000000044, 39.50000000000002, 43.900000000000006, -50.00000000000044, 44.5, 43.10000000000001, -50.00000000000044, 43.10000000000001, 43.50000000000001, 31.500000000000007, 33.10000000000003, 30.699999999999996, 41.90000000000001, 21.699999999999868, 43.900000000000006, 14.299999999999763, 44.5, 35.10000000000004, 31.900000000000013, 40.70000000000002, 40.90000000000002, 46.5, 43.900000000000006, -50.00000000000044, 33.30000000000003, 45.5, -50.00000000000044, 41.100000000000016, 6.699999999999655, 40.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 13.099999999999746, 47.1, -50.00000000000044, 39.300000000000026, 46.699999999999996, 23.8999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, 7.499999999999666, 39.70000000000002, 46.3, 41.30000000000001, -50.00000000000044, 19.899999999999842, 33.10000000000003, 33.90000000000004, -50.00000000000044, 2.0999999999995893, -50.00000000000044, 43.900000000000006, 11.699999999999726, 43.30000000000001, 7.299999999999663], "episode_lengths": [84, 82, 86, 52, 82, 500, 500, 500, 500, 100, 90, 70, 30, 136, 500, 500, 500, 114, 396, 500, 96, 34, 378, 500, 316, 68, 50, 500, 160, 58, 88, 90, 60, 500, 72, 48, 500, 500, 464, 500, 106, 62, 500, 56, 70, 500, 70, 66, 186, 170, 194, 82, 284, 62, 358, 56, 150, 182, 94, 92, 36, 62, 500, 168, 46, 500, 90, 434, 98, 500, 500, 500, 500, 500, 500, 500, 370, 30, 500, 108, 34, 262, 500, 500, 500, 426, 104, 38, 88, 500, 302, 170, 162, 500, 480, 500, 62, 384, 68, 428]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3751471563366722, "mean_inference_ms": 1.2009653394429682, "mean_action_processing_ms": 0.13876559483299203, "mean_env_wait_ms": 0.0830547074777564, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0319981575012207, "StateBufferConnector_ms": 0.0060002803802490234, "ViewRequirementAgentConnector_ms": 0.1312572956085205}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 270000, "num_agent_steps_trained": 270000, "num_env_steps_sampled": 270000, "num_env_steps_trained": 270000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5627.24800246504, "num_env_steps_trained_throughput_per_sec": 5627.24800246504, "timesteps_total": 270000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 270000, "timers": {"training_iteration_time_ms": 3182.392, "sample_time_ms": 2822.385, "load_time_ms": 18.947, "load_throughput": 950021.795, "learn_time_ms": 328.774, "learn_throughput": 54748.795, "synch_weights_time_ms": 9.984}, "counters": {"num_env_steps_sampled": 270000, "num_env_steps_trained": 270000, "num_agent_steps_sampled": 270000, "num_agent_steps_trained": 270000}, "done": false, "episodes_total": 990, "training_iteration": 15, "trial_id": "9f288_00015", "date": "2023-10-25_16-47-29", "timestamp": 1698248849, "time_this_iter_s": 3.2037200927734375, "time_total_s": 47.80945682525635, "pid": 4200, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 47.80945682525635, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 58.82000000000001, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.103515625000001e-06, "cur_lr": 0.0003, "total_loss": 7.0310933828353885, "policy_loss": -0.0320136422210453, "vf_loss": 7.0631649732589725, "vf_explained_var": 9.208917617797851e-07, "kl": 0.0007620874600434036, "entropy": 0.5791976600885391, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 310.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.2739999999998033, "episode_len_mean": 287.9, "episode_media": {}, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 41.100000000000016, 6.699999999999655, 40.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 13.099999999999746, 47.1, -50.00000000000044, 39.300000000000026, 46.699999999999996, 23.8999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, 7.499999999999666, 39.70000000000002, 46.3, 41.30000000000001, -50.00000000000044, 19.899999999999842, 33.10000000000003, 33.90000000000004, -50.00000000000044, 2.0999999999995893, -50.00000000000044, 43.900000000000006, 11.699999999999726, 43.30000000000001, 7.299999999999663, -50.00000000000044, 43.7, -50.00000000000044, 31.300000000000004, 28.89999999999997, 44.5, 36.70000000000003, 40.30000000000002, 43.900000000000006, 44.5, 41.90000000000001, 18.499999999999822, 42.900000000000006, 11.699999999999726, 25.899999999999928, 44.7, 43.10000000000001, -50.00000000000044, 13.099999999999746, -50.00000000000044, 43.50000000000001, 43.30000000000001, -50.00000000000044, -50.00000000000044, 20.299999999999848, 18.099999999999817, 46.099999999999994, 43.900000000000006, 30.9, 40.70000000000002, 23.8999999999999, -50.00000000000044, 41.90000000000001, -50.00000000000044, 27.099999999999945, 4.899999999999629, 45.1, -50.00000000000044, 32.50000000000002, -50.00000000000044, 35.500000000000036, -50.00000000000044, 42.500000000000014, 33.90000000000004, 44.10000000000001, -50.00000000000044, -50.00000000000044, 41.100000000000016, 5.299999999999635, 28.89999999999997, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 45.1, 42.900000000000006, -50.00000000000044, 34.70000000000004, -50.00000000000044, 46.099999999999994, 31.1, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 90, 434, 98, 500, 500, 500, 500, 500, 500, 500, 370, 30, 500, 108, 34, 262, 500, 500, 500, 426, 104, 38, 88, 500, 302, 170, 162, 500, 480, 500, 62, 384, 68, 428, 500, 64, 500, 188, 212, 56, 134, 98, 62, 56, 82, 316, 72, 384, 242, 54, 70, 500, 370, 500, 66, 68, 500, 500, 298, 320, 40, 62, 192, 94, 262, 500, 82, 500, 230, 452, 50, 500, 176, 500, 146, 500, 76, 162, 60, 500, 500, 90, 448, 212, 500, 60, 500, 500, 40, 500, 50, 72, 500, 154, 500, 40, 190, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.375308426707165, "mean_inference_ms": 1.2007447359839623, "mean_action_processing_ms": 0.139227343834117, "mean_env_wait_ms": 0.08286528076020215, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024753332138061523, "StateBufferConnector_ms": 0.012314081192016602, "ViewRequirementAgentConnector_ms": 0.1135098934173584}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.2739999999998033, "episode_len_mean": 287.9, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 41.100000000000016, 6.699999999999655, 40.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 13.099999999999746, 47.1, -50.00000000000044, 39.300000000000026, 46.699999999999996, 23.8999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, 7.499999999999666, 39.70000000000002, 46.3, 41.30000000000001, -50.00000000000044, 19.899999999999842, 33.10000000000003, 33.90000000000004, -50.00000000000044, 2.0999999999995893, -50.00000000000044, 43.900000000000006, 11.699999999999726, 43.30000000000001, 7.299999999999663, -50.00000000000044, 43.7, -50.00000000000044, 31.300000000000004, 28.89999999999997, 44.5, 36.70000000000003, 40.30000000000002, 43.900000000000006, 44.5, 41.90000000000001, 18.499999999999822, 42.900000000000006, 11.699999999999726, 25.899999999999928, 44.7, 43.10000000000001, -50.00000000000044, 13.099999999999746, -50.00000000000044, 43.50000000000001, 43.30000000000001, -50.00000000000044, -50.00000000000044, 20.299999999999848, 18.099999999999817, 46.099999999999994, 43.900000000000006, 30.9, 40.70000000000002, 23.8999999999999, -50.00000000000044, 41.90000000000001, -50.00000000000044, 27.099999999999945, 4.899999999999629, 45.1, -50.00000000000044, 32.50000000000002, -50.00000000000044, 35.500000000000036, -50.00000000000044, 42.500000000000014, 33.90000000000004, 44.10000000000001, -50.00000000000044, -50.00000000000044, 41.100000000000016, 5.299999999999635, 28.89999999999997, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 45.1, 42.900000000000006, -50.00000000000044, 34.70000000000004, -50.00000000000044, 46.099999999999994, 31.1, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 90, 434, 98, 500, 500, 500, 500, 500, 500, 500, 370, 30, 500, 108, 34, 262, 500, 500, 500, 426, 104, 38, 88, 500, 302, 170, 162, 500, 480, 500, 62, 384, 68, 428, 500, 64, 500, 188, 212, 56, 134, 98, 62, 56, 82, 316, 72, 384, 242, 54, 70, 500, 370, 500, 66, 68, 500, 500, 298, 320, 40, 62, 192, 94, 262, 500, 82, 500, 230, 452, 50, 500, 176, 500, 146, 500, 76, 162, 60, 500, 500, 90, 448, 212, 500, 60, 500, 500, 40, 500, 50, 72, 500, 154, 500, 40, 190, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.375308426707165, "mean_inference_ms": 1.2007447359839623, "mean_action_processing_ms": 0.139227343834117, "mean_env_wait_ms": 0.08286528076020215, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024753332138061523, "StateBufferConnector_ms": 0.012314081192016602, "ViewRequirementAgentConnector_ms": 0.1135098934173584}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5617.358889823907, "num_env_steps_trained_throughput_per_sec": 5617.358889823907, "timesteps_total": 288000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 3171.739, "sample_time_ms": 2817.131, "load_time_ms": 18.419, "load_throughput": 977274.336, "learn_time_ms": 323.999, "learn_throughput": 55555.645, "synch_weights_time_ms": 9.988}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "episodes_total": 1055, "training_iteration": 16, "trial_id": "9f288_00015", "date": "2023-10-25_16-47-32", "timestamp": 1698248852, "time_this_iter_s": 3.2098701000213623, "time_total_s": 51.01932692527771, "pid": 4200, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 51.01932692527771, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 61.825, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.0517578125000006e-06, "cur_lr": 0.0003, "total_loss": 6.639233827590942, "policy_loss": 0.0008740682154893875, "vf_loss": 6.6384141683578495, "vf_explained_var": -4.369020462036133e-06, "kl": 0.00114355385185263, "entropy": 0.5436837077140808, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 330.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 306000, "num_env_steps_trained": 306000, "num_agent_steps_sampled": 306000, "num_agent_steps_trained": 306000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.318999999999816, "episode_len_mean": 272.4, "episode_media": {}, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.1, -50.00000000000044, 32.50000000000002, -50.00000000000044, 35.500000000000036, -50.00000000000044, 42.500000000000014, 33.90000000000004, 44.10000000000001, -50.00000000000044, -50.00000000000044, 41.100000000000016, 5.299999999999635, 28.89999999999997, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 45.1, 42.900000000000006, -50.00000000000044, 34.70000000000004, -50.00000000000044, 46.099999999999994, 31.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 38.10000000000002, 44.900000000000006, -50.00000000000044, 46.3, -50.00000000000044, 37.90000000000003, 24.099999999999902, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.699999999999896, 45.3, 35.500000000000036, 44.900000000000006, 45.1, 43.900000000000006, 34.30000000000004, 39.90000000000002, 44.300000000000004, -50.00000000000044, -50.00000000000044, 44.10000000000001, 36.900000000000034, 37.10000000000003, -50.00000000000044, 26.299999999999933, 21.499999999999865, 34.30000000000004, 42.30000000000001, 42.70000000000001, 8.099999999999675, 45.1, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.900000000000034, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, 44.10000000000001, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 41.100000000000016, 45.5, 32.90000000000003, -50.00000000000044, 46.099999999999994, 46.3, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 40.90000000000002, 39.50000000000002, 37.90000000000003, 42.500000000000014, -50.00000000000044], "episode_lengths": [50, 500, 176, 500, 146, 500, 76, 162, 60, 500, 500, 90, 448, 212, 500, 60, 500, 500, 40, 500, 50, 72, 500, 154, 500, 40, 190, 500, 500, 500, 34, 120, 52, 500, 38, 500, 122, 260, 68, 500, 500, 500, 500, 264, 48, 146, 52, 50, 62, 158, 102, 58, 500, 500, 60, 132, 130, 500, 238, 286, 158, 78, 74, 420, 50, 72, 500, 500, 500, 500, 152, 500, 78, 500, 500, 500, 500, 110, 60, 500, 500, 78, 500, 90, 46, 172, 500, 40, 38, 66, 500, 500, 500, 500, 56, 92, 106, 122, 76, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3749594458327548, "mean_inference_ms": 1.20117766548268, "mean_action_processing_ms": 0.13963154559432192, "mean_env_wait_ms": 0.08297165439762566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026990413665771484, "StateBufferConnector_ms": 0.006001949310302734, "ViewRequirementAgentConnector_ms": 0.10551023483276367}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.318999999999816, "episode_len_mean": 272.4, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.1, -50.00000000000044, 32.50000000000002, -50.00000000000044, 35.500000000000036, -50.00000000000044, 42.500000000000014, 33.90000000000004, 44.10000000000001, -50.00000000000044, -50.00000000000044, 41.100000000000016, 5.299999999999635, 28.89999999999997, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 45.1, 42.900000000000006, -50.00000000000044, 34.70000000000004, -50.00000000000044, 46.099999999999994, 31.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 38.10000000000002, 44.900000000000006, -50.00000000000044, 46.3, -50.00000000000044, 37.90000000000003, 24.099999999999902, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.699999999999896, 45.3, 35.500000000000036, 44.900000000000006, 45.1, 43.900000000000006, 34.30000000000004, 39.90000000000002, 44.300000000000004, -50.00000000000044, -50.00000000000044, 44.10000000000001, 36.900000000000034, 37.10000000000003, -50.00000000000044, 26.299999999999933, 21.499999999999865, 34.30000000000004, 42.30000000000001, 42.70000000000001, 8.099999999999675, 45.1, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.900000000000034, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, 44.10000000000001, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 41.100000000000016, 45.5, 32.90000000000003, -50.00000000000044, 46.099999999999994, 46.3, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 40.90000000000002, 39.50000000000002, 37.90000000000003, 42.500000000000014, -50.00000000000044], "episode_lengths": [50, 500, 176, 500, 146, 500, 76, 162, 60, 500, 500, 90, 448, 212, 500, 60, 500, 500, 40, 500, 50, 72, 500, 154, 500, 40, 190, 500, 500, 500, 34, 120, 52, 500, 38, 500, 122, 260, 68, 500, 500, 500, 500, 264, 48, 146, 52, 50, 62, 158, 102, 58, 500, 500, 60, 132, 130, 500, 238, 286, 158, 78, 74, 420, 50, 72, 500, 500, 500, 500, 152, 500, 78, 500, 500, 500, 500, 110, 60, 500, 500, 78, 500, 90, 46, 172, 500, 40, 38, 66, 500, 500, 500, 500, 56, 92, 106, 122, 76, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3749594458327548, "mean_inference_ms": 1.20117766548268, "mean_action_processing_ms": 0.13963154559432192, "mean_env_wait_ms": 0.08297165439762566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026990413665771484, "StateBufferConnector_ms": 0.006001949310302734, "ViewRequirementAgentConnector_ms": 0.10551023483276367}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 306000, "num_agent_steps_trained": 306000, "num_env_steps_sampled": 306000, "num_env_steps_trained": 306000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5514.442150213613, "num_env_steps_trained_throughput_per_sec": 5514.442150213613, "timesteps_total": 306000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 306000, "timers": {"training_iteration_time_ms": 3187.189, "sample_time_ms": 2830.16, "load_time_ms": 18.819, "load_throughput": 956504.474, "learn_time_ms": 326.043, "learn_throughput": 55207.465, "synch_weights_time_ms": 10.067}, "counters": {"num_env_steps_sampled": 306000, "num_env_steps_trained": 306000, "num_agent_steps_sampled": 306000, "num_agent_steps_trained": 306000}, "done": false, "episodes_total": 1126, "training_iteration": 17, "trial_id": "9f288_00015", "date": "2023-10-25_16-47-35", "timestamp": 1698248855, "time_this_iter_s": 3.269069194793701, "time_total_s": 54.28839612007141, "pid": 4200, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 54.28839612007141, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 58.14, "ram_util_percent": 27.22}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.5258789062500003e-06, "cur_lr": 0.0003, "total_loss": 7.27158682346344, "policy_loss": -0.04170551504939794, "vf_loss": 7.313349676132202, "vf_explained_var": -3.543496131896973e-06, "kl": 0.0010288665874966796, "entropy": 0.5750921607017517, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 350.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "sampler_results": {"episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.872999999999841, "episode_len_mean": 246.94, "episode_media": {}, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 39.10000000000002, 44.10000000000001, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 41.100000000000016, 45.5, 32.90000000000003, -50.00000000000044, 46.099999999999994, 46.3, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 40.90000000000002, 39.50000000000002, 37.90000000000003, 42.500000000000014, -50.00000000000044, 38.90000000000002, 43.50000000000001, 40.500000000000014, -50.00000000000044, 38.300000000000026, 24.899999999999913, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 41.70000000000002, 23.8999999999999, 44.300000000000004, 43.10000000000001, 38.300000000000026, 45.1, -50.00000000000044, 5.299999999999635, 46.5, -50.00000000000044, 29.899999999999984, 42.30000000000001, -50.00000000000044, 37.50000000000003, 37.90000000000003, 44.7, 27.099999999999945, 44.5, 39.50000000000002, 18.499999999999822, -50.00000000000044, 21.499999999999865, -50.00000000000044, 44.5, 41.90000000000001, 43.7, 39.10000000000002, 32.90000000000003, 36.50000000000003, 37.90000000000003, -50.00000000000044, 43.30000000000001, -50.00000000000044, 41.90000000000001, 44.5, -50.00000000000044, 20.299999999999848, 20.49999999999985, 13.499999999999751, 24.299999999999905, -50.00000000000044, 40.10000000000002, 43.7, 10.299999999999706, -50.00000000000044, 45.5, 28.89999999999997, -50.00000000000044, 45.1, 42.500000000000014, -50.00000000000044, 45.9, 46.3, 42.10000000000001, 44.7, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 41.100000000000016, 39.50000000000002, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 110, 60, 500, 500, 78, 500, 90, 46, 172, 500, 40, 38, 66, 500, 500, 500, 500, 56, 92, 106, 122, 76, 500, 112, 66, 96, 500, 118, 252, 500, 500, 42, 500, 84, 262, 58, 70, 118, 50, 500, 448, 36, 500, 202, 78, 500, 126, 122, 54, 230, 56, 106, 316, 500, 286, 500, 56, 82, 64, 110, 172, 136, 122, 500, 68, 500, 82, 56, 500, 298, 296, 366, 258, 500, 100, 64, 398, 500, 46, 212, 500, 50, 76, 500, 42, 38, 80, 54, 500, 50, 500, 500, 90, 106, 82, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3751845761725555, "mean_inference_ms": 1.2011941721383004, "mean_action_processing_ms": 0.13949914255893917, "mean_env_wait_ms": 0.08250741513282023, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025987863540649414, "StateBufferConnector_ms": 0.0069997310638427734, "ViewRequirementAgentConnector_ms": 0.13284921646118164}}, "episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.872999999999841, "episode_len_mean": 246.94, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 39.10000000000002, 44.10000000000001, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 41.100000000000016, 45.5, 32.90000000000003, -50.00000000000044, 46.099999999999994, 46.3, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 40.90000000000002, 39.50000000000002, 37.90000000000003, 42.500000000000014, -50.00000000000044, 38.90000000000002, 43.50000000000001, 40.500000000000014, -50.00000000000044, 38.300000000000026, 24.899999999999913, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 41.70000000000002, 23.8999999999999, 44.300000000000004, 43.10000000000001, 38.300000000000026, 45.1, -50.00000000000044, 5.299999999999635, 46.5, -50.00000000000044, 29.899999999999984, 42.30000000000001, -50.00000000000044, 37.50000000000003, 37.90000000000003, 44.7, 27.099999999999945, 44.5, 39.50000000000002, 18.499999999999822, -50.00000000000044, 21.499999999999865, -50.00000000000044, 44.5, 41.90000000000001, 43.7, 39.10000000000002, 32.90000000000003, 36.50000000000003, 37.90000000000003, -50.00000000000044, 43.30000000000001, -50.00000000000044, 41.90000000000001, 44.5, -50.00000000000044, 20.299999999999848, 20.49999999999985, 13.499999999999751, 24.299999999999905, -50.00000000000044, 40.10000000000002, 43.7, 10.299999999999706, -50.00000000000044, 45.5, 28.89999999999997, -50.00000000000044, 45.1, 42.500000000000014, -50.00000000000044, 45.9, 46.3, 42.10000000000001, 44.7, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 41.100000000000016, 39.50000000000002, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 110, 60, 500, 500, 78, 500, 90, 46, 172, 500, 40, 38, 66, 500, 500, 500, 500, 56, 92, 106, 122, 76, 500, 112, 66, 96, 500, 118, 252, 500, 500, 42, 500, 84, 262, 58, 70, 118, 50, 500, 448, 36, 500, 202, 78, 500, 126, 122, 54, 230, 56, 106, 316, 500, 286, 500, 56, 82, 64, 110, 172, 136, 122, 500, 68, 500, 82, 56, 500, 298, 296, 366, 258, 500, 100, 64, 398, 500, 46, 212, 500, 50, 76, 500, 42, 38, 80, 54, 500, 50, 500, 500, 90, 106, 82, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3751845761725555, "mean_inference_ms": 1.2011941721383004, "mean_action_processing_ms": 0.13949914255893917, "mean_env_wait_ms": 0.08250741513282023, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025987863540649414, "StateBufferConnector_ms": 0.0069997310638427734, "ViewRequirementAgentConnector_ms": 0.13284921646118164}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5830.5342871222665, "num_env_steps_trained_throughput_per_sec": 5830.5342871222665, "timesteps_total": 324000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 324000, "timers": {"training_iteration_time_ms": 3169.83, "sample_time_ms": 2828.468, "load_time_ms": 18.849, "load_throughput": 954954.635, "learn_time_ms": 310.118, "learn_throughput": 58042.421, "synch_weights_time_ms": 10.194}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "done": false, "episodes_total": 1201, "training_iteration": 18, "trial_id": "9f288_00015", "date": "2023-10-25_16-47-38", "timestamp": 1698248858, "time_this_iter_s": 3.0919506549835205, "time_total_s": 57.38034677505493, "pid": 4200, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 57.38034677505493, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 60.1, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.629394531250001e-07, "cur_lr": 0.0003, "total_loss": 7.302219200134277, "policy_loss": 0.02865831647068262, "vf_loss": 7.273615574836731, "vf_explained_var": -3.2335519790649414e-06, "kl": 4.636368271633273e-05, "entropy": 0.5474258214235306, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 370.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 342000, "num_env_steps_trained": 342000, "num_agent_steps_sampled": 342000, "num_agent_steps_trained": 342000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.472999999999823, "episode_len_mean": 260.96, "episode_media": {}, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.5, -50.00000000000044, 20.299999999999848, 20.49999999999985, 13.499999999999751, 24.299999999999905, -50.00000000000044, 40.10000000000002, 43.7, 10.299999999999706, -50.00000000000044, 45.5, 28.89999999999997, -50.00000000000044, 45.1, 42.500000000000014, -50.00000000000044, 45.9, 46.3, 42.10000000000001, 44.7, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 41.100000000000016, 39.50000000000002, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, 22.099999999999874, 1.6999999999995836, 46.5, 43.900000000000006, 44.5, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 3.699999999999612, 44.7, 44.900000000000006, 4.099999999999618, -50.00000000000044, 42.500000000000014, 11.699999999999726, -50.00000000000044, -50.00000000000044, -50.00000000000044, 16.499999999999794, 41.100000000000016, -50.00000000000044, 45.5, 27.099999999999945, -50.00000000000044, 42.70000000000001, 32.100000000000016, 47.3, -50.00000000000044, -50.00000000000044, 44.7, 43.30000000000001, 44.300000000000004, 21.499999999999865, 46.099999999999994, 11.699999999999726, -50.00000000000044, -50.00000000000044, 12.099999999999731, 41.500000000000014, 39.300000000000026, 43.900000000000006, 25.099999999999916, -50.00000000000044, 45.7, -50.00000000000044, 19.09999999999983, 35.30000000000004, -50.00000000000044, 8.299999999999677, 43.900000000000006, 38.10000000000002, 44.10000000000001, 38.50000000000003, 42.900000000000006, -50.00000000000044, 20.899999999999856, 41.70000000000002, 29.899999999999984, 38.90000000000002, 47.3, 42.900000000000006, -50.00000000000044, 43.900000000000006, 26.69999999999994], "episode_lengths": [56, 500, 298, 296, 366, 258, 500, 100, 64, 398, 500, 46, 212, 500, 50, 76, 500, 42, 38, 80, 54, 500, 50, 500, 500, 90, 106, 82, 500, 500, 500, 500, 114, 280, 484, 36, 62, 56, 56, 500, 500, 500, 60, 500, 464, 54, 52, 460, 500, 76, 384, 500, 500, 500, 336, 90, 500, 46, 230, 500, 74, 180, 28, 500, 500, 54, 68, 58, 286, 40, 384, 500, 500, 380, 86, 108, 62, 250, 500, 44, 500, 310, 148, 500, 418, 62, 120, 60, 116, 72, 500, 292, 84, 202, 112, 28, 72, 500, 62, 234]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37510022539657434, "mean_inference_ms": 1.202976137420919, "mean_action_processing_ms": 0.13991175034923098, "mean_env_wait_ms": 0.08225798915106958, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03598451614379883, "StateBufferConnector_ms": 0.006884098052978516, "ViewRequirementAgentConnector_ms": 0.14296650886535645}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.472999999999823, "episode_len_mean": 260.96, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.5, -50.00000000000044, 20.299999999999848, 20.49999999999985, 13.499999999999751, 24.299999999999905, -50.00000000000044, 40.10000000000002, 43.7, 10.299999999999706, -50.00000000000044, 45.5, 28.89999999999997, -50.00000000000044, 45.1, 42.500000000000014, -50.00000000000044, 45.9, 46.3, 42.10000000000001, 44.7, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 41.100000000000016, 39.50000000000002, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, 22.099999999999874, 1.6999999999995836, 46.5, 43.900000000000006, 44.5, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 3.699999999999612, 44.7, 44.900000000000006, 4.099999999999618, -50.00000000000044, 42.500000000000014, 11.699999999999726, -50.00000000000044, -50.00000000000044, -50.00000000000044, 16.499999999999794, 41.100000000000016, -50.00000000000044, 45.5, 27.099999999999945, -50.00000000000044, 42.70000000000001, 32.100000000000016, 47.3, -50.00000000000044, -50.00000000000044, 44.7, 43.30000000000001, 44.300000000000004, 21.499999999999865, 46.099999999999994, 11.699999999999726, -50.00000000000044, -50.00000000000044, 12.099999999999731, 41.500000000000014, 39.300000000000026, 43.900000000000006, 25.099999999999916, -50.00000000000044, 45.7, -50.00000000000044, 19.09999999999983, 35.30000000000004, -50.00000000000044, 8.299999999999677, 43.900000000000006, 38.10000000000002, 44.10000000000001, 38.50000000000003, 42.900000000000006, -50.00000000000044, 20.899999999999856, 41.70000000000002, 29.899999999999984, 38.90000000000002, 47.3, 42.900000000000006, -50.00000000000044, 43.900000000000006, 26.69999999999994], "episode_lengths": [56, 500, 298, 296, 366, 258, 500, 100, 64, 398, 500, 46, 212, 500, 50, 76, 500, 42, 38, 80, 54, 500, 50, 500, 500, 90, 106, 82, 500, 500, 500, 500, 114, 280, 484, 36, 62, 56, 56, 500, 500, 500, 60, 500, 464, 54, 52, 460, 500, 76, 384, 500, 500, 500, 336, 90, 500, 46, 230, 500, 74, 180, 28, 500, 500, 54, 68, 58, 286, 40, 384, 500, 500, 380, 86, 108, 62, 250, 500, 44, 500, 310, 148, 500, 418, 62, 120, 60, 116, 72, 500, 292, 84, 202, 112, 28, 72, 500, 62, 234]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37510022539657434, "mean_inference_ms": 1.202976137420919, "mean_action_processing_ms": 0.13991175034923098, "mean_env_wait_ms": 0.08225798915106958, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03598451614379883, "StateBufferConnector_ms": 0.006884098052978516, "ViewRequirementAgentConnector_ms": 0.14296650886535645}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 342000, "num_agent_steps_trained": 342000, "num_env_steps_sampled": 342000, "num_env_steps_trained": 342000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5778.029893695996, "num_env_steps_trained_throughput_per_sec": 5778.029893695996, "timesteps_total": 342000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 342000, "timers": {"training_iteration_time_ms": 3165.164, "sample_time_ms": 2831.897, "load_time_ms": 18.749, "load_throughput": 960042.727, "learn_time_ms": 302.05, "learn_throughput": 59592.784, "synch_weights_time_ms": 10.168}, "counters": {"num_env_steps_sampled": 342000, "num_env_steps_trained": 342000, "num_agent_steps_sampled": 342000, "num_agent_steps_trained": 342000}, "done": false, "episodes_total": 1270, "training_iteration": 19, "trial_id": "9f288_00015", "date": "2023-10-25_16-47-42", "timestamp": 1698248862, "time_this_iter_s": 3.1213440895080566, "time_total_s": 60.50169086456299, "pid": 4200, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 60.50169086456299, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 59.620000000000005, "ram_util_percent": 27.22}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.814697265625001e-07, "cur_lr": 0.0003, "total_loss": 7.283563184738159, "policy_loss": 0.02458238899707794, "vf_loss": 7.259036993980407, "vf_explained_var": -7.808208465576172e-07, "kl": 0.0008280664514010994, "entropy": 0.5627964794635772, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 390.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.662999999999839, "episode_len_mean": 259.08, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.499999999999865, 46.099999999999994, 11.699999999999726, -50.00000000000044, -50.00000000000044, 12.099999999999731, 41.500000000000014, 39.300000000000026, 43.900000000000006, 25.099999999999916, -50.00000000000044, 45.7, -50.00000000000044, 19.09999999999983, 35.30000000000004, -50.00000000000044, 8.299999999999677, 43.900000000000006, 38.10000000000002, 44.10000000000001, 38.50000000000003, 42.900000000000006, -50.00000000000044, 20.899999999999856, 41.70000000000002, 29.899999999999984, 38.90000000000002, 47.3, 42.900000000000006, -50.00000000000044, 43.900000000000006, 26.69999999999994, -50.00000000000044, 40.90000000000002, 42.900000000000006, 15.49999999999978, 44.7, -50.00000000000044, 35.500000000000036, -50.00000000000044, 44.10000000000001, 39.10000000000002, 36.70000000000003, 46.099999999999994, 2.8999999999996007, 41.90000000000001, 42.500000000000014, 43.50000000000001, -50.00000000000044, -50.00000000000044, 29.099999999999973, -50.00000000000044, -50.00000000000044, 38.300000000000026, 37.90000000000003, 5.899999999999643, 14.899999999999771, 45.5, 34.900000000000034, -50.00000000000044, 42.30000000000001, 35.500000000000036, 35.900000000000034, 45.3, 14.09999999999976, -50.00000000000044, -50.00000000000044, 2.499999999999595, 29.899999999999984, 41.30000000000001, 40.90000000000002, 41.70000000000002, -50.00000000000044, 39.300000000000026, -50.00000000000044, 30.499999999999993, -50.00000000000044, -50.00000000000044, 40.90000000000002, 42.30000000000001, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 46.3, 44.7, -50.00000000000044, -50.00000000000044, 22.49999999999988, 19.299999999999834, -50.00000000000044, 39.90000000000002, 36.50000000000003, 43.900000000000006, 28.699999999999967, 14.699999999999768, 27.49999999999995, -50.00000000000044, 30.29999999999999], "episode_lengths": [286, 40, 384, 500, 500, 380, 86, 108, 62, 250, 500, 44, 500, 310, 148, 500, 418, 62, 120, 60, 116, 72, 500, 292, 84, 202, 112, 28, 72, 500, 62, 234, 500, 92, 72, 346, 54, 500, 146, 500, 60, 110, 134, 40, 472, 82, 76, 66, 500, 500, 210, 500, 500, 118, 122, 442, 352, 46, 152, 500, 78, 146, 142, 48, 360, 500, 500, 476, 202, 88, 92, 84, 500, 108, 500, 196, 500, 500, 92, 78, 500, 500, 26, 500, 500, 38, 54, 500, 500, 276, 308, 500, 102, 136, 62, 214, 354, 226, 500, 198]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37482622550395617, "mean_inference_ms": 1.202567770105775, "mean_action_processing_ms": 0.14005684452869732, "mean_env_wait_ms": 0.08259432890448216, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02797555923461914, "StateBufferConnector_ms": 0.0030014514923095703, "ViewRequirementAgentConnector_ms": 0.132979154586792}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.662999999999839, "episode_len_mean": 259.08, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.499999999999865, 46.099999999999994, 11.699999999999726, -50.00000000000044, -50.00000000000044, 12.099999999999731, 41.500000000000014, 39.300000000000026, 43.900000000000006, 25.099999999999916, -50.00000000000044, 45.7, -50.00000000000044, 19.09999999999983, 35.30000000000004, -50.00000000000044, 8.299999999999677, 43.900000000000006, 38.10000000000002, 44.10000000000001, 38.50000000000003, 42.900000000000006, -50.00000000000044, 20.899999999999856, 41.70000000000002, 29.899999999999984, 38.90000000000002, 47.3, 42.900000000000006, -50.00000000000044, 43.900000000000006, 26.69999999999994, -50.00000000000044, 40.90000000000002, 42.900000000000006, 15.49999999999978, 44.7, -50.00000000000044, 35.500000000000036, -50.00000000000044, 44.10000000000001, 39.10000000000002, 36.70000000000003, 46.099999999999994, 2.8999999999996007, 41.90000000000001, 42.500000000000014, 43.50000000000001, -50.00000000000044, -50.00000000000044, 29.099999999999973, -50.00000000000044, -50.00000000000044, 38.300000000000026, 37.90000000000003, 5.899999999999643, 14.899999999999771, 45.5, 34.900000000000034, -50.00000000000044, 42.30000000000001, 35.500000000000036, 35.900000000000034, 45.3, 14.09999999999976, -50.00000000000044, -50.00000000000044, 2.499999999999595, 29.899999999999984, 41.30000000000001, 40.90000000000002, 41.70000000000002, -50.00000000000044, 39.300000000000026, -50.00000000000044, 30.499999999999993, -50.00000000000044, -50.00000000000044, 40.90000000000002, 42.30000000000001, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 46.3, 44.7, -50.00000000000044, -50.00000000000044, 22.49999999999988, 19.299999999999834, -50.00000000000044, 39.90000000000002, 36.50000000000003, 43.900000000000006, 28.699999999999967, 14.699999999999768, 27.49999999999995, -50.00000000000044, 30.29999999999999], "episode_lengths": [286, 40, 384, 500, 500, 380, 86, 108, 62, 250, 500, 44, 500, 310, 148, 500, 418, 62, 120, 60, 116, 72, 500, 292, 84, 202, 112, 28, 72, 500, 62, 234, 500, 92, 72, 346, 54, 500, 146, 500, 60, 110, 134, 40, 472, 82, 76, 66, 500, 500, 210, 500, 500, 118, 122, 442, 352, 46, 152, 500, 78, 146, 142, 48, 360, 500, 500, 476, 202, 88, 92, 84, 500, 108, 500, 196, 500, 500, 92, 78, 500, 500, 26, 500, 500, 38, 54, 500, 500, 276, 308, 500, 102, 136, 62, 214, 354, 226, 500, 198]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37482622550395617, "mean_inference_ms": 1.202567770105775, "mean_action_processing_ms": 0.14005684452869732, "mean_env_wait_ms": 0.08259432890448216, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02797555923461914, "StateBufferConnector_ms": 0.0030014514923095703, "ViewRequirementAgentConnector_ms": 0.132979154586792}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5709.648093151906, "num_env_steps_trained_throughput_per_sec": 5709.648093151906, "timesteps_total": 360000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 360000, "timers": {"training_iteration_time_ms": 3160.327, "sample_time_ms": 2824.945, "load_time_ms": 18.64, "load_throughput": 965642.097, "learn_time_ms": 304.406, "learn_throughput": 59131.513, "synch_weights_time_ms": 10.036}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "done": false, "episodes_total": 1338, "training_iteration": 20, "trial_id": "9f288_00015", "date": "2023-10-25_16-47-45", "timestamp": 1698248865, "time_this_iter_s": 3.158585786819458, "time_total_s": 63.660276651382446, "pid": 4200, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 63.660276651382446, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 64.675, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.9073486328125004e-07, "cur_lr": 0.0003, "total_loss": 6.856546640396118, "policy_loss": 0.028436506167054176, "vf_loss": 6.828164219856262, "vf_explained_var": -1.2367963790893555e-06, "kl": 0.0006000256208807287, "entropy": 0.5413662105798721, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 410.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 378000, "num_env_steps_trained": 378000, "num_agent_steps_sampled": 378000, "num_agent_steps_trained": 378000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.556999999999829, "episode_len_mean": 270.1, "episode_media": {}, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 2.499999999999595, 29.899999999999984, 41.30000000000001, 40.90000000000002, 41.70000000000002, -50.00000000000044, 39.300000000000026, -50.00000000000044, 30.499999999999993, -50.00000000000044, -50.00000000000044, 40.90000000000002, 42.30000000000001, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 46.3, 44.7, -50.00000000000044, -50.00000000000044, 22.49999999999988, 19.299999999999834, -50.00000000000044, 39.90000000000002, 36.50000000000003, 43.900000000000006, 28.699999999999967, 14.699999999999768, 27.49999999999995, -50.00000000000044, 30.29999999999999, 41.70000000000002, -50.00000000000044, 41.500000000000014, 33.90000000000004, 42.30000000000001, 46.099999999999994, 37.300000000000026, 44.10000000000001, 33.500000000000036, 44.900000000000006, -50.00000000000044, 1.4999999999995808, 22.099999999999874, 38.50000000000003, -50.00000000000044, 31.900000000000013, -50.00000000000044, -50.00000000000044, 37.90000000000003, 43.30000000000001, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 20.899999999999856, 29.69999999999998, 44.900000000000006, 35.500000000000036, 38.700000000000024, 46.9, 13.499999999999751, 40.10000000000002, 37.300000000000026, -50.00000000000044, 42.70000000000001, 42.70000000000001, 30.9, 40.70000000000002, 44.7, -50.00000000000044, 24.299999999999905, 33.10000000000003, 19.299999999999834, 21.09999999999986, 44.10000000000001, 8.299999999999677, 46.3, 18.899999999999828, -50.00000000000044, 17.299999999999805, 42.500000000000014, 45.7, -50.00000000000044, -50.00000000000044, 16.699999999999797, 38.10000000000002, 38.300000000000026], "episode_lengths": [500, 476, 202, 88, 92, 84, 500, 108, 500, 196, 500, 500, 92, 78, 500, 500, 26, 500, 500, 38, 54, 500, 500, 276, 308, 500, 102, 136, 62, 214, 354, 226, 500, 198, 84, 500, 86, 162, 78, 40, 128, 60, 166, 52, 500, 486, 280, 116, 500, 182, 500, 500, 122, 68, 500, 40, 500, 500, 500, 116, 500, 500, 500, 500, 500, 500, 38, 292, 204, 52, 146, 114, 32, 366, 100, 128, 500, 74, 74, 192, 94, 54, 500, 258, 170, 308, 290, 60, 418, 38, 312, 500, 328, 76, 44, 500, 500, 334, 120, 118]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3745849765397587, "mean_inference_ms": 1.2023583616909734, "mean_action_processing_ms": 0.14032165630500082, "mean_env_wait_ms": 0.0820835706101829, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026999235153198242, "StateBufferConnector_ms": 0.006001710891723633, "ViewRequirementAgentConnector_ms": 0.1256425380706787}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.556999999999829, "episode_len_mean": 270.1, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 2.499999999999595, 29.899999999999984, 41.30000000000001, 40.90000000000002, 41.70000000000002, -50.00000000000044, 39.300000000000026, -50.00000000000044, 30.499999999999993, -50.00000000000044, -50.00000000000044, 40.90000000000002, 42.30000000000001, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 46.3, 44.7, -50.00000000000044, -50.00000000000044, 22.49999999999988, 19.299999999999834, -50.00000000000044, 39.90000000000002, 36.50000000000003, 43.900000000000006, 28.699999999999967, 14.699999999999768, 27.49999999999995, -50.00000000000044, 30.29999999999999, 41.70000000000002, -50.00000000000044, 41.500000000000014, 33.90000000000004, 42.30000000000001, 46.099999999999994, 37.300000000000026, 44.10000000000001, 33.500000000000036, 44.900000000000006, -50.00000000000044, 1.4999999999995808, 22.099999999999874, 38.50000000000003, -50.00000000000044, 31.900000000000013, -50.00000000000044, -50.00000000000044, 37.90000000000003, 43.30000000000001, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 20.899999999999856, 29.69999999999998, 44.900000000000006, 35.500000000000036, 38.700000000000024, 46.9, 13.499999999999751, 40.10000000000002, 37.300000000000026, -50.00000000000044, 42.70000000000001, 42.70000000000001, 30.9, 40.70000000000002, 44.7, -50.00000000000044, 24.299999999999905, 33.10000000000003, 19.299999999999834, 21.09999999999986, 44.10000000000001, 8.299999999999677, 46.3, 18.899999999999828, -50.00000000000044, 17.299999999999805, 42.500000000000014, 45.7, -50.00000000000044, -50.00000000000044, 16.699999999999797, 38.10000000000002, 38.300000000000026], "episode_lengths": [500, 476, 202, 88, 92, 84, 500, 108, 500, 196, 500, 500, 92, 78, 500, 500, 26, 500, 500, 38, 54, 500, 500, 276, 308, 500, 102, 136, 62, 214, 354, 226, 500, 198, 84, 500, 86, 162, 78, 40, 128, 60, 166, 52, 500, 486, 280, 116, 500, 182, 500, 500, 122, 68, 500, 40, 500, 500, 500, 116, 500, 500, 500, 500, 500, 500, 38, 292, 204, 52, 146, 114, 32, 366, 100, 128, 500, 74, 74, 192, 94, 54, 500, 258, 170, 308, 290, 60, 418, 38, 312, 500, 328, 76, 44, 500, 500, 334, 120, 118]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3745849765397587, "mean_inference_ms": 1.2023583616909734, "mean_action_processing_ms": 0.14032165630500082, "mean_env_wait_ms": 0.0820835706101829, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026999235153198242, "StateBufferConnector_ms": 0.006001710891723633, "ViewRequirementAgentConnector_ms": 0.1256425380706787}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 378000, "num_agent_steps_trained": 378000, "num_env_steps_sampled": 378000, "num_env_steps_trained": 378000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5568.181270061335, "num_env_steps_trained_throughput_per_sec": 5568.181270061335, "timesteps_total": 378000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 378000, "timers": {"training_iteration_time_ms": 3167.614, "sample_time_ms": 2827.799, "load_time_ms": 18.415, "load_throughput": 977462.862, "learn_time_ms": 308.963, "learn_throughput": 58259.32, "synch_weights_time_ms": 10.036}, "counters": {"num_env_steps_sampled": 378000, "num_env_steps_trained": 378000, "num_agent_steps_sampled": 378000, "num_agent_steps_trained": 378000}, "done": false, "episodes_total": 1404, "training_iteration": 21, "trial_id": "9f288_00015", "date": "2023-10-25_16-47-48", "timestamp": 1698248868, "time_this_iter_s": 3.2386555671691895, "time_total_s": 66.89893221855164, "pid": 4200, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 66.89893221855164, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 57.3, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.536743164062502e-08, "cur_lr": 0.0003, "total_loss": 6.781534886360168, "policy_loss": -0.026496064057573675, "vf_loss": 6.808082747459411, "vf_explained_var": -1.6629695892333984e-06, "kl": 0.0010766072600191024, "entropy": 0.5205942317843437, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 430.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.495999999999837, "episode_len_mean": 255.72, "episode_media": {}, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.899999999999856, 29.69999999999998, 44.900000000000006, 35.500000000000036, 38.700000000000024, 46.9, 13.499999999999751, 40.10000000000002, 37.300000000000026, -50.00000000000044, 42.70000000000001, 42.70000000000001, 30.9, 40.70000000000002, 44.7, -50.00000000000044, 24.299999999999905, 33.10000000000003, 19.299999999999834, 21.09999999999986, 44.10000000000001, 8.299999999999677, 46.3, 18.899999999999828, -50.00000000000044, 17.299999999999805, 42.500000000000014, 45.7, -50.00000000000044, -50.00000000000044, 16.699999999999797, 38.10000000000002, 38.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 23.099999999999888, 40.30000000000002, 47.5, 45.5, 16.8999999999998, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 38.90000000000002, 45.3, 19.69999999999984, -50.00000000000044, -50.00000000000044, 42.70000000000001, 32.100000000000016, 6.699999999999655, 26.299999999999933, 44.5, -50.00000000000044, 39.90000000000002, 45.7, -50.00000000000044, 40.70000000000002, 38.90000000000002, -50.00000000000044, 46.5, 43.900000000000006, -50.00000000000044, -50.00000000000044, 43.7, 34.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.499999999999964, 36.70000000000003, 45.9, 40.70000000000002, 45.5, -50.00000000000044, 32.50000000000002, 43.7, -50.00000000000044, -50.00000000000044, 27.099999999999945, 45.7, 45.3, 36.30000000000003, -50.00000000000044, 41.100000000000016, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 39.50000000000002, -50.00000000000044, 32.30000000000002, -50.00000000000044, 45.7], "episode_lengths": [292, 204, 52, 146, 114, 32, 366, 100, 128, 500, 74, 74, 192, 94, 54, 500, 258, 170, 308, 290, 60, 418, 38, 312, 500, 328, 76, 44, 500, 500, 334, 120, 118, 500, 500, 500, 500, 60, 270, 98, 26, 46, 332, 500, 66, 500, 500, 34, 500, 112, 48, 304, 500, 500, 74, 180, 434, 238, 56, 500, 102, 44, 500, 94, 112, 500, 36, 62, 500, 500, 64, 158, 500, 500, 500, 216, 134, 42, 94, 46, 500, 176, 64, 500, 500, 230, 44, 48, 138, 500, 90, 500, 76, 500, 500, 106, 500, 178, 500, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3748439266069472, "mean_inference_ms": 1.2017721041907947, "mean_action_processing_ms": 0.1398532147592962, "mean_env_wait_ms": 0.08213099003638494, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025006771087646484, "StateBufferConnector_ms": 0.003999471664428711, "ViewRequirementAgentConnector_ms": 0.11417293548583984}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.495999999999837, "episode_len_mean": 255.72, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [20.899999999999856, 29.69999999999998, 44.900000000000006, 35.500000000000036, 38.700000000000024, 46.9, 13.499999999999751, 40.10000000000002, 37.300000000000026, -50.00000000000044, 42.70000000000001, 42.70000000000001, 30.9, 40.70000000000002, 44.7, -50.00000000000044, 24.299999999999905, 33.10000000000003, 19.299999999999834, 21.09999999999986, 44.10000000000001, 8.299999999999677, 46.3, 18.899999999999828, -50.00000000000044, 17.299999999999805, 42.500000000000014, 45.7, -50.00000000000044, -50.00000000000044, 16.699999999999797, 38.10000000000002, 38.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 23.099999999999888, 40.30000000000002, 47.5, 45.5, 16.8999999999998, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 38.90000000000002, 45.3, 19.69999999999984, -50.00000000000044, -50.00000000000044, 42.70000000000001, 32.100000000000016, 6.699999999999655, 26.299999999999933, 44.5, -50.00000000000044, 39.90000000000002, 45.7, -50.00000000000044, 40.70000000000002, 38.90000000000002, -50.00000000000044, 46.5, 43.900000000000006, -50.00000000000044, -50.00000000000044, 43.7, 34.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.499999999999964, 36.70000000000003, 45.9, 40.70000000000002, 45.5, -50.00000000000044, 32.50000000000002, 43.7, -50.00000000000044, -50.00000000000044, 27.099999999999945, 45.7, 45.3, 36.30000000000003, -50.00000000000044, 41.100000000000016, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 39.50000000000002, -50.00000000000044, 32.30000000000002, -50.00000000000044, 45.7], "episode_lengths": [292, 204, 52, 146, 114, 32, 366, 100, 128, 500, 74, 74, 192, 94, 54, 500, 258, 170, 308, 290, 60, 418, 38, 312, 500, 328, 76, 44, 500, 500, 334, 120, 118, 500, 500, 500, 500, 60, 270, 98, 26, 46, 332, 500, 66, 500, 500, 34, 500, 112, 48, 304, 500, 500, 74, 180, 434, 238, 56, 500, 102, 44, 500, 94, 112, 500, 36, 62, 500, 500, 64, 158, 500, 500, 500, 216, 134, 42, 94, 46, 500, 176, 64, 500, 500, 230, 44, 48, 138, 500, 90, 500, 76, 500, 500, 106, 500, 178, 500, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3748439266069472, "mean_inference_ms": 1.2017721041907947, "mean_action_processing_ms": 0.1398532147592962, "mean_env_wait_ms": 0.08213099003638494, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025006771087646484, "StateBufferConnector_ms": 0.003999471664428711, "ViewRequirementAgentConnector_ms": 0.11417293548583984}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5793.792852000625, "num_env_steps_trained_throughput_per_sec": 5793.792852000625, "timesteps_total": 396000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 396000, "timers": {"training_iteration_time_ms": 3163.029, "sample_time_ms": 2829.495, "load_time_ms": 18.398, "load_throughput": 978345.724, "learn_time_ms": 303.302, "learn_throughput": 59346.78, "synch_weights_time_ms": 9.533}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "done": false, "episodes_total": 1471, "training_iteration": 22, "trial_id": "9f288_00015", "date": "2023-10-25_16-47-51", "timestamp": 1698248871, "time_this_iter_s": 3.1117684841156006, "time_total_s": 70.01070070266724, "pid": 4200, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 70.01070070266724, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 63.25, "ram_util_percent": 27.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.768371582031251e-08, "cur_lr": 0.0003, "total_loss": 6.7547181129455565, "policy_loss": 0.02040102183818817, "vf_loss": 6.734369945526123, "vf_explained_var": -6.854534149169922e-07, "kl": 0.0007350584901075763, "entropy": 0.5302091002464294, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 450.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 414000, "num_env_steps_trained": 414000, "num_agent_steps_sampled": 414000, "num_agent_steps_trained": 414000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.644999999999833, "episode_len_mean": 249.2, "episode_media": {}, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [28.499999999999964, 36.70000000000003, 45.9, 40.70000000000002, 45.5, -50.00000000000044, 32.50000000000002, 43.7, -50.00000000000044, -50.00000000000044, 27.099999999999945, 45.7, 45.3, 36.30000000000003, -50.00000000000044, 41.100000000000016, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 39.50000000000002, -50.00000000000044, 32.30000000000002, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 40.30000000000002, 42.900000000000006, 44.5, 34.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 45.3, 45.7, 42.30000000000001, -50.00000000000044, 23.8999999999999, -50.00000000000044, -50.00000000000044, 44.300000000000004, 39.300000000000026, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 0.49999999999956657, 47.1, 5.899999999999643, 44.300000000000004, 44.900000000000006, -50.00000000000044, 18.499999999999822, -50.00000000000044, 46.099999999999994, 39.300000000000026, -50.00000000000044, 41.500000000000014, -50.00000000000044, 9.8999999999997, -50.00000000000044, 36.900000000000034, 42.70000000000001, 46.9, 43.30000000000001, -50.00000000000044, -50.00000000000044, 18.899999999999828, 40.70000000000002, 43.10000000000001, 43.900000000000006, -50.00000000000044, 43.30000000000001, 44.10000000000001, 44.300000000000004, 39.90000000000002, 45.5, 18.099999999999817, 42.70000000000001, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 38.50000000000003, 44.7, -50.00000000000044, 45.9, 44.300000000000004, 27.099999999999945, -50.00000000000044, 39.70000000000002, 36.900000000000034, 44.900000000000006, -50.00000000000044, 43.7, 44.7, 43.10000000000001], "episode_lengths": [216, 134, 42, 94, 46, 500, 176, 64, 500, 500, 230, 44, 48, 138, 500, 90, 500, 76, 500, 500, 106, 500, 178, 500, 44, 500, 500, 98, 72, 56, 152, 500, 500, 500, 62, 500, 48, 44, 78, 500, 262, 500, 500, 58, 108, 500, 34, 500, 500, 496, 30, 442, 58, 52, 500, 316, 500, 40, 108, 500, 86, 500, 402, 500, 132, 74, 32, 68, 500, 500, 312, 94, 70, 62, 500, 68, 60, 58, 102, 46, 320, 74, 500, 44, 500, 500, 116, 54, 500, 42, 58, 230, 500, 104, 132, 52, 500, 64, 54, 70]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.374849606080721, "mean_inference_ms": 1.2018836474932955, "mean_action_processing_ms": 0.14014858743366376, "mean_env_wait_ms": 0.08239231663278472, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027996063232421875, "StateBufferConnector_ms": 0.004001140594482422, "ViewRequirementAgentConnector_ms": 0.11901211738586426}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.644999999999833, "episode_len_mean": 249.2, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [28.499999999999964, 36.70000000000003, 45.9, 40.70000000000002, 45.5, -50.00000000000044, 32.50000000000002, 43.7, -50.00000000000044, -50.00000000000044, 27.099999999999945, 45.7, 45.3, 36.30000000000003, -50.00000000000044, 41.100000000000016, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 39.50000000000002, -50.00000000000044, 32.30000000000002, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 40.30000000000002, 42.900000000000006, 44.5, 34.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 45.3, 45.7, 42.30000000000001, -50.00000000000044, 23.8999999999999, -50.00000000000044, -50.00000000000044, 44.300000000000004, 39.300000000000026, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 0.49999999999956657, 47.1, 5.899999999999643, 44.300000000000004, 44.900000000000006, -50.00000000000044, 18.499999999999822, -50.00000000000044, 46.099999999999994, 39.300000000000026, -50.00000000000044, 41.500000000000014, -50.00000000000044, 9.8999999999997, -50.00000000000044, 36.900000000000034, 42.70000000000001, 46.9, 43.30000000000001, -50.00000000000044, -50.00000000000044, 18.899999999999828, 40.70000000000002, 43.10000000000001, 43.900000000000006, -50.00000000000044, 43.30000000000001, 44.10000000000001, 44.300000000000004, 39.90000000000002, 45.5, 18.099999999999817, 42.70000000000001, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 38.50000000000003, 44.7, -50.00000000000044, 45.9, 44.300000000000004, 27.099999999999945, -50.00000000000044, 39.70000000000002, 36.900000000000034, 44.900000000000006, -50.00000000000044, 43.7, 44.7, 43.10000000000001], "episode_lengths": [216, 134, 42, 94, 46, 500, 176, 64, 500, 500, 230, 44, 48, 138, 500, 90, 500, 76, 500, 500, 106, 500, 178, 500, 44, 500, 500, 98, 72, 56, 152, 500, 500, 500, 62, 500, 48, 44, 78, 500, 262, 500, 500, 58, 108, 500, 34, 500, 500, 496, 30, 442, 58, 52, 500, 316, 500, 40, 108, 500, 86, 500, 402, 500, 132, 74, 32, 68, 500, 500, 312, 94, 70, 62, 500, 68, 60, 58, 102, 46, 320, 74, 500, 44, 500, 500, 116, 54, 500, 42, 58, 230, 500, 104, 132, 52, 500, 64, 54, 70]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.374849606080721, "mean_inference_ms": 1.2018836474932955, "mean_action_processing_ms": 0.14014858743366376, "mean_env_wait_ms": 0.08239231663278472, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027996063232421875, "StateBufferConnector_ms": 0.004001140594482422, "ViewRequirementAgentConnector_ms": 0.11901211738586426}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 414000, "num_agent_steps_trained": 414000, "num_env_steps_sampled": 414000, "num_env_steps_trained": 414000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5752.514428246447, "num_env_steps_trained_throughput_per_sec": 5752.514428246447, "timesteps_total": 414000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 414000, "timers": {"training_iteration_time_ms": 3164.257, "sample_time_ms": 2825.314, "load_time_ms": 18.198, "load_throughput": 989099.522, "learn_time_ms": 308.493, "learn_throughput": 58348.151, "synch_weights_time_ms": 9.851}, "counters": {"num_env_steps_sampled": 414000, "num_env_steps_trained": 414000, "num_agent_steps_sampled": 414000, "num_agent_steps_trained": 414000}, "done": false, "episodes_total": 1546, "training_iteration": 23, "trial_id": "9f288_00015", "date": "2023-10-25_16-47-54", "timestamp": 1698248874, "time_this_iter_s": 3.1344265937805176, "time_total_s": 73.14512729644775, "pid": 4200, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 73.14512729644775, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 55.36, "ram_util_percent": 27.139999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.3841857910156255e-08, "cur_lr": 0.0003, "total_loss": 7.113149976730346, "policy_loss": 0.03357026614248752, "vf_loss": 7.079634785652161, "vf_explained_var": -1.5556812286376954e-06, "kl": 0.0008547195000375041, "entropy": 0.5500079184770584, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 470.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.51599999999986, "episode_len_mean": 225.54, "episode_media": {}, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.10000000000001, 44.300000000000004, 39.90000000000002, 45.5, 18.099999999999817, 42.70000000000001, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 38.50000000000003, 44.7, -50.00000000000044, 45.9, 44.300000000000004, 27.099999999999945, -50.00000000000044, 39.70000000000002, 36.900000000000034, 44.900000000000006, -50.00000000000044, 43.7, 44.7, 43.10000000000001, -50.00000000000044, -50.00000000000044, 44.10000000000001, 45.5, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 35.500000000000036, 46.699999999999996, 7.499999999999666, 38.300000000000026, -50.00000000000044, 46.699999999999996, -50.00000000000044, 39.50000000000002, 42.30000000000001, 41.500000000000014, 29.299999999999976, -50.00000000000044, 41.100000000000016, 42.30000000000001, 10.899999999999714, 41.90000000000001, 30.29999999999999, 43.7, -50.00000000000044, 45.1, 41.90000000000001, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 43.10000000000001, 45.7, -50.00000000000044, -50.00000000000044, 41.70000000000002, 15.299999999999777, 28.89999999999997, 39.90000000000002, 43.50000000000001, 38.700000000000024, 37.50000000000003, 41.30000000000001, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 37.300000000000026, 38.90000000000002, 41.100000000000016, 36.50000000000003, 43.50000000000001, -50.00000000000044, 46.099999999999994, 42.30000000000001, 46.5, 43.10000000000001, 41.70000000000002, -50.00000000000044, 44.300000000000004, 42.70000000000001, -50.00000000000044, 21.499999999999865, 21.299999999999862, 44.5, 33.90000000000004, 37.10000000000003], "episode_lengths": [60, 58, 102, 46, 320, 74, 500, 44, 500, 500, 116, 54, 500, 42, 58, 230, 500, 104, 132, 52, 500, 64, 54, 70, 500, 500, 60, 46, 500, 54, 500, 500, 56, 500, 146, 34, 426, 118, 500, 34, 500, 106, 78, 86, 208, 500, 90, 78, 392, 82, 198, 64, 500, 50, 82, 500, 30, 500, 500, 60, 500, 70, 44, 500, 500, 84, 348, 212, 102, 66, 114, 126, 88, 500, 88, 500, 500, 60, 500, 500, 128, 112, 90, 136, 66, 500, 40, 78, 36, 70, 84, 500, 58, 74, 500, 286, 288, 56, 162, 130]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3756127556693604, "mean_inference_ms": 1.2032689188967474, "mean_action_processing_ms": 0.1400287971980945, "mean_env_wait_ms": 0.08284447358361316, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027998685836791992, "StateBufferConnector_ms": 0.0020003318786621094, "ViewRequirementAgentConnector_ms": 0.12780404090881348}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.51599999999986, "episode_len_mean": 225.54, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.10000000000001, 44.300000000000004, 39.90000000000002, 45.5, 18.099999999999817, 42.70000000000001, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 38.50000000000003, 44.7, -50.00000000000044, 45.9, 44.300000000000004, 27.099999999999945, -50.00000000000044, 39.70000000000002, 36.900000000000034, 44.900000000000006, -50.00000000000044, 43.7, 44.7, 43.10000000000001, -50.00000000000044, -50.00000000000044, 44.10000000000001, 45.5, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 35.500000000000036, 46.699999999999996, 7.499999999999666, 38.300000000000026, -50.00000000000044, 46.699999999999996, -50.00000000000044, 39.50000000000002, 42.30000000000001, 41.500000000000014, 29.299999999999976, -50.00000000000044, 41.100000000000016, 42.30000000000001, 10.899999999999714, 41.90000000000001, 30.29999999999999, 43.7, -50.00000000000044, 45.1, 41.90000000000001, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 43.10000000000001, 45.7, -50.00000000000044, -50.00000000000044, 41.70000000000002, 15.299999999999777, 28.89999999999997, 39.90000000000002, 43.50000000000001, 38.700000000000024, 37.50000000000003, 41.30000000000001, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 37.300000000000026, 38.90000000000002, 41.100000000000016, 36.50000000000003, 43.50000000000001, -50.00000000000044, 46.099999999999994, 42.30000000000001, 46.5, 43.10000000000001, 41.70000000000002, -50.00000000000044, 44.300000000000004, 42.70000000000001, -50.00000000000044, 21.499999999999865, 21.299999999999862, 44.5, 33.90000000000004, 37.10000000000003], "episode_lengths": [60, 58, 102, 46, 320, 74, 500, 44, 500, 500, 116, 54, 500, 42, 58, 230, 500, 104, 132, 52, 500, 64, 54, 70, 500, 500, 60, 46, 500, 54, 500, 500, 56, 500, 146, 34, 426, 118, 500, 34, 500, 106, 78, 86, 208, 500, 90, 78, 392, 82, 198, 64, 500, 50, 82, 500, 30, 500, 500, 60, 500, 70, 44, 500, 500, 84, 348, 212, 102, 66, 114, 126, 88, 500, 88, 500, 500, 60, 500, 500, 128, 112, 90, 136, 66, 500, 40, 78, 36, 70, 84, 500, 58, 74, 500, 286, 288, 56, 162, 130]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3756127556693604, "mean_inference_ms": 1.2032689188967474, "mean_action_processing_ms": 0.1400287971980945, "mean_env_wait_ms": 0.08284447358361316, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027998685836791992, "StateBufferConnector_ms": 0.0020003318786621094, "ViewRequirementAgentConnector_ms": 0.12780404090881348}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4762.070297071045, "num_env_steps_trained_throughput_per_sec": 4762.070297071045, "timesteps_total": 432000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 432000, "timers": {"training_iteration_time_ms": 3226.969, "sample_time_ms": 2843.147, "load_time_ms": 18.958, "load_throughput": 949442.351, "learn_time_ms": 322.432, "learn_throughput": 55825.713, "synch_weights_time_ms": 39.927}, "counters": {"num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "done": false, "episodes_total": 1622, "training_iteration": 24, "trial_id": "9f288_00015", "date": "2023-10-25_16-47-58", "timestamp": 1698248878, "time_this_iter_s": 3.785818338394165, "time_total_s": 76.93094563484192, "pid": 4200, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 76.93094563484192, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 62.519999999999996, "ram_util_percent": 27.18}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1920928955078127e-08, "cur_lr": 0.0003, "total_loss": 6.644952416419983, "policy_loss": -0.01942154811695218, "vf_loss": 6.664425110816955, "vf_explained_var": -2.3752450942993165e-06, "kl": 0.0012064656249101801, "entropy": 0.5124944522976875, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 490.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 450000, "num_env_steps_trained": 450000, "num_agent_steps_sampled": 450000, "num_agent_steps_trained": 450000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.205999999999847, "episode_len_mean": 238.62, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [38.700000000000024, 37.50000000000003, 41.30000000000001, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 37.300000000000026, 38.90000000000002, 41.100000000000016, 36.50000000000003, 43.50000000000001, -50.00000000000044, 46.099999999999994, 42.30000000000001, 46.5, 43.10000000000001, 41.70000000000002, -50.00000000000044, 44.300000000000004, 42.70000000000001, -50.00000000000044, 21.499999999999865, 21.299999999999862, 44.5, 33.90000000000004, 37.10000000000003, -50.00000000000044, -50.00000000000044, 47.5, 42.500000000000014, 41.90000000000001, -50.00000000000044, 43.900000000000006, 11.099999999999717, 45.1, -50.00000000000044, 25.899999999999928, 44.300000000000004, 41.30000000000001, 35.30000000000004, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.50000000000004, -50.00000000000044, 45.9, 23.699999999999896, 32.30000000000002, 35.30000000000004, -50.00000000000044, 45.9, -50.00000000000044, 46.9, 46.3, 44.5, -50.00000000000044, 47.1, 38.50000000000003, 44.5, 44.900000000000006, 44.10000000000001, 42.10000000000001, -50.00000000000044, 44.300000000000004, 44.10000000000001, -50.00000000000044, 44.7, 16.8999999999998, 45.9, -50.00000000000044, 47.5, 7.09999999999966, -50.00000000000044, 44.300000000000004, 32.30000000000002, -50.00000000000044, 31.1, 45.7, -50.00000000000044, 36.900000000000034, 46.5, 36.10000000000004, 41.500000000000014, -50.00000000000044, -50.00000000000044, 46.099999999999994, 39.50000000000002, -50.00000000000044, 43.900000000000006, 12.499999999999737, 10.899999999999714, -50.00000000000044, -50.00000000000044], "episode_lengths": [114, 126, 88, 500, 88, 500, 500, 60, 500, 500, 128, 112, 90, 136, 66, 500, 40, 78, 36, 70, 84, 500, 58, 74, 500, 286, 288, 56, 162, 130, 500, 500, 26, 76, 82, 500, 62, 390, 50, 500, 242, 58, 88, 148, 500, 500, 78, 500, 500, 500, 156, 500, 42, 264, 178, 148, 500, 42, 500, 32, 38, 56, 500, 30, 116, 56, 52, 60, 80, 500, 58, 60, 500, 54, 332, 42, 500, 26, 430, 500, 58, 178, 500, 190, 44, 500, 132, 36, 140, 86, 500, 500, 40, 106, 500, 62, 376, 392, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37584443510218307, "mean_inference_ms": 1.2050773187137904, "mean_action_processing_ms": 0.14043409882179517, "mean_env_wait_ms": 0.08258868407685693, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025001049041748047, "StateBufferConnector_ms": 0.004599571228027344, "ViewRequirementAgentConnector_ms": 0.14803266525268555}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.205999999999847, "episode_len_mean": 238.62, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [38.700000000000024, 37.50000000000003, 41.30000000000001, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 37.300000000000026, 38.90000000000002, 41.100000000000016, 36.50000000000003, 43.50000000000001, -50.00000000000044, 46.099999999999994, 42.30000000000001, 46.5, 43.10000000000001, 41.70000000000002, -50.00000000000044, 44.300000000000004, 42.70000000000001, -50.00000000000044, 21.499999999999865, 21.299999999999862, 44.5, 33.90000000000004, 37.10000000000003, -50.00000000000044, -50.00000000000044, 47.5, 42.500000000000014, 41.90000000000001, -50.00000000000044, 43.900000000000006, 11.099999999999717, 45.1, -50.00000000000044, 25.899999999999928, 44.300000000000004, 41.30000000000001, 35.30000000000004, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.50000000000004, -50.00000000000044, 45.9, 23.699999999999896, 32.30000000000002, 35.30000000000004, -50.00000000000044, 45.9, -50.00000000000044, 46.9, 46.3, 44.5, -50.00000000000044, 47.1, 38.50000000000003, 44.5, 44.900000000000006, 44.10000000000001, 42.10000000000001, -50.00000000000044, 44.300000000000004, 44.10000000000001, -50.00000000000044, 44.7, 16.8999999999998, 45.9, -50.00000000000044, 47.5, 7.09999999999966, -50.00000000000044, 44.300000000000004, 32.30000000000002, -50.00000000000044, 31.1, 45.7, -50.00000000000044, 36.900000000000034, 46.5, 36.10000000000004, 41.500000000000014, -50.00000000000044, -50.00000000000044, 46.099999999999994, 39.50000000000002, -50.00000000000044, 43.900000000000006, 12.499999999999737, 10.899999999999714, -50.00000000000044, -50.00000000000044], "episode_lengths": [114, 126, 88, 500, 88, 500, 500, 60, 500, 500, 128, 112, 90, 136, 66, 500, 40, 78, 36, 70, 84, 500, 58, 74, 500, 286, 288, 56, 162, 130, 500, 500, 26, 76, 82, 500, 62, 390, 50, 500, 242, 58, 88, 148, 500, 500, 78, 500, 500, 500, 156, 500, 42, 264, 178, 148, 500, 42, 500, 32, 38, 56, 500, 30, 116, 56, 52, 60, 80, 500, 58, 60, 500, 54, 332, 42, 500, 26, 430, 500, 58, 178, 500, 190, 44, 500, 132, 36, 140, 86, 500, 500, 40, 106, 500, 62, 376, 392, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37584443510218307, "mean_inference_ms": 1.2050773187137904, "mean_action_processing_ms": 0.14043409882179517, "mean_env_wait_ms": 0.08258868407685693, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025001049041748047, "StateBufferConnector_ms": 0.004599571228027344, "ViewRequirementAgentConnector_ms": 0.14803266525268555}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 450000, "num_agent_steps_trained": 450000, "num_env_steps_sampled": 450000, "num_env_steps_trained": 450000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5427.508381827289, "num_env_steps_trained_throughput_per_sec": 5427.508381827289, "timesteps_total": 450000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 450000, "timers": {"training_iteration_time_ms": 3238.741, "sample_time_ms": 2859.668, "load_time_ms": 18.258, "load_throughput": 985847.354, "learn_time_ms": 318.409, "learn_throughput": 56531.135, "synch_weights_time_ms": 39.701}, "counters": {"num_env_steps_sampled": 450000, "num_env_steps_trained": 450000, "num_agent_steps_sampled": 450000, "num_agent_steps_trained": 450000}, "done": false, "episodes_total": 1692, "training_iteration": 25, "trial_id": "9f288_00015", "date": "2023-10-25_16-48-01", "timestamp": 1698248881, "time_this_iter_s": 3.3214385509490967, "time_total_s": 80.25238418579102, "pid": 4200, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 80.25238418579102, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 61.32000000000001, "ram_util_percent": 27.22}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.960464477539064e-09, "cur_lr": 0.0003, "total_loss": 6.987955093383789, "policy_loss": -0.03656777068972587, "vf_loss": 7.02457628250122, "vf_explained_var": -2.0563602447509766e-06, "kl": 0.0007877446730731208, "entropy": 0.5354222610592843, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 510.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.722999999999817, "episode_len_mean": 268.42, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [38.50000000000003, 44.5, 44.900000000000006, 44.10000000000001, 42.10000000000001, -50.00000000000044, 44.300000000000004, 44.10000000000001, -50.00000000000044, 44.7, 16.8999999999998, 45.9, -50.00000000000044, 47.5, 7.09999999999966, -50.00000000000044, 44.300000000000004, 32.30000000000002, -50.00000000000044, 31.1, 45.7, -50.00000000000044, 36.900000000000034, 46.5, 36.10000000000004, 41.500000000000014, -50.00000000000044, -50.00000000000044, 46.099999999999994, 39.50000000000002, -50.00000000000044, 43.900000000000006, 12.499999999999737, 10.899999999999714, -50.00000000000044, -50.00000000000044, -50.00000000000044, 8.899999999999686, 41.30000000000001, 15.899999999999785, 25.499999999999922, -50.00000000000044, -50.00000000000044, 15.099999999999774, 40.30000000000002, 17.499999999999808, 32.100000000000016, 42.30000000000001, 41.100000000000016, 28.499999999999964, 40.70000000000002, 41.500000000000014, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 43.50000000000001, 41.70000000000002, -50.00000000000044, 45.7, -50.00000000000044, 6.299999999999649, 40.30000000000002, 44.10000000000001, -50.00000000000044, 31.500000000000007, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, 38.300000000000026, -50.00000000000044, 37.90000000000003, 42.10000000000001, 26.89999999999994, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 3.499999999999609, 20.899999999999856, 47.3, 46.5, 9.299999999999692, 37.90000000000003, 39.10000000000002, 46.5, -50.00000000000044, 42.70000000000001, 43.10000000000001, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044], "episode_lengths": [116, 56, 52, 60, 80, 500, 58, 60, 500, 54, 332, 42, 500, 26, 430, 500, 58, 178, 500, 190, 44, 500, 132, 36, 140, 86, 500, 500, 40, 106, 500, 62, 376, 392, 500, 500, 500, 412, 88, 342, 246, 500, 500, 350, 98, 326, 180, 78, 90, 216, 94, 86, 78, 500, 500, 500, 36, 66, 84, 500, 44, 500, 438, 98, 60, 500, 186, 500, 500, 40, 500, 500, 102, 500, 118, 500, 122, 80, 232, 72, 500, 500, 500, 500, 500, 466, 292, 28, 36, 408, 122, 110, 36, 500, 74, 70, 500, 32, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3770528072768866, "mean_inference_ms": 1.2063571443786278, "mean_action_processing_ms": 0.14045980653099618, "mean_env_wait_ms": 0.08264237938930086, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024001359939575195, "StateBufferConnector_ms": 0.0075969696044921875, "ViewRequirementAgentConnector_ms": 0.1338517665863037}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.722999999999817, "episode_len_mean": 268.42, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [38.50000000000003, 44.5, 44.900000000000006, 44.10000000000001, 42.10000000000001, -50.00000000000044, 44.300000000000004, 44.10000000000001, -50.00000000000044, 44.7, 16.8999999999998, 45.9, -50.00000000000044, 47.5, 7.09999999999966, -50.00000000000044, 44.300000000000004, 32.30000000000002, -50.00000000000044, 31.1, 45.7, -50.00000000000044, 36.900000000000034, 46.5, 36.10000000000004, 41.500000000000014, -50.00000000000044, -50.00000000000044, 46.099999999999994, 39.50000000000002, -50.00000000000044, 43.900000000000006, 12.499999999999737, 10.899999999999714, -50.00000000000044, -50.00000000000044, -50.00000000000044, 8.899999999999686, 41.30000000000001, 15.899999999999785, 25.499999999999922, -50.00000000000044, -50.00000000000044, 15.099999999999774, 40.30000000000002, 17.499999999999808, 32.100000000000016, 42.30000000000001, 41.100000000000016, 28.499999999999964, 40.70000000000002, 41.500000000000014, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 43.50000000000001, 41.70000000000002, -50.00000000000044, 45.7, -50.00000000000044, 6.299999999999649, 40.30000000000002, 44.10000000000001, -50.00000000000044, 31.500000000000007, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, 38.300000000000026, -50.00000000000044, 37.90000000000003, 42.10000000000001, 26.89999999999994, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 3.499999999999609, 20.899999999999856, 47.3, 46.5, 9.299999999999692, 37.90000000000003, 39.10000000000002, 46.5, -50.00000000000044, 42.70000000000001, 43.10000000000001, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044], "episode_lengths": [116, 56, 52, 60, 80, 500, 58, 60, 500, 54, 332, 42, 500, 26, 430, 500, 58, 178, 500, 190, 44, 500, 132, 36, 140, 86, 500, 500, 40, 106, 500, 62, 376, 392, 500, 500, 500, 412, 88, 342, 246, 500, 500, 350, 98, 326, 180, 78, 90, 216, 94, 86, 78, 500, 500, 500, 36, 66, 84, 500, 44, 500, 438, 98, 60, 500, 186, 500, 500, 40, 500, 500, 102, 500, 118, 500, 122, 80, 232, 72, 500, 500, 500, 500, 500, 466, 292, 28, 36, 408, 122, 110, 36, 500, 74, 70, 500, 32, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3770528072768866, "mean_inference_ms": 1.2063571443786278, "mean_action_processing_ms": 0.14045980653099618, "mean_env_wait_ms": 0.08264237938930086, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024001359939575195, "StateBufferConnector_ms": 0.0075969696044921875, "ViewRequirementAgentConnector_ms": 0.1338517665863037}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5417.611126638927, "num_env_steps_trained_throughput_per_sec": 5417.611126638927, "timesteps_total": 468000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 468000, "timers": {"training_iteration_time_ms": 3250.555, "sample_time_ms": 2877.544, "load_time_ms": 18.285, "load_throughput": 984439.75, "learn_time_ms": 312.321, "learn_throughput": 57633.07, "synch_weights_time_ms": 39.7}, "counters": {"num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000}, "done": false, "episodes_total": 1756, "training_iteration": 26, "trial_id": "9f288_00015", "date": "2023-10-25_16-48-05", "timestamp": 1698248885, "time_this_iter_s": 3.3274953365325928, "time_total_s": 83.57987952232361, "pid": 4200, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 83.57987952232361, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 72.0, "ram_util_percent": 27.225}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.980232238769532e-09, "cur_lr": 0.0003, "total_loss": 7.187116932868958, "policy_loss": -0.05519158467650413, "vf_loss": 7.242363500595093, "vf_explained_var": 7.450580596923828e-07, "kl": 8.21276166050211e-05, "entropy": 0.5499208480119705, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 530.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 486000, "num_env_steps_trained": 486000, "num_agent_steps_sampled": 486000, "num_agent_steps_trained": 486000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.58499999999984, "episode_len_mean": 249.82, "episode_media": {}, "episodes_this_iter": 80, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 3.499999999999609, 20.899999999999856, 47.3, 46.5, 9.299999999999692, 37.90000000000003, 39.10000000000002, 46.5, -50.00000000000044, 42.70000000000001, 43.10000000000001, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 43.10000000000001, -50.00000000000044, 31.1, 35.30000000000004, 29.899999999999984, -50.00000000000044, 43.50000000000001, -50.00000000000044, 34.50000000000004, 44.5, 46.699999999999996, 42.500000000000014, -50.00000000000044, -50.00000000000044, 37.50000000000003, 42.10000000000001, 38.10000000000002, 43.7, 30.099999999999987, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, -50.00000000000044, 44.5, 21.89999999999987, 43.10000000000001, 29.299999999999976, -50.00000000000044, 41.30000000000001, 42.900000000000006, -50.00000000000044, -50.00000000000044, 44.5, 44.7, 35.70000000000003, 45.9, -50.00000000000044, 45.1, 41.70000000000002, 26.499999999999936, 40.90000000000002, -50.00000000000044, -50.00000000000044, 27.49999999999995, 44.7, 29.899999999999984, 46.3, 29.69999999999998, -50.00000000000044, 39.300000000000026, 44.7, 14.699999999999768, -50.00000000000044, 42.900000000000006, -50.00000000000044, 44.300000000000004, 38.50000000000003, 39.50000000000002, 32.90000000000003, 45.5, 40.90000000000002, -50.00000000000044, 3.699999999999612, 38.50000000000003, 41.70000000000002, 11.899999999999729, 41.70000000000002, 44.5, 40.500000000000014, 34.30000000000004, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 42.70000000000001, -50.00000000000044, 47.1], "episode_lengths": [500, 500, 500, 500, 500, 466, 292, 28, 36, 408, 122, 110, 36, 500, 74, 70, 500, 32, 500, 500, 500, 44, 70, 500, 190, 148, 202, 500, 66, 500, 156, 56, 34, 76, 500, 500, 126, 80, 120, 64, 200, 500, 500, 130, 500, 500, 56, 282, 70, 208, 500, 88, 72, 500, 500, 56, 54, 144, 42, 500, 50, 84, 236, 92, 500, 500, 226, 54, 202, 38, 204, 500, 108, 54, 354, 500, 72, 500, 58, 116, 106, 172, 46, 92, 500, 464, 116, 84, 382, 84, 56, 96, 158, 500, 500, 66, 500, 74, 500, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3776926370871027, "mean_inference_ms": 1.2094649147428778, "mean_action_processing_ms": 0.14093323523155651, "mean_env_wait_ms": 0.08287998494070878, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02100348472595215, "StateBufferConnector_ms": 0.014998674392700195, "ViewRequirementAgentConnector_ms": 0.13787841796875}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.58499999999984, "episode_len_mean": 249.82, "episodes_this_iter": 80, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 3.499999999999609, 20.899999999999856, 47.3, 46.5, 9.299999999999692, 37.90000000000003, 39.10000000000002, 46.5, -50.00000000000044, 42.70000000000001, 43.10000000000001, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 43.10000000000001, -50.00000000000044, 31.1, 35.30000000000004, 29.899999999999984, -50.00000000000044, 43.50000000000001, -50.00000000000044, 34.50000000000004, 44.5, 46.699999999999996, 42.500000000000014, -50.00000000000044, -50.00000000000044, 37.50000000000003, 42.10000000000001, 38.10000000000002, 43.7, 30.099999999999987, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, -50.00000000000044, 44.5, 21.89999999999987, 43.10000000000001, 29.299999999999976, -50.00000000000044, 41.30000000000001, 42.900000000000006, -50.00000000000044, -50.00000000000044, 44.5, 44.7, 35.70000000000003, 45.9, -50.00000000000044, 45.1, 41.70000000000002, 26.499999999999936, 40.90000000000002, -50.00000000000044, -50.00000000000044, 27.49999999999995, 44.7, 29.899999999999984, 46.3, 29.69999999999998, -50.00000000000044, 39.300000000000026, 44.7, 14.699999999999768, -50.00000000000044, 42.900000000000006, -50.00000000000044, 44.300000000000004, 38.50000000000003, 39.50000000000002, 32.90000000000003, 45.5, 40.90000000000002, -50.00000000000044, 3.699999999999612, 38.50000000000003, 41.70000000000002, 11.899999999999729, 41.70000000000002, 44.5, 40.500000000000014, 34.30000000000004, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 42.70000000000001, -50.00000000000044, 47.1], "episode_lengths": [500, 500, 500, 500, 500, 466, 292, 28, 36, 408, 122, 110, 36, 500, 74, 70, 500, 32, 500, 500, 500, 44, 70, 500, 190, 148, 202, 500, 66, 500, 156, 56, 34, 76, 500, 500, 126, 80, 120, 64, 200, 500, 500, 130, 500, 500, 56, 282, 70, 208, 500, 88, 72, 500, 500, 56, 54, 144, 42, 500, 50, 84, 236, 92, 500, 500, 226, 54, 202, 38, 204, 500, 108, 54, 354, 500, 72, 500, 58, 116, 106, 172, 46, 92, 500, 464, 116, 84, 382, 84, 56, 96, 158, 500, 500, 66, 500, 74, 500, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3776926370871027, "mean_inference_ms": 1.2094649147428778, "mean_action_processing_ms": 0.14093323523155651, "mean_env_wait_ms": 0.08287998494070878, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02100348472595215, "StateBufferConnector_ms": 0.014998674392700195, "ViewRequirementAgentConnector_ms": 0.13787841796875}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 486000, "num_agent_steps_trained": 486000, "num_env_steps_sampled": 486000, "num_env_steps_trained": 486000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5471.646103821982, "num_env_steps_trained_throughput_per_sec": 5471.646103821982, "timesteps_total": 486000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 486000, "timers": {"training_iteration_time_ms": 3253.108, "sample_time_ms": 2883.522, "load_time_ms": 17.771, "load_throughput": 1012913.021, "learn_time_ms": 309.674, "learn_throughput": 58125.713, "synch_weights_time_ms": 39.419}, "counters": {"num_env_steps_sampled": 486000, "num_env_steps_trained": 486000, "num_agent_steps_sampled": 486000, "num_agent_steps_trained": 486000}, "done": false, "episodes_total": 1836, "training_iteration": 27, "trial_id": "9f288_00015", "date": "2023-10-25_16-48-08", "timestamp": 1698248888, "time_this_iter_s": 3.296679735183716, "time_total_s": 86.87655925750732, "pid": 4200, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 86.87655925750732, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 62.8, "ram_util_percent": 27.26}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.490116119384766e-09, "cur_lr": 0.0003, "total_loss": 6.742675256729126, "policy_loss": 0.024649563571438195, "vf_loss": 6.718074607849121, "vf_explained_var": -6.556510925292969e-08, "kl": 0.0009560368591021273, "entropy": 0.48900843411684036, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 550.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.34999999999985, "episode_len_mean": 237.2, "episode_media": {}, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.7, 14.699999999999768, -50.00000000000044, 42.900000000000006, -50.00000000000044, 44.300000000000004, 38.50000000000003, 39.50000000000002, 32.90000000000003, 45.5, 40.90000000000002, -50.00000000000044, 3.699999999999612, 38.50000000000003, 41.70000000000002, 11.899999999999729, 41.70000000000002, 44.5, 40.500000000000014, 34.30000000000004, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 42.70000000000001, -50.00000000000044, 47.1, -50.00000000000044, 45.1, -50.00000000000044, 39.300000000000026, 46.5, 42.30000000000001, 39.10000000000002, 43.7, 42.30000000000001, 44.7, 43.7, 40.500000000000014, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 45.3, 38.90000000000002, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002, -50.00000000000044, -50.00000000000044, 27.699999999999953, 38.300000000000026, -50.00000000000044, 44.5, 43.7, -50.00000000000044, 37.50000000000003, 38.300000000000026, 30.699999999999996, 45.1, 45.3, -50.00000000000044, 45.7, 44.10000000000001, 37.10000000000003, 37.50000000000003, -50.00000000000044, -50.00000000000044, 16.8999999999998, 43.10000000000001, -50.00000000000044, 2.8999999999996007, 14.699999999999768, 39.300000000000026, -50.00000000000044, 38.700000000000024, 42.10000000000001, 36.70000000000003, 45.5, 46.5, 7.699999999999669, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, 44.900000000000006, -50.00000000000044, 47.5, 42.10000000000001, 44.7, -50.00000000000044, -50.00000000000044, 28.29999999999996, 7.899999999999672, 19.499999999999837, 44.5, 44.900000000000006, 45.1], "episode_lengths": [54, 354, 500, 72, 500, 58, 116, 106, 172, 46, 92, 500, 464, 116, 84, 382, 84, 56, 96, 158, 500, 500, 66, 500, 74, 500, 30, 500, 50, 500, 108, 36, 78, 110, 64, 78, 54, 64, 96, 500, 56, 500, 500, 48, 112, 42, 500, 500, 500, 106, 500, 500, 224, 118, 500, 56, 64, 500, 126, 118, 194, 50, 48, 500, 44, 60, 130, 126, 500, 500, 332, 70, 500, 472, 354, 108, 500, 114, 80, 134, 46, 36, 424, 500, 500, 500, 94, 52, 500, 26, 80, 54, 500, 500, 218, 422, 306, 56, 52, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3775156596827077, "mean_inference_ms": 1.2108493449884659, "mean_action_processing_ms": 0.14082352375670953, "mean_env_wait_ms": 0.08280379890701978, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017011165618896484, "StateBufferConnector_ms": 0.00699615478515625, "ViewRequirementAgentConnector_ms": 0.12824010848999023}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.34999999999985, "episode_len_mean": 237.2, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.7, 14.699999999999768, -50.00000000000044, 42.900000000000006, -50.00000000000044, 44.300000000000004, 38.50000000000003, 39.50000000000002, 32.90000000000003, 45.5, 40.90000000000002, -50.00000000000044, 3.699999999999612, 38.50000000000003, 41.70000000000002, 11.899999999999729, 41.70000000000002, 44.5, 40.500000000000014, 34.30000000000004, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 42.70000000000001, -50.00000000000044, 47.1, -50.00000000000044, 45.1, -50.00000000000044, 39.300000000000026, 46.5, 42.30000000000001, 39.10000000000002, 43.7, 42.30000000000001, 44.7, 43.7, 40.500000000000014, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 45.3, 38.90000000000002, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002, -50.00000000000044, -50.00000000000044, 27.699999999999953, 38.300000000000026, -50.00000000000044, 44.5, 43.7, -50.00000000000044, 37.50000000000003, 38.300000000000026, 30.699999999999996, 45.1, 45.3, -50.00000000000044, 45.7, 44.10000000000001, 37.10000000000003, 37.50000000000003, -50.00000000000044, -50.00000000000044, 16.8999999999998, 43.10000000000001, -50.00000000000044, 2.8999999999996007, 14.699999999999768, 39.300000000000026, -50.00000000000044, 38.700000000000024, 42.10000000000001, 36.70000000000003, 45.5, 46.5, 7.699999999999669, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, 44.900000000000006, -50.00000000000044, 47.5, 42.10000000000001, 44.7, -50.00000000000044, -50.00000000000044, 28.29999999999996, 7.899999999999672, 19.499999999999837, 44.5, 44.900000000000006, 45.1], "episode_lengths": [54, 354, 500, 72, 500, 58, 116, 106, 172, 46, 92, 500, 464, 116, 84, 382, 84, 56, 96, 158, 500, 500, 66, 500, 74, 500, 30, 500, 50, 500, 108, 36, 78, 110, 64, 78, 54, 64, 96, 500, 56, 500, 500, 48, 112, 42, 500, 500, 500, 106, 500, 500, 224, 118, 500, 56, 64, 500, 126, 118, 194, 50, 48, 500, 44, 60, 130, 126, 500, 500, 332, 70, 500, 472, 354, 108, 500, 114, 80, 134, 46, 36, 424, 500, 500, 500, 94, 52, 500, 26, 80, 54, 500, 500, 218, 422, 306, 56, 52, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3775156596827077, "mean_inference_ms": 1.2108493449884659, "mean_action_processing_ms": 0.14082352375670953, "mean_env_wait_ms": 0.08280379890701978, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017011165618896484, "StateBufferConnector_ms": 0.00699615478515625, "ViewRequirementAgentConnector_ms": 0.12824010848999023}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5659.126009794289, "num_env_steps_trained_throughput_per_sec": 5659.126009794289, "timesteps_total": 504000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 504000, "timers": {"training_iteration_time_ms": 3262.459, "sample_time_ms": 2883.633, "load_time_ms": 17.498, "load_throughput": 1028669.81, "learn_time_ms": 319.273, "learn_throughput": 56378.131, "synch_weights_time_ms": 39.431}, "counters": {"num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000}, "done": false, "episodes_total": 1909, "training_iteration": 28, "trial_id": "9f288_00015", "date": "2023-10-25_16-48-11", "timestamp": 1698248891, "time_this_iter_s": 3.185703992843628, "time_total_s": 90.06226325035095, "pid": 4200, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 90.06226325035095, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 62.199999999999996, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.45058059692383e-10, "cur_lr": 0.0003, "total_loss": 6.293455982208252, "policy_loss": -0.05455639287829399, "vf_loss": 6.348060917854309, "vf_explained_var": -7.122755050659179e-07, "kl": 0.00014278042167461535, "entropy": 0.4861874982714653, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 570.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 522000, "num_env_steps_trained": 522000, "num_agent_steps_sampled": 522000, "num_agent_steps_trained": 522000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.759999999999821, "episode_len_mean": 263.04, "episode_media": {}, "episodes_this_iter": 58, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [37.50000000000003, 38.300000000000026, 30.699999999999996, 45.1, 45.3, -50.00000000000044, 45.7, 44.10000000000001, 37.10000000000003, 37.50000000000003, -50.00000000000044, -50.00000000000044, 16.8999999999998, 43.10000000000001, -50.00000000000044, 2.8999999999996007, 14.699999999999768, 39.300000000000026, -50.00000000000044, 38.700000000000024, 42.10000000000001, 36.70000000000003, 45.5, 46.5, 7.699999999999669, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, 44.900000000000006, -50.00000000000044, 47.5, 42.10000000000001, 44.7, -50.00000000000044, -50.00000000000044, 28.29999999999996, 7.899999999999672, 19.499999999999837, 44.5, 44.900000000000006, 45.1, 37.10000000000003, 41.500000000000014, 29.899999999999984, -50.00000000000044, 38.50000000000003, 43.7, 40.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, 42.500000000000014, 34.10000000000004, 44.900000000000006, -50.00000000000044, -50.00000000000044, 37.50000000000003, 45.1, 45.1, -50.00000000000044, -50.00000000000044, 28.29999999999996, -50.00000000000044, -50.00000000000044, 37.70000000000003, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 43.10000000000001, 37.70000000000003, 47.1, 36.10000000000004, 43.30000000000001, 42.500000000000014, -50.00000000000044, 25.099999999999916, -50.00000000000044, 45.1, -50.00000000000044, 34.10000000000004, 18.699999999999825, 46.099999999999994, 45.1, -50.00000000000044, 40.90000000000002, 46.3, 2.299999999999592, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [126, 118, 194, 50, 48, 500, 44, 60, 130, 126, 500, 500, 332, 70, 500, 472, 354, 108, 500, 114, 80, 134, 46, 36, 424, 500, 500, 500, 94, 52, 500, 26, 80, 54, 500, 500, 218, 422, 306, 56, 52, 50, 130, 86, 202, 500, 116, 64, 98, 500, 500, 500, 96, 500, 500, 76, 160, 52, 500, 500, 126, 50, 50, 500, 500, 218, 500, 500, 124, 500, 84, 500, 500, 62, 500, 70, 124, 30, 140, 68, 76, 500, 250, 500, 50, 500, 160, 314, 40, 50, 500, 92, 38, 478, 54, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37776329799157726, "mean_inference_ms": 1.208865031888599, "mean_action_processing_ms": 0.14081292371641585, "mean_env_wait_ms": 0.08256096314663537, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02400970458984375, "StateBufferConnector_ms": 0.005997180938720703, "ViewRequirementAgentConnector_ms": 0.11453008651733398}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.759999999999821, "episode_len_mean": 263.04, "episodes_this_iter": 58, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [37.50000000000003, 38.300000000000026, 30.699999999999996, 45.1, 45.3, -50.00000000000044, 45.7, 44.10000000000001, 37.10000000000003, 37.50000000000003, -50.00000000000044, -50.00000000000044, 16.8999999999998, 43.10000000000001, -50.00000000000044, 2.8999999999996007, 14.699999999999768, 39.300000000000026, -50.00000000000044, 38.700000000000024, 42.10000000000001, 36.70000000000003, 45.5, 46.5, 7.699999999999669, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, 44.900000000000006, -50.00000000000044, 47.5, 42.10000000000001, 44.7, -50.00000000000044, -50.00000000000044, 28.29999999999996, 7.899999999999672, 19.499999999999837, 44.5, 44.900000000000006, 45.1, 37.10000000000003, 41.500000000000014, 29.899999999999984, -50.00000000000044, 38.50000000000003, 43.7, 40.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, 42.500000000000014, 34.10000000000004, 44.900000000000006, -50.00000000000044, -50.00000000000044, 37.50000000000003, 45.1, 45.1, -50.00000000000044, -50.00000000000044, 28.29999999999996, -50.00000000000044, -50.00000000000044, 37.70000000000003, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 43.10000000000001, 37.70000000000003, 47.1, 36.10000000000004, 43.30000000000001, 42.500000000000014, -50.00000000000044, 25.099999999999916, -50.00000000000044, 45.1, -50.00000000000044, 34.10000000000004, 18.699999999999825, 46.099999999999994, 45.1, -50.00000000000044, 40.90000000000002, 46.3, 2.299999999999592, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [126, 118, 194, 50, 48, 500, 44, 60, 130, 126, 500, 500, 332, 70, 500, 472, 354, 108, 500, 114, 80, 134, 46, 36, 424, 500, 500, 500, 94, 52, 500, 26, 80, 54, 500, 500, 218, 422, 306, 56, 52, 50, 130, 86, 202, 500, 116, 64, 98, 500, 500, 500, 96, 500, 500, 76, 160, 52, 500, 500, 126, 50, 50, 500, 500, 218, 500, 500, 124, 500, 84, 500, 500, 62, 500, 70, 124, 30, 140, 68, 76, 500, 250, 500, 50, 500, 160, 314, 40, 50, 500, 92, 38, 478, 54, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37776329799157726, "mean_inference_ms": 1.208865031888599, "mean_action_processing_ms": 0.14081292371641585, "mean_env_wait_ms": 0.08256096314663537, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02400970458984375, "StateBufferConnector_ms": 0.005997180938720703, "ViewRequirementAgentConnector_ms": 0.11453008651733398}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 522000, "num_agent_steps_trained": 522000, "num_env_steps_sampled": 522000, "num_env_steps_trained": 522000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5562.812407505937, "num_env_steps_trained_throughput_per_sec": 5562.812407505937, "timesteps_total": 522000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 522000, "timers": {"training_iteration_time_ms": 3274.512, "sample_time_ms": 2879.667, "load_time_ms": 18.398, "load_throughput": 978358.402, "learn_time_ms": 334.369, "learn_throughput": 53832.785, "synch_weights_time_ms": 39.554}, "counters": {"num_env_steps_sampled": 522000, "num_env_steps_trained": 522000, "num_agent_steps_sampled": 522000, "num_agent_steps_trained": 522000}, "done": false, "episodes_total": 1967, "training_iteration": 29, "trial_id": "9f288_00015", "date": "2023-10-25_16-48-15", "timestamp": 1698248895, "time_this_iter_s": 3.240551710128784, "time_total_s": 93.30281496047974, "pid": 4200, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 93.30281496047974, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 56.86, "ram_util_percent": 27.22}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.725290298461915e-10, "cur_lr": 0.0003, "total_loss": 7.741877484321594, "policy_loss": 0.0027625031769275667, "vf_loss": 7.7391695261001585, "vf_explained_var": 4.0829181671142576e-07, "kl": 0.00023483044721501757, "entropy": 0.5459724962711334, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 590.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.224999999999821, "episode_len_mean": 263.42, "episode_media": {}, "episodes_this_iter": 80, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.500000000000014, -50.00000000000044, 25.099999999999916, -50.00000000000044, 45.1, -50.00000000000044, 34.10000000000004, 18.699999999999825, 46.099999999999994, 45.1, -50.00000000000044, 40.90000000000002, 46.3, 2.299999999999592, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, 36.10000000000004, 41.90000000000001, -50.00000000000044, -50.00000000000044, 42.900000000000006, 18.899999999999828, 47.7, 45.9, 37.70000000000003, -50.00000000000044, -50.00000000000044, 10.499999999999709, 22.49999999999988, 2.0999999999995893, -50.00000000000044, 46.099999999999994, -50.00000000000044, 33.500000000000036, -50.00000000000044, -50.00000000000044, 23.699999999999896, 40.70000000000002, 46.3, -50.00000000000044, 40.500000000000014, 45.5, 44.10000000000001, 40.30000000000002, -50.00000000000044, 9.299999999999692, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 20.099999999999845, 46.099999999999994, 45.3, 45.1, -50.00000000000044, -50.00000000000044, 43.30000000000001, 46.699999999999996, 43.50000000000001, 40.500000000000014, 25.499999999999922, 42.30000000000001, 42.30000000000001, -50.00000000000044, 45.9, 44.10000000000001, 43.30000000000001, 26.69999999999994, 41.70000000000002, 42.900000000000006, 15.299999999999777, 39.50000000000002, 14.899999999999771, -50.00000000000044, 34.10000000000004, 42.500000000000014, -50.00000000000044, -50.00000000000044, 44.5, 38.300000000000026, 46.099999999999994, 4.699999999999626, 45.3, 0.49999999999956657, 14.09999999999976, 34.30000000000004, -50.00000000000044, 30.699999999999996, 41.500000000000014, 45.5, -50.00000000000044, 44.900000000000006, -50.00000000000044], "episode_lengths": [76, 500, 250, 500, 50, 500, 160, 314, 40, 50, 500, 92, 38, 478, 54, 500, 500, 500, 500, 500, 500, 500, 114, 140, 82, 500, 500, 72, 312, 24, 42, 124, 500, 500, 396, 276, 480, 500, 40, 500, 166, 500, 500, 264, 94, 38, 500, 96, 46, 60, 98, 500, 408, 54, 500, 500, 500, 300, 40, 48, 50, 500, 500, 68, 34, 66, 96, 246, 78, 78, 500, 42, 60, 68, 234, 84, 72, 348, 106, 352, 500, 160, 76, 500, 500, 56, 118, 40, 454, 48, 496, 360, 158, 500, 194, 86, 46, 500, 52, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3776015649748057, "mean_inference_ms": 1.2080887142076806, "mean_action_processing_ms": 0.14061116446403202, "mean_env_wait_ms": 0.08270353143851812, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024993181228637695, "StateBufferConnector_ms": 0.006984710693359375, "ViewRequirementAgentConnector_ms": 0.12600159645080566}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.224999999999821, "episode_len_mean": 263.42, "episodes_this_iter": 80, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.500000000000014, -50.00000000000044, 25.099999999999916, -50.00000000000044, 45.1, -50.00000000000044, 34.10000000000004, 18.699999999999825, 46.099999999999994, 45.1, -50.00000000000044, 40.90000000000002, 46.3, 2.299999999999592, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, 36.10000000000004, 41.90000000000001, -50.00000000000044, -50.00000000000044, 42.900000000000006, 18.899999999999828, 47.7, 45.9, 37.70000000000003, -50.00000000000044, -50.00000000000044, 10.499999999999709, 22.49999999999988, 2.0999999999995893, -50.00000000000044, 46.099999999999994, -50.00000000000044, 33.500000000000036, -50.00000000000044, -50.00000000000044, 23.699999999999896, 40.70000000000002, 46.3, -50.00000000000044, 40.500000000000014, 45.5, 44.10000000000001, 40.30000000000002, -50.00000000000044, 9.299999999999692, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 20.099999999999845, 46.099999999999994, 45.3, 45.1, -50.00000000000044, -50.00000000000044, 43.30000000000001, 46.699999999999996, 43.50000000000001, 40.500000000000014, 25.499999999999922, 42.30000000000001, 42.30000000000001, -50.00000000000044, 45.9, 44.10000000000001, 43.30000000000001, 26.69999999999994, 41.70000000000002, 42.900000000000006, 15.299999999999777, 39.50000000000002, 14.899999999999771, -50.00000000000044, 34.10000000000004, 42.500000000000014, -50.00000000000044, -50.00000000000044, 44.5, 38.300000000000026, 46.099999999999994, 4.699999999999626, 45.3, 0.49999999999956657, 14.09999999999976, 34.30000000000004, -50.00000000000044, 30.699999999999996, 41.500000000000014, 45.5, -50.00000000000044, 44.900000000000006, -50.00000000000044], "episode_lengths": [76, 500, 250, 500, 50, 500, 160, 314, 40, 50, 500, 92, 38, 478, 54, 500, 500, 500, 500, 500, 500, 500, 114, 140, 82, 500, 500, 72, 312, 24, 42, 124, 500, 500, 396, 276, 480, 500, 40, 500, 166, 500, 500, 264, 94, 38, 500, 96, 46, 60, 98, 500, 408, 54, 500, 500, 500, 300, 40, 48, 50, 500, 500, 68, 34, 66, 96, 246, 78, 78, 500, 42, 60, 68, 234, 84, 72, 348, 106, 352, 500, 160, 76, 500, 500, 56, 118, 40, 454, 48, 496, 360, 158, 500, 194, 86, 46, 500, 52, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3776015649748057, "mean_inference_ms": 1.2080887142076806, "mean_action_processing_ms": 0.14061116446403202, "mean_env_wait_ms": 0.08270353143851812, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024993181228637695, "StateBufferConnector_ms": 0.006984710693359375, "ViewRequirementAgentConnector_ms": 0.12600159645080566}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5599.918349714817, "num_env_steps_trained_throughput_per_sec": 5599.918349714817, "timesteps_total": 540000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 540000, "timers": {"training_iteration_time_ms": 3280.689, "sample_time_ms": 2887.503, "load_time_ms": 18.38, "load_throughput": 979324.179, "learn_time_ms": 332.852, "learn_throughput": 54078.084, "synch_weights_time_ms": 39.43}, "counters": {"num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000}, "done": false, "episodes_total": 2047, "training_iteration": 30, "trial_id": "9f288_00015", "date": "2023-10-25_16-48-18", "timestamp": 1698248898, "time_this_iter_s": 3.2206056118011475, "time_total_s": 96.52342057228088, "pid": 4200, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 96.52342057228088, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 62.15, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.8626451492309574e-10, "cur_lr": 0.0003, "total_loss": 6.9292521476745605, "policy_loss": -0.02955782413482666, "vf_loss": 6.958861470222473, "vf_explained_var": -1.0460615158081055e-06, "kl": 0.00024510887782227544, "entropy": 0.5169481784105301, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 610.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 558000, "num_env_steps_trained": 558000, "num_agent_steps_sampled": 558000, "num_agent_steps_trained": 558000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.36499999999984, "episode_len_mean": 252.04, "episode_media": {}, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [25.499999999999922, 42.30000000000001, 42.30000000000001, -50.00000000000044, 45.9, 44.10000000000001, 43.30000000000001, 26.69999999999994, 41.70000000000002, 42.900000000000006, 15.299999999999777, 39.50000000000002, 14.899999999999771, -50.00000000000044, 34.10000000000004, 42.500000000000014, -50.00000000000044, -50.00000000000044, 44.5, 38.300000000000026, 46.099999999999994, 4.699999999999626, 45.3, 0.49999999999956657, 14.09999999999976, 34.30000000000004, -50.00000000000044, 30.699999999999996, 41.500000000000014, 45.5, -50.00000000000044, 44.900000000000006, -50.00000000000044, 33.500000000000036, -50.00000000000044, -50.00000000000044, 34.70000000000004, 20.899999999999856, 45.9, 24.899999999999913, 40.90000000000002, 42.10000000000001, -50.00000000000044, 39.300000000000026, -50.00000000000044, 39.70000000000002, 32.50000000000002, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 37.90000000000003, 14.299999999999763, 45.9, -50.00000000000044, -50.00000000000044, 29.49999999999998, -50.00000000000044, 23.29999999999989, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 46.9, 47.3, 29.69999999999998, 44.900000000000006, 45.1, 42.900000000000006, -50.00000000000044, 43.50000000000001, -50.00000000000044, 46.099999999999994, 32.30000000000002, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 29.899999999999984, 40.90000000000002, 42.500000000000014, 41.500000000000014, -50.00000000000044, 44.7, 17.499999999999808, 39.10000000000002, 13.699999999999754, 43.50000000000001, 41.500000000000014, 41.100000000000016, -50.00000000000044, 45.1, -50.00000000000044, 43.50000000000001, 40.70000000000002, -50.00000000000044, 7.09999999999966], "episode_lengths": [246, 78, 78, 500, 42, 60, 68, 234, 84, 72, 348, 106, 352, 500, 160, 76, 500, 500, 56, 118, 40, 454, 48, 496, 360, 158, 500, 194, 86, 46, 500, 52, 500, 166, 500, 500, 154, 292, 42, 252, 92, 80, 500, 108, 500, 104, 176, 58, 500, 500, 500, 60, 122, 358, 42, 500, 500, 206, 500, 268, 500, 500, 500, 500, 48, 500, 32, 28, 204, 52, 50, 72, 500, 66, 500, 40, 178, 500, 50, 500, 500, 202, 92, 76, 86, 500, 54, 326, 110, 364, 66, 86, 90, 500, 50, 500, 66, 94, 500, 430]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37757122923746395, "mean_inference_ms": 1.2090194563460124, "mean_action_processing_ms": 0.14029260802228982, "mean_env_wait_ms": 0.08262701253538995, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024975299835205078, "StateBufferConnector_ms": 0.0030014514923095703, "ViewRequirementAgentConnector_ms": 0.1040043830871582}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.36499999999984, "episode_len_mean": 252.04, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [25.499999999999922, 42.30000000000001, 42.30000000000001, -50.00000000000044, 45.9, 44.10000000000001, 43.30000000000001, 26.69999999999994, 41.70000000000002, 42.900000000000006, 15.299999999999777, 39.50000000000002, 14.899999999999771, -50.00000000000044, 34.10000000000004, 42.500000000000014, -50.00000000000044, -50.00000000000044, 44.5, 38.300000000000026, 46.099999999999994, 4.699999999999626, 45.3, 0.49999999999956657, 14.09999999999976, 34.30000000000004, -50.00000000000044, 30.699999999999996, 41.500000000000014, 45.5, -50.00000000000044, 44.900000000000006, -50.00000000000044, 33.500000000000036, -50.00000000000044, -50.00000000000044, 34.70000000000004, 20.899999999999856, 45.9, 24.899999999999913, 40.90000000000002, 42.10000000000001, -50.00000000000044, 39.300000000000026, -50.00000000000044, 39.70000000000002, 32.50000000000002, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 37.90000000000003, 14.299999999999763, 45.9, -50.00000000000044, -50.00000000000044, 29.49999999999998, -50.00000000000044, 23.29999999999989, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 46.9, 47.3, 29.69999999999998, 44.900000000000006, 45.1, 42.900000000000006, -50.00000000000044, 43.50000000000001, -50.00000000000044, 46.099999999999994, 32.30000000000002, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 29.899999999999984, 40.90000000000002, 42.500000000000014, 41.500000000000014, -50.00000000000044, 44.7, 17.499999999999808, 39.10000000000002, 13.699999999999754, 43.50000000000001, 41.500000000000014, 41.100000000000016, -50.00000000000044, 45.1, -50.00000000000044, 43.50000000000001, 40.70000000000002, -50.00000000000044, 7.09999999999966], "episode_lengths": [246, 78, 78, 500, 42, 60, 68, 234, 84, 72, 348, 106, 352, 500, 160, 76, 500, 500, 56, 118, 40, 454, 48, 496, 360, 158, 500, 194, 86, 46, 500, 52, 500, 166, 500, 500, 154, 292, 42, 252, 92, 80, 500, 108, 500, 104, 176, 58, 500, 500, 500, 60, 122, 358, 42, 500, 500, 206, 500, 268, 500, 500, 500, 500, 48, 500, 32, 28, 204, 52, 50, 72, 500, 66, 500, 40, 178, 500, 50, 500, 500, 202, 92, 76, 86, 500, 54, 326, 110, 364, 66, 86, 90, 500, 50, 500, 66, 94, 500, 430]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37757122923746395, "mean_inference_ms": 1.2090194563460124, "mean_action_processing_ms": 0.14029260802228982, "mean_env_wait_ms": 0.08262701253538995, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024975299835205078, "StateBufferConnector_ms": 0.0030014514923095703, "ViewRequirementAgentConnector_ms": 0.1040043830871582}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 558000, "num_agent_steps_trained": 558000, "num_env_steps_sampled": 558000, "num_env_steps_trained": 558000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5719.671844999128, "num_env_steps_trained_throughput_per_sec": 5719.671844999128, "timesteps_total": 558000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 558000, "timers": {"training_iteration_time_ms": 3272.127, "sample_time_ms": 2881.065, "load_time_ms": 18.886, "load_throughput": 953106.499, "learn_time_ms": 330.02, "learn_throughput": 54542.126, "synch_weights_time_ms": 39.63}, "counters": {"num_env_steps_sampled": 558000, "num_env_steps_trained": 558000, "num_agent_steps_sampled": 558000, "num_agent_steps_trained": 558000}, "done": false, "episodes_total": 2114, "training_iteration": 31, "trial_id": "9f288_00015", "date": "2023-10-25_16-48-21", "timestamp": 1698248901, "time_this_iter_s": 3.1527211666107178, "time_total_s": 99.6761417388916, "pid": 4200, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 99.6761417388916, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 56.7, "ram_util_percent": 27.22}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.313225746154787e-11, "cur_lr": 0.0003, "total_loss": 6.608447647094726, "policy_loss": -0.0134613536298275, "vf_loss": 6.621959972381592, "vf_explained_var": -1.7464160919189454e-06, "kl": 0.0005997595040867054, "entropy": 0.5095697328448295, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 630.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.28499999999984, "episode_len_mean": 242.82, "episode_media": {}, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [47.3, 29.69999999999998, 44.900000000000006, 45.1, 42.900000000000006, -50.00000000000044, 43.50000000000001, -50.00000000000044, 46.099999999999994, 32.30000000000002, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 29.899999999999984, 40.90000000000002, 42.500000000000014, 41.500000000000014, -50.00000000000044, 44.7, 17.499999999999808, 39.10000000000002, 13.699999999999754, 43.50000000000001, 41.500000000000014, 41.100000000000016, -50.00000000000044, 45.1, -50.00000000000044, 43.50000000000001, 40.70000000000002, -50.00000000000044, 7.09999999999966, -50.00000000000044, 21.89999999999987, 28.89999999999997, -50.00000000000044, 46.3, 44.5, 40.90000000000002, -50.00000000000044, 39.50000000000002, 38.300000000000026, 43.900000000000006, -50.00000000000044, 46.9, 44.5, 31.1, 43.50000000000001, -50.00000000000044, 46.099999999999994, 24.499999999999908, 43.10000000000001, 41.90000000000001, 47.1, 37.10000000000003, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 5.099999999999632, -50.00000000000044, -50.00000000000044, 42.10000000000001, 44.7, 37.50000000000003, -50.00000000000044, 36.70000000000003, 46.9, 47.5, -50.00000000000044, -50.00000000000044, 43.900000000000006, 44.900000000000006, 35.500000000000036, 15.699999999999783, 43.10000000000001, 43.50000000000001, 45.3, -50.00000000000044, 41.70000000000002, -50.00000000000044, 45.1, 15.699999999999783, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002, -50.00000000000044, 35.70000000000003, 37.10000000000003, 43.10000000000001, 46.5, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.70000000000003], "episode_lengths": [28, 204, 52, 50, 72, 500, 66, 500, 40, 178, 500, 50, 500, 500, 202, 92, 76, 86, 500, 54, 326, 110, 364, 66, 86, 90, 500, 50, 500, 66, 94, 500, 430, 500, 282, 212, 500, 38, 56, 92, 500, 106, 118, 62, 500, 32, 56, 190, 66, 500, 40, 256, 70, 82, 30, 130, 500, 500, 60, 500, 450, 500, 500, 80, 54, 126, 500, 134, 32, 26, 500, 500, 62, 52, 146, 344, 70, 66, 48, 500, 84, 500, 50, 344, 500, 500, 500, 500, 500, 106, 500, 144, 130, 70, 36, 74, 500, 500, 500, 144]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37740856833152003, "mean_inference_ms": 1.2081824906188565, "mean_action_processing_ms": 0.14050731462142374, "mean_env_wait_ms": 0.082541108506858, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02599024772644043, "StateBufferConnector_ms": 0.0050008296966552734, "ViewRequirementAgentConnector_ms": 0.11303472518920898}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.28499999999984, "episode_len_mean": 242.82, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [47.3, 29.69999999999998, 44.900000000000006, 45.1, 42.900000000000006, -50.00000000000044, 43.50000000000001, -50.00000000000044, 46.099999999999994, 32.30000000000002, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 29.899999999999984, 40.90000000000002, 42.500000000000014, 41.500000000000014, -50.00000000000044, 44.7, 17.499999999999808, 39.10000000000002, 13.699999999999754, 43.50000000000001, 41.500000000000014, 41.100000000000016, -50.00000000000044, 45.1, -50.00000000000044, 43.50000000000001, 40.70000000000002, -50.00000000000044, 7.09999999999966, -50.00000000000044, 21.89999999999987, 28.89999999999997, -50.00000000000044, 46.3, 44.5, 40.90000000000002, -50.00000000000044, 39.50000000000002, 38.300000000000026, 43.900000000000006, -50.00000000000044, 46.9, 44.5, 31.1, 43.50000000000001, -50.00000000000044, 46.099999999999994, 24.499999999999908, 43.10000000000001, 41.90000000000001, 47.1, 37.10000000000003, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 5.099999999999632, -50.00000000000044, -50.00000000000044, 42.10000000000001, 44.7, 37.50000000000003, -50.00000000000044, 36.70000000000003, 46.9, 47.5, -50.00000000000044, -50.00000000000044, 43.900000000000006, 44.900000000000006, 35.500000000000036, 15.699999999999783, 43.10000000000001, 43.50000000000001, 45.3, -50.00000000000044, 41.70000000000002, -50.00000000000044, 45.1, 15.699999999999783, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002, -50.00000000000044, 35.70000000000003, 37.10000000000003, 43.10000000000001, 46.5, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.70000000000003], "episode_lengths": [28, 204, 52, 50, 72, 500, 66, 500, 40, 178, 500, 50, 500, 500, 202, 92, 76, 86, 500, 54, 326, 110, 364, 66, 86, 90, 500, 50, 500, 66, 94, 500, 430, 500, 282, 212, 500, 38, 56, 92, 500, 106, 118, 62, 500, 32, 56, 190, 66, 500, 40, 256, 70, 82, 30, 130, 500, 500, 60, 500, 450, 500, 500, 80, 54, 126, 500, 134, 32, 26, 500, 500, 62, 52, 146, 344, 70, 66, 48, 500, 84, 500, 50, 344, 500, 500, 500, 500, 500, 106, 500, 144, 130, 70, 36, 74, 500, 500, 500, 144]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37740856833152003, "mean_inference_ms": 1.2081824906188565, "mean_action_processing_ms": 0.14050731462142374, "mean_env_wait_ms": 0.082541108506858, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02599024772644043, "StateBufferConnector_ms": 0.0050008296966552734, "ViewRequirementAgentConnector_ms": 0.11303472518920898}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5770.054189119362, "num_env_steps_trained_throughput_per_sec": 5770.054189119362, "timesteps_total": 576000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 576000, "timers": {"training_iteration_time_ms": 3273.496, "sample_time_ms": 2879.428, "load_time_ms": 18.88, "load_throughput": 953365.265, "learn_time_ms": 332.828, "learn_throughput": 54081.942, "synch_weights_time_ms": 39.832}, "counters": {"num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "done": false, "episodes_total": 2181, "training_iteration": 32, "trial_id": "9f288_00015", "date": "2023-10-25_16-48-24", "timestamp": 1698248904, "time_this_iter_s": 3.1245639324188232, "time_total_s": 102.80070567131042, "pid": 4200, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 102.80070567131042, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 62.75, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.6566128730773935e-11, "cur_lr": 0.0003, "total_loss": 6.456478786468506, "policy_loss": 0.026324560306966303, "vf_loss": 6.430205988883972, "vf_explained_var": 9.03010368347168e-07, "kl": 0.0006223736036645277, "entropy": 0.5177318826317787, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 650.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 594000, "num_env_steps_trained": 594000, "num_agent_steps_sampled": 594000, "num_agent_steps_trained": 594000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -3.1600000000002173, "episode_len_mean": 302.14, "episode_media": {}, "episodes_this_iter": 56, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 5.099999999999632, -50.00000000000044, -50.00000000000044, 42.10000000000001, 44.7, 37.50000000000003, -50.00000000000044, 36.70000000000003, 46.9, 47.5, -50.00000000000044, -50.00000000000044, 43.900000000000006, 44.900000000000006, 35.500000000000036, 15.699999999999783, 43.10000000000001, 43.50000000000001, 45.3, -50.00000000000044, 41.70000000000002, -50.00000000000044, 45.1, 15.699999999999783, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002, -50.00000000000044, 35.70000000000003, 37.10000000000003, 43.10000000000001, 46.5, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.70000000000003, -50.00000000000044, 17.899999999999814, -50.00000000000044, 28.699999999999967, -50.00000000000044, 40.70000000000002, 34.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.500000000000036, 42.70000000000001, 28.499999999999964, -50.00000000000044, 44.10000000000001, 26.299999999999933, 33.70000000000004, -50.00000000000044, 45.9, 41.70000000000002, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 38.10000000000002, 37.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.899999999999785, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.500000000000036, 43.30000000000001, -50.00000000000044, 16.29999999999979, 25.29999999999992, 47.1, -50.00000000000044, -50.00000000000044, 4.699999999999626, 46.5, -50.00000000000044, 37.10000000000003, 37.90000000000003, 45.5, 44.5], "episode_lengths": [500, 500, 60, 500, 450, 500, 500, 80, 54, 126, 500, 134, 32, 26, 500, 500, 62, 52, 146, 344, 70, 66, 48, 500, 84, 500, 50, 344, 500, 500, 500, 500, 500, 106, 500, 144, 130, 70, 36, 74, 500, 500, 500, 144, 500, 322, 500, 214, 500, 94, 154, 500, 500, 500, 500, 500, 146, 74, 216, 500, 60, 238, 164, 500, 42, 84, 500, 54, 500, 500, 500, 50, 120, 130, 500, 500, 500, 500, 500, 342, 500, 84, 500, 500, 500, 166, 68, 500, 338, 248, 30, 500, 500, 454, 36, 500, 130, 122, 46, 56]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37704473812633116, "mean_inference_ms": 1.2070132244458327, "mean_action_processing_ms": 0.14030867362350213, "mean_env_wait_ms": 0.08318735701836102, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02799510955810547, "StateBufferConnector_ms": 0.005001068115234375, "ViewRequirementAgentConnector_ms": 0.1240074634552002}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -3.1600000000002173, "episode_len_mean": 302.14, "episodes_this_iter": 56, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 5.099999999999632, -50.00000000000044, -50.00000000000044, 42.10000000000001, 44.7, 37.50000000000003, -50.00000000000044, 36.70000000000003, 46.9, 47.5, -50.00000000000044, -50.00000000000044, 43.900000000000006, 44.900000000000006, 35.500000000000036, 15.699999999999783, 43.10000000000001, 43.50000000000001, 45.3, -50.00000000000044, 41.70000000000002, -50.00000000000044, 45.1, 15.699999999999783, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002, -50.00000000000044, 35.70000000000003, 37.10000000000003, 43.10000000000001, 46.5, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.70000000000003, -50.00000000000044, 17.899999999999814, -50.00000000000044, 28.699999999999967, -50.00000000000044, 40.70000000000002, 34.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.500000000000036, 42.70000000000001, 28.499999999999964, -50.00000000000044, 44.10000000000001, 26.299999999999933, 33.70000000000004, -50.00000000000044, 45.9, 41.70000000000002, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 38.10000000000002, 37.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.899999999999785, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.500000000000036, 43.30000000000001, -50.00000000000044, 16.29999999999979, 25.29999999999992, 47.1, -50.00000000000044, -50.00000000000044, 4.699999999999626, 46.5, -50.00000000000044, 37.10000000000003, 37.90000000000003, 45.5, 44.5], "episode_lengths": [500, 500, 60, 500, 450, 500, 500, 80, 54, 126, 500, 134, 32, 26, 500, 500, 62, 52, 146, 344, 70, 66, 48, 500, 84, 500, 50, 344, 500, 500, 500, 500, 500, 106, 500, 144, 130, 70, 36, 74, 500, 500, 500, 144, 500, 322, 500, 214, 500, 94, 154, 500, 500, 500, 500, 500, 146, 74, 216, 500, 60, 238, 164, 500, 42, 84, 500, 54, 500, 500, 500, 50, 120, 130, 500, 500, 500, 500, 500, 342, 500, 84, 500, 500, 500, 166, 68, 500, 338, 248, 30, 500, 500, 454, 36, 500, 130, 122, 46, 56]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37704473812633116, "mean_inference_ms": 1.2070132244458327, "mean_action_processing_ms": 0.14030867362350213, "mean_env_wait_ms": 0.08318735701836102, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02799510955810547, "StateBufferConnector_ms": 0.005001068115234375, "ViewRequirementAgentConnector_ms": 0.1240074634552002}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 594000, "num_agent_steps_trained": 594000, "num_env_steps_sampled": 594000, "num_env_steps_trained": 594000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5320.673043278112, "num_env_steps_trained_throughput_per_sec": 5320.673043278112, "timesteps_total": 594000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 594000, "timers": {"training_iteration_time_ms": 3298.892, "sample_time_ms": 2893.537, "load_time_ms": 19.978, "load_throughput": 901009.427, "learn_time_ms": 343.495, "learn_throughput": 52402.566, "synch_weights_time_ms": 39.456}, "counters": {"num_env_steps_sampled": 594000, "num_env_steps_trained": 594000, "num_agent_steps_sampled": 594000, "num_agent_steps_trained": 594000}, "done": false, "episodes_total": 2237, "training_iteration": 33, "trial_id": "9f288_00015", "date": "2023-10-25_16-48-28", "timestamp": 1698248908, "time_this_iter_s": 3.3880088329315186, "time_total_s": 106.18871450424194, "pid": 4200, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 106.18871450424194, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 57.85999999999999, "ram_util_percent": 27.240000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.3283064365386967e-11, "cur_lr": 0.0003, "total_loss": 6.761074542999268, "policy_loss": -0.017069022334180773, "vf_loss": 6.778199863433838, "vf_explained_var": -1.3440847396850586e-06, "kl": 0.0002475402267634763, "entropy": 0.5629525929689407, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 670.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.6929999999998144, "episode_len_mean": 268.68, "episode_media": {}, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.899999999999785, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.500000000000036, 43.30000000000001, -50.00000000000044, 16.29999999999979, 25.29999999999992, 47.1, -50.00000000000044, -50.00000000000044, 4.699999999999626, 46.5, -50.00000000000044, 37.10000000000003, 37.90000000000003, 45.5, 44.5, -50.00000000000044, 44.5, -50.00000000000044, 35.30000000000004, 11.099999999999717, 32.30000000000002, 37.90000000000003, -50.00000000000044, 44.5, 42.30000000000001, 37.300000000000026, 41.100000000000016, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 16.699999999999797, 46.099999999999994, 43.50000000000001, -50.00000000000044, -50.00000000000044, 44.300000000000004, 45.5, 28.09999999999996, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 43.50000000000001, 43.30000000000001, 42.30000000000001, 40.70000000000002, 46.5, 44.5, -50.00000000000044, 43.900000000000006, 38.10000000000002, 13.099999999999746, 42.10000000000001, -50.00000000000044, 42.10000000000001, -50.00000000000044, 39.50000000000002, 43.900000000000006, 45.9, -50.00000000000044, 42.500000000000014, 37.300000000000026, -50.00000000000044, -50.00000000000044, 38.700000000000024, 42.900000000000006, 37.70000000000003, 31.500000000000007, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.899999999999842, 41.100000000000016, 46.3, -50.00000000000044, 40.500000000000014, 39.300000000000026, 37.90000000000003, 45.7, -50.00000000000044, 41.500000000000014, -50.00000000000044, 39.10000000000002, -50.00000000000044, 44.5], "episode_lengths": [500, 500, 500, 500, 342, 500, 84, 500, 500, 500, 166, 68, 500, 338, 248, 30, 500, 500, 454, 36, 500, 130, 122, 46, 56, 500, 56, 500, 148, 390, 178, 122, 500, 56, 78, 128, 90, 500, 56, 500, 500, 500, 334, 40, 66, 500, 500, 58, 46, 220, 48, 500, 500, 500, 500, 62, 66, 68, 78, 94, 36, 56, 500, 62, 120, 370, 80, 500, 80, 500, 106, 62, 42, 500, 76, 128, 500, 500, 114, 72, 124, 186, 500, 500, 500, 500, 302, 90, 38, 500, 96, 108, 122, 44, 500, 86, 500, 110, 500, 56]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37729542421514983, "mean_inference_ms": 1.2075870961828692, "mean_action_processing_ms": 0.14037038917489672, "mean_env_wait_ms": 0.0829052034423965, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018002033233642578, "StateBufferConnector_ms": 0.005019187927246094, "ViewRequirementAgentConnector_ms": 0.13501954078674316}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.6929999999998144, "episode_len_mean": 268.68, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.899999999999785, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.500000000000036, 43.30000000000001, -50.00000000000044, 16.29999999999979, 25.29999999999992, 47.1, -50.00000000000044, -50.00000000000044, 4.699999999999626, 46.5, -50.00000000000044, 37.10000000000003, 37.90000000000003, 45.5, 44.5, -50.00000000000044, 44.5, -50.00000000000044, 35.30000000000004, 11.099999999999717, 32.30000000000002, 37.90000000000003, -50.00000000000044, 44.5, 42.30000000000001, 37.300000000000026, 41.100000000000016, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 16.699999999999797, 46.099999999999994, 43.50000000000001, -50.00000000000044, -50.00000000000044, 44.300000000000004, 45.5, 28.09999999999996, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 43.50000000000001, 43.30000000000001, 42.30000000000001, 40.70000000000002, 46.5, 44.5, -50.00000000000044, 43.900000000000006, 38.10000000000002, 13.099999999999746, 42.10000000000001, -50.00000000000044, 42.10000000000001, -50.00000000000044, 39.50000000000002, 43.900000000000006, 45.9, -50.00000000000044, 42.500000000000014, 37.300000000000026, -50.00000000000044, -50.00000000000044, 38.700000000000024, 42.900000000000006, 37.70000000000003, 31.500000000000007, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.899999999999842, 41.100000000000016, 46.3, -50.00000000000044, 40.500000000000014, 39.300000000000026, 37.90000000000003, 45.7, -50.00000000000044, 41.500000000000014, -50.00000000000044, 39.10000000000002, -50.00000000000044, 44.5], "episode_lengths": [500, 500, 500, 500, 342, 500, 84, 500, 500, 500, 166, 68, 500, 338, 248, 30, 500, 500, 454, 36, 500, 130, 122, 46, 56, 500, 56, 500, 148, 390, 178, 122, 500, 56, 78, 128, 90, 500, 56, 500, 500, 500, 334, 40, 66, 500, 500, 58, 46, 220, 48, 500, 500, 500, 500, 62, 66, 68, 78, 94, 36, 56, 500, 62, 120, 370, 80, 500, 80, 500, 106, 62, 42, 500, 76, 128, 500, 500, 114, 72, 124, 186, 500, 500, 500, 500, 302, 90, 38, 500, 96, 108, 122, 44, 500, 86, 500, 110, 500, 56]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37729542421514983, "mean_inference_ms": 1.2075870961828692, "mean_action_processing_ms": 0.14037038917489672, "mean_env_wait_ms": 0.0829052034423965, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018002033233642578, "StateBufferConnector_ms": 0.005019187927246094, "ViewRequirementAgentConnector_ms": 0.13501954078674316}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000, "num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5788.954489012964, "num_env_steps_trained_throughput_per_sec": 5788.954489012964, "timesteps_total": 612000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 612000, "timers": {"training_iteration_time_ms": 3231.842, "sample_time_ms": 2870.523, "load_time_ms": 19.118, "load_throughput": 941537.564, "learn_time_ms": 330.47, "learn_throughput": 54467.802, "synch_weights_time_ms": 9.308}, "counters": {"num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000}, "done": false, "episodes_total": 2312, "training_iteration": 34, "trial_id": "9f288_00015", "date": "2023-10-25_16-48-31", "timestamp": 1698248911, "time_this_iter_s": 3.115382194519043, "time_total_s": 109.30409669876099, "pid": 4200, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 109.30409669876099, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 60.55, "ram_util_percent": 27.225}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1641532182693484e-11, "cur_lr": 0.0003, "total_loss": 6.7232670545578, "policy_loss": -0.008864373434334993, "vf_loss": 6.732187271118164, "vf_explained_var": -2.619624137878418e-06, "kl": 0.0009058808019432263, "entropy": 0.5593050330877304, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 690.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 630000, "num_env_steps_trained": 630000, "num_agent_steps_sampled": 630000, "num_agent_steps_trained": 630000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.93599999999984, "episode_len_mean": 251.28, "episode_media": {}, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.900000000000006, 45.9, -50.00000000000044, 42.500000000000014, 37.300000000000026, -50.00000000000044, -50.00000000000044, 38.700000000000024, 42.900000000000006, 37.70000000000003, 31.500000000000007, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.899999999999842, 41.100000000000016, 46.3, -50.00000000000044, 40.500000000000014, 39.300000000000026, 37.90000000000003, 45.7, -50.00000000000044, 41.500000000000014, -50.00000000000044, 39.10000000000002, -50.00000000000044, 44.5, -50.00000000000044, 42.900000000000006, 37.50000000000003, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, 31.300000000000004, -50.00000000000044, -50.00000000000044, 43.7, 13.899999999999757, -50.00000000000044, 41.70000000000002, -50.00000000000044, 45.1, -50.00000000000044, 38.700000000000024, 31.900000000000013, 29.899999999999984, 42.10000000000001, 34.30000000000004, 45.1, -50.00000000000044, 39.50000000000002, 46.099999999999994, -50.00000000000044, 35.900000000000034, 25.899999999999928, 40.90000000000002, -50.00000000000044, -50.00000000000044, 46.099999999999994, 46.3, -50.00000000000044, 26.299999999999933, 36.70000000000003, 22.099999999999874, 42.10000000000001, 43.30000000000001, 41.30000000000001, 34.50000000000004, 44.5, -50.00000000000044, 43.10000000000001, -50.00000000000044, 41.100000000000016, -50.00000000000044, 46.099999999999994, 40.30000000000002, 41.100000000000016, 12.499999999999737, -50.00000000000044, 46.699999999999996, 42.30000000000001, 43.30000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 31.500000000000007, -50.00000000000044, -50.00000000000044, 37.70000000000003, -50.00000000000044, -50.00000000000044, 40.90000000000002, 46.699999999999996, 37.70000000000003, 43.7], "episode_lengths": [62, 42, 500, 76, 128, 500, 500, 114, 72, 124, 186, 500, 500, 500, 500, 302, 90, 38, 500, 96, 108, 122, 44, 500, 86, 500, 110, 500, 56, 500, 72, 126, 500, 500, 100, 500, 188, 500, 500, 64, 362, 500, 84, 500, 50, 500, 114, 182, 202, 80, 158, 50, 500, 106, 40, 500, 142, 242, 92, 500, 500, 40, 38, 500, 238, 134, 280, 80, 68, 88, 156, 56, 500, 70, 500, 90, 500, 40, 98, 90, 376, 500, 34, 78, 68, 40, 500, 500, 32, 500, 186, 500, 500, 124, 500, 500, 92, 34, 124, 64]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37739182899158735, "mean_inference_ms": 1.2072349224618042, "mean_action_processing_ms": 0.14021453813080828, "mean_env_wait_ms": 0.08279698025660487, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019999027252197266, "StateBufferConnector_ms": 0.006005764007568359, "ViewRequirementAgentConnector_ms": 0.14085912704467773}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.93599999999984, "episode_len_mean": 251.28, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.900000000000006, 45.9, -50.00000000000044, 42.500000000000014, 37.300000000000026, -50.00000000000044, -50.00000000000044, 38.700000000000024, 42.900000000000006, 37.70000000000003, 31.500000000000007, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.899999999999842, 41.100000000000016, 46.3, -50.00000000000044, 40.500000000000014, 39.300000000000026, 37.90000000000003, 45.7, -50.00000000000044, 41.500000000000014, -50.00000000000044, 39.10000000000002, -50.00000000000044, 44.5, -50.00000000000044, 42.900000000000006, 37.50000000000003, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, 31.300000000000004, -50.00000000000044, -50.00000000000044, 43.7, 13.899999999999757, -50.00000000000044, 41.70000000000002, -50.00000000000044, 45.1, -50.00000000000044, 38.700000000000024, 31.900000000000013, 29.899999999999984, 42.10000000000001, 34.30000000000004, 45.1, -50.00000000000044, 39.50000000000002, 46.099999999999994, -50.00000000000044, 35.900000000000034, 25.899999999999928, 40.90000000000002, -50.00000000000044, -50.00000000000044, 46.099999999999994, 46.3, -50.00000000000044, 26.299999999999933, 36.70000000000003, 22.099999999999874, 42.10000000000001, 43.30000000000001, 41.30000000000001, 34.50000000000004, 44.5, -50.00000000000044, 43.10000000000001, -50.00000000000044, 41.100000000000016, -50.00000000000044, 46.099999999999994, 40.30000000000002, 41.100000000000016, 12.499999999999737, -50.00000000000044, 46.699999999999996, 42.30000000000001, 43.30000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 31.500000000000007, -50.00000000000044, -50.00000000000044, 37.70000000000003, -50.00000000000044, -50.00000000000044, 40.90000000000002, 46.699999999999996, 37.70000000000003, 43.7], "episode_lengths": [62, 42, 500, 76, 128, 500, 500, 114, 72, 124, 186, 500, 500, 500, 500, 302, 90, 38, 500, 96, 108, 122, 44, 500, 86, 500, 110, 500, 56, 500, 72, 126, 500, 500, 100, 500, 188, 500, 500, 64, 362, 500, 84, 500, 50, 500, 114, 182, 202, 80, 158, 50, 500, 106, 40, 500, 142, 242, 92, 500, 500, 40, 38, 500, 238, 134, 280, 80, 68, 88, 156, 56, 500, 70, 500, 90, 500, 40, 98, 90, 376, 500, 34, 78, 68, 40, 500, 500, 32, 500, 186, 500, 500, 124, 500, 500, 92, 34, 124, 64]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37739182899158735, "mean_inference_ms": 1.2072349224618042, "mean_action_processing_ms": 0.14021453813080828, "mean_env_wait_ms": 0.08279698025660487, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019999027252197266, "StateBufferConnector_ms": 0.006005764007568359, "ViewRequirementAgentConnector_ms": 0.14085912704467773}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 630000, "num_agent_steps_trained": 630000, "num_env_steps_sampled": 630000, "num_env_steps_trained": 630000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5655.8806534761125, "num_env_steps_trained_throughput_per_sec": 5655.8806534761125, "timesteps_total": 630000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 630000, "timers": {"training_iteration_time_ms": 3218.451, "sample_time_ms": 2857.872, "load_time_ms": 18.995, "load_throughput": 947622.605, "learn_time_ms": 330.028, "learn_throughput": 54540.821, "synch_weights_time_ms": 9.334}, "counters": {"num_env_steps_sampled": 630000, "num_env_steps_trained": 630000, "num_agent_steps_sampled": 630000, "num_agent_steps_trained": 630000}, "done": false, "episodes_total": 2383, "training_iteration": 35, "trial_id": "9f288_00015", "date": "2023-10-25_16-48-34", "timestamp": 1698248914, "time_this_iter_s": 3.1880991458892822, "time_total_s": 112.49219584465027, "pid": 4200, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 112.49219584465027, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 58.32000000000001, "ram_util_percent": 27.28}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.820766091346742e-12, "cur_lr": 0.0003, "total_loss": 6.889999103546143, "policy_loss": -0.012815176416188479, "vf_loss": 6.902866554260254, "vf_explained_var": 1.6540288925170898e-06, "kl": 0.0011982176511651232, "entropy": 0.5229726806282997, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 710.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.82099999999984, "episode_len_mean": 247.44, "episode_media": {}, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 41.100000000000016, -50.00000000000044, 46.099999999999994, 40.30000000000002, 41.100000000000016, 12.499999999999737, -50.00000000000044, 46.699999999999996, 42.30000000000001, 43.30000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 31.500000000000007, -50.00000000000044, -50.00000000000044, 37.70000000000003, -50.00000000000044, -50.00000000000044, 40.90000000000002, 46.699999999999996, 37.70000000000003, 43.7, -50.00000000000044, 36.900000000000034, 46.5, -50.00000000000044, -50.00000000000044, 19.69999999999984, 29.899999999999984, -50.00000000000044, 35.500000000000036, -50.00000000000044, 43.7, 38.700000000000024, -50.00000000000044, 41.70000000000002, -50.00000000000044, 33.10000000000003, 42.70000000000001, 43.10000000000001, 37.90000000000003, 30.699999999999996, 31.900000000000013, 36.900000000000034, 15.899999999999785, -50.00000000000044, -50.00000000000044, 45.1, 43.7, 37.50000000000003, -50.00000000000044, 43.30000000000001, 42.900000000000006, 44.10000000000001, 40.70000000000002, -50.00000000000044, -50.00000000000044, 10.099999999999703, 47.5, 38.10000000000002, 46.099999999999994, 44.900000000000006, 46.699999999999996, 43.50000000000001, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 46.3, 45.9, 43.900000000000006, -50.00000000000044, -50.00000000000044, 12.69999999999974, -50.00000000000044, 44.5, 47.3, -50.00000000000044, 32.100000000000016, 43.10000000000001, 35.500000000000036, 43.50000000000001, -50.00000000000044, -50.00000000000044, 31.70000000000001, 33.10000000000003, 44.300000000000004, -50.00000000000044, 43.10000000000001, -50.00000000000044, 36.70000000000003, 26.299999999999933, 46.099999999999994, -50.00000000000044, 47.9], "episode_lengths": [500, 90, 500, 40, 98, 90, 376, 500, 34, 78, 68, 40, 500, 500, 32, 500, 186, 500, 500, 124, 500, 500, 92, 34, 124, 64, 500, 132, 36, 500, 500, 304, 202, 500, 146, 500, 64, 114, 500, 84, 500, 170, 74, 70, 122, 194, 182, 132, 342, 500, 500, 50, 64, 126, 500, 68, 72, 60, 94, 500, 500, 400, 26, 120, 40, 52, 34, 66, 500, 500, 56, 500, 500, 38, 42, 62, 500, 500, 374, 500, 56, 28, 500, 180, 70, 146, 66, 500, 500, 184, 170, 58, 500, 70, 500, 134, 238, 40, 500, 22]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37767911101088425, "mean_inference_ms": 1.2068564705408904, "mean_action_processing_ms": 0.14003633978756333, "mean_env_wait_ms": 0.08297640445573048, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02503824234008789, "StateBufferConnector_ms": 0.005999326705932617, "ViewRequirementAgentConnector_ms": 0.12901759147644043}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.82099999999984, "episode_len_mean": 247.44, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 41.100000000000016, -50.00000000000044, 46.099999999999994, 40.30000000000002, 41.100000000000016, 12.499999999999737, -50.00000000000044, 46.699999999999996, 42.30000000000001, 43.30000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 31.500000000000007, -50.00000000000044, -50.00000000000044, 37.70000000000003, -50.00000000000044, -50.00000000000044, 40.90000000000002, 46.699999999999996, 37.70000000000003, 43.7, -50.00000000000044, 36.900000000000034, 46.5, -50.00000000000044, -50.00000000000044, 19.69999999999984, 29.899999999999984, -50.00000000000044, 35.500000000000036, -50.00000000000044, 43.7, 38.700000000000024, -50.00000000000044, 41.70000000000002, -50.00000000000044, 33.10000000000003, 42.70000000000001, 43.10000000000001, 37.90000000000003, 30.699999999999996, 31.900000000000013, 36.900000000000034, 15.899999999999785, -50.00000000000044, -50.00000000000044, 45.1, 43.7, 37.50000000000003, -50.00000000000044, 43.30000000000001, 42.900000000000006, 44.10000000000001, 40.70000000000002, -50.00000000000044, -50.00000000000044, 10.099999999999703, 47.5, 38.10000000000002, 46.099999999999994, 44.900000000000006, 46.699999999999996, 43.50000000000001, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 46.3, 45.9, 43.900000000000006, -50.00000000000044, -50.00000000000044, 12.69999999999974, -50.00000000000044, 44.5, 47.3, -50.00000000000044, 32.100000000000016, 43.10000000000001, 35.500000000000036, 43.50000000000001, -50.00000000000044, -50.00000000000044, 31.70000000000001, 33.10000000000003, 44.300000000000004, -50.00000000000044, 43.10000000000001, -50.00000000000044, 36.70000000000003, 26.299999999999933, 46.099999999999994, -50.00000000000044, 47.9], "episode_lengths": [500, 90, 500, 40, 98, 90, 376, 500, 34, 78, 68, 40, 500, 500, 32, 500, 186, 500, 500, 124, 500, 500, 92, 34, 124, 64, 500, 132, 36, 500, 500, 304, 202, 500, 146, 500, 64, 114, 500, 84, 500, 170, 74, 70, 122, 194, 182, 132, 342, 500, 500, 50, 64, 126, 500, 68, 72, 60, 94, 500, 500, 400, 26, 120, 40, 52, 34, 66, 500, 500, 56, 500, 500, 38, 42, 62, 500, 500, 374, 500, 56, 28, 500, 180, 70, 146, 66, 500, 500, 184, 170, 58, 500, 70, 500, 134, 238, 40, 500, 22]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37767911101088425, "mean_inference_ms": 1.2068564705408904, "mean_action_processing_ms": 0.14003633978756333, "mean_env_wait_ms": 0.08297640445573048, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02503824234008789, "StateBufferConnector_ms": 0.005999326705932617, "ViewRequirementAgentConnector_ms": 0.12901759147644043}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5577.476700511387, "num_env_steps_trained_throughput_per_sec": 5577.476700511387, "timesteps_total": 648000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 648000, "timers": {"training_iteration_time_ms": 3208.928, "sample_time_ms": 2844.549, "load_time_ms": 18.726, "load_throughput": 961225.929, "learn_time_ms": 334.142, "learn_throughput": 53869.287, "synch_weights_time_ms": 9.189}, "counters": {"num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000}, "done": false, "episodes_total": 2457, "training_iteration": 36, "trial_id": "9f288_00015", "date": "2023-10-25_16-48-37", "timestamp": 1698248917, "time_this_iter_s": 3.2322640419006348, "time_total_s": 115.7244598865509, "pid": 4200, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 115.7244598865509, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 63.175000000000004, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.910383045673371e-12, "cur_lr": 0.0003, "total_loss": 7.241003084182739, "policy_loss": -0.042447113618254664, "vf_loss": 7.283505868911743, "vf_explained_var": 3.933906555175781e-07, "kl": 0.0013484533664779974, "entropy": 0.5562142759561539, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 730.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 666000, "num_env_steps_trained": 666000, "num_agent_steps_sampled": 666000, "num_agent_steps_trained": 666000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.738999999999844, "episode_len_mean": 248.3, "episode_media": {}, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.9, 43.900000000000006, -50.00000000000044, -50.00000000000044, 12.69999999999974, -50.00000000000044, 44.5, 47.3, -50.00000000000044, 32.100000000000016, 43.10000000000001, 35.500000000000036, 43.50000000000001, -50.00000000000044, -50.00000000000044, 31.70000000000001, 33.10000000000003, 44.300000000000004, -50.00000000000044, 43.10000000000001, -50.00000000000044, 36.70000000000003, 26.299999999999933, 46.099999999999994, -50.00000000000044, 47.9, 6.699999999999655, 43.10000000000001, 43.30000000000001, 22.299999999999876, 43.7, -50.00000000000044, 33.30000000000003, 40.70000000000002, 42.30000000000001, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, 35.70000000000003, 44.900000000000006, 45.1, 44.5, 45.1, 44.5, 34.50000000000004, 44.900000000000006, 43.50000000000001, 43.50000000000001, 15.299999999999777, 43.7, -50.00000000000044, 45.5, -50.00000000000044, 36.900000000000034, 31.70000000000001, 41.100000000000016, -50.00000000000044, 44.10000000000001, 38.50000000000003, 40.30000000000002, -50.00000000000044, 44.10000000000001, -50.00000000000044, 32.50000000000002, 18.099999999999817, 40.30000000000002, -50.00000000000044, 38.10000000000002, -50.00000000000044, 43.10000000000001, 39.300000000000026, 42.500000000000014, 0.09999999999956088, 41.30000000000001, 17.099999999999802, 23.29999999999989, -50.00000000000044, 17.099999999999802, 43.900000000000006, 40.30000000000002, 44.10000000000001, 28.699999999999967, 26.69999999999994, 31.300000000000004, -50.00000000000044, -50.00000000000044, 42.30000000000001, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.500000000000007, 17.69999999999981, -50.00000000000044], "episode_lengths": [42, 62, 500, 500, 374, 500, 56, 28, 500, 180, 70, 146, 66, 500, 500, 184, 170, 58, 500, 70, 500, 134, 238, 40, 500, 22, 434, 70, 68, 278, 64, 500, 168, 94, 78, 124, 500, 500, 500, 86, 500, 500, 144, 52, 50, 56, 50, 56, 156, 52, 66, 66, 348, 64, 500, 46, 500, 132, 184, 90, 500, 60, 116, 98, 500, 60, 500, 176, 320, 98, 500, 120, 500, 70, 108, 76, 500, 88, 330, 268, 500, 330, 62, 98, 60, 214, 234, 188, 500, 500, 78, 52, 500, 500, 500, 500, 500, 186, 324, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3775370824832703, "mean_inference_ms": 1.2062789038498247, "mean_action_processing_ms": 0.1401466688981846, "mean_env_wait_ms": 0.08318925710519588, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03102278709411621, "StateBufferConnector_ms": 0.008996725082397461, "ViewRequirementAgentConnector_ms": 0.130997896194458}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.738999999999844, "episode_len_mean": 248.3, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.9, 43.900000000000006, -50.00000000000044, -50.00000000000044, 12.69999999999974, -50.00000000000044, 44.5, 47.3, -50.00000000000044, 32.100000000000016, 43.10000000000001, 35.500000000000036, 43.50000000000001, -50.00000000000044, -50.00000000000044, 31.70000000000001, 33.10000000000003, 44.300000000000004, -50.00000000000044, 43.10000000000001, -50.00000000000044, 36.70000000000003, 26.299999999999933, 46.099999999999994, -50.00000000000044, 47.9, 6.699999999999655, 43.10000000000001, 43.30000000000001, 22.299999999999876, 43.7, -50.00000000000044, 33.30000000000003, 40.70000000000002, 42.30000000000001, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, 35.70000000000003, 44.900000000000006, 45.1, 44.5, 45.1, 44.5, 34.50000000000004, 44.900000000000006, 43.50000000000001, 43.50000000000001, 15.299999999999777, 43.7, -50.00000000000044, 45.5, -50.00000000000044, 36.900000000000034, 31.70000000000001, 41.100000000000016, -50.00000000000044, 44.10000000000001, 38.50000000000003, 40.30000000000002, -50.00000000000044, 44.10000000000001, -50.00000000000044, 32.50000000000002, 18.099999999999817, 40.30000000000002, -50.00000000000044, 38.10000000000002, -50.00000000000044, 43.10000000000001, 39.300000000000026, 42.500000000000014, 0.09999999999956088, 41.30000000000001, 17.099999999999802, 23.29999999999989, -50.00000000000044, 17.099999999999802, 43.900000000000006, 40.30000000000002, 44.10000000000001, 28.699999999999967, 26.69999999999994, 31.300000000000004, -50.00000000000044, -50.00000000000044, 42.30000000000001, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.500000000000007, 17.69999999999981, -50.00000000000044], "episode_lengths": [42, 62, 500, 500, 374, 500, 56, 28, 500, 180, 70, 146, 66, 500, 500, 184, 170, 58, 500, 70, 500, 134, 238, 40, 500, 22, 434, 70, 68, 278, 64, 500, 168, 94, 78, 124, 500, 500, 500, 86, 500, 500, 144, 52, 50, 56, 50, 56, 156, 52, 66, 66, 348, 64, 500, 46, 500, 132, 184, 90, 500, 60, 116, 98, 500, 60, 500, 176, 320, 98, 500, 120, 500, 70, 108, 76, 500, 88, 330, 268, 500, 330, 62, 98, 60, 214, 234, 188, 500, 500, 78, 52, 500, 500, 500, 500, 500, 186, 324, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3775370824832703, "mean_inference_ms": 1.2062789038498247, "mean_action_processing_ms": 0.1401466688981846, "mean_env_wait_ms": 0.08318925710519588, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03102278709411621, "StateBufferConnector_ms": 0.008996725082397461, "ViewRequirementAgentConnector_ms": 0.130997896194458}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 666000, "num_agent_steps_trained": 666000, "num_env_steps_sampled": 666000, "num_env_steps_trained": 666000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5773.135256929944, "num_env_steps_trained_throughput_per_sec": 5773.135256929944, "timesteps_total": 666000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 666000, "timers": {"training_iteration_time_ms": 3191.748, "sample_time_ms": 2827.891, "load_time_ms": 18.704, "load_throughput": 962367.887, "learn_time_ms": 333.575, "learn_throughput": 53960.915, "synch_weights_time_ms": 9.274}, "counters": {"num_env_steps_sampled": 666000, "num_env_steps_trained": 666000, "num_agent_steps_sampled": 666000, "num_agent_steps_trained": 666000}, "done": false, "episodes_total": 2531, "training_iteration": 37, "trial_id": "9f288_00015", "date": "2023-10-25_16-48-40", "timestamp": 1698248920, "time_this_iter_s": 3.1228842735290527, "time_total_s": 118.84734416007996, "pid": 4200, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 118.84734416007996, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 57.67999999999999, "ram_util_percent": 27.32}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.4551915228366855e-12, "cur_lr": 0.0003, "total_loss": 6.763293886184693, "policy_loss": -0.031187832728028296, "vf_loss": 6.7945366382598875, "vf_explained_var": -4.6193599700927734e-07, "kl": 0.0003460067970536329, "entropy": 0.5490737378597259, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 750.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000}, "sampler_results": {"episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.104999999999833, "episode_len_mean": 264.62, "episode_media": {}, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.50000000000002, 18.099999999999817, 40.30000000000002, -50.00000000000044, 38.10000000000002, -50.00000000000044, 43.10000000000001, 39.300000000000026, 42.500000000000014, 0.09999999999956088, 41.30000000000001, 17.099999999999802, 23.29999999999989, -50.00000000000044, 17.099999999999802, 43.900000000000006, 40.30000000000002, 44.10000000000001, 28.699999999999967, 26.69999999999994, 31.300000000000004, -50.00000000000044, -50.00000000000044, 42.30000000000001, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.500000000000007, 17.69999999999981, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 44.5, 37.70000000000003, -50.00000000000044, 25.099999999999916, 43.900000000000006, 39.10000000000002, 29.099999999999973, 42.70000000000001, 42.70000000000001, 34.70000000000004, 2.499999999999595, -50.00000000000044, -50.00000000000044, 46.5, 41.30000000000001, 46.099999999999994, 44.5, 44.300000000000004, 40.500000000000014, -50.00000000000044, -50.00000000000044, 15.299999999999777, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, 33.10000000000003, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, 42.70000000000001, 25.099999999999916, 31.500000000000007, -50.00000000000044, 35.500000000000036, 45.5, 32.90000000000003, 45.5, 42.30000000000001, 39.50000000000002, 39.50000000000002, 36.30000000000003, 44.7, 25.099999999999916, 40.90000000000002, 8.299999999999677, -50.00000000000044, 43.7, 38.300000000000026, 42.10000000000001, 36.70000000000003, 24.899999999999913, -50.00000000000044, 41.500000000000014, 38.700000000000024, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044], "episode_lengths": [176, 320, 98, 500, 120, 500, 70, 108, 76, 500, 88, 330, 268, 500, 330, 62, 98, 60, 214, 234, 188, 500, 500, 78, 52, 500, 500, 500, 500, 500, 186, 324, 500, 500, 84, 500, 56, 124, 500, 250, 62, 110, 210, 74, 74, 154, 476, 500, 500, 36, 88, 40, 56, 58, 96, 500, 500, 348, 500, 500, 500, 500, 500, 96, 500, 170, 90, 500, 500, 500, 118, 74, 250, 186, 500, 146, 46, 172, 46, 78, 106, 106, 138, 54, 250, 92, 418, 500, 64, 118, 80, 134, 252, 500, 86, 114, 500, 102, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3778341417702133, "mean_inference_ms": 1.207352308133703, "mean_action_processing_ms": 0.14021705239405, "mean_env_wait_ms": 0.08273320920609761, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02699875831604004, "StateBufferConnector_ms": 0.008000612258911133, "ViewRequirementAgentConnector_ms": 0.11698484420776367}}, "episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.104999999999833, "episode_len_mean": 264.62, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [32.50000000000002, 18.099999999999817, 40.30000000000002, -50.00000000000044, 38.10000000000002, -50.00000000000044, 43.10000000000001, 39.300000000000026, 42.500000000000014, 0.09999999999956088, 41.30000000000001, 17.099999999999802, 23.29999999999989, -50.00000000000044, 17.099999999999802, 43.900000000000006, 40.30000000000002, 44.10000000000001, 28.699999999999967, 26.69999999999994, 31.300000000000004, -50.00000000000044, -50.00000000000044, 42.30000000000001, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.500000000000007, 17.69999999999981, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 44.5, 37.70000000000003, -50.00000000000044, 25.099999999999916, 43.900000000000006, 39.10000000000002, 29.099999999999973, 42.70000000000001, 42.70000000000001, 34.70000000000004, 2.499999999999595, -50.00000000000044, -50.00000000000044, 46.5, 41.30000000000001, 46.099999999999994, 44.5, 44.300000000000004, 40.500000000000014, -50.00000000000044, -50.00000000000044, 15.299999999999777, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, 33.10000000000003, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, 42.70000000000001, 25.099999999999916, 31.500000000000007, -50.00000000000044, 35.500000000000036, 45.5, 32.90000000000003, 45.5, 42.30000000000001, 39.50000000000002, 39.50000000000002, 36.30000000000003, 44.7, 25.099999999999916, 40.90000000000002, 8.299999999999677, -50.00000000000044, 43.7, 38.300000000000026, 42.10000000000001, 36.70000000000003, 24.899999999999913, -50.00000000000044, 41.500000000000014, 38.700000000000024, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044], "episode_lengths": [176, 320, 98, 500, 120, 500, 70, 108, 76, 500, 88, 330, 268, 500, 330, 62, 98, 60, 214, 234, 188, 500, 500, 78, 52, 500, 500, 500, 500, 500, 186, 324, 500, 500, 84, 500, 56, 124, 500, 250, 62, 110, 210, 74, 74, 154, 476, 500, 500, 36, 88, 40, 56, 58, 96, 500, 500, 348, 500, 500, 500, 500, 500, 96, 500, 170, 90, 500, 500, 500, 118, 74, 250, 186, 500, 146, 46, 172, 46, 78, 106, 106, 138, 54, 250, 92, 418, 500, 64, 118, 80, 134, 252, 500, 86, 114, 500, 102, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3778341417702133, "mean_inference_ms": 1.207352308133703, "mean_action_processing_ms": 0.14021705239405, "mean_env_wait_ms": 0.08273320920609761, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02699875831604004, "StateBufferConnector_ms": 0.008000612258911133, "ViewRequirementAgentConnector_ms": 0.11698484420776367}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000, "num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5613.916614262161, "num_env_steps_trained_throughput_per_sec": 5613.916614262161, "timesteps_total": 684000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 684000, "timers": {"training_iteration_time_ms": 3194.31, "sample_time_ms": 2835.593, "load_time_ms": 17.602, "load_throughput": 1022618.533, "learn_time_ms": 329.472, "learn_throughput": 54632.829, "synch_weights_time_ms": 9.338}, "counters": {"num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000}, "done": false, "episodes_total": 2598, "training_iteration": 38, "trial_id": "9f288_00015", "date": "2023-10-25_16-48-44", "timestamp": 1698248924, "time_this_iter_s": 3.212312698364258, "time_total_s": 122.05965685844421, "pid": 4200, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 122.05965685844421, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 63.324999999999996, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.275957614183427e-13, "cur_lr": 0.0003, "total_loss": 6.86504909992218, "policy_loss": -0.028745470754802226, "vf_loss": 6.893849897384643, "vf_explained_var": -1.4275312423706054e-06, "kl": 0.000354623202005655, "entropy": 0.5521491527557373, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 770.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 702000, "num_env_steps_trained": 702000, "num_agent_steps_sampled": 702000, "num_agent_steps_trained": 702000}, "sampler_results": {"episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.855999999999831, "episode_len_mean": 262.1, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 38.300000000000026, 42.70000000000001, 25.099999999999916, 31.500000000000007, -50.00000000000044, 35.500000000000036, 45.5, 32.90000000000003, 45.5, 42.30000000000001, 39.50000000000002, 39.50000000000002, 36.30000000000003, 44.7, 25.099999999999916, 40.90000000000002, 8.299999999999677, -50.00000000000044, 43.7, 38.300000000000026, 42.10000000000001, 36.70000000000003, 24.899999999999913, -50.00000000000044, 41.500000000000014, 38.700000000000024, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 43.50000000000001, -50.00000000000044, -50.00000000000044, 43.10000000000001, 44.300000000000004, 35.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 37.50000000000003, 44.900000000000006, 43.900000000000006, 45.1, -50.00000000000044, 45.5, 31.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 1.299999999999578, 10.099999999999703, 28.29999999999996, 46.099999999999994, -50.00000000000044, -50.00000000000044, 22.899999999999885, 43.50000000000001, -50.00000000000044, 42.30000000000001, -50.00000000000044, 43.900000000000006, 2.299999999999592, 22.699999999999882, 37.300000000000026, 22.699999999999882, 44.5, -50.00000000000044, 40.70000000000002, 41.100000000000016, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 26.299999999999933, 41.30000000000001, 39.50000000000002, 35.70000000000003, -50.00000000000044, -50.00000000000044, 14.09999999999976, 41.30000000000001, 44.300000000000004, 29.099999999999973, 18.699999999999825, 45.3, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 43.7, 36.10000000000004], "episode_lengths": [500, 500, 118, 74, 250, 186, 500, 146, 46, 172, 46, 78, 106, 106, 138, 54, 250, 92, 418, 500, 64, 118, 80, 134, 252, 500, 86, 114, 500, 102, 500, 500, 500, 40, 66, 500, 500, 70, 58, 150, 500, 500, 500, 38, 126, 52, 62, 50, 500, 46, 184, 500, 500, 500, 488, 400, 218, 40, 500, 500, 272, 66, 500, 78, 500, 62, 478, 274, 128, 274, 56, 500, 94, 90, 500, 56, 500, 500, 500, 56, 500, 238, 88, 106, 144, 500, 500, 360, 88, 58, 210, 314, 48, 500, 500, 50, 500, 500, 64, 140]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37778073900903336, "mean_inference_ms": 1.2077305149283157, "mean_action_processing_ms": 0.14031302386739988, "mean_env_wait_ms": 0.08284636273135013, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021999359130859375, "StateBufferConnector_ms": 0.00600123405456543, "ViewRequirementAgentConnector_ms": 0.11500740051269531}}, "episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.855999999999831, "episode_len_mean": 262.1, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 38.300000000000026, 42.70000000000001, 25.099999999999916, 31.500000000000007, -50.00000000000044, 35.500000000000036, 45.5, 32.90000000000003, 45.5, 42.30000000000001, 39.50000000000002, 39.50000000000002, 36.30000000000003, 44.7, 25.099999999999916, 40.90000000000002, 8.299999999999677, -50.00000000000044, 43.7, 38.300000000000026, 42.10000000000001, 36.70000000000003, 24.899999999999913, -50.00000000000044, 41.500000000000014, 38.700000000000024, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 43.50000000000001, -50.00000000000044, -50.00000000000044, 43.10000000000001, 44.300000000000004, 35.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 37.50000000000003, 44.900000000000006, 43.900000000000006, 45.1, -50.00000000000044, 45.5, 31.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 1.299999999999578, 10.099999999999703, 28.29999999999996, 46.099999999999994, -50.00000000000044, -50.00000000000044, 22.899999999999885, 43.50000000000001, -50.00000000000044, 42.30000000000001, -50.00000000000044, 43.900000000000006, 2.299999999999592, 22.699999999999882, 37.300000000000026, 22.699999999999882, 44.5, -50.00000000000044, 40.70000000000002, 41.100000000000016, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 26.299999999999933, 41.30000000000001, 39.50000000000002, 35.70000000000003, -50.00000000000044, -50.00000000000044, 14.09999999999976, 41.30000000000001, 44.300000000000004, 29.099999999999973, 18.699999999999825, 45.3, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 43.7, 36.10000000000004], "episode_lengths": [500, 500, 118, 74, 250, 186, 500, 146, 46, 172, 46, 78, 106, 106, 138, 54, 250, 92, 418, 500, 64, 118, 80, 134, 252, 500, 86, 114, 500, 102, 500, 500, 500, 40, 66, 500, 500, 70, 58, 150, 500, 500, 500, 38, 126, 52, 62, 50, 500, 46, 184, 500, 500, 500, 488, 400, 218, 40, 500, 500, 272, 66, 500, 78, 500, 62, 478, 274, 128, 274, 56, 500, 94, 90, 500, 56, 500, 500, 500, 56, 500, 238, 88, 106, 144, 500, 500, 360, 88, 58, 210, 314, 48, 500, 500, 50, 500, 500, 64, 140]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37778073900903336, "mean_inference_ms": 1.2077305149283157, "mean_action_processing_ms": 0.14031302386739988, "mean_env_wait_ms": 0.08284636273135013, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021999359130859375, "StateBufferConnector_ms": 0.00600123405456543, "ViewRequirementAgentConnector_ms": 0.11500740051269531}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 702000, "num_agent_steps_trained": 702000, "num_env_steps_sampled": 702000, "num_env_steps_trained": 702000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5312.491344922974, "num_env_steps_trained_throughput_per_sec": 5312.491344922974, "timesteps_total": 702000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 702000, "timers": {"training_iteration_time_ms": 3209.556, "sample_time_ms": 2847.947, "load_time_ms": 18.502, "load_throughput": 972849.152, "learn_time_ms": 331.562, "learn_throughput": 54288.521, "synch_weights_time_ms": 9.141}, "counters": {"num_env_steps_sampled": 702000, "num_env_steps_trained": 702000, "num_agent_steps_sampled": 702000, "num_agent_steps_trained": 702000}, "done": false, "episodes_total": 2666, "training_iteration": 39, "trial_id": "9f288_00015", "date": "2023-10-25_16-48-47", "timestamp": 1698248927, "time_this_iter_s": 3.3942744731903076, "time_total_s": 125.45393133163452, "pid": 4200, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 125.45393133163452, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 57.9, "ram_util_percent": 27.32}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.6379788070917137e-13, "cur_lr": 0.0003, "total_loss": 7.075979113578796, "policy_loss": 0.04523380286991596, "vf_loss": 7.030802869796753, "vf_explained_var": -4.023313522338867e-07, "kl": 0.00045053988135350663, "entropy": 0.5753382056951523, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 790.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.973999999999844, "episode_len_mean": 250.94, "episode_media": {}, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 26.299999999999933, 41.30000000000001, 39.50000000000002, 35.70000000000003, -50.00000000000044, -50.00000000000044, 14.09999999999976, 41.30000000000001, 44.300000000000004, 29.099999999999973, 18.699999999999825, 45.3, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 43.7, 36.10000000000004, -50.00000000000044, 43.30000000000001, 44.10000000000001, -50.00000000000044, 40.90000000000002, -50.00000000000044, 42.70000000000001, 45.7, 44.900000000000006, 34.900000000000034, 42.900000000000006, -50.00000000000044, -50.00000000000044, 35.900000000000034, 20.899999999999856, 21.499999999999865, 46.5, 8.299999999999677, 31.70000000000001, -50.00000000000044, 23.29999999999989, -50.00000000000044, -50.00000000000044, 44.300000000000004, 40.70000000000002, 37.90000000000003, 44.5, -50.00000000000044, -50.00000000000044, 43.10000000000001, 43.7, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.299999999999947, 41.30000000000001, 46.699999999999996, 27.099999999999945, 45.3, 26.89999999999994, 39.50000000000002, -50.00000000000044, -50.00000000000044, 45.5, 43.900000000000006, -50.00000000000044, 37.70000000000003, 25.499999999999922, 24.499999999999908, 20.49999999999985, -50.00000000000044, 38.90000000000002, 40.90000000000002, 43.900000000000006, 28.699999999999967, 40.500000000000014, 37.90000000000003, 45.3, 41.500000000000014, 42.70000000000001, 41.90000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.69999999999981, 34.70000000000004, 42.500000000000014, -50.00000000000044, 29.899999999999984, 23.499999999999893, 43.7, 33.500000000000036, 39.90000000000002], "episode_lengths": [500, 500, 500, 56, 500, 238, 88, 106, 144, 500, 500, 360, 88, 58, 210, 314, 48, 500, 500, 50, 500, 500, 64, 140, 500, 68, 60, 500, 92, 500, 74, 44, 52, 152, 72, 500, 500, 142, 292, 286, 36, 418, 184, 500, 268, 500, 500, 58, 94, 122, 56, 500, 500, 70, 64, 48, 500, 500, 500, 500, 228, 88, 34, 230, 48, 232, 106, 500, 500, 46, 62, 500, 124, 246, 256, 296, 500, 112, 92, 62, 214, 96, 122, 48, 86, 74, 82, 40, 500, 500, 500, 324, 154, 76, 500, 202, 266, 64, 166, 102]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37743136180264775, "mean_inference_ms": 1.20597248815024, "mean_action_processing_ms": 0.14031006615732455, "mean_env_wait_ms": 0.08308414020158848, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029995203018188477, "StateBufferConnector_ms": 0.002997159957885742, "ViewRequirementAgentConnector_ms": 0.12499833106994629}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.973999999999844, "episode_len_mean": 250.94, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 26.299999999999933, 41.30000000000001, 39.50000000000002, 35.70000000000003, -50.00000000000044, -50.00000000000044, 14.09999999999976, 41.30000000000001, 44.300000000000004, 29.099999999999973, 18.699999999999825, 45.3, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 43.7, 36.10000000000004, -50.00000000000044, 43.30000000000001, 44.10000000000001, -50.00000000000044, 40.90000000000002, -50.00000000000044, 42.70000000000001, 45.7, 44.900000000000006, 34.900000000000034, 42.900000000000006, -50.00000000000044, -50.00000000000044, 35.900000000000034, 20.899999999999856, 21.499999999999865, 46.5, 8.299999999999677, 31.70000000000001, -50.00000000000044, 23.29999999999989, -50.00000000000044, -50.00000000000044, 44.300000000000004, 40.70000000000002, 37.90000000000003, 44.5, -50.00000000000044, -50.00000000000044, 43.10000000000001, 43.7, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.299999999999947, 41.30000000000001, 46.699999999999996, 27.099999999999945, 45.3, 26.89999999999994, 39.50000000000002, -50.00000000000044, -50.00000000000044, 45.5, 43.900000000000006, -50.00000000000044, 37.70000000000003, 25.499999999999922, 24.499999999999908, 20.49999999999985, -50.00000000000044, 38.90000000000002, 40.90000000000002, 43.900000000000006, 28.699999999999967, 40.500000000000014, 37.90000000000003, 45.3, 41.500000000000014, 42.70000000000001, 41.90000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.69999999999981, 34.70000000000004, 42.500000000000014, -50.00000000000044, 29.899999999999984, 23.499999999999893, 43.7, 33.500000000000036, 39.90000000000002], "episode_lengths": [500, 500, 500, 56, 500, 238, 88, 106, 144, 500, 500, 360, 88, 58, 210, 314, 48, 500, 500, 50, 500, 500, 64, 140, 500, 68, 60, 500, 92, 500, 74, 44, 52, 152, 72, 500, 500, 142, 292, 286, 36, 418, 184, 500, 268, 500, 500, 58, 94, 122, 56, 500, 500, 70, 64, 48, 500, 500, 500, 500, 228, 88, 34, 230, 48, 232, 106, 500, 500, 46, 62, 500, 124, 246, 256, 296, 500, 112, 92, 62, 214, 96, 122, 48, 86, 74, 82, 40, 500, 500, 500, 324, 154, 76, 500, 202, 266, 64, 166, 102]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37743136180264775, "mean_inference_ms": 1.20597248815024, "mean_action_processing_ms": 0.14031006615732455, "mean_env_wait_ms": 0.08308414020158848, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029995203018188477, "StateBufferConnector_ms": 0.002997159957885742, "ViewRequirementAgentConnector_ms": 0.12499833106994629}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5811.610230962663, "num_env_steps_trained_throughput_per_sec": 5811.610230962663, "timesteps_total": 720000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 720000, "timers": {"training_iteration_time_ms": 3197.848, "sample_time_ms": 2836.697, "load_time_ms": 18.229, "load_throughput": 987425.558, "learn_time_ms": 331.121, "learn_throughput": 54360.868, "synch_weights_time_ms": 9.297}, "counters": {"num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "done": false, "episodes_total": 2742, "training_iteration": 40, "trial_id": "9f288_00015", "date": "2023-10-25_16-48-50", "timestamp": 1698248930, "time_this_iter_s": 3.1022472381591797, "time_total_s": 128.5561785697937, "pid": 4200, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 128.5561785697937, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 57.75, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.8189894035458568e-13, "cur_lr": 0.0003, "total_loss": 6.813942933082581, "policy_loss": -0.010753504186868667, "vf_loss": 6.8247534275054935, "vf_explained_var": -1.1026859283447266e-07, "kl": 0.001159236282137499, "entropy": 0.5695605963468552, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 810.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 738000, "num_env_steps_trained": 738000, "num_agent_steps_sampled": 738000, "num_agent_steps_trained": 738000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.064999999999866, "episode_len_mean": 225.06, "episode_media": {}, "episodes_this_iter": 78, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.90000000000002, 43.900000000000006, 28.699999999999967, 40.500000000000014, 37.90000000000003, 45.3, 41.500000000000014, 42.70000000000001, 41.90000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.69999999999981, 34.70000000000004, 42.500000000000014, -50.00000000000044, 29.899999999999984, 23.499999999999893, 43.7, 33.500000000000036, 39.90000000000002, 29.899999999999984, 40.30000000000002, 37.10000000000003, 7.299999999999663, 35.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 45.1, 45.5, 44.5, 44.900000000000006, 43.50000000000001, -50.00000000000044, 47.3, 43.10000000000001, -50.00000000000044, 39.50000000000002, 44.300000000000004, 41.100000000000016, 45.9, 39.70000000000002, -50.00000000000044, 42.900000000000006, -50.00000000000044, 38.700000000000024, -50.00000000000044, -50.00000000000044, 34.70000000000004, -50.00000000000044, -50.00000000000044, 42.500000000000014, 44.300000000000004, 43.50000000000001, 43.900000000000006, -50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 45.1, 44.7, 44.5, 39.10000000000002, 29.49999999999998, -50.00000000000044, 21.299999999999862, 31.70000000000001, -50.00000000000044, 46.9, 44.10000000000001, 25.899999999999928, 28.09999999999996, -50.00000000000044, 42.500000000000014, 38.10000000000002, -50.00000000000044, 45.1, 47.5, 47.1, 44.7, 44.7, -50.00000000000044, 24.299999999999905, -50.00000000000044, 25.699999999999925, 43.50000000000001, 45.9, 14.09999999999976, 45.9, -50.00000000000044, -50.00000000000044, 37.10000000000003, 42.10000000000001, -50.00000000000044], "episode_lengths": [92, 62, 214, 96, 122, 48, 86, 74, 82, 40, 500, 500, 500, 324, 154, 76, 500, 202, 266, 64, 166, 102, 202, 98, 130, 428, 142, 500, 500, 500, 66, 50, 46, 56, 52, 66, 500, 28, 70, 500, 106, 58, 90, 42, 104, 500, 72, 500, 114, 500, 500, 154, 500, 500, 76, 58, 66, 62, 500, 96, 500, 500, 70, 500, 500, 50, 54, 56, 110, 206, 500, 288, 184, 500, 32, 60, 242, 220, 500, 76, 120, 500, 50, 26, 30, 54, 54, 500, 258, 500, 244, 66, 42, 360, 42, 500, 500, 130, 80, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37717454117698607, "mean_inference_ms": 1.2053801299479405, "mean_action_processing_ms": 0.14021186823955023, "mean_env_wait_ms": 0.08287362209144454, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02799701690673828, "StateBufferConnector_ms": 0.0030057430267333984, "ViewRequirementAgentConnector_ms": 0.10400724411010742}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.064999999999866, "episode_len_mean": 225.06, "episodes_this_iter": 78, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [40.90000000000002, 43.900000000000006, 28.699999999999967, 40.500000000000014, 37.90000000000003, 45.3, 41.500000000000014, 42.70000000000001, 41.90000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.69999999999981, 34.70000000000004, 42.500000000000014, -50.00000000000044, 29.899999999999984, 23.499999999999893, 43.7, 33.500000000000036, 39.90000000000002, 29.899999999999984, 40.30000000000002, 37.10000000000003, 7.299999999999663, 35.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 45.1, 45.5, 44.5, 44.900000000000006, 43.50000000000001, -50.00000000000044, 47.3, 43.10000000000001, -50.00000000000044, 39.50000000000002, 44.300000000000004, 41.100000000000016, 45.9, 39.70000000000002, -50.00000000000044, 42.900000000000006, -50.00000000000044, 38.700000000000024, -50.00000000000044, -50.00000000000044, 34.70000000000004, -50.00000000000044, -50.00000000000044, 42.500000000000014, 44.300000000000004, 43.50000000000001, 43.900000000000006, -50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 45.1, 44.7, 44.5, 39.10000000000002, 29.49999999999998, -50.00000000000044, 21.299999999999862, 31.70000000000001, -50.00000000000044, 46.9, 44.10000000000001, 25.899999999999928, 28.09999999999996, -50.00000000000044, 42.500000000000014, 38.10000000000002, -50.00000000000044, 45.1, 47.5, 47.1, 44.7, 44.7, -50.00000000000044, 24.299999999999905, -50.00000000000044, 25.699999999999925, 43.50000000000001, 45.9, 14.09999999999976, 45.9, -50.00000000000044, -50.00000000000044, 37.10000000000003, 42.10000000000001, -50.00000000000044], "episode_lengths": [92, 62, 214, 96, 122, 48, 86, 74, 82, 40, 500, 500, 500, 324, 154, 76, 500, 202, 266, 64, 166, 102, 202, 98, 130, 428, 142, 500, 500, 500, 66, 50, 46, 56, 52, 66, 500, 28, 70, 500, 106, 58, 90, 42, 104, 500, 72, 500, 114, 500, 500, 154, 500, 500, 76, 58, 66, 62, 500, 96, 500, 500, 70, 500, 500, 50, 54, 56, 110, 206, 500, 288, 184, 500, 32, 60, 242, 220, 500, 76, 120, 500, 50, 26, 30, 54, 54, 500, 258, 500, 244, 66, 42, 360, 42, 500, 500, 130, 80, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37717454117698607, "mean_inference_ms": 1.2053801299479405, "mean_action_processing_ms": 0.14021186823955023, "mean_env_wait_ms": 0.08287362209144454, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02799701690673828, "StateBufferConnector_ms": 0.0030057430267333984, "ViewRequirementAgentConnector_ms": 0.10400724411010742}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 738000, "num_agent_steps_trained": 738000, "num_env_steps_sampled": 738000, "num_env_steps_trained": 738000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5548.267019768733, "num_env_steps_trained_throughput_per_sec": 5548.267019768733, "timesteps_total": 738000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 738000, "timers": {"training_iteration_time_ms": 3207.57, "sample_time_ms": 2836.828, "load_time_ms": 17.846, "load_throughput": 1008655.651, "learn_time_ms": 341.41, "learn_throughput": 52722.53, "synch_weights_time_ms": 9.086}, "counters": {"num_env_steps_sampled": 738000, "num_env_steps_trained": 738000, "num_agent_steps_sampled": 738000, "num_agent_steps_trained": 738000}, "done": false, "episodes_total": 2820, "training_iteration": 41, "trial_id": "9f288_00015", "date": "2023-10-25_16-48-53", "timestamp": 1698248933, "time_this_iter_s": 3.2502551078796387, "time_total_s": 131.80643367767334, "pid": 4200, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 131.80643367767334, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 57.239999999999995, "ram_util_percent": 27.32}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.094947017729284e-14, "cur_lr": 0.0003, "total_loss": 6.846089148521424, "policy_loss": -0.03384456969797611, "vf_loss": 6.879984259605408, "vf_explained_var": -2.2470951080322267e-06, "kl": 0.0013608876528223846, "entropy": 0.5057045951485634, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 830.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.844999999999848, "episode_len_mean": 237.26, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 21.299999999999862, 31.70000000000001, -50.00000000000044, 46.9, 44.10000000000001, 25.899999999999928, 28.09999999999996, -50.00000000000044, 42.500000000000014, 38.10000000000002, -50.00000000000044, 45.1, 47.5, 47.1, 44.7, 44.7, -50.00000000000044, 24.299999999999905, -50.00000000000044, 25.699999999999925, 43.50000000000001, 45.9, 14.09999999999976, 45.9, -50.00000000000044, -50.00000000000044, 37.10000000000003, 42.10000000000001, -50.00000000000044, 21.09999999999986, 46.5, 45.3, 43.30000000000001, 3.2999999999996064, 42.70000000000001, 27.099999999999945, 43.30000000000001, 45.7, 44.900000000000006, 47.3, -50.00000000000044, -50.00000000000044, 47.1, 45.3, 42.30000000000001, 39.10000000000002, -50.00000000000044, 14.299999999999763, 42.900000000000006, 42.30000000000001, 38.300000000000026, 30.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, -50.00000000000044, 45.1, 44.10000000000001, -50.00000000000044, 35.30000000000004, 8.899999999999686, 45.1, 46.099999999999994, -50.00000000000044, -50.00000000000044, 41.70000000000002, 43.30000000000001, -50.00000000000044, 46.099999999999994, -50.00000000000044, 28.499999999999964, -50.00000000000044, 9.8999999999997, -50.00000000000044, 43.900000000000006, 14.899999999999771, 24.899999999999913, 45.7, 42.900000000000006, -50.00000000000044, 45.9, 43.7, -50.00000000000044, 33.70000000000004, -50.00000000000044, 41.90000000000001, 45.3, 44.7, 44.5, -50.00000000000044, 41.100000000000016, 28.499999999999964, 44.5, 14.499999999999766, 23.499999999999893, 41.30000000000001, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 288, 184, 500, 32, 60, 242, 220, 500, 76, 120, 500, 50, 26, 30, 54, 54, 500, 258, 500, 244, 66, 42, 360, 42, 500, 500, 130, 80, 500, 290, 36, 48, 68, 468, 74, 230, 68, 44, 52, 28, 500, 500, 30, 48, 78, 110, 500, 358, 72, 78, 118, 194, 500, 500, 500, 142, 500, 50, 60, 500, 148, 412, 50, 40, 500, 500, 84, 68, 500, 40, 500, 216, 500, 402, 500, 62, 352, 252, 44, 72, 500, 42, 64, 500, 164, 500, 82, 48, 54, 56, 500, 90, 216, 56, 356, 266, 88, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3773288571000167, "mean_inference_ms": 1.2058227883889425, "mean_action_processing_ms": 0.1404496573598034, "mean_env_wait_ms": 0.08268035460013431, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016004085540771484, "StateBufferConnector_ms": 0.0030014514923095703, "ViewRequirementAgentConnector_ms": 0.11400699615478516}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.844999999999848, "episode_len_mean": 237.26, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 21.299999999999862, 31.70000000000001, -50.00000000000044, 46.9, 44.10000000000001, 25.899999999999928, 28.09999999999996, -50.00000000000044, 42.500000000000014, 38.10000000000002, -50.00000000000044, 45.1, 47.5, 47.1, 44.7, 44.7, -50.00000000000044, 24.299999999999905, -50.00000000000044, 25.699999999999925, 43.50000000000001, 45.9, 14.09999999999976, 45.9, -50.00000000000044, -50.00000000000044, 37.10000000000003, 42.10000000000001, -50.00000000000044, 21.09999999999986, 46.5, 45.3, 43.30000000000001, 3.2999999999996064, 42.70000000000001, 27.099999999999945, 43.30000000000001, 45.7, 44.900000000000006, 47.3, -50.00000000000044, -50.00000000000044, 47.1, 45.3, 42.30000000000001, 39.10000000000002, -50.00000000000044, 14.299999999999763, 42.900000000000006, 42.30000000000001, 38.300000000000026, 30.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, -50.00000000000044, 45.1, 44.10000000000001, -50.00000000000044, 35.30000000000004, 8.899999999999686, 45.1, 46.099999999999994, -50.00000000000044, -50.00000000000044, 41.70000000000002, 43.30000000000001, -50.00000000000044, 46.099999999999994, -50.00000000000044, 28.499999999999964, -50.00000000000044, 9.8999999999997, -50.00000000000044, 43.900000000000006, 14.899999999999771, 24.899999999999913, 45.7, 42.900000000000006, -50.00000000000044, 45.9, 43.7, -50.00000000000044, 33.70000000000004, -50.00000000000044, 41.90000000000001, 45.3, 44.7, 44.5, -50.00000000000044, 41.100000000000016, 28.499999999999964, 44.5, 14.499999999999766, 23.499999999999893, 41.30000000000001, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 288, 184, 500, 32, 60, 242, 220, 500, 76, 120, 500, 50, 26, 30, 54, 54, 500, 258, 500, 244, 66, 42, 360, 42, 500, 500, 130, 80, 500, 290, 36, 48, 68, 468, 74, 230, 68, 44, 52, 28, 500, 500, 30, 48, 78, 110, 500, 358, 72, 78, 118, 194, 500, 500, 500, 142, 500, 50, 60, 500, 148, 412, 50, 40, 500, 500, 84, 68, 500, 40, 500, 216, 500, 402, 500, 62, 352, 252, 44, 72, 500, 42, 64, 500, 164, 500, 82, 48, 54, 56, 500, 90, 216, 56, 356, 266, 88, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3773288571000167, "mean_inference_ms": 1.2058227883889425, "mean_action_processing_ms": 0.1404496573598034, "mean_env_wait_ms": 0.08268035460013431, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016004085540771484, "StateBufferConnector_ms": 0.0030014514923095703, "ViewRequirementAgentConnector_ms": 0.11400699615478516}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000, "num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5561.190986237691, "num_env_steps_trained_throughput_per_sec": 5561.190986237691, "timesteps_total": 756000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 756000, "timers": {"training_iteration_time_ms": 3219.286, "sample_time_ms": 2846.145, "load_time_ms": 17.867, "load_throughput": 1007425.468, "learn_time_ms": 343.787, "learn_throughput": 52358.04, "synch_weights_time_ms": 9.086}, "counters": {"num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000}, "done": false, "episodes_total": 2890, "training_iteration": 42, "trial_id": "9f288_00015", "date": "2023-10-25_16-48-57", "timestamp": 1698248937, "time_this_iter_s": 3.2415387630462646, "time_total_s": 135.0479724407196, "pid": 4200, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 135.0479724407196, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 53.52, "ram_util_percent": 27.26}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.547473508864642e-14, "cur_lr": 0.0003, "total_loss": 7.369437861442566, "policy_loss": -0.014248456805944443, "vf_loss": 7.383737063407898, "vf_explained_var": -4.76837158203125e-08, "kl": 0.0005864594777335696, "entropy": 0.5083690956234932, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 850.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 774000, "num_env_steps_trained": 774000, "num_agent_steps_sampled": 774000, "num_agent_steps_trained": 774000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 16.541999999999877, "episode_len_mean": 215.34, "episode_media": {}, "episodes_this_iter": 87, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.90000000000001, 45.3, 44.7, 44.5, -50.00000000000044, 41.100000000000016, 28.499999999999964, 44.5, 14.499999999999766, 23.499999999999893, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 13.299999999999748, 31.70000000000001, 46.099999999999994, 37.10000000000003, 46.5, 42.70000000000001, 32.50000000000002, -50.00000000000044, 41.500000000000014, 46.9, 16.699999999999797, 30.29999999999999, 40.500000000000014, 29.49999999999998, 42.900000000000006, 24.69999999999991, -50.00000000000044, 39.90000000000002, 34.50000000000004, 44.7, 31.70000000000001, -50.00000000000044, 18.499999999999822, -50.00000000000044, 46.099999999999994, 39.300000000000026, -50.00000000000044, 35.10000000000004, 43.50000000000001, 46.5, 44.7, 24.899999999999913, 44.10000000000001, 47.7, 44.300000000000004, 46.3, 41.100000000000016, 42.500000000000014, -50.00000000000044, 44.900000000000006, -50.00000000000044, 47.1, 35.500000000000036, 32.700000000000024, 12.899999999999743, -50.00000000000044, 45.1, -50.00000000000044, 44.900000000000006, 47.5, 45.1, 36.900000000000034, 39.70000000000002, 41.90000000000001, 45.7, -50.00000000000044, 36.10000000000004, -50.00000000000044, 35.30000000000004, -50.00000000000044, -50.00000000000044, 45.7, 42.10000000000001, 46.9, 18.699999999999825, -50.00000000000044, -50.00000000000044, 11.29999999999972, 37.90000000000003, -50.00000000000044, -50.00000000000044, 44.7, 44.7, 41.30000000000001, 32.700000000000024, 41.500000000000014, -50.00000000000044, 14.899999999999771, 45.9, 25.699999999999925, -50.00000000000044, 34.70000000000004, -50.00000000000044, 45.1, 35.30000000000004], "episode_lengths": [82, 48, 54, 56, 500, 90, 216, 56, 356, 266, 88, 500, 500, 500, 44, 368, 184, 40, 130, 36, 74, 176, 500, 86, 32, 334, 198, 96, 206, 72, 254, 500, 102, 156, 54, 184, 500, 316, 500, 40, 108, 500, 150, 66, 36, 54, 252, 60, 24, 58, 38, 90, 76, 500, 52, 500, 30, 146, 174, 372, 500, 50, 500, 52, 26, 50, 132, 104, 82, 44, 500, 140, 500, 148, 500, 500, 44, 80, 32, 314, 500, 500, 388, 122, 500, 500, 54, 54, 88, 174, 86, 500, 352, 42, 244, 500, 154, 500, 50, 148]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37717768958145215, "mean_inference_ms": 1.2038383500754488, "mean_action_processing_ms": 0.1400321651233798, "mean_env_wait_ms": 0.08325064977248363, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023998498916625977, "StateBufferConnector_ms": 0.007998228073120117, "ViewRequirementAgentConnector_ms": 0.15500330924987793}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 16.541999999999877, "episode_len_mean": 215.34, "episodes_this_iter": 87, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [41.90000000000001, 45.3, 44.7, 44.5, -50.00000000000044, 41.100000000000016, 28.499999999999964, 44.5, 14.499999999999766, 23.499999999999893, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 13.299999999999748, 31.70000000000001, 46.099999999999994, 37.10000000000003, 46.5, 42.70000000000001, 32.50000000000002, -50.00000000000044, 41.500000000000014, 46.9, 16.699999999999797, 30.29999999999999, 40.500000000000014, 29.49999999999998, 42.900000000000006, 24.69999999999991, -50.00000000000044, 39.90000000000002, 34.50000000000004, 44.7, 31.70000000000001, -50.00000000000044, 18.499999999999822, -50.00000000000044, 46.099999999999994, 39.300000000000026, -50.00000000000044, 35.10000000000004, 43.50000000000001, 46.5, 44.7, 24.899999999999913, 44.10000000000001, 47.7, 44.300000000000004, 46.3, 41.100000000000016, 42.500000000000014, -50.00000000000044, 44.900000000000006, -50.00000000000044, 47.1, 35.500000000000036, 32.700000000000024, 12.899999999999743, -50.00000000000044, 45.1, -50.00000000000044, 44.900000000000006, 47.5, 45.1, 36.900000000000034, 39.70000000000002, 41.90000000000001, 45.7, -50.00000000000044, 36.10000000000004, -50.00000000000044, 35.30000000000004, -50.00000000000044, -50.00000000000044, 45.7, 42.10000000000001, 46.9, 18.699999999999825, -50.00000000000044, -50.00000000000044, 11.29999999999972, 37.90000000000003, -50.00000000000044, -50.00000000000044, 44.7, 44.7, 41.30000000000001, 32.700000000000024, 41.500000000000014, -50.00000000000044, 14.899999999999771, 45.9, 25.699999999999925, -50.00000000000044, 34.70000000000004, -50.00000000000044, 45.1, 35.30000000000004], "episode_lengths": [82, 48, 54, 56, 500, 90, 216, 56, 356, 266, 88, 500, 500, 500, 44, 368, 184, 40, 130, 36, 74, 176, 500, 86, 32, 334, 198, 96, 206, 72, 254, 500, 102, 156, 54, 184, 500, 316, 500, 40, 108, 500, 150, 66, 36, 54, 252, 60, 24, 58, 38, 90, 76, 500, 52, 500, 30, 146, 174, 372, 500, 50, 500, 52, 26, 50, 132, 104, 82, 44, 500, 140, 500, 148, 500, 500, 44, 80, 32, 314, 500, 500, 388, 122, 500, 500, 54, 54, 88, 174, 86, 500, 352, 42, 244, 500, 154, 500, 50, 148]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37717768958145215, "mean_inference_ms": 1.2038383500754488, "mean_action_processing_ms": 0.1400321651233798, "mean_env_wait_ms": 0.08325064977248363, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023998498916625977, "StateBufferConnector_ms": 0.007998228073120117, "ViewRequirementAgentConnector_ms": 0.15500330924987793}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 774000, "num_agent_steps_trained": 774000, "num_env_steps_sampled": 774000, "num_env_steps_trained": 774000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5526.193350046663, "num_env_steps_trained_throughput_per_sec": 5526.193350046663, "timesteps_total": 774000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 774000, "timers": {"training_iteration_time_ms": 3206.705, "sample_time_ms": 2837.061, "load_time_ms": 17.77, "load_throughput": 1012953.792, "learn_time_ms": 340.114, "learn_throughput": 52923.465, "synch_weights_time_ms": 9.159}, "counters": {"num_env_steps_sampled": 774000, "num_env_steps_trained": 774000, "num_agent_steps_sampled": 774000, "num_agent_steps_trained": 774000}, "done": false, "episodes_total": 2977, "training_iteration": 43, "trial_id": "9f288_00015", "date": "2023-10-25_16-49-00", "timestamp": 1698248940, "time_this_iter_s": 3.2622604370117188, "time_total_s": 138.31023287773132, "pid": 4200, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 138.31023287773132, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 66.05000000000001, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.273736754432321e-14, "cur_lr": 0.0003, "total_loss": 6.735252904891968, "policy_loss": -0.01131756091490388, "vf_loss": 6.746618008613586, "vf_explained_var": -2.6226043701171877e-07, "kl": 0.0004190074119719611, "entropy": 0.47622777074575423, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 870.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.2119999999998097, "episode_len_mean": 278.5, "episode_media": {}, "episodes_this_iter": 60, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.1, -50.00000000000044, 44.900000000000006, 47.5, 45.1, 36.900000000000034, 39.70000000000002, 41.90000000000001, 45.7, -50.00000000000044, 36.10000000000004, -50.00000000000044, 35.30000000000004, -50.00000000000044, -50.00000000000044, 45.7, 42.10000000000001, 46.9, 18.699999999999825, -50.00000000000044, -50.00000000000044, 11.29999999999972, 37.90000000000003, -50.00000000000044, -50.00000000000044, 44.7, 44.7, 41.30000000000001, 32.700000000000024, 41.500000000000014, -50.00000000000044, 14.899999999999771, 45.9, 25.699999999999925, -50.00000000000044, 34.70000000000004, -50.00000000000044, 45.1, 35.30000000000004, 30.099999999999987, 44.10000000000001, -50.00000000000044, 46.9, 47.1, 28.699999999999967, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 23.499999999999893, 36.900000000000034, 0.09999999999956088, -50.00000000000044, 20.299999999999848, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, 30.099999999999987, 10.299999999999706, -50.00000000000044, 43.50000000000001, 45.3, -50.00000000000044, 46.3, -50.00000000000044, 25.899999999999928, 42.30000000000001, 28.699999999999967, 28.699999999999967, 38.10000000000002, 24.899999999999913, -50.00000000000044, 46.9, 25.699999999999925, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 37.90000000000003, 45.9, 33.90000000000004, 41.500000000000014, -50.00000000000044, 6.499999999999652, 45.1, 8.899999999999686, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024], "episode_lengths": [500, 50, 500, 52, 26, 50, 132, 104, 82, 44, 500, 140, 500, 148, 500, 500, 44, 80, 32, 314, 500, 500, 388, 122, 500, 500, 54, 54, 88, 174, 86, 500, 352, 42, 244, 500, 154, 500, 50, 148, 200, 60, 500, 32, 30, 214, 500, 500, 500, 32, 500, 266, 132, 500, 500, 298, 500, 500, 90, 500, 500, 86, 500, 500, 200, 398, 500, 66, 48, 500, 38, 500, 242, 78, 214, 214, 120, 252, 500, 32, 244, 54, 500, 500, 500, 500, 500, 32, 122, 42, 162, 86, 500, 436, 50, 412, 500, 500, 500, 114]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37746109946730383, "mean_inference_ms": 1.2045025779303185, "mean_action_processing_ms": 0.1402691751018387, "mean_env_wait_ms": 0.08281333465762838, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025991439819335938, "StateBufferConnector_ms": 0.009000062942504883, "ViewRequirementAgentConnector_ms": 0.12499260902404785}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.2119999999998097, "episode_len_mean": 278.5, "episodes_this_iter": 60, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.1, -50.00000000000044, 44.900000000000006, 47.5, 45.1, 36.900000000000034, 39.70000000000002, 41.90000000000001, 45.7, -50.00000000000044, 36.10000000000004, -50.00000000000044, 35.30000000000004, -50.00000000000044, -50.00000000000044, 45.7, 42.10000000000001, 46.9, 18.699999999999825, -50.00000000000044, -50.00000000000044, 11.29999999999972, 37.90000000000003, -50.00000000000044, -50.00000000000044, 44.7, 44.7, 41.30000000000001, 32.700000000000024, 41.500000000000014, -50.00000000000044, 14.899999999999771, 45.9, 25.699999999999925, -50.00000000000044, 34.70000000000004, -50.00000000000044, 45.1, 35.30000000000004, 30.099999999999987, 44.10000000000001, -50.00000000000044, 46.9, 47.1, 28.699999999999967, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 23.499999999999893, 36.900000000000034, 0.09999999999956088, -50.00000000000044, 20.299999999999848, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, 30.099999999999987, 10.299999999999706, -50.00000000000044, 43.50000000000001, 45.3, -50.00000000000044, 46.3, -50.00000000000044, 25.899999999999928, 42.30000000000001, 28.699999999999967, 28.699999999999967, 38.10000000000002, 24.899999999999913, -50.00000000000044, 46.9, 25.699999999999925, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 37.90000000000003, 45.9, 33.90000000000004, 41.500000000000014, -50.00000000000044, 6.499999999999652, 45.1, 8.899999999999686, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024], "episode_lengths": [500, 50, 500, 52, 26, 50, 132, 104, 82, 44, 500, 140, 500, 148, 500, 500, 44, 80, 32, 314, 500, 500, 388, 122, 500, 500, 54, 54, 88, 174, 86, 500, 352, 42, 244, 500, 154, 500, 50, 148, 200, 60, 500, 32, 30, 214, 500, 500, 500, 32, 500, 266, 132, 500, 500, 298, 500, 500, 90, 500, 500, 86, 500, 500, 200, 398, 500, 66, 48, 500, 38, 500, 242, 78, 214, 214, 120, 252, 500, 32, 244, 54, 500, 500, 500, 500, 500, 32, 122, 42, 162, 86, 500, 436, 50, 412, 500, 500, 500, 114]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37746109946730383, "mean_inference_ms": 1.2045025779303185, "mean_action_processing_ms": 0.1402691751018387, "mean_env_wait_ms": 0.08281333465762838, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025991439819335938, "StateBufferConnector_ms": 0.009000062942504883, "ViewRequirementAgentConnector_ms": 0.12499260902404785}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000, "num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5589.950723859923, "num_env_steps_trained_throughput_per_sec": 5589.950723859923, "timesteps_total": 792000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 792000, "timers": {"training_iteration_time_ms": 3217.774, "sample_time_ms": 2842.361, "load_time_ms": 19.072, "load_throughput": 943773.847, "learn_time_ms": 344.64, "learn_throughput": 52228.421, "synch_weights_time_ms": 9.199}, "counters": {"num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000}, "done": false, "episodes_total": 3037, "training_iteration": 44, "trial_id": "9f288_00015", "date": "2023-10-25_16-49-03", "timestamp": 1698248943, "time_this_iter_s": 3.2250633239746094, "time_total_s": 141.53529620170593, "pid": 4200, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 141.53529620170593, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 54.779999999999994, "ram_util_percent": 27.22}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1368683772161605e-14, "cur_lr": 0.0003, "total_loss": 6.4741294384002686, "policy_loss": -0.02405700571835041, "vf_loss": 6.4982353210449215, "vf_explained_var": -1.0251998901367187e-06, "kl": 0.0012671395912647655, "entropy": 0.48744258731603624, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 890.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 810000, "num_env_steps_trained": 810000, "num_agent_steps_sampled": 810000, "num_agent_steps_trained": 810000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.015000000000215, "episode_len_mean": 295.72, "episode_media": {}, "episodes_this_iter": 59, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, 30.099999999999987, 10.299999999999706, -50.00000000000044, 43.50000000000001, 45.3, -50.00000000000044, 46.3, -50.00000000000044, 25.899999999999928, 42.30000000000001, 28.699999999999967, 28.699999999999967, 38.10000000000002, 24.899999999999913, -50.00000000000044, 46.9, 25.699999999999925, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 37.90000000000003, 45.9, 33.90000000000004, 41.500000000000014, -50.00000000000044, 6.499999999999652, 45.1, 8.899999999999686, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, -50.00000000000044, -50.00000000000044, 44.300000000000004, 42.70000000000001, 44.300000000000004, 31.300000000000004, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 43.50000000000001, 13.099999999999746, 46.3, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, -50.00000000000044, 6.299999999999649, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 23.699999999999896, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 41.500000000000014, 45.1, 1.299999999999578, 45.7, 32.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 11.499999999999723, 43.50000000000001, 18.499999999999822, 38.10000000000002, 45.7, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 37.50000000000003, 45.1, 46.099999999999994, 44.900000000000006, -50.00000000000044, -50.00000000000044, 28.29999999999996, -50.00000000000044, -50.00000000000044, 46.9], "episode_lengths": [500, 500, 86, 500, 500, 200, 398, 500, 66, 48, 500, 38, 500, 242, 78, 214, 214, 120, 252, 500, 32, 244, 54, 500, 500, 500, 500, 500, 32, 122, 42, 162, 86, 500, 436, 50, 412, 500, 500, 500, 114, 500, 500, 58, 74, 58, 188, 500, 500, 36, 500, 66, 370, 38, 500, 76, 500, 500, 500, 112, 500, 438, 500, 500, 500, 30, 264, 500, 500, 500, 60, 86, 50, 488, 44, 176, 500, 500, 500, 72, 386, 66, 316, 120, 44, 48, 500, 500, 500, 48, 126, 50, 40, 52, 500, 500, 218, 500, 500, 32]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3774953407525176, "mean_inference_ms": 1.2044293919249174, "mean_action_processing_ms": 0.14016922970866275, "mean_env_wait_ms": 0.08285253724078434, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02744007110595703, "StateBufferConnector_ms": 0.006997585296630859, "ViewRequirementAgentConnector_ms": 0.1249232292175293}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.015000000000215, "episode_len_mean": 295.72, "episodes_this_iter": 59, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, 30.099999999999987, 10.299999999999706, -50.00000000000044, 43.50000000000001, 45.3, -50.00000000000044, 46.3, -50.00000000000044, 25.899999999999928, 42.30000000000001, 28.699999999999967, 28.699999999999967, 38.10000000000002, 24.899999999999913, -50.00000000000044, 46.9, 25.699999999999925, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 37.90000000000003, 45.9, 33.90000000000004, 41.500000000000014, -50.00000000000044, 6.499999999999652, 45.1, 8.899999999999686, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, -50.00000000000044, -50.00000000000044, 44.300000000000004, 42.70000000000001, 44.300000000000004, 31.300000000000004, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 43.50000000000001, 13.099999999999746, 46.3, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, -50.00000000000044, 6.299999999999649, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 23.699999999999896, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 41.500000000000014, 45.1, 1.299999999999578, 45.7, 32.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 11.499999999999723, 43.50000000000001, 18.499999999999822, 38.10000000000002, 45.7, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 37.50000000000003, 45.1, 46.099999999999994, 44.900000000000006, -50.00000000000044, -50.00000000000044, 28.29999999999996, -50.00000000000044, -50.00000000000044, 46.9], "episode_lengths": [500, 500, 86, 500, 500, 200, 398, 500, 66, 48, 500, 38, 500, 242, 78, 214, 214, 120, 252, 500, 32, 244, 54, 500, 500, 500, 500, 500, 32, 122, 42, 162, 86, 500, 436, 50, 412, 500, 500, 500, 114, 500, 500, 58, 74, 58, 188, 500, 500, 36, 500, 66, 370, 38, 500, 76, 500, 500, 500, 112, 500, 438, 500, 500, 500, 30, 264, 500, 500, 500, 60, 86, 50, 488, 44, 176, 500, 500, 500, 72, 386, 66, 316, 120, 44, 48, 500, 500, 500, 48, 126, 50, 40, 52, 500, 500, 218, 500, 500, 32]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3774953407525176, "mean_inference_ms": 1.2044293919249174, "mean_action_processing_ms": 0.14016922970866275, "mean_env_wait_ms": 0.08285253724078434, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02744007110595703, "StateBufferConnector_ms": 0.006997585296630859, "ViewRequirementAgentConnector_ms": 0.1249232292175293}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 810000, "num_agent_steps_trained": 810000, "num_env_steps_sampled": 810000, "num_env_steps_trained": 810000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5783.998350700848, "num_env_steps_trained_throughput_per_sec": 5783.998350700848, "timesteps_total": 810000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 810000, "timers": {"training_iteration_time_ms": 3210.725, "sample_time_ms": 2838.261, "load_time_ms": 19.095, "load_throughput": 942644.963, "learn_time_ms": 341.614, "learn_throughput": 52690.982, "synch_weights_time_ms": 9.153}, "counters": {"num_env_steps_sampled": 810000, "num_env_steps_trained": 810000, "num_agent_steps_sampled": 810000, "num_agent_steps_trained": 810000}, "done": false, "episodes_total": 3096, "training_iteration": 45, "trial_id": "9f288_00015", "date": "2023-10-25_16-49-06", "timestamp": 1698248946, "time_this_iter_s": 3.1180310249328613, "time_total_s": 144.6533272266388, "pid": 4200, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 144.6533272266388, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 64.2, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.6843418860808026e-15, "cur_lr": 0.0003, "total_loss": 6.637321352958679, "policy_loss": -0.018775354698300363, "vf_loss": 6.656144666671753, "vf_explained_var": -1.9043684005737304e-06, "kl": 0.001484705897371441, "entropy": 0.4799785867333412, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 910.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 828000, "num_env_steps_trained": 828000, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.577999999999838, "episode_len_mean": 234.86, "episode_media": {}, "episodes_this_iter": 82, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.499999999999822, 38.10000000000002, 45.7, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 37.50000000000003, 45.1, 46.099999999999994, 44.900000000000006, -50.00000000000044, -50.00000000000044, 28.29999999999996, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 40.70000000000002, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.300000000000004, 25.699999999999925, -50.00000000000044, 44.10000000000001, 46.699999999999996, -50.00000000000044, 41.500000000000014, 40.500000000000014, 47.1, -50.00000000000044, 40.30000000000002, -50.00000000000044, 41.500000000000014, 35.10000000000004, 27.899999999999956, -50.00000000000044, 44.5, 44.5, -50.00000000000044, 45.7, -50.00000000000044, 37.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 22.899999999999885, 45.3, 44.7, 32.50000000000002, 37.50000000000003, 41.30000000000001, 47.3, -50.00000000000044, 33.10000000000003, 45.5, 43.900000000000006, -50.00000000000044, 44.900000000000006, 46.9, 41.70000000000002, 44.7, 42.10000000000001, 37.90000000000003, -50.00000000000044, 43.50000000000001, 44.10000000000001, 47.3, -50.00000000000044, -50.00000000000044, 41.90000000000001, 41.70000000000002, -50.00000000000044, -50.00000000000044, 45.9, 46.5, 46.099999999999994, -50.00000000000044, 43.7, 46.3, 47.5, 46.5, -50.00000000000044, 45.1, -50.00000000000044, 46.699999999999996, -50.00000000000044, 46.699999999999996, 44.5, -50.00000000000044, 46.099999999999994, 39.50000000000002, -50.00000000000044, -50.00000000000044, 15.899999999999785], "episode_lengths": [316, 120, 44, 48, 500, 500, 500, 48, 126, 50, 40, 52, 500, 500, 218, 500, 500, 32, 500, 500, 54, 500, 94, 40, 500, 500, 58, 244, 500, 60, 34, 500, 86, 96, 30, 500, 98, 500, 86, 150, 222, 500, 56, 56, 500, 44, 500, 126, 500, 500, 500, 272, 48, 54, 176, 126, 88, 28, 500, 170, 46, 62, 500, 52, 32, 84, 54, 80, 122, 500, 66, 60, 28, 500, 500, 82, 84, 500, 500, 42, 36, 40, 500, 64, 38, 26, 36, 500, 50, 500, 34, 500, 34, 56, 500, 40, 106, 500, 500, 342]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3775789924927315, "mean_inference_ms": 1.203126525651083, "mean_action_processing_ms": 0.1399152872976712, "mean_env_wait_ms": 0.08285925387931908, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016587257385253906, "StateBufferConnector_ms": 0.004999876022338867, "ViewRequirementAgentConnector_ms": 0.13739562034606934}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.577999999999838, "episode_len_mean": 234.86, "episodes_this_iter": 82, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [18.499999999999822, 38.10000000000002, 45.7, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 37.50000000000003, 45.1, 46.099999999999994, 44.900000000000006, -50.00000000000044, -50.00000000000044, 28.29999999999996, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 40.70000000000002, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.300000000000004, 25.699999999999925, -50.00000000000044, 44.10000000000001, 46.699999999999996, -50.00000000000044, 41.500000000000014, 40.500000000000014, 47.1, -50.00000000000044, 40.30000000000002, -50.00000000000044, 41.500000000000014, 35.10000000000004, 27.899999999999956, -50.00000000000044, 44.5, 44.5, -50.00000000000044, 45.7, -50.00000000000044, 37.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 22.899999999999885, 45.3, 44.7, 32.50000000000002, 37.50000000000003, 41.30000000000001, 47.3, -50.00000000000044, 33.10000000000003, 45.5, 43.900000000000006, -50.00000000000044, 44.900000000000006, 46.9, 41.70000000000002, 44.7, 42.10000000000001, 37.90000000000003, -50.00000000000044, 43.50000000000001, 44.10000000000001, 47.3, -50.00000000000044, -50.00000000000044, 41.90000000000001, 41.70000000000002, -50.00000000000044, -50.00000000000044, 45.9, 46.5, 46.099999999999994, -50.00000000000044, 43.7, 46.3, 47.5, 46.5, -50.00000000000044, 45.1, -50.00000000000044, 46.699999999999996, -50.00000000000044, 46.699999999999996, 44.5, -50.00000000000044, 46.099999999999994, 39.50000000000002, -50.00000000000044, -50.00000000000044, 15.899999999999785], "episode_lengths": [316, 120, 44, 48, 500, 500, 500, 48, 126, 50, 40, 52, 500, 500, 218, 500, 500, 32, 500, 500, 54, 500, 94, 40, 500, 500, 58, 244, 500, 60, 34, 500, 86, 96, 30, 500, 98, 500, 86, 150, 222, 500, 56, 56, 500, 44, 500, 126, 500, 500, 500, 272, 48, 54, 176, 126, 88, 28, 500, 170, 46, 62, 500, 52, 32, 84, 54, 80, 122, 500, 66, 60, 28, 500, 500, 82, 84, 500, 500, 42, 36, 40, 500, 64, 38, 26, 36, 500, 50, 500, 34, 500, 34, 56, 500, 40, 106, 500, 500, 342]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3775789924927315, "mean_inference_ms": 1.203126525651083, "mean_action_processing_ms": 0.1399152872976712, "mean_env_wait_ms": 0.08285925387931908, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016587257385253906, "StateBufferConnector_ms": 0.004999876022338867, "ViewRequirementAgentConnector_ms": 0.13739562034606934}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000, "num_env_steps_sampled": 828000, "num_env_steps_trained": 828000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5578.9666358495415, "num_env_steps_trained_throughput_per_sec": 5578.9666358495415, "timesteps_total": 828000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 828000, "timers": {"training_iteration_time_ms": 3210.639, "sample_time_ms": 2837.392, "load_time_ms": 18.91, "load_throughput": 951889.179, "learn_time_ms": 342.535, "learn_throughput": 52549.379, "synch_weights_time_ms": 9.198}, "counters": {"num_env_steps_sampled": 828000, "num_env_steps_trained": 828000, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000}, "done": false, "episodes_total": 3178, "training_iteration": 46, "trial_id": "9f288_00015", "date": "2023-10-25_16-49-10", "timestamp": 1698248950, "time_this_iter_s": 3.2323760986328125, "time_total_s": 147.8857033252716, "pid": 4200, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 147.8857033252716, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 54.839999999999996, "ram_util_percent": 27.22}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.8421709430404013e-15, "cur_lr": 0.0003, "total_loss": 6.1514297246932985, "policy_loss": 0.03195203896611929, "vf_loss": 6.1195244789123535, "vf_explained_var": -2.0086765289306642e-06, "kl": 8.209337009361662e-05, "entropy": 0.46848346292972565, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 930.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 846000, "num_env_steps_trained": 846000, "num_agent_steps_sampled": 846000, "num_agent_steps_trained": 846000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.465999999999824, "episode_len_mean": 245.96, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.9, 41.70000000000002, 44.7, 42.10000000000001, 37.90000000000003, -50.00000000000044, 43.50000000000001, 44.10000000000001, 47.3, -50.00000000000044, -50.00000000000044, 41.90000000000001, 41.70000000000002, -50.00000000000044, -50.00000000000044, 45.9, 46.5, 46.099999999999994, -50.00000000000044, 43.7, 46.3, 47.5, 46.5, -50.00000000000044, 45.1, -50.00000000000044, 46.699999999999996, -50.00000000000044, 46.699999999999996, 44.5, -50.00000000000044, 46.099999999999994, 39.50000000000002, -50.00000000000044, -50.00000000000044, 15.899999999999785, -50.00000000000044, 41.100000000000016, 40.500000000000014, 44.7, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 43.900000000000006, 45.1, -50.00000000000044, 45.7, 45.1, -50.00000000000044, 28.09999999999996, 45.9, 24.299999999999905, 45.5, 14.499999999999766, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 8.699999999999683, 47.7, 46.9, -50.00000000000044, 39.10000000000002, 43.50000000000001, -50.00000000000044, -50.00000000000044, 44.10000000000001, 44.10000000000001, -50.00000000000044, 20.299999999999848, -50.00000000000044, -50.00000000000044, 44.5, 24.299999999999905, -50.00000000000044, 46.099999999999994, 44.10000000000001, 33.70000000000004, 44.5, 43.7, 44.300000000000004, 46.699999999999996, 43.30000000000001, -50.00000000000044, -50.00000000000044, 47.7, 42.900000000000006, 40.90000000000002, -50.00000000000044, -50.00000000000044, 44.5, 26.69999999999994, 42.500000000000014, -50.00000000000044], "episode_lengths": [32, 84, 54, 80, 122, 500, 66, 60, 28, 500, 500, 82, 84, 500, 500, 42, 36, 40, 500, 64, 38, 26, 36, 500, 50, 500, 34, 500, 34, 56, 500, 40, 106, 500, 500, 342, 500, 90, 96, 54, 62, 500, 500, 500, 500, 500, 54, 62, 50, 500, 44, 50, 500, 220, 42, 258, 46, 356, 500, 500, 500, 500, 500, 500, 414, 24, 32, 500, 110, 66, 500, 500, 60, 60, 500, 298, 500, 500, 56, 258, 500, 40, 60, 164, 56, 64, 58, 34, 68, 500, 500, 24, 72, 92, 500, 500, 56, 234, 76, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3773955851117726, "mean_inference_ms": 1.2032851456761784, "mean_action_processing_ms": 0.1400396040485446, "mean_env_wait_ms": 0.0827218679181556, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025058746337890625, "StateBufferConnector_ms": 0.004003047943115234, "ViewRequirementAgentConnector_ms": 0.12041330337524414}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.465999999999824, "episode_len_mean": 245.96, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.9, 41.70000000000002, 44.7, 42.10000000000001, 37.90000000000003, -50.00000000000044, 43.50000000000001, 44.10000000000001, 47.3, -50.00000000000044, -50.00000000000044, 41.90000000000001, 41.70000000000002, -50.00000000000044, -50.00000000000044, 45.9, 46.5, 46.099999999999994, -50.00000000000044, 43.7, 46.3, 47.5, 46.5, -50.00000000000044, 45.1, -50.00000000000044, 46.699999999999996, -50.00000000000044, 46.699999999999996, 44.5, -50.00000000000044, 46.099999999999994, 39.50000000000002, -50.00000000000044, -50.00000000000044, 15.899999999999785, -50.00000000000044, 41.100000000000016, 40.500000000000014, 44.7, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 43.900000000000006, 45.1, -50.00000000000044, 45.7, 45.1, -50.00000000000044, 28.09999999999996, 45.9, 24.299999999999905, 45.5, 14.499999999999766, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 8.699999999999683, 47.7, 46.9, -50.00000000000044, 39.10000000000002, 43.50000000000001, -50.00000000000044, -50.00000000000044, 44.10000000000001, 44.10000000000001, -50.00000000000044, 20.299999999999848, -50.00000000000044, -50.00000000000044, 44.5, 24.299999999999905, -50.00000000000044, 46.099999999999994, 44.10000000000001, 33.70000000000004, 44.5, 43.7, 44.300000000000004, 46.699999999999996, 43.30000000000001, -50.00000000000044, -50.00000000000044, 47.7, 42.900000000000006, 40.90000000000002, -50.00000000000044, -50.00000000000044, 44.5, 26.69999999999994, 42.500000000000014, -50.00000000000044], "episode_lengths": [32, 84, 54, 80, 122, 500, 66, 60, 28, 500, 500, 82, 84, 500, 500, 42, 36, 40, 500, 64, 38, 26, 36, 500, 50, 500, 34, 500, 34, 56, 500, 40, 106, 500, 500, 342, 500, 90, 96, 54, 62, 500, 500, 500, 500, 500, 54, 62, 50, 500, 44, 50, 500, 220, 42, 258, 46, 356, 500, 500, 500, 500, 500, 500, 414, 24, 32, 500, 110, 66, 500, 500, 60, 60, 500, 298, 500, 500, 56, 258, 500, 40, 60, 164, 56, 64, 58, 34, 68, 500, 500, 24, 72, 92, 500, 500, 56, 234, 76, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3773955851117726, "mean_inference_ms": 1.2032851456761784, "mean_action_processing_ms": 0.1400396040485446, "mean_env_wait_ms": 0.0827218679181556, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025058746337890625, "StateBufferConnector_ms": 0.004003047943115234, "ViewRequirementAgentConnector_ms": 0.12041330337524414}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 846000, "num_agent_steps_trained": 846000, "num_env_steps_sampled": 846000, "num_env_steps_trained": 846000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5781.047331134165, "num_env_steps_trained_throughput_per_sec": 5781.047331134165, "timesteps_total": 846000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 846000, "timers": {"training_iteration_time_ms": 3210.212, "sample_time_ms": 2838.193, "load_time_ms": 18.989, "load_throughput": 947939.099, "learn_time_ms": 341.154, "learn_throughput": 52762.151, "synch_weights_time_ms": 9.273}, "counters": {"num_env_steps_sampled": 846000, "num_env_steps_trained": 846000, "num_agent_steps_sampled": 846000, "num_agent_steps_trained": 846000}, "done": false, "episodes_total": 3242, "training_iteration": 47, "trial_id": "9f288_00015", "date": "2023-10-25_16-49-13", "timestamp": 1698248953, "time_this_iter_s": 3.1186187267303467, "time_total_s": 151.00432205200195, "pid": 4200, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 151.00432205200195, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 64.7, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.4210854715202006e-15, "cur_lr": 0.0003, "total_loss": 6.511311745643615, "policy_loss": 0.06861922889947891, "vf_loss": 6.442739725112915, "vf_explained_var": -1.931190490722656e-06, "kl": 0.0002592303790834194, "entropy": 0.47276416420936584, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 950.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 864000, "num_env_steps_trained": 864000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.589999999999809, "episode_len_mean": 264.68, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.10000000000002, 43.50000000000001, -50.00000000000044, -50.00000000000044, 44.10000000000001, 44.10000000000001, -50.00000000000044, 20.299999999999848, -50.00000000000044, -50.00000000000044, 44.5, 24.299999999999905, -50.00000000000044, 46.099999999999994, 44.10000000000001, 33.70000000000004, 44.5, 43.7, 44.300000000000004, 46.699999999999996, 43.30000000000001, -50.00000000000044, -50.00000000000044, 47.7, 42.900000000000006, 40.90000000000002, -50.00000000000044, -50.00000000000044, 44.5, 26.69999999999994, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.900000000000034, 45.3, -50.00000000000044, -50.00000000000044, 45.3, 46.3, 43.10000000000001, 45.3, 46.9, -50.00000000000044, 41.30000000000001, 47.5, -50.00000000000044, 46.5, 45.3, -50.00000000000044, -50.00000000000044, 46.699999999999996, 40.70000000000002, -50.00000000000044, -50.00000000000044, 16.8999999999998, 30.499999999999993, 46.699999999999996, 39.70000000000002, 37.70000000000003, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 9.8999999999997, 45.5, -50.00000000000044, 45.9, 47.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002, 46.3, -50.00000000000044, -50.00000000000044, 37.90000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, 37.90000000000003, 44.7, -50.00000000000044, 16.8999999999998, 41.90000000000001, 44.10000000000001, 39.90000000000002, 44.5, -50.00000000000044, 32.700000000000024, 44.900000000000006, 44.900000000000006], "episode_lengths": [110, 66, 500, 500, 60, 60, 500, 298, 500, 500, 56, 258, 500, 40, 60, 164, 56, 64, 58, 34, 68, 500, 500, 24, 72, 92, 500, 500, 56, 234, 76, 500, 500, 500, 500, 132, 48, 500, 500, 48, 38, 70, 48, 32, 500, 88, 26, 500, 36, 48, 500, 500, 34, 94, 500, 500, 332, 196, 34, 104, 124, 500, 36, 500, 500, 500, 402, 46, 500, 42, 24, 500, 500, 500, 500, 500, 500, 106, 38, 500, 500, 122, 500, 500, 500, 28, 500, 500, 122, 54, 500, 332, 82, 60, 102, 56, 500, 174, 52, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37746453154163745, "mean_inference_ms": 1.2036340336325093, "mean_action_processing_ms": 0.13995930710068027, "mean_env_wait_ms": 0.08301823637660455, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026787996292114258, "StateBufferConnector_ms": 0.0060083866119384766, "ViewRequirementAgentConnector_ms": 0.10260844230651855}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.589999999999809, "episode_len_mean": 264.68, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [39.10000000000002, 43.50000000000001, -50.00000000000044, -50.00000000000044, 44.10000000000001, 44.10000000000001, -50.00000000000044, 20.299999999999848, -50.00000000000044, -50.00000000000044, 44.5, 24.299999999999905, -50.00000000000044, 46.099999999999994, 44.10000000000001, 33.70000000000004, 44.5, 43.7, 44.300000000000004, 46.699999999999996, 43.30000000000001, -50.00000000000044, -50.00000000000044, 47.7, 42.900000000000006, 40.90000000000002, -50.00000000000044, -50.00000000000044, 44.5, 26.69999999999994, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.900000000000034, 45.3, -50.00000000000044, -50.00000000000044, 45.3, 46.3, 43.10000000000001, 45.3, 46.9, -50.00000000000044, 41.30000000000001, 47.5, -50.00000000000044, 46.5, 45.3, -50.00000000000044, -50.00000000000044, 46.699999999999996, 40.70000000000002, -50.00000000000044, -50.00000000000044, 16.8999999999998, 30.499999999999993, 46.699999999999996, 39.70000000000002, 37.70000000000003, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 9.8999999999997, 45.5, -50.00000000000044, 45.9, 47.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002, 46.3, -50.00000000000044, -50.00000000000044, 37.90000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, 37.90000000000003, 44.7, -50.00000000000044, 16.8999999999998, 41.90000000000001, 44.10000000000001, 39.90000000000002, 44.5, -50.00000000000044, 32.700000000000024, 44.900000000000006, 44.900000000000006], "episode_lengths": [110, 66, 500, 500, 60, 60, 500, 298, 500, 500, 56, 258, 500, 40, 60, 164, 56, 64, 58, 34, 68, 500, 500, 24, 72, 92, 500, 500, 56, 234, 76, 500, 500, 500, 500, 132, 48, 500, 500, 48, 38, 70, 48, 32, 500, 88, 26, 500, 36, 48, 500, 500, 34, 94, 500, 500, 332, 196, 34, 104, 124, 500, 36, 500, 500, 500, 402, 46, 500, 42, 24, 500, 500, 500, 500, 500, 500, 106, 38, 500, 500, 122, 500, 500, 500, 28, 500, 500, 122, 54, 500, 332, 82, 60, 102, 56, 500, 174, 52, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37746453154163745, "mean_inference_ms": 1.2036340336325093, "mean_action_processing_ms": 0.13995930710068027, "mean_env_wait_ms": 0.08301823637660455, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026787996292114258, "StateBufferConnector_ms": 0.0060083866119384766, "ViewRequirementAgentConnector_ms": 0.10260844230651855}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000, "num_env_steps_sampled": 864000, "num_env_steps_trained": 864000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5692.828944367134, "num_env_steps_trained_throughput_per_sec": 5692.828944367134, "timesteps_total": 864000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 864000, "timers": {"training_iteration_time_ms": 3205.767, "sample_time_ms": 2837.117, "load_time_ms": 19.226, "load_throughput": 936230.893, "learn_time_ms": 337.648, "learn_throughput": 53309.917, "synch_weights_time_ms": 9.173}, "counters": {"num_env_steps_sampled": 864000, "num_env_steps_trained": 864000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "done": false, "episodes_total": 3310, "training_iteration": 48, "trial_id": "9f288_00015", "date": "2023-10-25_16-49-16", "timestamp": 1698248956, "time_this_iter_s": 3.167717456817627, "time_total_s": 154.17203950881958, "pid": 4200, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 154.17203950881958, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 59.8, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.105427357601003e-16, "cur_lr": 0.0003, "total_loss": 6.324345850944519, "policy_loss": -0.03058511996641755, "vf_loss": 6.35498161315918, "vf_explained_var": -1.5497207641601562e-06, "kl": 0.0005577881016563424, "entropy": 0.5058810502290726, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 970.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 882000, "num_env_steps_trained": 882000, "num_agent_steps_sampled": 882000, "num_agent_steps_trained": 882000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.515999999999815, "episode_len_mean": 265.44, "episode_media": {}, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.5, -50.00000000000044, 45.9, 47.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002, 46.3, -50.00000000000044, -50.00000000000044, 37.90000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, 37.90000000000003, 44.7, -50.00000000000044, 16.8999999999998, 41.90000000000001, 44.10000000000001, 39.90000000000002, 44.5, -50.00000000000044, 32.700000000000024, 44.900000000000006, 44.900000000000006, -50.00000000000044, 29.099999999999973, 44.300000000000004, 44.10000000000001, 39.90000000000002, -50.00000000000044, 42.500000000000014, 43.30000000000001, 35.30000000000004, 29.69999999999998, 21.09999999999986, -50.00000000000044, 44.300000000000004, 46.699999999999996, 39.50000000000002, 28.499999999999964, 7.499999999999666, 44.10000000000001, 39.90000000000002, -50.00000000000044, 41.70000000000002, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, 45.7, 40.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.900000000000034, 45.5, 26.69999999999994, 44.10000000000001, 3.699999999999612, 43.900000000000006, -50.00000000000044, 36.50000000000003, -50.00000000000044, 33.90000000000004, -50.00000000000044, -50.00000000000044, 34.70000000000004, 46.699999999999996, 45.9, 46.5, -50.00000000000044, 44.300000000000004, 45.9, 16.699999999999797, -50.00000000000044, 45.5, 42.500000000000014, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 34.900000000000034, -50.00000000000044, 44.300000000000004, 44.900000000000006], "episode_lengths": [46, 500, 42, 24, 500, 500, 500, 500, 500, 500, 106, 38, 500, 500, 122, 500, 500, 500, 28, 500, 500, 122, 54, 500, 332, 82, 60, 102, 56, 500, 174, 52, 52, 500, 210, 58, 60, 102, 500, 76, 68, 148, 204, 290, 500, 58, 34, 106, 216, 426, 60, 102, 500, 84, 500, 46, 500, 500, 500, 26, 500, 44, 98, 500, 500, 500, 132, 46, 234, 60, 464, 62, 500, 136, 500, 162, 500, 500, 154, 34, 42, 36, 500, 58, 42, 334, 500, 46, 76, 500, 500, 92, 500, 64, 500, 500, 152, 500, 58, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37745310865456305, "mean_inference_ms": 1.2042724983607611, "mean_action_processing_ms": 0.14012492512628388, "mean_env_wait_ms": 0.0827309044546477, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02499246597290039, "StateBufferConnector_ms": 0.004996061325073242, "ViewRequirementAgentConnector_ms": 0.12248063087463379}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.515999999999815, "episode_len_mean": 265.44, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.5, -50.00000000000044, 45.9, 47.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002, 46.3, -50.00000000000044, -50.00000000000044, 37.90000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, 37.90000000000003, 44.7, -50.00000000000044, 16.8999999999998, 41.90000000000001, 44.10000000000001, 39.90000000000002, 44.5, -50.00000000000044, 32.700000000000024, 44.900000000000006, 44.900000000000006, -50.00000000000044, 29.099999999999973, 44.300000000000004, 44.10000000000001, 39.90000000000002, -50.00000000000044, 42.500000000000014, 43.30000000000001, 35.30000000000004, 29.69999999999998, 21.09999999999986, -50.00000000000044, 44.300000000000004, 46.699999999999996, 39.50000000000002, 28.499999999999964, 7.499999999999666, 44.10000000000001, 39.90000000000002, -50.00000000000044, 41.70000000000002, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, 45.7, 40.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.900000000000034, 45.5, 26.69999999999994, 44.10000000000001, 3.699999999999612, 43.900000000000006, -50.00000000000044, 36.50000000000003, -50.00000000000044, 33.90000000000004, -50.00000000000044, -50.00000000000044, 34.70000000000004, 46.699999999999996, 45.9, 46.5, -50.00000000000044, 44.300000000000004, 45.9, 16.699999999999797, -50.00000000000044, 45.5, 42.500000000000014, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 34.900000000000034, -50.00000000000044, 44.300000000000004, 44.900000000000006], "episode_lengths": [46, 500, 42, 24, 500, 500, 500, 500, 500, 500, 106, 38, 500, 500, 122, 500, 500, 500, 28, 500, 500, 122, 54, 500, 332, 82, 60, 102, 56, 500, 174, 52, 52, 500, 210, 58, 60, 102, 500, 76, 68, 148, 204, 290, 500, 58, 34, 106, 216, 426, 60, 102, 500, 84, 500, 46, 500, 500, 500, 26, 500, 44, 98, 500, 500, 500, 132, 46, 234, 60, 464, 62, 500, 136, 500, 162, 500, 500, 154, 34, 42, 36, 500, 58, 42, 334, 500, 46, 76, 500, 500, 92, 500, 64, 500, 500, 152, 500, 58, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37745310865456305, "mean_inference_ms": 1.2042724983607611, "mean_action_processing_ms": 0.14012492512628388, "mean_env_wait_ms": 0.0827309044546477, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02499246597290039, "StateBufferConnector_ms": 0.004996061325073242, "ViewRequirementAgentConnector_ms": 0.12248063087463379}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 882000, "num_agent_steps_trained": 882000, "num_env_steps_sampled": 882000, "num_env_steps_trained": 882000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5573.013722474111, "num_env_steps_trained_throughput_per_sec": 5573.013722474111, "timesteps_total": 882000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 882000, "timers": {"training_iteration_time_ms": 3189.928, "sample_time_ms": 2827.577, "load_time_ms": 18.595, "load_throughput": 967994.492, "learn_time_ms": 331.984, "learn_throughput": 54219.555, "synch_weights_time_ms": 9.27}, "counters": {"num_env_steps_sampled": 882000, "num_env_steps_trained": 882000, "num_agent_steps_sampled": 882000, "num_agent_steps_trained": 882000}, "done": false, "episodes_total": 3377, "training_iteration": 49, "trial_id": "9f288_00015", "date": "2023-10-25_16-49-19", "timestamp": 1698248959, "time_this_iter_s": 3.234849452972412, "time_total_s": 157.406888961792, "pid": 4200, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 157.406888961792, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 58.239999999999995, "ram_util_percent": 27.22}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.5527136788005016e-16, "cur_lr": 0.0003, "total_loss": 6.5198941946029665, "policy_loss": -0.041609654028434306, "vf_loss": 6.561555433273315, "vf_explained_var": -1.4901161193847656e-06, "kl": 0.0006344506338791689, "entropy": 0.5169399857521058, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 990.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 900000, "num_env_steps_trained": 900000, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -4.364000000000226, "episode_len_mean": 304.16, "episode_media": {}, "episodes_this_iter": 57, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, 45.7, 40.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.900000000000034, 45.5, 26.69999999999994, 44.10000000000001, 3.699999999999612, 43.900000000000006, -50.00000000000044, 36.50000000000003, -50.00000000000044, 33.90000000000004, -50.00000000000044, -50.00000000000044, 34.70000000000004, 46.699999999999996, 45.9, 46.5, -50.00000000000044, 44.300000000000004, 45.9, 16.699999999999797, -50.00000000000044, 45.5, 42.500000000000014, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 34.900000000000034, -50.00000000000044, 44.300000000000004, 44.900000000000006, -50.00000000000044, 38.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 20.099999999999845, 44.900000000000006, 44.7, -50.00000000000044, 46.699999999999996, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.300000000000026, 44.7, 43.7, 46.099999999999994, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 4.099999999999618, -50.00000000000044, -50.00000000000044, 41.500000000000014, 44.10000000000001, 31.300000000000004, 9.699999999999697, 23.099999999999888, 46.099999999999994, 30.699999999999996, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.500000000000036, 39.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.50000000000003, -50.00000000000044, 9.299999999999692, -50.00000000000044, -50.00000000000044, 45.5], "episode_lengths": [500, 500, 26, 500, 44, 98, 500, 500, 500, 132, 46, 234, 60, 464, 62, 500, 136, 500, 162, 500, 500, 154, 34, 42, 36, 500, 58, 42, 334, 500, 46, 76, 500, 500, 92, 500, 64, 500, 500, 152, 500, 58, 52, 500, 120, 500, 500, 500, 500, 30, 500, 500, 300, 52, 54, 500, 34, 66, 500, 500, 500, 500, 128, 54, 64, 40, 82, 500, 500, 500, 500, 460, 500, 500, 86, 60, 188, 404, 270, 40, 194, 60, 500, 500, 500, 84, 500, 500, 500, 146, 106, 500, 500, 500, 136, 500, 408, 500, 500, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3774283526372303, "mean_inference_ms": 1.2032018292719784, "mean_action_processing_ms": 0.13991901656101113, "mean_env_wait_ms": 0.0829869390529927, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02410602569580078, "StateBufferConnector_ms": 0.004507541656494141, "ViewRequirementAgentConnector_ms": 0.12250566482543945}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -4.364000000000226, "episode_len_mean": 304.16, "episodes_this_iter": 57, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, 45.7, 40.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.900000000000034, 45.5, 26.69999999999994, 44.10000000000001, 3.699999999999612, 43.900000000000006, -50.00000000000044, 36.50000000000003, -50.00000000000044, 33.90000000000004, -50.00000000000044, -50.00000000000044, 34.70000000000004, 46.699999999999996, 45.9, 46.5, -50.00000000000044, 44.300000000000004, 45.9, 16.699999999999797, -50.00000000000044, 45.5, 42.500000000000014, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 34.900000000000034, -50.00000000000044, 44.300000000000004, 44.900000000000006, -50.00000000000044, 38.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 20.099999999999845, 44.900000000000006, 44.7, -50.00000000000044, 46.699999999999996, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.300000000000026, 44.7, 43.7, 46.099999999999994, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 4.099999999999618, -50.00000000000044, -50.00000000000044, 41.500000000000014, 44.10000000000001, 31.300000000000004, 9.699999999999697, 23.099999999999888, 46.099999999999994, 30.699999999999996, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.500000000000036, 39.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.50000000000003, -50.00000000000044, 9.299999999999692, -50.00000000000044, -50.00000000000044, 45.5], "episode_lengths": [500, 500, 26, 500, 44, 98, 500, 500, 500, 132, 46, 234, 60, 464, 62, 500, 136, 500, 162, 500, 500, 154, 34, 42, 36, 500, 58, 42, 334, 500, 46, 76, 500, 500, 92, 500, 64, 500, 500, 152, 500, 58, 52, 500, 120, 500, 500, 500, 500, 30, 500, 500, 300, 52, 54, 500, 34, 66, 500, 500, 500, 500, 128, 54, 64, 40, 82, 500, 500, 500, 500, 460, 500, 500, 86, 60, 188, 404, 270, 40, 194, 60, 500, 500, 500, 84, 500, 500, 500, 146, 106, 500, 500, 500, 136, 500, 408, 500, 500, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3774283526372303, "mean_inference_ms": 1.2032018292719784, "mean_action_processing_ms": 0.13991901656101113, "mean_env_wait_ms": 0.0829869390529927, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02410602569580078, "StateBufferConnector_ms": 0.004507541656494141, "ViewRequirementAgentConnector_ms": 0.12250566482543945}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000, "num_env_steps_sampled": 900000, "num_env_steps_trained": 900000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5746.9436273700085, "num_env_steps_trained_throughput_per_sec": 5746.9436273700085, "timesteps_total": 900000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 900000, "timers": {"training_iteration_time_ms": 3193.414, "sample_time_ms": 2830.706, "load_time_ms": 18.766, "load_throughput": 959195.012, "learn_time_ms": 332.337, "learn_throughput": 54161.882, "synch_weights_time_ms": 9.202}, "counters": {"num_env_steps_sampled": 900000, "num_env_steps_trained": 900000, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000}, "done": false, "episodes_total": 3434, "training_iteration": 50, "trial_id": "9f288_00015", "date": "2023-10-25_16-49-22", "timestamp": 1698248962, "time_this_iter_s": 3.1370980739593506, "time_total_s": 160.54398703575134, "pid": 4200, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 160.54398703575134, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 59.650000000000006, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.7763568394002508e-16, "cur_lr": 0.0003, "total_loss": 6.52820086479187, "policy_loss": 0.05543210441901465, "vf_loss": 6.472821426391602, "vf_explained_var": -5.78165054321289e-07, "kl": 0.0014206098516297062, "entropy": 0.5275081425905228, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1010.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 918000, "num_env_steps_trained": 918000, "num_agent_steps_sampled": 918000, "num_agent_steps_trained": 918000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -4.171000000000223, "episode_len_mean": 307.24, "episode_media": {}, "episodes_this_iter": 60, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 37.300000000000026, 44.7, 43.7, 46.099999999999994, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 4.099999999999618, -50.00000000000044, -50.00000000000044, 41.500000000000014, 44.10000000000001, 31.300000000000004, 9.699999999999697, 23.099999999999888, 46.099999999999994, 30.699999999999996, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.500000000000036, 39.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.50000000000003, -50.00000000000044, 9.299999999999692, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 41.30000000000001, 44.300000000000004, 40.30000000000002, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 41.90000000000001, 18.29999999999982, 45.7, -50.00000000000044, 46.5, 21.09999999999986, 39.10000000000002, -50.00000000000044, 23.8999999999999, -50.00000000000044, 46.9, 43.50000000000001, -50.00000000000044, -50.00000000000044, 6.499999999999652, 39.300000000000026, -50.00000000000044, 42.30000000000001, 38.700000000000024, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 35.30000000000004, -50.00000000000044, -50.00000000000044, 45.5, 30.29999999999999, -50.00000000000044, -50.00000000000044, 44.5, 31.500000000000007, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.9, -50.00000000000044, 45.7, 16.499999999999794, 41.70000000000002, 33.30000000000003, -50.00000000000044, 39.300000000000026, 44.900000000000006, -50.00000000000044, 45.1, 41.90000000000001, -50.00000000000044], "episode_lengths": [500, 500, 128, 54, 64, 40, 82, 500, 500, 500, 500, 460, 500, 500, 86, 60, 188, 404, 270, 40, 194, 60, 500, 500, 500, 84, 500, 500, 500, 146, 106, 500, 500, 500, 136, 500, 408, 500, 500, 46, 500, 500, 88, 58, 98, 88, 500, 500, 500, 500, 58, 82, 318, 44, 500, 36, 290, 110, 500, 262, 500, 32, 66, 500, 500, 436, 108, 500, 78, 114, 500, 500, 52, 500, 500, 148, 500, 500, 46, 198, 500, 500, 56, 186, 500, 500, 500, 192, 500, 44, 336, 84, 168, 500, 108, 52, 500, 50, 82, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3771595576892014, "mean_inference_ms": 1.2027956541636589, "mean_action_processing_ms": 0.14005946423414728, "mean_env_wait_ms": 0.08305454572100064, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026111841201782227, "StateBufferConnector_ms": 0.0045130252838134766, "ViewRequirementAgentConnector_ms": 0.1309044361114502}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -4.171000000000223, "episode_len_mean": 307.24, "episodes_this_iter": 60, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 37.300000000000026, 44.7, 43.7, 46.099999999999994, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 4.099999999999618, -50.00000000000044, -50.00000000000044, 41.500000000000014, 44.10000000000001, 31.300000000000004, 9.699999999999697, 23.099999999999888, 46.099999999999994, 30.699999999999996, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.500000000000036, 39.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.50000000000003, -50.00000000000044, 9.299999999999692, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 41.30000000000001, 44.300000000000004, 40.30000000000002, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 41.90000000000001, 18.29999999999982, 45.7, -50.00000000000044, 46.5, 21.09999999999986, 39.10000000000002, -50.00000000000044, 23.8999999999999, -50.00000000000044, 46.9, 43.50000000000001, -50.00000000000044, -50.00000000000044, 6.499999999999652, 39.300000000000026, -50.00000000000044, 42.30000000000001, 38.700000000000024, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 35.30000000000004, -50.00000000000044, -50.00000000000044, 45.5, 30.29999999999999, -50.00000000000044, -50.00000000000044, 44.5, 31.500000000000007, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.9, -50.00000000000044, 45.7, 16.499999999999794, 41.70000000000002, 33.30000000000003, -50.00000000000044, 39.300000000000026, 44.900000000000006, -50.00000000000044, 45.1, 41.90000000000001, -50.00000000000044], "episode_lengths": [500, 500, 128, 54, 64, 40, 82, 500, 500, 500, 500, 460, 500, 500, 86, 60, 188, 404, 270, 40, 194, 60, 500, 500, 500, 84, 500, 500, 500, 146, 106, 500, 500, 500, 136, 500, 408, 500, 500, 46, 500, 500, 88, 58, 98, 88, 500, 500, 500, 500, 58, 82, 318, 44, 500, 36, 290, 110, 500, 262, 500, 32, 66, 500, 500, 436, 108, 500, 78, 114, 500, 500, 52, 500, 500, 148, 500, 500, 46, 198, 500, 500, 56, 186, 500, 500, 500, 192, 500, 44, 336, 84, 168, 500, 108, 52, 500, 50, 82, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3771595576892014, "mean_inference_ms": 1.2027956541636589, "mean_action_processing_ms": 0.14005946423414728, "mean_env_wait_ms": 0.08305454572100064, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026111841201782227, "StateBufferConnector_ms": 0.0045130252838134766, "ViewRequirementAgentConnector_ms": 0.1309044361114502}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 918000, "num_agent_steps_trained": 918000, "num_env_steps_sampled": 918000, "num_env_steps_trained": 918000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5616.770049694828, "num_env_steps_trained_throughput_per_sec": 5616.770049694828, "timesteps_total": 918000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 918000, "timers": {"training_iteration_time_ms": 3189.457, "sample_time_ms": 2833.844, "load_time_ms": 18.753, "load_throughput": 959834.013, "learn_time_ms": 325.183, "learn_throughput": 55353.486, "synch_weights_time_ms": 9.273}, "counters": {"num_env_steps_sampled": 918000, "num_env_steps_trained": 918000, "num_agent_steps_sampled": 918000, "num_agent_steps_trained": 918000}, "done": false, "episodes_total": 3494, "training_iteration": 51, "trial_id": "9f288_00015", "date": "2023-10-25_16-49-26", "timestamp": 1698248966, "time_this_iter_s": 3.2099668979644775, "time_total_s": 163.75395393371582, "pid": 4200, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 163.75395393371582, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 58.459999999999994, "ram_util_percent": 27.22}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.881784197001254e-17, "cur_lr": 0.0003, "total_loss": 6.897119688987732, "policy_loss": -0.0072925508255138995, "vf_loss": 6.904465842247009, "vf_explained_var": -1.817941665649414e-06, "kl": 0.000683025868590903, "entropy": 0.5362197101116181, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1030.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 936000, "num_env_steps_trained": 936000, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.845999999999838, "episode_len_mean": 242.22, "episode_media": {}, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 45.5, 30.29999999999999, -50.00000000000044, -50.00000000000044, 44.5, 31.500000000000007, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.9, -50.00000000000044, 45.7, 16.499999999999794, 41.70000000000002, 33.30000000000003, -50.00000000000044, 39.300000000000026, 44.900000000000006, -50.00000000000044, 45.1, 41.90000000000001, -50.00000000000044, -50.00000000000044, 44.10000000000001, 40.70000000000002, -50.00000000000044, 44.5, 45.3, 46.099999999999994, 41.30000000000001, 41.90000000000001, -50.00000000000044, 45.3, 45.7, 45.9, 43.10000000000001, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 46.3, -50.00000000000044, 46.3, -50.00000000000044, 24.499999999999908, 20.699999999999854, 26.89999999999994, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, 46.5, 46.099999999999994, 46.5, 29.899999999999984, -50.00000000000044, -50.00000000000044, 45.3, 46.3, 35.500000000000036, 42.30000000000001, -50.00000000000044, 39.300000000000026, 41.30000000000001, 46.099999999999994, -50.00000000000044, 26.89999999999994, 39.50000000000002, 45.1, 43.7, 44.900000000000006, 40.500000000000014, 13.099999999999746, 43.900000000000006, 6.299999999999649, 43.50000000000001, -50.00000000000044, -50.00000000000044, 41.30000000000001, 6.099999999999646, 9.8999999999997, 20.299999999999848, 43.10000000000001, 42.10000000000001, -50.00000000000044, -50.00000000000044, 42.900000000000006, 19.299999999999834, 46.699999999999996, 44.7, -50.00000000000044, 21.09999999999986, 44.900000000000006, 44.900000000000006, 30.099999999999987, -50.00000000000044, 46.099999999999994, 43.900000000000006], "episode_lengths": [500, 500, 46, 198, 500, 500, 56, 186, 500, 500, 500, 192, 500, 44, 336, 84, 168, 500, 108, 52, 500, 50, 82, 500, 500, 60, 94, 500, 56, 48, 40, 88, 82, 500, 48, 44, 42, 70, 500, 500, 58, 500, 38, 500, 38, 500, 256, 294, 232, 500, 500, 94, 500, 36, 40, 36, 202, 500, 500, 48, 38, 146, 78, 500, 108, 88, 40, 500, 232, 106, 50, 64, 52, 96, 370, 62, 438, 66, 500, 500, 88, 440, 402, 298, 70, 80, 500, 500, 72, 308, 34, 54, 500, 290, 52, 52, 200, 500, 40, 62]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37724090785929576, "mean_inference_ms": 1.2028556137067268, "mean_action_processing_ms": 0.14010778098403198, "mean_env_wait_ms": 0.08286850585912926, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025996923446655273, "StateBufferConnector_ms": 0.004002809524536133, "ViewRequirementAgentConnector_ms": 0.12403631210327148}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.845999999999838, "episode_len_mean": 242.22, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 45.5, 30.29999999999999, -50.00000000000044, -50.00000000000044, 44.5, 31.500000000000007, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.9, -50.00000000000044, 45.7, 16.499999999999794, 41.70000000000002, 33.30000000000003, -50.00000000000044, 39.300000000000026, 44.900000000000006, -50.00000000000044, 45.1, 41.90000000000001, -50.00000000000044, -50.00000000000044, 44.10000000000001, 40.70000000000002, -50.00000000000044, 44.5, 45.3, 46.099999999999994, 41.30000000000001, 41.90000000000001, -50.00000000000044, 45.3, 45.7, 45.9, 43.10000000000001, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 46.3, -50.00000000000044, 46.3, -50.00000000000044, 24.499999999999908, 20.699999999999854, 26.89999999999994, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, 46.5, 46.099999999999994, 46.5, 29.899999999999984, -50.00000000000044, -50.00000000000044, 45.3, 46.3, 35.500000000000036, 42.30000000000001, -50.00000000000044, 39.300000000000026, 41.30000000000001, 46.099999999999994, -50.00000000000044, 26.89999999999994, 39.50000000000002, 45.1, 43.7, 44.900000000000006, 40.500000000000014, 13.099999999999746, 43.900000000000006, 6.299999999999649, 43.50000000000001, -50.00000000000044, -50.00000000000044, 41.30000000000001, 6.099999999999646, 9.8999999999997, 20.299999999999848, 43.10000000000001, 42.10000000000001, -50.00000000000044, -50.00000000000044, 42.900000000000006, 19.299999999999834, 46.699999999999996, 44.7, -50.00000000000044, 21.09999999999986, 44.900000000000006, 44.900000000000006, 30.099999999999987, -50.00000000000044, 46.099999999999994, 43.900000000000006], "episode_lengths": [500, 500, 46, 198, 500, 500, 56, 186, 500, 500, 500, 192, 500, 44, 336, 84, 168, 500, 108, 52, 500, 50, 82, 500, 500, 60, 94, 500, 56, 48, 40, 88, 82, 500, 48, 44, 42, 70, 500, 500, 58, 500, 38, 500, 38, 500, 256, 294, 232, 500, 500, 94, 500, 36, 40, 36, 202, 500, 500, 48, 38, 146, 78, 500, 108, 88, 40, 500, 232, 106, 50, 64, 52, 96, 370, 62, 438, 66, 500, 500, 88, 440, 402, 298, 70, 80, 500, 500, 72, 308, 34, 54, 500, 290, 52, 52, 200, 500, 40, 62]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37724090785929576, "mean_inference_ms": 1.2028556137067268, "mean_action_processing_ms": 0.14010778098403198, "mean_env_wait_ms": 0.08286850585912926, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025996923446655273, "StateBufferConnector_ms": 0.004002809524536133, "ViewRequirementAgentConnector_ms": 0.12403631210327148}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000, "num_env_steps_sampled": 936000, "num_env_steps_trained": 936000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5645.040949600957, "num_env_steps_trained_throughput_per_sec": 5645.040949600957, "timesteps_total": 936000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 936000, "timers": {"training_iteration_time_ms": 3184.649, "sample_time_ms": 2830.749, "load_time_ms": 19.498, "load_throughput": 923164.15, "learn_time_ms": 322.759, "learn_throughput": 55769.18, "synch_weights_time_ms": 9.24}, "counters": {"num_env_steps_sampled": 936000, "num_env_steps_trained": 936000, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000}, "done": false, "episodes_total": 3570, "training_iteration": 52, "trial_id": "9f288_00015", "date": "2023-10-25_16-49-29", "timestamp": 1698248969, "time_this_iter_s": 3.193983793258667, "time_total_s": 166.9479377269745, "pid": 4200, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 166.9479377269745, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 60.45, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.440892098500627e-17, "cur_lr": 0.0003, "total_loss": 7.15700933933258, "policy_loss": -0.046156420931220056, "vf_loss": 7.203218936920166, "vf_explained_var": -1.5556812286376954e-06, "kl": 0.00082139052824175, "entropy": 0.5319513484835625, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1050.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 954000, "num_env_steps_trained": 954000, "num_agent_steps_sampled": 954000, "num_agent_steps_trained": 954000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.620999999999844, "episode_len_mean": 239.5, "episode_media": {}, "episodes_this_iter": 80, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.30000000000001, 6.099999999999646, 9.8999999999997, 20.299999999999848, 43.10000000000001, 42.10000000000001, -50.00000000000044, -50.00000000000044, 42.900000000000006, 19.299999999999834, 46.699999999999996, 44.7, -50.00000000000044, 21.09999999999986, 44.900000000000006, 44.900000000000006, 30.099999999999987, -50.00000000000044, 46.099999999999994, 43.900000000000006, -50.00000000000044, 42.900000000000006, 32.90000000000003, 40.10000000000002, -50.00000000000044, -50.00000000000044, 41.90000000000001, 46.9, -50.00000000000044, 27.699999999999953, 37.300000000000026, -50.00000000000044, 45.9, 45.5, 43.900000000000006, 43.7, 39.300000000000026, -50.00000000000044, -50.00000000000044, 35.70000000000003, -50.00000000000044, 43.900000000000006, 45.9, 42.30000000000001, 44.7, 8.699999999999683, 46.099999999999994, 45.5, 45.9, 36.30000000000003, 42.900000000000006, 42.10000000000001, -50.00000000000044, 45.7, 44.7, 44.7, -50.00000000000044, 44.900000000000006, 43.900000000000006, 32.30000000000002, 45.5, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 40.30000000000002, -50.00000000000044, 28.699999999999967, -50.00000000000044, 46.099999999999994, 43.50000000000001, 6.699999999999655, -50.00000000000044, 27.699999999999953, 25.699999999999925, 44.7, -50.00000000000044, 33.10000000000003, 38.300000000000026, 40.70000000000002, 42.500000000000014, 29.099999999999973, 20.49999999999985, 4.499999999999623, 11.29999999999972, -50.00000000000044, 43.10000000000001, 41.90000000000001, 43.7, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 7.299999999999663, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [88, 440, 402, 298, 70, 80, 500, 500, 72, 308, 34, 54, 500, 290, 52, 52, 200, 500, 40, 62, 500, 72, 172, 100, 500, 500, 82, 32, 500, 224, 128, 500, 42, 46, 62, 64, 108, 500, 500, 144, 500, 62, 42, 78, 54, 414, 40, 46, 42, 138, 72, 80, 500, 44, 54, 54, 500, 52, 62, 178, 46, 60, 500, 500, 500, 84, 500, 98, 500, 214, 500, 40, 66, 434, 500, 224, 244, 54, 500, 170, 118, 94, 76, 210, 296, 456, 388, 500, 70, 82, 64, 500, 500, 42, 500, 428, 62, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3772870497640867, "mean_inference_ms": 1.2023244899585586, "mean_action_processing_ms": 0.1396614905052397, "mean_env_wait_ms": 0.08303849821991185, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03399968147277832, "StateBufferConnector_ms": 0.003999471664428711, "ViewRequirementAgentConnector_ms": 0.12797141075134277}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.620999999999844, "episode_len_mean": 239.5, "episodes_this_iter": 80, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [41.30000000000001, 6.099999999999646, 9.8999999999997, 20.299999999999848, 43.10000000000001, 42.10000000000001, -50.00000000000044, -50.00000000000044, 42.900000000000006, 19.299999999999834, 46.699999999999996, 44.7, -50.00000000000044, 21.09999999999986, 44.900000000000006, 44.900000000000006, 30.099999999999987, -50.00000000000044, 46.099999999999994, 43.900000000000006, -50.00000000000044, 42.900000000000006, 32.90000000000003, 40.10000000000002, -50.00000000000044, -50.00000000000044, 41.90000000000001, 46.9, -50.00000000000044, 27.699999999999953, 37.300000000000026, -50.00000000000044, 45.9, 45.5, 43.900000000000006, 43.7, 39.300000000000026, -50.00000000000044, -50.00000000000044, 35.70000000000003, -50.00000000000044, 43.900000000000006, 45.9, 42.30000000000001, 44.7, 8.699999999999683, 46.099999999999994, 45.5, 45.9, 36.30000000000003, 42.900000000000006, 42.10000000000001, -50.00000000000044, 45.7, 44.7, 44.7, -50.00000000000044, 44.900000000000006, 43.900000000000006, 32.30000000000002, 45.5, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 40.30000000000002, -50.00000000000044, 28.699999999999967, -50.00000000000044, 46.099999999999994, 43.50000000000001, 6.699999999999655, -50.00000000000044, 27.699999999999953, 25.699999999999925, 44.7, -50.00000000000044, 33.10000000000003, 38.300000000000026, 40.70000000000002, 42.500000000000014, 29.099999999999973, 20.49999999999985, 4.499999999999623, 11.29999999999972, -50.00000000000044, 43.10000000000001, 41.90000000000001, 43.7, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 7.299999999999663, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [88, 440, 402, 298, 70, 80, 500, 500, 72, 308, 34, 54, 500, 290, 52, 52, 200, 500, 40, 62, 500, 72, 172, 100, 500, 500, 82, 32, 500, 224, 128, 500, 42, 46, 62, 64, 108, 500, 500, 144, 500, 62, 42, 78, 54, 414, 40, 46, 42, 138, 72, 80, 500, 44, 54, 54, 500, 52, 62, 178, 46, 60, 500, 500, 500, 84, 500, 98, 500, 214, 500, 40, 66, 434, 500, 224, 244, 54, 500, 170, 118, 94, 76, 210, 296, 456, 388, 500, 70, 82, 64, 500, 500, 42, 500, 428, 62, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3772870497640867, "mean_inference_ms": 1.2023244899585586, "mean_action_processing_ms": 0.1396614905052397, "mean_env_wait_ms": 0.08303849821991185, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03399968147277832, "StateBufferConnector_ms": 0.003999471664428711, "ViewRequirementAgentConnector_ms": 0.12797141075134277}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 954000, "num_agent_steps_trained": 954000, "num_env_steps_sampled": 954000, "num_env_steps_trained": 954000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5805.743618389766, "num_env_steps_trained_throughput_per_sec": 5805.743618389766, "timesteps_total": 954000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 954000, "timers": {"training_iteration_time_ms": 3168.965, "sample_time_ms": 2827.48, "load_time_ms": 18.78, "load_throughput": 958443.689, "learn_time_ms": 311.437, "learn_throughput": 57796.51, "synch_weights_time_ms": 9.064}, "counters": {"num_env_steps_sampled": 954000, "num_env_steps_trained": 954000, "num_agent_steps_sampled": 954000, "num_agent_steps_trained": 954000}, "done": false, "episodes_total": 3650, "training_iteration": 53, "trial_id": "9f288_00015", "date": "2023-10-25_16-49-32", "timestamp": 1698248972, "time_this_iter_s": 3.105374336242676, "time_total_s": 170.05331206321716, "pid": 4200, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 170.05331206321716, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 58.080000000000005, "ram_util_percent": 27.22}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.2204460492503135e-17, "cur_lr": 0.0003, "total_loss": 6.445796084403992, "policy_loss": 0.01320305373519659, "vf_loss": 6.432643938064575, "vf_explained_var": -1.5914440155029296e-06, "kl": 0.0006397696757687755, "entropy": 0.5092441156506539, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1070.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 972000, "num_env_steps_trained": 972000, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.753999999999823, "episode_len_mean": 263.1, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.099999999999994, 43.50000000000001, 6.699999999999655, -50.00000000000044, 27.699999999999953, 25.699999999999925, 44.7, -50.00000000000044, 33.10000000000003, 38.300000000000026, 40.70000000000002, 42.500000000000014, 29.099999999999973, 20.49999999999985, 4.499999999999623, 11.29999999999972, -50.00000000000044, 43.10000000000001, 41.90000000000001, 43.7, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 7.299999999999663, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 35.900000000000034, 45.9, -50.00000000000044, 39.10000000000002, 42.900000000000006, 45.9, 45.5, -50.00000000000044, 11.29999999999972, 46.5, 45.3, 36.50000000000003, 44.7, -50.00000000000044, -50.00000000000044, 42.10000000000001, 32.100000000000016, -50.00000000000044, 14.499999999999766, 44.300000000000004, 35.10000000000004, -50.00000000000044, 35.900000000000034, 31.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.900000000000013, 37.90000000000003, -50.00000000000044, 46.9, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 45.5, 36.50000000000003, -50.00000000000044, 42.900000000000006, 34.50000000000004, 38.10000000000002, -50.00000000000044, 47.3, -50.00000000000044, 12.099999999999731, -50.00000000000044, 35.30000000000004, 42.10000000000001, -50.00000000000044, -50.00000000000044, 47.1, 38.700000000000024, 39.90000000000002, 45.5, -50.00000000000044, 46.099999999999994, -50.00000000000044, 42.70000000000001, 41.100000000000016, -50.00000000000044, 46.9, -50.00000000000044, 41.30000000000001, 41.90000000000001, 45.3], "episode_lengths": [500, 40, 66, 434, 500, 224, 244, 54, 500, 170, 118, 94, 76, 210, 296, 456, 388, 500, 70, 82, 64, 500, 500, 42, 500, 428, 62, 500, 500, 500, 500, 82, 500, 142, 42, 500, 110, 72, 42, 46, 500, 388, 36, 48, 136, 54, 500, 500, 80, 180, 500, 356, 58, 150, 500, 142, 184, 500, 500, 500, 182, 122, 500, 32, 50, 500, 500, 500, 46, 500, 46, 136, 500, 72, 156, 120, 500, 28, 500, 380, 500, 148, 80, 500, 500, 30, 114, 102, 46, 500, 40, 500, 74, 90, 500, 32, 500, 88, 82, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37737270441384996, "mean_inference_ms": 1.2036019833779863, "mean_action_processing_ms": 0.14019435348467454, "mean_env_wait_ms": 0.08271704073230701, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025990724563598633, "StateBufferConnector_ms": 0.004995584487915039, "ViewRequirementAgentConnector_ms": 0.12698602676391602}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.753999999999823, "episode_len_mean": 263.1, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.099999999999994, 43.50000000000001, 6.699999999999655, -50.00000000000044, 27.699999999999953, 25.699999999999925, 44.7, -50.00000000000044, 33.10000000000003, 38.300000000000026, 40.70000000000002, 42.500000000000014, 29.099999999999973, 20.49999999999985, 4.499999999999623, 11.29999999999972, -50.00000000000044, 43.10000000000001, 41.90000000000001, 43.7, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 7.299999999999663, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 35.900000000000034, 45.9, -50.00000000000044, 39.10000000000002, 42.900000000000006, 45.9, 45.5, -50.00000000000044, 11.29999999999972, 46.5, 45.3, 36.50000000000003, 44.7, -50.00000000000044, -50.00000000000044, 42.10000000000001, 32.100000000000016, -50.00000000000044, 14.499999999999766, 44.300000000000004, 35.10000000000004, -50.00000000000044, 35.900000000000034, 31.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.900000000000013, 37.90000000000003, -50.00000000000044, 46.9, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 45.5, 36.50000000000003, -50.00000000000044, 42.900000000000006, 34.50000000000004, 38.10000000000002, -50.00000000000044, 47.3, -50.00000000000044, 12.099999999999731, -50.00000000000044, 35.30000000000004, 42.10000000000001, -50.00000000000044, -50.00000000000044, 47.1, 38.700000000000024, 39.90000000000002, 45.5, -50.00000000000044, 46.099999999999994, -50.00000000000044, 42.70000000000001, 41.100000000000016, -50.00000000000044, 46.9, -50.00000000000044, 41.30000000000001, 41.90000000000001, 45.3], "episode_lengths": [500, 40, 66, 434, 500, 224, 244, 54, 500, 170, 118, 94, 76, 210, 296, 456, 388, 500, 70, 82, 64, 500, 500, 42, 500, 428, 62, 500, 500, 500, 500, 82, 500, 142, 42, 500, 110, 72, 42, 46, 500, 388, 36, 48, 136, 54, 500, 500, 80, 180, 500, 356, 58, 150, 500, 142, 184, 500, 500, 500, 182, 122, 500, 32, 50, 500, 500, 500, 46, 500, 46, 136, 500, 72, 156, 120, 500, 28, 500, 380, 500, 148, 80, 500, 500, 30, 114, 102, 46, 500, 40, 500, 74, 90, 500, 32, 500, 88, 82, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37737270441384996, "mean_inference_ms": 1.2036019833779863, "mean_action_processing_ms": 0.14019435348467454, "mean_env_wait_ms": 0.08271704073230701, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025990724563598633, "StateBufferConnector_ms": 0.004995584487915039, "ViewRequirementAgentConnector_ms": 0.12698602676391602}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000, "num_env_steps_sampled": 972000, "num_env_steps_trained": 972000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5672.810488573826, "num_env_steps_trained_throughput_per_sec": 5672.810488573826, "timesteps_total": 972000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 972000, "timers": {"training_iteration_time_ms": 3164.262, "sample_time_ms": 2829.114, "load_time_ms": 17.863, "load_throughput": 1007660.774, "learn_time_ms": 305.852, "learn_throughput": 58852.066, "synch_weights_time_ms": 9.129}, "counters": {"num_env_steps_sampled": 972000, "num_env_steps_trained": 972000, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000}, "done": false, "episodes_total": 3720, "training_iteration": 54, "trial_id": "9f288_00015", "date": "2023-10-25_16-49-35", "timestamp": 1698248975, "time_this_iter_s": 3.180123805999756, "time_total_s": 173.23343586921692, "pid": 4200, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 173.23343586921692, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 63.724999999999994, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1102230246251568e-17, "cur_lr": 0.0003, "total_loss": 6.6945950269699095, "policy_loss": -0.021770598739385603, "vf_loss": 6.716416263580323, "vf_explained_var": -1.9490718841552736e-06, "kl": 0.00022702511011516436, "entropy": 0.506807117164135, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1090.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 990000, "num_env_steps_trained": 990000, "num_agent_steps_sampled": 990000, "num_agent_steps_trained": 990000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.7479999999998235, "episode_len_mean": 253.14, "episode_media": {}, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 42.900000000000006, 34.50000000000004, 38.10000000000002, -50.00000000000044, 47.3, -50.00000000000044, 12.099999999999731, -50.00000000000044, 35.30000000000004, 42.10000000000001, -50.00000000000044, -50.00000000000044, 47.1, 38.700000000000024, 39.90000000000002, 45.5, -50.00000000000044, 46.099999999999994, -50.00000000000044, 42.70000000000001, 41.100000000000016, -50.00000000000044, 46.9, -50.00000000000044, 41.30000000000001, 41.90000000000001, 45.3, -50.00000000000044, 47.7, 46.5, 43.50000000000001, 24.099999999999902, -50.00000000000044, 44.300000000000004, 42.900000000000006, 45.7, -50.00000000000044, 45.9, 26.69999999999994, 45.1, -50.00000000000044, 43.10000000000001, 24.499999999999908, 40.70000000000002, 25.699999999999925, -50.00000000000044, 37.300000000000026, 39.70000000000002, 43.7, 45.5, 45.3, -50.00000000000044, -50.00000000000044, 30.29999999999999, 45.9, 46.699999999999996, 20.49999999999985, 46.099999999999994, -50.00000000000044, 42.70000000000001, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 44.7, 45.7, 40.500000000000014, 42.70000000000001, 31.500000000000007, -50.00000000000044, -50.00000000000044, 43.7, 31.900000000000013, -50.00000000000044, -50.00000000000044, 42.500000000000014, 40.10000000000002, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 13.499999999999751, 45.9, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 46.3, 18.899999999999828, -50.00000000000044], "episode_lengths": [500, 72, 156, 120, 500, 28, 500, 380, 500, 148, 80, 500, 500, 30, 114, 102, 46, 500, 40, 500, 74, 90, 500, 32, 500, 88, 82, 48, 500, 24, 36, 66, 260, 500, 58, 72, 44, 500, 42, 234, 50, 500, 70, 256, 94, 244, 500, 128, 104, 64, 46, 48, 500, 500, 198, 42, 34, 296, 40, 500, 74, 44, 500, 500, 500, 500, 48, 500, 44, 500, 500, 54, 44, 96, 74, 186, 500, 500, 64, 182, 500, 500, 76, 100, 500, 500, 50, 500, 366, 42, 92, 500, 500, 500, 500, 500, 48, 38, 312, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3774205238128068, "mean_inference_ms": 1.2032087933785407, "mean_action_processing_ms": 0.1400898403054297, "mean_env_wait_ms": 0.08281876374933024, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029988527297973633, "StateBufferConnector_ms": 0.009997367858886719, "ViewRequirementAgentConnector_ms": 0.10099363327026367}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.7479999999998235, "episode_len_mean": 253.14, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 42.900000000000006, 34.50000000000004, 38.10000000000002, -50.00000000000044, 47.3, -50.00000000000044, 12.099999999999731, -50.00000000000044, 35.30000000000004, 42.10000000000001, -50.00000000000044, -50.00000000000044, 47.1, 38.700000000000024, 39.90000000000002, 45.5, -50.00000000000044, 46.099999999999994, -50.00000000000044, 42.70000000000001, 41.100000000000016, -50.00000000000044, 46.9, -50.00000000000044, 41.30000000000001, 41.90000000000001, 45.3, -50.00000000000044, 47.7, 46.5, 43.50000000000001, 24.099999999999902, -50.00000000000044, 44.300000000000004, 42.900000000000006, 45.7, -50.00000000000044, 45.9, 26.69999999999994, 45.1, -50.00000000000044, 43.10000000000001, 24.499999999999908, 40.70000000000002, 25.699999999999925, -50.00000000000044, 37.300000000000026, 39.70000000000002, 43.7, 45.5, 45.3, -50.00000000000044, -50.00000000000044, 30.29999999999999, 45.9, 46.699999999999996, 20.49999999999985, 46.099999999999994, -50.00000000000044, 42.70000000000001, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 44.7, 45.7, 40.500000000000014, 42.70000000000001, 31.500000000000007, -50.00000000000044, -50.00000000000044, 43.7, 31.900000000000013, -50.00000000000044, -50.00000000000044, 42.500000000000014, 40.10000000000002, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 13.499999999999751, 45.9, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 46.3, 18.899999999999828, -50.00000000000044], "episode_lengths": [500, 72, 156, 120, 500, 28, 500, 380, 500, 148, 80, 500, 500, 30, 114, 102, 46, 500, 40, 500, 74, 90, 500, 32, 500, 88, 82, 48, 500, 24, 36, 66, 260, 500, 58, 72, 44, 500, 42, 234, 50, 500, 70, 256, 94, 244, 500, 128, 104, 64, 46, 48, 500, 500, 198, 42, 34, 296, 40, 500, 74, 44, 500, 500, 500, 500, 48, 500, 44, 500, 500, 54, 44, 96, 74, 186, 500, 500, 64, 182, 500, 500, 76, 100, 500, 500, 50, 500, 366, 42, 92, 500, 500, 500, 500, 500, 48, 38, 312, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3774205238128068, "mean_inference_ms": 1.2032087933785407, "mean_action_processing_ms": 0.1400898403054297, "mean_env_wait_ms": 0.08281876374933024, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029988527297973633, "StateBufferConnector_ms": 0.009997367858886719, "ViewRequirementAgentConnector_ms": 0.10099363327026367}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 990000, "num_agent_steps_trained": 990000, "num_env_steps_sampled": 990000, "num_env_steps_trained": 990000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5563.000548655485, "num_env_steps_trained_throughput_per_sec": 5563.000548655485, "timesteps_total": 990000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 990000, "timers": {"training_iteration_time_ms": 3176.625, "sample_time_ms": 2835.859, "load_time_ms": 18.812, "load_throughput": 956845.119, "learn_time_ms": 310.575, "learn_throughput": 57957.08, "synch_weights_time_ms": 9.175}, "counters": {"num_env_steps_sampled": 990000, "num_env_steps_trained": 990000, "num_agent_steps_sampled": 990000, "num_agent_steps_trained": 990000}, "done": false, "episodes_total": 3792, "training_iteration": 55, "trial_id": "9f288_00015", "date": "2023-10-25_16-49-38", "timestamp": 1698248978, "time_this_iter_s": 3.2406606674194336, "time_total_s": 176.47409653663635, "pid": 4200, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 176.47409653663635, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 58.580000000000005, "ram_util_percent": 27.240000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.551115123125784e-18, "cur_lr": 0.0003, "total_loss": 6.431297779083252, "policy_loss": -0.017048770504334242, "vf_loss": 6.448396062850952, "vf_explained_var": -4.798173904418946e-07, "kl": 0.0005092806615323298, "entropy": 0.4955423057079315, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1110.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 1008000, "num_env_steps_trained": 1008000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.443000000000209, "episode_len_mean": 279.98, "episode_media": {}, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 44.7, 45.7, 40.500000000000014, 42.70000000000001, 31.500000000000007, -50.00000000000044, -50.00000000000044, 43.7, 31.900000000000013, -50.00000000000044, -50.00000000000044, 42.500000000000014, 40.10000000000002, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 13.499999999999751, 45.9, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 46.3, 18.899999999999828, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 44.10000000000001, 43.7, -50.00000000000044, 36.10000000000004, -50.00000000000044, 45.3, 47.1, 45.5, 45.9, -50.00000000000044, 45.1, 45.1, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 46.099999999999994, -50.00000000000044, 44.300000000000004, 43.30000000000001, 25.899999999999928, 45.1, 43.900000000000006, -50.00000000000044, 45.1, 44.5, 46.5, -50.00000000000044, -50.00000000000044, 38.700000000000024, 45.5, -50.00000000000044, 34.900000000000034, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.49999999999998, 45.5, -50.00000000000044, 12.499999999999737, 27.899999999999956, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 44.10000000000001, 8.299999999999677, -50.00000000000044, 45.3, 44.10000000000001, -50.00000000000044, -50.00000000000044, 46.9, 39.70000000000002, -50.00000000000044, 47.1, 30.699999999999996, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 44, 500, 500, 54, 44, 96, 74, 186, 500, 500, 64, 182, 500, 500, 76, 100, 500, 500, 50, 500, 366, 42, 92, 500, 500, 500, 500, 500, 48, 38, 312, 500, 500, 500, 500, 500, 34, 60, 64, 500, 140, 500, 48, 30, 46, 42, 500, 50, 50, 500, 500, 60, 500, 40, 500, 58, 68, 242, 50, 62, 500, 50, 56, 36, 500, 500, 114, 46, 500, 152, 80, 500, 500, 500, 206, 46, 500, 376, 222, 500, 500, 500, 54, 60, 418, 500, 48, 60, 500, 500, 32, 104, 500, 30, 194, 500, 102, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3774170513752676, "mean_inference_ms": 1.2032919309470949, "mean_action_processing_ms": 0.13978439624504205, "mean_env_wait_ms": 0.08284939438429202, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02699565887451172, "StateBufferConnector_ms": 0.009999990463256836, "ViewRequirementAgentConnector_ms": 0.09198307991027832}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.443000000000209, "episode_len_mean": 279.98, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 44.7, 45.7, 40.500000000000014, 42.70000000000001, 31.500000000000007, -50.00000000000044, -50.00000000000044, 43.7, 31.900000000000013, -50.00000000000044, -50.00000000000044, 42.500000000000014, 40.10000000000002, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 13.499999999999751, 45.9, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 46.3, 18.899999999999828, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 44.10000000000001, 43.7, -50.00000000000044, 36.10000000000004, -50.00000000000044, 45.3, 47.1, 45.5, 45.9, -50.00000000000044, 45.1, 45.1, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 46.099999999999994, -50.00000000000044, 44.300000000000004, 43.30000000000001, 25.899999999999928, 45.1, 43.900000000000006, -50.00000000000044, 45.1, 44.5, 46.5, -50.00000000000044, -50.00000000000044, 38.700000000000024, 45.5, -50.00000000000044, 34.900000000000034, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.49999999999998, 45.5, -50.00000000000044, 12.499999999999737, 27.899999999999956, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 44.10000000000001, 8.299999999999677, -50.00000000000044, 45.3, 44.10000000000001, -50.00000000000044, -50.00000000000044, 46.9, 39.70000000000002, -50.00000000000044, 47.1, 30.699999999999996, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 44, 500, 500, 54, 44, 96, 74, 186, 500, 500, 64, 182, 500, 500, 76, 100, 500, 500, 50, 500, 366, 42, 92, 500, 500, 500, 500, 500, 48, 38, 312, 500, 500, 500, 500, 500, 34, 60, 64, 500, 140, 500, 48, 30, 46, 42, 500, 50, 50, 500, 500, 60, 500, 40, 500, 58, 68, 242, 50, 62, 500, 50, 56, 36, 500, 500, 114, 46, 500, 152, 80, 500, 500, 500, 206, 46, 500, 376, 222, 500, 500, 500, 54, 60, 418, 500, 48, 60, 500, 500, 32, 104, 500, 30, 194, 500, 102, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3774170513752676, "mean_inference_ms": 1.2032919309470949, "mean_action_processing_ms": 0.13978439624504205, "mean_env_wait_ms": 0.08284939438429202, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02699565887451172, "StateBufferConnector_ms": 0.009999990463256836, "ViewRequirementAgentConnector_ms": 0.09198307991027832}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000, "num_env_steps_sampled": 1008000, "num_env_steps_trained": 1008000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5771.7379338351675, "num_env_steps_trained_throughput_per_sec": 5771.7379338351675, "timesteps_total": 1008000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1008000, "timers": {"training_iteration_time_ms": 3165.849, "sample_time_ms": 2833.452, "load_time_ms": 18.058, "load_throughput": 996812.365, "learn_time_ms": 302.813, "learn_throughput": 59442.649, "synch_weights_time_ms": 9.225}, "counters": {"num_env_steps_sampled": 1008000, "num_env_steps_trained": 1008000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "done": false, "episodes_total": 3859, "training_iteration": 56, "trial_id": "9f288_00015", "date": "2023-10-25_16-49-41", "timestamp": 1698248981, "time_this_iter_s": 3.1246414184570312, "time_total_s": 179.59873795509338, "pid": 4200, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 179.59873795509338, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 60.575, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.775557561562892e-18, "cur_lr": 0.0003, "total_loss": 6.68189697265625, "policy_loss": -0.004470045119524002, "vf_loss": 6.6864197015762326, "vf_explained_var": -1.7583370208740235e-07, "kl": 0.0003199992891808279, "entropy": 0.5282166913151741, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1130.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 1026000, "num_env_steps_trained": 1026000, "num_agent_steps_sampled": 1026000, "num_agent_steps_trained": 1026000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.3170000000002064, "episode_len_mean": 288.74, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.5, -50.00000000000044, -50.00000000000044, 38.700000000000024, 45.5, -50.00000000000044, 34.900000000000034, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.49999999999998, 45.5, -50.00000000000044, 12.499999999999737, 27.899999999999956, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 44.10000000000001, 8.299999999999677, -50.00000000000044, 45.3, 44.10000000000001, -50.00000000000044, -50.00000000000044, 46.9, 39.70000000000002, -50.00000000000044, 47.1, 30.699999999999996, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, 19.899999999999842, 36.30000000000003, 44.900000000000006, 38.50000000000003, 44.7, 14.899999999999771, 45.5, 46.9, 13.899999999999757, 43.900000000000006, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 27.899999999999956, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.700000000000024, 36.70000000000003, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 11.699999999999726, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 43.10000000000001, -50.00000000000044, 44.300000000000004, 23.099999999999888, 40.70000000000002, 35.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 43.10000000000001, 7.899999999999672, -50.00000000000044, 45.3, 44.7, 40.30000000000002, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, 32.30000000000002, 45.5, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 45.7, 44.7, 18.29999999999982, 44.10000000000001], "episode_lengths": [36, 500, 500, 114, 46, 500, 152, 80, 500, 500, 500, 206, 46, 500, 376, 222, 500, 500, 500, 54, 60, 418, 500, 48, 60, 500, 500, 32, 104, 500, 30, 194, 500, 102, 500, 500, 302, 138, 52, 116, 54, 352, 46, 32, 362, 62, 500, 500, 74, 500, 222, 500, 500, 500, 174, 134, 500, 500, 34, 500, 384, 60, 500, 500, 500, 50, 70, 500, 58, 270, 94, 146, 500, 500, 500, 500, 500, 90, 70, 422, 500, 48, 54, 98, 500, 72, 500, 500, 500, 100, 178, 46, 500, 54, 500, 500, 44, 54, 318, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37736284185499724, "mean_inference_ms": 1.2036042369995568, "mean_action_processing_ms": 0.14010032004291767, "mean_env_wait_ms": 0.08271236052486368, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028003454208374023, "StateBufferConnector_ms": 0.007002592086791992, "ViewRequirementAgentConnector_ms": 0.12401127815246582}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.3170000000002064, "episode_len_mean": 288.74, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.5, -50.00000000000044, -50.00000000000044, 38.700000000000024, 45.5, -50.00000000000044, 34.900000000000034, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.49999999999998, 45.5, -50.00000000000044, 12.499999999999737, 27.899999999999956, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 44.10000000000001, 8.299999999999677, -50.00000000000044, 45.3, 44.10000000000001, -50.00000000000044, -50.00000000000044, 46.9, 39.70000000000002, -50.00000000000044, 47.1, 30.699999999999996, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, 19.899999999999842, 36.30000000000003, 44.900000000000006, 38.50000000000003, 44.7, 14.899999999999771, 45.5, 46.9, 13.899999999999757, 43.900000000000006, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 27.899999999999956, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.700000000000024, 36.70000000000003, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 11.699999999999726, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 43.10000000000001, -50.00000000000044, 44.300000000000004, 23.099999999999888, 40.70000000000002, 35.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 43.10000000000001, 7.899999999999672, -50.00000000000044, 45.3, 44.7, 40.30000000000002, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, 32.30000000000002, 45.5, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 45.7, 44.7, 18.29999999999982, 44.10000000000001], "episode_lengths": [36, 500, 500, 114, 46, 500, 152, 80, 500, 500, 500, 206, 46, 500, 376, 222, 500, 500, 500, 54, 60, 418, 500, 48, 60, 500, 500, 32, 104, 500, 30, 194, 500, 102, 500, 500, 302, 138, 52, 116, 54, 352, 46, 32, 362, 62, 500, 500, 74, 500, 222, 500, 500, 500, 174, 134, 500, 500, 34, 500, 384, 60, 500, 500, 500, 50, 70, 500, 58, 270, 94, 146, 500, 500, 500, 500, 500, 90, 70, 422, 500, 48, 54, 98, 500, 72, 500, 500, 500, 100, 178, 46, 500, 54, 500, 500, 44, 54, 318, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37736284185499724, "mean_inference_ms": 1.2036042369995568, "mean_action_processing_ms": 0.14010032004291767, "mean_env_wait_ms": 0.08271236052486368, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028003454208374023, "StateBufferConnector_ms": 0.007002592086791992, "ViewRequirementAgentConnector_ms": 0.12401127815246582}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1026000, "num_agent_steps_trained": 1026000, "num_env_steps_sampled": 1026000, "num_env_steps_trained": 1026000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5723.224249574894, "num_env_steps_trained_throughput_per_sec": 5723.224249574894, "timesteps_total": 1026000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1026000, "timers": {"training_iteration_time_ms": 3168.995, "sample_time_ms": 2834.467, "load_time_ms": 18.169, "load_throughput": 990692.064, "learn_time_ms": 304.96, "learn_throughput": 59024.169, "synch_weights_time_ms": 9.098}, "counters": {"num_env_steps_sampled": 1026000, "num_env_steps_trained": 1026000, "num_agent_steps_sampled": 1026000, "num_agent_steps_trained": 1026000}, "done": false, "episodes_total": 3923, "training_iteration": 57, "trial_id": "9f288_00015", "date": "2023-10-25_16-49-45", "timestamp": 1698248985, "time_this_iter_s": 3.1500885486602783, "time_total_s": 182.74882650375366, "pid": 4200, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 182.74882650375366, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 57.06, "ram_util_percent": 27.240000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.387778780781446e-18, "cur_lr": 0.0003, "total_loss": 6.796374249458313, "policy_loss": -0.04499188361223787, "vf_loss": 6.8414146423339846, "vf_explained_var": -7.808208465576172e-07, "kl": 0.0008782431036124194, "entropy": 0.4852339044213295, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1150.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 1044000, "num_env_steps_trained": 1044000, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.731999999999817, "episode_len_mean": 263.3, "episode_media": {}, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.10000000000001, -50.00000000000044, 44.300000000000004, 23.099999999999888, 40.70000000000002, 35.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 43.10000000000001, 7.899999999999672, -50.00000000000044, 45.3, 44.7, 40.30000000000002, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, 32.30000000000002, 45.5, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 45.7, 44.7, 18.29999999999982, 44.10000000000001, 41.500000000000014, -50.00000000000044, 3.699999999999612, 47.3, -50.00000000000044, -50.00000000000044, 45.1, 45.5, 45.3, 43.7, 44.10000000000001, -50.00000000000044, 46.5, 33.30000000000003, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.90000000000003, 39.10000000000002, 32.50000000000002, -50.00000000000044, -50.00000000000044, 38.300000000000026, 45.1, 45.9, 45.1, -50.00000000000044, 45.5, 22.099999999999874, 34.10000000000004, -50.00000000000044, 41.70000000000002, 45.5, 38.700000000000024, 3.0999999999996035, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 43.50000000000001, 38.10000000000002, -50.00000000000044, 27.099999999999945, 46.3, 40.500000000000014, -50.00000000000044, 36.900000000000034, -50.00000000000044, 42.900000000000006, 41.30000000000001, 22.299999999999876, 8.699999999999683, 41.70000000000002, 36.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 46.099999999999994, -50.00000000000044, 47.5, -50.00000000000044, 41.500000000000014], "episode_lengths": [70, 500, 58, 270, 94, 146, 500, 500, 500, 500, 500, 90, 70, 422, 500, 48, 54, 98, 500, 72, 500, 500, 500, 100, 178, 46, 500, 54, 500, 500, 44, 54, 318, 60, 86, 500, 464, 28, 500, 500, 50, 46, 48, 64, 60, 500, 36, 168, 500, 34, 500, 500, 500, 172, 110, 176, 500, 500, 118, 50, 42, 50, 500, 46, 280, 160, 500, 84, 46, 114, 470, 500, 26, 500, 500, 66, 120, 500, 230, 38, 96, 500, 132, 500, 72, 88, 278, 414, 84, 136, 500, 500, 500, 500, 50, 40, 500, 26, 500, 86]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37728741046645026, "mean_inference_ms": 1.2040784909529159, "mean_action_processing_ms": 0.13993514098024085, "mean_env_wait_ms": 0.0827463745421934, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02600884437561035, "StateBufferConnector_ms": 0.00900125503540039, "ViewRequirementAgentConnector_ms": 0.10791349411010742}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.731999999999817, "episode_len_mean": 263.3, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.10000000000001, -50.00000000000044, 44.300000000000004, 23.099999999999888, 40.70000000000002, 35.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 43.10000000000001, 7.899999999999672, -50.00000000000044, 45.3, 44.7, 40.30000000000002, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, 32.30000000000002, 45.5, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 45.7, 44.7, 18.29999999999982, 44.10000000000001, 41.500000000000014, -50.00000000000044, 3.699999999999612, 47.3, -50.00000000000044, -50.00000000000044, 45.1, 45.5, 45.3, 43.7, 44.10000000000001, -50.00000000000044, 46.5, 33.30000000000003, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.90000000000003, 39.10000000000002, 32.50000000000002, -50.00000000000044, -50.00000000000044, 38.300000000000026, 45.1, 45.9, 45.1, -50.00000000000044, 45.5, 22.099999999999874, 34.10000000000004, -50.00000000000044, 41.70000000000002, 45.5, 38.700000000000024, 3.0999999999996035, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 43.50000000000001, 38.10000000000002, -50.00000000000044, 27.099999999999945, 46.3, 40.500000000000014, -50.00000000000044, 36.900000000000034, -50.00000000000044, 42.900000000000006, 41.30000000000001, 22.299999999999876, 8.699999999999683, 41.70000000000002, 36.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 46.099999999999994, -50.00000000000044, 47.5, -50.00000000000044, 41.500000000000014], "episode_lengths": [70, 500, 58, 270, 94, 146, 500, 500, 500, 500, 500, 90, 70, 422, 500, 48, 54, 98, 500, 72, 500, 500, 500, 100, 178, 46, 500, 54, 500, 500, 44, 54, 318, 60, 86, 500, 464, 28, 500, 500, 50, 46, 48, 64, 60, 500, 36, 168, 500, 34, 500, 500, 500, 172, 110, 176, 500, 500, 118, 50, 42, 50, 500, 46, 280, 160, 500, 84, 46, 114, 470, 500, 26, 500, 500, 66, 120, 500, 230, 38, 96, 500, 132, 500, 72, 88, 278, 414, 84, 136, 500, 500, 500, 500, 50, 40, 500, 26, 500, 86]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37728741046645026, "mean_inference_ms": 1.2040784909529159, "mean_action_processing_ms": 0.13993514098024085, "mean_env_wait_ms": 0.0827463745421934, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02600884437561035, "StateBufferConnector_ms": 0.00900125503540039, "ViewRequirementAgentConnector_ms": 0.10791349411010742}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000, "num_env_steps_sampled": 1044000, "num_env_steps_trained": 1044000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5566.062602090904, "num_env_steps_trained_throughput_per_sec": 5566.062602090904, "timesteps_total": 1044000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1044000, "timers": {"training_iteration_time_ms": 3176.196, "sample_time_ms": 2832.698, "load_time_ms": 19.524, "load_throughput": 921951.134, "learn_time_ms": 312.597, "learn_throughput": 57582.19, "synch_weights_time_ms": 9.076}, "counters": {"num_env_steps_sampled": 1044000, "num_env_steps_trained": 1044000, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000}, "done": false, "episodes_total": 3989, "training_iteration": 58, "trial_id": "9f288_00015", "date": "2023-10-25_16-49-48", "timestamp": 1698248988, "time_this_iter_s": 3.2392187118530273, "time_total_s": 185.9880452156067, "pid": 4200, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 185.9880452156067, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 65.325, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.93889390390723e-19, "cur_lr": 0.0003, "total_loss": 6.57364444732666, "policy_loss": 0.05185223435983062, "vf_loss": 6.52183997631073, "vf_explained_var": -3.963708877563477e-07, "kl": 0.0007115010107781927, "entropy": 0.47677762508392335, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1170.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 1062000, "num_env_steps_trained": 1062000, "num_agent_steps_sampled": 1062000, "num_agent_steps_trained": 1062000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.957999999999827, "episode_len_mean": 251.06, "episode_media": {}, "episodes_this_iter": 78, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [27.099999999999945, 46.3, 40.500000000000014, -50.00000000000044, 36.900000000000034, -50.00000000000044, 42.900000000000006, 41.30000000000001, 22.299999999999876, 8.699999999999683, 41.70000000000002, 36.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 46.099999999999994, -50.00000000000044, 47.5, -50.00000000000044, 41.500000000000014, -50.00000000000044, 44.7, 42.900000000000006, 46.099999999999994, 45.1, 44.7, 32.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.70000000000003, 44.5, 43.10000000000001, 41.500000000000014, 8.49999999999968, 34.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.499999999999808, 38.50000000000003, -50.00000000000044, 44.5, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 45.9, 37.300000000000026, 39.50000000000002, 44.5, -50.00000000000044, 28.89999999999997, -50.00000000000044, 39.300000000000026, 46.3, 46.9, 46.699999999999996, 19.69999999999984, 35.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 4.899999999999629, 46.3, -50.00000000000044, 39.70000000000002, 46.099999999999994, 45.3, 45.7, 45.5, -50.00000000000044, -50.00000000000044, 45.9, 36.70000000000003, 40.500000000000014, -50.00000000000044, -50.00000000000044, 6.8999999999996575, 36.30000000000003, 44.5, 44.5, 46.5, 46.9, 45.5, 44.900000000000006, 45.5, 43.7, 47.3, 37.90000000000003, -50.00000000000044, 45.1], "episode_lengths": [230, 38, 96, 500, 132, 500, 72, 88, 278, 414, 84, 136, 500, 500, 500, 500, 50, 40, 500, 26, 500, 86, 500, 54, 72, 40, 50, 54, 178, 500, 500, 500, 500, 500, 500, 124, 56, 70, 86, 416, 160, 500, 500, 500, 500, 326, 116, 500, 56, 500, 70, 500, 500, 42, 128, 106, 56, 500, 212, 500, 108, 38, 32, 34, 304, 146, 500, 500, 500, 500, 500, 452, 38, 500, 104, 40, 48, 44, 46, 500, 500, 42, 134, 96, 500, 500, 432, 138, 56, 56, 36, 32, 46, 52, 46, 64, 28, 122, 500, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3767942367286055, "mean_inference_ms": 1.2035458980347489, "mean_action_processing_ms": 0.1401437075446579, "mean_env_wait_ms": 0.08274604426129349, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02399754524230957, "StateBufferConnector_ms": 0.003999471664428711, "ViewRequirementAgentConnector_ms": 0.09955167770385742}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.957999999999827, "episode_len_mean": 251.06, "episodes_this_iter": 78, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [27.099999999999945, 46.3, 40.500000000000014, -50.00000000000044, 36.900000000000034, -50.00000000000044, 42.900000000000006, 41.30000000000001, 22.299999999999876, 8.699999999999683, 41.70000000000002, 36.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 46.099999999999994, -50.00000000000044, 47.5, -50.00000000000044, 41.500000000000014, -50.00000000000044, 44.7, 42.900000000000006, 46.099999999999994, 45.1, 44.7, 32.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.70000000000003, 44.5, 43.10000000000001, 41.500000000000014, 8.49999999999968, 34.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.499999999999808, 38.50000000000003, -50.00000000000044, 44.5, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 45.9, 37.300000000000026, 39.50000000000002, 44.5, -50.00000000000044, 28.89999999999997, -50.00000000000044, 39.300000000000026, 46.3, 46.9, 46.699999999999996, 19.69999999999984, 35.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 4.899999999999629, 46.3, -50.00000000000044, 39.70000000000002, 46.099999999999994, 45.3, 45.7, 45.5, -50.00000000000044, -50.00000000000044, 45.9, 36.70000000000003, 40.500000000000014, -50.00000000000044, -50.00000000000044, 6.8999999999996575, 36.30000000000003, 44.5, 44.5, 46.5, 46.9, 45.5, 44.900000000000006, 45.5, 43.7, 47.3, 37.90000000000003, -50.00000000000044, 45.1], "episode_lengths": [230, 38, 96, 500, 132, 500, 72, 88, 278, 414, 84, 136, 500, 500, 500, 500, 50, 40, 500, 26, 500, 86, 500, 54, 72, 40, 50, 54, 178, 500, 500, 500, 500, 500, 500, 124, 56, 70, 86, 416, 160, 500, 500, 500, 500, 326, 116, 500, 56, 500, 70, 500, 500, 42, 128, 106, 56, 500, 212, 500, 108, 38, 32, 34, 304, 146, 500, 500, 500, 500, 500, 452, 38, 500, 104, 40, 48, 44, 46, 500, 500, 42, 134, 96, 500, 500, 432, 138, 56, 56, 36, 32, 46, 52, 46, 64, 28, 122, 500, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3767942367286055, "mean_inference_ms": 1.2035458980347489, "mean_action_processing_ms": 0.1401437075446579, "mean_env_wait_ms": 0.08274604426129349, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02399754524230957, "StateBufferConnector_ms": 0.003999471664428711, "ViewRequirementAgentConnector_ms": 0.09955167770385742}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1062000, "num_agent_steps_trained": 1062000, "num_env_steps_sampled": 1062000, "num_env_steps_trained": 1062000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5751.818035334106, "num_env_steps_trained_throughput_per_sec": 5751.818035334106, "timesteps_total": 1062000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1062000, "timers": {"training_iteration_time_ms": 3166.155, "sample_time_ms": 2834.221, "load_time_ms": 18.328, "load_throughput": 982102.655, "learn_time_ms": 302.156, "learn_throughput": 59571.868, "synch_weights_time_ms": 9.079}, "counters": {"num_env_steps_sampled": 1062000, "num_env_steps_trained": 1062000, "num_agent_steps_sampled": 1062000, "num_agent_steps_trained": 1062000}, "done": false, "episodes_total": 4067, "training_iteration": 59, "trial_id": "9f288_00015", "date": "2023-10-25_16-49-51", "timestamp": 1698248991, "time_this_iter_s": 3.1354410648345947, "time_total_s": 189.12348628044128, "pid": 4200, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 189.12348628044128, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 55.0, "ram_util_percent": 27.22}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.469446951953615e-19, "cur_lr": 0.0003, "total_loss": 6.6208803176879885, "policy_loss": -0.02916447267343756, "vf_loss": 6.650094008445739, "vf_explained_var": -2.3245811462402343e-07, "kl": 0.00045858186770431075, "entropy": 0.4933714851737022, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1190.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 1080000, "num_env_steps_trained": 1080000, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.13399999999981, "episode_len_mean": 269.28, "episode_media": {}, "episodes_this_iter": 57, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 28.89999999999997, -50.00000000000044, 39.300000000000026, 46.3, 46.9, 46.699999999999996, 19.69999999999984, 35.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 4.899999999999629, 46.3, -50.00000000000044, 39.70000000000002, 46.099999999999994, 45.3, 45.7, 45.5, -50.00000000000044, -50.00000000000044, 45.9, 36.70000000000003, 40.500000000000014, -50.00000000000044, -50.00000000000044, 6.8999999999996575, 36.30000000000003, 44.5, 44.5, 46.5, 46.9, 45.5, 44.900000000000006, 45.5, 43.7, 47.3, 37.90000000000003, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 39.300000000000026, 22.49999999999988, 46.5, 40.30000000000002, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.9, 20.699999999999854, -50.00000000000044, 47.1, 45.7, 42.10000000000001, 27.899999999999956, -50.00000000000044, 43.30000000000001, 40.10000000000002, 7.499999999999666, 37.70000000000003, 36.10000000000004, -50.00000000000044, 33.500000000000036, 44.900000000000006, 44.5, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.299999999999933, 6.099999999999646, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 35.30000000000004, 32.30000000000002, -50.00000000000044, 47.1, 19.899999999999842, -50.00000000000044, -50.00000000000044, 30.9, -50.00000000000044, 0.09999999999956088, -50.00000000000044, 45.9, -50.00000000000044], "episode_lengths": [500, 212, 500, 108, 38, 32, 34, 304, 146, 500, 500, 500, 500, 500, 452, 38, 500, 104, 40, 48, 44, 46, 500, 500, 42, 134, 96, 500, 500, 432, 138, 56, 56, 36, 32, 46, 52, 46, 64, 28, 122, 500, 50, 500, 500, 72, 500, 500, 500, 34, 108, 276, 36, 98, 42, 500, 500, 500, 192, 294, 500, 30, 44, 80, 222, 500, 68, 100, 426, 124, 140, 500, 166, 52, 56, 500, 500, 32, 500, 500, 500, 238, 440, 500, 500, 500, 90, 148, 178, 500, 30, 302, 500, 500, 192, 500, 500, 500, 42, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3767101765621577, "mean_inference_ms": 1.2025376500811276, "mean_action_processing_ms": 0.1397492485686486, "mean_env_wait_ms": 0.08288593572671182, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023975372314453125, "StateBufferConnector_ms": 0.0029997825622558594, "ViewRequirementAgentConnector_ms": 0.10600829124450684}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.13399999999981, "episode_len_mean": 269.28, "episodes_this_iter": 57, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 28.89999999999997, -50.00000000000044, 39.300000000000026, 46.3, 46.9, 46.699999999999996, 19.69999999999984, 35.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 4.899999999999629, 46.3, -50.00000000000044, 39.70000000000002, 46.099999999999994, 45.3, 45.7, 45.5, -50.00000000000044, -50.00000000000044, 45.9, 36.70000000000003, 40.500000000000014, -50.00000000000044, -50.00000000000044, 6.8999999999996575, 36.30000000000003, 44.5, 44.5, 46.5, 46.9, 45.5, 44.900000000000006, 45.5, 43.7, 47.3, 37.90000000000003, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 39.300000000000026, 22.49999999999988, 46.5, 40.30000000000002, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.9, 20.699999999999854, -50.00000000000044, 47.1, 45.7, 42.10000000000001, 27.899999999999956, -50.00000000000044, 43.30000000000001, 40.10000000000002, 7.499999999999666, 37.70000000000003, 36.10000000000004, -50.00000000000044, 33.500000000000036, 44.900000000000006, 44.5, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.299999999999933, 6.099999999999646, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 35.30000000000004, 32.30000000000002, -50.00000000000044, 47.1, 19.899999999999842, -50.00000000000044, -50.00000000000044, 30.9, -50.00000000000044, 0.09999999999956088, -50.00000000000044, 45.9, -50.00000000000044], "episode_lengths": [500, 212, 500, 108, 38, 32, 34, 304, 146, 500, 500, 500, 500, 500, 452, 38, 500, 104, 40, 48, 44, 46, 500, 500, 42, 134, 96, 500, 500, 432, 138, 56, 56, 36, 32, 46, 52, 46, 64, 28, 122, 500, 50, 500, 500, 72, 500, 500, 500, 34, 108, 276, 36, 98, 42, 500, 500, 500, 192, 294, 500, 30, 44, 80, 222, 500, 68, 100, 426, 124, 140, 500, 166, 52, 56, 500, 500, 32, 500, 500, 500, 238, 440, 500, 500, 500, 90, 148, 178, 500, 30, 302, 500, 500, 192, 500, 500, 500, 42, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3767101765621577, "mean_inference_ms": 1.2025376500811276, "mean_action_processing_ms": 0.1397492485686486, "mean_env_wait_ms": 0.08288593572671182, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023975372314453125, "StateBufferConnector_ms": 0.0029997825622558594, "ViewRequirementAgentConnector_ms": 0.10600829124450684}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000, "num_env_steps_sampled": 1080000, "num_env_steps_trained": 1080000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5699.842724371441, "num_env_steps_trained_throughput_per_sec": 5699.842724371441, "timesteps_total": 1080000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1080000, "timers": {"training_iteration_time_ms": 3168.744, "sample_time_ms": 2838.078, "load_time_ms": 18.357, "load_throughput": 980533.766, "learn_time_ms": 300.788, "learn_throughput": 59842.908, "synch_weights_time_ms": 8.949}, "counters": {"num_env_steps_sampled": 1080000, "num_env_steps_trained": 1080000, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000}, "done": false, "episodes_total": 4124, "training_iteration": 60, "trial_id": "9f288_00015", "date": "2023-10-25_16-49-54", "timestamp": 1698248994, "time_this_iter_s": 3.1626453399658203, "time_total_s": 192.2861316204071, "pid": 4200, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 192.2861316204071, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 64.675, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.7347234759768074e-19, "cur_lr": 0.0003, "total_loss": 6.526237630844117, "policy_loss": -0.03821711577475071, "vf_loss": 6.564506959915161, "vf_explained_var": -1.5616416931152343e-06, "kl": 0.0012205521435229905, "entropy": 0.5222068279981613, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1210.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 1098000, "num_env_steps_trained": 1098000, "num_agent_steps_sampled": 1098000, "num_agent_steps_trained": 1098000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.45899999999979274, "episode_len_mean": 280.98, "episode_media": {}, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 33.500000000000036, 44.900000000000006, 44.5, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.299999999999933, 6.099999999999646, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 35.30000000000004, 32.30000000000002, -50.00000000000044, 47.1, 19.899999999999842, -50.00000000000044, -50.00000000000044, 30.9, -50.00000000000044, 0.09999999999956088, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 0.49999999999956657, 45.3, 36.70000000000003, 20.699999999999854, 38.90000000000002, 35.500000000000036, -50.00000000000044, -50.00000000000044, 45.1, 44.5, 44.7, 25.29999999999992, 47.5, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.10000000000003, -50.00000000000044, 38.90000000000002, 45.5, 45.9, 42.10000000000001, 45.5, -50.00000000000044, 33.30000000000003, 45.5, 44.900000000000006, -50.00000000000044, 45.3, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 44.300000000000004, 45.5, 44.10000000000001, 43.50000000000001, 46.699999999999996, 25.899999999999928, 14.09999999999976, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 44.300000000000004, 46.5, -50.00000000000044, 41.70000000000002, -50.00000000000044, 45.3, 43.900000000000006, 43.50000000000001, 40.500000000000014, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 47.1, 46.099999999999994, -50.00000000000044], "episode_lengths": [500, 166, 52, 56, 500, 500, 32, 500, 500, 500, 238, 440, 500, 500, 500, 90, 148, 178, 500, 30, 302, 500, 500, 192, 500, 500, 500, 42, 500, 500, 496, 48, 134, 294, 112, 146, 500, 500, 50, 56, 54, 248, 26, 30, 500, 500, 500, 500, 170, 500, 112, 46, 42, 80, 46, 500, 168, 46, 52, 500, 48, 500, 32, 500, 500, 58, 46, 60, 66, 34, 242, 360, 56, 500, 500, 500, 30, 500, 58, 36, 500, 84, 500, 48, 62, 66, 96, 500, 80, 500, 500, 500, 500, 500, 500, 44, 500, 30, 40, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3772396985411393, "mean_inference_ms": 1.2033321187535169, "mean_action_processing_ms": 0.13974457056198225, "mean_env_wait_ms": 0.08282550116005596, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020991802215576172, "StateBufferConnector_ms": 0.0029993057250976562, "ViewRequirementAgentConnector_ms": 0.12800264358520508}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.45899999999979274, "episode_len_mean": 280.98, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 33.500000000000036, 44.900000000000006, 44.5, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.299999999999933, 6.099999999999646, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 35.30000000000004, 32.30000000000002, -50.00000000000044, 47.1, 19.899999999999842, -50.00000000000044, -50.00000000000044, 30.9, -50.00000000000044, 0.09999999999956088, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 0.49999999999956657, 45.3, 36.70000000000003, 20.699999999999854, 38.90000000000002, 35.500000000000036, -50.00000000000044, -50.00000000000044, 45.1, 44.5, 44.7, 25.29999999999992, 47.5, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.10000000000003, -50.00000000000044, 38.90000000000002, 45.5, 45.9, 42.10000000000001, 45.5, -50.00000000000044, 33.30000000000003, 45.5, 44.900000000000006, -50.00000000000044, 45.3, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 44.300000000000004, 45.5, 44.10000000000001, 43.50000000000001, 46.699999999999996, 25.899999999999928, 14.09999999999976, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 44.300000000000004, 46.5, -50.00000000000044, 41.70000000000002, -50.00000000000044, 45.3, 43.900000000000006, 43.50000000000001, 40.500000000000014, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 47.1, 46.099999999999994, -50.00000000000044], "episode_lengths": [500, 166, 52, 56, 500, 500, 32, 500, 500, 500, 238, 440, 500, 500, 500, 90, 148, 178, 500, 30, 302, 500, 500, 192, 500, 500, 500, 42, 500, 500, 496, 48, 134, 294, 112, 146, 500, 500, 50, 56, 54, 248, 26, 30, 500, 500, 500, 500, 170, 500, 112, 46, 42, 80, 46, 500, 168, 46, 52, 500, 48, 500, 32, 500, 500, 58, 46, 60, 66, 34, 242, 360, 56, 500, 500, 500, 30, 500, 58, 36, 500, 84, 500, 48, 62, 66, 96, 500, 80, 500, 500, 500, 500, 500, 500, 44, 500, 30, 40, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3772396985411393, "mean_inference_ms": 1.2033321187535169, "mean_action_processing_ms": 0.13974457056198225, "mean_env_wait_ms": 0.08282550116005596, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020991802215576172, "StateBufferConnector_ms": 0.0029993057250976562, "ViewRequirementAgentConnector_ms": 0.12800264358520508}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1098000, "num_agent_steps_trained": 1098000, "num_env_steps_sampled": 1098000, "num_env_steps_trained": 1098000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5581.794135947781, "num_env_steps_trained_throughput_per_sec": 5581.794135947781, "timesteps_total": 1098000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1098000, "timers": {"training_iteration_time_ms": 3170.752, "sample_time_ms": 2841.22, "load_time_ms": 18.248, "load_throughput": 986397.347, "learn_time_ms": 299.838, "learn_throughput": 60032.49, "synch_weights_time_ms": 8.874}, "counters": {"num_env_steps_sampled": 1098000, "num_env_steps_trained": 1098000, "num_agent_steps_sampled": 1098000, "num_agent_steps_trained": 1098000}, "done": false, "episodes_total": 4195, "training_iteration": 61, "trial_id": "9f288_00015", "date": "2023-10-25_16-49-58", "timestamp": 1698248998, "time_this_iter_s": 3.2296106815338135, "time_total_s": 195.51574230194092, "pid": 4200, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 195.51574230194092, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 55.64, "ram_util_percent": 27.22}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.673617379884037e-20, "cur_lr": 0.0003, "total_loss": 6.9163535833358765, "policy_loss": 0.009025409672176465, "vf_loss": 6.9073773384094235, "vf_explained_var": -1.066923141479492e-06, "kl": 0.0007500366890212717, "entropy": 0.4930217996239662, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1230.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 1116000, "num_env_steps_trained": 1116000, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.695999999999835, "episode_len_mean": 243.7, "episode_media": {}, "episodes_this_iter": 80, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 41.70000000000002, -50.00000000000044, 45.3, 43.900000000000006, 43.50000000000001, 40.500000000000014, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 47.1, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, 41.30000000000001, 44.900000000000006, 44.300000000000004, 43.7, 31.500000000000007, -50.00000000000044, 46.099999999999994, -50.00000000000044, 46.9, 41.90000000000001, -50.00000000000044, 27.899999999999956, 38.50000000000003, 42.30000000000001, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, -50.00000000000044, 45.7, 42.70000000000001, 43.30000000000001, -50.00000000000044, 46.3, 43.30000000000001, 20.099999999999845, 30.29999999999999, 44.5, 44.300000000000004, -50.00000000000044, 43.7, 46.3, 41.70000000000002, -50.00000000000044, -50.00000000000044, 46.5, 44.300000000000004, 24.299999999999905, 32.50000000000002, 46.3, 41.100000000000016, -50.00000000000044, 35.70000000000003, 43.30000000000001, 43.50000000000001, 45.1, 44.900000000000006, 43.50000000000001, 39.70000000000002, 37.300000000000026, -50.00000000000044, 46.3, -50.00000000000044, 43.30000000000001, 0.6999999999995694, -50.00000000000044, 26.89999999999994, 9.499999999999694, -50.00000000000044, -50.00000000000044, -50.00000000000044, 1.6999999999995836, 46.3, 44.5, 37.300000000000026, 35.900000000000034, 39.90000000000002, 20.099999999999845, 47.3, 40.90000000000002, 12.499999999999737, -50.00000000000044, 45.3, 44.300000000000004, -50.00000000000044], "episode_lengths": [500, 84, 500, 48, 62, 66, 96, 500, 80, 500, 500, 500, 500, 500, 500, 44, 500, 30, 40, 500, 500, 500, 500, 112, 88, 52, 58, 64, 186, 500, 40, 500, 32, 82, 500, 222, 116, 78, 64, 500, 500, 500, 112, 500, 44, 74, 68, 500, 38, 68, 300, 198, 56, 58, 500, 64, 38, 84, 500, 500, 36, 58, 258, 176, 38, 90, 500, 144, 68, 66, 50, 52, 66, 104, 128, 500, 38, 500, 68, 494, 500, 232, 406, 500, 500, 500, 484, 38, 56, 128, 142, 102, 300, 28, 92, 376, 500, 48, 58, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37710961423711437, "mean_inference_ms": 1.2025207105854248, "mean_action_processing_ms": 0.1397127530512067, "mean_env_wait_ms": 0.08290752975104888, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03178811073303223, "StateBufferConnector_ms": 0.001997232437133789, "ViewRequirementAgentConnector_ms": 0.10300803184509277}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.695999999999835, "episode_len_mean": 243.7, "episodes_this_iter": 80, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 41.70000000000002, -50.00000000000044, 45.3, 43.900000000000006, 43.50000000000001, 40.500000000000014, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 47.1, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, 41.30000000000001, 44.900000000000006, 44.300000000000004, 43.7, 31.500000000000007, -50.00000000000044, 46.099999999999994, -50.00000000000044, 46.9, 41.90000000000001, -50.00000000000044, 27.899999999999956, 38.50000000000003, 42.30000000000001, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, -50.00000000000044, 45.7, 42.70000000000001, 43.30000000000001, -50.00000000000044, 46.3, 43.30000000000001, 20.099999999999845, 30.29999999999999, 44.5, 44.300000000000004, -50.00000000000044, 43.7, 46.3, 41.70000000000002, -50.00000000000044, -50.00000000000044, 46.5, 44.300000000000004, 24.299999999999905, 32.50000000000002, 46.3, 41.100000000000016, -50.00000000000044, 35.70000000000003, 43.30000000000001, 43.50000000000001, 45.1, 44.900000000000006, 43.50000000000001, 39.70000000000002, 37.300000000000026, -50.00000000000044, 46.3, -50.00000000000044, 43.30000000000001, 0.6999999999995694, -50.00000000000044, 26.89999999999994, 9.499999999999694, -50.00000000000044, -50.00000000000044, -50.00000000000044, 1.6999999999995836, 46.3, 44.5, 37.300000000000026, 35.900000000000034, 39.90000000000002, 20.099999999999845, 47.3, 40.90000000000002, 12.499999999999737, -50.00000000000044, 45.3, 44.300000000000004, -50.00000000000044], "episode_lengths": [500, 84, 500, 48, 62, 66, 96, 500, 80, 500, 500, 500, 500, 500, 500, 44, 500, 30, 40, 500, 500, 500, 500, 112, 88, 52, 58, 64, 186, 500, 40, 500, 32, 82, 500, 222, 116, 78, 64, 500, 500, 500, 112, 500, 44, 74, 68, 500, 38, 68, 300, 198, 56, 58, 500, 64, 38, 84, 500, 500, 36, 58, 258, 176, 38, 90, 500, 144, 68, 66, 50, 52, 66, 104, 128, 500, 38, 500, 68, 494, 500, 232, 406, 500, 500, 500, 484, 38, 56, 128, 142, 102, 300, 28, 92, 376, 500, 48, 58, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37710961423711437, "mean_inference_ms": 1.2025207105854248, "mean_action_processing_ms": 0.1397127530512067, "mean_env_wait_ms": 0.08290752975104888, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03178811073303223, "StateBufferConnector_ms": 0.001997232437133789, "ViewRequirementAgentConnector_ms": 0.10300803184509277}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000, "num_env_steps_sampled": 1116000, "num_env_steps_trained": 1116000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5613.877792124009, "num_env_steps_trained_throughput_per_sec": 5613.877792124009, "timesteps_total": 1116000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1116000, "timers": {"training_iteration_time_ms": 3172.522, "sample_time_ms": 2843.615, "load_time_ms": 17.21, "load_throughput": 1045900.239, "learn_time_ms": 300.219, "learn_throughput": 59956.296, "synch_weights_time_ms": 8.906}, "counters": {"num_env_steps_sampled": 1116000, "num_env_steps_trained": 1116000, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000}, "done": false, "episodes_total": 4275, "training_iteration": 62, "trial_id": "9f288_00015", "date": "2023-10-25_16-50-01", "timestamp": 1698249001, "time_this_iter_s": 3.2113354206085205, "time_total_s": 198.72707772254944, "pid": 4200, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 198.72707772254944, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 63.525, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.3368086899420186e-20, "cur_lr": 0.0003, "total_loss": 7.001308465003968, "policy_loss": -0.02568015120923519, "vf_loss": 7.0270397663116455, "vf_explained_var": -7.539987564086914e-07, "kl": 0.00012987964090598324, "entropy": 0.5103767201304436, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1250.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 1134000, "num_env_steps_trained": 1134000, "num_agent_steps_sampled": 1134000, "num_agent_steps_trained": 1134000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.151999999999843, "episode_len_mean": 239.2, "episode_media": {}, "episodes_this_iter": 79, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.6999999999995694, -50.00000000000044, 26.89999999999994, 9.499999999999694, -50.00000000000044, -50.00000000000044, -50.00000000000044, 1.6999999999995836, 46.3, 44.5, 37.300000000000026, 35.900000000000034, 39.90000000000002, 20.099999999999845, 47.3, 40.90000000000002, 12.499999999999737, -50.00000000000044, 45.3, 44.300000000000004, -50.00000000000044, 34.30000000000004, 45.5, 38.300000000000026, -50.00000000000044, 43.10000000000001, -50.00000000000044, 45.7, -50.00000000000044, 11.099999999999717, 43.30000000000001, 15.699999999999783, -50.00000000000044, 39.50000000000002, 44.900000000000006, 46.099999999999994, -50.00000000000044, 41.90000000000001, 33.30000000000003, 36.50000000000003, 42.900000000000006, 45.7, 45.3, 7.09999999999966, 29.899999999999984, 36.70000000000003, 45.3, 41.90000000000001, -50.00000000000044, 45.3, 46.699999999999996, -50.00000000000044, 7.499999999999666, 44.5, 45.3, 19.899999999999842, 39.70000000000002, 38.700000000000024, -50.00000000000044, 1.6999999999995836, -50.00000000000044, 24.299999999999905, 47.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 43.900000000000006, 42.900000000000006, 33.30000000000003, 46.699999999999996, -50.00000000000044, 41.100000000000016, 43.30000000000001, -50.00000000000044, 45.3, 45.7, -50.00000000000044, 47.3, -50.00000000000044, 47.5, 23.499999999999893, -50.00000000000044, 47.1, 44.10000000000001, 40.500000000000014, -50.00000000000044, 43.10000000000001, 43.900000000000006, 42.70000000000001, -50.00000000000044, 33.10000000000003, 42.500000000000014, -50.00000000000044, -50.00000000000044, 9.8999999999997, 42.10000000000001, -50.00000000000044, 46.699999999999996, 46.699999999999996], "episode_lengths": [494, 500, 232, 406, 500, 500, 500, 484, 38, 56, 128, 142, 102, 300, 28, 92, 376, 500, 48, 58, 500, 158, 46, 118, 500, 70, 500, 44, 500, 390, 68, 344, 500, 106, 52, 40, 500, 82, 168, 136, 72, 44, 48, 430, 202, 134, 48, 82, 500, 48, 34, 500, 426, 56, 48, 302, 104, 114, 500, 484, 500, 258, 24, 500, 500, 500, 62, 62, 72, 168, 34, 500, 90, 68, 500, 48, 44, 500, 28, 500, 26, 266, 500, 30, 60, 96, 500, 70, 62, 74, 500, 170, 76, 500, 500, 402, 80, 500, 34, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.377169771490082, "mean_inference_ms": 1.202294668587949, "mean_action_processing_ms": 0.13975816514646694, "mean_env_wait_ms": 0.0827666692792684, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03679704666137695, "StateBufferConnector_ms": 0.004003286361694336, "ViewRequirementAgentConnector_ms": 0.10610222816467285}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.151999999999843, "episode_len_mean": 239.2, "episodes_this_iter": 79, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.6999999999995694, -50.00000000000044, 26.89999999999994, 9.499999999999694, -50.00000000000044, -50.00000000000044, -50.00000000000044, 1.6999999999995836, 46.3, 44.5, 37.300000000000026, 35.900000000000034, 39.90000000000002, 20.099999999999845, 47.3, 40.90000000000002, 12.499999999999737, -50.00000000000044, 45.3, 44.300000000000004, -50.00000000000044, 34.30000000000004, 45.5, 38.300000000000026, -50.00000000000044, 43.10000000000001, -50.00000000000044, 45.7, -50.00000000000044, 11.099999999999717, 43.30000000000001, 15.699999999999783, -50.00000000000044, 39.50000000000002, 44.900000000000006, 46.099999999999994, -50.00000000000044, 41.90000000000001, 33.30000000000003, 36.50000000000003, 42.900000000000006, 45.7, 45.3, 7.09999999999966, 29.899999999999984, 36.70000000000003, 45.3, 41.90000000000001, -50.00000000000044, 45.3, 46.699999999999996, -50.00000000000044, 7.499999999999666, 44.5, 45.3, 19.899999999999842, 39.70000000000002, 38.700000000000024, -50.00000000000044, 1.6999999999995836, -50.00000000000044, 24.299999999999905, 47.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 43.900000000000006, 42.900000000000006, 33.30000000000003, 46.699999999999996, -50.00000000000044, 41.100000000000016, 43.30000000000001, -50.00000000000044, 45.3, 45.7, -50.00000000000044, 47.3, -50.00000000000044, 47.5, 23.499999999999893, -50.00000000000044, 47.1, 44.10000000000001, 40.500000000000014, -50.00000000000044, 43.10000000000001, 43.900000000000006, 42.70000000000001, -50.00000000000044, 33.10000000000003, 42.500000000000014, -50.00000000000044, -50.00000000000044, 9.8999999999997, 42.10000000000001, -50.00000000000044, 46.699999999999996, 46.699999999999996], "episode_lengths": [494, 500, 232, 406, 500, 500, 500, 484, 38, 56, 128, 142, 102, 300, 28, 92, 376, 500, 48, 58, 500, 158, 46, 118, 500, 70, 500, 44, 500, 390, 68, 344, 500, 106, 52, 40, 500, 82, 168, 136, 72, 44, 48, 430, 202, 134, 48, 82, 500, 48, 34, 500, 426, 56, 48, 302, 104, 114, 500, 484, 500, 258, 24, 500, 500, 500, 62, 62, 72, 168, 34, 500, 90, 68, 500, 48, 44, 500, 28, 500, 26, 266, 500, 30, 60, 96, 500, 70, 62, 74, 500, 170, 76, 500, 500, 402, 80, 500, 34, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.377169771490082, "mean_inference_ms": 1.202294668587949, "mean_action_processing_ms": 0.13975816514646694, "mean_env_wait_ms": 0.0827666692792684, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03679704666137695, "StateBufferConnector_ms": 0.004003286361694336, "ViewRequirementAgentConnector_ms": 0.10610222816467285}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1134000, "num_agent_steps_trained": 1134000, "num_env_steps_sampled": 1134000, "num_env_steps_trained": 1134000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5728.354460287858, "num_env_steps_trained_throughput_per_sec": 5728.354460287858, "timesteps_total": 1134000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1134000, "timers": {"training_iteration_time_ms": 3176.71, "sample_time_ms": 2845.785, "load_time_ms": 18.615, "load_throughput": 966977.843, "learn_time_ms": 300.629, "learn_throughput": 59874.431, "synch_weights_time_ms": 9.009}, "counters": {"num_env_steps_sampled": 1134000, "num_env_steps_trained": 1134000, "num_agent_steps_sampled": 1134000, "num_agent_steps_trained": 1134000}, "done": false, "episodes_total": 4354, "training_iteration": 63, "trial_id": "9f288_00015", "date": "2023-10-25_16-50-04", "timestamp": 1698249004, "time_this_iter_s": 3.1472601890563965, "time_total_s": 201.87433791160583, "pid": 4200, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 201.87433791160583, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 54.9, "ram_util_percent": 27.22}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.1684043449710093e-20, "cur_lr": 0.0003, "total_loss": 6.554906916618347, "policy_loss": -0.05916005466133356, "vf_loss": 6.61411817073822, "vf_explained_var": -1.7821788787841796e-06, "kl": 0.0006982709329690806, "entropy": 0.5124379009008407, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1270.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 1152000, "num_env_steps_trained": 1152000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.768999999999809, "episode_len_mean": 267.9, "episode_media": {}, "episodes_this_iter": 60, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 24.299999999999905, 47.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 43.900000000000006, 42.900000000000006, 33.30000000000003, 46.699999999999996, -50.00000000000044, 41.100000000000016, 43.30000000000001, -50.00000000000044, 45.3, 45.7, -50.00000000000044, 47.3, -50.00000000000044, 47.5, 23.499999999999893, -50.00000000000044, 47.1, 44.10000000000001, 40.500000000000014, -50.00000000000044, 43.10000000000001, 43.900000000000006, 42.70000000000001, -50.00000000000044, 33.10000000000003, 42.500000000000014, -50.00000000000044, -50.00000000000044, 9.8999999999997, 42.10000000000001, -50.00000000000044, 46.699999999999996, 46.699999999999996, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.30000000000004, 32.700000000000024, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.50000000000003, 41.90000000000001, -50.00000000000044, 41.100000000000016, 46.3, 34.10000000000004, -50.00000000000044, 40.70000000000002, 46.9, 15.899999999999785, 43.900000000000006, 45.5, 47.5, 21.699999999999868, -50.00000000000044, 20.099999999999845, 28.499999999999964, 44.300000000000004, 7.699999999999669, -50.00000000000044, 46.699999999999996, 43.30000000000001, 46.3, 42.900000000000006, -50.00000000000044, -50.00000000000044, 36.30000000000003, -50.00000000000044, -50.00000000000044, 29.899999999999984, 34.50000000000004, -50.00000000000044, 44.10000000000001, 43.900000000000006, 43.900000000000006, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 258, 24, 500, 500, 500, 62, 62, 72, 168, 34, 500, 90, 68, 500, 48, 44, 500, 28, 500, 26, 266, 500, 30, 60, 96, 500, 70, 62, 74, 500, 170, 76, 500, 500, 402, 80, 500, 34, 34, 500, 500, 30, 500, 500, 500, 158, 174, 40, 500, 500, 500, 500, 500, 126, 82, 500, 90, 38, 160, 500, 94, 32, 342, 62, 46, 26, 284, 500, 300, 216, 58, 424, 500, 34, 68, 38, 72, 500, 500, 138, 500, 500, 202, 156, 500, 60, 62, 62, 66, 500, 500, 500, 500, 500, 30, 82, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37725653574698426, "mean_inference_ms": 1.203041926380981, "mean_action_processing_ms": 0.13965512758616197, "mean_env_wait_ms": 0.08270769714366256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030996322631835938, "StateBufferConnector_ms": 0.007980108261108398, "ViewRequirementAgentConnector_ms": 0.09298586845397949}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.768999999999809, "episode_len_mean": 267.9, "episodes_this_iter": 60, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 24.299999999999905, 47.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 43.900000000000006, 42.900000000000006, 33.30000000000003, 46.699999999999996, -50.00000000000044, 41.100000000000016, 43.30000000000001, -50.00000000000044, 45.3, 45.7, -50.00000000000044, 47.3, -50.00000000000044, 47.5, 23.499999999999893, -50.00000000000044, 47.1, 44.10000000000001, 40.500000000000014, -50.00000000000044, 43.10000000000001, 43.900000000000006, 42.70000000000001, -50.00000000000044, 33.10000000000003, 42.500000000000014, -50.00000000000044, -50.00000000000044, 9.8999999999997, 42.10000000000001, -50.00000000000044, 46.699999999999996, 46.699999999999996, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.30000000000004, 32.700000000000024, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.50000000000003, 41.90000000000001, -50.00000000000044, 41.100000000000016, 46.3, 34.10000000000004, -50.00000000000044, 40.70000000000002, 46.9, 15.899999999999785, 43.900000000000006, 45.5, 47.5, 21.699999999999868, -50.00000000000044, 20.099999999999845, 28.499999999999964, 44.300000000000004, 7.699999999999669, -50.00000000000044, 46.699999999999996, 43.30000000000001, 46.3, 42.900000000000006, -50.00000000000044, -50.00000000000044, 36.30000000000003, -50.00000000000044, -50.00000000000044, 29.899999999999984, 34.50000000000004, -50.00000000000044, 44.10000000000001, 43.900000000000006, 43.900000000000006, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 258, 24, 500, 500, 500, 62, 62, 72, 168, 34, 500, 90, 68, 500, 48, 44, 500, 28, 500, 26, 266, 500, 30, 60, 96, 500, 70, 62, 74, 500, 170, 76, 500, 500, 402, 80, 500, 34, 34, 500, 500, 30, 500, 500, 500, 158, 174, 40, 500, 500, 500, 500, 500, 126, 82, 500, 90, 38, 160, 500, 94, 32, 342, 62, 46, 26, 284, 500, 300, 216, 58, 424, 500, 34, 68, 38, 72, 500, 500, 138, 500, 500, 202, 156, 500, 60, 62, 62, 66, 500, 500, 500, 500, 500, 30, 82, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37725653574698426, "mean_inference_ms": 1.203041926380981, "mean_action_processing_ms": 0.13965512758616197, "mean_env_wait_ms": 0.08270769714366256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030996322631835938, "StateBufferConnector_ms": 0.007980108261108398, "ViewRequirementAgentConnector_ms": 0.09298586845397949}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000, "num_env_steps_sampled": 1152000, "num_env_steps_trained": 1152000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5361.433583141896, "num_env_steps_trained_throughput_per_sec": 5361.433583141896, "timesteps_total": 1152000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1152000, "timers": {"training_iteration_time_ms": 3195.138, "sample_time_ms": 2863.024, "load_time_ms": 18.832, "load_throughput": 955798.498, "learn_time_ms": 301.668, "learn_throughput": 59668.263, "synch_weights_time_ms": 8.945}, "counters": {"num_env_steps_sampled": 1152000, "num_env_steps_trained": 1152000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "done": false, "episodes_total": 4414, "training_iteration": 64, "trial_id": "9f288_00015", "date": "2023-10-25_16-50-07", "timestamp": 1698249007, "time_this_iter_s": 3.3633062839508057, "time_total_s": 205.23764419555664, "pid": 4200, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 205.23764419555664, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 64.5, "ram_util_percent": 27.224999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.0842021724855046e-20, "cur_lr": 0.0003, "total_loss": 6.572159600257874, "policy_loss": 0.02098701661452651, "vf_loss": 6.551222348213196, "vf_explained_var": 1.1920928955078126e-08, "kl": 0.00038728903081732826, "entropy": 0.4973672956228256, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1290.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 1170000, "num_env_steps_trained": 1170000, "num_agent_steps_sampled": 1170000, "num_agent_steps_trained": 1170000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.075999999999799, "episode_len_mean": 279.84, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 20.099999999999845, 28.499999999999964, 44.300000000000004, 7.699999999999669, -50.00000000000044, 46.699999999999996, 43.30000000000001, 46.3, 42.900000000000006, -50.00000000000044, -50.00000000000044, 36.30000000000003, -50.00000000000044, -50.00000000000044, 29.899999999999984, 34.50000000000004, -50.00000000000044, 44.10000000000001, 43.900000000000006, 43.900000000000006, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 8.299999999999677, 42.10000000000001, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 16.8999999999998, 46.3, 43.10000000000001, 41.30000000000001, -50.00000000000044, 45.9, 1.8999999999995865, 37.90000000000003, 39.10000000000002, 42.30000000000001, 43.900000000000006, -50.00000000000044, 44.7, 43.50000000000001, -50.00000000000044, 4.899999999999629, 20.299999999999848, -50.00000000000044, -50.00000000000044, 39.90000000000002, 44.5, 42.70000000000001, 24.499999999999908, 44.900000000000006, 44.7, 43.7, 39.90000000000002, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 46.5, 45.9, 46.099999999999994, 45.9, 25.099999999999916, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.300000000000026, 42.500000000000014, 40.500000000000014, -50.00000000000044, 22.699999999999882, -50.00000000000044, -50.00000000000044, 37.90000000000003, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 40.90000000000002, 27.299999999999947, -50.00000000000044, 5.299999999999635, 26.499999999999936], "episode_lengths": [500, 300, 216, 58, 424, 500, 34, 68, 38, 72, 500, 500, 138, 500, 500, 202, 156, 500, 60, 62, 62, 66, 500, 500, 500, 500, 500, 30, 82, 500, 500, 500, 500, 418, 80, 500, 76, 500, 500, 36, 500, 332, 38, 70, 88, 500, 42, 482, 122, 110, 78, 62, 500, 54, 66, 500, 452, 298, 500, 500, 102, 56, 74, 256, 52, 54, 64, 102, 500, 62, 500, 500, 36, 42, 40, 42, 250, 500, 500, 500, 128, 76, 96, 500, 274, 500, 500, 122, 500, 30, 500, 500, 50, 500, 500, 92, 228, 500, 448, 236]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3771767043272294, "mean_inference_ms": 1.2022629147800235, "mean_action_processing_ms": 0.13933343624074154, "mean_env_wait_ms": 0.08263901390557779, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027997970581054688, "StateBufferConnector_ms": 0.0070018768310546875, "ViewRequirementAgentConnector_ms": 0.10485339164733887}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.075999999999799, "episode_len_mean": 279.84, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 20.099999999999845, 28.499999999999964, 44.300000000000004, 7.699999999999669, -50.00000000000044, 46.699999999999996, 43.30000000000001, 46.3, 42.900000000000006, -50.00000000000044, -50.00000000000044, 36.30000000000003, -50.00000000000044, -50.00000000000044, 29.899999999999984, 34.50000000000004, -50.00000000000044, 44.10000000000001, 43.900000000000006, 43.900000000000006, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 8.299999999999677, 42.10000000000001, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 16.8999999999998, 46.3, 43.10000000000001, 41.30000000000001, -50.00000000000044, 45.9, 1.8999999999995865, 37.90000000000003, 39.10000000000002, 42.30000000000001, 43.900000000000006, -50.00000000000044, 44.7, 43.50000000000001, -50.00000000000044, 4.899999999999629, 20.299999999999848, -50.00000000000044, -50.00000000000044, 39.90000000000002, 44.5, 42.70000000000001, 24.499999999999908, 44.900000000000006, 44.7, 43.7, 39.90000000000002, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 46.5, 45.9, 46.099999999999994, 45.9, 25.099999999999916, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.300000000000026, 42.500000000000014, 40.500000000000014, -50.00000000000044, 22.699999999999882, -50.00000000000044, -50.00000000000044, 37.90000000000003, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 40.90000000000002, 27.299999999999947, -50.00000000000044, 5.299999999999635, 26.499999999999936], "episode_lengths": [500, 300, 216, 58, 424, 500, 34, 68, 38, 72, 500, 500, 138, 500, 500, 202, 156, 500, 60, 62, 62, 66, 500, 500, 500, 500, 500, 30, 82, 500, 500, 500, 500, 418, 80, 500, 76, 500, 500, 36, 500, 332, 38, 70, 88, 500, 42, 482, 122, 110, 78, 62, 500, 54, 66, 500, 452, 298, 500, 500, 102, 56, 74, 256, 52, 54, 64, 102, 500, 62, 500, 500, 36, 42, 40, 42, 250, 500, 500, 500, 128, 76, 96, 500, 274, 500, 500, 122, 500, 30, 500, 500, 50, 500, 500, 92, 228, 500, 448, 236]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3771767043272294, "mean_inference_ms": 1.2022629147800235, "mean_action_processing_ms": 0.13933343624074154, "mean_env_wait_ms": 0.08263901390557779, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027997970581054688, "StateBufferConnector_ms": 0.0070018768310546875, "ViewRequirementAgentConnector_ms": 0.10485339164733887}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1170000, "num_agent_steps_trained": 1170000, "num_env_steps_sampled": 1170000, "num_env_steps_trained": 1170000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5721.774658358826, "num_env_steps_trained_throughput_per_sec": 5721.774658358826, "timesteps_total": 1170000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1170000, "timers": {"training_iteration_time_ms": 3186.16, "sample_time_ms": 2857.004, "load_time_ms": 17.954, "load_throughput": 1002543.918, "learn_time_ms": 299.59, "learn_throughput": 60082.08, "synch_weights_time_ms": 8.942}, "counters": {"num_env_steps_sampled": 1170000, "num_env_steps_trained": 1170000, "num_agent_steps_sampled": 1170000, "num_agent_steps_trained": 1170000}, "done": false, "episodes_total": 4482, "training_iteration": 65, "trial_id": "9f288_00015", "date": "2023-10-25_16-50-11", "timestamp": 1698249011, "time_this_iter_s": 3.1508753299713135, "time_total_s": 208.38851952552795, "pid": 4200, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 208.38851952552795, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 54.04, "ram_util_percent": 27.240000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.421010862427523e-21, "cur_lr": 0.0003, "total_loss": 6.3232430696487425, "policy_loss": -0.03637693375349045, "vf_loss": 6.359671425819397, "vf_explained_var": -9.000301361083984e-07, "kl": 0.0008060510912216046, "entropy": 0.5136090412735939, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1310.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 1188000, "num_env_steps_trained": 1188000, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.2389999999997977, "episode_len_mean": 283.18, "episode_media": {}, "episodes_this_iter": 59, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 39.90000000000002, 44.5, 42.70000000000001, 24.499999999999908, 44.900000000000006, 44.7, 43.7, 39.90000000000002, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 46.5, 45.9, 46.099999999999994, 45.9, 25.099999999999916, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.300000000000026, 42.500000000000014, 40.500000000000014, -50.00000000000044, 22.699999999999882, -50.00000000000044, -50.00000000000044, 37.90000000000003, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 40.90000000000002, 27.299999999999947, -50.00000000000044, 5.299999999999635, 26.499999999999936, 38.700000000000024, 41.30000000000001, -50.00000000000044, 46.099999999999994, 24.69999999999991, 19.499999999999837, -50.00000000000044, 42.30000000000001, 44.5, 38.700000000000024, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 10.099999999999703, 41.30000000000001, 43.900000000000006, 44.900000000000006, -50.00000000000044, -50.00000000000044, 22.899999999999885, 26.69999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.699999999999967, -50.00000000000044, -50.00000000000044, 27.099999999999945, 41.70000000000002, 42.500000000000014, 45.9, -50.00000000000044, -50.00000000000044, 45.3, 35.900000000000034, 45.3, 36.900000000000034, -50.00000000000044, 31.900000000000013, 41.500000000000014, -50.00000000000044, 45.3, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 44.300000000000004, -50.00000000000044, 46.9, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 102, 56, 74, 256, 52, 54, 64, 102, 500, 62, 500, 500, 36, 42, 40, 42, 250, 500, 500, 500, 128, 76, 96, 500, 274, 500, 500, 122, 500, 30, 500, 500, 50, 500, 500, 92, 228, 500, 448, 236, 114, 88, 500, 40, 254, 306, 500, 78, 56, 114, 54, 500, 500, 500, 500, 400, 88, 62, 52, 500, 500, 272, 234, 500, 500, 500, 500, 500, 500, 214, 500, 500, 230, 84, 76, 42, 500, 500, 48, 142, 48, 132, 500, 182, 86, 500, 48, 72, 500, 500, 500, 52, 58, 500, 32, 500, 48, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.377035804709328, "mean_inference_ms": 1.2021558337648366, "mean_action_processing_ms": 0.13949018581350756, "mean_env_wait_ms": 0.0825419989978071, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030997276306152344, "StateBufferConnector_ms": 0.00600123405456543, "ViewRequirementAgentConnector_ms": 0.12085080146789551}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.2389999999997977, "episode_len_mean": 283.18, "episodes_this_iter": 59, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 39.90000000000002, 44.5, 42.70000000000001, 24.499999999999908, 44.900000000000006, 44.7, 43.7, 39.90000000000002, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 46.5, 45.9, 46.099999999999994, 45.9, 25.099999999999916, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.300000000000026, 42.500000000000014, 40.500000000000014, -50.00000000000044, 22.699999999999882, -50.00000000000044, -50.00000000000044, 37.90000000000003, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 40.90000000000002, 27.299999999999947, -50.00000000000044, 5.299999999999635, 26.499999999999936, 38.700000000000024, 41.30000000000001, -50.00000000000044, 46.099999999999994, 24.69999999999991, 19.499999999999837, -50.00000000000044, 42.30000000000001, 44.5, 38.700000000000024, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 10.099999999999703, 41.30000000000001, 43.900000000000006, 44.900000000000006, -50.00000000000044, -50.00000000000044, 22.899999999999885, 26.69999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.699999999999967, -50.00000000000044, -50.00000000000044, 27.099999999999945, 41.70000000000002, 42.500000000000014, 45.9, -50.00000000000044, -50.00000000000044, 45.3, 35.900000000000034, 45.3, 36.900000000000034, -50.00000000000044, 31.900000000000013, 41.500000000000014, -50.00000000000044, 45.3, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 44.300000000000004, -50.00000000000044, 46.9, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 102, 56, 74, 256, 52, 54, 64, 102, 500, 62, 500, 500, 36, 42, 40, 42, 250, 500, 500, 500, 128, 76, 96, 500, 274, 500, 500, 122, 500, 30, 500, 500, 50, 500, 500, 92, 228, 500, 448, 236, 114, 88, 500, 40, 254, 306, 500, 78, 56, 114, 54, 500, 500, 500, 500, 400, 88, 62, 52, 500, 500, 272, 234, 500, 500, 500, 500, 500, 500, 214, 500, 500, 230, 84, 76, 42, 500, 500, 48, 142, 48, 132, 500, 182, 86, 500, 48, 72, 500, 500, 500, 52, 58, 500, 32, 500, 48, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.377035804709328, "mean_inference_ms": 1.2021558337648366, "mean_action_processing_ms": 0.13949018581350756, "mean_env_wait_ms": 0.0825419989978071, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030997276306152344, "StateBufferConnector_ms": 0.00600123405456543, "ViewRequirementAgentConnector_ms": 0.12085080146789551}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000, "num_env_steps_sampled": 1188000, "num_env_steps_trained": 1188000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5652.029217552542, "num_env_steps_trained_throughput_per_sec": 5652.029217552542, "timesteps_total": 1188000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1188000, "timers": {"training_iteration_time_ms": 3192.765, "sample_time_ms": 2854.004, "load_time_ms": 18.946, "load_throughput": 950045.704, "learn_time_ms": 308.578, "learn_throughput": 58332.124, "synch_weights_time_ms": 8.768}, "counters": {"num_env_steps_sampled": 1188000, "num_env_steps_trained": 1188000, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000}, "done": false, "episodes_total": 4541, "training_iteration": 66, "trial_id": "9f288_00015", "date": "2023-10-25_16-50-14", "timestamp": 1698249014, "time_this_iter_s": 3.1898272037506104, "time_total_s": 211.57834672927856, "pid": 4200, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 211.57834672927856, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 64.725, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.7105054312137616e-21, "cur_lr": 0.0003, "total_loss": 7.401333260536194, "policy_loss": -0.012773803621530532, "vf_loss": 7.414159059524536, "vf_explained_var": -6.854534149169921e-08, "kl": 0.00024927067377689127, "entropy": 0.5203830152750015, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1330.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 1206000, "num_env_steps_trained": 1206000, "num_agent_steps_sampled": 1206000, "num_agent_steps_trained": 1206000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.901999999999841, "episode_len_mean": 241.66, "episode_media": {}, "episodes_this_iter": 80, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.900000000000034, 45.3, 36.900000000000034, -50.00000000000044, 31.900000000000013, 41.500000000000014, -50.00000000000044, 45.3, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 44.300000000000004, -50.00000000000044, 46.9, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 1.299999999999578, 42.500000000000014, 45.9, 43.7, 45.3, 40.30000000000002, 44.300000000000004, 17.499999999999808, 22.299999999999876, 45.9, 43.900000000000006, -50.00000000000044, 46.5, 42.30000000000001, 44.7, -50.00000000000044, 45.3, 44.300000000000004, 46.9, 30.499999999999993, -50.00000000000044, 45.1, 40.10000000000002, 39.70000000000002, 43.50000000000001, -50.00000000000044, 28.29999999999996, 25.699999999999925, 29.69999999999998, 45.1, 46.3, 25.29999999999992, 41.100000000000016, 39.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.899999999999842, 45.3, 16.499999999999794, -50.00000000000044, 42.900000000000006, 31.300000000000004, 41.100000000000016, 45.1, 35.500000000000036, 45.7, 30.099999999999987, -50.00000000000044, -50.00000000000044, 36.70000000000003, 44.900000000000006, 36.30000000000003, 3.2999999999996064, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 47.5, -50.00000000000044, 45.5, -50.00000000000044, 42.30000000000001, 44.300000000000004, -50.00000000000044, 39.90000000000002, 26.89999999999994, 39.90000000000002, 12.299999999999734, 35.500000000000036, -50.00000000000044], "episode_lengths": [142, 48, 132, 500, 182, 86, 500, 48, 72, 500, 500, 500, 52, 58, 500, 32, 500, 48, 500, 500, 488, 76, 42, 64, 48, 98, 58, 326, 278, 42, 62, 500, 36, 78, 54, 500, 48, 58, 32, 196, 500, 50, 100, 104, 66, 500, 218, 244, 204, 50, 38, 248, 90, 106, 500, 500, 500, 302, 48, 336, 500, 72, 188, 90, 50, 146, 44, 200, 500, 500, 134, 52, 138, 468, 500, 500, 48, 500, 500, 50, 500, 46, 500, 500, 500, 84, 500, 26, 500, 46, 500, 78, 58, 500, 102, 232, 102, 378, 146, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3767778367627747, "mean_inference_ms": 1.2023105506638307, "mean_action_processing_ms": 0.13964149279566737, "mean_env_wait_ms": 0.08264311485598498, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02299189567565918, "StateBufferConnector_ms": 0.00500178337097168, "ViewRequirementAgentConnector_ms": 0.11099982261657715}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.901999999999841, "episode_len_mean": 241.66, "episodes_this_iter": 80, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [35.900000000000034, 45.3, 36.900000000000034, -50.00000000000044, 31.900000000000013, 41.500000000000014, -50.00000000000044, 45.3, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 44.300000000000004, -50.00000000000044, 46.9, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 1.299999999999578, 42.500000000000014, 45.9, 43.7, 45.3, 40.30000000000002, 44.300000000000004, 17.499999999999808, 22.299999999999876, 45.9, 43.900000000000006, -50.00000000000044, 46.5, 42.30000000000001, 44.7, -50.00000000000044, 45.3, 44.300000000000004, 46.9, 30.499999999999993, -50.00000000000044, 45.1, 40.10000000000002, 39.70000000000002, 43.50000000000001, -50.00000000000044, 28.29999999999996, 25.699999999999925, 29.69999999999998, 45.1, 46.3, 25.29999999999992, 41.100000000000016, 39.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.899999999999842, 45.3, 16.499999999999794, -50.00000000000044, 42.900000000000006, 31.300000000000004, 41.100000000000016, 45.1, 35.500000000000036, 45.7, 30.099999999999987, -50.00000000000044, -50.00000000000044, 36.70000000000003, 44.900000000000006, 36.30000000000003, 3.2999999999996064, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 47.5, -50.00000000000044, 45.5, -50.00000000000044, 42.30000000000001, 44.300000000000004, -50.00000000000044, 39.90000000000002, 26.89999999999994, 39.90000000000002, 12.299999999999734, 35.500000000000036, -50.00000000000044], "episode_lengths": [142, 48, 132, 500, 182, 86, 500, 48, 72, 500, 500, 500, 52, 58, 500, 32, 500, 48, 500, 500, 488, 76, 42, 64, 48, 98, 58, 326, 278, 42, 62, 500, 36, 78, 54, 500, 48, 58, 32, 196, 500, 50, 100, 104, 66, 500, 218, 244, 204, 50, 38, 248, 90, 106, 500, 500, 500, 302, 48, 336, 500, 72, 188, 90, 50, 146, 44, 200, 500, 500, 134, 52, 138, 468, 500, 500, 48, 500, 500, 50, 500, 46, 500, 500, 500, 84, 500, 26, 500, 46, 500, 78, 58, 500, 102, 232, 102, 378, 146, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3767778367627747, "mean_inference_ms": 1.2023105506638307, "mean_action_processing_ms": 0.13964149279566737, "mean_env_wait_ms": 0.08264311485598498, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02299189567565918, "StateBufferConnector_ms": 0.00500178337097168, "ViewRequirementAgentConnector_ms": 0.11099982261657715}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1206000, "num_agent_steps_trained": 1206000, "num_env_steps_sampled": 1206000, "num_env_steps_trained": 1206000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5699.39823663018, "num_env_steps_trained_throughput_per_sec": 5699.39823663018, "timesteps_total": 1206000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1206000, "timers": {"training_iteration_time_ms": 3194.08, "sample_time_ms": 2852.433, "load_time_ms": 18.992, "load_throughput": 947757.03, "learn_time_ms": 311.371, "learn_throughput": 57808.849, "synch_weights_time_ms": 8.814}, "counters": {"num_env_steps_sampled": 1206000, "num_env_steps_trained": 1206000, "num_agent_steps_sampled": 1206000, "num_agent_steps_trained": 1206000}, "done": false, "episodes_total": 4621, "training_iteration": 67, "trial_id": "9f288_00015", "date": "2023-10-25_16-50-17", "timestamp": 1698249017, "time_this_iter_s": 3.165224552154541, "time_total_s": 214.7435712814331, "pid": 4200, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 214.7435712814331, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 55.14, "ram_util_percent": 27.22}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.3552527156068808e-21, "cur_lr": 0.0003, "total_loss": 7.461491489410401, "policy_loss": -0.022395374486222863, "vf_loss": 7.483938241004944, "vf_explained_var": -1.0013580322265625e-06, "kl": 0.00011925275972117788, "entropy": 0.5147824987769127, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1350.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 1224000, "num_env_steps_trained": 1224000, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 17.154999999999873, "episode_len_mean": 214.22, "episode_media": {}, "episodes_this_iter": 87, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [47.5, -50.00000000000044, 45.5, -50.00000000000044, 42.30000000000001, 44.300000000000004, -50.00000000000044, 39.90000000000002, 26.89999999999994, 39.90000000000002, 12.299999999999734, 35.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.300000000000026, 45.3, 40.70000000000002, 46.3, 44.7, 34.70000000000004, 43.30000000000001, 45.9, 10.699999999999712, 21.09999999999986, 41.100000000000016, 46.099999999999994, 44.5, 42.10000000000001, 44.900000000000006, 45.7, 42.500000000000014, -50.00000000000044, -50.00000000000044, 32.100000000000016, 38.300000000000026, -50.00000000000044, -50.00000000000044, 18.099999999999817, -50.00000000000044, 45.5, 32.50000000000002, 47.7, 38.300000000000026, 32.700000000000024, 37.300000000000026, 28.699999999999967, 3.499999999999609, 43.30000000000001, 42.70000000000001, 43.7, 43.50000000000001, -50.00000000000044, 20.299999999999848, 22.099999999999874, 20.299999999999848, 46.9, 42.500000000000014, -50.00000000000044, 44.5, -50.00000000000044, 43.30000000000001, 45.1, 4.899999999999629, 46.099999999999994, 45.5, 45.3, -50.00000000000044, 37.10000000000003, 44.7, -50.00000000000044, 24.299999999999905, -50.00000000000044, 45.3, 41.500000000000014, 44.300000000000004, -50.00000000000044, 46.099999999999994, -50.00000000000044, 20.699999999999854, 40.10000000000002, 44.300000000000004, 45.7, -50.00000000000044, 25.699999999999925, 44.10000000000001, 43.900000000000006, 24.099999999999902, 46.5, 43.7, 42.500000000000014, 43.10000000000001, 45.5, -50.00000000000044, 8.699999999999683, -50.00000000000044, 26.89999999999994, 41.70000000000002, 27.299999999999947], "episode_lengths": [26, 500, 46, 500, 78, 58, 500, 102, 232, 102, 378, 146, 500, 500, 500, 500, 108, 48, 94, 38, 54, 154, 68, 42, 394, 290, 90, 40, 56, 80, 52, 44, 76, 500, 500, 180, 118, 500, 500, 320, 500, 46, 176, 24, 118, 174, 128, 214, 466, 68, 74, 64, 66, 500, 298, 280, 298, 32, 76, 500, 56, 500, 68, 50, 452, 40, 46, 48, 500, 130, 54, 500, 258, 500, 48, 86, 58, 500, 40, 500, 294, 100, 58, 44, 500, 244, 60, 62, 260, 36, 64, 76, 70, 46, 500, 414, 500, 232, 84, 228]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37663966406636995, "mean_inference_ms": 1.2016390767493386, "mean_action_processing_ms": 0.13947163987065217, "mean_env_wait_ms": 0.08293016587451824, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026001453399658203, "StateBufferConnector_ms": 0.007999181747436523, "ViewRequirementAgentConnector_ms": 0.12197089195251465}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 17.154999999999873, "episode_len_mean": 214.22, "episodes_this_iter": 87, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [47.5, -50.00000000000044, 45.5, -50.00000000000044, 42.30000000000001, 44.300000000000004, -50.00000000000044, 39.90000000000002, 26.89999999999994, 39.90000000000002, 12.299999999999734, 35.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.300000000000026, 45.3, 40.70000000000002, 46.3, 44.7, 34.70000000000004, 43.30000000000001, 45.9, 10.699999999999712, 21.09999999999986, 41.100000000000016, 46.099999999999994, 44.5, 42.10000000000001, 44.900000000000006, 45.7, 42.500000000000014, -50.00000000000044, -50.00000000000044, 32.100000000000016, 38.300000000000026, -50.00000000000044, -50.00000000000044, 18.099999999999817, -50.00000000000044, 45.5, 32.50000000000002, 47.7, 38.300000000000026, 32.700000000000024, 37.300000000000026, 28.699999999999967, 3.499999999999609, 43.30000000000001, 42.70000000000001, 43.7, 43.50000000000001, -50.00000000000044, 20.299999999999848, 22.099999999999874, 20.299999999999848, 46.9, 42.500000000000014, -50.00000000000044, 44.5, -50.00000000000044, 43.30000000000001, 45.1, 4.899999999999629, 46.099999999999994, 45.5, 45.3, -50.00000000000044, 37.10000000000003, 44.7, -50.00000000000044, 24.299999999999905, -50.00000000000044, 45.3, 41.500000000000014, 44.300000000000004, -50.00000000000044, 46.099999999999994, -50.00000000000044, 20.699999999999854, 40.10000000000002, 44.300000000000004, 45.7, -50.00000000000044, 25.699999999999925, 44.10000000000001, 43.900000000000006, 24.099999999999902, 46.5, 43.7, 42.500000000000014, 43.10000000000001, 45.5, -50.00000000000044, 8.699999999999683, -50.00000000000044, 26.89999999999994, 41.70000000000002, 27.299999999999947], "episode_lengths": [26, 500, 46, 500, 78, 58, 500, 102, 232, 102, 378, 146, 500, 500, 500, 500, 108, 48, 94, 38, 54, 154, 68, 42, 394, 290, 90, 40, 56, 80, 52, 44, 76, 500, 500, 180, 118, 500, 500, 320, 500, 46, 176, 24, 118, 174, 128, 214, 466, 68, 74, 64, 66, 500, 298, 280, 298, 32, 76, 500, 56, 500, 68, 50, 452, 40, 46, 48, 500, 130, 54, 500, 258, 500, 48, 86, 58, 500, 40, 500, 294, 100, 58, 44, 500, 244, 60, 62, 260, 36, 64, 76, 70, 46, 500, 414, 500, 232, 84, 228]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37663966406636995, "mean_inference_ms": 1.2016390767493386, "mean_action_processing_ms": 0.13947163987065217, "mean_env_wait_ms": 0.08293016587451824, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026001453399658203, "StateBufferConnector_ms": 0.007999181747436523, "ViewRequirementAgentConnector_ms": 0.12197089195251465}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000, "num_env_steps_sampled": 1224000, "num_env_steps_trained": 1224000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5628.193137429871, "num_env_steps_trained_throughput_per_sec": 5628.193137429871, "timesteps_total": 1224000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1224000, "timers": {"training_iteration_time_ms": 3190.51, "sample_time_ms": 2853.773, "load_time_ms": 18.779, "load_throughput": 958508.181, "learn_time_ms": 306.552, "learn_throughput": 58717.597, "synch_weights_time_ms": 8.736}, "counters": {"num_env_steps_sampled": 1224000, "num_env_steps_trained": 1224000, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000}, "done": false, "episodes_total": 4708, "training_iteration": 68, "trial_id": "9f288_00015", "date": "2023-10-25_16-50-20", "timestamp": 1698249020, "time_this_iter_s": 3.2024431228637695, "time_total_s": 217.94601440429688, "pid": 4200, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 217.94601440429688, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 64.875, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.776263578034404e-22, "cur_lr": 0.0003, "total_loss": 6.4927656888961796, "policy_loss": -0.029653030913323164, "vf_loss": 6.522468996047974, "vf_explained_var": -9.685754776000977e-07, "kl": 0.0003905839492560403, "entropy": 0.5025213345885277, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1370.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 1242000, "num_env_steps_trained": 1242000, "num_agent_steps_sampled": 1242000, "num_agent_steps_trained": 1242000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.184999999999858, "episode_len_mean": 223.86, "episode_media": {}, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.500000000000014, 44.300000000000004, -50.00000000000044, 46.099999999999994, -50.00000000000044, 20.699999999999854, 40.10000000000002, 44.300000000000004, 45.7, -50.00000000000044, 25.699999999999925, 44.10000000000001, 43.900000000000006, 24.099999999999902, 46.5, 43.7, 42.500000000000014, 43.10000000000001, 45.5, -50.00000000000044, 8.699999999999683, -50.00000000000044, 26.89999999999994, 41.70000000000002, 27.299999999999947, -50.00000000000044, 43.50000000000001, 46.699999999999996, 14.699999999999768, 45.5, 43.50000000000001, 21.699999999999868, -50.00000000000044, 43.30000000000001, 45.9, 44.7, -50.00000000000044, 47.1, -50.00000000000044, 44.900000000000006, 43.50000000000001, 41.500000000000014, 45.5, -50.00000000000044, 44.10000000000001, 34.30000000000004, -50.00000000000044, 42.70000000000001, -50.00000000000044, 45.7, 43.7, -50.00000000000044, 39.90000000000002, 46.5, 43.7, 41.100000000000016, 44.300000000000004, -50.00000000000044, 34.70000000000004, 37.90000000000003, 44.10000000000001, -50.00000000000044, -50.00000000000044, 44.7, 42.900000000000006, 34.30000000000004, 10.499999999999709, -50.00000000000044, 39.90000000000002, 15.299999999999777, 10.699999999999712, 46.3, 43.50000000000001, 35.900000000000034, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 41.90000000000001, 46.699999999999996, 45.3, -50.00000000000044, 44.900000000000006, 45.3, 44.7, 42.500000000000014, 42.500000000000014, 40.500000000000014, 27.49999999999995, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 32.90000000000003, -50.00000000000044, -50.00000000000044], "episode_lengths": [86, 58, 500, 40, 500, 294, 100, 58, 44, 500, 244, 60, 62, 260, 36, 64, 76, 70, 46, 500, 414, 500, 232, 84, 228, 500, 66, 34, 354, 46, 66, 284, 500, 68, 42, 54, 500, 30, 500, 52, 66, 86, 46, 500, 60, 158, 500, 74, 500, 44, 64, 500, 102, 36, 64, 90, 58, 500, 154, 122, 60, 500, 500, 54, 72, 158, 396, 500, 102, 348, 394, 38, 66, 142, 88, 500, 500, 500, 500, 500, 72, 500, 82, 34, 48, 500, 52, 48, 54, 76, 76, 96, 226, 500, 500, 56, 500, 172, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3765370485492116, "mean_inference_ms": 1.2015734380991059, "mean_action_processing_ms": 0.13947220297658128, "mean_env_wait_ms": 0.08277231021137803, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016999483108520508, "StateBufferConnector_ms": 0.005999565124511719, "ViewRequirementAgentConnector_ms": 0.11201930046081543}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.184999999999858, "episode_len_mean": 223.86, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [41.500000000000014, 44.300000000000004, -50.00000000000044, 46.099999999999994, -50.00000000000044, 20.699999999999854, 40.10000000000002, 44.300000000000004, 45.7, -50.00000000000044, 25.699999999999925, 44.10000000000001, 43.900000000000006, 24.099999999999902, 46.5, 43.7, 42.500000000000014, 43.10000000000001, 45.5, -50.00000000000044, 8.699999999999683, -50.00000000000044, 26.89999999999994, 41.70000000000002, 27.299999999999947, -50.00000000000044, 43.50000000000001, 46.699999999999996, 14.699999999999768, 45.5, 43.50000000000001, 21.699999999999868, -50.00000000000044, 43.30000000000001, 45.9, 44.7, -50.00000000000044, 47.1, -50.00000000000044, 44.900000000000006, 43.50000000000001, 41.500000000000014, 45.5, -50.00000000000044, 44.10000000000001, 34.30000000000004, -50.00000000000044, 42.70000000000001, -50.00000000000044, 45.7, 43.7, -50.00000000000044, 39.90000000000002, 46.5, 43.7, 41.100000000000016, 44.300000000000004, -50.00000000000044, 34.70000000000004, 37.90000000000003, 44.10000000000001, -50.00000000000044, -50.00000000000044, 44.7, 42.900000000000006, 34.30000000000004, 10.499999999999709, -50.00000000000044, 39.90000000000002, 15.299999999999777, 10.699999999999712, 46.3, 43.50000000000001, 35.900000000000034, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 41.90000000000001, 46.699999999999996, 45.3, -50.00000000000044, 44.900000000000006, 45.3, 44.7, 42.500000000000014, 42.500000000000014, 40.500000000000014, 27.49999999999995, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 32.90000000000003, -50.00000000000044, -50.00000000000044], "episode_lengths": [86, 58, 500, 40, 500, 294, 100, 58, 44, 500, 244, 60, 62, 260, 36, 64, 76, 70, 46, 500, 414, 500, 232, 84, 228, 500, 66, 34, 354, 46, 66, 284, 500, 68, 42, 54, 500, 30, 500, 52, 66, 86, 46, 500, 60, 158, 500, 74, 500, 44, 64, 500, 102, 36, 64, 90, 58, 500, 154, 122, 60, 500, 500, 54, 72, 158, 396, 500, 102, 348, 394, 38, 66, 142, 88, 500, 500, 500, 500, 500, 72, 500, 82, 34, 48, 500, 52, 48, 54, 76, 76, 96, 226, 500, 500, 56, 500, 172, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3765370485492116, "mean_inference_ms": 1.2015734380991059, "mean_action_processing_ms": 0.13947220297658128, "mean_env_wait_ms": 0.08277231021137803, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016999483108520508, "StateBufferConnector_ms": 0.005999565124511719, "ViewRequirementAgentConnector_ms": 0.11201930046081543}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1242000, "num_agent_steps_trained": 1242000, "num_env_steps_sampled": 1242000, "num_env_steps_trained": 1242000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5697.851460717659, "num_env_steps_trained_throughput_per_sec": 5697.851460717659, "timesteps_total": 1242000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1242000, "timers": {"training_iteration_time_ms": 3193.474, "sample_time_ms": 2850.977, "load_time_ms": 18.806, "load_throughput": 957143.535, "learn_time_ms": 312.259, "learn_throughput": 57644.428, "synch_weights_time_ms": 8.833}, "counters": {"num_env_steps_sampled": 1242000, "num_env_steps_trained": 1242000, "num_agent_steps_sampled": 1242000, "num_agent_steps_trained": 1242000}, "done": false, "episodes_total": 4783, "training_iteration": 69, "trial_id": "9f288_00015", "date": "2023-10-25_16-50-23", "timestamp": 1698249023, "time_this_iter_s": 3.164081335067749, "time_total_s": 221.11009573936462, "pid": 4200, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 221.11009573936462, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 55.2, "ram_util_percent": 27.22}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.388131789017202e-22, "cur_lr": 0.0003, "total_loss": 6.485131287574768, "policy_loss": -0.0230104417540133, "vf_loss": 6.50819582939148, "vf_explained_var": -9.65595245361328e-07, "kl": 0.00015621720921217276, "entropy": 0.5425967961549759, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1390.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 1260000, "num_env_steps_trained": 1260000, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.670999999999807, "episode_len_mean": 278.9, "episode_media": {}, "episodes_this_iter": 60, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.10000000000001, -50.00000000000044, -50.00000000000044, 44.7, 42.900000000000006, 34.30000000000004, 10.499999999999709, -50.00000000000044, 39.90000000000002, 15.299999999999777, 10.699999999999712, 46.3, 43.50000000000001, 35.900000000000034, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 41.90000000000001, 46.699999999999996, 45.3, -50.00000000000044, 44.900000000000006, 45.3, 44.7, 42.500000000000014, 42.500000000000014, 40.500000000000014, 27.49999999999995, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 32.90000000000003, -50.00000000000044, -50.00000000000044, 32.100000000000016, -50.00000000000044, 44.300000000000004, 41.70000000000002, -50.00000000000044, -50.00000000000044, 34.900000000000034, -50.00000000000044, 45.3, 41.30000000000001, -50.00000000000044, 43.900000000000006, 18.499999999999822, 39.300000000000026, 7.699999999999669, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 40.90000000000002, -50.00000000000044, 41.500000000000014, 36.70000000000003, 30.099999999999987, 43.30000000000001, 7.09999999999966, 32.90000000000003, -50.00000000000044, 44.900000000000006, -50.00000000000044, 42.30000000000001, 42.500000000000014, 45.5, -50.00000000000044, 32.30000000000002, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 33.70000000000004, 45.3, -50.00000000000044, 42.30000000000001, 42.30000000000001, 9.299999999999692, -50.00000000000044, 37.300000000000026, 29.69999999999998, -50.00000000000044, -50.00000000000044, 10.899999999999714, -50.00000000000044, -50.00000000000044, 44.5, 4.899999999999629, 46.099999999999994, -50.00000000000044, -50.00000000000044], "episode_lengths": [60, 500, 500, 54, 72, 158, 396, 500, 102, 348, 394, 38, 66, 142, 88, 500, 500, 500, 500, 500, 72, 500, 82, 34, 48, 500, 52, 48, 54, 76, 76, 96, 226, 500, 500, 56, 500, 172, 500, 500, 180, 500, 58, 84, 500, 500, 152, 500, 48, 88, 500, 62, 316, 108, 424, 62, 500, 500, 500, 76, 500, 92, 500, 86, 134, 200, 68, 430, 172, 500, 52, 500, 78, 76, 46, 500, 178, 500, 500, 62, 500, 164, 48, 500, 78, 78, 408, 500, 128, 204, 500, 500, 392, 500, 500, 56, 452, 40, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3767457843721306, "mean_inference_ms": 1.2017532264222377, "mean_action_processing_ms": 0.13927686007079473, "mean_env_wait_ms": 0.08260207561498299, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02399754524230957, "StateBufferConnector_ms": 0.0030050277709960938, "ViewRequirementAgentConnector_ms": 0.09301638603210449}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.670999999999807, "episode_len_mean": 278.9, "episodes_this_iter": 60, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.10000000000001, -50.00000000000044, -50.00000000000044, 44.7, 42.900000000000006, 34.30000000000004, 10.499999999999709, -50.00000000000044, 39.90000000000002, 15.299999999999777, 10.699999999999712, 46.3, 43.50000000000001, 35.900000000000034, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 41.90000000000001, 46.699999999999996, 45.3, -50.00000000000044, 44.900000000000006, 45.3, 44.7, 42.500000000000014, 42.500000000000014, 40.500000000000014, 27.49999999999995, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 32.90000000000003, -50.00000000000044, -50.00000000000044, 32.100000000000016, -50.00000000000044, 44.300000000000004, 41.70000000000002, -50.00000000000044, -50.00000000000044, 34.900000000000034, -50.00000000000044, 45.3, 41.30000000000001, -50.00000000000044, 43.900000000000006, 18.499999999999822, 39.300000000000026, 7.699999999999669, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 40.90000000000002, -50.00000000000044, 41.500000000000014, 36.70000000000003, 30.099999999999987, 43.30000000000001, 7.09999999999966, 32.90000000000003, -50.00000000000044, 44.900000000000006, -50.00000000000044, 42.30000000000001, 42.500000000000014, 45.5, -50.00000000000044, 32.30000000000002, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 33.70000000000004, 45.3, -50.00000000000044, 42.30000000000001, 42.30000000000001, 9.299999999999692, -50.00000000000044, 37.300000000000026, 29.69999999999998, -50.00000000000044, -50.00000000000044, 10.899999999999714, -50.00000000000044, -50.00000000000044, 44.5, 4.899999999999629, 46.099999999999994, -50.00000000000044, -50.00000000000044], "episode_lengths": [60, 500, 500, 54, 72, 158, 396, 500, 102, 348, 394, 38, 66, 142, 88, 500, 500, 500, 500, 500, 72, 500, 82, 34, 48, 500, 52, 48, 54, 76, 76, 96, 226, 500, 500, 56, 500, 172, 500, 500, 180, 500, 58, 84, 500, 500, 152, 500, 48, 88, 500, 62, 316, 108, 424, 62, 500, 500, 500, 76, 500, 92, 500, 86, 134, 200, 68, 430, 172, 500, 52, 500, 78, 76, 46, 500, 178, 500, 500, 62, 500, 164, 48, 500, 78, 78, 408, 500, 128, 204, 500, 500, 392, 500, 500, 56, 452, 40, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3767457843721306, "mean_inference_ms": 1.2017532264222377, "mean_action_processing_ms": 0.13927686007079473, "mean_env_wait_ms": 0.08260207561498299, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02399754524230957, "StateBufferConnector_ms": 0.0030050277709960938, "ViewRequirementAgentConnector_ms": 0.09301638603210449}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000, "num_env_steps_sampled": 1260000, "num_env_steps_trained": 1260000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5757.739900833909, "num_env_steps_trained_throughput_per_sec": 5757.739900833909, "timesteps_total": 1260000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1260000, "timers": {"training_iteration_time_ms": 3190.298, "sample_time_ms": 2845.806, "load_time_ms": 18.979, "load_throughput": 948421.385, "learn_time_ms": 313.883, "learn_throughput": 57346.197, "synch_weights_time_ms": 9.231}, "counters": {"num_env_steps_sampled": 1260000, "num_env_steps_trained": 1260000, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000}, "done": false, "episodes_total": 4843, "training_iteration": 70, "trial_id": "9f288_00015", "date": "2023-10-25_16-50-26", "timestamp": 1698249026, "time_this_iter_s": 3.131898880004883, "time_total_s": 224.2419946193695, "pid": 4200, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 224.2419946193695, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 65.2, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.694065894508601e-22, "cur_lr": 0.0003, "total_loss": 6.495711159706116, "policy_loss": 0.09237710870802403, "vf_loss": 6.403389739990234, "vf_explained_var": -1.430511474609375e-06, "kl": 0.0010904112563615343, "entropy": 0.557694599032402, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1410.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 1278000, "num_env_steps_trained": 1278000, "num_agent_steps_sampled": 1278000, "num_agent_steps_trained": 1278000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.5050000000002091, "episode_len_mean": 290.62, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [36.70000000000003, 30.099999999999987, 43.30000000000001, 7.09999999999966, 32.90000000000003, -50.00000000000044, 44.900000000000006, -50.00000000000044, 42.30000000000001, 42.500000000000014, 45.5, -50.00000000000044, 32.30000000000002, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 33.70000000000004, 45.3, -50.00000000000044, 42.30000000000001, 42.30000000000001, 9.299999999999692, -50.00000000000044, 37.300000000000026, 29.69999999999998, -50.00000000000044, -50.00000000000044, 10.899999999999714, -50.00000000000044, -50.00000000000044, 44.5, 4.899999999999629, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 43.7, 40.30000000000002, -50.00000000000044, -50.00000000000044, 45.7, 45.1, -50.00000000000044, 42.10000000000001, 45.1, -50.00000000000044, -50.00000000000044, 44.7, 45.5, 43.7, 24.299999999999905, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.8999999999999, -50.00000000000044, 39.90000000000002, 45.3, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 42.500000000000014, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, 39.70000000000002, 45.3, -50.00000000000044, 41.500000000000014, 38.700000000000024, 15.899999999999785, -50.00000000000044, 36.70000000000003, 24.69999999999991, 7.899999999999672, 43.900000000000006, 29.099999999999973, 46.9, 19.899999999999842, 46.099999999999994, 43.10000000000001], "episode_lengths": [134, 200, 68, 430, 172, 500, 52, 500, 78, 76, 46, 500, 178, 500, 500, 62, 500, 164, 48, 500, 78, 78, 408, 500, 128, 204, 500, 500, 392, 500, 500, 56, 452, 40, 500, 500, 500, 66, 500, 500, 500, 42, 500, 64, 98, 500, 500, 44, 50, 500, 80, 50, 500, 500, 54, 46, 64, 258, 500, 500, 500, 500, 500, 262, 500, 102, 48, 500, 48, 500, 500, 500, 146, 500, 500, 500, 44, 76, 64, 500, 500, 500, 92, 500, 104, 48, 500, 86, 114, 342, 500, 134, 254, 422, 62, 210, 32, 302, 40, 70]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37667114992778805, "mean_inference_ms": 1.2024590602176886, "mean_action_processing_ms": 0.13924341134712923, "mean_env_wait_ms": 0.08284947860334638, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021979570388793945, "StateBufferConnector_ms": 0.007998228073120117, "ViewRequirementAgentConnector_ms": 0.1139991283416748}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.5050000000002091, "episode_len_mean": 290.62, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [36.70000000000003, 30.099999999999987, 43.30000000000001, 7.09999999999966, 32.90000000000003, -50.00000000000044, 44.900000000000006, -50.00000000000044, 42.30000000000001, 42.500000000000014, 45.5, -50.00000000000044, 32.30000000000002, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 33.70000000000004, 45.3, -50.00000000000044, 42.30000000000001, 42.30000000000001, 9.299999999999692, -50.00000000000044, 37.300000000000026, 29.69999999999998, -50.00000000000044, -50.00000000000044, 10.899999999999714, -50.00000000000044, -50.00000000000044, 44.5, 4.899999999999629, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 43.7, 40.30000000000002, -50.00000000000044, -50.00000000000044, 45.7, 45.1, -50.00000000000044, 42.10000000000001, 45.1, -50.00000000000044, -50.00000000000044, 44.7, 45.5, 43.7, 24.299999999999905, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.8999999999999, -50.00000000000044, 39.90000000000002, 45.3, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 42.500000000000014, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, 39.70000000000002, 45.3, -50.00000000000044, 41.500000000000014, 38.700000000000024, 15.899999999999785, -50.00000000000044, 36.70000000000003, 24.69999999999991, 7.899999999999672, 43.900000000000006, 29.099999999999973, 46.9, 19.899999999999842, 46.099999999999994, 43.10000000000001], "episode_lengths": [134, 200, 68, 430, 172, 500, 52, 500, 78, 76, 46, 500, 178, 500, 500, 62, 500, 164, 48, 500, 78, 78, 408, 500, 128, 204, 500, 500, 392, 500, 500, 56, 452, 40, 500, 500, 500, 66, 500, 500, 500, 42, 500, 64, 98, 500, 500, 44, 50, 500, 80, 50, 500, 500, 54, 46, 64, 258, 500, 500, 500, 500, 500, 262, 500, 102, 48, 500, 48, 500, 500, 500, 146, 500, 500, 500, 44, 76, 64, 500, 500, 500, 92, 500, 104, 48, 500, 86, 114, 342, 500, 134, 254, 422, 62, 210, 32, 302, 40, 70]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37667114992778805, "mean_inference_ms": 1.2024590602176886, "mean_action_processing_ms": 0.13924341134712923, "mean_env_wait_ms": 0.08284947860334638, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021979570388793945, "StateBufferConnector_ms": 0.007998228073120117, "ViewRequirementAgentConnector_ms": 0.1139991283416748}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1278000, "num_agent_steps_trained": 1278000, "num_env_steps_sampled": 1278000, "num_env_steps_trained": 1278000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5616.648452245358, "num_env_steps_trained_throughput_per_sec": 5616.648452245358, "timesteps_total": 1278000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1278000, "timers": {"training_iteration_time_ms": 3188.197, "sample_time_ms": 2839.006, "load_time_ms": 18.815, "load_throughput": 956663.25, "learn_time_ms": 318.754, "learn_throughput": 56469.891, "synch_weights_time_ms": 9.322}, "counters": {"num_env_steps_sampled": 1278000, "num_env_steps_trained": 1278000, "num_agent_steps_sampled": 1278000, "num_agent_steps_trained": 1278000}, "done": false, "episodes_total": 4907, "training_iteration": 71, "trial_id": "9f288_00015", "date": "2023-10-25_16-50-30", "timestamp": 1698249030, "time_this_iter_s": 3.2097561359405518, "time_total_s": 227.45175075531006, "pid": 4200, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 227.45175075531006, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 54.160000000000004, "ram_util_percent": 27.22}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.470329472543005e-23, "cur_lr": 0.0003, "total_loss": 6.355681443214417, "policy_loss": -0.050598681159317496, "vf_loss": 6.406334853172302, "vf_explained_var": -1.2576580047607423e-06, "kl": 0.000974469279577761, "entropy": 0.5485173493623734, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1430.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 1296000, "num_env_steps_trained": 1296000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.8139999999998215, "episode_len_mean": 262.5, "episode_media": {}, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.90000000000002, 45.3, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 42.500000000000014, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, 39.70000000000002, 45.3, -50.00000000000044, 41.500000000000014, 38.700000000000024, 15.899999999999785, -50.00000000000044, 36.70000000000003, 24.69999999999991, 7.899999999999672, 43.900000000000006, 29.099999999999973, 46.9, 19.899999999999842, 46.099999999999994, 43.10000000000001, -50.00000000000044, -50.00000000000044, 39.90000000000002, 26.499999999999936, 41.30000000000001, 8.899999999999686, -50.00000000000044, -50.00000000000044, 13.499999999999751, 43.50000000000001, 40.90000000000002, -50.00000000000044, 41.100000000000016, 44.300000000000004, 40.10000000000002, -50.00000000000044, 46.099999999999994, 46.5, 35.30000000000004, 41.90000000000001, 44.5, -50.00000000000044, 10.299999999999706, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 43.50000000000001, -50.00000000000044, 43.7, 43.7, 29.099999999999973, -50.00000000000044, 40.10000000000002, 45.7, 24.099999999999902, -50.00000000000044, 10.499999999999709, 44.5, -50.00000000000044, 44.5, 44.300000000000004, 38.50000000000003, 31.500000000000007, 44.300000000000004, 41.500000000000014, 42.70000000000001, -50.00000000000044, 39.90000000000002, 17.899999999999814, 41.500000000000014, 46.699999999999996, 27.099999999999945, -50.00000000000044, 41.70000000000002, 39.90000000000002, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [102, 48, 500, 48, 500, 500, 500, 146, 500, 500, 500, 44, 76, 64, 500, 500, 500, 92, 500, 104, 48, 500, 86, 114, 342, 500, 134, 254, 422, 62, 210, 32, 302, 40, 70, 500, 500, 102, 236, 88, 412, 500, 500, 366, 66, 92, 500, 90, 58, 100, 500, 40, 36, 148, 82, 56, 500, 398, 500, 500, 500, 36, 500, 66, 500, 64, 64, 210, 500, 100, 44, 260, 500, 396, 56, 500, 56, 58, 116, 186, 58, 86, 74, 500, 102, 322, 86, 34, 230, 500, 84, 102, 84, 500, 500, 500, 66, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37653905813795996, "mean_inference_ms": 1.2021908181010421, "mean_action_processing_ms": 0.1392858655211628, "mean_env_wait_ms": 0.08270176400353459, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01797628402709961, "StateBufferConnector_ms": 0.008994579315185547, "ViewRequirementAgentConnector_ms": 0.10553431510925293}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.8139999999998215, "episode_len_mean": 262.5, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [39.90000000000002, 45.3, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 42.500000000000014, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, 39.70000000000002, 45.3, -50.00000000000044, 41.500000000000014, 38.700000000000024, 15.899999999999785, -50.00000000000044, 36.70000000000003, 24.69999999999991, 7.899999999999672, 43.900000000000006, 29.099999999999973, 46.9, 19.899999999999842, 46.099999999999994, 43.10000000000001, -50.00000000000044, -50.00000000000044, 39.90000000000002, 26.499999999999936, 41.30000000000001, 8.899999999999686, -50.00000000000044, -50.00000000000044, 13.499999999999751, 43.50000000000001, 40.90000000000002, -50.00000000000044, 41.100000000000016, 44.300000000000004, 40.10000000000002, -50.00000000000044, 46.099999999999994, 46.5, 35.30000000000004, 41.90000000000001, 44.5, -50.00000000000044, 10.299999999999706, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 43.50000000000001, -50.00000000000044, 43.7, 43.7, 29.099999999999973, -50.00000000000044, 40.10000000000002, 45.7, 24.099999999999902, -50.00000000000044, 10.499999999999709, 44.5, -50.00000000000044, 44.5, 44.300000000000004, 38.50000000000003, 31.500000000000007, 44.300000000000004, 41.500000000000014, 42.70000000000001, -50.00000000000044, 39.90000000000002, 17.899999999999814, 41.500000000000014, 46.699999999999996, 27.099999999999945, -50.00000000000044, 41.70000000000002, 39.90000000000002, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [102, 48, 500, 48, 500, 500, 500, 146, 500, 500, 500, 44, 76, 64, 500, 500, 500, 92, 500, 104, 48, 500, 86, 114, 342, 500, 134, 254, 422, 62, 210, 32, 302, 40, 70, 500, 500, 102, 236, 88, 412, 500, 500, 366, 66, 92, 500, 90, 58, 100, 500, 40, 36, 148, 82, 56, 500, 398, 500, 500, 500, 36, 500, 66, 500, 64, 64, 210, 500, 100, 44, 260, 500, 396, 56, 500, 56, 58, 116, 186, 58, 86, 74, 500, 102, 322, 86, 34, 230, 500, 84, 102, 84, 500, 500, 500, 66, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37653905813795996, "mean_inference_ms": 1.2021908181010421, "mean_action_processing_ms": 0.1392858655211628, "mean_env_wait_ms": 0.08270176400353459, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01797628402709961, "StateBufferConnector_ms": 0.008994579315185547, "ViewRequirementAgentConnector_ms": 0.10553431510925293}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000, "num_env_steps_sampled": 1296000, "num_env_steps_trained": 1296000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5649.801034284964, "num_env_steps_trained_throughput_per_sec": 5649.801034284964, "timesteps_total": 1296000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1296000, "timers": {"training_iteration_time_ms": 3186.159, "sample_time_ms": 2833.688, "load_time_ms": 19.113, "load_throughput": 941754.841, "learn_time_ms": 321.756, "learn_throughput": 55943.066, "synch_weights_time_ms": 9.303}, "counters": {"num_env_steps_sampled": 1296000, "num_env_steps_trained": 1296000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "done": false, "episodes_total": 4972, "training_iteration": 72, "trial_id": "9f288_00015", "date": "2023-10-25_16-50-33", "timestamp": 1698249033, "time_this_iter_s": 3.190950870513916, "time_total_s": 230.64270162582397, "pid": 4200, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 230.64270162582397, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 64.275, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.2351647362715025e-23, "cur_lr": 0.0003, "total_loss": 6.9377490997314455, "policy_loss": -0.051501072198152545, "vf_loss": 6.989301156997681, "vf_explained_var": -9.119510650634766e-07, "kl": 0.001218221124122465, "entropy": 0.5099005326628685, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1450.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 1314000, "num_env_steps_trained": 1314000, "num_agent_steps_sampled": 1314000, "num_agent_steps_trained": 1314000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.418999999999821, "episode_len_mean": 261.44, "episode_media": {}, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.10000000000002, 45.7, 24.099999999999902, -50.00000000000044, 10.499999999999709, 44.5, -50.00000000000044, 44.5, 44.300000000000004, 38.50000000000003, 31.500000000000007, 44.300000000000004, 41.500000000000014, 42.70000000000001, -50.00000000000044, 39.90000000000002, 17.899999999999814, 41.500000000000014, 46.699999999999996, 27.099999999999945, -50.00000000000044, 41.70000000000002, 39.90000000000002, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 44.300000000000004, -50.00000000000044, 40.70000000000002, -50.00000000000044, 38.300000000000026, 46.9, 4.499999999999623, 31.300000000000004, 46.5, 28.699999999999967, 45.5, 45.9, 46.5, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.899999999999785, 39.10000000000002, 45.9, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 41.90000000000001, 45.3, 42.10000000000001, -50.00000000000044, 38.50000000000003, 27.299999999999947, -50.00000000000044, -50.00000000000044, 39.10000000000002, 42.70000000000001, 32.100000000000016, -50.00000000000044, -50.00000000000044, 36.30000000000003, -50.00000000000044, 31.1, 46.699999999999996, 10.499999999999709, 43.900000000000006, 40.90000000000002, 44.900000000000006, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 42.500000000000014, 46.5, 41.90000000000001, 8.699999999999683, -50.00000000000044, 24.499999999999908, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 43.900000000000006], "episode_lengths": [100, 44, 260, 500, 396, 56, 500, 56, 58, 116, 186, 58, 86, 74, 500, 102, 322, 86, 34, 230, 500, 84, 102, 84, 500, 500, 500, 66, 500, 500, 500, 500, 500, 68, 58, 500, 94, 500, 118, 32, 456, 188, 36, 214, 46, 42, 36, 500, 44, 500, 500, 500, 500, 342, 110, 42, 500, 40, 500, 500, 76, 500, 82, 48, 80, 500, 116, 228, 500, 500, 110, 74, 180, 500, 500, 138, 500, 190, 34, 396, 62, 92, 52, 500, 66, 500, 500, 76, 36, 82, 414, 500, 256, 72, 500, 500, 500, 500, 56, 62]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3766014294905976, "mean_inference_ms": 1.2022541535471432, "mean_action_processing_ms": 0.1393880651422187, "mean_env_wait_ms": 0.08261069997771225, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01798391342163086, "StateBufferConnector_ms": 0.00799870491027832, "ViewRequirementAgentConnector_ms": 0.11254715919494629}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.418999999999821, "episode_len_mean": 261.44, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [40.10000000000002, 45.7, 24.099999999999902, -50.00000000000044, 10.499999999999709, 44.5, -50.00000000000044, 44.5, 44.300000000000004, 38.50000000000003, 31.500000000000007, 44.300000000000004, 41.500000000000014, 42.70000000000001, -50.00000000000044, 39.90000000000002, 17.899999999999814, 41.500000000000014, 46.699999999999996, 27.099999999999945, -50.00000000000044, 41.70000000000002, 39.90000000000002, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 44.300000000000004, -50.00000000000044, 40.70000000000002, -50.00000000000044, 38.300000000000026, 46.9, 4.499999999999623, 31.300000000000004, 46.5, 28.699999999999967, 45.5, 45.9, 46.5, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.899999999999785, 39.10000000000002, 45.9, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 41.90000000000001, 45.3, 42.10000000000001, -50.00000000000044, 38.50000000000003, 27.299999999999947, -50.00000000000044, -50.00000000000044, 39.10000000000002, 42.70000000000001, 32.100000000000016, -50.00000000000044, -50.00000000000044, 36.30000000000003, -50.00000000000044, 31.1, 46.699999999999996, 10.499999999999709, 43.900000000000006, 40.90000000000002, 44.900000000000006, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 42.500000000000014, 46.5, 41.90000000000001, 8.699999999999683, -50.00000000000044, 24.499999999999908, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 43.900000000000006], "episode_lengths": [100, 44, 260, 500, 396, 56, 500, 56, 58, 116, 186, 58, 86, 74, 500, 102, 322, 86, 34, 230, 500, 84, 102, 84, 500, 500, 500, 66, 500, 500, 500, 500, 500, 68, 58, 500, 94, 500, 118, 32, 456, 188, 36, 214, 46, 42, 36, 500, 44, 500, 500, 500, 500, 342, 110, 42, 500, 40, 500, 500, 76, 500, 82, 48, 80, 500, 116, 228, 500, 500, 110, 74, 180, 500, 500, 138, 500, 190, 34, 396, 62, 92, 52, 500, 66, 500, 500, 76, 36, 82, 414, 500, 256, 72, 500, 500, 500, 500, 56, 62]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3766014294905976, "mean_inference_ms": 1.2022541535471432, "mean_action_processing_ms": 0.1393880651422187, "mean_env_wait_ms": 0.08261069997771225, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01798391342163086, "StateBufferConnector_ms": 0.00799870491027832, "ViewRequirementAgentConnector_ms": 0.11254715919494629}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1314000, "num_agent_steps_trained": 1314000, "num_env_steps_sampled": 1314000, "num_env_steps_trained": 1314000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5607.975565937962, "num_env_steps_trained_throughput_per_sec": 5607.975565937962, "timesteps_total": 1314000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1314000, "timers": {"training_iteration_time_ms": 3192.904, "sample_time_ms": 2838.734, "load_time_ms": 17.796, "load_throughput": 1011471.841, "learn_time_ms": 324.673, "learn_throughput": 55440.448, "synch_weights_time_ms": 9.503}, "counters": {"num_env_steps_sampled": 1314000, "num_env_steps_trained": 1314000, "num_agent_steps_sampled": 1314000, "num_agent_steps_trained": 1314000}, "done": false, "episodes_total": 5041, "training_iteration": 73, "trial_id": "9f288_00015", "date": "2023-10-25_16-50-36", "timestamp": 1698249036, "time_this_iter_s": 3.2147109508514404, "time_total_s": 233.85741257667542, "pid": 4200, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 233.85741257667542, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 56.36, "ram_util_percent": 27.240000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.1175823681357513e-23, "cur_lr": 0.0003, "total_loss": 6.9733140707015995, "policy_loss": -0.05619874950498342, "vf_loss": 7.029566216468811, "vf_explained_var": -9.834766387939453e-07, "kl": 0.00021190060779758825, "entropy": 0.5325539350509644, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1470.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 1332000, "num_env_steps_trained": 1332000, "num_agent_steps_sampled": 1332000, "num_agent_steps_trained": 1332000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.4459999999998185, "episode_len_mean": 266.18, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.10000000000002, 42.70000000000001, 32.100000000000016, -50.00000000000044, -50.00000000000044, 36.30000000000003, -50.00000000000044, 31.1, 46.699999999999996, 10.499999999999709, 43.900000000000006, 40.90000000000002, 44.900000000000006, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 42.500000000000014, 46.5, 41.90000000000001, 8.699999999999683, -50.00000000000044, 24.499999999999908, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 43.900000000000006, 35.30000000000004, 24.899999999999913, 42.30000000000001, 45.1, -50.00000000000044, 41.500000000000014, 34.50000000000004, 35.30000000000004, 6.499999999999652, 36.70000000000003, 42.10000000000001, 46.3, -50.00000000000044, 46.099999999999994, 19.299999999999834, 45.5, 46.099999999999994, -50.00000000000044, 16.8999999999998, 0.09999999999956088, 46.099999999999994, 41.30000000000001, 44.10000000000001, 35.70000000000003, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, 23.099999999999888, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 29.69999999999998, -50.00000000000044, 36.70000000000003, 46.699999999999996, -50.00000000000044, 41.100000000000016, 43.900000000000006, 43.10000000000001, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.299999999999905, 45.1, -50.00000000000044, 47.7, 46.099999999999994, 3.699999999999612, 19.499999999999837, 38.700000000000024, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 38.700000000000024, 44.7, 43.50000000000001, -50.00000000000044, 28.89999999999997, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 44.300000000000004, -50.00000000000044], "episode_lengths": [110, 74, 180, 500, 500, 138, 500, 190, 34, 396, 62, 92, 52, 500, 66, 500, 500, 76, 36, 82, 414, 500, 256, 72, 500, 500, 500, 500, 56, 62, 148, 252, 78, 50, 500, 86, 156, 148, 436, 134, 80, 38, 500, 40, 308, 46, 40, 500, 332, 500, 40, 88, 60, 144, 500, 104, 500, 500, 270, 500, 500, 500, 500, 500, 80, 204, 500, 134, 34, 500, 90, 62, 70, 86, 500, 500, 500, 258, 50, 500, 24, 40, 464, 306, 114, 500, 500, 30, 500, 114, 54, 66, 500, 212, 500, 500, 42, 500, 58, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37681676372074535, "mean_inference_ms": 1.202664965563487, "mean_action_processing_ms": 0.1395207664944099, "mean_env_wait_ms": 0.08265452230771123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025998353958129883, "StateBufferConnector_ms": 0.00499725341796875, "ViewRequirementAgentConnector_ms": 0.13608717918395996}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.4459999999998185, "episode_len_mean": 266.18, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [39.10000000000002, 42.70000000000001, 32.100000000000016, -50.00000000000044, -50.00000000000044, 36.30000000000003, -50.00000000000044, 31.1, 46.699999999999996, 10.499999999999709, 43.900000000000006, 40.90000000000002, 44.900000000000006, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 42.500000000000014, 46.5, 41.90000000000001, 8.699999999999683, -50.00000000000044, 24.499999999999908, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 43.900000000000006, 35.30000000000004, 24.899999999999913, 42.30000000000001, 45.1, -50.00000000000044, 41.500000000000014, 34.50000000000004, 35.30000000000004, 6.499999999999652, 36.70000000000003, 42.10000000000001, 46.3, -50.00000000000044, 46.099999999999994, 19.299999999999834, 45.5, 46.099999999999994, -50.00000000000044, 16.8999999999998, 0.09999999999956088, 46.099999999999994, 41.30000000000001, 44.10000000000001, 35.70000000000003, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, 23.099999999999888, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 29.69999999999998, -50.00000000000044, 36.70000000000003, 46.699999999999996, -50.00000000000044, 41.100000000000016, 43.900000000000006, 43.10000000000001, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.299999999999905, 45.1, -50.00000000000044, 47.7, 46.099999999999994, 3.699999999999612, 19.499999999999837, 38.700000000000024, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 38.700000000000024, 44.7, 43.50000000000001, -50.00000000000044, 28.89999999999997, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 44.300000000000004, -50.00000000000044], "episode_lengths": [110, 74, 180, 500, 500, 138, 500, 190, 34, 396, 62, 92, 52, 500, 66, 500, 500, 76, 36, 82, 414, 500, 256, 72, 500, 500, 500, 500, 56, 62, 148, 252, 78, 50, 500, 86, 156, 148, 436, 134, 80, 38, 500, 40, 308, 46, 40, 500, 332, 500, 40, 88, 60, 144, 500, 104, 500, 500, 270, 500, 500, 500, 500, 500, 80, 204, 500, 134, 34, 500, 90, 62, 70, 86, 500, 500, 500, 258, 50, 500, 24, 40, 464, 306, 114, 500, 500, 30, 500, 114, 54, 66, 500, 212, 500, 500, 42, 500, 58, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37681676372074535, "mean_inference_ms": 1.202664965563487, "mean_action_processing_ms": 0.1395207664944099, "mean_env_wait_ms": 0.08265452230771123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025998353958129883, "StateBufferConnector_ms": 0.00499725341796875, "ViewRequirementAgentConnector_ms": 0.13608717918395996}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1332000, "num_agent_steps_trained": 1332000, "num_env_steps_sampled": 1332000, "num_env_steps_trained": 1332000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5741.744710744411, "num_env_steps_trained_throughput_per_sec": 5741.744710744411, "timesteps_total": 1332000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1332000, "timers": {"training_iteration_time_ms": 3170.666, "sample_time_ms": 2818.32, "load_time_ms": 18.411, "load_throughput": 977664.12, "learn_time_ms": 322.278, "learn_throughput": 55852.393, "synch_weights_time_ms": 9.556}, "counters": {"num_env_steps_sampled": 1332000, "num_env_steps_trained": 1332000, "num_agent_steps_sampled": 1332000, "num_agent_steps_trained": 1332000}, "done": false, "episodes_total": 5111, "training_iteration": 74, "trial_id": "9f288_00015", "date": "2023-10-25_16-50-39", "timestamp": 1698249039, "time_this_iter_s": 3.13993239402771, "time_total_s": 236.99734497070312, "pid": 4200, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 236.99734497070312, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 64.55000000000001, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.0587911840678756e-23, "cur_lr": 0.0003, "total_loss": 6.62247519493103, "policy_loss": 0.06724612861871719, "vf_loss": 6.555279850959778, "vf_explained_var": -1.043081283569336e-06, "kl": 0.001233479961103967, "entropy": 0.5072033628821373, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1490.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 1350000, "num_env_steps_trained": 1350000, "num_agent_steps_sampled": 1350000, "num_agent_steps_trained": 1350000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.308999999999813, "episode_len_mean": 262.5, "episode_media": {}, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.299999999999905, 45.1, -50.00000000000044, 47.7, 46.099999999999994, 3.699999999999612, 19.499999999999837, 38.700000000000024, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 38.700000000000024, 44.7, 43.50000000000001, -50.00000000000044, 28.89999999999997, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 41.70000000000002, 41.70000000000002, 37.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, 43.900000000000006, -50.00000000000044, 44.5, -50.00000000000044, 46.099999999999994, 34.30000000000004, 46.3, -50.00000000000044, 44.7, 39.70000000000002, 46.099999999999994, -50.00000000000044, 46.699999999999996, 42.30000000000001, -50.00000000000044, 17.69999999999981, -50.00000000000044, 37.50000000000003, 42.30000000000001, 40.90000000000002, 46.5, -50.00000000000044, 45.5, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 35.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 40.10000000000002, -50.00000000000044, 45.3, 38.50000000000003, -50.00000000000044, 41.500000000000014, 24.099999999999902, 45.7, 43.900000000000006, 43.900000000000006, -50.00000000000044, 43.30000000000001, -50.00000000000044, 37.10000000000003, 46.099999999999994, -50.00000000000044, 42.900000000000006, 44.7, 24.69999999999991, 44.900000000000006, 46.099999999999994, 45.7, 45.9, 43.50000000000001], "episode_lengths": [86, 500, 500, 500, 258, 50, 500, 24, 40, 464, 306, 114, 500, 500, 30, 500, 114, 54, 66, 500, 212, 500, 500, 42, 500, 58, 500, 500, 84, 84, 128, 500, 500, 500, 154, 500, 500, 500, 500, 500, 96, 62, 500, 56, 500, 40, 158, 38, 500, 54, 104, 40, 500, 34, 78, 500, 324, 500, 126, 78, 92, 36, 500, 46, 34, 500, 500, 500, 64, 142, 500, 500, 500, 500, 500, 40, 100, 500, 48, 116, 500, 86, 260, 44, 62, 62, 500, 68, 500, 130, 40, 500, 72, 54, 254, 52, 40, 44, 42, 66]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.376573193798328, "mean_inference_ms": 1.2020383327341089, "mean_action_processing_ms": 0.1393795854014367, "mean_env_wait_ms": 0.08293421380112585, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.037006378173828125, "StateBufferConnector_ms": 0.003998756408691406, "ViewRequirementAgentConnector_ms": 0.12640881538391113}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.308999999999813, "episode_len_mean": 262.5, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.299999999999905, 45.1, -50.00000000000044, 47.7, 46.099999999999994, 3.699999999999612, 19.499999999999837, 38.700000000000024, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 38.700000000000024, 44.7, 43.50000000000001, -50.00000000000044, 28.89999999999997, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 41.70000000000002, 41.70000000000002, 37.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, 43.900000000000006, -50.00000000000044, 44.5, -50.00000000000044, 46.099999999999994, 34.30000000000004, 46.3, -50.00000000000044, 44.7, 39.70000000000002, 46.099999999999994, -50.00000000000044, 46.699999999999996, 42.30000000000001, -50.00000000000044, 17.69999999999981, -50.00000000000044, 37.50000000000003, 42.30000000000001, 40.90000000000002, 46.5, -50.00000000000044, 45.5, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 35.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 40.10000000000002, -50.00000000000044, 45.3, 38.50000000000003, -50.00000000000044, 41.500000000000014, 24.099999999999902, 45.7, 43.900000000000006, 43.900000000000006, -50.00000000000044, 43.30000000000001, -50.00000000000044, 37.10000000000003, 46.099999999999994, -50.00000000000044, 42.900000000000006, 44.7, 24.69999999999991, 44.900000000000006, 46.099999999999994, 45.7, 45.9, 43.50000000000001], "episode_lengths": [86, 500, 500, 500, 258, 50, 500, 24, 40, 464, 306, 114, 500, 500, 30, 500, 114, 54, 66, 500, 212, 500, 500, 42, 500, 58, 500, 500, 84, 84, 128, 500, 500, 500, 154, 500, 500, 500, 500, 500, 96, 62, 500, 56, 500, 40, 158, 38, 500, 54, 104, 40, 500, 34, 78, 500, 324, 500, 126, 78, 92, 36, 500, 46, 34, 500, 500, 500, 64, 142, 500, 500, 500, 500, 500, 40, 100, 500, 48, 116, 500, 86, 260, 44, 62, 62, 500, 68, 500, 130, 40, 500, 72, 54, 254, 52, 40, 44, 42, 66]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.376573193798328, "mean_inference_ms": 1.2020383327341089, "mean_action_processing_ms": 0.1393795854014367, "mean_env_wait_ms": 0.08293421380112585, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.037006378173828125, "StateBufferConnector_ms": 0.003998756408691406, "ViewRequirementAgentConnector_ms": 0.12640881538391113}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1350000, "num_agent_steps_trained": 1350000, "num_env_steps_sampled": 1350000, "num_env_steps_trained": 1350000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5689.844982330744, "num_env_steps_trained_throughput_per_sec": 5689.844982330744, "timesteps_total": 1350000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1350000, "timers": {"training_iteration_time_ms": 3172.431, "sample_time_ms": 2818.42, "load_time_ms": 18.17, "load_throughput": 990637.467, "learn_time_ms": 323.951, "learn_throughput": 55563.88, "synch_weights_time_ms": 9.72}, "counters": {"num_env_steps_sampled": 1350000, "num_env_steps_trained": 1350000, "num_agent_steps_sampled": 1350000, "num_agent_steps_trained": 1350000}, "done": false, "episodes_total": 5184, "training_iteration": 75, "trial_id": "9f288_00015", "date": "2023-10-25_16-50-43", "timestamp": 1698249043, "time_this_iter_s": 3.1694555282592773, "time_total_s": 240.1668004989624, "pid": 4200, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 240.1668004989624, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 54.720000000000006, "ram_util_percent": 27.240000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.293955920339378e-24, "cur_lr": 0.0003, "total_loss": 6.277817630767823, "policy_loss": -0.029427121207118035, "vf_loss": 6.307294511795044, "vf_explained_var": -1.245737075805664e-06, "kl": 0.0010928811318649423, "entropy": 0.4975694641470909, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1510.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 1368000, "num_env_steps_trained": 1368000, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.480999999999816, "episode_len_mean": 260.8, "episode_media": {}, "episodes_this_iter": 62, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.5, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 35.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 40.10000000000002, -50.00000000000044, 45.3, 38.50000000000003, -50.00000000000044, 41.500000000000014, 24.099999999999902, 45.7, 43.900000000000006, 43.900000000000006, -50.00000000000044, 43.30000000000001, -50.00000000000044, 37.10000000000003, 46.099999999999994, -50.00000000000044, 42.900000000000006, 44.7, 24.69999999999991, 44.900000000000006, 46.099999999999994, 45.7, 45.9, 43.50000000000001, -50.00000000000044, -50.00000000000044, 26.09999999999993, 44.5, 31.500000000000007, -50.00000000000044, 9.299999999999692, -50.00000000000044, 44.900000000000006, 45.3, 35.10000000000004, 38.90000000000002, 44.300000000000004, 44.7, 41.70000000000002, 23.699999999999896, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 34.70000000000004, 39.50000000000002, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, -50.00000000000044, 40.10000000000002, 38.90000000000002, -50.00000000000044, 9.099999999999689, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 46.9, 45.7, 17.899999999999814, 40.30000000000002, 40.10000000000002, 46.099999999999994, 39.300000000000026, 46.099999999999994, -50.00000000000044, 43.7, 45.7, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 13.299999999999748, 43.30000000000001, -50.00000000000044, 43.900000000000006, -50.00000000000044, 43.7, 21.699999999999868, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 46, 34, 500, 500, 500, 64, 142, 500, 500, 500, 500, 500, 40, 100, 500, 48, 116, 500, 86, 260, 44, 62, 62, 500, 68, 500, 130, 40, 500, 72, 54, 254, 52, 40, 44, 42, 66, 500, 500, 240, 56, 186, 500, 408, 500, 52, 48, 150, 112, 58, 54, 84, 264, 500, 500, 500, 500, 54, 154, 106, 32, 500, 500, 500, 112, 500, 100, 112, 500, 410, 500, 42, 500, 500, 32, 44, 322, 98, 100, 40, 108, 40, 500, 64, 44, 500, 42, 500, 500, 500, 368, 68, 500, 62, 500, 64, 284, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37666305846938963, "mean_inference_ms": 1.2020328199185173, "mean_action_processing_ms": 0.1394073937926618, "mean_env_wait_ms": 0.0826890800086621, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030988454818725586, "StateBufferConnector_ms": 0.006996631622314453, "ViewRequirementAgentConnector_ms": 0.11637067794799805}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.480999999999816, "episode_len_mean": 260.8, "episodes_this_iter": 62, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.5, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 35.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 40.10000000000002, -50.00000000000044, 45.3, 38.50000000000003, -50.00000000000044, 41.500000000000014, 24.099999999999902, 45.7, 43.900000000000006, 43.900000000000006, -50.00000000000044, 43.30000000000001, -50.00000000000044, 37.10000000000003, 46.099999999999994, -50.00000000000044, 42.900000000000006, 44.7, 24.69999999999991, 44.900000000000006, 46.099999999999994, 45.7, 45.9, 43.50000000000001, -50.00000000000044, -50.00000000000044, 26.09999999999993, 44.5, 31.500000000000007, -50.00000000000044, 9.299999999999692, -50.00000000000044, 44.900000000000006, 45.3, 35.10000000000004, 38.90000000000002, 44.300000000000004, 44.7, 41.70000000000002, 23.699999999999896, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 34.70000000000004, 39.50000000000002, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, -50.00000000000044, 40.10000000000002, 38.90000000000002, -50.00000000000044, 9.099999999999689, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 46.9, 45.7, 17.899999999999814, 40.30000000000002, 40.10000000000002, 46.099999999999994, 39.300000000000026, 46.099999999999994, -50.00000000000044, 43.7, 45.7, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 13.299999999999748, 43.30000000000001, -50.00000000000044, 43.900000000000006, -50.00000000000044, 43.7, 21.699999999999868, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 46, 34, 500, 500, 500, 64, 142, 500, 500, 500, 500, 500, 40, 100, 500, 48, 116, 500, 86, 260, 44, 62, 62, 500, 68, 500, 130, 40, 500, 72, 54, 254, 52, 40, 44, 42, 66, 500, 500, 240, 56, 186, 500, 408, 500, 52, 48, 150, 112, 58, 54, 84, 264, 500, 500, 500, 500, 54, 154, 106, 32, 500, 500, 500, 112, 500, 100, 112, 500, 410, 500, 42, 500, 500, 32, 44, 322, 98, 100, 40, 108, 40, 500, 64, 44, 500, 42, 500, 500, 500, 368, 68, 500, 62, 500, 64, 284, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37666305846938963, "mean_inference_ms": 1.2020328199185173, "mean_action_processing_ms": 0.1394073937926618, "mean_env_wait_ms": 0.0826890800086621, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030988454818725586, "StateBufferConnector_ms": 0.006996631622314453, "ViewRequirementAgentConnector_ms": 0.11637067794799805}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000, "num_env_steps_sampled": 1368000, "num_env_steps_trained": 1368000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5761.277773627315, "num_env_steps_trained_throughput_per_sec": 5761.277773627315, "timesteps_total": 1368000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1368000, "timers": {"training_iteration_time_ms": 3166.392, "sample_time_ms": 2822.37, "load_time_ms": 17.291, "load_throughput": 1041004.141, "learn_time_ms": 314.717, "learn_throughput": 57194.223, "synch_weights_time_ms": 9.745}, "counters": {"num_env_steps_sampled": 1368000, "num_env_steps_trained": 1368000, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000}, "done": false, "episodes_total": 5246, "training_iteration": 76, "trial_id": "9f288_00015", "date": "2023-10-25_16-50-46", "timestamp": 1698249046, "time_this_iter_s": 3.1285722255706787, "time_total_s": 243.29537272453308, "pid": 4200, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 243.29537272453308, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 65.97500000000001, "ram_util_percent": 27.224999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.646977960169689e-24, "cur_lr": 0.0003, "total_loss": 6.814186596870423, "policy_loss": 0.029295962676405905, "vf_loss": 6.784938454627991, "vf_explained_var": -9.775161743164062e-07, "kl": 0.0006970267328824775, "entropy": 0.47915802150964737, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1530.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 1386000, "num_env_steps_trained": 1386000, "num_agent_steps_sampled": 1386000, "num_agent_steps_trained": 1386000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.6730000000002068, "episode_len_mean": 292.3, "episode_media": {}, "episodes_this_iter": 62, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, -50.00000000000044, 40.10000000000002, 38.90000000000002, -50.00000000000044, 9.099999999999689, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 46.9, 45.7, 17.899999999999814, 40.30000000000002, 40.10000000000002, 46.099999999999994, 39.300000000000026, 46.099999999999994, -50.00000000000044, 43.7, 45.7, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 13.299999999999748, 43.30000000000001, -50.00000000000044, 43.900000000000006, -50.00000000000044, 43.7, 21.699999999999868, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.50000000000002, 37.10000000000003, 46.5, 33.70000000000004, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 38.700000000000024, 45.7, 34.30000000000004, -50.00000000000044, 46.699999999999996, 4.699999999999626, -50.00000000000044, 31.900000000000013, 31.70000000000001, 46.699999999999996, -50.00000000000044, -50.00000000000044, 26.09999999999993, 46.699999999999996, 22.899999999999885, -50.00000000000044, -50.00000000000044, 26.89999999999994, 36.70000000000003, -50.00000000000044, 42.900000000000006, 44.5, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, 41.70000000000002, 46.9, 42.900000000000006, 3.699999999999612, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 33.10000000000003, 45.5, 36.50000000000003, -50.00000000000044, -50.00000000000044, 15.099999999999774, 44.900000000000006, 30.9, -50.00000000000044, 30.29999999999999, 21.89999999999987], "episode_lengths": [500, 500, 500, 112, 500, 100, 112, 500, 410, 500, 42, 500, 500, 32, 44, 322, 98, 100, 40, 108, 40, 500, 64, 44, 500, 42, 500, 500, 500, 368, 68, 500, 62, 500, 64, 284, 500, 500, 500, 176, 130, 36, 164, 500, 500, 44, 500, 500, 500, 56, 114, 44, 158, 500, 34, 454, 500, 182, 184, 34, 500, 500, 240, 34, 272, 500, 500, 232, 134, 500, 72, 56, 500, 500, 80, 500, 500, 500, 100, 500, 500, 84, 32, 72, 464, 500, 500, 66, 500, 170, 46, 136, 500, 500, 350, 52, 192, 500, 198, 282]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3767928956470444, "mean_inference_ms": 1.2024552762684741, "mean_action_processing_ms": 0.1394047318494093, "mean_env_wait_ms": 0.08268770846990295, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023993730545043945, "StateBufferConnector_ms": 0.002997875213623047, "ViewRequirementAgentConnector_ms": 0.11378097534179688}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.6730000000002068, "episode_len_mean": 292.3, "episodes_this_iter": 62, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, -50.00000000000044, 40.10000000000002, 38.90000000000002, -50.00000000000044, 9.099999999999689, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 46.9, 45.7, 17.899999999999814, 40.30000000000002, 40.10000000000002, 46.099999999999994, 39.300000000000026, 46.099999999999994, -50.00000000000044, 43.7, 45.7, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 13.299999999999748, 43.30000000000001, -50.00000000000044, 43.900000000000006, -50.00000000000044, 43.7, 21.699999999999868, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.50000000000002, 37.10000000000003, 46.5, 33.70000000000004, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 38.700000000000024, 45.7, 34.30000000000004, -50.00000000000044, 46.699999999999996, 4.699999999999626, -50.00000000000044, 31.900000000000013, 31.70000000000001, 46.699999999999996, -50.00000000000044, -50.00000000000044, 26.09999999999993, 46.699999999999996, 22.899999999999885, -50.00000000000044, -50.00000000000044, 26.89999999999994, 36.70000000000003, -50.00000000000044, 42.900000000000006, 44.5, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, 41.70000000000002, 46.9, 42.900000000000006, 3.699999999999612, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 33.10000000000003, 45.5, 36.50000000000003, -50.00000000000044, -50.00000000000044, 15.099999999999774, 44.900000000000006, 30.9, -50.00000000000044, 30.29999999999999, 21.89999999999987], "episode_lengths": [500, 500, 500, 112, 500, 100, 112, 500, 410, 500, 42, 500, 500, 32, 44, 322, 98, 100, 40, 108, 40, 500, 64, 44, 500, 42, 500, 500, 500, 368, 68, 500, 62, 500, 64, 284, 500, 500, 500, 176, 130, 36, 164, 500, 500, 44, 500, 500, 500, 56, 114, 44, 158, 500, 34, 454, 500, 182, 184, 34, 500, 500, 240, 34, 272, 500, 500, 232, 134, 500, 72, 56, 500, 500, 80, 500, 500, 500, 100, 500, 500, 84, 32, 72, 464, 500, 500, 66, 500, 170, 46, 136, 500, 500, 350, 52, 192, 500, 198, 282]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3767928956470444, "mean_inference_ms": 1.2024552762684741, "mean_action_processing_ms": 0.1394047318494093, "mean_env_wait_ms": 0.08268770846990295, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023993730545043945, "StateBufferConnector_ms": 0.002997875213623047, "ViewRequirementAgentConnector_ms": 0.11378097534179688}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1386000, "num_agent_steps_trained": 1386000, "num_env_steps_sampled": 1386000, "num_env_steps_trained": 1386000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5741.574850360424, "num_env_steps_trained_throughput_per_sec": 5741.574850360424, "timesteps_total": 1386000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1386000, "timers": {"training_iteration_time_ms": 3164.072, "sample_time_ms": 2821.121, "load_time_ms": 17.32, "load_throughput": 1039277.355, "learn_time_ms": 313.484, "learn_throughput": 57419.281, "synch_weights_time_ms": 9.979}, "counters": {"num_env_steps_sampled": 1386000, "num_env_steps_trained": 1386000, "num_agent_steps_sampled": 1386000, "num_agent_steps_trained": 1386000}, "done": false, "episodes_total": 5308, "training_iteration": 77, "trial_id": "9f288_00015", "date": "2023-10-25_16-50-49", "timestamp": 1698249049, "time_this_iter_s": 3.1400253772735596, "time_total_s": 246.43539810180664, "pid": 4200, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 246.43539810180664, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 61.175, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.3234889800848445e-24, "cur_lr": 0.0003, "total_loss": 6.622639083862305, "policy_loss": 0.02886282061226666, "vf_loss": 6.593825721740723, "vf_explained_var": -8.761882781982421e-07, "kl": 0.000385015342214956, "entropy": 0.49498183876276014, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1550.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 1404000, "num_env_steps_trained": 1404000, "num_agent_steps_sampled": 1404000, "num_agent_steps_trained": 1404000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.923999999999847, "episode_len_mean": 231.44, "episode_media": {}, "episodes_this_iter": 85, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 33.10000000000003, 45.5, 36.50000000000003, -50.00000000000044, -50.00000000000044, 15.099999999999774, 44.900000000000006, 30.9, -50.00000000000044, 30.29999999999999, 21.89999999999987, -50.00000000000044, 45.1, 45.9, 46.9, -50.00000000000044, 27.899999999999956, 46.699999999999996, 44.10000000000001, 32.30000000000002, 36.10000000000004, 43.7, 45.7, 44.900000000000006, 17.099999999999802, 41.70000000000002, -50.00000000000044, 44.10000000000001, 44.5, 45.3, -50.00000000000044, -50.00000000000044, 10.099999999999703, 45.3, -50.00000000000044, -50.00000000000044, 44.900000000000006, 46.5, 45.3, 45.1, 43.900000000000006, -50.00000000000044, 40.90000000000002, -50.00000000000044, 43.7, -50.00000000000044, 42.70000000000001, 38.90000000000002, 2.699999999999598, 44.300000000000004, -50.00000000000044, 46.5, -50.00000000000044, 46.5, 40.500000000000014, 45.5, 45.7, 43.7, 22.49999999999988, -50.00000000000044, 36.10000000000004, 31.900000000000013, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, 45.3, 44.5, -50.00000000000044, 44.5, -50.00000000000044, 45.1, 44.7, -50.00000000000044, 44.5, -50.00000000000044, 35.30000000000004, 43.50000000000001, 45.1, 36.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 47.1, -50.00000000000044, 45.5, 32.100000000000016, -50.00000000000044, 45.7, 41.100000000000016, 45.7, 45.1, 35.30000000000004, -50.00000000000044, 33.500000000000036], "episode_lengths": [500, 500, 66, 500, 170, 46, 136, 500, 500, 350, 52, 192, 500, 198, 282, 500, 50, 42, 32, 500, 222, 34, 60, 178, 140, 64, 44, 52, 330, 84, 500, 60, 56, 48, 500, 500, 400, 48, 500, 500, 52, 36, 48, 50, 62, 500, 92, 500, 64, 500, 74, 112, 474, 58, 500, 36, 500, 36, 96, 46, 44, 64, 276, 500, 140, 182, 500, 500, 500, 118, 48, 56, 500, 56, 500, 50, 54, 500, 56, 500, 148, 66, 50, 134, 500, 500, 500, 32, 30, 500, 46, 180, 500, 44, 90, 44, 50, 148, 500, 166]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37626818029350845, "mean_inference_ms": 1.2011811990804826, "mean_action_processing_ms": 0.1395683272421802, "mean_env_wait_ms": 0.08289684420819925, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01698756217956543, "StateBufferConnector_ms": 0.0039975643157958984, "ViewRequirementAgentConnector_ms": 0.10559415817260742}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.923999999999847, "episode_len_mean": 231.44, "episodes_this_iter": 85, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 33.10000000000003, 45.5, 36.50000000000003, -50.00000000000044, -50.00000000000044, 15.099999999999774, 44.900000000000006, 30.9, -50.00000000000044, 30.29999999999999, 21.89999999999987, -50.00000000000044, 45.1, 45.9, 46.9, -50.00000000000044, 27.899999999999956, 46.699999999999996, 44.10000000000001, 32.30000000000002, 36.10000000000004, 43.7, 45.7, 44.900000000000006, 17.099999999999802, 41.70000000000002, -50.00000000000044, 44.10000000000001, 44.5, 45.3, -50.00000000000044, -50.00000000000044, 10.099999999999703, 45.3, -50.00000000000044, -50.00000000000044, 44.900000000000006, 46.5, 45.3, 45.1, 43.900000000000006, -50.00000000000044, 40.90000000000002, -50.00000000000044, 43.7, -50.00000000000044, 42.70000000000001, 38.90000000000002, 2.699999999999598, 44.300000000000004, -50.00000000000044, 46.5, -50.00000000000044, 46.5, 40.500000000000014, 45.5, 45.7, 43.7, 22.49999999999988, -50.00000000000044, 36.10000000000004, 31.900000000000013, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, 45.3, 44.5, -50.00000000000044, 44.5, -50.00000000000044, 45.1, 44.7, -50.00000000000044, 44.5, -50.00000000000044, 35.30000000000004, 43.50000000000001, 45.1, 36.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 47.1, -50.00000000000044, 45.5, 32.100000000000016, -50.00000000000044, 45.7, 41.100000000000016, 45.7, 45.1, 35.30000000000004, -50.00000000000044, 33.500000000000036], "episode_lengths": [500, 500, 66, 500, 170, 46, 136, 500, 500, 350, 52, 192, 500, 198, 282, 500, 50, 42, 32, 500, 222, 34, 60, 178, 140, 64, 44, 52, 330, 84, 500, 60, 56, 48, 500, 500, 400, 48, 500, 500, 52, 36, 48, 50, 62, 500, 92, 500, 64, 500, 74, 112, 474, 58, 500, 36, 500, 36, 96, 46, 44, 64, 276, 500, 140, 182, 500, 500, 500, 118, 48, 56, 500, 56, 500, 50, 54, 500, 56, 500, 148, 66, 50, 134, 500, 500, 500, 32, 30, 500, 46, 180, 500, 44, 90, 44, 50, 148, 500, 166]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37626818029350845, "mean_inference_ms": 1.2011811990804826, "mean_action_processing_ms": 0.1395683272421802, "mean_env_wait_ms": 0.08289684420819925, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01698756217956543, "StateBufferConnector_ms": 0.0039975643157958984, "ViewRequirementAgentConnector_ms": 0.10559415817260742}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1404000, "num_agent_steps_trained": 1404000, "num_env_steps_sampled": 1404000, "num_env_steps_trained": 1404000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5520.3702267032395, "num_env_steps_trained_throughput_per_sec": 5520.3702267032395, "timesteps_total": 1404000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1404000, "timers": {"training_iteration_time_ms": 3170.319, "sample_time_ms": 2820.634, "load_time_ms": 17.202, "load_throughput": 1046413.412, "learn_time_ms": 320.451, "learn_throughput": 56170.918, "synch_weights_time_ms": 10.063}, "counters": {"num_env_steps_sampled": 1404000, "num_env_steps_trained": 1404000, "num_agent_steps_sampled": 1404000, "num_agent_steps_trained": 1404000}, "done": false, "episodes_total": 5393, "training_iteration": 78, "trial_id": "9f288_00015", "date": "2023-10-25_16-50-52", "timestamp": 1698249052, "time_this_iter_s": 3.2666451930999756, "time_total_s": 249.70204329490662, "pid": 4200, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 249.70204329490662, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 57.54, "ram_util_percent": 27.22}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.617444900424223e-25, "cur_lr": 0.0003, "total_loss": 7.029509329795838, "policy_loss": -0.056388963013887405, "vf_loss": 7.085950016975403, "vf_explained_var": -8.642673492431641e-07, "kl": 0.0004678389760130131, "entropy": 0.5164543524384498, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1570.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 1422000, "num_env_steps_trained": 1422000, "num_agent_steps_sampled": 1422000, "num_agent_steps_trained": 1422000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.26499999999984, "episode_len_mean": 243.02, "episode_media": {}, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.5, -50.00000000000044, 45.1, 44.7, -50.00000000000044, 44.5, -50.00000000000044, 35.30000000000004, 43.50000000000001, 45.1, 36.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 47.1, -50.00000000000044, 45.5, 32.100000000000016, -50.00000000000044, 45.7, 41.100000000000016, 45.7, 45.1, 35.30000000000004, -50.00000000000044, 33.500000000000036, -50.00000000000044, -50.00000000000044, 40.90000000000002, 44.10000000000001, 42.30000000000001, 24.499999999999908, 41.30000000000001, -50.00000000000044, 38.90000000000002, 45.1, 34.900000000000034, -50.00000000000044, 25.099999999999916, 42.70000000000001, 42.500000000000014, -50.00000000000044, 43.30000000000001, 24.299999999999905, 40.500000000000014, 25.699999999999925, -50.00000000000044, 45.3, 47.5, -50.00000000000044, -50.00000000000044, 46.9, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 12.499999999999737, 38.50000000000003, -50.00000000000044, 46.099999999999994, -50.00000000000044, 45.5, 45.9, -50.00000000000044, 45.3, 19.499999999999837, 43.900000000000006, -50.00000000000044, 27.49999999999995, -50.00000000000044, 32.90000000000003, 45.9, 39.70000000000002, -50.00000000000044, 11.099999999999717, 3.0999999999996035, 11.899999999999729, 46.5, 16.699999999999797, 37.70000000000003, 43.900000000000006, 44.10000000000001, 46.9, -50.00000000000044, -50.00000000000044, 38.90000000000002, -50.00000000000044, 46.5, 45.9, 40.30000000000002, 47.3, 35.30000000000004, 44.10000000000001, -50.00000000000044, 45.1, 29.299999999999976, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 56, 500, 50, 54, 500, 56, 500, 148, 66, 50, 134, 500, 500, 500, 32, 30, 500, 46, 180, 500, 44, 90, 44, 50, 148, 500, 166, 500, 500, 92, 60, 78, 256, 88, 500, 112, 50, 152, 500, 250, 74, 76, 500, 68, 258, 96, 244, 500, 48, 26, 500, 500, 32, 46, 500, 500, 500, 376, 116, 500, 40, 500, 46, 42, 500, 48, 306, 62, 500, 226, 500, 172, 42, 104, 500, 390, 470, 382, 36, 334, 124, 62, 60, 32, 500, 500, 112, 500, 36, 42, 98, 28, 148, 60, 500, 50, 208, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3763941783765719, "mean_inference_ms": 1.2024441549908405, "mean_action_processing_ms": 0.13970212701751455, "mean_env_wait_ms": 0.08272601764285711, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02596902847290039, "StateBufferConnector_ms": 0.007996559143066406, "ViewRequirementAgentConnector_ms": 0.11941742897033691}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.26499999999984, "episode_len_mean": 243.02, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.5, -50.00000000000044, 45.1, 44.7, -50.00000000000044, 44.5, -50.00000000000044, 35.30000000000004, 43.50000000000001, 45.1, 36.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 47.1, -50.00000000000044, 45.5, 32.100000000000016, -50.00000000000044, 45.7, 41.100000000000016, 45.7, 45.1, 35.30000000000004, -50.00000000000044, 33.500000000000036, -50.00000000000044, -50.00000000000044, 40.90000000000002, 44.10000000000001, 42.30000000000001, 24.499999999999908, 41.30000000000001, -50.00000000000044, 38.90000000000002, 45.1, 34.900000000000034, -50.00000000000044, 25.099999999999916, 42.70000000000001, 42.500000000000014, -50.00000000000044, 43.30000000000001, 24.299999999999905, 40.500000000000014, 25.699999999999925, -50.00000000000044, 45.3, 47.5, -50.00000000000044, -50.00000000000044, 46.9, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 12.499999999999737, 38.50000000000003, -50.00000000000044, 46.099999999999994, -50.00000000000044, 45.5, 45.9, -50.00000000000044, 45.3, 19.499999999999837, 43.900000000000006, -50.00000000000044, 27.49999999999995, -50.00000000000044, 32.90000000000003, 45.9, 39.70000000000002, -50.00000000000044, 11.099999999999717, 3.0999999999996035, 11.899999999999729, 46.5, 16.699999999999797, 37.70000000000003, 43.900000000000006, 44.10000000000001, 46.9, -50.00000000000044, -50.00000000000044, 38.90000000000002, -50.00000000000044, 46.5, 45.9, 40.30000000000002, 47.3, 35.30000000000004, 44.10000000000001, -50.00000000000044, 45.1, 29.299999999999976, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 56, 500, 50, 54, 500, 56, 500, 148, 66, 50, 134, 500, 500, 500, 32, 30, 500, 46, 180, 500, 44, 90, 44, 50, 148, 500, 166, 500, 500, 92, 60, 78, 256, 88, 500, 112, 50, 152, 500, 250, 74, 76, 500, 68, 258, 96, 244, 500, 48, 26, 500, 500, 32, 46, 500, 500, 500, 376, 116, 500, 40, 500, 46, 42, 500, 48, 306, 62, 500, 226, 500, 172, 42, 104, 500, 390, 470, 382, 36, 334, 124, 62, 60, 32, 500, 500, 112, 500, 36, 42, 98, 28, 148, 60, 500, 50, 208, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3763941783765719, "mean_inference_ms": 1.2024441549908405, "mean_action_processing_ms": 0.13970212701751455, "mean_env_wait_ms": 0.08272601764285711, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02596902847290039, "StateBufferConnector_ms": 0.007996559143066406, "ViewRequirementAgentConnector_ms": 0.11941742897033691}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1422000, "num_agent_steps_trained": 1422000, "num_env_steps_sampled": 1422000, "num_env_steps_trained": 1422000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5479.883038686004, "num_env_steps_trained_throughput_per_sec": 5479.883038686004, "timesteps_total": 1422000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1422000, "timers": {"training_iteration_time_ms": 3182.885, "sample_time_ms": 2833.832, "load_time_ms": 17.002, "load_throughput": 1058717.633, "learn_time_ms": 320.103, "learn_throughput": 56231.854, "synch_weights_time_ms": 9.978}, "counters": {"num_env_steps_sampled": 1422000, "num_env_steps_trained": 1422000, "num_agent_steps_sampled": 1422000, "num_agent_steps_trained": 1422000}, "done": false, "episodes_total": 5465, "training_iteration": 79, "trial_id": "9f288_00015", "date": "2023-10-25_16-50-55", "timestamp": 1698249055, "time_this_iter_s": 3.290374755859375, "time_total_s": 252.992418050766, "pid": 4200, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 252.992418050766, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 55.64, "ram_util_percent": 27.240000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.3087224502121113e-25, "cur_lr": 0.0003, "total_loss": 6.798088335990906, "policy_loss": -0.010577870160341262, "vf_loss": 6.808718585968018, "vf_explained_var": -1.3589859008789063e-06, "kl": 0.00041911689398261843, "entropy": 0.5245182022452355, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1590.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 1440000, "num_env_steps_trained": 1440000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.8139999999997922, "episode_len_mean": 292.48, "episode_media": {}, "episodes_this_iter": 55, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 12.499999999999737, 38.50000000000003, -50.00000000000044, 46.099999999999994, -50.00000000000044, 45.5, 45.9, -50.00000000000044, 45.3, 19.499999999999837, 43.900000000000006, -50.00000000000044, 27.49999999999995, -50.00000000000044, 32.90000000000003, 45.9, 39.70000000000002, -50.00000000000044, 11.099999999999717, 3.0999999999996035, 11.899999999999729, 46.5, 16.699999999999797, 37.70000000000003, 43.900000000000006, 44.10000000000001, 46.9, -50.00000000000044, -50.00000000000044, 38.90000000000002, -50.00000000000044, 46.5, 45.9, 40.30000000000002, 47.3, 35.30000000000004, 44.10000000000001, -50.00000000000044, 45.1, 29.299999999999976, -50.00000000000044, -50.00000000000044, 13.499999999999751, -50.00000000000044, 23.8999999999999, 40.70000000000002, 19.09999999999983, -50.00000000000044, -50.00000000000044, 46.099999999999994, 15.899999999999785, -50.00000000000044, 2.499999999999595, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, 37.10000000000003, -50.00000000000044, -50.00000000000044, 43.10000000000001, 38.700000000000024, -50.00000000000044, -50.00000000000044, 45.1, 42.500000000000014, 44.10000000000001, 35.500000000000036, 21.699999999999868, 46.699999999999996, 9.8999999999997, -50.00000000000044, 29.69999999999998, 9.499999999999694, 40.90000000000002, -50.00000000000044, 33.500000000000036, 12.099999999999731, -50.00000000000044, 4.499999999999623, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 45.3, -50.00000000000044, -50.00000000000044, 45.3, 39.90000000000002, 28.499999999999964, -50.00000000000044, 46.699999999999996, 14.699999999999768, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 500, 376, 116, 500, 40, 500, 46, 42, 500, 48, 306, 62, 500, 226, 500, 172, 42, 104, 500, 390, 470, 382, 36, 334, 124, 62, 60, 32, 500, 500, 112, 500, 36, 42, 98, 28, 148, 60, 500, 50, 208, 500, 500, 366, 500, 262, 94, 310, 500, 500, 40, 342, 500, 476, 500, 72, 500, 500, 500, 110, 130, 500, 500, 70, 114, 500, 500, 50, 76, 60, 146, 284, 34, 402, 500, 204, 406, 92, 500, 166, 380, 500, 456, 500, 500, 500, 52, 48, 500, 500, 48, 102, 216, 500, 34, 354, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37652614563775827, "mean_inference_ms": 1.2019642750251405, "mean_action_processing_ms": 0.13955969515656208, "mean_env_wait_ms": 0.08285961542466336, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023003816604614258, "StateBufferConnector_ms": 0.009999513626098633, "ViewRequirementAgentConnector_ms": 0.12680625915527344}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.8139999999997922, "episode_len_mean": 292.48, "episodes_this_iter": 55, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 12.499999999999737, 38.50000000000003, -50.00000000000044, 46.099999999999994, -50.00000000000044, 45.5, 45.9, -50.00000000000044, 45.3, 19.499999999999837, 43.900000000000006, -50.00000000000044, 27.49999999999995, -50.00000000000044, 32.90000000000003, 45.9, 39.70000000000002, -50.00000000000044, 11.099999999999717, 3.0999999999996035, 11.899999999999729, 46.5, 16.699999999999797, 37.70000000000003, 43.900000000000006, 44.10000000000001, 46.9, -50.00000000000044, -50.00000000000044, 38.90000000000002, -50.00000000000044, 46.5, 45.9, 40.30000000000002, 47.3, 35.30000000000004, 44.10000000000001, -50.00000000000044, 45.1, 29.299999999999976, -50.00000000000044, -50.00000000000044, 13.499999999999751, -50.00000000000044, 23.8999999999999, 40.70000000000002, 19.09999999999983, -50.00000000000044, -50.00000000000044, 46.099999999999994, 15.899999999999785, -50.00000000000044, 2.499999999999595, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, 37.10000000000003, -50.00000000000044, -50.00000000000044, 43.10000000000001, 38.700000000000024, -50.00000000000044, -50.00000000000044, 45.1, 42.500000000000014, 44.10000000000001, 35.500000000000036, 21.699999999999868, 46.699999999999996, 9.8999999999997, -50.00000000000044, 29.69999999999998, 9.499999999999694, 40.90000000000002, -50.00000000000044, 33.500000000000036, 12.099999999999731, -50.00000000000044, 4.499999999999623, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 45.3, -50.00000000000044, -50.00000000000044, 45.3, 39.90000000000002, 28.499999999999964, -50.00000000000044, 46.699999999999996, 14.699999999999768, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 500, 376, 116, 500, 40, 500, 46, 42, 500, 48, 306, 62, 500, 226, 500, 172, 42, 104, 500, 390, 470, 382, 36, 334, 124, 62, 60, 32, 500, 500, 112, 500, 36, 42, 98, 28, 148, 60, 500, 50, 208, 500, 500, 366, 500, 262, 94, 310, 500, 500, 40, 342, 500, 476, 500, 72, 500, 500, 500, 110, 130, 500, 500, 70, 114, 500, 500, 50, 76, 60, 146, 284, 34, 402, 500, 204, 406, 92, 500, 166, 380, 500, 456, 500, 500, 500, 52, 48, 500, 500, 48, 102, 216, 500, 34, 354, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37652614563775827, "mean_inference_ms": 1.2019642750251405, "mean_action_processing_ms": 0.13955969515656208, "mean_env_wait_ms": 0.08285961542466336, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023003816604614258, "StateBufferConnector_ms": 0.009999513626098633, "ViewRequirementAgentConnector_ms": 0.12680625915527344}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000, "num_env_steps_sampled": 1440000, "num_env_steps_trained": 1440000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5718.279490079021, "num_env_steps_trained_throughput_per_sec": 5718.279490079021, "timesteps_total": 1440000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1440000, "timers": {"training_iteration_time_ms": 3185.042, "sample_time_ms": 2834.835, "load_time_ms": 16.641, "load_throughput": 1081673.713, "learn_time_ms": 321.958, "learn_throughput": 55907.96, "synch_weights_time_ms": 9.66}, "counters": {"num_env_steps_sampled": 1440000, "num_env_steps_trained": 1440000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "done": false, "episodes_total": 5520, "training_iteration": 80, "trial_id": "9f288_00015", "date": "2023-10-25_16-50-59", "timestamp": 1698249059, "time_this_iter_s": 3.1537508964538574, "time_total_s": 256.14616894721985, "pid": 4200, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 256.14616894721985, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 65.825, "ram_util_percent": 27.224999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.6543612251060557e-25, "cur_lr": 0.0003, "total_loss": 6.913261532783508, "policy_loss": -0.03876994028687477, "vf_loss": 6.9520854473114015, "vf_explained_var": -1.5795230865478516e-06, "kl": 0.0005101011320050475, "entropy": 0.5382827311754227, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1610.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 1458000, "num_env_steps_trained": 1458000, "num_agent_steps_sampled": 1458000, "num_agent_steps_trained": 1458000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.237999999999805, "episode_len_mean": 278.24, "episode_media": {}, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.1, 42.500000000000014, 44.10000000000001, 35.500000000000036, 21.699999999999868, 46.699999999999996, 9.8999999999997, -50.00000000000044, 29.69999999999998, 9.499999999999694, 40.90000000000002, -50.00000000000044, 33.500000000000036, 12.099999999999731, -50.00000000000044, 4.499999999999623, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 45.3, -50.00000000000044, -50.00000000000044, 45.3, 39.90000000000002, 28.499999999999964, -50.00000000000044, 46.699999999999996, 14.699999999999768, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 43.30000000000001, -50.00000000000044, 44.5, -50.00000000000044, 37.300000000000026, -50.00000000000044, 28.499999999999964, -50.00000000000044, -50.00000000000044, 28.29999999999996, 21.299999999999862, 32.30000000000002, 41.90000000000001, 44.5, -50.00000000000044, 22.099999999999874, 41.90000000000001, 46.099999999999994, -50.00000000000044, 3.0999999999996035, -50.00000000000044, 37.70000000000003, -50.00000000000044, 47.1, 21.09999999999986, 33.90000000000004, 10.099999999999703, -50.00000000000044, 44.900000000000006, 5.499999999999638, -50.00000000000044, -50.00000000000044, 39.70000000000002, 46.699999999999996, 45.7, 44.900000000000006, -50.00000000000044, 45.9, 40.30000000000002, 36.70000000000003, -50.00000000000044, 44.7, 46.699999999999996, -50.00000000000044, -50.00000000000044, 41.30000000000001, 44.900000000000006, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 41.30000000000001, 46.099999999999994, 46.3, 46.5, 35.10000000000004, -50.00000000000044, 43.30000000000001, 38.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [50, 76, 60, 146, 284, 34, 402, 500, 204, 406, 92, 500, 166, 380, 500, 456, 500, 500, 500, 52, 48, 500, 500, 48, 102, 216, 500, 34, 354, 500, 500, 500, 100, 500, 500, 64, 500, 68, 500, 56, 500, 128, 500, 216, 500, 500, 218, 288, 178, 82, 56, 500, 280, 82, 40, 500, 470, 500, 124, 500, 30, 290, 162, 400, 500, 52, 446, 500, 500, 104, 34, 44, 52, 500, 42, 98, 134, 500, 54, 34, 500, 500, 88, 52, 64, 500, 500, 500, 48, 88, 40, 38, 36, 150, 500, 68, 116, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3764163252699888, "mean_inference_ms": 1.2015700334507242, "mean_action_processing_ms": 0.1393907623839303, "mean_env_wait_ms": 0.08270041313036978, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02200031280517578, "StateBufferConnector_ms": 0.008003473281860352, "ViewRequirementAgentConnector_ms": 0.11051678657531738}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.237999999999805, "episode_len_mean": 278.24, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.1, 42.500000000000014, 44.10000000000001, 35.500000000000036, 21.699999999999868, 46.699999999999996, 9.8999999999997, -50.00000000000044, 29.69999999999998, 9.499999999999694, 40.90000000000002, -50.00000000000044, 33.500000000000036, 12.099999999999731, -50.00000000000044, 4.499999999999623, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 45.3, -50.00000000000044, -50.00000000000044, 45.3, 39.90000000000002, 28.499999999999964, -50.00000000000044, 46.699999999999996, 14.699999999999768, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 43.30000000000001, -50.00000000000044, 44.5, -50.00000000000044, 37.300000000000026, -50.00000000000044, 28.499999999999964, -50.00000000000044, -50.00000000000044, 28.29999999999996, 21.299999999999862, 32.30000000000002, 41.90000000000001, 44.5, -50.00000000000044, 22.099999999999874, 41.90000000000001, 46.099999999999994, -50.00000000000044, 3.0999999999996035, -50.00000000000044, 37.70000000000003, -50.00000000000044, 47.1, 21.09999999999986, 33.90000000000004, 10.099999999999703, -50.00000000000044, 44.900000000000006, 5.499999999999638, -50.00000000000044, -50.00000000000044, 39.70000000000002, 46.699999999999996, 45.7, 44.900000000000006, -50.00000000000044, 45.9, 40.30000000000002, 36.70000000000003, -50.00000000000044, 44.7, 46.699999999999996, -50.00000000000044, -50.00000000000044, 41.30000000000001, 44.900000000000006, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 41.30000000000001, 46.099999999999994, 46.3, 46.5, 35.10000000000004, -50.00000000000044, 43.30000000000001, 38.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [50, 76, 60, 146, 284, 34, 402, 500, 204, 406, 92, 500, 166, 380, 500, 456, 500, 500, 500, 52, 48, 500, 500, 48, 102, 216, 500, 34, 354, 500, 500, 500, 100, 500, 500, 64, 500, 68, 500, 56, 500, 128, 500, 216, 500, 500, 218, 288, 178, 82, 56, 500, 280, 82, 40, 500, 470, 500, 124, 500, 30, 290, 162, 400, 500, 52, 446, 500, 500, 104, 34, 44, 52, 500, 42, 98, 134, 500, 54, 34, 500, 500, 88, 52, 64, 500, 500, 500, 48, 88, 40, 38, 36, 150, 500, 68, 116, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3764163252699888, "mean_inference_ms": 1.2015700334507242, "mean_action_processing_ms": 0.1393907623839303, "mean_env_wait_ms": 0.08270041313036978, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02200031280517578, "StateBufferConnector_ms": 0.008003473281860352, "ViewRequirementAgentConnector_ms": 0.11051678657531738}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1458000, "num_agent_steps_trained": 1458000, "num_env_steps_sampled": 1458000, "num_env_steps_trained": 1458000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5532.216052068176, "num_env_steps_trained_throughput_per_sec": 5532.216052068176, "timesteps_total": 1458000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1458000, "timers": {"training_iteration_time_ms": 3190.033, "sample_time_ms": 2838.926, "load_time_ms": 17.23, "load_throughput": 1044674.431, "learn_time_ms": 322.19, "learn_throughput": 55867.615, "synch_weights_time_ms": 9.638}, "counters": {"num_env_steps_sampled": 1458000, "num_env_steps_trained": 1458000, "num_agent_steps_sampled": 1458000, "num_agent_steps_trained": 1458000}, "done": false, "episodes_total": 5589, "training_iteration": 81, "trial_id": "9f288_00015", "date": "2023-10-25_16-51-02", "timestamp": 1698249062, "time_this_iter_s": 3.258669376373291, "time_total_s": 259.40483832359314, "pid": 4200, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 259.40483832359314, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 53.58, "ram_util_percent": 27.240000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.271806125530278e-26, "cur_lr": 0.0003, "total_loss": 6.452343320846557, "policy_loss": 0.00795058999210596, "vf_loss": 6.444442319869995, "vf_explained_var": -1.0192394256591798e-06, "kl": 0.0007250698332200046, "entropy": 0.4969261854887009, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1630.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 1476000, "num_env_steps_trained": 1476000, "num_agent_steps_sampled": 1476000, "num_agent_steps_trained": 1476000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.866999999999816, "episode_len_mean": 256.94, "episode_media": {}, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.499999999999638, -50.00000000000044, -50.00000000000044, 39.70000000000002, 46.699999999999996, 45.7, 44.900000000000006, -50.00000000000044, 45.9, 40.30000000000002, 36.70000000000003, -50.00000000000044, 44.7, 46.699999999999996, -50.00000000000044, -50.00000000000044, 41.30000000000001, 44.900000000000006, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 41.30000000000001, 46.099999999999994, 46.3, 46.5, 35.10000000000004, -50.00000000000044, 43.30000000000001, 38.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 40.10000000000002, 40.70000000000002, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 43.30000000000001, -50.00000000000044, 43.30000000000001, 36.10000000000004, 22.299999999999876, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 25.29999999999992, 36.70000000000003, 43.30000000000001, -50.00000000000044, 43.10000000000001, -50.00000000000044, 44.10000000000001, -50.00000000000044, 46.3, 24.299999999999905, 45.5, -50.00000000000044, 7.899999999999672, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 9.099999999999689, -50.00000000000044, -50.00000000000044, 42.900000000000006, 41.30000000000001, 45.1, -50.00000000000044, 44.7, 45.1, 44.5, 45.9, 43.900000000000006, 46.099999999999994, -50.00000000000044, -50.00000000000044, 46.5, 11.699999999999726, 47.1, 44.7, 43.30000000000001, -50.00000000000044, 40.30000000000002, 46.099999999999994, 30.099999999999987, 45.9, 42.30000000000001, -50.00000000000044, -50.00000000000044], "episode_lengths": [446, 500, 500, 104, 34, 44, 52, 500, 42, 98, 134, 500, 54, 34, 500, 500, 88, 52, 64, 500, 500, 500, 48, 88, 40, 38, 36, 150, 500, 68, 116, 500, 500, 500, 500, 48, 100, 94, 50, 500, 500, 500, 500, 500, 500, 88, 68, 500, 68, 140, 278, 500, 500, 70, 500, 248, 134, 68, 500, 70, 500, 60, 500, 38, 258, 46, 500, 422, 500, 500, 500, 62, 410, 500, 500, 72, 88, 50, 500, 54, 50, 56, 42, 62, 40, 500, 500, 36, 384, 30, 54, 68, 500, 98, 40, 200, 42, 78, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3764277990410928, "mean_inference_ms": 1.2022679565672343, "mean_action_processing_ms": 0.13959249719825018, "mean_env_wait_ms": 0.08263950817361305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027001380920410156, "StateBufferConnector_ms": 0.006001949310302734, "ViewRequirementAgentConnector_ms": 0.11701130867004395}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.866999999999816, "episode_len_mean": 256.94, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [5.499999999999638, -50.00000000000044, -50.00000000000044, 39.70000000000002, 46.699999999999996, 45.7, 44.900000000000006, -50.00000000000044, 45.9, 40.30000000000002, 36.70000000000003, -50.00000000000044, 44.7, 46.699999999999996, -50.00000000000044, -50.00000000000044, 41.30000000000001, 44.900000000000006, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 41.30000000000001, 46.099999999999994, 46.3, 46.5, 35.10000000000004, -50.00000000000044, 43.30000000000001, 38.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 40.10000000000002, 40.70000000000002, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 43.30000000000001, -50.00000000000044, 43.30000000000001, 36.10000000000004, 22.299999999999876, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 25.29999999999992, 36.70000000000003, 43.30000000000001, -50.00000000000044, 43.10000000000001, -50.00000000000044, 44.10000000000001, -50.00000000000044, 46.3, 24.299999999999905, 45.5, -50.00000000000044, 7.899999999999672, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 9.099999999999689, -50.00000000000044, -50.00000000000044, 42.900000000000006, 41.30000000000001, 45.1, -50.00000000000044, 44.7, 45.1, 44.5, 45.9, 43.900000000000006, 46.099999999999994, -50.00000000000044, -50.00000000000044, 46.5, 11.699999999999726, 47.1, 44.7, 43.30000000000001, -50.00000000000044, 40.30000000000002, 46.099999999999994, 30.099999999999987, 45.9, 42.30000000000001, -50.00000000000044, -50.00000000000044], "episode_lengths": [446, 500, 500, 104, 34, 44, 52, 500, 42, 98, 134, 500, 54, 34, 500, 500, 88, 52, 64, 500, 500, 500, 48, 88, 40, 38, 36, 150, 500, 68, 116, 500, 500, 500, 500, 48, 100, 94, 50, 500, 500, 500, 500, 500, 500, 88, 68, 500, 68, 140, 278, 500, 500, 70, 500, 248, 134, 68, 500, 70, 500, 60, 500, 38, 258, 46, 500, 422, 500, 500, 500, 62, 410, 500, 500, 72, 88, 50, 500, 54, 50, 56, 42, 62, 40, 500, 500, 36, 384, 30, 54, 68, 500, 98, 40, 200, 42, 78, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3764277990410928, "mean_inference_ms": 1.2022679565672343, "mean_action_processing_ms": 0.13959249719825018, "mean_env_wait_ms": 0.08263950817361305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027001380920410156, "StateBufferConnector_ms": 0.006001949310302734, "ViewRequirementAgentConnector_ms": 0.11701130867004395}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1476000, "num_agent_steps_trained": 1476000, "num_env_steps_sampled": 1476000, "num_env_steps_trained": 1476000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5772.436510820699, "num_env_steps_trained_throughput_per_sec": 5772.436510820699, "timesteps_total": 1476000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1476000, "timers": {"training_iteration_time_ms": 3183.264, "sample_time_ms": 2838.756, "load_time_ms": 17.103, "load_throughput": 1052430.527, "learn_time_ms": 315.759, "learn_throughput": 57005.477, "synch_weights_time_ms": 9.598}, "counters": {"num_env_steps_sampled": 1476000, "num_env_steps_trained": 1476000, "num_agent_steps_sampled": 1476000, "num_agent_steps_trained": 1476000}, "done": false, "episodes_total": 5655, "training_iteration": 82, "trial_id": "9f288_00015", "date": "2023-10-25_16-51-05", "timestamp": 1698249065, "time_this_iter_s": 3.1232635974884033, "time_total_s": 262.52810192108154, "pid": 4200, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 262.52810192108154, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 65.30000000000001, "ram_util_percent": 27.224999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.135903062765139e-26, "cur_lr": 0.0003, "total_loss": 7.104804110527039, "policy_loss": -0.058792071603238585, "vf_loss": 7.163645839691162, "vf_explained_var": -6.735324859619141e-07, "kl": 0.0004260266544520164, "entropy": 0.49562455862760546, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1650.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 1494000, "num_env_steps_trained": 1494000, "num_agent_steps_sampled": 1494000, "num_agent_steps_trained": 1494000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.566999999999835, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.099999999999689, -50.00000000000044, -50.00000000000044, 42.900000000000006, 41.30000000000001, 45.1, -50.00000000000044, 44.7, 45.1, 44.5, 45.9, 43.900000000000006, 46.099999999999994, -50.00000000000044, -50.00000000000044, 46.5, 11.699999999999726, 47.1, 44.7, 43.30000000000001, -50.00000000000044, 40.30000000000002, 46.099999999999994, 30.099999999999987, 45.9, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.299999999999777, 41.500000000000014, 40.30000000000002, -50.00000000000044, 24.69999999999991, 17.099999999999802, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 29.49999999999998, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 10.299999999999706, -50.00000000000044, 31.70000000000001, 42.10000000000001, 31.300000000000004, 38.300000000000026, -50.00000000000044, 24.69999999999991, 43.7, -50.00000000000044, -50.00000000000044, 45.7, 38.300000000000026, 9.8999999999997, 45.3, 32.50000000000002, 35.30000000000004, -50.00000000000044, 23.29999999999989, 46.5, -50.00000000000044, -50.00000000000044, 36.70000000000003, 32.700000000000024, 40.30000000000002, 40.500000000000014, 46.5, -50.00000000000044, 39.90000000000002, 42.70000000000001, 44.300000000000004, 21.09999999999986, 43.30000000000001, 44.7, 41.90000000000001, 45.1, -50.00000000000044, 20.299999999999848, -50.00000000000044, 41.30000000000001, 44.7, 29.899999999999984, -50.00000000000044, 43.900000000000006, -50.00000000000044, 39.90000000000002, 35.500000000000036, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 43.900000000000006], "episode_lengths": [410, 500, 500, 72, 88, 50, 500, 54, 50, 56, 42, 62, 40, 500, 500, 36, 384, 30, 54, 68, 500, 98, 40, 200, 42, 78, 500, 500, 500, 348, 86, 98, 500, 254, 330, 500, 500, 500, 64, 206, 500, 80, 500, 500, 500, 56, 398, 500, 184, 80, 188, 118, 500, 254, 64, 500, 500, 44, 118, 402, 48, 176, 148, 500, 268, 36, 500, 500, 134, 174, 98, 96, 36, 500, 102, 74, 58, 290, 68, 54, 82, 50, 500, 298, 500, 88, 54, 202, 500, 62, 500, 102, 146, 124, 500, 500, 500, 500, 44, 62]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3763580820858338, "mean_inference_ms": 1.202476184121014, "mean_action_processing_ms": 0.13941677145579173, "mean_env_wait_ms": 0.08267722049092228, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.034002065658569336, "StateBufferConnector_ms": 0.007001161575317383, "ViewRequirementAgentConnector_ms": 0.12299561500549316}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.566999999999835, "episode_len_mean": 250.0, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.099999999999689, -50.00000000000044, -50.00000000000044, 42.900000000000006, 41.30000000000001, 45.1, -50.00000000000044, 44.7, 45.1, 44.5, 45.9, 43.900000000000006, 46.099999999999994, -50.00000000000044, -50.00000000000044, 46.5, 11.699999999999726, 47.1, 44.7, 43.30000000000001, -50.00000000000044, 40.30000000000002, 46.099999999999994, 30.099999999999987, 45.9, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.299999999999777, 41.500000000000014, 40.30000000000002, -50.00000000000044, 24.69999999999991, 17.099999999999802, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 29.49999999999998, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 10.299999999999706, -50.00000000000044, 31.70000000000001, 42.10000000000001, 31.300000000000004, 38.300000000000026, -50.00000000000044, 24.69999999999991, 43.7, -50.00000000000044, -50.00000000000044, 45.7, 38.300000000000026, 9.8999999999997, 45.3, 32.50000000000002, 35.30000000000004, -50.00000000000044, 23.29999999999989, 46.5, -50.00000000000044, -50.00000000000044, 36.70000000000003, 32.700000000000024, 40.30000000000002, 40.500000000000014, 46.5, -50.00000000000044, 39.90000000000002, 42.70000000000001, 44.300000000000004, 21.09999999999986, 43.30000000000001, 44.7, 41.90000000000001, 45.1, -50.00000000000044, 20.299999999999848, -50.00000000000044, 41.30000000000001, 44.7, 29.899999999999984, -50.00000000000044, 43.900000000000006, -50.00000000000044, 39.90000000000002, 35.500000000000036, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 43.900000000000006], "episode_lengths": [410, 500, 500, 72, 88, 50, 500, 54, 50, 56, 42, 62, 40, 500, 500, 36, 384, 30, 54, 68, 500, 98, 40, 200, 42, 78, 500, 500, 500, 348, 86, 98, 500, 254, 330, 500, 500, 500, 64, 206, 500, 80, 500, 500, 500, 56, 398, 500, 184, 80, 188, 118, 500, 254, 64, 500, 500, 44, 118, 402, 48, 176, 148, 500, 268, 36, 500, 500, 134, 174, 98, 96, 36, 500, 102, 74, 58, 290, 68, 54, 82, 50, 500, 298, 500, 88, 54, 202, 500, 62, 500, 102, 146, 124, 500, 500, 500, 500, 44, 62]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3763580820858338, "mean_inference_ms": 1.202476184121014, "mean_action_processing_ms": 0.13941677145579173, "mean_env_wait_ms": 0.08267722049092228, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.034002065658569336, "StateBufferConnector_ms": 0.007001161575317383, "ViewRequirementAgentConnector_ms": 0.12299561500549316}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1494000, "num_agent_steps_trained": 1494000, "num_env_steps_sampled": 1494000, "num_env_steps_trained": 1494000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5666.6838048935215, "num_env_steps_trained_throughput_per_sec": 5666.6838048935215, "timesteps_total": 1494000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1494000, "timers": {"training_iteration_time_ms": 3179.939, "sample_time_ms": 2829.382, "load_time_ms": 18.238, "load_throughput": 986941.503, "learn_time_ms": 320.935, "learn_throughput": 56086.063, "synch_weights_time_ms": 9.375}, "counters": {"num_env_steps_sampled": 1494000, "num_env_steps_trained": 1494000, "num_agent_steps_sampled": 1494000, "num_agent_steps_trained": 1494000}, "done": false, "episodes_total": 5727, "training_iteration": 83, "trial_id": "9f288_00015", "date": "2023-10-25_16-51-08", "timestamp": 1698249068, "time_this_iter_s": 3.1814560890197754, "time_total_s": 265.7095580101013, "pid": 4200, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 265.7095580101013, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 59.55, "ram_util_percent": 27.225}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.0679515313825696e-26, "cur_lr": 0.0003, "total_loss": 6.005209469795227, "policy_loss": -0.024996770173311235, "vf_loss": 6.03025963306427, "vf_explained_var": -9.000301361083984e-07, "kl": 0.0007348155642716847, "entropy": 0.5324687615036965, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1670.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 1512000, "num_env_steps_trained": 1512000, "num_agent_steps_sampled": 1512000, "num_agent_steps_trained": 1512000}, "sampler_results": {"episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.4529999999998116, "episode_len_mean": 271.06, "episode_media": {}, "episodes_this_iter": 55, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 45.7, 38.300000000000026, 9.8999999999997, 45.3, 32.50000000000002, 35.30000000000004, -50.00000000000044, 23.29999999999989, 46.5, -50.00000000000044, -50.00000000000044, 36.70000000000003, 32.700000000000024, 40.30000000000002, 40.500000000000014, 46.5, -50.00000000000044, 39.90000000000002, 42.70000000000001, 44.300000000000004, 21.09999999999986, 43.30000000000001, 44.7, 41.90000000000001, 45.1, -50.00000000000044, 20.299999999999848, -50.00000000000044, 41.30000000000001, 44.7, 29.899999999999984, -50.00000000000044, 43.900000000000006, -50.00000000000044, 39.90000000000002, 35.500000000000036, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 43.900000000000006, -50.00000000000044, 44.300000000000004, 42.70000000000001, 32.700000000000024, -50.00000000000044, -50.00000000000044, 39.10000000000002, -50.00000000000044, -50.00000000000044, 46.3, 45.7, -50.00000000000044, 42.900000000000006, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.89999999999994, -50.00000000000044, -50.00000000000044, 45.3, 45.1, 43.50000000000001, 45.9, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 30.29999999999999, -50.00000000000044, 37.300000000000026, 45.3, -50.00000000000044, 34.30000000000004, -50.00000000000044, 38.10000000000002, 45.7, -50.00000000000044, 39.50000000000002, 21.699999999999868, 46.3, -50.00000000000044, 42.900000000000006, 44.7, 7.299999999999663, -50.00000000000044, 45.7, -50.00000000000044], "episode_lengths": [500, 500, 44, 118, 402, 48, 176, 148, 500, 268, 36, 500, 500, 134, 174, 98, 96, 36, 500, 102, 74, 58, 290, 68, 54, 82, 50, 500, 298, 500, 88, 54, 202, 500, 62, 500, 102, 146, 124, 500, 500, 500, 500, 44, 62, 500, 58, 74, 174, 500, 500, 110, 500, 500, 38, 44, 500, 72, 44, 500, 500, 500, 232, 500, 500, 48, 50, 66, 42, 500, 48, 500, 500, 500, 500, 500, 500, 500, 500, 46, 198, 500, 128, 48, 500, 158, 500, 120, 44, 500, 106, 284, 38, 500, 72, 54, 428, 500, 44, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3765677872500101, "mean_inference_ms": 1.2024243765780607, "mean_action_processing_ms": 0.13943245039717597, "mean_env_wait_ms": 0.08263927247795726, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02199721336364746, "StateBufferConnector_ms": 0.006002187728881836, "ViewRequirementAgentConnector_ms": 0.10499906539916992}}, "episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.4529999999998116, "episode_len_mean": 271.06, "episodes_this_iter": 55, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 45.7, 38.300000000000026, 9.8999999999997, 45.3, 32.50000000000002, 35.30000000000004, -50.00000000000044, 23.29999999999989, 46.5, -50.00000000000044, -50.00000000000044, 36.70000000000003, 32.700000000000024, 40.30000000000002, 40.500000000000014, 46.5, -50.00000000000044, 39.90000000000002, 42.70000000000001, 44.300000000000004, 21.09999999999986, 43.30000000000001, 44.7, 41.90000000000001, 45.1, -50.00000000000044, 20.299999999999848, -50.00000000000044, 41.30000000000001, 44.7, 29.899999999999984, -50.00000000000044, 43.900000000000006, -50.00000000000044, 39.90000000000002, 35.500000000000036, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 43.900000000000006, -50.00000000000044, 44.300000000000004, 42.70000000000001, 32.700000000000024, -50.00000000000044, -50.00000000000044, 39.10000000000002, -50.00000000000044, -50.00000000000044, 46.3, 45.7, -50.00000000000044, 42.900000000000006, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.89999999999994, -50.00000000000044, -50.00000000000044, 45.3, 45.1, 43.50000000000001, 45.9, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 30.29999999999999, -50.00000000000044, 37.300000000000026, 45.3, -50.00000000000044, 34.30000000000004, -50.00000000000044, 38.10000000000002, 45.7, -50.00000000000044, 39.50000000000002, 21.699999999999868, 46.3, -50.00000000000044, 42.900000000000006, 44.7, 7.299999999999663, -50.00000000000044, 45.7, -50.00000000000044], "episode_lengths": [500, 500, 44, 118, 402, 48, 176, 148, 500, 268, 36, 500, 500, 134, 174, 98, 96, 36, 500, 102, 74, 58, 290, 68, 54, 82, 50, 500, 298, 500, 88, 54, 202, 500, 62, 500, 102, 146, 124, 500, 500, 500, 500, 44, 62, 500, 58, 74, 174, 500, 500, 110, 500, 500, 38, 44, 500, 72, 44, 500, 500, 500, 232, 500, 500, 48, 50, 66, 42, 500, 48, 500, 500, 500, 500, 500, 500, 500, 500, 46, 198, 500, 128, 48, 500, 158, 500, 120, 44, 500, 106, 284, 38, 500, 72, 54, 428, 500, 44, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3765677872500101, "mean_inference_ms": 1.2024243765780607, "mean_action_processing_ms": 0.13943245039717597, "mean_env_wait_ms": 0.08263927247795726, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02199721336364746, "StateBufferConnector_ms": 0.006002187728881836, "ViewRequirementAgentConnector_ms": 0.10499906539916992}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1512000, "num_agent_steps_trained": 1512000, "num_env_steps_sampled": 1512000, "num_env_steps_trained": 1512000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5589.871672239819, "num_env_steps_trained_throughput_per_sec": 5589.871672239819, "timesteps_total": 1512000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1512000, "timers": {"training_iteration_time_ms": 3188.457, "sample_time_ms": 2830.115, "load_time_ms": 17.924, "load_throughput": 1004254.884, "learn_time_ms": 329.02, "learn_throughput": 54707.944, "synch_weights_time_ms": 9.293}, "counters": {"num_env_steps_sampled": 1512000, "num_env_steps_trained": 1512000, "num_agent_steps_sampled": 1512000, "num_agent_steps_trained": 1512000}, "done": true, "episodes_total": 5782, "training_iteration": 84, "trial_id": "9f288_00015", "date": "2023-10-25_16-51-12", "timestamp": 1698249072, "time_this_iter_s": 3.225102424621582, "time_total_s": 268.9346604347229, "pid": 4200, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 268.9346604347229, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 58.14000000000001, "ram_util_percent": 27.26}}
