{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000007, "cur_lr": 0.0003, "total_loss": 9.22411855061849, "policy_loss": -0.0018647841061465442, "vf_loss": 9.225460052490234, "vf_explained_var": 0.00018558899561564127, "kl": 0.0029809435876811657, "entropy": 0.7286580701669058, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 15.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "sampler_results": {"episode_reward_max": 41.90000000000001, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -30.33461538461574, "episode_len_mean": 438.2307692307692, "episode_media": {}, "episodes_this_iter": 26, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 18.899999999999828, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 4.099999999999618, -50.00000000000044, 20.299999999999848, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.49999999999995, 26.89999999999994, -50.00000000000044, -50.00000000000044, 21.699999999999868, 41.90000000000001, -50.00000000000044], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 312, 500, 500, 500, 500, 460, 500, 298, 500, 500, 500, 226, 232, 500, 500, 284, 82, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36661736486803276, "mean_inference_ms": 1.1987268242234685, "mean_action_processing_ms": 0.14652867288984492, "mean_env_wait_ms": 0.07912474683343719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.042330301724947415, "StateBufferConnector_ms": 0.007780698629525991, "ViewRequirementAgentConnector_ms": 0.11064639458289513}}, "episode_reward_max": 41.90000000000001, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -30.33461538461574, "episode_len_mean": 438.2307692307692, "episodes_this_iter": 26, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 18.899999999999828, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 4.099999999999618, -50.00000000000044, 20.299999999999848, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.49999999999995, 26.89999999999994, -50.00000000000044, -50.00000000000044, 21.699999999999868, 41.90000000000001, -50.00000000000044], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 312, 500, 500, 500, 500, 460, 500, 298, 500, 500, 500, 226, 232, 500, 500, 284, 82, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36661736486803276, "mean_inference_ms": 1.1987268242234685, "mean_action_processing_ms": 0.14652867288984492, "mean_env_wait_ms": 0.07912474683343719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.042330301724947415, "StateBufferConnector_ms": 0.007780698629525991, "ViewRequirementAgentConnector_ms": 0.11064639458289513}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5703.942118839153, "num_env_steps_trained_throughput_per_sec": 5703.942118839153, "timesteps_total": 12000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 2103.808, "sample_time_ms": 1888.058, "load_time_ms": 7.009, "load_throughput": 1712193.768, "learn_time_ms": 196.097, "learn_throughput": 61194.311, "synch_weights_time_ms": 10.639}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "episodes_total": 26, "training_iteration": 1, "trial_id": "9f288_00017", "date": "2023-10-25_16-56-32", "timestamp": 1698249392, "time_this_iter_s": 2.1088032722473145, "time_total_s": 2.1088032722473145, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 2.1088032722473145, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 59.5, "ram_util_percent": 26.933333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000003, "cur_lr": 0.0003, "total_loss": 8.841276868184407, "policy_loss": -0.0018126030452549457, "vf_loss": 8.842828941345214, "vf_explained_var": -7.309913635253907e-05, "kl": 0.003330215894519976, "entropy": 0.7241603235403696, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 45.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "sampler_results": {"episode_reward_max": 41.90000000000001, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -22.630188679245617, "episode_len_mean": 415.35849056603774, "episode_media": {}, "episodes_this_iter": 27, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 18.899999999999828, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 4.099999999999618, -50.00000000000044, 20.299999999999848, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.49999999999995, 26.89999999999994, -50.00000000000044, -50.00000000000044, 21.699999999999868, 41.90000000000001, -50.00000000000044, 35.30000000000004, -50.00000000000044, 19.299999999999834, 41.90000000000001, 21.89999999999987, 41.500000000000014, -50.00000000000044, -50.00000000000044, 0.09999999999956088, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.69999999999984, 32.50000000000002, -50.00000000000044, 13.099999999999746, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 4.299999999999621, -50.00000000000044, 5.899999999999643, 34.30000000000004, -50.00000000000044, 19.499999999999837], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 312, 500, 500, 500, 500, 460, 500, 298, 500, 500, 500, 226, 232, 500, 500, 284, 82, 500, 148, 500, 308, 82, 282, 86, 500, 500, 500, 500, 500, 500, 500, 304, 176, 500, 370, 500, 500, 500, 500, 458, 500, 442, 158, 500, 306]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3676326469093092, "mean_inference_ms": 1.2011703537446483, "mean_action_processing_ms": 0.1451802736599412, "mean_env_wait_ms": 0.08087033589542574, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028337622588535526, "StateBufferConnector_ms": 0.00759160743569428, "ViewRequirementAgentConnector_ms": 0.13049908404080374}}, "episode_reward_max": 41.90000000000001, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -22.630188679245617, "episode_len_mean": 415.35849056603774, "episodes_this_iter": 27, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 18.899999999999828, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 4.099999999999618, -50.00000000000044, 20.299999999999848, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.49999999999995, 26.89999999999994, -50.00000000000044, -50.00000000000044, 21.699999999999868, 41.90000000000001, -50.00000000000044, 35.30000000000004, -50.00000000000044, 19.299999999999834, 41.90000000000001, 21.89999999999987, 41.500000000000014, -50.00000000000044, -50.00000000000044, 0.09999999999956088, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.69999999999984, 32.50000000000002, -50.00000000000044, 13.099999999999746, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 4.299999999999621, -50.00000000000044, 5.899999999999643, 34.30000000000004, -50.00000000000044, 19.499999999999837], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 312, 500, 500, 500, 500, 460, 500, 298, 500, 500, 500, 226, 232, 500, 500, 284, 82, 500, 148, 500, 308, 82, 282, 86, 500, 500, 500, 500, 500, 500, 500, 304, 176, 500, 370, 500, 500, 500, 500, 458, 500, 442, 158, 500, 306]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3676326469093092, "mean_inference_ms": 1.2011703537446483, "mean_action_processing_ms": 0.1451802736599412, "mean_env_wait_ms": 0.08087033589542574, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028337622588535526, "StateBufferConnector_ms": 0.00759160743569428, "ViewRequirementAgentConnector_ms": 0.13049908404080374}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5586.830297455394, "num_env_steps_trained_throughput_per_sec": 5586.830297455394, "timesteps_total": 24000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 2125.858, "sample_time_ms": 1910.867, "load_time_ms": 6.927, "load_throughput": 1732288.694, "learn_time_ms": 195.972, "learn_throughput": 61233.323, "synch_weights_time_ms": 10.09}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "episodes_total": 53, "training_iteration": 2, "trial_id": "9f288_00017", "date": "2023-10-25_16-56-35", "timestamp": 1698249395, "time_this_iter_s": 2.1527581214904785, "time_total_s": 4.261561393737793, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 4.261561393737793, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 57.224999999999994, "ram_util_percent": 27.025}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.05000000000000002, "cur_lr": 0.0003, "total_loss": 8.833501211802165, "policy_loss": -0.0017422473989427089, "vf_loss": 8.835169792175293, "vf_explained_var": 1.4062722524007162e-05, "kl": 0.0027264032795073943, "entropy": 0.6245096156994502, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 75.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "sampler_results": {"episode_reward_max": 44.300000000000004, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -8.305208333333587, "episode_len_mean": 349.2083333333333, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 18.899999999999828, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 4.099999999999618, -50.00000000000044, 20.299999999999848, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.49999999999995, 26.89999999999994, -50.00000000000044, -50.00000000000044, 21.699999999999868, 41.90000000000001, -50.00000000000044, 35.30000000000004, -50.00000000000044, 19.299999999999834, 41.90000000000001, 21.89999999999987, 41.500000000000014, -50.00000000000044, -50.00000000000044, 0.09999999999956088, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.69999999999984, 32.50000000000002, -50.00000000000044, 13.099999999999746, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 4.299999999999621, -50.00000000000044, 5.899999999999643, 34.30000000000004, -50.00000000000044, 19.499999999999837, 12.69999999999974, -50.00000000000044, 11.499999999999723, 19.499999999999837, 44.300000000000004, -50.00000000000044, 28.699999999999967, -50.00000000000044, 41.100000000000016, 43.7, 36.30000000000003, 39.50000000000002, -50.00000000000044, 43.7, 31.70000000000001, -50.00000000000044, -50.00000000000044, 30.9, -50.00000000000044, 35.70000000000003, 26.299999999999933, 39.90000000000002, -50.00000000000044, 23.8999999999999, 39.90000000000002, 27.299999999999947, 40.70000000000002, 44.10000000000001, 35.10000000000004, 42.500000000000014, 42.500000000000014, 38.10000000000002, 42.900000000000006, 4.099999999999618, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.70000000000003, 20.899999999999856, 26.09999999999993, 41.30000000000001, -50.00000000000044, 10.499999999999709], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 312, 500, 500, 500, 500, 460, 500, 298, 500, 500, 500, 226, 232, 500, 500, 284, 82, 500, 148, 500, 308, 82, 282, 86, 500, 500, 500, 500, 500, 500, 500, 304, 176, 500, 370, 500, 500, 500, 500, 458, 500, 442, 158, 500, 306, 374, 500, 386, 306, 58, 500, 214, 500, 90, 64, 138, 106, 500, 64, 184, 500, 500, 192, 500, 144, 238, 102, 500, 262, 102, 228, 94, 60, 150, 76, 76, 120, 72, 460, 500, 500, 500, 134, 292, 240, 88, 500, 396]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3689620430721224, "mean_inference_ms": 1.2038785896681834, "mean_action_processing_ms": 0.14381891187751636, "mean_env_wait_ms": 0.08240931721867283, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027103970448176067, "StateBufferConnector_ms": 0.00627562403678894, "ViewRequirementAgentConnector_ms": 0.13199994961420694}}, "episode_reward_max": 44.300000000000004, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -8.305208333333587, "episode_len_mean": 349.2083333333333, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 18.899999999999828, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 4.099999999999618, -50.00000000000044, 20.299999999999848, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.49999999999995, 26.89999999999994, -50.00000000000044, -50.00000000000044, 21.699999999999868, 41.90000000000001, -50.00000000000044, 35.30000000000004, -50.00000000000044, 19.299999999999834, 41.90000000000001, 21.89999999999987, 41.500000000000014, -50.00000000000044, -50.00000000000044, 0.09999999999956088, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.69999999999984, 32.50000000000002, -50.00000000000044, 13.099999999999746, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 4.299999999999621, -50.00000000000044, 5.899999999999643, 34.30000000000004, -50.00000000000044, 19.499999999999837, 12.69999999999974, -50.00000000000044, 11.499999999999723, 19.499999999999837, 44.300000000000004, -50.00000000000044, 28.699999999999967, -50.00000000000044, 41.100000000000016, 43.7, 36.30000000000003, 39.50000000000002, -50.00000000000044, 43.7, 31.70000000000001, -50.00000000000044, -50.00000000000044, 30.9, -50.00000000000044, 35.70000000000003, 26.299999999999933, 39.90000000000002, -50.00000000000044, 23.8999999999999, 39.90000000000002, 27.299999999999947, 40.70000000000002, 44.10000000000001, 35.10000000000004, 42.500000000000014, 42.500000000000014, 38.10000000000002, 42.900000000000006, 4.099999999999618, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.70000000000003, 20.899999999999856, 26.09999999999993, 41.30000000000001, -50.00000000000044, 10.499999999999709], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 312, 500, 500, 500, 500, 460, 500, 298, 500, 500, 500, 226, 232, 500, 500, 284, 82, 500, 148, 500, 308, 82, 282, 86, 500, 500, 500, 500, 500, 500, 500, 304, 176, 500, 370, 500, 500, 500, 500, 458, 500, 442, 158, 500, 306, 374, 500, 386, 306, 58, 500, 214, 500, 90, 64, 138, 106, 500, 64, 184, 500, 500, 192, 500, 144, 238, 102, 500, 262, 102, 228, 94, 60, 150, 76, 76, 120, 72, 460, 500, 500, 500, 134, 292, 240, 88, 500, 396]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3689620430721224, "mean_inference_ms": 1.2038785896681834, "mean_action_processing_ms": 0.14381891187751636, "mean_env_wait_ms": 0.08240931721867283, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027103970448176067, "StateBufferConnector_ms": 0.00627562403678894, "ViewRequirementAgentConnector_ms": 0.13199994961420694}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5326.533203968323, "num_env_steps_trained_throughput_per_sec": 5326.533203968323, "timesteps_total": 36000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 2168.196, "sample_time_ms": 1908.278, "load_time_ms": 7.546, "load_throughput": 1590324.437, "learn_time_ms": 240.653, "learn_throughput": 49864.336, "synch_weights_time_ms": 9.718}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "episodes_total": 96, "training_iteration": 3, "trial_id": "9f288_00017", "date": "2023-10-25_16-56-37", "timestamp": 1698249397, "time_this_iter_s": 2.256869077682495, "time_total_s": 6.518430471420288, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 6.518430471420288, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 59.26666666666667, "ram_util_percent": 27.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.02500000000000001, "cur_lr": 0.0003, "total_loss": 8.680163447062174, "policy_loss": -0.0006600480837126572, "vf_loss": 8.68085241317749, "vf_explained_var": 7.319450378417969e-06, "kl": 0.0013537028563860077, "entropy": 0.6276003619035085, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 105.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.574999999999825, "episode_len_mean": 279.92, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 4.299999999999621, -50.00000000000044, 5.899999999999643, 34.30000000000004, -50.00000000000044, 19.499999999999837, 12.69999999999974, -50.00000000000044, 11.499999999999723, 19.499999999999837, 44.300000000000004, -50.00000000000044, 28.699999999999967, -50.00000000000044, 41.100000000000016, 43.7, 36.30000000000003, 39.50000000000002, -50.00000000000044, 43.7, 31.70000000000001, -50.00000000000044, -50.00000000000044, 30.9, -50.00000000000044, 35.70000000000003, 26.299999999999933, 39.90000000000002, -50.00000000000044, 23.8999999999999, 39.90000000000002, 27.299999999999947, 40.70000000000002, 44.10000000000001, 35.10000000000004, 42.500000000000014, 42.500000000000014, 38.10000000000002, 42.900000000000006, 4.099999999999618, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.70000000000003, 20.899999999999856, 26.09999999999993, 41.30000000000001, -50.00000000000044, 10.499999999999709, 12.899999999999743, -50.00000000000044, 45.9, 35.30000000000004, 23.699999999999896, -50.00000000000044, 33.500000000000036, 37.90000000000003, 42.30000000000001, -50.00000000000044, -50.00000000000044, 42.10000000000001, 38.90000000000002, 36.10000000000004, -50.00000000000044, 38.90000000000002, 43.10000000000001, 28.699999999999967, 41.500000000000014, 43.30000000000001, 37.70000000000003, 45.9, -50.00000000000044, 41.500000000000014, -50.00000000000044, 43.10000000000001, -50.00000000000044, 12.299999999999734, -50.00000000000044, 46.5, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 36.900000000000034, 32.30000000000002, 32.700000000000024, 44.900000000000006, 21.499999999999865, 18.899999999999828, 27.899999999999956, 32.90000000000003, -50.00000000000044, 33.30000000000003, 47.7, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 500, 500, 458, 500, 442, 158, 500, 306, 374, 500, 386, 306, 58, 500, 214, 500, 90, 64, 138, 106, 500, 64, 184, 500, 500, 192, 500, 144, 238, 102, 500, 262, 102, 228, 94, 60, 150, 76, 76, 120, 72, 460, 500, 500, 500, 134, 292, 240, 88, 500, 396, 372, 500, 42, 148, 264, 500, 166, 122, 78, 500, 500, 80, 112, 140, 500, 112, 70, 214, 86, 68, 124, 42, 500, 86, 500, 70, 500, 378, 500, 36, 500, 88, 500, 500, 132, 178, 174, 52, 286, 312, 222, 172, 500, 168, 24, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3714923706753247, "mean_inference_ms": 1.2037737683275984, "mean_action_processing_ms": 0.14204556805299562, "mean_env_wait_ms": 0.0836475398522847, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025001049041748047, "StateBufferConnector_ms": 0.003999948501586914, "ViewRequirementAgentConnector_ms": 0.1278669834136963}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.574999999999825, "episode_len_mean": 279.92, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 4.299999999999621, -50.00000000000044, 5.899999999999643, 34.30000000000004, -50.00000000000044, 19.499999999999837, 12.69999999999974, -50.00000000000044, 11.499999999999723, 19.499999999999837, 44.300000000000004, -50.00000000000044, 28.699999999999967, -50.00000000000044, 41.100000000000016, 43.7, 36.30000000000003, 39.50000000000002, -50.00000000000044, 43.7, 31.70000000000001, -50.00000000000044, -50.00000000000044, 30.9, -50.00000000000044, 35.70000000000003, 26.299999999999933, 39.90000000000002, -50.00000000000044, 23.8999999999999, 39.90000000000002, 27.299999999999947, 40.70000000000002, 44.10000000000001, 35.10000000000004, 42.500000000000014, 42.500000000000014, 38.10000000000002, 42.900000000000006, 4.099999999999618, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.70000000000003, 20.899999999999856, 26.09999999999993, 41.30000000000001, -50.00000000000044, 10.499999999999709, 12.899999999999743, -50.00000000000044, 45.9, 35.30000000000004, 23.699999999999896, -50.00000000000044, 33.500000000000036, 37.90000000000003, 42.30000000000001, -50.00000000000044, -50.00000000000044, 42.10000000000001, 38.90000000000002, 36.10000000000004, -50.00000000000044, 38.90000000000002, 43.10000000000001, 28.699999999999967, 41.500000000000014, 43.30000000000001, 37.70000000000003, 45.9, -50.00000000000044, 41.500000000000014, -50.00000000000044, 43.10000000000001, -50.00000000000044, 12.299999999999734, -50.00000000000044, 46.5, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 36.900000000000034, 32.30000000000002, 32.700000000000024, 44.900000000000006, 21.499999999999865, 18.899999999999828, 27.899999999999956, 32.90000000000003, -50.00000000000044, 33.30000000000003, 47.7, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 500, 500, 458, 500, 442, 158, 500, 306, 374, 500, 386, 306, 58, 500, 214, 500, 90, 64, 138, 106, 500, 64, 184, 500, 500, 192, 500, 144, 238, 102, 500, 262, 102, 228, 94, 60, 150, 76, 76, 120, 72, 460, 500, 500, 500, 134, 292, 240, 88, 500, 396, 372, 500, 42, 148, 264, 500, 166, 122, 78, 500, 500, 80, 112, 140, 500, 112, 70, 214, 86, 68, 124, 42, 500, 86, 500, 70, 500, 378, 500, 36, 500, 88, 500, 500, 132, 178, 174, 52, 286, 312, 222, 172, 500, 168, 24, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3714923706753247, "mean_inference_ms": 1.2037737683275984, "mean_action_processing_ms": 0.14204556805299562, "mean_env_wait_ms": 0.0836475398522847, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025001049041748047, "StateBufferConnector_ms": 0.003999948501586914, "ViewRequirementAgentConnector_ms": 0.1278669834136963}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5154.644830177271, "num_env_steps_trained_throughput_per_sec": 5154.644830177271, "timesteps_total": 48000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 2208.147, "sample_time_ms": 1909.361, "load_time_ms": 9.848, "load_throughput": 1218484.824, "learn_time_ms": 277.441, "learn_throughput": 43252.491, "synch_weights_time_ms": 9.745}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "episodes_total": 143, "training_iteration": 4, "trial_id": "9f288_00017", "date": "2023-10-25_16-56-39", "timestamp": 1698249399, "time_this_iter_s": 2.332991361618042, "time_total_s": 8.85142183303833, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 8.85142183303833, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 60.366666666666674, "ram_util_percent": 27.133333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.012500000000000004, "cur_lr": 0.0003, "total_loss": 8.269769732157389, "policy_loss": -0.0008962780858079593, "vf_loss": 8.270703585942586, "vf_explained_var": -2.157688140869141e-06, "kl": 0.00155508659112229, "entropy": 0.5689391672611237, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 135.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.407999999999819, "episode_len_mean": 276.56, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.500000000000014, 38.10000000000002, 42.900000000000006, 4.099999999999618, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.70000000000003, 20.899999999999856, 26.09999999999993, 41.30000000000001, -50.00000000000044, 10.499999999999709, 12.899999999999743, -50.00000000000044, 45.9, 35.30000000000004, 23.699999999999896, -50.00000000000044, 33.500000000000036, 37.90000000000003, 42.30000000000001, -50.00000000000044, -50.00000000000044, 42.10000000000001, 38.90000000000002, 36.10000000000004, -50.00000000000044, 38.90000000000002, 43.10000000000001, 28.699999999999967, 41.500000000000014, 43.30000000000001, 37.70000000000003, 45.9, -50.00000000000044, 41.500000000000014, -50.00000000000044, 43.10000000000001, -50.00000000000044, 12.299999999999734, -50.00000000000044, 46.5, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 36.900000000000034, 32.30000000000002, 32.700000000000024, 44.900000000000006, 21.499999999999865, 18.899999999999828, 27.899999999999956, 32.90000000000003, -50.00000000000044, 33.30000000000003, 47.7, -50.00000000000044, -50.00000000000044, 44.5, 43.900000000000006, 8.299999999999677, 20.49999999999985, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.900000000000034, 42.30000000000001, 43.7, 20.299999999999848, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, 34.900000000000034, 40.10000000000002, 21.499999999999865, -50.00000000000044, -50.00000000000044, 36.70000000000003, 46.3, 23.099999999999888, 41.30000000000001, 23.29999999999989, -50.00000000000044, 44.900000000000006, -50.00000000000044, 43.50000000000001, 44.10000000000001], "episode_lengths": [76, 120, 72, 460, 500, 500, 500, 134, 292, 240, 88, 500, 396, 372, 500, 42, 148, 264, 500, 166, 122, 78, 500, 500, 80, 112, 140, 500, 112, 70, 214, 86, 68, 124, 42, 500, 86, 500, 70, 500, 378, 500, 36, 500, 88, 500, 500, 132, 178, 174, 52, 286, 312, 222, 172, 500, 168, 24, 500, 500, 56, 62, 418, 296, 500, 500, 68, 500, 500, 500, 132, 78, 64, 298, 500, 500, 64, 500, 500, 500, 82, 500, 28, 500, 500, 152, 100, 286, 500, 500, 134, 38, 270, 88, 268, 500, 52, 500, 66, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37595250839276484, "mean_inference_ms": 1.202633375782749, "mean_action_processing_ms": 0.1421206225194313, "mean_env_wait_ms": 0.08342050043841708, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01997661590576172, "StateBufferConnector_ms": 0.005015850067138672, "ViewRequirementAgentConnector_ms": 0.1283271312713623}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.407999999999819, "episode_len_mean": 276.56, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.500000000000014, 38.10000000000002, 42.900000000000006, 4.099999999999618, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.70000000000003, 20.899999999999856, 26.09999999999993, 41.30000000000001, -50.00000000000044, 10.499999999999709, 12.899999999999743, -50.00000000000044, 45.9, 35.30000000000004, 23.699999999999896, -50.00000000000044, 33.500000000000036, 37.90000000000003, 42.30000000000001, -50.00000000000044, -50.00000000000044, 42.10000000000001, 38.90000000000002, 36.10000000000004, -50.00000000000044, 38.90000000000002, 43.10000000000001, 28.699999999999967, 41.500000000000014, 43.30000000000001, 37.70000000000003, 45.9, -50.00000000000044, 41.500000000000014, -50.00000000000044, 43.10000000000001, -50.00000000000044, 12.299999999999734, -50.00000000000044, 46.5, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 36.900000000000034, 32.30000000000002, 32.700000000000024, 44.900000000000006, 21.499999999999865, 18.899999999999828, 27.899999999999956, 32.90000000000003, -50.00000000000044, 33.30000000000003, 47.7, -50.00000000000044, -50.00000000000044, 44.5, 43.900000000000006, 8.299999999999677, 20.49999999999985, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.900000000000034, 42.30000000000001, 43.7, 20.299999999999848, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, 34.900000000000034, 40.10000000000002, 21.499999999999865, -50.00000000000044, -50.00000000000044, 36.70000000000003, 46.3, 23.099999999999888, 41.30000000000001, 23.29999999999989, -50.00000000000044, 44.900000000000006, -50.00000000000044, 43.50000000000001, 44.10000000000001], "episode_lengths": [76, 120, 72, 460, 500, 500, 500, 134, 292, 240, 88, 500, 396, 372, 500, 42, 148, 264, 500, 166, 122, 78, 500, 500, 80, 112, 140, 500, 112, 70, 214, 86, 68, 124, 42, 500, 86, 500, 70, 500, 378, 500, 36, 500, 88, 500, 500, 132, 178, 174, 52, 286, 312, 222, 172, 500, 168, 24, 500, 500, 56, 62, 418, 296, 500, 500, 68, 500, 500, 500, 132, 78, 64, 298, 500, 500, 64, 500, 500, 500, 82, 500, 28, 500, 500, 152, 100, 286, 500, 500, 134, 38, 270, 88, 268, 500, 52, 500, 66, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37595250839276484, "mean_inference_ms": 1.202633375782749, "mean_action_processing_ms": 0.1421206225194313, "mean_env_wait_ms": 0.08342050043841708, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01997661590576172, "StateBufferConnector_ms": 0.005015850067138672, "ViewRequirementAgentConnector_ms": 0.1283271312713623}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5319.061707232916, "num_env_steps_trained_throughput_per_sec": 5319.061707232916, "timesteps_total": 60000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 2217.725, "sample_time_ms": 1912.864, "load_time_ms": 10.084, "load_throughput": 1189952.243, "learn_time_ms": 282.979, "learn_throughput": 42406.0, "synch_weights_time_ms": 9.796}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "episodes_total": 183, "training_iteration": 5, "trial_id": "9f288_00017", "date": "2023-10-25_16-56-42", "timestamp": 1698249402, "time_this_iter_s": 2.260587692260742, "time_total_s": 11.112009525299072, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 11.112009525299072, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 58.333333333333336, "ram_util_percent": 27.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.006250000000000002, "cur_lr": 0.0003, "total_loss": 7.371159919102987, "policy_loss": -0.0009482172628243764, "vf_loss": 7.372156031926473, "vf_explained_var": -3.1252702077229816e-06, "kl": 0.001632261311874572, "entropy": 0.5813799341519673, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 165.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.027999999999819, "episode_len_mean": 270.34, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 36.900000000000034, 32.30000000000002, 32.700000000000024, 44.900000000000006, 21.499999999999865, 18.899999999999828, 27.899999999999956, 32.90000000000003, -50.00000000000044, 33.30000000000003, 47.7, -50.00000000000044, -50.00000000000044, 44.5, 43.900000000000006, 8.299999999999677, 20.49999999999985, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.900000000000034, 42.30000000000001, 43.7, 20.299999999999848, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, 34.900000000000034, 40.10000000000002, 21.499999999999865, -50.00000000000044, -50.00000000000044, 36.70000000000003, 46.3, 23.099999999999888, 41.30000000000001, 23.29999999999989, -50.00000000000044, 44.900000000000006, -50.00000000000044, 43.50000000000001, 44.10000000000001, 25.099999999999916, -50.00000000000044, 43.7, 39.300000000000026, 44.5, -50.00000000000044, -50.00000000000044, 29.899999999999984, 37.10000000000003, 18.899999999999828, -50.00000000000044, 44.10000000000001, -50.00000000000044, 43.7, 45.7, 44.300000000000004, 8.099999999999675, -50.00000000000044, 45.5, 33.90000000000004, 42.900000000000006, 41.70000000000002, -50.00000000000044, 42.30000000000001, -50.00000000000044, 45.1, -50.00000000000044, 45.1, 44.900000000000006, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 42.500000000000014, 35.900000000000034, 44.300000000000004, -50.00000000000044, 41.90000000000001, 45.5, 46.9, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.500000000000036], "episode_lengths": [500, 132, 178, 174, 52, 286, 312, 222, 172, 500, 168, 24, 500, 500, 56, 62, 418, 296, 500, 500, 68, 500, 500, 500, 132, 78, 64, 298, 500, 500, 64, 500, 500, 500, 82, 500, 28, 500, 500, 152, 100, 286, 500, 500, 134, 38, 270, 88, 268, 500, 52, 500, 66, 60, 250, 500, 64, 108, 56, 500, 500, 202, 130, 312, 500, 60, 500, 64, 44, 58, 420, 500, 46, 162, 72, 84, 500, 78, 500, 50, 500, 50, 52, 500, 72, 500, 500, 76, 142, 58, 500, 82, 46, 32, 500, 118, 500, 500, 500, 166]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3788162025249995, "mean_inference_ms": 1.2015533181475144, "mean_action_processing_ms": 0.14213805267268145, "mean_env_wait_ms": 0.08435299180038534, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020977020263671875, "StateBufferConnector_ms": 0.011015176773071289, "ViewRequirementAgentConnector_ms": 0.1281721591949463}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.027999999999819, "episode_len_mean": 270.34, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 36.900000000000034, 32.30000000000002, 32.700000000000024, 44.900000000000006, 21.499999999999865, 18.899999999999828, 27.899999999999956, 32.90000000000003, -50.00000000000044, 33.30000000000003, 47.7, -50.00000000000044, -50.00000000000044, 44.5, 43.900000000000006, 8.299999999999677, 20.49999999999985, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.900000000000034, 42.30000000000001, 43.7, 20.299999999999848, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, 34.900000000000034, 40.10000000000002, 21.499999999999865, -50.00000000000044, -50.00000000000044, 36.70000000000003, 46.3, 23.099999999999888, 41.30000000000001, 23.29999999999989, -50.00000000000044, 44.900000000000006, -50.00000000000044, 43.50000000000001, 44.10000000000001, 25.099999999999916, -50.00000000000044, 43.7, 39.300000000000026, 44.5, -50.00000000000044, -50.00000000000044, 29.899999999999984, 37.10000000000003, 18.899999999999828, -50.00000000000044, 44.10000000000001, -50.00000000000044, 43.7, 45.7, 44.300000000000004, 8.099999999999675, -50.00000000000044, 45.5, 33.90000000000004, 42.900000000000006, 41.70000000000002, -50.00000000000044, 42.30000000000001, -50.00000000000044, 45.1, -50.00000000000044, 45.1, 44.900000000000006, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 42.500000000000014, 35.900000000000034, 44.300000000000004, -50.00000000000044, 41.90000000000001, 45.5, 46.9, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.500000000000036], "episode_lengths": [500, 132, 178, 174, 52, 286, 312, 222, 172, 500, 168, 24, 500, 500, 56, 62, 418, 296, 500, 500, 68, 500, 500, 500, 132, 78, 64, 298, 500, 500, 64, 500, 500, 500, 82, 500, 28, 500, 500, 152, 100, 286, 500, 500, 134, 38, 270, 88, 268, 500, 52, 500, 66, 60, 250, 500, 64, 108, 56, 500, 500, 202, 130, 312, 500, 60, 500, 64, 44, 58, 420, 500, 46, 162, 72, 84, 500, 78, 500, 50, 500, 50, 52, 500, 72, 500, 500, 76, 142, 58, 500, 82, 46, 32, 500, 118, 500, 500, 500, 166]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3788162025249995, "mean_inference_ms": 1.2015533181475144, "mean_action_processing_ms": 0.14213805267268145, "mean_env_wait_ms": 0.08435299180038534, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020977020263671875, "StateBufferConnector_ms": 0.011015176773071289, "ViewRequirementAgentConnector_ms": 0.1281721591949463}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5269.457276235212, "num_env_steps_trained_throughput_per_sec": 5269.457276235212, "timesteps_total": 72000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 2227.65, "sample_time_ms": 1912.204, "load_time_ms": 11.036, "load_throughput": 1087342.791, "learn_time_ms": 292.965, "learn_throughput": 40960.572, "synch_weights_time_ms": 9.61}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "episodes_total": 229, "training_iteration": 6, "trial_id": "9f288_00017", "date": "2023-10-25_16-56-44", "timestamp": 1698249404, "time_this_iter_s": 2.28226900100708, "time_total_s": 13.394278526306152, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 13.394278526306152, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 57.166666666666664, "ram_util_percent": 27.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.003125000000000001, "cur_lr": 0.0003, "total_loss": 6.786521339416504, "policy_loss": -0.0008552753056089084, "vf_loss": 6.787428267796835, "vf_explained_var": -1.813968022664388e-06, "kl": 0.0016656772720618088, "entropy": 0.5683293382326762, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 195.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.261999999999832, "episode_len_mean": 248.04, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.50000000000001, 44.10000000000001, 25.099999999999916, -50.00000000000044, 43.7, 39.300000000000026, 44.5, -50.00000000000044, -50.00000000000044, 29.899999999999984, 37.10000000000003, 18.899999999999828, -50.00000000000044, 44.10000000000001, -50.00000000000044, 43.7, 45.7, 44.300000000000004, 8.099999999999675, -50.00000000000044, 45.5, 33.90000000000004, 42.900000000000006, 41.70000000000002, -50.00000000000044, 42.30000000000001, -50.00000000000044, 45.1, -50.00000000000044, 45.1, 44.900000000000006, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 42.500000000000014, 35.900000000000034, 44.300000000000004, -50.00000000000044, 41.90000000000001, 45.5, 46.9, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 42.30000000000001, 45.7, 47.3, 40.70000000000002, 43.7, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 43.50000000000001, -50.00000000000044, 40.500000000000014, 33.10000000000003, -50.00000000000044, 31.900000000000013, 44.900000000000006, 44.300000000000004, 42.10000000000001, -50.00000000000044, 44.5, 45.5, 44.900000000000006, -50.00000000000044, 7.699999999999669, 43.900000000000006, 41.30000000000001, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 44.900000000000006, 4.899999999999629, 42.30000000000001, -50.00000000000044, 47.1, 39.70000000000002, 46.3, 14.299999999999763, 12.099999999999731, 45.3, -50.00000000000044, 2.299999999999592, 37.10000000000003, 36.900000000000034, 17.899999999999814, -50.00000000000044], "episode_lengths": [66, 60, 250, 500, 64, 108, 56, 500, 500, 202, 130, 312, 500, 60, 500, 64, 44, 58, 420, 500, 46, 162, 72, 84, 500, 78, 500, 50, 500, 50, 52, 500, 72, 500, 500, 76, 142, 58, 500, 82, 46, 32, 500, 118, 500, 500, 500, 166, 500, 500, 500, 56, 78, 44, 28, 94, 64, 54, 500, 500, 500, 34, 500, 66, 500, 96, 170, 500, 182, 52, 58, 80, 500, 56, 46, 52, 500, 424, 62, 88, 500, 500, 38, 500, 52, 452, 78, 500, 30, 104, 38, 358, 380, 48, 500, 478, 130, 132, 322, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38000374515818647, "mean_inference_ms": 1.2027507776809516, "mean_action_processing_ms": 0.14204673782573132, "mean_env_wait_ms": 0.08368046019042222, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023991107940673828, "StateBufferConnector_ms": 0.01300191879272461, "ViewRequirementAgentConnector_ms": 0.12587189674377441}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.261999999999832, "episode_len_mean": 248.04, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.50000000000001, 44.10000000000001, 25.099999999999916, -50.00000000000044, 43.7, 39.300000000000026, 44.5, -50.00000000000044, -50.00000000000044, 29.899999999999984, 37.10000000000003, 18.899999999999828, -50.00000000000044, 44.10000000000001, -50.00000000000044, 43.7, 45.7, 44.300000000000004, 8.099999999999675, -50.00000000000044, 45.5, 33.90000000000004, 42.900000000000006, 41.70000000000002, -50.00000000000044, 42.30000000000001, -50.00000000000044, 45.1, -50.00000000000044, 45.1, 44.900000000000006, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 42.500000000000014, 35.900000000000034, 44.300000000000004, -50.00000000000044, 41.90000000000001, 45.5, 46.9, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 42.30000000000001, 45.7, 47.3, 40.70000000000002, 43.7, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 43.50000000000001, -50.00000000000044, 40.500000000000014, 33.10000000000003, -50.00000000000044, 31.900000000000013, 44.900000000000006, 44.300000000000004, 42.10000000000001, -50.00000000000044, 44.5, 45.5, 44.900000000000006, -50.00000000000044, 7.699999999999669, 43.900000000000006, 41.30000000000001, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 44.900000000000006, 4.899999999999629, 42.30000000000001, -50.00000000000044, 47.1, 39.70000000000002, 46.3, 14.299999999999763, 12.099999999999731, 45.3, -50.00000000000044, 2.299999999999592, 37.10000000000003, 36.900000000000034, 17.899999999999814, -50.00000000000044], "episode_lengths": [66, 60, 250, 500, 64, 108, 56, 500, 500, 202, 130, 312, 500, 60, 500, 64, 44, 58, 420, 500, 46, 162, 72, 84, 500, 78, 500, 50, 500, 50, 52, 500, 72, 500, 500, 76, 142, 58, 500, 82, 46, 32, 500, 118, 500, 500, 500, 166, 500, 500, 500, 56, 78, 44, 28, 94, 64, 54, 500, 500, 500, 34, 500, 66, 500, 96, 170, 500, 182, 52, 58, 80, 500, 56, 46, 52, 500, 424, 62, 88, 500, 500, 38, 500, 52, 452, 78, 500, 30, 104, 38, 358, 380, 48, 500, 478, 130, 132, 322, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38000374515818647, "mean_inference_ms": 1.2027507776809516, "mean_action_processing_ms": 0.14204673782573132, "mean_env_wait_ms": 0.08368046019042222, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023991107940673828, "StateBufferConnector_ms": 0.01300191879272461, "ViewRequirementAgentConnector_ms": 0.12587189674377441}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5238.409890227006, "num_env_steps_trained_throughput_per_sec": 5238.409890227006, "timesteps_total": 84000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 2236.667, "sample_time_ms": 1920.982, "load_time_ms": 10.889, "load_throughput": 1101989.703, "learn_time_ms": 292.986, "learn_throughput": 40957.605, "synch_weights_time_ms": 9.951}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "episodes_total": 281, "training_iteration": 7, "trial_id": "9f288_00017", "date": "2023-10-25_16-56-46", "timestamp": 1698249406, "time_this_iter_s": 2.2967700958251953, "time_total_s": 15.691048622131348, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 15.691048622131348, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 53.900000000000006, "ram_util_percent": 27.150000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0015625000000000005, "cur_lr": 0.0003, "total_loss": 6.404182847340902, "policy_loss": 1.8153091271718343e-05, "vf_loss": 6.40421708424886, "vf_explained_var": -1.0927518208821614e-07, "kl": 0.0001455111985402861, "entropy": 0.5254730552434921, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 225.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.352999999999812, "episode_len_mean": 262.1, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [38.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 42.30000000000001, 45.7, 47.3, 40.70000000000002, 43.7, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 43.50000000000001, -50.00000000000044, 40.500000000000014, 33.10000000000003, -50.00000000000044, 31.900000000000013, 44.900000000000006, 44.300000000000004, 42.10000000000001, -50.00000000000044, 44.5, 45.5, 44.900000000000006, -50.00000000000044, 7.699999999999669, 43.900000000000006, 41.30000000000001, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 44.900000000000006, 4.899999999999629, 42.30000000000001, -50.00000000000044, 47.1, 39.70000000000002, 46.3, 14.299999999999763, 12.099999999999731, 45.3, -50.00000000000044, 2.299999999999592, 37.10000000000003, 36.900000000000034, 17.899999999999814, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 11.899999999999729, 43.30000000000001, -50.00000000000044, 44.900000000000006, -50.00000000000044, 33.70000000000004, 44.5, -50.00000000000044, -50.00000000000044, 45.1, 42.70000000000001, 41.70000000000002, -50.00000000000044, 41.90000000000001, 46.699999999999996, -50.00000000000044, 18.699999999999825, -50.00000000000044, 43.10000000000001, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 46.699999999999996, -50.00000000000044, 18.699999999999825, 43.50000000000001, 9.699999999999697, 45.5, 45.7, 37.300000000000026, -50.00000000000044, 41.100000000000016, 43.10000000000001, 44.300000000000004, -50.00000000000044, 44.900000000000006, 44.300000000000004], "episode_lengths": [118, 500, 500, 500, 166, 500, 500, 500, 56, 78, 44, 28, 94, 64, 54, 500, 500, 500, 34, 500, 66, 500, 96, 170, 500, 182, 52, 58, 80, 500, 56, 46, 52, 500, 424, 62, 88, 500, 500, 38, 500, 52, 452, 78, 500, 30, 104, 38, 358, 380, 48, 500, 478, 130, 132, 322, 500, 500, 500, 500, 382, 68, 500, 52, 500, 164, 56, 500, 500, 50, 74, 84, 500, 82, 34, 500, 314, 500, 70, 54, 500, 500, 500, 500, 54, 34, 500, 314, 66, 404, 46, 44, 128, 500, 90, 70, 58, 500, 52, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3800775173131974, "mean_inference_ms": 1.205595467641302, "mean_action_processing_ms": 0.14212374460443625, "mean_env_wait_ms": 0.08328131003049682, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025992393493652344, "StateBufferConnector_ms": 0.013002395629882812, "ViewRequirementAgentConnector_ms": 0.11651253700256348}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.352999999999812, "episode_len_mean": 262.1, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [38.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 42.30000000000001, 45.7, 47.3, 40.70000000000002, 43.7, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 43.50000000000001, -50.00000000000044, 40.500000000000014, 33.10000000000003, -50.00000000000044, 31.900000000000013, 44.900000000000006, 44.300000000000004, 42.10000000000001, -50.00000000000044, 44.5, 45.5, 44.900000000000006, -50.00000000000044, 7.699999999999669, 43.900000000000006, 41.30000000000001, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 44.900000000000006, 4.899999999999629, 42.30000000000001, -50.00000000000044, 47.1, 39.70000000000002, 46.3, 14.299999999999763, 12.099999999999731, 45.3, -50.00000000000044, 2.299999999999592, 37.10000000000003, 36.900000000000034, 17.899999999999814, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 11.899999999999729, 43.30000000000001, -50.00000000000044, 44.900000000000006, -50.00000000000044, 33.70000000000004, 44.5, -50.00000000000044, -50.00000000000044, 45.1, 42.70000000000001, 41.70000000000002, -50.00000000000044, 41.90000000000001, 46.699999999999996, -50.00000000000044, 18.699999999999825, -50.00000000000044, 43.10000000000001, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 46.699999999999996, -50.00000000000044, 18.699999999999825, 43.50000000000001, 9.699999999999697, 45.5, 45.7, 37.300000000000026, -50.00000000000044, 41.100000000000016, 43.10000000000001, 44.300000000000004, -50.00000000000044, 44.900000000000006, 44.300000000000004], "episode_lengths": [118, 500, 500, 500, 166, 500, 500, 500, 56, 78, 44, 28, 94, 64, 54, 500, 500, 500, 34, 500, 66, 500, 96, 170, 500, 182, 52, 58, 80, 500, 56, 46, 52, 500, 424, 62, 88, 500, 500, 38, 500, 52, 452, 78, 500, 30, 104, 38, 358, 380, 48, 500, 478, 130, 132, 322, 500, 500, 500, 500, 382, 68, 500, 52, 500, 164, 56, 500, 500, 50, 74, 84, 500, 82, 34, 500, 314, 500, 70, 54, 500, 500, 500, 500, 54, 34, 500, 314, 66, 404, 46, 44, 128, 500, 90, 70, 58, 500, 52, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3800775173131974, "mean_inference_ms": 1.205595467641302, "mean_action_processing_ms": 0.14212374460443625, "mean_env_wait_ms": 0.08328131003049682, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025992393493652344, "StateBufferConnector_ms": 0.013002395629882812, "ViewRequirementAgentConnector_ms": 0.11651253700256348}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5321.083858614138, "num_env_steps_trained_throughput_per_sec": 5321.083858614138, "timesteps_total": 96000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 2238.981, "sample_time_ms": 1917.335, "load_time_ms": 11.656, "load_throughput": 1029529.701, "learn_time_ms": 298.171, "learn_throughput": 40245.357, "synch_weights_time_ms": 10.068}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "episodes_total": 324, "training_iteration": 8, "trial_id": "9f288_00017", "date": "2023-10-25_16-56-48", "timestamp": 1698249408, "time_this_iter_s": 2.260650873184204, "time_total_s": 17.95169949531555, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 17.95169949531555, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 58.96666666666666, "ram_util_percent": 27.133333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0007812500000000003, "cur_lr": 0.0003, "total_loss": 6.610548607508341, "policy_loss": -0.00014375771085421243, "vf_loss": 6.610745112101237, "vf_explained_var": -3.814697265625e-06, "kl": 0.0004564173076857969, "entropy": 0.5312701304753621, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 255.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.106999999999828, "episode_len_mean": 254.58, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.299999999999592, 37.10000000000003, 36.900000000000034, 17.899999999999814, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 11.899999999999729, 43.30000000000001, -50.00000000000044, 44.900000000000006, -50.00000000000044, 33.70000000000004, 44.5, -50.00000000000044, -50.00000000000044, 45.1, 42.70000000000001, 41.70000000000002, -50.00000000000044, 41.90000000000001, 46.699999999999996, -50.00000000000044, 18.699999999999825, -50.00000000000044, 43.10000000000001, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 46.699999999999996, -50.00000000000044, 18.699999999999825, 43.50000000000001, 9.699999999999697, 45.5, 45.7, 37.300000000000026, -50.00000000000044, 41.100000000000016, 43.10000000000001, 44.300000000000004, -50.00000000000044, 44.900000000000006, 44.300000000000004, 13.499999999999751, 40.30000000000002, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 45.9, 43.7, 23.8999999999999, -50.00000000000044, 41.100000000000016, 46.9, -50.00000000000044, 41.500000000000014, 33.70000000000004, 45.9, -50.00000000000044, 47.1, 14.699999999999768, -50.00000000000044, 42.500000000000014, -50.00000000000044, 20.099999999999845, 44.10000000000001, 43.7, 44.7, 43.900000000000006, 36.10000000000004, 38.50000000000003, 44.7, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, 41.30000000000001, -50.00000000000044, 44.10000000000001, 30.9, 35.30000000000004, 39.90000000000002, -50.00000000000044, 39.70000000000002, -50.00000000000044, 27.299999999999947, 43.900000000000006, -50.00000000000044, -50.00000000000044, 44.300000000000004, 39.90000000000002, 42.30000000000001, 45.7, -50.00000000000044], "episode_lengths": [478, 130, 132, 322, 500, 500, 500, 500, 382, 68, 500, 52, 500, 164, 56, 500, 500, 50, 74, 84, 500, 82, 34, 500, 314, 500, 70, 54, 500, 500, 500, 500, 54, 34, 500, 314, 66, 404, 46, 44, 128, 500, 90, 70, 58, 500, 52, 58, 366, 98, 500, 72, 500, 500, 42, 64, 262, 500, 90, 32, 500, 86, 164, 42, 500, 30, 354, 500, 76, 500, 300, 60, 64, 54, 62, 140, 116, 54, 500, 500, 100, 500, 88, 500, 60, 192, 148, 102, 500, 104, 500, 228, 62, 500, 500, 58, 102, 78, 44, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3796754597970758, "mean_inference_ms": 1.2051116967423807, "mean_action_processing_ms": 0.14238882220108867, "mean_env_wait_ms": 0.0831023937387104, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03499436378479004, "StateBufferConnector_ms": 0.008998870849609375, "ViewRequirementAgentConnector_ms": 0.1267082691192627}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.106999999999828, "episode_len_mean": 254.58, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [2.299999999999592, 37.10000000000003, 36.900000000000034, 17.899999999999814, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 11.899999999999729, 43.30000000000001, -50.00000000000044, 44.900000000000006, -50.00000000000044, 33.70000000000004, 44.5, -50.00000000000044, -50.00000000000044, 45.1, 42.70000000000001, 41.70000000000002, -50.00000000000044, 41.90000000000001, 46.699999999999996, -50.00000000000044, 18.699999999999825, -50.00000000000044, 43.10000000000001, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 46.699999999999996, -50.00000000000044, 18.699999999999825, 43.50000000000001, 9.699999999999697, 45.5, 45.7, 37.300000000000026, -50.00000000000044, 41.100000000000016, 43.10000000000001, 44.300000000000004, -50.00000000000044, 44.900000000000006, 44.300000000000004, 13.499999999999751, 40.30000000000002, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 45.9, 43.7, 23.8999999999999, -50.00000000000044, 41.100000000000016, 46.9, -50.00000000000044, 41.500000000000014, 33.70000000000004, 45.9, -50.00000000000044, 47.1, 14.699999999999768, -50.00000000000044, 42.500000000000014, -50.00000000000044, 20.099999999999845, 44.10000000000001, 43.7, 44.7, 43.900000000000006, 36.10000000000004, 38.50000000000003, 44.7, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, 41.30000000000001, -50.00000000000044, 44.10000000000001, 30.9, 35.30000000000004, 39.90000000000002, -50.00000000000044, 39.70000000000002, -50.00000000000044, 27.299999999999947, 43.900000000000006, -50.00000000000044, -50.00000000000044, 44.300000000000004, 39.90000000000002, 42.30000000000001, 45.7, -50.00000000000044], "episode_lengths": [478, 130, 132, 322, 500, 500, 500, 500, 382, 68, 500, 52, 500, 164, 56, 500, 500, 50, 74, 84, 500, 82, 34, 500, 314, 500, 70, 54, 500, 500, 500, 500, 54, 34, 500, 314, 66, 404, 46, 44, 128, 500, 90, 70, 58, 500, 52, 58, 366, 98, 500, 72, 500, 500, 42, 64, 262, 500, 90, 32, 500, 86, 164, 42, 500, 30, 354, 500, 76, 500, 300, 60, 64, 54, 62, 140, 116, 54, 500, 500, 100, 500, 88, 500, 60, 192, 148, 102, 500, 104, 500, 228, 62, 500, 500, 58, 102, 78, 44, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3796754597970758, "mean_inference_ms": 1.2051116967423807, "mean_action_processing_ms": 0.14238882220108867, "mean_env_wait_ms": 0.0831023937387104, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03499436378479004, "StateBufferConnector_ms": 0.008998870849609375, "ViewRequirementAgentConnector_ms": 0.1267082691192627}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5647.57904303992, "num_env_steps_trained_throughput_per_sec": 5647.57904303992, "timesteps_total": 108000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 2226.295, "sample_time_ms": 1917.409, "load_time_ms": 11.027, "load_throughput": 1088191.72, "learn_time_ms": 286.241, "learn_throughput": 41922.785, "synch_weights_time_ms": 9.95}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "done": false, "episodes_total": 376, "training_iteration": 9, "trial_id": "9f288_00017", "date": "2023-10-25_16-56-51", "timestamp": 1698249411, "time_this_iter_s": 2.1297988891601562, "time_total_s": 20.081498384475708, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 20.081498384475708, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 60.166666666666664, "ram_util_percent": 27.133333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.00039062500000000013, "cur_lr": 0.0003, "total_loss": 6.683180284500122, "policy_loss": -0.00012124671290318172, "vf_loss": 6.6833575884501135, "vf_explained_var": 1.8676122029622396e-07, "kl": 0.0004144264614221053, "entropy": 0.5617254833380382, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 285.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.207999999999844, "episode_len_mean": 248.58, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.499999999999751, 40.30000000000002, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 45.9, 43.7, 23.8999999999999, -50.00000000000044, 41.100000000000016, 46.9, -50.00000000000044, 41.500000000000014, 33.70000000000004, 45.9, -50.00000000000044, 47.1, 14.699999999999768, -50.00000000000044, 42.500000000000014, -50.00000000000044, 20.099999999999845, 44.10000000000001, 43.7, 44.7, 43.900000000000006, 36.10000000000004, 38.50000000000003, 44.7, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, 41.30000000000001, -50.00000000000044, 44.10000000000001, 30.9, 35.30000000000004, 39.90000000000002, -50.00000000000044, 39.70000000000002, -50.00000000000044, 27.299999999999947, 43.900000000000006, -50.00000000000044, -50.00000000000044, 44.300000000000004, 39.90000000000002, 42.30000000000001, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 39.300000000000026, 20.699999999999854, 43.30000000000001, 45.3, 30.499999999999993, 42.500000000000014, 46.099999999999994, 43.7, 30.29999999999999, -50.00000000000044, -50.00000000000044, 29.299999999999976, 41.100000000000016, 38.90000000000002, 37.300000000000026, 26.09999999999993, -50.00000000000044, 44.5, 37.90000000000003, 31.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, 41.90000000000001, 35.10000000000004, 47.1, 29.69999999999998, -50.00000000000044, 39.50000000000002, 45.9, 18.499999999999822, -50.00000000000044, 35.10000000000004, -50.00000000000044, 34.10000000000004, 37.90000000000003], "episode_lengths": [366, 98, 500, 72, 500, 500, 42, 64, 262, 500, 90, 32, 500, 86, 164, 42, 500, 30, 354, 500, 76, 500, 300, 60, 64, 54, 62, 140, 116, 54, 500, 500, 100, 500, 88, 500, 60, 192, 148, 102, 500, 104, 500, 228, 62, 500, 500, 58, 102, 78, 44, 500, 500, 500, 96, 36, 500, 500, 500, 52, 108, 294, 68, 48, 196, 76, 40, 64, 198, 500, 500, 208, 90, 112, 128, 240, 500, 56, 122, 188, 500, 500, 500, 500, 500, 500, 82, 82, 150, 30, 204, 500, 106, 42, 316, 500, 150, 500, 160, 122]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3792962021681352, "mean_inference_ms": 1.205559815706009, "mean_action_processing_ms": 0.14249887901269023, "mean_env_wait_ms": 0.08251888349732106, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03400063514709473, "StateBufferConnector_ms": 0.00599980354309082, "ViewRequirementAgentConnector_ms": 0.128004789352417}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.207999999999844, "episode_len_mean": 248.58, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [13.499999999999751, 40.30000000000002, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 45.9, 43.7, 23.8999999999999, -50.00000000000044, 41.100000000000016, 46.9, -50.00000000000044, 41.500000000000014, 33.70000000000004, 45.9, -50.00000000000044, 47.1, 14.699999999999768, -50.00000000000044, 42.500000000000014, -50.00000000000044, 20.099999999999845, 44.10000000000001, 43.7, 44.7, 43.900000000000006, 36.10000000000004, 38.50000000000003, 44.7, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, 41.30000000000001, -50.00000000000044, 44.10000000000001, 30.9, 35.30000000000004, 39.90000000000002, -50.00000000000044, 39.70000000000002, -50.00000000000044, 27.299999999999947, 43.900000000000006, -50.00000000000044, -50.00000000000044, 44.300000000000004, 39.90000000000002, 42.30000000000001, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 39.300000000000026, 20.699999999999854, 43.30000000000001, 45.3, 30.499999999999993, 42.500000000000014, 46.099999999999994, 43.7, 30.29999999999999, -50.00000000000044, -50.00000000000044, 29.299999999999976, 41.100000000000016, 38.90000000000002, 37.300000000000026, 26.09999999999993, -50.00000000000044, 44.5, 37.90000000000003, 31.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, 41.90000000000001, 35.10000000000004, 47.1, 29.69999999999998, -50.00000000000044, 39.50000000000002, 45.9, 18.499999999999822, -50.00000000000044, 35.10000000000004, -50.00000000000044, 34.10000000000004, 37.90000000000003], "episode_lengths": [366, 98, 500, 72, 500, 500, 42, 64, 262, 500, 90, 32, 500, 86, 164, 42, 500, 30, 354, 500, 76, 500, 300, 60, 64, 54, 62, 140, 116, 54, 500, 500, 100, 500, 88, 500, 60, 192, 148, 102, 500, 104, 500, 228, 62, 500, 500, 58, 102, 78, 44, 500, 500, 500, 96, 36, 500, 500, 500, 52, 108, 294, 68, 48, 196, 76, 40, 64, 198, 500, 500, 208, 90, 112, 128, 240, 500, 56, 122, 188, 500, 500, 500, 500, 500, 500, 82, 82, 150, 30, 204, 500, 106, 42, 316, 500, 150, 500, 160, 122]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3792962021681352, "mean_inference_ms": 1.205559815706009, "mean_action_processing_ms": 0.14249887901269023, "mean_env_wait_ms": 0.08251888349732106, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03400063514709473, "StateBufferConnector_ms": 0.00599980354309082, "ViewRequirementAgentConnector_ms": 0.128004789352417}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4857.064636023996, "num_env_steps_trained_throughput_per_sec": 4857.064636023996, "timesteps_total": 120000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 2250.728, "sample_time_ms": 1941.288, "load_time_ms": 11.012, "load_throughput": 1089762.2, "learn_time_ms": 286.791, "learn_throughput": 41842.308, "synch_weights_time_ms": 9.957}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "episodes_total": 424, "training_iteration": 10, "trial_id": "9f288_00017", "date": "2023-10-25_16-56-53", "timestamp": 1698249413, "time_this_iter_s": 2.475618839263916, "time_total_s": 22.557117223739624, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 22.557117223739624, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 59.833333333333336, "ram_util_percent": 27.166666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.00019531250000000007, "cur_lr": 0.0003, "total_loss": 7.164169184366862, "policy_loss": -0.0005632560700178146, "vf_loss": 7.164787340164184, "vf_explained_var": -1.237789789835612e-06, "kl": 0.001495682464340368, "entropy": 0.551462874809901, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 315.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.09899999999983, "episode_len_mean": 264.66, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [27.299999999999947, 43.900000000000006, -50.00000000000044, -50.00000000000044, 44.300000000000004, 39.90000000000002, 42.30000000000001, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 39.300000000000026, 20.699999999999854, 43.30000000000001, 45.3, 30.499999999999993, 42.500000000000014, 46.099999999999994, 43.7, 30.29999999999999, -50.00000000000044, -50.00000000000044, 29.299999999999976, 41.100000000000016, 38.90000000000002, 37.300000000000026, 26.09999999999993, -50.00000000000044, 44.5, 37.90000000000003, 31.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, 41.90000000000001, 35.10000000000004, 47.1, 29.69999999999998, -50.00000000000044, 39.50000000000002, 45.9, 18.499999999999822, -50.00000000000044, 35.10000000000004, -50.00000000000044, 34.10000000000004, 37.90000000000003, 38.90000000000002, 45.3, -50.00000000000044, 7.09999999999966, 34.10000000000004, -50.00000000000044, 43.10000000000001, 40.70000000000002, -50.00000000000044, -50.00000000000044, 35.70000000000003, -50.00000000000044, 19.299999999999834, 45.7, 31.500000000000007, 15.49999999999978, 28.699999999999967, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 44.300000000000004, 20.299999999999848, 44.10000000000001, 45.7, 44.900000000000006, 37.70000000000003, -50.00000000000044, -50.00000000000044, 41.100000000000016, 44.7, -50.00000000000044, 40.500000000000014, -50.00000000000044, 45.7, -50.00000000000044, 34.50000000000004, 23.499999999999893, 4.299999999999621, -50.00000000000044, 44.10000000000001, -50.00000000000044, 4.899999999999629], "episode_lengths": [228, 62, 500, 500, 58, 102, 78, 44, 500, 500, 500, 96, 36, 500, 500, 500, 52, 108, 294, 68, 48, 196, 76, 40, 64, 198, 500, 500, 208, 90, 112, 128, 240, 500, 56, 122, 188, 500, 500, 500, 500, 500, 500, 82, 82, 150, 30, 204, 500, 106, 42, 316, 500, 150, 500, 160, 122, 112, 48, 500, 430, 160, 500, 70, 94, 500, 500, 144, 500, 308, 44, 186, 346, 214, 500, 62, 500, 500, 58, 298, 60, 44, 52, 124, 500, 500, 90, 54, 500, 96, 500, 44, 500, 156, 266, 458, 500, 60, 500, 452]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37906661962180643, "mean_inference_ms": 1.205650031323576, "mean_action_processing_ms": 0.14276992823574802, "mean_env_wait_ms": 0.08256220348847144, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030805349349975586, "StateBufferConnector_ms": 0.0048444271087646484, "ViewRequirementAgentConnector_ms": 0.13370466232299805}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.09899999999983, "episode_len_mean": 264.66, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [27.299999999999947, 43.900000000000006, -50.00000000000044, -50.00000000000044, 44.300000000000004, 39.90000000000002, 42.30000000000001, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 39.300000000000026, 20.699999999999854, 43.30000000000001, 45.3, 30.499999999999993, 42.500000000000014, 46.099999999999994, 43.7, 30.29999999999999, -50.00000000000044, -50.00000000000044, 29.299999999999976, 41.100000000000016, 38.90000000000002, 37.300000000000026, 26.09999999999993, -50.00000000000044, 44.5, 37.90000000000003, 31.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, 41.90000000000001, 35.10000000000004, 47.1, 29.69999999999998, -50.00000000000044, 39.50000000000002, 45.9, 18.499999999999822, -50.00000000000044, 35.10000000000004, -50.00000000000044, 34.10000000000004, 37.90000000000003, 38.90000000000002, 45.3, -50.00000000000044, 7.09999999999966, 34.10000000000004, -50.00000000000044, 43.10000000000001, 40.70000000000002, -50.00000000000044, -50.00000000000044, 35.70000000000003, -50.00000000000044, 19.299999999999834, 45.7, 31.500000000000007, 15.49999999999978, 28.699999999999967, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 44.300000000000004, 20.299999999999848, 44.10000000000001, 45.7, 44.900000000000006, 37.70000000000003, -50.00000000000044, -50.00000000000044, 41.100000000000016, 44.7, -50.00000000000044, 40.500000000000014, -50.00000000000044, 45.7, -50.00000000000044, 34.50000000000004, 23.499999999999893, 4.299999999999621, -50.00000000000044, 44.10000000000001, -50.00000000000044, 4.899999999999629], "episode_lengths": [228, 62, 500, 500, 58, 102, 78, 44, 500, 500, 500, 96, 36, 500, 500, 500, 52, 108, 294, 68, 48, 196, 76, 40, 64, 198, 500, 500, 208, 90, 112, 128, 240, 500, 56, 122, 188, 500, 500, 500, 500, 500, 500, 82, 82, 150, 30, 204, 500, 106, 42, 316, 500, 150, 500, 160, 122, 112, 48, 500, 430, 160, 500, 70, 94, 500, 500, 144, 500, 308, 44, 186, 346, 214, 500, 62, 500, 500, 58, 298, 60, 44, 52, 124, 500, 500, 90, 54, 500, 96, 500, 44, 500, 156, 266, 458, 500, 60, 500, 452]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37906661962180643, "mean_inference_ms": 1.205650031323576, "mean_action_processing_ms": 0.14276992823574802, "mean_env_wait_ms": 0.08256220348847144, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030805349349975586, "StateBufferConnector_ms": 0.0048444271087646484, "ViewRequirementAgentConnector_ms": 0.13370466232299805}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5172.245977099611, "num_env_steps_trained_throughput_per_sec": 5172.245977099611, "timesteps_total": 132000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 132000, "timers": {"training_iteration_time_ms": 2272.355, "sample_time_ms": 1947.117, "load_time_ms": 11.694, "load_throughput": 1026164.984, "learn_time_ms": 301.933, "learn_throughput": 39743.951, "synch_weights_time_ms": 9.931}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "done": false, "episodes_total": 467, "training_iteration": 11, "trial_id": "9f288_00017", "date": "2023-10-25_16-56-55", "timestamp": 1698249415, "time_this_iter_s": 2.325072765350342, "time_total_s": 24.882189989089966, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 24.882189989089966, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 47.974999999999994, "ram_util_percent": 27.150000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.765625000000003e-05, "cur_lr": 0.0003, "total_loss": 6.742800076802571, "policy_loss": -0.0006055635710557302, "vf_loss": 6.743457778294881, "vf_explained_var": 3.159046173095703e-07, "kl": 0.0007623382662056126, "entropy": 0.5218631784121196, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 345.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "sampler_results": {"episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.43699999999984, "episode_len_mean": 251.32, "episode_media": {}, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.50000000000002, 45.9, 18.499999999999822, -50.00000000000044, 35.10000000000004, -50.00000000000044, 34.10000000000004, 37.90000000000003, 38.90000000000002, 45.3, -50.00000000000044, 7.09999999999966, 34.10000000000004, -50.00000000000044, 43.10000000000001, 40.70000000000002, -50.00000000000044, -50.00000000000044, 35.70000000000003, -50.00000000000044, 19.299999999999834, 45.7, 31.500000000000007, 15.49999999999978, 28.699999999999967, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 44.300000000000004, 20.299999999999848, 44.10000000000001, 45.7, 44.900000000000006, 37.70000000000003, -50.00000000000044, -50.00000000000044, 41.100000000000016, 44.7, -50.00000000000044, 40.500000000000014, -50.00000000000044, 45.7, -50.00000000000044, 34.50000000000004, 23.499999999999893, 4.299999999999621, -50.00000000000044, 44.10000000000001, -50.00000000000044, 4.899999999999629, 44.10000000000001, 34.30000000000004, 44.7, 37.70000000000003, -50.00000000000044, 43.900000000000006, 15.899999999999785, 46.099999999999994, 43.900000000000006, -50.00000000000044, -50.00000000000044, 19.499999999999837, 44.300000000000004, -50.00000000000044, 44.7, 34.50000000000004, 42.70000000000001, 43.900000000000006, -50.00000000000044, 43.30000000000001, -50.00000000000044, 29.69999999999998, 43.900000000000006, 40.10000000000002, 44.10000000000001, 3.699999999999612, 32.30000000000002, -50.00000000000044, 41.500000000000014, 33.90000000000004, 11.099999999999717, 46.099999999999994, 46.099999999999994, 46.099999999999994, -50.00000000000044, 45.7, 41.100000000000016, 29.49999999999998, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 42.70000000000001, 41.500000000000014, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 39.300000000000026], "episode_lengths": [106, 42, 316, 500, 150, 500, 160, 122, 112, 48, 500, 430, 160, 500, 70, 94, 500, 500, 144, 500, 308, 44, 186, 346, 214, 500, 62, 500, 500, 58, 298, 60, 44, 52, 124, 500, 500, 90, 54, 500, 96, 500, 44, 500, 156, 266, 458, 500, 60, 500, 452, 60, 158, 54, 124, 500, 62, 342, 40, 62, 500, 500, 306, 58, 500, 54, 156, 74, 62, 500, 68, 500, 204, 62, 100, 60, 464, 178, 500, 86, 162, 390, 40, 40, 40, 500, 44, 90, 206, 500, 500, 38, 500, 74, 86, 500, 500, 54, 500, 108]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3791231245536114, "mean_inference_ms": 1.2073404897968616, "mean_action_processing_ms": 0.14239925585965685, "mean_env_wait_ms": 0.08303748551257631, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028397798538208008, "StateBufferConnector_ms": 0.008841991424560547, "ViewRequirementAgentConnector_ms": 0.1390993595123291}}, "episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.43699999999984, "episode_len_mean": 251.32, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [39.50000000000002, 45.9, 18.499999999999822, -50.00000000000044, 35.10000000000004, -50.00000000000044, 34.10000000000004, 37.90000000000003, 38.90000000000002, 45.3, -50.00000000000044, 7.09999999999966, 34.10000000000004, -50.00000000000044, 43.10000000000001, 40.70000000000002, -50.00000000000044, -50.00000000000044, 35.70000000000003, -50.00000000000044, 19.299999999999834, 45.7, 31.500000000000007, 15.49999999999978, 28.699999999999967, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 44.300000000000004, 20.299999999999848, 44.10000000000001, 45.7, 44.900000000000006, 37.70000000000003, -50.00000000000044, -50.00000000000044, 41.100000000000016, 44.7, -50.00000000000044, 40.500000000000014, -50.00000000000044, 45.7, -50.00000000000044, 34.50000000000004, 23.499999999999893, 4.299999999999621, -50.00000000000044, 44.10000000000001, -50.00000000000044, 4.899999999999629, 44.10000000000001, 34.30000000000004, 44.7, 37.70000000000003, -50.00000000000044, 43.900000000000006, 15.899999999999785, 46.099999999999994, 43.900000000000006, -50.00000000000044, -50.00000000000044, 19.499999999999837, 44.300000000000004, -50.00000000000044, 44.7, 34.50000000000004, 42.70000000000001, 43.900000000000006, -50.00000000000044, 43.30000000000001, -50.00000000000044, 29.69999999999998, 43.900000000000006, 40.10000000000002, 44.10000000000001, 3.699999999999612, 32.30000000000002, -50.00000000000044, 41.500000000000014, 33.90000000000004, 11.099999999999717, 46.099999999999994, 46.099999999999994, 46.099999999999994, -50.00000000000044, 45.7, 41.100000000000016, 29.49999999999998, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 42.70000000000001, 41.500000000000014, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 39.300000000000026], "episode_lengths": [106, 42, 316, 500, 150, 500, 160, 122, 112, 48, 500, 430, 160, 500, 70, 94, 500, 500, 144, 500, 308, 44, 186, 346, 214, 500, 62, 500, 500, 58, 298, 60, 44, 52, 124, 500, 500, 90, 54, 500, 96, 500, 44, 500, 156, 266, 458, 500, 60, 500, 452, 60, 158, 54, 124, 500, 62, 342, 40, 62, 500, 500, 306, 58, 500, 54, 156, 74, 62, 500, 68, 500, 204, 62, 100, 60, 464, 178, 500, 86, 162, 390, 40, 40, 40, 500, 44, 90, 206, 500, 500, 38, 500, 74, 86, 500, 500, 54, 500, 108]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3791231245536114, "mean_inference_ms": 1.2073404897968616, "mean_action_processing_ms": 0.14239925585965685, "mean_env_wait_ms": 0.08303748551257631, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028397798538208008, "StateBufferConnector_ms": 0.008841991424560547, "ViewRequirementAgentConnector_ms": 0.1390993595123291}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5392.747254937234, "num_env_steps_trained_throughput_per_sec": 5392.747254937234, "timesteps_total": 144000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 2280.085, "sample_time_ms": 1943.694, "load_time_ms": 11.915, "load_throughput": 1007154.666, "learn_time_ms": 312.925, "learn_throughput": 38347.89, "synch_weights_time_ms": 9.972}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "episodes_total": 516, "training_iteration": 12, "trial_id": "9f288_00017", "date": "2023-10-25_16-56-58", "timestamp": 1698249418, "time_this_iter_s": 2.2302095890045166, "time_total_s": 27.112399578094482, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 27.112399578094482, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 60.199999999999996, "ram_util_percent": 27.133333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.8828125000000016e-05, "cur_lr": 0.0003, "total_loss": 6.887252871195475, "policy_loss": -0.0005493178963661194, "vf_loss": 6.887857437133789, "vf_explained_var": -1.6609827677408854e-06, "kl": 0.0013114272384882498, "entropy": 0.5532730023066202, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 375.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.615999999999838, "episode_len_mean": 254.52, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [23.499999999999893, 4.299999999999621, -50.00000000000044, 44.10000000000001, -50.00000000000044, 4.899999999999629, 44.10000000000001, 34.30000000000004, 44.7, 37.70000000000003, -50.00000000000044, 43.900000000000006, 15.899999999999785, 46.099999999999994, 43.900000000000006, -50.00000000000044, -50.00000000000044, 19.499999999999837, 44.300000000000004, -50.00000000000044, 44.7, 34.50000000000004, 42.70000000000001, 43.900000000000006, -50.00000000000044, 43.30000000000001, -50.00000000000044, 29.69999999999998, 43.900000000000006, 40.10000000000002, 44.10000000000001, 3.699999999999612, 32.30000000000002, -50.00000000000044, 41.500000000000014, 33.90000000000004, 11.099999999999717, 46.099999999999994, 46.099999999999994, 46.099999999999994, -50.00000000000044, 45.7, 41.100000000000016, 29.49999999999998, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 42.70000000000001, 41.500000000000014, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 39.300000000000026, 32.700000000000024, 26.299999999999933, 46.5, 27.899999999999956, 45.5, -50.00000000000044, 17.099999999999802, 36.30000000000003, -50.00000000000044, 41.70000000000002, 33.90000000000004, 42.500000000000014, -50.00000000000044, 46.699999999999996, 36.70000000000003, 43.30000000000001, 43.50000000000001, 40.10000000000002, 36.70000000000003, 22.699999999999882, -50.00000000000044, 43.7, 39.50000000000002, -50.00000000000044, -50.00000000000044, 3.0999999999996035, 36.50000000000003, 37.300000000000026, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 36.900000000000034, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.299999999999933, -50.00000000000044, 35.10000000000004, 43.7, -50.00000000000044], "episode_lengths": [266, 458, 500, 60, 500, 452, 60, 158, 54, 124, 500, 62, 342, 40, 62, 500, 500, 306, 58, 500, 54, 156, 74, 62, 500, 68, 500, 204, 62, 100, 60, 464, 178, 500, 86, 162, 390, 40, 40, 40, 500, 44, 90, 206, 500, 500, 38, 500, 74, 86, 500, 500, 54, 500, 108, 174, 238, 36, 222, 46, 500, 330, 138, 500, 84, 162, 76, 500, 34, 134, 68, 66, 100, 134, 274, 500, 64, 106, 500, 500, 470, 136, 128, 56, 500, 500, 500, 78, 132, 500, 72, 500, 500, 500, 500, 238, 500, 150, 64, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.378943511681952, "mean_inference_ms": 1.2072363703667175, "mean_action_processing_ms": 0.14227988048672516, "mean_env_wait_ms": 0.08286630952462161, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03148150444030762, "StateBufferConnector_ms": 0.0069959163665771484, "ViewRequirementAgentConnector_ms": 0.1330103874206543}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.615999999999838, "episode_len_mean": 254.52, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [23.499999999999893, 4.299999999999621, -50.00000000000044, 44.10000000000001, -50.00000000000044, 4.899999999999629, 44.10000000000001, 34.30000000000004, 44.7, 37.70000000000003, -50.00000000000044, 43.900000000000006, 15.899999999999785, 46.099999999999994, 43.900000000000006, -50.00000000000044, -50.00000000000044, 19.499999999999837, 44.300000000000004, -50.00000000000044, 44.7, 34.50000000000004, 42.70000000000001, 43.900000000000006, -50.00000000000044, 43.30000000000001, -50.00000000000044, 29.69999999999998, 43.900000000000006, 40.10000000000002, 44.10000000000001, 3.699999999999612, 32.30000000000002, -50.00000000000044, 41.500000000000014, 33.90000000000004, 11.099999999999717, 46.099999999999994, 46.099999999999994, 46.099999999999994, -50.00000000000044, 45.7, 41.100000000000016, 29.49999999999998, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 42.70000000000001, 41.500000000000014, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 39.300000000000026, 32.700000000000024, 26.299999999999933, 46.5, 27.899999999999956, 45.5, -50.00000000000044, 17.099999999999802, 36.30000000000003, -50.00000000000044, 41.70000000000002, 33.90000000000004, 42.500000000000014, -50.00000000000044, 46.699999999999996, 36.70000000000003, 43.30000000000001, 43.50000000000001, 40.10000000000002, 36.70000000000003, 22.699999999999882, -50.00000000000044, 43.7, 39.50000000000002, -50.00000000000044, -50.00000000000044, 3.0999999999996035, 36.50000000000003, 37.300000000000026, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 36.900000000000034, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.299999999999933, -50.00000000000044, 35.10000000000004, 43.7, -50.00000000000044], "episode_lengths": [266, 458, 500, 60, 500, 452, 60, 158, 54, 124, 500, 62, 342, 40, 62, 500, 500, 306, 58, 500, 54, 156, 74, 62, 500, 68, 500, 204, 62, 100, 60, 464, 178, 500, 86, 162, 390, 40, 40, 40, 500, 44, 90, 206, 500, 500, 38, 500, 74, 86, 500, 500, 54, 500, 108, 174, 238, 36, 222, 46, 500, 330, 138, 500, 84, 162, 76, 500, 34, 134, 68, 66, 100, 134, 274, 500, 64, 106, 500, 500, 470, 136, 128, 56, 500, 500, 500, 78, 132, 500, 72, 500, 500, 500, 500, 238, 500, 150, 64, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.378943511681952, "mean_inference_ms": 1.2072363703667175, "mean_action_processing_ms": 0.14227988048672516, "mean_env_wait_ms": 0.08286630952462161, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03148150444030762, "StateBufferConnector_ms": 0.0069959163665771484, "ViewRequirementAgentConnector_ms": 0.1330103874206543}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5118.342203615691, "num_env_steps_trained_throughput_per_sec": 5118.342203615691, "timesteps_total": 156000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 156000, "timers": {"training_iteration_time_ms": 2289.249, "sample_time_ms": 1944.498, "load_time_ms": 12.66, "load_throughput": 947861.741, "learn_time_ms": 320.683, "learn_throughput": 37420.176, "synch_weights_time_ms": 9.928}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "done": false, "episodes_total": 561, "training_iteration": 13, "trial_id": "9f288_00017", "date": "2023-10-25_16-57-00", "timestamp": 1698249420, "time_this_iter_s": 2.3495070934295654, "time_total_s": 29.461906671524048, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 29.461906671524048, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 60.666666666666664, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.4414062500000008e-05, "cur_lr": 0.0003, "total_loss": 7.205238342285156, "policy_loss": -0.00017129083474477132, "vf_loss": 7.205466349919637, "vf_explained_var": -4.6292940775553385e-07, "kl": 0.0005707026311256413, "entropy": 0.5678548981746038, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 405.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.338999999999839, "episode_len_mean": 252.28, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 39.300000000000026, 32.700000000000024, 26.299999999999933, 46.5, 27.899999999999956, 45.5, -50.00000000000044, 17.099999999999802, 36.30000000000003, -50.00000000000044, 41.70000000000002, 33.90000000000004, 42.500000000000014, -50.00000000000044, 46.699999999999996, 36.70000000000003, 43.30000000000001, 43.50000000000001, 40.10000000000002, 36.70000000000003, 22.699999999999882, -50.00000000000044, 43.7, 39.50000000000002, -50.00000000000044, -50.00000000000044, 3.0999999999996035, 36.50000000000003, 37.300000000000026, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 36.900000000000034, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.299999999999933, -50.00000000000044, 35.10000000000004, 43.7, -50.00000000000044, 3.499999999999609, 24.69999999999991, -50.00000000000044, 42.900000000000006, -50.00000000000044, 42.70000000000001, 42.70000000000001, -50.00000000000044, 41.100000000000016, -50.00000000000044, 37.300000000000026, 1.8999999999995865, 34.50000000000004, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 10.499999999999709, -50.00000000000044, -50.00000000000044, 42.900000000000006, 44.900000000000006, 43.30000000000001, -50.00000000000044, 41.70000000000002, 30.699999999999996, -50.00000000000044, 46.9, -50.00000000000044, 36.50000000000003, 44.10000000000001, 46.099999999999994, 45.5, -50.00000000000044, 45.1, -50.00000000000044, 25.099999999999916, 42.30000000000001, 40.30000000000002, -50.00000000000044, 37.300000000000026, 43.30000000000001, 39.300000000000026, 44.7, 42.900000000000006, 43.50000000000001, 44.900000000000006, 39.10000000000002, 46.5, 42.500000000000014, -50.00000000000044, 41.30000000000001, 25.899999999999928], "episode_lengths": [500, 108, 174, 238, 36, 222, 46, 500, 330, 138, 500, 84, 162, 76, 500, 34, 134, 68, 66, 100, 134, 274, 500, 64, 106, 500, 500, 470, 136, 128, 56, 500, 500, 500, 78, 132, 500, 72, 500, 500, 500, 500, 238, 500, 150, 64, 500, 466, 254, 500, 72, 500, 74, 74, 500, 90, 500, 128, 482, 156, 58, 500, 500, 500, 396, 500, 500, 72, 52, 68, 500, 84, 194, 500, 32, 500, 136, 60, 40, 46, 500, 50, 500, 250, 78, 98, 500, 128, 68, 108, 54, 72, 66, 52, 110, 36, 76, 500, 88, 242]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3788302759067363, "mean_inference_ms": 1.2090900999366079, "mean_action_processing_ms": 0.14221563036434184, "mean_env_wait_ms": 0.08273905531370064, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03142428398132324, "StateBufferConnector_ms": 0.006018877029418945, "ViewRequirementAgentConnector_ms": 0.13115859031677246}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.338999999999839, "episode_len_mean": 252.28, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 39.300000000000026, 32.700000000000024, 26.299999999999933, 46.5, 27.899999999999956, 45.5, -50.00000000000044, 17.099999999999802, 36.30000000000003, -50.00000000000044, 41.70000000000002, 33.90000000000004, 42.500000000000014, -50.00000000000044, 46.699999999999996, 36.70000000000003, 43.30000000000001, 43.50000000000001, 40.10000000000002, 36.70000000000003, 22.699999999999882, -50.00000000000044, 43.7, 39.50000000000002, -50.00000000000044, -50.00000000000044, 3.0999999999996035, 36.50000000000003, 37.300000000000026, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 36.900000000000034, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.299999999999933, -50.00000000000044, 35.10000000000004, 43.7, -50.00000000000044, 3.499999999999609, 24.69999999999991, -50.00000000000044, 42.900000000000006, -50.00000000000044, 42.70000000000001, 42.70000000000001, -50.00000000000044, 41.100000000000016, -50.00000000000044, 37.300000000000026, 1.8999999999995865, 34.50000000000004, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 10.499999999999709, -50.00000000000044, -50.00000000000044, 42.900000000000006, 44.900000000000006, 43.30000000000001, -50.00000000000044, 41.70000000000002, 30.699999999999996, -50.00000000000044, 46.9, -50.00000000000044, 36.50000000000003, 44.10000000000001, 46.099999999999994, 45.5, -50.00000000000044, 45.1, -50.00000000000044, 25.099999999999916, 42.30000000000001, 40.30000000000002, -50.00000000000044, 37.300000000000026, 43.30000000000001, 39.300000000000026, 44.7, 42.900000000000006, 43.50000000000001, 44.900000000000006, 39.10000000000002, 46.5, 42.500000000000014, -50.00000000000044, 41.30000000000001, 25.899999999999928], "episode_lengths": [500, 108, 174, 238, 36, 222, 46, 500, 330, 138, 500, 84, 162, 76, 500, 34, 134, 68, 66, 100, 134, 274, 500, 64, 106, 500, 500, 470, 136, 128, 56, 500, 500, 500, 78, 132, 500, 72, 500, 500, 500, 500, 238, 500, 150, 64, 500, 466, 254, 500, 72, 500, 74, 74, 500, 90, 500, 128, 482, 156, 58, 500, 500, 500, 396, 500, 500, 72, 52, 68, 500, 84, 194, 500, 32, 500, 136, 60, 40, 46, 500, 50, 500, 250, 78, 98, 500, 128, 68, 108, 54, 72, 66, 52, 110, 36, 76, 500, 88, 242]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3788302759067363, "mean_inference_ms": 1.2090900999366079, "mean_action_processing_ms": 0.14221563036434184, "mean_env_wait_ms": 0.08273905531370064, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03142428398132324, "StateBufferConnector_ms": 0.006018877029418945, "ViewRequirementAgentConnector_ms": 0.13115859031677246}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5297.047831838709, "num_env_steps_trained_throughput_per_sec": 5297.047831838709, "timesteps_total": 168000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 168000, "timers": {"training_iteration_time_ms": 2282.99, "sample_time_ms": 1947.31, "load_time_ms": 12.089, "load_throughput": 992613.29, "learn_time_ms": 312.165, "learn_throughput": 38441.174, "synch_weights_time_ms": 9.846}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "done": false, "episodes_total": 614, "training_iteration": 14, "trial_id": "9f288_00017", "date": "2023-10-25_16-57-02", "timestamp": 1698249422, "time_this_iter_s": 2.270413398742676, "time_total_s": 31.732320070266724, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 31.732320070266724, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 56.666666666666664, "ram_util_percent": 27.133333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.2207031250000004e-05, "cur_lr": 0.0003, "total_loss": 6.484291887283325, "policy_loss": -0.0003616991142431895, "vf_loss": 6.484705781936645, "vf_explained_var": -5.960464477539063e-08, "kl": 0.0014539293743079421, "entropy": 0.5220083226760228, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 435.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.702999999999856, "episode_len_mean": 228.7, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [24.69999999999991, -50.00000000000044, 42.900000000000006, -50.00000000000044, 42.70000000000001, 42.70000000000001, -50.00000000000044, 41.100000000000016, -50.00000000000044, 37.300000000000026, 1.8999999999995865, 34.50000000000004, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 10.499999999999709, -50.00000000000044, -50.00000000000044, 42.900000000000006, 44.900000000000006, 43.30000000000001, -50.00000000000044, 41.70000000000002, 30.699999999999996, -50.00000000000044, 46.9, -50.00000000000044, 36.50000000000003, 44.10000000000001, 46.099999999999994, 45.5, -50.00000000000044, 45.1, -50.00000000000044, 25.099999999999916, 42.30000000000001, 40.30000000000002, -50.00000000000044, 37.300000000000026, 43.30000000000001, 39.300000000000026, 44.7, 42.900000000000006, 43.50000000000001, 44.900000000000006, 39.10000000000002, 46.5, 42.500000000000014, -50.00000000000044, 41.30000000000001, 25.899999999999928, 35.30000000000004, 44.5, 38.700000000000024, 41.100000000000016, 40.90000000000002, 43.900000000000006, 46.3, 41.30000000000001, -50.00000000000044, 46.099999999999994, 45.3, 46.5, 41.500000000000014, 44.300000000000004, 40.10000000000002, -50.00000000000044, 15.49999999999978, 39.50000000000002, -50.00000000000044, 39.50000000000002, -50.00000000000044, -50.00000000000044, 44.300000000000004, 1.299999999999578, -50.00000000000044, 21.89999999999987, 44.7, -50.00000000000044, 39.70000000000002, -50.00000000000044, 39.70000000000002, 45.3, 0.6999999999995694, -50.00000000000044, 9.499999999999694, 39.90000000000002, 46.5, 41.100000000000016, 41.70000000000002, 33.90000000000004, 0.2999999999995637, 43.50000000000001, 40.30000000000002, 17.099999999999802, -50.00000000000044, -50.00000000000044, 42.70000000000001, 46.699999999999996], "episode_lengths": [254, 500, 72, 500, 74, 74, 500, 90, 500, 128, 482, 156, 58, 500, 500, 500, 396, 500, 500, 72, 52, 68, 500, 84, 194, 500, 32, 500, 136, 60, 40, 46, 500, 50, 500, 250, 78, 98, 500, 128, 68, 108, 54, 72, 66, 52, 110, 36, 76, 500, 88, 242, 148, 56, 114, 90, 92, 62, 38, 88, 500, 40, 48, 36, 86, 58, 100, 500, 346, 106, 500, 106, 500, 500, 58, 488, 500, 282, 54, 500, 104, 500, 104, 48, 494, 500, 406, 102, 36, 90, 84, 162, 498, 66, 98, 330, 500, 500, 74, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3793085239953781, "mean_inference_ms": 1.2104139053569225, "mean_action_processing_ms": 0.14133435250566034, "mean_env_wait_ms": 0.08289737349797532, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02751302719116211, "StateBufferConnector_ms": 0.0040209293365478516, "ViewRequirementAgentConnector_ms": 0.12144804000854492}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.702999999999856, "episode_len_mean": 228.7, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [24.69999999999991, -50.00000000000044, 42.900000000000006, -50.00000000000044, 42.70000000000001, 42.70000000000001, -50.00000000000044, 41.100000000000016, -50.00000000000044, 37.300000000000026, 1.8999999999995865, 34.50000000000004, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 10.499999999999709, -50.00000000000044, -50.00000000000044, 42.900000000000006, 44.900000000000006, 43.30000000000001, -50.00000000000044, 41.70000000000002, 30.699999999999996, -50.00000000000044, 46.9, -50.00000000000044, 36.50000000000003, 44.10000000000001, 46.099999999999994, 45.5, -50.00000000000044, 45.1, -50.00000000000044, 25.099999999999916, 42.30000000000001, 40.30000000000002, -50.00000000000044, 37.300000000000026, 43.30000000000001, 39.300000000000026, 44.7, 42.900000000000006, 43.50000000000001, 44.900000000000006, 39.10000000000002, 46.5, 42.500000000000014, -50.00000000000044, 41.30000000000001, 25.899999999999928, 35.30000000000004, 44.5, 38.700000000000024, 41.100000000000016, 40.90000000000002, 43.900000000000006, 46.3, 41.30000000000001, -50.00000000000044, 46.099999999999994, 45.3, 46.5, 41.500000000000014, 44.300000000000004, 40.10000000000002, -50.00000000000044, 15.49999999999978, 39.50000000000002, -50.00000000000044, 39.50000000000002, -50.00000000000044, -50.00000000000044, 44.300000000000004, 1.299999999999578, -50.00000000000044, 21.89999999999987, 44.7, -50.00000000000044, 39.70000000000002, -50.00000000000044, 39.70000000000002, 45.3, 0.6999999999995694, -50.00000000000044, 9.499999999999694, 39.90000000000002, 46.5, 41.100000000000016, 41.70000000000002, 33.90000000000004, 0.2999999999995637, 43.50000000000001, 40.30000000000002, 17.099999999999802, -50.00000000000044, -50.00000000000044, 42.70000000000001, 46.699999999999996], "episode_lengths": [254, 500, 72, 500, 74, 74, 500, 90, 500, 128, 482, 156, 58, 500, 500, 500, 396, 500, 500, 72, 52, 68, 500, 84, 194, 500, 32, 500, 136, 60, 40, 46, 500, 50, 500, 250, 78, 98, 500, 128, 68, 108, 54, 72, 66, 52, 110, 36, 76, 500, 88, 242, 148, 56, 114, 90, 92, 62, 38, 88, 500, 40, 48, 36, 86, 58, 100, 500, 346, 106, 500, 106, 500, 500, 58, 488, 500, 282, 54, 500, 104, 500, 104, 48, 494, 500, 406, 102, 36, 90, 84, 162, 498, 66, 98, 330, 500, 500, 74, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3793085239953781, "mean_inference_ms": 1.2104139053569225, "mean_action_processing_ms": 0.14133435250566034, "mean_env_wait_ms": 0.08289737349797532, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02751302719116211, "StateBufferConnector_ms": 0.0040209293365478516, "ViewRequirementAgentConnector_ms": 0.12144804000854492}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5229.649531440615, "num_env_steps_trained_throughput_per_sec": 5229.649531440615, "timesteps_total": 180000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 180000, "timers": {"training_iteration_time_ms": 2286.847, "sample_time_ms": 1945.879, "load_time_ms": 12.556, "load_throughput": 955708.964, "learn_time_ms": 317.187, "learn_throughput": 37832.62, "synch_weights_time_ms": 9.746}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "done": false, "episodes_total": 662, "training_iteration": 15, "trial_id": "9f288_00017", "date": "2023-10-25_16-57-05", "timestamp": 1698249425, "time_this_iter_s": 2.2996013164520264, "time_total_s": 34.03192138671875, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 34.03192138671875, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 50.64999999999999, "ram_util_percent": 27.175}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.103515625000002e-06, "cur_lr": 0.0003, "total_loss": 6.070504188537598, "policy_loss": -0.00018406038482983908, "vf_loss": 6.070740604400635, "vf_explained_var": -1.5974044799804688e-06, "kl": 0.00045848661528419634, "entropy": 0.524800447622935, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 465.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.707999999999851, "episode_len_mean": 233.64, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.50000000000001, 44.900000000000006, 39.10000000000002, 46.5, 42.500000000000014, -50.00000000000044, 41.30000000000001, 25.899999999999928, 35.30000000000004, 44.5, 38.700000000000024, 41.100000000000016, 40.90000000000002, 43.900000000000006, 46.3, 41.30000000000001, -50.00000000000044, 46.099999999999994, 45.3, 46.5, 41.500000000000014, 44.300000000000004, 40.10000000000002, -50.00000000000044, 15.49999999999978, 39.50000000000002, -50.00000000000044, 39.50000000000002, -50.00000000000044, -50.00000000000044, 44.300000000000004, 1.299999999999578, -50.00000000000044, 21.89999999999987, 44.7, -50.00000000000044, 39.70000000000002, -50.00000000000044, 39.70000000000002, 45.3, 0.6999999999995694, -50.00000000000044, 9.499999999999694, 39.90000000000002, 46.5, 41.100000000000016, 41.70000000000002, 33.90000000000004, 0.2999999999995637, 43.50000000000001, 40.30000000000002, 17.099999999999802, -50.00000000000044, -50.00000000000044, 42.70000000000001, 46.699999999999996, -50.00000000000044, 44.900000000000006, -50.00000000000044, 37.90000000000003, 45.5, -50.00000000000044, 32.700000000000024, -50.00000000000044, -50.00000000000044, 46.3, 43.50000000000001, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.899999999999842, 41.90000000000001, -50.00000000000044, -50.00000000000044, 20.899999999999856, 10.899999999999714, -50.00000000000044, 30.9, 36.70000000000003, 43.7, 24.299999999999905, -50.00000000000044, 24.099999999999902, -50.00000000000044, 37.90000000000003, 42.70000000000001, 41.90000000000001, 43.7, 45.1, 33.500000000000036, 46.099999999999994, 40.30000000000002, -50.00000000000044, 36.30000000000003, 46.099999999999994, 44.7, 46.3, -50.00000000000044], "episode_lengths": [66, 52, 110, 36, 76, 500, 88, 242, 148, 56, 114, 90, 92, 62, 38, 88, 500, 40, 48, 36, 86, 58, 100, 500, 346, 106, 500, 106, 500, 500, 58, 488, 500, 282, 54, 500, 104, 500, 104, 48, 494, 500, 406, 102, 36, 90, 84, 162, 498, 66, 98, 330, 500, 500, 74, 34, 500, 52, 500, 122, 46, 500, 174, 500, 500, 38, 66, 500, 28, 500, 500, 500, 302, 82, 500, 500, 292, 392, 500, 192, 134, 64, 258, 500, 260, 500, 122, 74, 82, 64, 50, 166, 40, 98, 500, 138, 40, 54, 38, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37968606585318354, "mean_inference_ms": 1.2086633061392325, "mean_action_processing_ms": 0.14095517023326873, "mean_env_wait_ms": 0.08336056770956604, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.032508134841918945, "StateBufferConnector_ms": 0.007020235061645508, "ViewRequirementAgentConnector_ms": 0.12450408935546875}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.707999999999851, "episode_len_mean": 233.64, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.50000000000001, 44.900000000000006, 39.10000000000002, 46.5, 42.500000000000014, -50.00000000000044, 41.30000000000001, 25.899999999999928, 35.30000000000004, 44.5, 38.700000000000024, 41.100000000000016, 40.90000000000002, 43.900000000000006, 46.3, 41.30000000000001, -50.00000000000044, 46.099999999999994, 45.3, 46.5, 41.500000000000014, 44.300000000000004, 40.10000000000002, -50.00000000000044, 15.49999999999978, 39.50000000000002, -50.00000000000044, 39.50000000000002, -50.00000000000044, -50.00000000000044, 44.300000000000004, 1.299999999999578, -50.00000000000044, 21.89999999999987, 44.7, -50.00000000000044, 39.70000000000002, -50.00000000000044, 39.70000000000002, 45.3, 0.6999999999995694, -50.00000000000044, 9.499999999999694, 39.90000000000002, 46.5, 41.100000000000016, 41.70000000000002, 33.90000000000004, 0.2999999999995637, 43.50000000000001, 40.30000000000002, 17.099999999999802, -50.00000000000044, -50.00000000000044, 42.70000000000001, 46.699999999999996, -50.00000000000044, 44.900000000000006, -50.00000000000044, 37.90000000000003, 45.5, -50.00000000000044, 32.700000000000024, -50.00000000000044, -50.00000000000044, 46.3, 43.50000000000001, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.899999999999842, 41.90000000000001, -50.00000000000044, -50.00000000000044, 20.899999999999856, 10.899999999999714, -50.00000000000044, 30.9, 36.70000000000003, 43.7, 24.299999999999905, -50.00000000000044, 24.099999999999902, -50.00000000000044, 37.90000000000003, 42.70000000000001, 41.90000000000001, 43.7, 45.1, 33.500000000000036, 46.099999999999994, 40.30000000000002, -50.00000000000044, 36.30000000000003, 46.099999999999994, 44.7, 46.3, -50.00000000000044], "episode_lengths": [66, 52, 110, 36, 76, 500, 88, 242, 148, 56, 114, 90, 92, 62, 38, 88, 500, 40, 48, 36, 86, 58, 100, 500, 346, 106, 500, 106, 500, 500, 58, 488, 500, 282, 54, 500, 104, 500, 104, 48, 494, 500, 406, 102, 36, 90, 84, 162, 498, 66, 98, 330, 500, 500, 74, 34, 500, 52, 500, 122, 46, 500, 174, 500, 500, 38, 66, 500, 28, 500, 500, 500, 302, 82, 500, 500, 292, 392, 500, 192, 134, 64, 258, 500, 260, 500, 122, 74, 82, 64, 50, 166, 40, 98, 500, 138, 40, 54, 38, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37968606585318354, "mean_inference_ms": 1.2086633061392325, "mean_action_processing_ms": 0.14095517023326873, "mean_env_wait_ms": 0.08336056770956604, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.032508134841918945, "StateBufferConnector_ms": 0.007020235061645508, "ViewRequirementAgentConnector_ms": 0.12450408935546875}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5503.51380141593, "num_env_steps_trained_throughput_per_sec": 5503.51380141593, "timesteps_total": 192000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 2277.163, "sample_time_ms": 1946.988, "load_time_ms": 11.577, "load_throughput": 1036562.671, "learn_time_ms": 307.343, "learn_throughput": 39044.358, "synch_weights_time_ms": 9.775}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "episodes_total": 706, "training_iteration": 16, "trial_id": "9f288_00017", "date": "2023-10-25_16-57-07", "timestamp": 1698249427, "time_this_iter_s": 2.1864259243011475, "time_total_s": 36.2183473110199, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 36.2183473110199, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 61.666666666666664, "ram_util_percent": 27.133333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.051757812500001e-06, "cur_lr": 0.0003, "total_loss": 6.5883145491282145, "policy_loss": 3.777138578395049e-05, "vf_loss": 6.588330094019572, "vf_explained_var": -8.344650268554688e-07, "kl": 0.00015386246795306608, "entropy": 0.5324807276328405, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 495.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.9909999999998185, "episode_len_mean": 265.72, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.2999999999995637, 43.50000000000001, 40.30000000000002, 17.099999999999802, -50.00000000000044, -50.00000000000044, 42.70000000000001, 46.699999999999996, -50.00000000000044, 44.900000000000006, -50.00000000000044, 37.90000000000003, 45.5, -50.00000000000044, 32.700000000000024, -50.00000000000044, -50.00000000000044, 46.3, 43.50000000000001, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.899999999999842, 41.90000000000001, -50.00000000000044, -50.00000000000044, 20.899999999999856, 10.899999999999714, -50.00000000000044, 30.9, 36.70000000000003, 43.7, 24.299999999999905, -50.00000000000044, 24.099999999999902, -50.00000000000044, 37.90000000000003, 42.70000000000001, 41.90000000000001, 43.7, 45.1, 33.500000000000036, 46.099999999999994, 40.30000000000002, -50.00000000000044, 36.30000000000003, 46.099999999999994, 44.7, 46.3, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 35.900000000000034, 42.30000000000001, -50.00000000000044, 35.30000000000004, -50.00000000000044, 43.50000000000001, 41.90000000000001, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.699999999999967, -50.00000000000044, 43.7, 43.50000000000001, 46.3, 17.299999999999805, 29.49999999999998, 41.100000000000016, -50.00000000000044, 44.5, 29.49999999999998, 44.7, 45.3, 44.10000000000001, 16.499999999999794, -50.00000000000044, -50.00000000000044, 46.5, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, 43.10000000000001, 44.900000000000006, 40.90000000000002, 2.699999999999598, -50.00000000000044, 39.10000000000002, -50.00000000000044, 35.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [498, 66, 98, 330, 500, 500, 74, 34, 500, 52, 500, 122, 46, 500, 174, 500, 500, 38, 66, 500, 28, 500, 500, 500, 302, 82, 500, 500, 292, 392, 500, 192, 134, 64, 258, 500, 260, 500, 122, 74, 82, 64, 50, 166, 40, 98, 500, 138, 40, 54, 38, 500, 500, 42, 500, 142, 78, 500, 148, 500, 66, 82, 30, 500, 500, 500, 214, 500, 64, 66, 38, 328, 206, 90, 500, 56, 206, 54, 48, 60, 336, 500, 500, 36, 52, 500, 500, 500, 118, 70, 52, 92, 474, 500, 110, 500, 146, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37837247169124916, "mean_inference_ms": 1.2082555470421275, "mean_action_processing_ms": 0.14154167273959284, "mean_env_wait_ms": 0.08326736790048843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0299985408782959, "StateBufferConnector_ms": 0.009002208709716797, "ViewRequirementAgentConnector_ms": 0.12700796127319336}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.9909999999998185, "episode_len_mean": 265.72, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.2999999999995637, 43.50000000000001, 40.30000000000002, 17.099999999999802, -50.00000000000044, -50.00000000000044, 42.70000000000001, 46.699999999999996, -50.00000000000044, 44.900000000000006, -50.00000000000044, 37.90000000000003, 45.5, -50.00000000000044, 32.700000000000024, -50.00000000000044, -50.00000000000044, 46.3, 43.50000000000001, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.899999999999842, 41.90000000000001, -50.00000000000044, -50.00000000000044, 20.899999999999856, 10.899999999999714, -50.00000000000044, 30.9, 36.70000000000003, 43.7, 24.299999999999905, -50.00000000000044, 24.099999999999902, -50.00000000000044, 37.90000000000003, 42.70000000000001, 41.90000000000001, 43.7, 45.1, 33.500000000000036, 46.099999999999994, 40.30000000000002, -50.00000000000044, 36.30000000000003, 46.099999999999994, 44.7, 46.3, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 35.900000000000034, 42.30000000000001, -50.00000000000044, 35.30000000000004, -50.00000000000044, 43.50000000000001, 41.90000000000001, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.699999999999967, -50.00000000000044, 43.7, 43.50000000000001, 46.3, 17.299999999999805, 29.49999999999998, 41.100000000000016, -50.00000000000044, 44.5, 29.49999999999998, 44.7, 45.3, 44.10000000000001, 16.499999999999794, -50.00000000000044, -50.00000000000044, 46.5, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, 43.10000000000001, 44.900000000000006, 40.90000000000002, 2.699999999999598, -50.00000000000044, 39.10000000000002, -50.00000000000044, 35.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [498, 66, 98, 330, 500, 500, 74, 34, 500, 52, 500, 122, 46, 500, 174, 500, 500, 38, 66, 500, 28, 500, 500, 500, 302, 82, 500, 500, 292, 392, 500, 192, 134, 64, 258, 500, 260, 500, 122, 74, 82, 64, 50, 166, 40, 98, 500, 138, 40, 54, 38, 500, 500, 42, 500, 142, 78, 500, 148, 500, 66, 82, 30, 500, 500, 500, 214, 500, 64, 66, 38, 328, 206, 90, 500, 56, 206, 54, 48, 60, 336, 500, 500, 36, 52, 500, 500, 500, 118, 70, 52, 92, 474, 500, 110, 500, 146, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37837247169124916, "mean_inference_ms": 1.2082555470421275, "mean_action_processing_ms": 0.14154167273959284, "mean_env_wait_ms": 0.08326736790048843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0299985408782959, "StateBufferConnector_ms": 0.009002208709716797, "ViewRequirementAgentConnector_ms": 0.12700796127319336}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5295.18094344347, "num_env_steps_trained_throughput_per_sec": 5295.18094344347, "timesteps_total": 204000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 204000, "timers": {"training_iteration_time_ms": 2274.707, "sample_time_ms": 1938.809, "load_time_ms": 11.576, "load_throughput": 1036652.338, "learn_time_ms": 313.497, "learn_throughput": 38277.832, "synch_weights_time_ms": 9.444}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "done": false, "episodes_total": 754, "training_iteration": 17, "trial_id": "9f288_00017", "date": "2023-10-25_16-57-09", "timestamp": 1698249429, "time_this_iter_s": 2.271205186843872, "time_total_s": 38.48955249786377, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 38.48955249786377, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 59.166666666666664, "ram_util_percent": 27.166666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.5258789062500005e-06, "cur_lr": 0.0003, "total_loss": 7.539060878753662, "policy_loss": -0.00026350120703379313, "vf_loss": 7.539374383290609, "vf_explained_var": -2.1855036417643228e-08, "kl": 0.0003679141948869831, "entropy": 0.5003082136313121, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 525.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.535999999999836, "episode_len_mean": 245.32, "episode_media": {}, "episodes_this_iter": 57, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 35.30000000000004, -50.00000000000044, 43.50000000000001, 41.90000000000001, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.699999999999967, -50.00000000000044, 43.7, 43.50000000000001, 46.3, 17.299999999999805, 29.49999999999998, 41.100000000000016, -50.00000000000044, 44.5, 29.49999999999998, 44.7, 45.3, 44.10000000000001, 16.499999999999794, -50.00000000000044, -50.00000000000044, 46.5, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, 43.10000000000001, 44.900000000000006, 40.90000000000002, 2.699999999999598, -50.00000000000044, 39.10000000000002, -50.00000000000044, 35.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 47.1, 27.699999999999953, 43.900000000000006, 35.70000000000003, 22.699999999999882, -50.00000000000044, 43.50000000000001, 46.9, 43.7, -50.00000000000044, -50.00000000000044, 39.70000000000002, 46.699999999999996, 45.9, 11.499999999999723, 45.9, 39.70000000000002, 43.900000000000006, -50.00000000000044, 41.100000000000016, 38.300000000000026, 45.1, 46.5, 45.5, -50.00000000000044, 22.699999999999882, 21.699999999999868, 43.30000000000001, 35.70000000000003, -50.00000000000044, 43.50000000000001, 42.500000000000014, 39.300000000000026, -50.00000000000044, -50.00000000000044, 45.3, 33.10000000000003, 40.70000000000002, 40.10000000000002, 45.1, 44.900000000000006, 44.7, -50.00000000000044, 12.499999999999737, 4.899999999999629, 45.9, 0.2999999999995637, -50.00000000000044, 47.3, 45.3, -50.00000000000044, -50.00000000000044, 30.9, -50.00000000000044], "episode_lengths": [500, 148, 500, 66, 82, 30, 500, 500, 500, 214, 500, 64, 66, 38, 328, 206, 90, 500, 56, 206, 54, 48, 60, 336, 500, 500, 36, 52, 500, 500, 500, 118, 70, 52, 92, 474, 500, 110, 500, 146, 500, 500, 500, 500, 500, 56, 30, 224, 62, 144, 274, 500, 66, 32, 64, 500, 500, 104, 34, 42, 386, 42, 104, 62, 500, 90, 118, 50, 36, 46, 500, 274, 284, 68, 144, 500, 66, 76, 108, 500, 500, 48, 170, 94, 100, 50, 52, 54, 500, 376, 452, 42, 498, 500, 28, 48, 500, 500, 192, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37769850187775733, "mean_inference_ms": 1.206939576491903, "mean_action_processing_ms": 0.1416787913431704, "mean_env_wait_ms": 0.08299598478718945, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030995607376098633, "StateBufferConnector_ms": 0.0040018558502197266, "ViewRequirementAgentConnector_ms": 0.12599611282348633}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.535999999999836, "episode_len_mean": 245.32, "episodes_this_iter": 57, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 35.30000000000004, -50.00000000000044, 43.50000000000001, 41.90000000000001, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.699999999999967, -50.00000000000044, 43.7, 43.50000000000001, 46.3, 17.299999999999805, 29.49999999999998, 41.100000000000016, -50.00000000000044, 44.5, 29.49999999999998, 44.7, 45.3, 44.10000000000001, 16.499999999999794, -50.00000000000044, -50.00000000000044, 46.5, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, 43.10000000000001, 44.900000000000006, 40.90000000000002, 2.699999999999598, -50.00000000000044, 39.10000000000002, -50.00000000000044, 35.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 47.1, 27.699999999999953, 43.900000000000006, 35.70000000000003, 22.699999999999882, -50.00000000000044, 43.50000000000001, 46.9, 43.7, -50.00000000000044, -50.00000000000044, 39.70000000000002, 46.699999999999996, 45.9, 11.499999999999723, 45.9, 39.70000000000002, 43.900000000000006, -50.00000000000044, 41.100000000000016, 38.300000000000026, 45.1, 46.5, 45.5, -50.00000000000044, 22.699999999999882, 21.699999999999868, 43.30000000000001, 35.70000000000003, -50.00000000000044, 43.50000000000001, 42.500000000000014, 39.300000000000026, -50.00000000000044, -50.00000000000044, 45.3, 33.10000000000003, 40.70000000000002, 40.10000000000002, 45.1, 44.900000000000006, 44.7, -50.00000000000044, 12.499999999999737, 4.899999999999629, 45.9, 0.2999999999995637, -50.00000000000044, 47.3, 45.3, -50.00000000000044, -50.00000000000044, 30.9, -50.00000000000044], "episode_lengths": [500, 148, 500, 66, 82, 30, 500, 500, 500, 214, 500, 64, 66, 38, 328, 206, 90, 500, 56, 206, 54, 48, 60, 336, 500, 500, 36, 52, 500, 500, 500, 118, 70, 52, 92, 474, 500, 110, 500, 146, 500, 500, 500, 500, 500, 56, 30, 224, 62, 144, 274, 500, 66, 32, 64, 500, 500, 104, 34, 42, 386, 42, 104, 62, 500, 90, 118, 50, 36, 46, 500, 274, 284, 68, 144, 500, 66, 76, 108, 500, 500, 48, 170, 94, 100, 50, 52, 54, 500, 376, 452, 42, 498, 500, 28, 48, 500, 500, 192, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37769850187775733, "mean_inference_ms": 1.206939576491903, "mean_action_processing_ms": 0.1416787913431704, "mean_env_wait_ms": 0.08299598478718945, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030995607376098633, "StateBufferConnector_ms": 0.0040018558502197266, "ViewRequirementAgentConnector_ms": 0.12599611282348633}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5441.6216258293525, "num_env_steps_trained_throughput_per_sec": 5441.6216258293525, "timesteps_total": 216000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 216000, "timers": {"training_iteration_time_ms": 2269.711, "sample_time_ms": 1938.589, "load_time_ms": 10.874, "load_throughput": 1103582.7, "learn_time_ms": 309.433, "learn_throughput": 38780.613, "synch_weights_time_ms": 9.335}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "done": false, "episodes_total": 811, "training_iteration": 18, "trial_id": "9f288_00017", "date": "2023-10-25_16-57-11", "timestamp": 1698249431, "time_this_iter_s": 2.210221290588379, "time_total_s": 40.69977378845215, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 40.69977378845215, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 60.43333333333334, "ram_util_percent": 27.166666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.629394531250003e-07, "cur_lr": 0.0003, "total_loss": 6.065220785140991, "policy_loss": -0.0005893830209970474, "vf_loss": 6.065857172012329, "vf_explained_var": -1.2755393981933593e-06, "kl": 0.0012191663656722085, "entropy": 0.4688095152378082, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 555.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.7809999999998007, "episode_len_mean": 277.78, "episode_media": {}, "episodes_this_iter": 33, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.900000000000006, 40.90000000000002, 2.699999999999598, -50.00000000000044, 39.10000000000002, -50.00000000000044, 35.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 47.1, 27.699999999999953, 43.900000000000006, 35.70000000000003, 22.699999999999882, -50.00000000000044, 43.50000000000001, 46.9, 43.7, -50.00000000000044, -50.00000000000044, 39.70000000000002, 46.699999999999996, 45.9, 11.499999999999723, 45.9, 39.70000000000002, 43.900000000000006, -50.00000000000044, 41.100000000000016, 38.300000000000026, 45.1, 46.5, 45.5, -50.00000000000044, 22.699999999999882, 21.699999999999868, 43.30000000000001, 35.70000000000003, -50.00000000000044, 43.50000000000001, 42.500000000000014, 39.300000000000026, -50.00000000000044, -50.00000000000044, 45.3, 33.10000000000003, 40.70000000000002, 40.10000000000002, 45.1, 44.900000000000006, 44.7, -50.00000000000044, 12.499999999999737, 4.899999999999629, 45.9, 0.2999999999995637, -50.00000000000044, 47.3, 45.3, -50.00000000000044, -50.00000000000044, 30.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.300000000000004, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 44.7, -50.00000000000044, 30.9, -50.00000000000044, -50.00000000000044, 46.3, 37.300000000000026, 44.7, -50.00000000000044, 33.10000000000003, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044], "episode_lengths": [52, 92, 474, 500, 110, 500, 146, 500, 500, 500, 500, 500, 56, 30, 224, 62, 144, 274, 500, 66, 32, 64, 500, 500, 104, 34, 42, 386, 42, 104, 62, 500, 90, 118, 50, 36, 46, 500, 274, 284, 68, 144, 500, 66, 76, 108, 500, 500, 48, 170, 94, 100, 50, 52, 54, 500, 376, 452, 42, 498, 500, 28, 48, 500, 500, 192, 500, 500, 500, 500, 118, 500, 54, 500, 500, 500, 500, 500, 500, 500, 188, 46, 500, 500, 500, 36, 54, 500, 192, 500, 500, 38, 128, 54, 500, 170, 500, 36, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3788548501174408, "mean_inference_ms": 1.2078002600775408, "mean_action_processing_ms": 0.14133028003003167, "mean_env_wait_ms": 0.08331547538173999, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03499102592468262, "StateBufferConnector_ms": 0.0030007362365722656, "ViewRequirementAgentConnector_ms": 0.11234855651855469}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.7809999999998007, "episode_len_mean": 277.78, "episodes_this_iter": 33, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.900000000000006, 40.90000000000002, 2.699999999999598, -50.00000000000044, 39.10000000000002, -50.00000000000044, 35.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 47.1, 27.699999999999953, 43.900000000000006, 35.70000000000003, 22.699999999999882, -50.00000000000044, 43.50000000000001, 46.9, 43.7, -50.00000000000044, -50.00000000000044, 39.70000000000002, 46.699999999999996, 45.9, 11.499999999999723, 45.9, 39.70000000000002, 43.900000000000006, -50.00000000000044, 41.100000000000016, 38.300000000000026, 45.1, 46.5, 45.5, -50.00000000000044, 22.699999999999882, 21.699999999999868, 43.30000000000001, 35.70000000000003, -50.00000000000044, 43.50000000000001, 42.500000000000014, 39.300000000000026, -50.00000000000044, -50.00000000000044, 45.3, 33.10000000000003, 40.70000000000002, 40.10000000000002, 45.1, 44.900000000000006, 44.7, -50.00000000000044, 12.499999999999737, 4.899999999999629, 45.9, 0.2999999999995637, -50.00000000000044, 47.3, 45.3, -50.00000000000044, -50.00000000000044, 30.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.300000000000004, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 44.7, -50.00000000000044, 30.9, -50.00000000000044, -50.00000000000044, 46.3, 37.300000000000026, 44.7, -50.00000000000044, 33.10000000000003, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044], "episode_lengths": [52, 92, 474, 500, 110, 500, 146, 500, 500, 500, 500, 500, 56, 30, 224, 62, 144, 274, 500, 66, 32, 64, 500, 500, 104, 34, 42, 386, 42, 104, 62, 500, 90, 118, 50, 36, 46, 500, 274, 284, 68, 144, 500, 66, 76, 108, 500, 500, 48, 170, 94, 100, 50, 52, 54, 500, 376, 452, 42, 498, 500, 28, 48, 500, 500, 192, 500, 500, 500, 500, 118, 500, 54, 500, 500, 500, 500, 500, 500, 500, 188, 46, 500, 500, 500, 36, 54, 500, 192, 500, 500, 38, 128, 54, 500, 170, 500, 36, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3788548501174408, "mean_inference_ms": 1.2078002600775408, "mean_action_processing_ms": 0.14133028003003167, "mean_env_wait_ms": 0.08331547538173999, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03499102592468262, "StateBufferConnector_ms": 0.0030007362365722656, "ViewRequirementAgentConnector_ms": 0.11234855651855469}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5175.498247503904, "num_env_steps_trained_throughput_per_sec": 5175.498247503904, "timesteps_total": 228000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 228000, "timers": {"training_iteration_time_ms": 2289.092, "sample_time_ms": 1933.604, "load_time_ms": 11.974, "load_throughput": 1002209.209, "learn_time_ms": 332.499, "learn_throughput": 36090.365, "synch_weights_time_ms": 9.436}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "done": false, "episodes_total": 844, "training_iteration": 19, "trial_id": "9f288_00017", "date": "2023-10-25_16-57-14", "timestamp": 1698249434, "time_this_iter_s": 2.323615550994873, "time_total_s": 43.02338933944702, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 43.02338933944702, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 58.56666666666666, "ram_util_percent": 27.133333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.8146972656250013e-07, "cur_lr": 0.0003, "total_loss": 5.966449149449667, "policy_loss": -0.00020393322532375653, "vf_loss": 5.966699457168579, "vf_explained_var": -1.235802968343099e-06, "kl": 0.0005597132625856223, "entropy": 0.4647518664598465, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 585.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -5.337000000000232, "episode_len_mean": 308.88, "episode_media": {}, "episodes_this_iter": 35, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.5, 45.5, -50.00000000000044, 22.699999999999882, 21.699999999999868, 43.30000000000001, 35.70000000000003, -50.00000000000044, 43.50000000000001, 42.500000000000014, 39.300000000000026, -50.00000000000044, -50.00000000000044, 45.3, 33.10000000000003, 40.70000000000002, 40.10000000000002, 45.1, 44.900000000000006, 44.7, -50.00000000000044, 12.499999999999737, 4.899999999999629, 45.9, 0.2999999999995637, -50.00000000000044, 47.3, 45.3, -50.00000000000044, -50.00000000000044, 30.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.300000000000004, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 44.7, -50.00000000000044, 30.9, -50.00000000000044, -50.00000000000044, 46.3, 37.300000000000026, 44.7, -50.00000000000044, 33.10000000000003, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, 35.900000000000034, -50.00000000000044, 45.7, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 38.300000000000026, -50.00000000000044, 46.5, 46.3, -50.00000000000044, 40.30000000000002, -50.00000000000044, 46.099999999999994, 41.100000000000016, -50.00000000000044, -50.00000000000044, 46.3, 2.0999999999995893, -50.00000000000044, -50.00000000000044, 20.49999999999985, 27.899999999999956, -50.00000000000044, 38.700000000000024], "episode_lengths": [36, 46, 500, 274, 284, 68, 144, 500, 66, 76, 108, 500, 500, 48, 170, 94, 100, 50, 52, 54, 500, 376, 452, 42, 498, 500, 28, 48, 500, 500, 192, 500, 500, 500, 500, 118, 500, 54, 500, 500, 500, 500, 500, 500, 500, 188, 46, 500, 500, 500, 36, 54, 500, 192, 500, 500, 38, 128, 54, 500, 170, 500, 36, 500, 500, 500, 98, 500, 500, 142, 500, 44, 42, 500, 500, 500, 500, 500, 500, 72, 500, 118, 500, 36, 38, 500, 98, 500, 40, 90, 500, 500, 38, 480, 500, 500, 296, 222, 500, 114]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3789334289307342, "mean_inference_ms": 1.208783426136635, "mean_action_processing_ms": 0.14148182000792647, "mean_env_wait_ms": 0.0833863513389407, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03299403190612793, "StateBufferConnector_ms": 0.004999399185180664, "ViewRequirementAgentConnector_ms": 0.11637449264526367}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -5.337000000000232, "episode_len_mean": 308.88, "episodes_this_iter": 35, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.5, 45.5, -50.00000000000044, 22.699999999999882, 21.699999999999868, 43.30000000000001, 35.70000000000003, -50.00000000000044, 43.50000000000001, 42.500000000000014, 39.300000000000026, -50.00000000000044, -50.00000000000044, 45.3, 33.10000000000003, 40.70000000000002, 40.10000000000002, 45.1, 44.900000000000006, 44.7, -50.00000000000044, 12.499999999999737, 4.899999999999629, 45.9, 0.2999999999995637, -50.00000000000044, 47.3, 45.3, -50.00000000000044, -50.00000000000044, 30.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.300000000000004, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 44.7, -50.00000000000044, 30.9, -50.00000000000044, -50.00000000000044, 46.3, 37.300000000000026, 44.7, -50.00000000000044, 33.10000000000003, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, 35.900000000000034, -50.00000000000044, 45.7, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 38.300000000000026, -50.00000000000044, 46.5, 46.3, -50.00000000000044, 40.30000000000002, -50.00000000000044, 46.099999999999994, 41.100000000000016, -50.00000000000044, -50.00000000000044, 46.3, 2.0999999999995893, -50.00000000000044, -50.00000000000044, 20.49999999999985, 27.899999999999956, -50.00000000000044, 38.700000000000024], "episode_lengths": [36, 46, 500, 274, 284, 68, 144, 500, 66, 76, 108, 500, 500, 48, 170, 94, 100, 50, 52, 54, 500, 376, 452, 42, 498, 500, 28, 48, 500, 500, 192, 500, 500, 500, 500, 118, 500, 54, 500, 500, 500, 500, 500, 500, 500, 188, 46, 500, 500, 500, 36, 54, 500, 192, 500, 500, 38, 128, 54, 500, 170, 500, 36, 500, 500, 500, 98, 500, 500, 142, 500, 44, 42, 500, 500, 500, 500, 500, 500, 72, 500, 118, 500, 36, 38, 500, 98, 500, 40, 90, 500, 500, 38, 480, 500, 500, 296, 222, 500, 114]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3789334289307342, "mean_inference_ms": 1.208783426136635, "mean_action_processing_ms": 0.14148182000792647, "mean_env_wait_ms": 0.0833863513389407, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03299403190612793, "StateBufferConnector_ms": 0.004999399185180664, "ViewRequirementAgentConnector_ms": 0.11637449264526367}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4978.715082500236, "num_env_steps_trained_throughput_per_sec": 4978.715082500236, "timesteps_total": 240000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 2282.956, "sample_time_ms": 1910.561, "load_time_ms": 12.581, "load_throughput": 953805.489, "learn_time_ms": 348.878, "learn_throughput": 34395.966, "synch_weights_time_ms": 9.434}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "episodes_total": 879, "training_iteration": 20, "trial_id": "9f288_00017", "date": "2023-10-25_16-57-16", "timestamp": 1698249436, "time_this_iter_s": 2.414257764816284, "time_total_s": 45.437647104263306, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 45.437647104263306, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 48.375, "ram_util_percent": 27.150000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.9073486328125006e-07, "cur_lr": 0.0003, "total_loss": 6.147025235493978, "policy_loss": -0.0003980369617541631, "vf_loss": 6.147473128636678, "vf_explained_var": -1.8199284871419272e-06, "kl": 0.0005146930369922605, "entropy": 0.49987340966860455, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 615.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -7.901000000000239, "episode_len_mean": 314.48, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.300000000000004, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 44.7, -50.00000000000044, 30.9, -50.00000000000044, -50.00000000000044, 46.3, 37.300000000000026, 44.7, -50.00000000000044, 33.10000000000003, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, 35.900000000000034, -50.00000000000044, 45.7, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 38.300000000000026, -50.00000000000044, 46.5, 46.3, -50.00000000000044, 40.30000000000002, -50.00000000000044, 46.099999999999994, 41.100000000000016, -50.00000000000044, -50.00000000000044, 46.3, 2.0999999999995893, -50.00000000000044, -50.00000000000044, 20.49999999999985, 27.899999999999956, -50.00000000000044, 38.700000000000024, -50.00000000000044, -50.00000000000044, 24.69999999999991, 46.3, 44.300000000000004, -50.00000000000044, 44.5, 43.10000000000001, 29.899999999999984, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 44.5, 41.500000000000014, -50.00000000000044, -50.00000000000044, 37.70000000000003, 43.10000000000001, 43.10000000000001, 39.50000000000002, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 46.9, 33.30000000000003, 37.10000000000003, 38.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 39.90000000000002, -50.00000000000044], "episode_lengths": [500, 500, 500, 500, 188, 46, 500, 500, 500, 36, 54, 500, 192, 500, 500, 38, 128, 54, 500, 170, 500, 36, 500, 500, 500, 98, 500, 500, 142, 500, 44, 42, 500, 500, 500, 500, 500, 500, 72, 500, 118, 500, 36, 38, 500, 98, 500, 40, 90, 500, 500, 38, 480, 500, 500, 296, 222, 500, 114, 500, 500, 254, 38, 58, 500, 56, 70, 202, 500, 500, 500, 500, 500, 500, 58, 56, 86, 500, 500, 124, 70, 70, 106, 88, 500, 500, 500, 72, 500, 500, 32, 168, 130, 112, 500, 500, 500, 86, 102, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3789700604499357, "mean_inference_ms": 1.2080395098139394, "mean_action_processing_ms": 0.14090553181170834, "mean_env_wait_ms": 0.08318488671313545, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.034998416900634766, "StateBufferConnector_ms": 0.006001710891723633, "ViewRequirementAgentConnector_ms": 0.09836673736572266}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -7.901000000000239, "episode_len_mean": 314.48, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.300000000000004, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 44.7, -50.00000000000044, 30.9, -50.00000000000044, -50.00000000000044, 46.3, 37.300000000000026, 44.7, -50.00000000000044, 33.10000000000003, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, 35.900000000000034, -50.00000000000044, 45.7, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 38.300000000000026, -50.00000000000044, 46.5, 46.3, -50.00000000000044, 40.30000000000002, -50.00000000000044, 46.099999999999994, 41.100000000000016, -50.00000000000044, -50.00000000000044, 46.3, 2.0999999999995893, -50.00000000000044, -50.00000000000044, 20.49999999999985, 27.899999999999956, -50.00000000000044, 38.700000000000024, -50.00000000000044, -50.00000000000044, 24.69999999999991, 46.3, 44.300000000000004, -50.00000000000044, 44.5, 43.10000000000001, 29.899999999999984, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 44.5, 41.500000000000014, -50.00000000000044, -50.00000000000044, 37.70000000000003, 43.10000000000001, 43.10000000000001, 39.50000000000002, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 46.9, 33.30000000000003, 37.10000000000003, 38.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 39.90000000000002, -50.00000000000044], "episode_lengths": [500, 500, 500, 500, 188, 46, 500, 500, 500, 36, 54, 500, 192, 500, 500, 38, 128, 54, 500, 170, 500, 36, 500, 500, 500, 98, 500, 500, 142, 500, 44, 42, 500, 500, 500, 500, 500, 500, 72, 500, 118, 500, 36, 38, 500, 98, 500, 40, 90, 500, 500, 38, 480, 500, 500, 296, 222, 500, 114, 500, 500, 254, 38, 58, 500, 56, 70, 202, 500, 500, 500, 500, 500, 500, 58, 56, 86, 500, 500, 124, 70, 70, 106, 88, 500, 500, 500, 72, 500, 500, 32, 168, 130, 112, 500, 500, 500, 86, 102, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3789700604499357, "mean_inference_ms": 1.2080395098139394, "mean_action_processing_ms": 0.14090553181170834, "mean_env_wait_ms": 0.08318488671313545, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.034998416900634766, "StateBufferConnector_ms": 0.006001710891723633, "ViewRequirementAgentConnector_ms": 0.09836673736572266}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5165.438243270731, "num_env_steps_trained_throughput_per_sec": 5165.438243270731, "timesteps_total": 252000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 252000, "timers": {"training_iteration_time_ms": 2283.162, "sample_time_ms": 1907.001, "load_time_ms": 12.889, "load_throughput": 931058.908, "learn_time_ms": 352.497, "learn_throughput": 34042.891, "synch_weights_time_ms": 9.374}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "done": false, "episodes_total": 920, "training_iteration": 21, "trial_id": "9f288_00017", "date": "2023-10-25_16-57-19", "timestamp": 1698249439, "time_this_iter_s": 2.3268747329711914, "time_total_s": 47.7645218372345, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 47.7645218372345, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 59.53333333333334, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.536743164062503e-08, "cur_lr": 0.0003, "total_loss": 6.531747468312582, "policy_loss": -0.0003985823442538579, "vf_loss": 6.532195520401001, "vf_explained_var": 4.569689432779948e-07, "kl": 0.0006740802511747764, "entropy": 0.49566296537717186, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 645.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.4050000000002063, "episode_len_mean": 289.6, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.30000000000002, -50.00000000000044, 46.099999999999994, 41.100000000000016, -50.00000000000044, -50.00000000000044, 46.3, 2.0999999999995893, -50.00000000000044, -50.00000000000044, 20.49999999999985, 27.899999999999956, -50.00000000000044, 38.700000000000024, -50.00000000000044, -50.00000000000044, 24.69999999999991, 46.3, 44.300000000000004, -50.00000000000044, 44.5, 43.10000000000001, 29.899999999999984, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 44.5, 41.500000000000014, -50.00000000000044, -50.00000000000044, 37.70000000000003, 43.10000000000001, 43.10000000000001, 39.50000000000002, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 46.9, 33.30000000000003, 37.10000000000003, 38.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 39.90000000000002, -50.00000000000044, -50.00000000000044, 42.500000000000014, 44.10000000000001, -50.00000000000044, 24.299999999999905, 33.500000000000036, -50.00000000000044, 41.30000000000001, 40.70000000000002, -50.00000000000044, 37.90000000000003, -50.00000000000044, 42.900000000000006, 37.10000000000003, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, 38.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.499999999999893, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 43.10000000000001, 45.3, 47.5, 43.30000000000001, 46.099999999999994, 43.10000000000001, 46.099999999999994, -50.00000000000044, 37.50000000000003, 13.699999999999754, 42.30000000000001, 23.8999999999999, 24.099999999999902, -50.00000000000044], "episode_lengths": [98, 500, 40, 90, 500, 500, 38, 480, 500, 500, 296, 222, 500, 114, 500, 500, 254, 38, 58, 500, 56, 70, 202, 500, 500, 500, 500, 500, 500, 58, 56, 86, 500, 500, 124, 70, 70, 106, 88, 500, 500, 500, 72, 500, 500, 32, 168, 130, 112, 500, 500, 500, 86, 102, 500, 500, 76, 60, 500, 258, 166, 500, 88, 94, 500, 122, 500, 72, 130, 500, 500, 28, 500, 112, 500, 500, 500, 500, 266, 500, 500, 72, 500, 500, 500, 48, 70, 48, 26, 68, 40, 70, 40, 500, 126, 364, 78, 262, 260, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37942080983621923, "mean_inference_ms": 1.2081371505066043, "mean_action_processing_ms": 0.1405609641142778, "mean_env_wait_ms": 0.08328541463675716, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02598881721496582, "StateBufferConnector_ms": 0.006002187728881836, "ViewRequirementAgentConnector_ms": 0.11631178855895996}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.4050000000002063, "episode_len_mean": 289.6, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [40.30000000000002, -50.00000000000044, 46.099999999999994, 41.100000000000016, -50.00000000000044, -50.00000000000044, 46.3, 2.0999999999995893, -50.00000000000044, -50.00000000000044, 20.49999999999985, 27.899999999999956, -50.00000000000044, 38.700000000000024, -50.00000000000044, -50.00000000000044, 24.69999999999991, 46.3, 44.300000000000004, -50.00000000000044, 44.5, 43.10000000000001, 29.899999999999984, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 44.5, 41.500000000000014, -50.00000000000044, -50.00000000000044, 37.70000000000003, 43.10000000000001, 43.10000000000001, 39.50000000000002, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 46.9, 33.30000000000003, 37.10000000000003, 38.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 39.90000000000002, -50.00000000000044, -50.00000000000044, 42.500000000000014, 44.10000000000001, -50.00000000000044, 24.299999999999905, 33.500000000000036, -50.00000000000044, 41.30000000000001, 40.70000000000002, -50.00000000000044, 37.90000000000003, -50.00000000000044, 42.900000000000006, 37.10000000000003, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, 38.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.499999999999893, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 43.10000000000001, 45.3, 47.5, 43.30000000000001, 46.099999999999994, 43.10000000000001, 46.099999999999994, -50.00000000000044, 37.50000000000003, 13.699999999999754, 42.30000000000001, 23.8999999999999, 24.099999999999902, -50.00000000000044], "episode_lengths": [98, 500, 40, 90, 500, 500, 38, 480, 500, 500, 296, 222, 500, 114, 500, 500, 254, 38, 58, 500, 56, 70, 202, 500, 500, 500, 500, 500, 500, 58, 56, 86, 500, 500, 124, 70, 70, 106, 88, 500, 500, 500, 72, 500, 500, 32, 168, 130, 112, 500, 500, 500, 86, 102, 500, 500, 76, 60, 500, 258, 166, 500, 88, 94, 500, 122, 500, 72, 130, 500, 500, 28, 500, 112, 500, 500, 500, 500, 266, 500, 500, 72, 500, 500, 500, 48, 70, 48, 26, 68, 40, 70, 40, 500, 126, 364, 78, 262, 260, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37942080983621923, "mean_inference_ms": 1.2081371505066043, "mean_action_processing_ms": 0.1405609641142778, "mean_env_wait_ms": 0.08328541463675716, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02598881721496582, "StateBufferConnector_ms": 0.006002187728881836, "ViewRequirementAgentConnector_ms": 0.11631178855895996}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5099.11987594743, "num_env_steps_trained_throughput_per_sec": 5099.11987594743, "timesteps_total": 264000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 264000, "timers": {"training_iteration_time_ms": 2295.975, "sample_time_ms": 1909.607, "load_time_ms": 13.758, "load_throughput": 872215.785, "learn_time_ms": 361.747, "learn_throughput": 33172.379, "synch_weights_time_ms": 9.358}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "done": false, "episodes_total": 965, "training_iteration": 22, "trial_id": "9f288_00017", "date": "2023-10-25_16-57-21", "timestamp": 1698249441, "time_this_iter_s": 2.3583109378814697, "time_total_s": 50.12283277511597, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 50.12283277511597, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 58.06666666666666, "ram_util_percent": 27.166666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.7683715820312516e-08, "cur_lr": 0.0003, "total_loss": 6.819223515192667, "policy_loss": -0.00026690525313218433, "vf_loss": 6.819541501998901, "vf_explained_var": -1.1026859283447266e-06, "kl": 0.0005728040661509226, "entropy": 0.5108692834774653, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 675.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.752999999999831, "episode_len_mean": 258.1, "episode_media": {}, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 41.500000000000014, 39.90000000000002, -50.00000000000044, -50.00000000000044, 42.500000000000014, 44.10000000000001, -50.00000000000044, 24.299999999999905, 33.500000000000036, -50.00000000000044, 41.30000000000001, 40.70000000000002, -50.00000000000044, 37.90000000000003, -50.00000000000044, 42.900000000000006, 37.10000000000003, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, 38.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.499999999999893, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 43.10000000000001, 45.3, 47.5, 43.30000000000001, 46.099999999999994, 43.10000000000001, 46.099999999999994, -50.00000000000044, 37.50000000000003, 13.699999999999754, 42.30000000000001, 23.8999999999999, 24.099999999999902, -50.00000000000044, 39.10000000000002, 40.30000000000002, -50.00000000000044, 37.300000000000026, 47.5, 21.89999999999987, 41.500000000000014, 28.89999999999997, 36.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.899999999999956, 46.699999999999996, -50.00000000000044, 40.10000000000002, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 37.10000000000003, 46.699999999999996, 33.500000000000036, 45.9, 40.10000000000002, -50.00000000000044, 18.29999999999982, 34.30000000000004, 30.29999999999999, -50.00000000000044, 43.7, 46.5, 45.1, 39.90000000000002, -50.00000000000044, -50.00000000000044, 46.5, 39.50000000000002, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 31.1, 16.499999999999794, 42.70000000000001, 44.5, 45.3, 43.900000000000006, 36.900000000000034], "episode_lengths": [500, 86, 102, 500, 500, 76, 60, 500, 258, 166, 500, 88, 94, 500, 122, 500, 72, 130, 500, 500, 28, 500, 112, 500, 500, 500, 500, 266, 500, 500, 72, 500, 500, 500, 48, 70, 48, 26, 68, 40, 70, 40, 500, 126, 364, 78, 262, 260, 500, 110, 98, 500, 128, 26, 282, 86, 212, 140, 500, 500, 500, 500, 222, 34, 500, 100, 500, 78, 500, 500, 130, 34, 166, 42, 100, 500, 318, 158, 198, 500, 64, 36, 50, 102, 500, 500, 36, 106, 60, 500, 500, 500, 64, 190, 336, 74, 56, 48, 62, 132]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3795961472017042, "mean_inference_ms": 1.2074662291516338, "mean_action_processing_ms": 0.14069220384033274, "mean_env_wait_ms": 0.08322080665470125, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02500462532043457, "StateBufferConnector_ms": 0.010008811950683594, "ViewRequirementAgentConnector_ms": 0.12028002738952637}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.752999999999831, "episode_len_mean": 258.1, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 41.500000000000014, 39.90000000000002, -50.00000000000044, -50.00000000000044, 42.500000000000014, 44.10000000000001, -50.00000000000044, 24.299999999999905, 33.500000000000036, -50.00000000000044, 41.30000000000001, 40.70000000000002, -50.00000000000044, 37.90000000000003, -50.00000000000044, 42.900000000000006, 37.10000000000003, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, 38.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.499999999999893, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 43.10000000000001, 45.3, 47.5, 43.30000000000001, 46.099999999999994, 43.10000000000001, 46.099999999999994, -50.00000000000044, 37.50000000000003, 13.699999999999754, 42.30000000000001, 23.8999999999999, 24.099999999999902, -50.00000000000044, 39.10000000000002, 40.30000000000002, -50.00000000000044, 37.300000000000026, 47.5, 21.89999999999987, 41.500000000000014, 28.89999999999997, 36.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.899999999999956, 46.699999999999996, -50.00000000000044, 40.10000000000002, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 37.10000000000003, 46.699999999999996, 33.500000000000036, 45.9, 40.10000000000002, -50.00000000000044, 18.29999999999982, 34.30000000000004, 30.29999999999999, -50.00000000000044, 43.7, 46.5, 45.1, 39.90000000000002, -50.00000000000044, -50.00000000000044, 46.5, 39.50000000000002, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 31.1, 16.499999999999794, 42.70000000000001, 44.5, 45.3, 43.900000000000006, 36.900000000000034], "episode_lengths": [500, 86, 102, 500, 500, 76, 60, 500, 258, 166, 500, 88, 94, 500, 122, 500, 72, 130, 500, 500, 28, 500, 112, 500, 500, 500, 500, 266, 500, 500, 72, 500, 500, 500, 48, 70, 48, 26, 68, 40, 70, 40, 500, 126, 364, 78, 262, 260, 500, 110, 98, 500, 128, 26, 282, 86, 212, 140, 500, 500, 500, 500, 222, 34, 500, 100, 500, 78, 500, 500, 130, 34, 166, 42, 100, 500, 318, 158, 198, 500, 64, 36, 50, 102, 500, 500, 36, 106, 60, 500, 500, 500, 64, 190, 336, 74, 56, 48, 62, 132]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3795961472017042, "mean_inference_ms": 1.2074662291516338, "mean_action_processing_ms": 0.14069220384033274, "mean_env_wait_ms": 0.08322080665470125, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02500462532043457, "StateBufferConnector_ms": 0.010008811950683594, "ViewRequirementAgentConnector_ms": 0.12028002738952637}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5283.808046893232, "num_env_steps_trained_throughput_per_sec": 5283.808046893232, "timesteps_total": 276000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 276000, "timers": {"training_iteration_time_ms": 2288.633, "sample_time_ms": 1908.49, "load_time_ms": 13.835, "load_throughput": 867350.368, "learn_time_ms": 355.298, "learn_throughput": 33774.511, "synch_weights_time_ms": 9.405}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000}, "done": false, "episodes_total": 1016, "training_iteration": 23, "trial_id": "9f288_00017", "date": "2023-10-25_16-57-23", "timestamp": 1698249443, "time_this_iter_s": 2.2762770652770996, "time_total_s": 52.399109840393066, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 52.399109840393066, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 49.0, "ram_util_percent": 27.150000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.3841857910156258e-08, "cur_lr": 0.0003, "total_loss": 6.265874036153158, "policy_loss": -3.6677531898021695e-05, "vf_loss": 6.265960470835368, "vf_explained_var": -9.993712107340494e-07, "kl": 0.0002148404310787555, "entropy": 0.4975801030794779, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 705.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.617999999999844, "episode_len_mean": 244.5, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [37.50000000000003, 13.699999999999754, 42.30000000000001, 23.8999999999999, 24.099999999999902, -50.00000000000044, 39.10000000000002, 40.30000000000002, -50.00000000000044, 37.300000000000026, 47.5, 21.89999999999987, 41.500000000000014, 28.89999999999997, 36.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.899999999999956, 46.699999999999996, -50.00000000000044, 40.10000000000002, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 37.10000000000003, 46.699999999999996, 33.500000000000036, 45.9, 40.10000000000002, -50.00000000000044, 18.29999999999982, 34.30000000000004, 30.29999999999999, -50.00000000000044, 43.7, 46.5, 45.1, 39.90000000000002, -50.00000000000044, -50.00000000000044, 46.5, 39.50000000000002, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 31.1, 16.499999999999794, 42.70000000000001, 44.5, 45.3, 43.900000000000006, 36.900000000000034, -50.00000000000044, 46.5, -50.00000000000044, 43.10000000000001, 46.5, 37.10000000000003, 43.7, 45.5, 41.500000000000014, 46.3, 21.299999999999862, 47.1, 36.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 11.699999999999726, -50.00000000000044, 45.5, -50.00000000000044, 44.7, 46.699999999999996, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 10.699999999999712, 42.500000000000014, 41.70000000000002, 34.900000000000034, -50.00000000000044, 28.499999999999964, 33.500000000000036, 15.899999999999785, 43.50000000000001, -50.00000000000044, 43.900000000000006, 40.500000000000014], "episode_lengths": [126, 364, 78, 262, 260, 500, 110, 98, 500, 128, 26, 282, 86, 212, 140, 500, 500, 500, 500, 222, 34, 500, 100, 500, 78, 500, 500, 130, 34, 166, 42, 100, 500, 318, 158, 198, 500, 64, 36, 50, 102, 500, 500, 36, 106, 60, 500, 500, 500, 64, 190, 336, 74, 56, 48, 62, 132, 500, 36, 500, 70, 36, 130, 64, 46, 86, 38, 288, 30, 140, 500, 500, 500, 500, 58, 384, 500, 46, 500, 54, 34, 500, 36, 500, 500, 52, 500, 500, 394, 76, 84, 152, 500, 216, 166, 342, 66, 500, 62, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37939077374222924, "mean_inference_ms": 1.2081116578038755, "mean_action_processing_ms": 0.14035610640098542, "mean_env_wait_ms": 0.08284504691681725, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029012441635131836, "StateBufferConnector_ms": 0.014013528823852539, "ViewRequirementAgentConnector_ms": 0.13299942016601562}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.617999999999844, "episode_len_mean": 244.5, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [37.50000000000003, 13.699999999999754, 42.30000000000001, 23.8999999999999, 24.099999999999902, -50.00000000000044, 39.10000000000002, 40.30000000000002, -50.00000000000044, 37.300000000000026, 47.5, 21.89999999999987, 41.500000000000014, 28.89999999999997, 36.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.899999999999956, 46.699999999999996, -50.00000000000044, 40.10000000000002, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 37.10000000000003, 46.699999999999996, 33.500000000000036, 45.9, 40.10000000000002, -50.00000000000044, 18.29999999999982, 34.30000000000004, 30.29999999999999, -50.00000000000044, 43.7, 46.5, 45.1, 39.90000000000002, -50.00000000000044, -50.00000000000044, 46.5, 39.50000000000002, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 31.1, 16.499999999999794, 42.70000000000001, 44.5, 45.3, 43.900000000000006, 36.900000000000034, -50.00000000000044, 46.5, -50.00000000000044, 43.10000000000001, 46.5, 37.10000000000003, 43.7, 45.5, 41.500000000000014, 46.3, 21.299999999999862, 47.1, 36.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 11.699999999999726, -50.00000000000044, 45.5, -50.00000000000044, 44.7, 46.699999999999996, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 10.699999999999712, 42.500000000000014, 41.70000000000002, 34.900000000000034, -50.00000000000044, 28.499999999999964, 33.500000000000036, 15.899999999999785, 43.50000000000001, -50.00000000000044, 43.900000000000006, 40.500000000000014], "episode_lengths": [126, 364, 78, 262, 260, 500, 110, 98, 500, 128, 26, 282, 86, 212, 140, 500, 500, 500, 500, 222, 34, 500, 100, 500, 78, 500, 500, 130, 34, 166, 42, 100, 500, 318, 158, 198, 500, 64, 36, 50, 102, 500, 500, 36, 106, 60, 500, 500, 500, 64, 190, 336, 74, 56, 48, 62, 132, 500, 36, 500, 70, 36, 130, 64, 46, 86, 38, 288, 30, 140, 500, 500, 500, 500, 58, 384, 500, 46, 500, 54, 34, 500, 36, 500, 500, 52, 500, 500, 394, 76, 84, 152, 500, 216, 166, 342, 66, 500, 62, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37939077374222924, "mean_inference_ms": 1.2081116578038755, "mean_action_processing_ms": 0.14035610640098542, "mean_env_wait_ms": 0.08284504691681725, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029012441635131836, "StateBufferConnector_ms": 0.014013528823852539, "ViewRequirementAgentConnector_ms": 0.13299942016601562}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5447.74647864457, "num_env_steps_trained_throughput_per_sec": 5447.74647864457, "timesteps_total": 288000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 2282.367, "sample_time_ms": 1905.251, "load_time_ms": 13.43, "load_throughput": 893504.561, "learn_time_ms": 352.5, "learn_throughput": 34042.591, "synch_weights_time_ms": 9.702}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "episodes_total": 1059, "training_iteration": 24, "trial_id": "9f288_00017", "date": "2023-10-25_16-57-25", "timestamp": 1698249445, "time_this_iter_s": 2.2077393531799316, "time_total_s": 54.606849193573, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 54.606849193573, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 60.833333333333336, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1920928955078129e-08, "cur_lr": 0.0003, "total_loss": 6.8443203608194985, "policy_loss": -1.4532109101613363e-05, "vf_loss": 6.844383239746094, "vf_explained_var": -9.139378865559896e-08, "kl": 0.00018665789218275108, "entropy": 0.48361905217170714, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 735.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.928999999999829, "episode_len_mean": 246.34, "episode_media": {}, "episodes_this_iter": 54, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.3, 43.900000000000006, 36.900000000000034, -50.00000000000044, 46.5, -50.00000000000044, 43.10000000000001, 46.5, 37.10000000000003, 43.7, 45.5, 41.500000000000014, 46.3, 21.299999999999862, 47.1, 36.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 11.699999999999726, -50.00000000000044, 45.5, -50.00000000000044, 44.7, 46.699999999999996, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 10.699999999999712, 42.500000000000014, 41.70000000000002, 34.900000000000034, -50.00000000000044, 28.499999999999964, 33.500000000000036, 15.899999999999785, 43.50000000000001, -50.00000000000044, 43.900000000000006, 40.500000000000014, 38.10000000000002, -50.00000000000044, 44.10000000000001, 43.10000000000001, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 33.500000000000036, 45.1, -50.00000000000044, 44.7, 46.099999999999994, -50.00000000000044, 35.500000000000036, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.10000000000001, 35.500000000000036, 46.9, -50.00000000000044, 19.09999999999983, 42.10000000000001, 39.70000000000002, 45.1, 41.100000000000016, 41.70000000000002, 46.699999999999996, -50.00000000000044, 35.10000000000004, -50.00000000000044, -50.00000000000044, 46.5, 46.9, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 45.9, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 33.70000000000004, 41.30000000000001, 43.900000000000006], "episode_lengths": [48, 62, 132, 500, 36, 500, 70, 36, 130, 64, 46, 86, 38, 288, 30, 140, 500, 500, 500, 500, 58, 384, 500, 46, 500, 54, 34, 500, 36, 500, 500, 52, 500, 500, 394, 76, 84, 152, 500, 216, 166, 342, 66, 500, 62, 96, 120, 500, 60, 70, 500, 500, 54, 500, 166, 50, 500, 54, 40, 500, 146, 500, 40, 500, 500, 60, 146, 32, 500, 310, 80, 104, 50, 90, 84, 34, 500, 150, 500, 500, 36, 32, 500, 500, 52, 500, 42, 50, 500, 500, 500, 62, 44, 500, 500, 500, 38, 164, 88, 62]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37842780346634897, "mean_inference_ms": 1.2084593930153744, "mean_action_processing_ms": 0.14035673691135667, "mean_env_wait_ms": 0.0825207347733298, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030002832412719727, "StateBufferConnector_ms": 0.010007619857788086, "ViewRequirementAgentConnector_ms": 0.12079477310180664}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.928999999999829, "episode_len_mean": 246.34, "episodes_this_iter": 54, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.3, 43.900000000000006, 36.900000000000034, -50.00000000000044, 46.5, -50.00000000000044, 43.10000000000001, 46.5, 37.10000000000003, 43.7, 45.5, 41.500000000000014, 46.3, 21.299999999999862, 47.1, 36.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 11.699999999999726, -50.00000000000044, 45.5, -50.00000000000044, 44.7, 46.699999999999996, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 10.699999999999712, 42.500000000000014, 41.70000000000002, 34.900000000000034, -50.00000000000044, 28.499999999999964, 33.500000000000036, 15.899999999999785, 43.50000000000001, -50.00000000000044, 43.900000000000006, 40.500000000000014, 38.10000000000002, -50.00000000000044, 44.10000000000001, 43.10000000000001, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 33.500000000000036, 45.1, -50.00000000000044, 44.7, 46.099999999999994, -50.00000000000044, 35.500000000000036, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.10000000000001, 35.500000000000036, 46.9, -50.00000000000044, 19.09999999999983, 42.10000000000001, 39.70000000000002, 45.1, 41.100000000000016, 41.70000000000002, 46.699999999999996, -50.00000000000044, 35.10000000000004, -50.00000000000044, -50.00000000000044, 46.5, 46.9, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 45.9, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 33.70000000000004, 41.30000000000001, 43.900000000000006], "episode_lengths": [48, 62, 132, 500, 36, 500, 70, 36, 130, 64, 46, 86, 38, 288, 30, 140, 500, 500, 500, 500, 58, 384, 500, 46, 500, 54, 34, 500, 36, 500, 500, 52, 500, 500, 394, 76, 84, 152, 500, 216, 166, 342, 66, 500, 62, 96, 120, 500, 60, 70, 500, 500, 54, 500, 166, 50, 500, 54, 40, 500, 146, 500, 40, 500, 500, 60, 146, 32, 500, 310, 80, 104, 50, 90, 84, 34, 500, 150, 500, 500, 36, 32, 500, 500, 52, 500, 42, 50, 500, 500, 500, 62, 44, 500, 500, 500, 38, 164, 88, 62]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37842780346634897, "mean_inference_ms": 1.2084593930153744, "mean_action_processing_ms": 0.14035673691135667, "mean_env_wait_ms": 0.0825207347733298, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030002832412719727, "StateBufferConnector_ms": 0.010007619857788086, "ViewRequirementAgentConnector_ms": 0.12079477310180664}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5123.581670454851, "num_env_steps_trained_throughput_per_sec": 5123.581670454851, "timesteps_total": 300000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 300000, "timers": {"training_iteration_time_ms": 2287.117, "sample_time_ms": 1905.555, "load_time_ms": 13.464, "load_throughput": 891292.571, "learn_time_ms": 356.961, "learn_throughput": 33617.097, "synch_weights_time_ms": 9.754}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "done": false, "episodes_total": 1113, "training_iteration": 25, "trial_id": "9f288_00017", "date": "2023-10-25_16-57-28", "timestamp": 1698249448, "time_this_iter_s": 2.3481056690216064, "time_total_s": 56.954954862594604, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 56.954954862594604, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 59.800000000000004, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.9604644775390645e-09, "cur_lr": 0.0003, "total_loss": 6.895805549621582, "policy_loss": -0.0004715748131275177, "vf_loss": 6.896325159072876, "vf_explained_var": -6.953875223795573e-07, "kl": 0.0007131102089677673, "entropy": 0.47991041441758475, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 765.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.384999999999837, "episode_len_mean": 241.78, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.7, -50.00000000000044, 33.500000000000036, 45.1, -50.00000000000044, 44.7, 46.099999999999994, -50.00000000000044, 35.500000000000036, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.10000000000001, 35.500000000000036, 46.9, -50.00000000000044, 19.09999999999983, 42.10000000000001, 39.70000000000002, 45.1, 41.100000000000016, 41.70000000000002, 46.699999999999996, -50.00000000000044, 35.10000000000004, -50.00000000000044, -50.00000000000044, 46.5, 46.9, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 45.9, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 33.70000000000004, 41.30000000000001, 43.900000000000006, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 42.500000000000014, -50.00000000000044, 40.500000000000014, 44.7, 45.1, 42.30000000000001, 17.299999999999805, -50.00000000000044, 45.5, 38.300000000000026, 37.70000000000003, -50.00000000000044, -50.00000000000044, 46.3, 42.30000000000001, 43.30000000000001, 44.900000000000006, 43.7, 44.7, 45.9, 43.10000000000001, -50.00000000000044, 36.10000000000004, 45.1, 42.10000000000001, -50.00000000000044, 27.099999999999945, -50.00000000000044, 41.100000000000016, 27.899999999999956, 41.90000000000001, 42.900000000000006, 36.50000000000003, -50.00000000000044, 31.70000000000001, -50.00000000000044, 33.90000000000004, 39.50000000000002, 44.300000000000004, -50.00000000000044, 44.7], "episode_lengths": [54, 500, 166, 50, 500, 54, 40, 500, 146, 500, 40, 500, 500, 60, 146, 32, 500, 310, 80, 104, 50, 90, 84, 34, 500, 150, 500, 500, 36, 32, 500, 500, 52, 500, 42, 50, 500, 500, 500, 62, 44, 500, 500, 500, 38, 164, 88, 62, 500, 500, 54, 500, 500, 500, 110, 500, 500, 52, 500, 76, 500, 96, 54, 50, 78, 328, 500, 46, 118, 124, 500, 500, 38, 78, 68, 52, 64, 54, 42, 70, 500, 140, 50, 80, 500, 230, 500, 90, 222, 82, 72, 136, 500, 184, 500, 162, 106, 58, 500, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.378279361853205, "mean_inference_ms": 1.2082141348929596, "mean_action_processing_ms": 0.14141599199174876, "mean_env_wait_ms": 0.0828909872812838, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025004148483276367, "StateBufferConnector_ms": 0.008001565933227539, "ViewRequirementAgentConnector_ms": 0.10294246673583984}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.384999999999837, "episode_len_mean": 241.78, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.7, -50.00000000000044, 33.500000000000036, 45.1, -50.00000000000044, 44.7, 46.099999999999994, -50.00000000000044, 35.500000000000036, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.10000000000001, 35.500000000000036, 46.9, -50.00000000000044, 19.09999999999983, 42.10000000000001, 39.70000000000002, 45.1, 41.100000000000016, 41.70000000000002, 46.699999999999996, -50.00000000000044, 35.10000000000004, -50.00000000000044, -50.00000000000044, 46.5, 46.9, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 45.9, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 33.70000000000004, 41.30000000000001, 43.900000000000006, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 42.500000000000014, -50.00000000000044, 40.500000000000014, 44.7, 45.1, 42.30000000000001, 17.299999999999805, -50.00000000000044, 45.5, 38.300000000000026, 37.70000000000003, -50.00000000000044, -50.00000000000044, 46.3, 42.30000000000001, 43.30000000000001, 44.900000000000006, 43.7, 44.7, 45.9, 43.10000000000001, -50.00000000000044, 36.10000000000004, 45.1, 42.10000000000001, -50.00000000000044, 27.099999999999945, -50.00000000000044, 41.100000000000016, 27.899999999999956, 41.90000000000001, 42.900000000000006, 36.50000000000003, -50.00000000000044, 31.70000000000001, -50.00000000000044, 33.90000000000004, 39.50000000000002, 44.300000000000004, -50.00000000000044, 44.7], "episode_lengths": [54, 500, 166, 50, 500, 54, 40, 500, 146, 500, 40, 500, 500, 60, 146, 32, 500, 310, 80, 104, 50, 90, 84, 34, 500, 150, 500, 500, 36, 32, 500, 500, 52, 500, 42, 50, 500, 500, 500, 62, 44, 500, 500, 500, 38, 164, 88, 62, 500, 500, 54, 500, 500, 500, 110, 500, 500, 52, 500, 76, 500, 96, 54, 50, 78, 328, 500, 46, 118, 124, 500, 500, 38, 78, 68, 52, 64, 54, 42, 70, 500, 140, 50, 80, 500, 230, 500, 90, 222, 82, 72, 136, 500, 184, 500, 162, 106, 58, 500, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.378279361853205, "mean_inference_ms": 1.2082141348929596, "mean_action_processing_ms": 0.14141599199174876, "mean_env_wait_ms": 0.0828909872812838, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025004148483276367, "StateBufferConnector_ms": 0.008001565933227539, "ViewRequirementAgentConnector_ms": 0.10294246673583984}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5366.678082790641, "num_env_steps_trained_throughput_per_sec": 5366.678082790641, "timesteps_total": 312000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 312000, "timers": {"training_iteration_time_ms": 2292.676, "sample_time_ms": 1903.493, "load_time_ms": 13.858, "load_throughput": 865941.683, "learn_time_ms": 363.901, "learn_throughput": 32976.019, "synch_weights_time_ms": 9.934}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "done": false, "episodes_total": 1165, "training_iteration": 26, "trial_id": "9f288_00017", "date": "2023-10-25_16-57-30", "timestamp": 1698249450, "time_this_iter_s": 2.241011381149292, "time_total_s": 59.1959662437439, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 59.1959662437439, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 58.03333333333333, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.9802322387695322e-09, "cur_lr": 0.0003, "total_loss": 6.295641374588013, "policy_loss": -2.5315582752227785e-05, "vf_loss": 6.295716444651286, "vf_explained_var": -4.847844441731771e-07, "kl": 9.841509636959363e-05, "entropy": 0.49827057917912804, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 795.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.726999999999844, "episode_len_mean": 238.38, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.3, 33.70000000000004, 41.30000000000001, 43.900000000000006, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 42.500000000000014, -50.00000000000044, 40.500000000000014, 44.7, 45.1, 42.30000000000001, 17.299999999999805, -50.00000000000044, 45.5, 38.300000000000026, 37.70000000000003, -50.00000000000044, -50.00000000000044, 46.3, 42.30000000000001, 43.30000000000001, 44.900000000000006, 43.7, 44.7, 45.9, 43.10000000000001, -50.00000000000044, 36.10000000000004, 45.1, 42.10000000000001, -50.00000000000044, 27.099999999999945, -50.00000000000044, 41.100000000000016, 27.899999999999956, 41.90000000000001, 42.900000000000006, 36.50000000000003, -50.00000000000044, 31.70000000000001, -50.00000000000044, 33.90000000000004, 39.50000000000002, 44.300000000000004, -50.00000000000044, 44.7, -50.00000000000044, 45.1, 40.70000000000002, 20.699999999999854, 46.3, 42.30000000000001, 42.500000000000014, -50.00000000000044, -50.00000000000044, 33.10000000000003, 45.7, -50.00000000000044, 42.500000000000014, 21.09999999999986, 42.10000000000001, 42.30000000000001, -50.00000000000044, 41.70000000000002, 44.900000000000006, 41.70000000000002, -50.00000000000044, -50.00000000000044, 28.09999999999996, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 37.50000000000003, 28.699999999999967, 44.10000000000001, -50.00000000000044, 43.50000000000001, 45.5, -50.00000000000044, 40.30000000000002, 44.300000000000004, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 45.1], "episode_lengths": [500, 38, 164, 88, 62, 500, 500, 54, 500, 500, 500, 110, 500, 500, 52, 500, 76, 500, 96, 54, 50, 78, 328, 500, 46, 118, 124, 500, 500, 38, 78, 68, 52, 64, 54, 42, 70, 500, 140, 50, 80, 500, 230, 500, 90, 222, 82, 72, 136, 500, 184, 500, 162, 106, 58, 500, 54, 500, 50, 94, 294, 38, 78, 76, 500, 500, 170, 44, 500, 76, 290, 80, 78, 500, 84, 52, 84, 500, 500, 220, 500, 60, 500, 500, 52, 500, 126, 214, 60, 500, 66, 46, 500, 98, 58, 500, 30, 500, 500, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37905196163955857, "mean_inference_ms": 1.2072441242633092, "mean_action_processing_ms": 0.14103279864413765, "mean_env_wait_ms": 0.08307287885938282, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023984909057617188, "StateBufferConnector_ms": 0.007997989654541016, "ViewRequirementAgentConnector_ms": 0.10071873664855957}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.726999999999844, "episode_len_mean": 238.38, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.3, 33.70000000000004, 41.30000000000001, 43.900000000000006, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 42.500000000000014, -50.00000000000044, 40.500000000000014, 44.7, 45.1, 42.30000000000001, 17.299999999999805, -50.00000000000044, 45.5, 38.300000000000026, 37.70000000000003, -50.00000000000044, -50.00000000000044, 46.3, 42.30000000000001, 43.30000000000001, 44.900000000000006, 43.7, 44.7, 45.9, 43.10000000000001, -50.00000000000044, 36.10000000000004, 45.1, 42.10000000000001, -50.00000000000044, 27.099999999999945, -50.00000000000044, 41.100000000000016, 27.899999999999956, 41.90000000000001, 42.900000000000006, 36.50000000000003, -50.00000000000044, 31.70000000000001, -50.00000000000044, 33.90000000000004, 39.50000000000002, 44.300000000000004, -50.00000000000044, 44.7, -50.00000000000044, 45.1, 40.70000000000002, 20.699999999999854, 46.3, 42.30000000000001, 42.500000000000014, -50.00000000000044, -50.00000000000044, 33.10000000000003, 45.7, -50.00000000000044, 42.500000000000014, 21.09999999999986, 42.10000000000001, 42.30000000000001, -50.00000000000044, 41.70000000000002, 44.900000000000006, 41.70000000000002, -50.00000000000044, -50.00000000000044, 28.09999999999996, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 37.50000000000003, 28.699999999999967, 44.10000000000001, -50.00000000000044, 43.50000000000001, 45.5, -50.00000000000044, 40.30000000000002, 44.300000000000004, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 45.1], "episode_lengths": [500, 38, 164, 88, 62, 500, 500, 54, 500, 500, 500, 110, 500, 500, 52, 500, 76, 500, 96, 54, 50, 78, 328, 500, 46, 118, 124, 500, 500, 38, 78, 68, 52, 64, 54, 42, 70, 500, 140, 50, 80, 500, 230, 500, 90, 222, 82, 72, 136, 500, 184, 500, 162, 106, 58, 500, 54, 500, 50, 94, 294, 38, 78, 76, 500, 500, 170, 44, 500, 76, 290, 80, 78, 500, 84, 52, 84, 500, 500, 220, 500, 60, 500, 500, 52, 500, 126, 214, 60, 500, 66, 46, 500, 98, 58, 500, 30, 500, 500, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37905196163955857, "mean_inference_ms": 1.2072441242633092, "mean_action_processing_ms": 0.14103279864413765, "mean_env_wait_ms": 0.08307287885938282, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023984909057617188, "StateBufferConnector_ms": 0.007997989654541016, "ViewRequirementAgentConnector_ms": 0.10071873664855957}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5210.204959418563, "num_env_steps_trained_throughput_per_sec": 5210.204959418563, "timesteps_total": 324000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 324000, "timers": {"training_iteration_time_ms": 2296.373, "sample_time_ms": 1905.272, "load_time_ms": 14.558, "load_throughput": 824302.248, "learn_time_ms": 364.787, "learn_throughput": 32895.891, "synch_weights_time_ms": 10.064}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "done": false, "episodes_total": 1208, "training_iteration": 27, "trial_id": "9f288_00017", "date": "2023-10-25_16-57-32", "timestamp": 1698249452, "time_this_iter_s": 2.3079581260681152, "time_total_s": 61.50392436981201, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 61.50392436981201, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 57.73333333333333, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.4901161193847661e-09, "cur_lr": 0.0003, "total_loss": 6.313991753260295, "policy_loss": -7.892424861590067e-05, "vf_loss": 6.3141257762908936, "vf_explained_var": -1.0927518208821614e-06, "kl": 0.0003501104699182633, "entropy": 0.5504940489927928, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 825.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.8209999999998137, "episode_len_mean": 267.38, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 27.099999999999945, -50.00000000000044, 41.100000000000016, 27.899999999999956, 41.90000000000001, 42.900000000000006, 36.50000000000003, -50.00000000000044, 31.70000000000001, -50.00000000000044, 33.90000000000004, 39.50000000000002, 44.300000000000004, -50.00000000000044, 44.7, -50.00000000000044, 45.1, 40.70000000000002, 20.699999999999854, 46.3, 42.30000000000001, 42.500000000000014, -50.00000000000044, -50.00000000000044, 33.10000000000003, 45.7, -50.00000000000044, 42.500000000000014, 21.09999999999986, 42.10000000000001, 42.30000000000001, -50.00000000000044, 41.70000000000002, 44.900000000000006, 41.70000000000002, -50.00000000000044, -50.00000000000044, 28.09999999999996, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 37.50000000000003, 28.699999999999967, 44.10000000000001, -50.00000000000044, 43.50000000000001, 45.5, -50.00000000000044, 40.30000000000002, 44.300000000000004, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, 42.10000000000001, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 43.30000000000001, -50.00000000000044, 46.9, 39.70000000000002, -50.00000000000044, 44.900000000000006, 41.30000000000001, -50.00000000000044, 41.500000000000014, -50.00000000000044, 45.5, -50.00000000000044, 36.30000000000003, -50.00000000000044, -50.00000000000044, 30.699999999999996, 44.7, 44.10000000000001, 43.900000000000006, 39.10000000000002, 42.500000000000014, 7.699999999999669, -50.00000000000044, 29.69999999999998], "episode_lengths": [500, 230, 500, 90, 222, 82, 72, 136, 500, 184, 500, 162, 106, 58, 500, 54, 500, 50, 94, 294, 38, 78, 76, 500, 500, 170, 44, 500, 76, 290, 80, 78, 500, 84, 52, 84, 500, 500, 220, 500, 60, 500, 500, 52, 500, 126, 214, 60, 500, 66, 46, 500, 98, 58, 500, 30, 500, 500, 50, 500, 500, 72, 500, 500, 500, 96, 500, 80, 66, 500, 500, 500, 500, 500, 500, 62, 68, 500, 32, 104, 500, 52, 88, 500, 86, 500, 46, 500, 138, 500, 500, 194, 54, 60, 62, 110, 76, 424, 500, 204]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.379651894900202, "mean_inference_ms": 1.2082848568973048, "mean_action_processing_ms": 0.1413056685951053, "mean_env_wait_ms": 0.08313984852718505, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028985261917114258, "StateBufferConnector_ms": 0.009001493453979492, "ViewRequirementAgentConnector_ms": 0.10572648048400879}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.8209999999998137, "episode_len_mean": 267.38, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 27.099999999999945, -50.00000000000044, 41.100000000000016, 27.899999999999956, 41.90000000000001, 42.900000000000006, 36.50000000000003, -50.00000000000044, 31.70000000000001, -50.00000000000044, 33.90000000000004, 39.50000000000002, 44.300000000000004, -50.00000000000044, 44.7, -50.00000000000044, 45.1, 40.70000000000002, 20.699999999999854, 46.3, 42.30000000000001, 42.500000000000014, -50.00000000000044, -50.00000000000044, 33.10000000000003, 45.7, -50.00000000000044, 42.500000000000014, 21.09999999999986, 42.10000000000001, 42.30000000000001, -50.00000000000044, 41.70000000000002, 44.900000000000006, 41.70000000000002, -50.00000000000044, -50.00000000000044, 28.09999999999996, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 37.50000000000003, 28.699999999999967, 44.10000000000001, -50.00000000000044, 43.50000000000001, 45.5, -50.00000000000044, 40.30000000000002, 44.300000000000004, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, 42.10000000000001, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 43.30000000000001, -50.00000000000044, 46.9, 39.70000000000002, -50.00000000000044, 44.900000000000006, 41.30000000000001, -50.00000000000044, 41.500000000000014, -50.00000000000044, 45.5, -50.00000000000044, 36.30000000000003, -50.00000000000044, -50.00000000000044, 30.699999999999996, 44.7, 44.10000000000001, 43.900000000000006, 39.10000000000002, 42.500000000000014, 7.699999999999669, -50.00000000000044, 29.69999999999998], "episode_lengths": [500, 230, 500, 90, 222, 82, 72, 136, 500, 184, 500, 162, 106, 58, 500, 54, 500, 50, 94, 294, 38, 78, 76, 500, 500, 170, 44, 500, 76, 290, 80, 78, 500, 84, 52, 84, 500, 500, 220, 500, 60, 500, 500, 52, 500, 126, 214, 60, 500, 66, 46, 500, 98, 58, 500, 30, 500, 500, 50, 500, 500, 72, 500, 500, 500, 96, 500, 80, 66, 500, 500, 500, 500, 500, 500, 62, 68, 500, 32, 104, 500, 52, 88, 500, 86, 500, 46, 500, 138, 500, 500, 194, 54, 60, 62, 110, 76, 424, 500, 204]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.379651894900202, "mean_inference_ms": 1.2082848568973048, "mean_action_processing_ms": 0.1413056685951053, "mean_env_wait_ms": 0.08313984852718505, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028985261917114258, "StateBufferConnector_ms": 0.009001493453979492, "ViewRequirementAgentConnector_ms": 0.10572648048400879}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5353.465875405007, "num_env_steps_trained_throughput_per_sec": 5353.465875405007, "timesteps_total": 336000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 336000, "timers": {"training_iteration_time_ms": 2300.004, "sample_time_ms": 1908.655, "load_time_ms": 14.357, "load_throughput": 835818.421, "learn_time_ms": 365.258, "learn_throughput": 32853.49, "synch_weights_time_ms": 10.042}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "done": false, "episodes_total": 1249, "training_iteration": 28, "trial_id": "9f288_00017", "date": "2023-10-25_16-57-35", "timestamp": 1698249455, "time_this_iter_s": 2.246549367904663, "time_total_s": 63.750473737716675, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 63.750473737716675, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 52.2, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.450580596923831e-10, "cur_lr": 0.0003, "total_loss": 6.918874311447143, "policy_loss": -0.0005057290196418762, "vf_loss": 6.919432735443115, "vf_explained_var": -1.8239021301269532e-06, "kl": 0.0008076921632740171, "entropy": 0.5269648045301437, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 855.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.0479999999998095, "episode_len_mean": 270.1, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.300000000000004, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, 42.10000000000001, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 43.30000000000001, -50.00000000000044, 46.9, 39.70000000000002, -50.00000000000044, 44.900000000000006, 41.30000000000001, -50.00000000000044, 41.500000000000014, -50.00000000000044, 45.5, -50.00000000000044, 36.30000000000003, -50.00000000000044, -50.00000000000044, 30.699999999999996, 44.7, 44.10000000000001, 43.900000000000006, 39.10000000000002, 42.500000000000014, 7.699999999999669, -50.00000000000044, 29.69999999999998, 15.899999999999785, 33.10000000000003, -50.00000000000044, 14.499999999999766, 16.499999999999794, 45.7, -50.00000000000044, 35.500000000000036, 38.50000000000003, 28.699999999999967, 43.10000000000001, 45.3, -50.00000000000044, 28.699999999999967, 46.099999999999994, 44.900000000000006, 38.300000000000026, -50.00000000000044, 46.3, -50.00000000000044, 39.90000000000002, -50.00000000000044, 34.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, 36.900000000000034, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 46.5, 45.5, -50.00000000000044, 47.3, 42.10000000000001, 47.5, -50.00000000000044, 41.70000000000002, 44.900000000000006, 45.5, 43.7, -50.00000000000044, 40.10000000000002, 41.70000000000002, -50.00000000000044, 41.90000000000001, 40.70000000000002], "episode_lengths": [58, 500, 30, 500, 500, 50, 500, 500, 72, 500, 500, 500, 96, 500, 80, 66, 500, 500, 500, 500, 500, 500, 62, 68, 500, 32, 104, 500, 52, 88, 500, 86, 500, 46, 500, 138, 500, 500, 194, 54, 60, 62, 110, 76, 424, 500, 204, 342, 170, 500, 356, 336, 44, 500, 146, 116, 214, 70, 48, 500, 214, 40, 52, 118, 500, 38, 500, 102, 500, 152, 500, 500, 500, 500, 500, 80, 500, 132, 48, 500, 500, 500, 58, 36, 46, 500, 28, 80, 26, 500, 84, 52, 46, 64, 500, 100, 84, 500, 82, 94]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3794144165373923, "mean_inference_ms": 1.2078338218615157, "mean_action_processing_ms": 0.14128572841501996, "mean_env_wait_ms": 0.0830919996839535, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030004501342773438, "StateBufferConnector_ms": 0.007002592086791992, "ViewRequirementAgentConnector_ms": 0.12595748901367188}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.0479999999998095, "episode_len_mean": 270.1, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.300000000000004, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, 42.10000000000001, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 43.30000000000001, -50.00000000000044, 46.9, 39.70000000000002, -50.00000000000044, 44.900000000000006, 41.30000000000001, -50.00000000000044, 41.500000000000014, -50.00000000000044, 45.5, -50.00000000000044, 36.30000000000003, -50.00000000000044, -50.00000000000044, 30.699999999999996, 44.7, 44.10000000000001, 43.900000000000006, 39.10000000000002, 42.500000000000014, 7.699999999999669, -50.00000000000044, 29.69999999999998, 15.899999999999785, 33.10000000000003, -50.00000000000044, 14.499999999999766, 16.499999999999794, 45.7, -50.00000000000044, 35.500000000000036, 38.50000000000003, 28.699999999999967, 43.10000000000001, 45.3, -50.00000000000044, 28.699999999999967, 46.099999999999994, 44.900000000000006, 38.300000000000026, -50.00000000000044, 46.3, -50.00000000000044, 39.90000000000002, -50.00000000000044, 34.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, 36.900000000000034, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 46.5, 45.5, -50.00000000000044, 47.3, 42.10000000000001, 47.5, -50.00000000000044, 41.70000000000002, 44.900000000000006, 45.5, 43.7, -50.00000000000044, 40.10000000000002, 41.70000000000002, -50.00000000000044, 41.90000000000001, 40.70000000000002], "episode_lengths": [58, 500, 30, 500, 500, 50, 500, 500, 72, 500, 500, 500, 96, 500, 80, 66, 500, 500, 500, 500, 500, 500, 62, 68, 500, 32, 104, 500, 52, 88, 500, 86, 500, 46, 500, 138, 500, 500, 194, 54, 60, 62, 110, 76, 424, 500, 204, 342, 170, 500, 356, 336, 44, 500, 146, 116, 214, 70, 48, 500, 214, 40, 52, 118, 500, 38, 500, 102, 500, 152, 500, 500, 500, 500, 500, 80, 500, 132, 48, 500, 500, 500, 58, 36, 46, 500, 28, 80, 26, 500, 84, 52, 46, 64, 500, 100, 84, 500, 82, 94]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3794144165373923, "mean_inference_ms": 1.2078338218615157, "mean_action_processing_ms": 0.14128572841501996, "mean_env_wait_ms": 0.0830919996839535, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030004501342773438, "StateBufferConnector_ms": 0.007002592086791992, "ViewRequirementAgentConnector_ms": 0.12595748901367188}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5178.233530171096, "num_env_steps_trained_throughput_per_sec": 5178.233530171096, "timesteps_total": 348000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 348000, "timers": {"training_iteration_time_ms": 2299.781, "sample_time_ms": 1914.623, "load_time_ms": 14.158, "load_throughput": 847572.432, "learn_time_ms": 359.312, "learn_throughput": 33397.147, "synch_weights_time_ms": 9.897}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000}, "done": false, "episodes_total": 1302, "training_iteration": 29, "trial_id": "9f288_00017", "date": "2023-10-25_16-57-37", "timestamp": 1698249457, "time_this_iter_s": 2.322390079498291, "time_total_s": 66.07286381721497, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 66.07286381721497, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 60.666666666666664, "ram_util_percent": 27.166666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.7252902984619153e-10, "cur_lr": 0.0003, "total_loss": 6.027802022298177, "policy_loss": -0.00031194500625133517, "vf_loss": 6.028170903523763, "vf_explained_var": -3.6557515462239586e-07, "kl": 0.0007114781225614782, "entropy": 0.5691427667935689, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 885.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.937999999999834, "episode_len_mean": 251.26, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.10000000000002, 42.500000000000014, 7.699999999999669, -50.00000000000044, 29.69999999999998, 15.899999999999785, 33.10000000000003, -50.00000000000044, 14.499999999999766, 16.499999999999794, 45.7, -50.00000000000044, 35.500000000000036, 38.50000000000003, 28.699999999999967, 43.10000000000001, 45.3, -50.00000000000044, 28.699999999999967, 46.099999999999994, 44.900000000000006, 38.300000000000026, -50.00000000000044, 46.3, -50.00000000000044, 39.90000000000002, -50.00000000000044, 34.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, 36.900000000000034, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 46.5, 45.5, -50.00000000000044, 47.3, 42.10000000000001, 47.5, -50.00000000000044, 41.70000000000002, 44.900000000000006, 45.5, 43.7, -50.00000000000044, 40.10000000000002, 41.70000000000002, -50.00000000000044, 41.90000000000001, 40.70000000000002, -50.00000000000044, -50.00000000000044, 46.3, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 42.10000000000001, -50.00000000000044, 45.7, 30.499999999999993, 45.9, 36.30000000000003, 42.70000000000001, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 45.5, 45.7, 44.300000000000004, 37.300000000000026, -50.00000000000044, -50.00000000000044, 30.9, 41.90000000000001, 44.5, 12.499999999999737, 31.300000000000004, 30.9, 38.700000000000024, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 42.70000000000001, 42.500000000000014, -50.00000000000044, -50.00000000000044, 40.30000000000002, 45.9], "episode_lengths": [110, 76, 424, 500, 204, 342, 170, 500, 356, 336, 44, 500, 146, 116, 214, 70, 48, 500, 214, 40, 52, 118, 500, 38, 500, 102, 500, 152, 500, 500, 500, 500, 500, 80, 500, 132, 48, 500, 500, 500, 58, 36, 46, 500, 28, 80, 26, 500, 84, 52, 46, 64, 500, 100, 84, 500, 82, 94, 500, 500, 38, 54, 500, 500, 500, 60, 80, 500, 44, 196, 42, 138, 74, 500, 500, 68, 500, 46, 44, 58, 128, 500, 500, 192, 82, 56, 376, 188, 192, 114, 500, 500, 54, 500, 74, 76, 500, 500, 98, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3790271453896128, "mean_inference_ms": 1.2068114608241516, "mean_action_processing_ms": 0.14111627191552104, "mean_env_wait_ms": 0.08313142806284503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.033006906509399414, "StateBufferConnector_ms": 0.0049974918365478516, "ViewRequirementAgentConnector_ms": 0.1389307975769043}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.937999999999834, "episode_len_mean": 251.26, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [39.10000000000002, 42.500000000000014, 7.699999999999669, -50.00000000000044, 29.69999999999998, 15.899999999999785, 33.10000000000003, -50.00000000000044, 14.499999999999766, 16.499999999999794, 45.7, -50.00000000000044, 35.500000000000036, 38.50000000000003, 28.699999999999967, 43.10000000000001, 45.3, -50.00000000000044, 28.699999999999967, 46.099999999999994, 44.900000000000006, 38.300000000000026, -50.00000000000044, 46.3, -50.00000000000044, 39.90000000000002, -50.00000000000044, 34.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, 36.900000000000034, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 46.5, 45.5, -50.00000000000044, 47.3, 42.10000000000001, 47.5, -50.00000000000044, 41.70000000000002, 44.900000000000006, 45.5, 43.7, -50.00000000000044, 40.10000000000002, 41.70000000000002, -50.00000000000044, 41.90000000000001, 40.70000000000002, -50.00000000000044, -50.00000000000044, 46.3, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 42.10000000000001, -50.00000000000044, 45.7, 30.499999999999993, 45.9, 36.30000000000003, 42.70000000000001, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 45.5, 45.7, 44.300000000000004, 37.300000000000026, -50.00000000000044, -50.00000000000044, 30.9, 41.90000000000001, 44.5, 12.499999999999737, 31.300000000000004, 30.9, 38.700000000000024, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 42.70000000000001, 42.500000000000014, -50.00000000000044, -50.00000000000044, 40.30000000000002, 45.9], "episode_lengths": [110, 76, 424, 500, 204, 342, 170, 500, 356, 336, 44, 500, 146, 116, 214, 70, 48, 500, 214, 40, 52, 118, 500, 38, 500, 102, 500, 152, 500, 500, 500, 500, 500, 80, 500, 132, 48, 500, 500, 500, 58, 36, 46, 500, 28, 80, 26, 500, 84, 52, 46, 64, 500, 100, 84, 500, 82, 94, 500, 500, 38, 54, 500, 500, 500, 60, 80, 500, 44, 196, 42, 138, 74, 500, 500, 68, 500, 46, 44, 58, 128, 500, 500, 192, 82, 56, 376, 188, 192, 114, 500, 500, 54, 500, 74, 76, 500, 500, 98, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3790271453896128, "mean_inference_ms": 1.2068114608241516, "mean_action_processing_ms": 0.14111627191552104, "mean_env_wait_ms": 0.08313142806284503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.033006906509399414, "StateBufferConnector_ms": 0.0049974918365478516, "ViewRequirementAgentConnector_ms": 0.1389307975769043}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5599.104350627506, "num_env_steps_trained_throughput_per_sec": 5599.104350627506, "timesteps_total": 360000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 360000, "timers": {"training_iteration_time_ms": 2273.175, "sample_time_ms": 1910.046, "load_time_ms": 13.464, "load_throughput": 891289.414, "learn_time_ms": 337.881, "learn_throughput": 35515.503, "synch_weights_time_ms": 9.894}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "done": false, "episodes_total": 1344, "training_iteration": 30, "trial_id": "9f288_00017", "date": "2023-10-25_16-57-39", "timestamp": 1698249459, "time_this_iter_s": 2.1481947898864746, "time_total_s": 68.22105860710144, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 68.22105860710144, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 59.6, "ram_util_percent": 27.166666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.8626451492309577e-10, "cur_lr": 0.0003, "total_loss": 6.959061892827352, "policy_loss": -0.00038167964667081835, "vf_loss": 6.959502840042115, "vf_explained_var": -9.934107462565105e-07, "kl": 0.001467708080660183, "entropy": 0.5927083988984426, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 915.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000}, "sampler_results": {"episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.752999999999838, "episode_len_mean": 248.14, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 41.70000000000002, 44.900000000000006, 45.5, 43.7, -50.00000000000044, 40.10000000000002, 41.70000000000002, -50.00000000000044, 41.90000000000001, 40.70000000000002, -50.00000000000044, -50.00000000000044, 46.3, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 42.10000000000001, -50.00000000000044, 45.7, 30.499999999999993, 45.9, 36.30000000000003, 42.70000000000001, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 45.5, 45.7, 44.300000000000004, 37.300000000000026, -50.00000000000044, -50.00000000000044, 30.9, 41.90000000000001, 44.5, 12.499999999999737, 31.300000000000004, 30.9, 38.700000000000024, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 42.70000000000001, 42.500000000000014, -50.00000000000044, -50.00000000000044, 40.30000000000002, 45.9, 2.0999999999995893, 45.7, 44.7, -50.00000000000044, 36.900000000000034, 43.900000000000006, 40.10000000000002, 42.900000000000006, 41.90000000000001, 39.300000000000026, 38.700000000000024, 42.500000000000014, 0.09999999999956088, 45.5, 42.70000000000001, 29.899999999999984, 38.90000000000002, 33.30000000000003, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 42.10000000000001, -50.00000000000044, 40.500000000000014, 34.10000000000004, 31.300000000000004, 41.90000000000001, 45.1, -50.00000000000044, 20.899999999999856, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, 17.899999999999814, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, 42.500000000000014, 40.10000000000002, 33.90000000000004, 13.299999999999748, 4.499999999999623, -50.00000000000044], "episode_lengths": [500, 84, 52, 46, 64, 500, 100, 84, 500, 82, 94, 500, 500, 38, 54, 500, 500, 500, 60, 80, 500, 44, 196, 42, 138, 74, 500, 500, 68, 500, 46, 44, 58, 128, 500, 500, 192, 82, 56, 376, 188, 192, 114, 500, 500, 54, 500, 74, 76, 500, 500, 98, 42, 480, 44, 54, 500, 132, 62, 100, 72, 82, 108, 114, 76, 500, 46, 74, 202, 112, 168, 500, 500, 42, 500, 80, 500, 96, 160, 188, 82, 50, 500, 292, 500, 500, 100, 500, 500, 322, 500, 500, 500, 94, 76, 100, 162, 368, 456, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37879443504022825, "mean_inference_ms": 1.2079768338461097, "mean_action_processing_ms": 0.14110788046367936, "mean_env_wait_ms": 0.08287783159722238, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02400374412536621, "StateBufferConnector_ms": 0.005983114242553711, "ViewRequirementAgentConnector_ms": 0.13102412223815918}}, "episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.752999999999838, "episode_len_mean": 248.14, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 41.70000000000002, 44.900000000000006, 45.5, 43.7, -50.00000000000044, 40.10000000000002, 41.70000000000002, -50.00000000000044, 41.90000000000001, 40.70000000000002, -50.00000000000044, -50.00000000000044, 46.3, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 42.10000000000001, -50.00000000000044, 45.7, 30.499999999999993, 45.9, 36.30000000000003, 42.70000000000001, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 45.5, 45.7, 44.300000000000004, 37.300000000000026, -50.00000000000044, -50.00000000000044, 30.9, 41.90000000000001, 44.5, 12.499999999999737, 31.300000000000004, 30.9, 38.700000000000024, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 42.70000000000001, 42.500000000000014, -50.00000000000044, -50.00000000000044, 40.30000000000002, 45.9, 2.0999999999995893, 45.7, 44.7, -50.00000000000044, 36.900000000000034, 43.900000000000006, 40.10000000000002, 42.900000000000006, 41.90000000000001, 39.300000000000026, 38.700000000000024, 42.500000000000014, 0.09999999999956088, 45.5, 42.70000000000001, 29.899999999999984, 38.90000000000002, 33.30000000000003, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 42.10000000000001, -50.00000000000044, 40.500000000000014, 34.10000000000004, 31.300000000000004, 41.90000000000001, 45.1, -50.00000000000044, 20.899999999999856, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, 17.899999999999814, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, 42.500000000000014, 40.10000000000002, 33.90000000000004, 13.299999999999748, 4.499999999999623, -50.00000000000044], "episode_lengths": [500, 84, 52, 46, 64, 500, 100, 84, 500, 82, 94, 500, 500, 38, 54, 500, 500, 500, 60, 80, 500, 44, 196, 42, 138, 74, 500, 500, 68, 500, 46, 44, 58, 128, 500, 500, 192, 82, 56, 376, 188, 192, 114, 500, 500, 54, 500, 74, 76, 500, 500, 98, 42, 480, 44, 54, 500, 132, 62, 100, 72, 82, 108, 114, 76, 500, 46, 74, 202, 112, 168, 500, 500, 42, 500, 80, 500, 96, 160, 188, 82, 50, 500, 292, 500, 500, 100, 500, 500, 322, 500, 500, 500, 94, 76, 100, 162, 368, 456, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37879443504022825, "mean_inference_ms": 1.2079768338461097, "mean_action_processing_ms": 0.14110788046367936, "mean_env_wait_ms": 0.08287783159722238, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02400374412536621, "StateBufferConnector_ms": 0.005983114242553711, "ViewRequirementAgentConnector_ms": 0.13102412223815918}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5192.0273372487345, "num_env_steps_trained_throughput_per_sec": 5192.0273372487345, "timesteps_total": 372000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 372000, "timers": {"training_iteration_time_ms": 2272.085, "sample_time_ms": 1912.861, "load_time_ms": 12.579, "load_throughput": 953941.071, "learn_time_ms": 334.738, "learn_throughput": 35848.893, "synch_weights_time_ms": 9.816}, "counters": {"num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000}, "done": false, "episodes_total": 1391, "training_iteration": 31, "trial_id": "9f288_00017", "date": "2023-10-25_16-57-42", "timestamp": 1698249462, "time_this_iter_s": 2.316235303878784, "time_total_s": 70.53729391098022, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 70.53729391098022, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 60.13333333333333, "ram_util_percent": 27.166666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.313225746154788e-11, "cur_lr": 0.0003, "total_loss": 6.54341918627421, "policy_loss": -6.116206447283427e-05, "vf_loss": 6.54353518486023, "vf_explained_var": -5.284945170084636e-07, "kl": 0.00028475337133310554, "entropy": 0.5482774446407954, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 945.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.501999999999848, "episode_len_mean": 245.68, "episode_media": {}, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 40.30000000000002, 45.9, 2.0999999999995893, 45.7, 44.7, -50.00000000000044, 36.900000000000034, 43.900000000000006, 40.10000000000002, 42.900000000000006, 41.90000000000001, 39.300000000000026, 38.700000000000024, 42.500000000000014, 0.09999999999956088, 45.5, 42.70000000000001, 29.899999999999984, 38.90000000000002, 33.30000000000003, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 42.10000000000001, -50.00000000000044, 40.500000000000014, 34.10000000000004, 31.300000000000004, 41.90000000000001, 45.1, -50.00000000000044, 20.899999999999856, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, 17.899999999999814, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, 42.500000000000014, 40.10000000000002, 33.90000000000004, 13.299999999999748, 4.499999999999623, -50.00000000000044, -50.00000000000044, 41.500000000000014, 22.899999999999885, 27.099999999999945, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.90000000000003, 43.7, -50.00000000000044, -50.00000000000044, 40.70000000000002, 43.30000000000001, 24.299999999999905, 43.900000000000006, -50.00000000000044, -50.00000000000044, 43.7, 39.300000000000026, 27.099999999999945, 24.899999999999913, 45.7, 37.90000000000003, 44.300000000000004, -50.00000000000044, -50.00000000000044, 36.70000000000003, 36.70000000000003, 31.900000000000013, 45.1, -50.00000000000044, 15.299999999999777, 45.7, 42.30000000000001, 38.700000000000024, 46.9, 25.499999999999922, -50.00000000000044, 45.9, 42.30000000000001, 43.30000000000001, 45.5, 34.10000000000004, 35.900000000000034, 45.5, 43.30000000000001, -50.00000000000044, 36.30000000000003], "episode_lengths": [500, 500, 98, 42, 480, 44, 54, 500, 132, 62, 100, 72, 82, 108, 114, 76, 500, 46, 74, 202, 112, 168, 500, 500, 42, 500, 80, 500, 96, 160, 188, 82, 50, 500, 292, 500, 500, 100, 500, 500, 322, 500, 500, 500, 94, 76, 100, 162, 368, 456, 500, 500, 86, 272, 230, 500, 500, 500, 500, 172, 64, 500, 500, 94, 68, 258, 62, 500, 500, 64, 108, 230, 252, 44, 122, 58, 500, 500, 134, 134, 182, 50, 500, 348, 44, 78, 114, 32, 246, 500, 42, 78, 68, 46, 160, 142, 46, 68, 500, 138]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3782362511972693, "mean_inference_ms": 1.2091914840846436, "mean_action_processing_ms": 0.14109903396995085, "mean_env_wait_ms": 0.08278170211157965, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023998260498046875, "StateBufferConnector_ms": 0.0029866695404052734, "ViewRequirementAgentConnector_ms": 0.11402463912963867}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.501999999999848, "episode_len_mean": 245.68, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 40.30000000000002, 45.9, 2.0999999999995893, 45.7, 44.7, -50.00000000000044, 36.900000000000034, 43.900000000000006, 40.10000000000002, 42.900000000000006, 41.90000000000001, 39.300000000000026, 38.700000000000024, 42.500000000000014, 0.09999999999956088, 45.5, 42.70000000000001, 29.899999999999984, 38.90000000000002, 33.30000000000003, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 42.10000000000001, -50.00000000000044, 40.500000000000014, 34.10000000000004, 31.300000000000004, 41.90000000000001, 45.1, -50.00000000000044, 20.899999999999856, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, 17.899999999999814, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, 42.500000000000014, 40.10000000000002, 33.90000000000004, 13.299999999999748, 4.499999999999623, -50.00000000000044, -50.00000000000044, 41.500000000000014, 22.899999999999885, 27.099999999999945, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.90000000000003, 43.7, -50.00000000000044, -50.00000000000044, 40.70000000000002, 43.30000000000001, 24.299999999999905, 43.900000000000006, -50.00000000000044, -50.00000000000044, 43.7, 39.300000000000026, 27.099999999999945, 24.899999999999913, 45.7, 37.90000000000003, 44.300000000000004, -50.00000000000044, -50.00000000000044, 36.70000000000003, 36.70000000000003, 31.900000000000013, 45.1, -50.00000000000044, 15.299999999999777, 45.7, 42.30000000000001, 38.700000000000024, 46.9, 25.499999999999922, -50.00000000000044, 45.9, 42.30000000000001, 43.30000000000001, 45.5, 34.10000000000004, 35.900000000000034, 45.5, 43.30000000000001, -50.00000000000044, 36.30000000000003], "episode_lengths": [500, 500, 98, 42, 480, 44, 54, 500, 132, 62, 100, 72, 82, 108, 114, 76, 500, 46, 74, 202, 112, 168, 500, 500, 42, 500, 80, 500, 96, 160, 188, 82, 50, 500, 292, 500, 500, 100, 500, 500, 322, 500, 500, 500, 94, 76, 100, 162, 368, 456, 500, 500, 86, 272, 230, 500, 500, 500, 500, 172, 64, 500, 500, 94, 68, 258, 62, 500, 500, 64, 108, 230, 252, 44, 122, 58, 500, 500, 134, 134, 182, 50, 500, 348, 44, 78, 114, 32, 246, 500, 42, 78, 68, 46, 160, 142, 46, 68, 500, 138]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3782362511972693, "mean_inference_ms": 1.2091914840846436, "mean_action_processing_ms": 0.14109903396995085, "mean_env_wait_ms": 0.08278170211157965, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023998260498046875, "StateBufferConnector_ms": 0.0029866695404052734, "ViewRequirementAgentConnector_ms": 0.11402463912963867}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5443.842861639199, "num_env_steps_trained_throughput_per_sec": 5443.842861639199, "timesteps_total": 384000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 384000, "timers": {"training_iteration_time_ms": 2257.183, "sample_time_ms": 1909.016, "load_time_ms": 11.587, "load_throughput": 1035607.178, "learn_time_ms": 324.683, "learn_throughput": 36959.091, "synch_weights_time_ms": 9.809}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "done": false, "episodes_total": 1440, "training_iteration": 32, "trial_id": "9f288_00017", "date": "2023-10-25_16-57-44", "timestamp": 1698249464, "time_this_iter_s": 2.2092151641845703, "time_total_s": 72.7465090751648, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 72.7465090751648, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 55.4, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.656612873077394e-11, "cur_lr": 0.0003, "total_loss": 6.512648073832194, "policy_loss": -0.0002855209012826284, "vf_loss": 6.51299098332723, "vf_explained_var": -1.4364719390869141e-06, "kl": 0.0006719576515195058, "entropy": 0.574418443441391, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 975.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.549999999999841, "episode_len_mean": 255.16, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.500000000000014, 40.10000000000002, 33.90000000000004, 13.299999999999748, 4.499999999999623, -50.00000000000044, -50.00000000000044, 41.500000000000014, 22.899999999999885, 27.099999999999945, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.90000000000003, 43.7, -50.00000000000044, -50.00000000000044, 40.70000000000002, 43.30000000000001, 24.299999999999905, 43.900000000000006, -50.00000000000044, -50.00000000000044, 43.7, 39.300000000000026, 27.099999999999945, 24.899999999999913, 45.7, 37.90000000000003, 44.300000000000004, -50.00000000000044, -50.00000000000044, 36.70000000000003, 36.70000000000003, 31.900000000000013, 45.1, -50.00000000000044, 15.299999999999777, 45.7, 42.30000000000001, 38.700000000000024, 46.9, 25.499999999999922, -50.00000000000044, 45.9, 42.30000000000001, 43.30000000000001, 45.5, 34.10000000000004, 35.900000000000034, 45.5, 43.30000000000001, -50.00000000000044, 36.30000000000003, -50.00000000000044, -50.00000000000044, 31.500000000000007, 40.70000000000002, 43.10000000000001, 26.09999999999993, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 30.9, 32.90000000000003, 30.099999999999987, 43.7, 33.500000000000036, -50.00000000000044, 45.7, 45.3, 44.10000000000001, -50.00000000000044, 39.300000000000026, 45.3, 27.899999999999956, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, 42.10000000000001, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 26.69999999999994, 35.70000000000003, 43.10000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, 26.299999999999933], "episode_lengths": [76, 100, 162, 368, 456, 500, 500, 86, 272, 230, 500, 500, 500, 500, 172, 64, 500, 500, 94, 68, 258, 62, 500, 500, 64, 108, 230, 252, 44, 122, 58, 500, 500, 134, 134, 182, 50, 500, 348, 44, 78, 114, 32, 246, 500, 42, 78, 68, 46, 160, 142, 46, 68, 500, 138, 500, 500, 186, 94, 70, 240, 500, 58, 500, 500, 500, 44, 500, 500, 192, 172, 200, 64, 166, 500, 44, 48, 60, 500, 108, 48, 222, 500, 56, 500, 500, 500, 98, 80, 500, 44, 500, 500, 234, 144, 70, 40, 500, 500, 238]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3783317762092818, "mean_inference_ms": 1.2094112044810739, "mean_action_processing_ms": 0.14140167977967052, "mean_env_wait_ms": 0.08326959701916557, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02399730682373047, "StateBufferConnector_ms": 0.0060002803802490234, "ViewRequirementAgentConnector_ms": 0.11996817588806152}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.549999999999841, "episode_len_mean": 255.16, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.500000000000014, 40.10000000000002, 33.90000000000004, 13.299999999999748, 4.499999999999623, -50.00000000000044, -50.00000000000044, 41.500000000000014, 22.899999999999885, 27.099999999999945, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.90000000000003, 43.7, -50.00000000000044, -50.00000000000044, 40.70000000000002, 43.30000000000001, 24.299999999999905, 43.900000000000006, -50.00000000000044, -50.00000000000044, 43.7, 39.300000000000026, 27.099999999999945, 24.899999999999913, 45.7, 37.90000000000003, 44.300000000000004, -50.00000000000044, -50.00000000000044, 36.70000000000003, 36.70000000000003, 31.900000000000013, 45.1, -50.00000000000044, 15.299999999999777, 45.7, 42.30000000000001, 38.700000000000024, 46.9, 25.499999999999922, -50.00000000000044, 45.9, 42.30000000000001, 43.30000000000001, 45.5, 34.10000000000004, 35.900000000000034, 45.5, 43.30000000000001, -50.00000000000044, 36.30000000000003, -50.00000000000044, -50.00000000000044, 31.500000000000007, 40.70000000000002, 43.10000000000001, 26.09999999999993, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 30.9, 32.90000000000003, 30.099999999999987, 43.7, 33.500000000000036, -50.00000000000044, 45.7, 45.3, 44.10000000000001, -50.00000000000044, 39.300000000000026, 45.3, 27.899999999999956, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, 42.10000000000001, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 26.69999999999994, 35.70000000000003, 43.10000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, 26.299999999999933], "episode_lengths": [76, 100, 162, 368, 456, 500, 500, 86, 272, 230, 500, 500, 500, 500, 172, 64, 500, 500, 94, 68, 258, 62, 500, 500, 64, 108, 230, 252, 44, 122, 58, 500, 500, 134, 134, 182, 50, 500, 348, 44, 78, 114, 32, 246, 500, 42, 78, 68, 46, 160, 142, 46, 68, 500, 138, 500, 500, 186, 94, 70, 240, 500, 58, 500, 500, 500, 44, 500, 500, 192, 172, 200, 64, 166, 500, 44, 48, 60, 500, 108, 48, 222, 500, 56, 500, 500, 500, 98, 80, 500, 44, 500, 500, 234, 144, 70, 40, 500, 500, 238]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3783317762092818, "mean_inference_ms": 1.2094112044810739, "mean_action_processing_ms": 0.14140167977967052, "mean_env_wait_ms": 0.08326959701916557, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02399730682373047, "StateBufferConnector_ms": 0.0060002803802490234, "ViewRequirementAgentConnector_ms": 0.11996817588806152}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5001.621076357735, "num_env_steps_trained_throughput_per_sec": 5001.621076357735, "timesteps_total": 396000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 396000, "timers": {"training_iteration_time_ms": 2269.996, "sample_time_ms": 1917.796, "load_time_ms": 11.366, "load_throughput": 1055775.066, "learn_time_ms": 328.938, "learn_throughput": 36481.001, "synch_weights_time_ms": 9.709}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "done": false, "episodes_total": 1485, "training_iteration": 33, "trial_id": "9f288_00017", "date": "2023-10-25_16-57-46", "timestamp": 1698249466, "time_this_iter_s": 2.4042208194732666, "time_total_s": 75.15072989463806, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 75.15072989463806, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 53.60000000000001, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.328306436538697e-11, "cur_lr": 0.0003, "total_loss": 6.168670654296875, "policy_loss": -0.00024125201938052972, "vf_loss": 6.168966897328695, "vf_explained_var": -1.5417734781901042e-06, "kl": 0.0006161318352042144, "entropy": 0.5496901313463847, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1005.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.114999999999826, "episode_len_mean": 264.48, "episode_media": {}, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.299999999999777, 45.7, 42.30000000000001, 38.700000000000024, 46.9, 25.499999999999922, -50.00000000000044, 45.9, 42.30000000000001, 43.30000000000001, 45.5, 34.10000000000004, 35.900000000000034, 45.5, 43.30000000000001, -50.00000000000044, 36.30000000000003, -50.00000000000044, -50.00000000000044, 31.500000000000007, 40.70000000000002, 43.10000000000001, 26.09999999999993, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 30.9, 32.90000000000003, 30.099999999999987, 43.7, 33.500000000000036, -50.00000000000044, 45.7, 45.3, 44.10000000000001, -50.00000000000044, 39.300000000000026, 45.3, 27.899999999999956, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, 42.10000000000001, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 26.69999999999994, 35.70000000000003, 43.10000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, 26.299999999999933, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 17.899999999999814, 43.30000000000001, 44.10000000000001, 8.899999999999686, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 35.900000000000034, -50.00000000000044, 29.69999999999998, 24.099999999999902, 23.29999999999989, 45.9, -50.00000000000044, 45.7, 33.70000000000004, 28.89999999999997, -50.00000000000044, 39.70000000000002, 21.89999999999987, 39.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 46.3, 44.7, 26.499999999999936, -50.00000000000044, -50.00000000000044], "episode_lengths": [348, 44, 78, 114, 32, 246, 500, 42, 78, 68, 46, 160, 142, 46, 68, 500, 138, 500, 500, 186, 94, 70, 240, 500, 58, 500, 500, 500, 44, 500, 500, 192, 172, 200, 64, 166, 500, 44, 48, 60, 500, 108, 48, 222, 500, 56, 500, 500, 500, 98, 80, 500, 44, 500, 500, 234, 144, 70, 40, 500, 500, 238, 500, 66, 500, 500, 322, 68, 60, 412, 60, 500, 500, 500, 500, 70, 142, 500, 204, 260, 268, 42, 500, 44, 164, 212, 500, 104, 282, 106, 500, 500, 500, 500, 64, 38, 54, 236, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37853547240266494, "mean_inference_ms": 1.210686476361856, "mean_action_processing_ms": 0.14164453992329315, "mean_env_wait_ms": 0.08348889306130153, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02698993682861328, "StateBufferConnector_ms": 0.0069997310638427734, "ViewRequirementAgentConnector_ms": 0.11299729347229004}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.114999999999826, "episode_len_mean": 264.48, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.299999999999777, 45.7, 42.30000000000001, 38.700000000000024, 46.9, 25.499999999999922, -50.00000000000044, 45.9, 42.30000000000001, 43.30000000000001, 45.5, 34.10000000000004, 35.900000000000034, 45.5, 43.30000000000001, -50.00000000000044, 36.30000000000003, -50.00000000000044, -50.00000000000044, 31.500000000000007, 40.70000000000002, 43.10000000000001, 26.09999999999993, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 30.9, 32.90000000000003, 30.099999999999987, 43.7, 33.500000000000036, -50.00000000000044, 45.7, 45.3, 44.10000000000001, -50.00000000000044, 39.300000000000026, 45.3, 27.899999999999956, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, 42.10000000000001, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 26.69999999999994, 35.70000000000003, 43.10000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, 26.299999999999933, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 17.899999999999814, 43.30000000000001, 44.10000000000001, 8.899999999999686, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 35.900000000000034, -50.00000000000044, 29.69999999999998, 24.099999999999902, 23.29999999999989, 45.9, -50.00000000000044, 45.7, 33.70000000000004, 28.89999999999997, -50.00000000000044, 39.70000000000002, 21.89999999999987, 39.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 46.3, 44.7, 26.499999999999936, -50.00000000000044, -50.00000000000044], "episode_lengths": [348, 44, 78, 114, 32, 246, 500, 42, 78, 68, 46, 160, 142, 46, 68, 500, 138, 500, 500, 186, 94, 70, 240, 500, 58, 500, 500, 500, 44, 500, 500, 192, 172, 200, 64, 166, 500, 44, 48, 60, 500, 108, 48, 222, 500, 56, 500, 500, 500, 98, 80, 500, 44, 500, 500, 234, 144, 70, 40, 500, 500, 238, 500, 66, 500, 500, 322, 68, 60, 412, 60, 500, 500, 500, 500, 70, 142, 500, 204, 260, 268, 42, 500, 44, 164, 212, 500, 104, 282, 106, 500, 500, 500, 500, 64, 38, 54, 236, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37853547240266494, "mean_inference_ms": 1.210686476361856, "mean_action_processing_ms": 0.14164453992329315, "mean_env_wait_ms": 0.08348889306130153, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02698993682861328, "StateBufferConnector_ms": 0.0069997310638427734, "ViewRequirementAgentConnector_ms": 0.11299729347229004}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5417.681493384036, "num_env_steps_trained_throughput_per_sec": 5417.681493384036, "timesteps_total": 408000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 408000, "timers": {"training_iteration_time_ms": 2271.219, "sample_time_ms": 1916.024, "load_time_ms": 11.667, "load_throughput": 1028528.27, "learn_time_ms": 331.835, "learn_throughput": 36162.537, "synch_weights_time_ms": 9.482}, "counters": {"num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000}, "done": false, "episodes_total": 1523, "training_iteration": 34, "trial_id": "9f288_00017", "date": "2023-10-25_16-57-48", "timestamp": 1698249468, "time_this_iter_s": 2.2208383083343506, "time_total_s": 77.37156820297241, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 77.37156820297241, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 59.5, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1641532182693485e-11, "cur_lr": 0.0003, "total_loss": 6.898928022384643, "policy_loss": -2.1925941109657287e-05, "vf_loss": 6.899005349477132, "vf_explained_var": -1.2000401814778646e-06, "kl": 6.93231136229618e-05, "entropy": 0.5528439005215963, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1035.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.511999999999821, "episode_len_mean": 265.52, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.7, -50.00000000000044, -50.00000000000044, 26.69999999999994, 35.70000000000003, 43.10000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, 26.299999999999933, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 17.899999999999814, 43.30000000000001, 44.10000000000001, 8.899999999999686, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 35.900000000000034, -50.00000000000044, 29.69999999999998, 24.099999999999902, 23.29999999999989, 45.9, -50.00000000000044, 45.7, 33.70000000000004, 28.89999999999997, -50.00000000000044, 39.70000000000002, 21.89999999999987, 39.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 46.3, 44.7, 26.499999999999936, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 46.3, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 43.30000000000001, 30.29999999999999, 41.90000000000001, 12.499999999999737, -50.00000000000044, 43.900000000000006, 23.699999999999896, 44.10000000000001, 43.7, 45.5, 8.099999999999675, -50.00000000000044, -50.00000000000044, 42.500000000000014, 46.699999999999996, 41.90000000000001, 44.900000000000006, 41.70000000000002, 40.30000000000002, 36.50000000000003, 44.300000000000004, 45.3, -50.00000000000044, 36.70000000000003, 38.10000000000002, 45.7, 25.899999999999928, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 3.2999999999996064, -50.00000000000044, 42.500000000000014, 43.10000000000001, 7.499999999999666, -50.00000000000044, 35.900000000000034, 44.7, 45.1, 40.30000000000002], "episode_lengths": [44, 500, 500, 234, 144, 70, 40, 500, 500, 238, 500, 66, 500, 500, 322, 68, 60, 412, 60, 500, 500, 500, 500, 70, 142, 500, 204, 260, 268, 42, 500, 44, 164, 212, 500, 104, 282, 106, 500, 500, 500, 500, 64, 38, 54, 236, 500, 500, 500, 62, 38, 500, 500, 44, 500, 500, 42, 500, 500, 68, 198, 82, 376, 500, 62, 264, 60, 64, 46, 420, 500, 500, 76, 34, 82, 52, 84, 98, 136, 58, 48, 500, 134, 120, 44, 242, 500, 500, 500, 86, 468, 500, 76, 70, 426, 500, 142, 54, 50, 98]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3784527672237463, "mean_inference_ms": 1.2084262189268427, "mean_action_processing_ms": 0.141160329743783, "mean_env_wait_ms": 0.08377491088320951, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03100442886352539, "StateBufferConnector_ms": 0.00500035285949707, "ViewRequirementAgentConnector_ms": 0.11596012115478516}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.511999999999821, "episode_len_mean": 265.52, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.7, -50.00000000000044, -50.00000000000044, 26.69999999999994, 35.70000000000003, 43.10000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, 26.299999999999933, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 17.899999999999814, 43.30000000000001, 44.10000000000001, 8.899999999999686, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 35.900000000000034, -50.00000000000044, 29.69999999999998, 24.099999999999902, 23.29999999999989, 45.9, -50.00000000000044, 45.7, 33.70000000000004, 28.89999999999997, -50.00000000000044, 39.70000000000002, 21.89999999999987, 39.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 46.3, 44.7, 26.499999999999936, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 46.3, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 43.30000000000001, 30.29999999999999, 41.90000000000001, 12.499999999999737, -50.00000000000044, 43.900000000000006, 23.699999999999896, 44.10000000000001, 43.7, 45.5, 8.099999999999675, -50.00000000000044, -50.00000000000044, 42.500000000000014, 46.699999999999996, 41.90000000000001, 44.900000000000006, 41.70000000000002, 40.30000000000002, 36.50000000000003, 44.300000000000004, 45.3, -50.00000000000044, 36.70000000000003, 38.10000000000002, 45.7, 25.899999999999928, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 3.2999999999996064, -50.00000000000044, 42.500000000000014, 43.10000000000001, 7.499999999999666, -50.00000000000044, 35.900000000000034, 44.7, 45.1, 40.30000000000002], "episode_lengths": [44, 500, 500, 234, 144, 70, 40, 500, 500, 238, 500, 66, 500, 500, 322, 68, 60, 412, 60, 500, 500, 500, 500, 70, 142, 500, 204, 260, 268, 42, 500, 44, 164, 212, 500, 104, 282, 106, 500, 500, 500, 500, 64, 38, 54, 236, 500, 500, 500, 62, 38, 500, 500, 44, 500, 500, 42, 500, 500, 68, 198, 82, 376, 500, 62, 264, 60, 64, 46, 420, 500, 500, 76, 34, 82, 52, 84, 98, 136, 58, 48, 500, 134, 120, 44, 242, 500, 500, 500, 86, 468, 500, 76, 70, 426, 500, 142, 54, 50, 98]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3784527672237463, "mean_inference_ms": 1.2084262189268427, "mean_action_processing_ms": 0.141160329743783, "mean_env_wait_ms": 0.08377491088320951, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03100442886352539, "StateBufferConnector_ms": 0.00500035285949707, "ViewRequirementAgentConnector_ms": 0.11596012115478516}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5164.833978548734, "num_env_steps_trained_throughput_per_sec": 5164.833978548734, "timesteps_total": 420000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 420000, "timers": {"training_iteration_time_ms": 2269.348, "sample_time_ms": 1913.218, "load_time_ms": 11.866, "load_throughput": 1011309.254, "learn_time_ms": 332.623, "learn_throughput": 36076.874, "synch_weights_time_ms": 9.431}, "counters": {"num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000}, "done": false, "episodes_total": 1575, "training_iteration": 35, "trial_id": "9f288_00017", "date": "2023-10-25_16-57-51", "timestamp": 1698249471, "time_this_iter_s": 2.3284010887145996, "time_total_s": 79.69996929168701, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 79.69996929168701, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 60.866666666666674, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.820766091346743e-12, "cur_lr": 0.0003, "total_loss": 7.137126143773397, "policy_loss": -0.0003803352204461892, "vf_loss": 7.1375587463378904, "vf_explained_var": -1.7623106638590495e-06, "kl": 0.0009670046794174899, "entropy": 0.5223834812641144, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1065.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.752999999999856, "episode_len_mean": 228.18, "episode_media": {}, "episodes_this_iter": 57, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 43.30000000000001, 30.29999999999999, 41.90000000000001, 12.499999999999737, -50.00000000000044, 43.900000000000006, 23.699999999999896, 44.10000000000001, 43.7, 45.5, 8.099999999999675, -50.00000000000044, -50.00000000000044, 42.500000000000014, 46.699999999999996, 41.90000000000001, 44.900000000000006, 41.70000000000002, 40.30000000000002, 36.50000000000003, 44.300000000000004, 45.3, -50.00000000000044, 36.70000000000003, 38.10000000000002, 45.7, 25.899999999999928, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 3.2999999999996064, -50.00000000000044, 42.500000000000014, 43.10000000000001, 7.499999999999666, -50.00000000000044, 35.900000000000034, 44.7, 45.1, 40.30000000000002, -50.00000000000044, -50.00000000000044, 38.90000000000002, -50.00000000000044, 44.900000000000006, 43.50000000000001, 44.10000000000001, 46.699999999999996, 43.10000000000001, 41.90000000000001, -50.00000000000044, -50.00000000000044, 37.90000000000003, 39.10000000000002, 29.49999999999998, 30.699999999999996, 46.9, 18.499999999999822, 33.90000000000004, 31.900000000000013, -50.00000000000044, 43.50000000000001, -50.00000000000044, 8.899999999999686, 38.50000000000003, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 45.3, 46.099999999999994, 42.900000000000006, -50.00000000000044, -50.00000000000044, 43.30000000000001, 46.099999999999994, 28.29999999999996, 44.300000000000004, -50.00000000000044, -50.00000000000044, 43.7, 45.1, 39.50000000000002, 47.3, 42.70000000000001, 33.70000000000004, 44.300000000000004, -50.00000000000044, 42.500000000000014, 40.90000000000002, -50.00000000000044, 46.699999999999996, 46.699999999999996, 46.099999999999994, -50.00000000000044, 34.70000000000004], "episode_lengths": [500, 500, 68, 198, 82, 376, 500, 62, 264, 60, 64, 46, 420, 500, 500, 76, 34, 82, 52, 84, 98, 136, 58, 48, 500, 134, 120, 44, 242, 500, 500, 500, 86, 468, 500, 76, 70, 426, 500, 142, 54, 50, 98, 500, 500, 112, 500, 52, 66, 60, 34, 70, 82, 500, 500, 122, 110, 206, 194, 32, 316, 162, 182, 500, 66, 500, 412, 116, 500, 500, 88, 500, 500, 48, 40, 72, 500, 500, 68, 40, 218, 58, 500, 500, 64, 50, 106, 28, 74, 164, 58, 500, 76, 92, 500, 34, 34, 40, 500, 154]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3778443773232716, "mean_inference_ms": 1.2083605415251677, "mean_action_processing_ms": 0.14101998869256768, "mean_env_wait_ms": 0.08377607213532753, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03199911117553711, "StateBufferConnector_ms": 0.003996133804321289, "ViewRequirementAgentConnector_ms": 0.12694334983825684}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.752999999999856, "episode_len_mean": 228.18, "episodes_this_iter": 57, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 43.30000000000001, 30.29999999999999, 41.90000000000001, 12.499999999999737, -50.00000000000044, 43.900000000000006, 23.699999999999896, 44.10000000000001, 43.7, 45.5, 8.099999999999675, -50.00000000000044, -50.00000000000044, 42.500000000000014, 46.699999999999996, 41.90000000000001, 44.900000000000006, 41.70000000000002, 40.30000000000002, 36.50000000000003, 44.300000000000004, 45.3, -50.00000000000044, 36.70000000000003, 38.10000000000002, 45.7, 25.899999999999928, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 3.2999999999996064, -50.00000000000044, 42.500000000000014, 43.10000000000001, 7.499999999999666, -50.00000000000044, 35.900000000000034, 44.7, 45.1, 40.30000000000002, -50.00000000000044, -50.00000000000044, 38.90000000000002, -50.00000000000044, 44.900000000000006, 43.50000000000001, 44.10000000000001, 46.699999999999996, 43.10000000000001, 41.90000000000001, -50.00000000000044, -50.00000000000044, 37.90000000000003, 39.10000000000002, 29.49999999999998, 30.699999999999996, 46.9, 18.499999999999822, 33.90000000000004, 31.900000000000013, -50.00000000000044, 43.50000000000001, -50.00000000000044, 8.899999999999686, 38.50000000000003, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 45.3, 46.099999999999994, 42.900000000000006, -50.00000000000044, -50.00000000000044, 43.30000000000001, 46.099999999999994, 28.29999999999996, 44.300000000000004, -50.00000000000044, -50.00000000000044, 43.7, 45.1, 39.50000000000002, 47.3, 42.70000000000001, 33.70000000000004, 44.300000000000004, -50.00000000000044, 42.500000000000014, 40.90000000000002, -50.00000000000044, 46.699999999999996, 46.699999999999996, 46.099999999999994, -50.00000000000044, 34.70000000000004], "episode_lengths": [500, 500, 68, 198, 82, 376, 500, 62, 264, 60, 64, 46, 420, 500, 500, 76, 34, 82, 52, 84, 98, 136, 58, 48, 500, 134, 120, 44, 242, 500, 500, 500, 86, 468, 500, 76, 70, 426, 500, 142, 54, 50, 98, 500, 500, 112, 500, 52, 66, 60, 34, 70, 82, 500, 500, 122, 110, 206, 194, 32, 316, 162, 182, 500, 66, 500, 412, 116, 500, 500, 88, 500, 500, 48, 40, 72, 500, 500, 68, 40, 218, 58, 500, 500, 64, 50, 106, 28, 74, 164, 58, 500, 76, 92, 500, 34, 34, 40, 500, 154]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3778443773232716, "mean_inference_ms": 1.2083605415251677, "mean_action_processing_ms": 0.14101998869256768, "mean_env_wait_ms": 0.08377607213532753, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03199911117553711, "StateBufferConnector_ms": 0.003996133804321289, "ViewRequirementAgentConnector_ms": 0.12694334983825684}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5544.207687833765, "num_env_steps_trained_throughput_per_sec": 5544.207687833765, "timesteps_total": 432000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 432000, "timers": {"training_iteration_time_ms": 2262.188, "sample_time_ms": 1913.185, "load_time_ms": 11.571, "load_throughput": 1037032.532, "learn_time_ms": 326.076, "learn_throughput": 36801.225, "synch_weights_time_ms": 9.154}, "counters": {"num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "done": false, "episodes_total": 1632, "training_iteration": 36, "trial_id": "9f288_00017", "date": "2023-10-25_16-57-53", "timestamp": 1698249473, "time_this_iter_s": 2.1694183349609375, "time_total_s": 81.86938762664795, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 81.86938762664795, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 57.699999999999996, "ram_util_percent": 27.166666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.9103830456733713e-12, "cur_lr": 0.0003, "total_loss": 6.586782646179199, "policy_loss": -0.0012271551454129319, "vf_loss": 6.588060887654622, "vf_explained_var": -6.079673767089843e-07, "kl": 0.0016804112177813597, "entropy": 0.510806389649709, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1095.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_agent_steps_sampled": 444000, "num_agent_steps_trained": 444000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.198999999999842, "episode_len_mean": 243.66, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 38.90000000000002, -50.00000000000044, 44.900000000000006, 43.50000000000001, 44.10000000000001, 46.699999999999996, 43.10000000000001, 41.90000000000001, -50.00000000000044, -50.00000000000044, 37.90000000000003, 39.10000000000002, 29.49999999999998, 30.699999999999996, 46.9, 18.499999999999822, 33.90000000000004, 31.900000000000013, -50.00000000000044, 43.50000000000001, -50.00000000000044, 8.899999999999686, 38.50000000000003, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 45.3, 46.099999999999994, 42.900000000000006, -50.00000000000044, -50.00000000000044, 43.30000000000001, 46.099999999999994, 28.29999999999996, 44.300000000000004, -50.00000000000044, -50.00000000000044, 43.7, 45.1, 39.50000000000002, 47.3, 42.70000000000001, 33.70000000000004, 44.300000000000004, -50.00000000000044, 42.500000000000014, 40.90000000000002, -50.00000000000044, 46.699999999999996, 46.699999999999996, 46.099999999999994, -50.00000000000044, 34.70000000000004, -50.00000000000044, 46.5, -50.00000000000044, 35.70000000000003, 44.900000000000006, 28.09999999999996, -50.00000000000044, -50.00000000000044, 35.70000000000003, -50.00000000000044, 45.7, 44.300000000000004, 7.699999999999669, 36.70000000000003, 39.90000000000002, 43.10000000000001, 44.7, 29.899999999999984, 39.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.29999999999999, -50.00000000000044, -50.00000000000044, 42.30000000000001, 45.7, 42.30000000000001, -50.00000000000044, 40.70000000000002, -50.00000000000044, 44.5, 42.500000000000014, -50.00000000000044, 44.10000000000001, 34.50000000000004, 40.500000000000014, 39.90000000000002, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 112, 500, 52, 66, 60, 34, 70, 82, 500, 500, 122, 110, 206, 194, 32, 316, 162, 182, 500, 66, 500, 412, 116, 500, 500, 88, 500, 500, 48, 40, 72, 500, 500, 68, 40, 218, 58, 500, 500, 64, 50, 106, 28, 74, 164, 58, 500, 76, 92, 500, 34, 34, 40, 500, 154, 500, 36, 500, 144, 52, 220, 500, 500, 144, 500, 44, 58, 424, 134, 102, 70, 54, 202, 108, 500, 500, 500, 198, 500, 500, 78, 44, 78, 500, 94, 500, 56, 76, 500, 60, 156, 96, 102, 500, 500, 36, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37731037817616553, "mean_inference_ms": 1.2096789366641019, "mean_action_processing_ms": 0.14100206218912487, "mean_env_wait_ms": 0.08362381859374265, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026991605758666992, "StateBufferConnector_ms": 0.0029954910278320312, "ViewRequirementAgentConnector_ms": 0.1269972324371338}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.198999999999842, "episode_len_mean": 243.66, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 38.90000000000002, -50.00000000000044, 44.900000000000006, 43.50000000000001, 44.10000000000001, 46.699999999999996, 43.10000000000001, 41.90000000000001, -50.00000000000044, -50.00000000000044, 37.90000000000003, 39.10000000000002, 29.49999999999998, 30.699999999999996, 46.9, 18.499999999999822, 33.90000000000004, 31.900000000000013, -50.00000000000044, 43.50000000000001, -50.00000000000044, 8.899999999999686, 38.50000000000003, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 45.3, 46.099999999999994, 42.900000000000006, -50.00000000000044, -50.00000000000044, 43.30000000000001, 46.099999999999994, 28.29999999999996, 44.300000000000004, -50.00000000000044, -50.00000000000044, 43.7, 45.1, 39.50000000000002, 47.3, 42.70000000000001, 33.70000000000004, 44.300000000000004, -50.00000000000044, 42.500000000000014, 40.90000000000002, -50.00000000000044, 46.699999999999996, 46.699999999999996, 46.099999999999994, -50.00000000000044, 34.70000000000004, -50.00000000000044, 46.5, -50.00000000000044, 35.70000000000003, 44.900000000000006, 28.09999999999996, -50.00000000000044, -50.00000000000044, 35.70000000000003, -50.00000000000044, 45.7, 44.300000000000004, 7.699999999999669, 36.70000000000003, 39.90000000000002, 43.10000000000001, 44.7, 29.899999999999984, 39.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.29999999999999, -50.00000000000044, -50.00000000000044, 42.30000000000001, 45.7, 42.30000000000001, -50.00000000000044, 40.70000000000002, -50.00000000000044, 44.5, 42.500000000000014, -50.00000000000044, 44.10000000000001, 34.50000000000004, 40.500000000000014, 39.90000000000002, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 112, 500, 52, 66, 60, 34, 70, 82, 500, 500, 122, 110, 206, 194, 32, 316, 162, 182, 500, 66, 500, 412, 116, 500, 500, 88, 500, 500, 48, 40, 72, 500, 500, 68, 40, 218, 58, 500, 500, 64, 50, 106, 28, 74, 164, 58, 500, 76, 92, 500, 34, 34, 40, 500, 154, 500, 36, 500, 144, 52, 220, 500, 500, 144, 500, 44, 58, 424, 134, 102, 70, 54, 202, 108, 500, 500, 500, 198, 500, 500, 78, 44, 78, 500, 94, 500, 56, 76, 500, 60, 156, 96, 102, 500, 500, 36, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37731037817616553, "mean_inference_ms": 1.2096789366641019, "mean_action_processing_ms": 0.14100206218912487, "mean_env_wait_ms": 0.08362381859374265, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026991605758666992, "StateBufferConnector_ms": 0.0029954910278320312, "ViewRequirementAgentConnector_ms": 0.1269972324371338}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 444000, "num_agent_steps_trained": 444000, "num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5168.007946540336, "num_env_steps_trained_throughput_per_sec": 5168.007946540336, "timesteps_total": 444000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 444000, "timers": {"training_iteration_time_ms": 2264.069, "sample_time_ms": 1913.537, "load_time_ms": 10.673, "load_throughput": 1124352.686, "learn_time_ms": 328.463, "learn_throughput": 36533.813, "synch_weights_time_ms": 9.295}, "counters": {"num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_agent_steps_sampled": 444000, "num_agent_steps_trained": 444000}, "done": false, "episodes_total": 1676, "training_iteration": 37, "trial_id": "9f288_00017", "date": "2023-10-25_16-57-55", "timestamp": 1698249475, "time_this_iter_s": 2.326976776123047, "time_total_s": 84.196364402771, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 84.196364402771, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 59.300000000000004, "ram_util_percent": 27.166666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.4551915228366857e-12, "cur_lr": 0.0003, "total_loss": 6.015064239501953, "policy_loss": -0.000948356216152509, "vf_loss": 6.01606338818868, "vf_explained_var": -8.642673492431641e-07, "kl": 0.0010735100482397305, "entropy": 0.5082415044307709, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1125.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.03400000000020242, "episode_len_mean": 280.9, "episode_media": {}, "episodes_this_iter": 33, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 43.30000000000001, 46.099999999999994, 28.29999999999996, 44.300000000000004, -50.00000000000044, -50.00000000000044, 43.7, 45.1, 39.50000000000002, 47.3, 42.70000000000001, 33.70000000000004, 44.300000000000004, -50.00000000000044, 42.500000000000014, 40.90000000000002, -50.00000000000044, 46.699999999999996, 46.699999999999996, 46.099999999999994, -50.00000000000044, 34.70000000000004, -50.00000000000044, 46.5, -50.00000000000044, 35.70000000000003, 44.900000000000006, 28.09999999999996, -50.00000000000044, -50.00000000000044, 35.70000000000003, -50.00000000000044, 45.7, 44.300000000000004, 7.699999999999669, 36.70000000000003, 39.90000000000002, 43.10000000000001, 44.7, 29.899999999999984, 39.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.29999999999999, -50.00000000000044, -50.00000000000044, 42.30000000000001, 45.7, 42.30000000000001, -50.00000000000044, 40.70000000000002, -50.00000000000044, 44.5, 42.500000000000014, -50.00000000000044, 44.10000000000001, 34.50000000000004, 40.500000000000014, 39.90000000000002, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 16.699999999999797, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, 44.900000000000006, 46.5, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 31.1, -50.00000000000044, -50.00000000000044, 14.699999999999768, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.50000000000003, -50.00000000000044, 47.1, -50.00000000000044, 8.099999999999675, 40.90000000000002, -50.00000000000044, 46.5], "episode_lengths": [500, 68, 40, 218, 58, 500, 500, 64, 50, 106, 28, 74, 164, 58, 500, 76, 92, 500, 34, 34, 40, 500, 154, 500, 36, 500, 144, 52, 220, 500, 500, 144, 500, 44, 58, 424, 134, 102, 70, 54, 202, 108, 500, 500, 500, 198, 500, 500, 78, 44, 78, 500, 94, 500, 56, 76, 500, 60, 156, 96, 102, 500, 500, 36, 500, 500, 500, 500, 44, 334, 500, 500, 500, 500, 500, 500, 500, 96, 500, 52, 36, 500, 46, 500, 500, 190, 500, 500, 354, 500, 500, 500, 136, 500, 30, 500, 420, 92, 500, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3779161477069867, "mean_inference_ms": 1.2097586648397463, "mean_action_processing_ms": 0.14139392114664667, "mean_env_wait_ms": 0.08389336414752165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020998239517211914, "StateBufferConnector_ms": 0.003999233245849609, "ViewRequirementAgentConnector_ms": 0.11401629447937012}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.03400000000020242, "episode_len_mean": 280.9, "episodes_this_iter": 33, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 43.30000000000001, 46.099999999999994, 28.29999999999996, 44.300000000000004, -50.00000000000044, -50.00000000000044, 43.7, 45.1, 39.50000000000002, 47.3, 42.70000000000001, 33.70000000000004, 44.300000000000004, -50.00000000000044, 42.500000000000014, 40.90000000000002, -50.00000000000044, 46.699999999999996, 46.699999999999996, 46.099999999999994, -50.00000000000044, 34.70000000000004, -50.00000000000044, 46.5, -50.00000000000044, 35.70000000000003, 44.900000000000006, 28.09999999999996, -50.00000000000044, -50.00000000000044, 35.70000000000003, -50.00000000000044, 45.7, 44.300000000000004, 7.699999999999669, 36.70000000000003, 39.90000000000002, 43.10000000000001, 44.7, 29.899999999999984, 39.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.29999999999999, -50.00000000000044, -50.00000000000044, 42.30000000000001, 45.7, 42.30000000000001, -50.00000000000044, 40.70000000000002, -50.00000000000044, 44.5, 42.500000000000014, -50.00000000000044, 44.10000000000001, 34.50000000000004, 40.500000000000014, 39.90000000000002, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 16.699999999999797, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, 44.900000000000006, 46.5, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 31.1, -50.00000000000044, -50.00000000000044, 14.699999999999768, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.50000000000003, -50.00000000000044, 47.1, -50.00000000000044, 8.099999999999675, 40.90000000000002, -50.00000000000044, 46.5], "episode_lengths": [500, 68, 40, 218, 58, 500, 500, 64, 50, 106, 28, 74, 164, 58, 500, 76, 92, 500, 34, 34, 40, 500, 154, 500, 36, 500, 144, 52, 220, 500, 500, 144, 500, 44, 58, 424, 134, 102, 70, 54, 202, 108, 500, 500, 500, 198, 500, 500, 78, 44, 78, 500, 94, 500, 56, 76, 500, 60, 156, 96, 102, 500, 500, 36, 500, 500, 500, 500, 44, 334, 500, 500, 500, 500, 500, 500, 500, 96, 500, 52, 36, 500, 46, 500, 500, 190, 500, 500, 354, 500, 500, 500, 136, 500, 30, 500, 420, 92, 500, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3779161477069867, "mean_inference_ms": 1.2097586648397463, "mean_action_processing_ms": 0.14139392114664667, "mean_env_wait_ms": 0.08389336414752165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020998239517211914, "StateBufferConnector_ms": 0.003999233245849609, "ViewRequirementAgentConnector_ms": 0.11401629447937012}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5305.693329581977, "num_env_steps_trained_throughput_per_sec": 5305.693329581977, "timesteps_total": 456000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 456000, "timers": {"training_iteration_time_ms": 2266.087, "sample_time_ms": 1911.67, "load_time_ms": 11.545, "load_throughput": 1039411.852, "learn_time_ms": 331.204, "learn_throughput": 36231.396, "synch_weights_time_ms": 9.666}, "counters": {"num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000}, "done": false, "episodes_total": 1709, "training_iteration": 38, "trial_id": "9f288_00017", "date": "2023-10-25_16-57-58", "timestamp": 1698249478, "time_this_iter_s": 2.266732692718506, "time_total_s": 86.4630970954895, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 86.4630970954895, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 52.25, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.275957614183428e-13, "cur_lr": 0.0003, "total_loss": 6.583858791987101, "policy_loss": -0.0004981901496648788, "vf_loss": 6.584409538904826, "vf_explained_var": -1.1146068572998046e-06, "kl": 0.0010109441736631196, "entropy": 0.5268061399459839, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1155.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -2.8680000000002197, "episode_len_mean": 299.22, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [30.29999999999999, -50.00000000000044, -50.00000000000044, 42.30000000000001, 45.7, 42.30000000000001, -50.00000000000044, 40.70000000000002, -50.00000000000044, 44.5, 42.500000000000014, -50.00000000000044, 44.10000000000001, 34.50000000000004, 40.500000000000014, 39.90000000000002, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 16.699999999999797, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, 44.900000000000006, 46.5, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 31.1, -50.00000000000044, -50.00000000000044, 14.699999999999768, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.50000000000003, -50.00000000000044, 47.1, -50.00000000000044, 8.099999999999675, 40.90000000000002, -50.00000000000044, 46.5, -50.00000000000044, 32.100000000000016, 35.900000000000034, -50.00000000000044, -50.00000000000044, 47.7, 40.30000000000002, 13.699999999999754, 46.5, 44.5, 21.09999999999986, -50.00000000000044, -50.00000000000044, 8.49999999999968, 13.699999999999754, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.69999999999981, 19.299999999999834, 32.50000000000002, 41.30000000000001, -50.00000000000044, -50.00000000000044, 42.500000000000014, 45.9, 40.500000000000014, 43.50000000000001, 44.10000000000001, -50.00000000000044, 46.3, 35.30000000000004, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 34.10000000000004, 42.10000000000001, 41.100000000000016, -50.00000000000044, 45.5, 42.70000000000001, -50.00000000000044, 46.3, 44.300000000000004], "episode_lengths": [198, 500, 500, 78, 44, 78, 500, 94, 500, 56, 76, 500, 60, 156, 96, 102, 500, 500, 36, 500, 500, 500, 500, 44, 334, 500, 500, 500, 500, 500, 500, 500, 96, 500, 52, 36, 500, 46, 500, 500, 190, 500, 500, 354, 500, 500, 500, 136, 500, 30, 500, 420, 92, 500, 36, 500, 180, 142, 500, 500, 24, 98, 364, 36, 56, 290, 500, 500, 416, 364, 500, 500, 500, 324, 308, 176, 88, 500, 500, 76, 42, 96, 66, 60, 500, 38, 148, 500, 500, 44, 500, 160, 80, 90, 500, 46, 74, 500, 38, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37807805541622364, "mean_inference_ms": 1.210642131724047, "mean_action_processing_ms": 0.14107668926555647, "mean_env_wait_ms": 0.08430600468739455, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014001846313476562, "StateBufferConnector_ms": 0.005999565124511719, "ViewRequirementAgentConnector_ms": 0.10819387435913086}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -2.8680000000002197, "episode_len_mean": 299.22, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [30.29999999999999, -50.00000000000044, -50.00000000000044, 42.30000000000001, 45.7, 42.30000000000001, -50.00000000000044, 40.70000000000002, -50.00000000000044, 44.5, 42.500000000000014, -50.00000000000044, 44.10000000000001, 34.50000000000004, 40.500000000000014, 39.90000000000002, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 16.699999999999797, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, 44.900000000000006, 46.5, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 31.1, -50.00000000000044, -50.00000000000044, 14.699999999999768, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.50000000000003, -50.00000000000044, 47.1, -50.00000000000044, 8.099999999999675, 40.90000000000002, -50.00000000000044, 46.5, -50.00000000000044, 32.100000000000016, 35.900000000000034, -50.00000000000044, -50.00000000000044, 47.7, 40.30000000000002, 13.699999999999754, 46.5, 44.5, 21.09999999999986, -50.00000000000044, -50.00000000000044, 8.49999999999968, 13.699999999999754, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.69999999999981, 19.299999999999834, 32.50000000000002, 41.30000000000001, -50.00000000000044, -50.00000000000044, 42.500000000000014, 45.9, 40.500000000000014, 43.50000000000001, 44.10000000000001, -50.00000000000044, 46.3, 35.30000000000004, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 34.10000000000004, 42.10000000000001, 41.100000000000016, -50.00000000000044, 45.5, 42.70000000000001, -50.00000000000044, 46.3, 44.300000000000004], "episode_lengths": [198, 500, 500, 78, 44, 78, 500, 94, 500, 56, 76, 500, 60, 156, 96, 102, 500, 500, 36, 500, 500, 500, 500, 44, 334, 500, 500, 500, 500, 500, 500, 500, 96, 500, 52, 36, 500, 46, 500, 500, 190, 500, 500, 354, 500, 500, 500, 136, 500, 30, 500, 420, 92, 500, 36, 500, 180, 142, 500, 500, 24, 98, 364, 36, 56, 290, 500, 500, 416, 364, 500, 500, 500, 324, 308, 176, 88, 500, 500, 76, 42, 96, 66, 60, 500, 38, 148, 500, 500, 44, 500, 160, 80, 90, 500, 46, 74, 500, 38, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37807805541622364, "mean_inference_ms": 1.210642131724047, "mean_action_processing_ms": 0.14107668926555647, "mean_env_wait_ms": 0.08430600468739455, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014001846313476562, "StateBufferConnector_ms": 0.005999565124511719, "ViewRequirementAgentConnector_ms": 0.10819387435913086}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5341.923150359971, "num_env_steps_trained_throughput_per_sec": 5341.923150359971, "timesteps_total": 468000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 468000, "timers": {"training_iteration_time_ms": 2259.086, "sample_time_ms": 1911.016, "load_time_ms": 10.843, "load_throughput": 1106683.817, "learn_time_ms": 325.645, "learn_throughput": 36849.985, "synch_weights_time_ms": 9.781}, "counters": {"num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000}, "done": false, "episodes_total": 1754, "training_iteration": 39, "trial_id": "9f288_00017", "date": "2023-10-25_16-58-00", "timestamp": 1698249480, "time_this_iter_s": 2.2513906955718994, "time_total_s": 88.7144877910614, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 88.7144877910614, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 60.56666666666667, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.637978807091714e-13, "cur_lr": 0.0003, "total_loss": 6.4994793891906735, "policy_loss": -0.00013731718063354493, "vf_loss": 6.499665673573812, "vf_explained_var": -1.0947386423746745e-06, "kl": 0.0004094207679713691, "entropy": 0.48964039584000907, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1185.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "sampler_results": {"episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.699999999999819, "episode_len_mean": 263.62, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [36.50000000000003, -50.00000000000044, 47.1, -50.00000000000044, 8.099999999999675, 40.90000000000002, -50.00000000000044, 46.5, -50.00000000000044, 32.100000000000016, 35.900000000000034, -50.00000000000044, -50.00000000000044, 47.7, 40.30000000000002, 13.699999999999754, 46.5, 44.5, 21.09999999999986, -50.00000000000044, -50.00000000000044, 8.49999999999968, 13.699999999999754, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.69999999999981, 19.299999999999834, 32.50000000000002, 41.30000000000001, -50.00000000000044, -50.00000000000044, 42.500000000000014, 45.9, 40.500000000000014, 43.50000000000001, 44.10000000000001, -50.00000000000044, 46.3, 35.30000000000004, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 34.10000000000004, 42.10000000000001, 41.100000000000016, -50.00000000000044, 45.5, 42.70000000000001, -50.00000000000044, 46.3, 44.300000000000004, 17.899999999999814, 46.9, -50.00000000000044, 31.500000000000007, 44.7, 33.90000000000004, 33.500000000000036, 48.1, -50.00000000000044, 44.10000000000001, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 44.5, 41.100000000000016, 21.89999999999987, 46.3, -50.00000000000044, -50.00000000000044, 39.10000000000002, 42.70000000000001, -50.00000000000044, -50.00000000000044, 41.100000000000016, 42.30000000000001, 35.10000000000004, -50.00000000000044, -50.00000000000044, 39.50000000000002, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 43.900000000000006, 41.90000000000001, 41.100000000000016, -50.00000000000044, 42.70000000000001, 44.5], "episode_lengths": [136, 500, 30, 500, 420, 92, 500, 36, 500, 180, 142, 500, 500, 24, 98, 364, 36, 56, 290, 500, 500, 416, 364, 500, 500, 500, 324, 308, 176, 88, 500, 500, 76, 42, 96, 66, 60, 500, 38, 148, 500, 500, 44, 500, 160, 80, 90, 500, 46, 74, 500, 38, 58, 322, 32, 500, 186, 54, 162, 166, 20, 500, 60, 32, 500, 500, 500, 500, 26, 56, 90, 282, 38, 500, 500, 110, 74, 500, 500, 90, 78, 150, 500, 500, 106, 84, 500, 500, 500, 52, 500, 32, 500, 500, 62, 82, 90, 500, 74, 56]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3780493808970842, "mean_inference_ms": 1.2098725396365149, "mean_action_processing_ms": 0.1408007689529215, "mean_env_wait_ms": 0.08423461561794426, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02501988410949707, "StateBufferConnector_ms": 0.005001068115234375, "ViewRequirementAgentConnector_ms": 0.10659408569335938}}, "episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.699999999999819, "episode_len_mean": 263.62, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [36.50000000000003, -50.00000000000044, 47.1, -50.00000000000044, 8.099999999999675, 40.90000000000002, -50.00000000000044, 46.5, -50.00000000000044, 32.100000000000016, 35.900000000000034, -50.00000000000044, -50.00000000000044, 47.7, 40.30000000000002, 13.699999999999754, 46.5, 44.5, 21.09999999999986, -50.00000000000044, -50.00000000000044, 8.49999999999968, 13.699999999999754, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.69999999999981, 19.299999999999834, 32.50000000000002, 41.30000000000001, -50.00000000000044, -50.00000000000044, 42.500000000000014, 45.9, 40.500000000000014, 43.50000000000001, 44.10000000000001, -50.00000000000044, 46.3, 35.30000000000004, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 34.10000000000004, 42.10000000000001, 41.100000000000016, -50.00000000000044, 45.5, 42.70000000000001, -50.00000000000044, 46.3, 44.300000000000004, 17.899999999999814, 46.9, -50.00000000000044, 31.500000000000007, 44.7, 33.90000000000004, 33.500000000000036, 48.1, -50.00000000000044, 44.10000000000001, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 44.5, 41.100000000000016, 21.89999999999987, 46.3, -50.00000000000044, -50.00000000000044, 39.10000000000002, 42.70000000000001, -50.00000000000044, -50.00000000000044, 41.100000000000016, 42.30000000000001, 35.10000000000004, -50.00000000000044, -50.00000000000044, 39.50000000000002, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 43.900000000000006, 41.90000000000001, 41.100000000000016, -50.00000000000044, 42.70000000000001, 44.5], "episode_lengths": [136, 500, 30, 500, 420, 92, 500, 36, 500, 180, 142, 500, 500, 24, 98, 364, 36, 56, 290, 500, 500, 416, 364, 500, 500, 500, 324, 308, 176, 88, 500, 500, 76, 42, 96, 66, 60, 500, 38, 148, 500, 500, 44, 500, 160, 80, 90, 500, 46, 74, 500, 38, 58, 322, 32, 500, 186, 54, 162, 166, 20, 500, 60, 32, 500, 500, 500, 500, 26, 56, 90, 282, 38, 500, 500, 110, 74, 500, 500, 90, 78, 150, 500, 500, 106, 84, 500, 500, 500, 52, 500, 32, 500, 500, 62, 82, 90, 500, 74, 56]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3780493808970842, "mean_inference_ms": 1.2098725396365149, "mean_action_processing_ms": 0.1408007689529215, "mean_env_wait_ms": 0.08423461561794426, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02501988410949707, "StateBufferConnector_ms": 0.005001068115234375, "ViewRequirementAgentConnector_ms": 0.10659408569335938}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5198.3002434951595, "num_env_steps_trained_throughput_per_sec": 5198.3002434951595, "timesteps_total": 480000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 480000, "timers": {"training_iteration_time_ms": 2275.611, "sample_time_ms": 1916.644, "load_time_ms": 11.543, "load_throughput": 1039575.013, "learn_time_ms": 336.01, "learn_throughput": 35713.273, "synch_weights_time_ms": 9.612}, "counters": {"num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "done": false, "episodes_total": 1801, "training_iteration": 40, "trial_id": "9f288_00017", "date": "2023-10-25_16-58-02", "timestamp": 1698249482, "time_this_iter_s": 2.314443588256836, "time_total_s": 91.02893137931824, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 91.02893137931824, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 60.6, "ram_util_percent": 27.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.818989403545857e-13, "cur_lr": 0.0003, "total_loss": 6.293435637156168, "policy_loss": -0.00032981634140014646, "vf_loss": 6.293814659118652, "vf_explained_var": -1.3709068298339844e-06, "kl": 0.0006405907902587179, "entropy": 0.49162108898162843, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1215.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_agent_steps_sampled": 492000, "num_agent_steps_trained": 492000}, "sampler_results": {"episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.644999999999833, "episode_len_mean": 249.18, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.5, 42.70000000000001, -50.00000000000044, 46.3, 44.300000000000004, 17.899999999999814, 46.9, -50.00000000000044, 31.500000000000007, 44.7, 33.90000000000004, 33.500000000000036, 48.1, -50.00000000000044, 44.10000000000001, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 44.5, 41.100000000000016, 21.89999999999987, 46.3, -50.00000000000044, -50.00000000000044, 39.10000000000002, 42.70000000000001, -50.00000000000044, -50.00000000000044, 41.100000000000016, 42.30000000000001, 35.10000000000004, -50.00000000000044, -50.00000000000044, 39.50000000000002, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 43.900000000000006, 41.90000000000001, 41.100000000000016, -50.00000000000044, 42.70000000000001, 44.5, 36.900000000000034, 9.8999999999997, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.499999999999837, 15.699999999999783, -50.00000000000044, 45.7, 35.500000000000036, 44.5, -50.00000000000044, 45.1, 31.900000000000013, -50.00000000000044, 43.50000000000001, 41.100000000000016, 43.7, 43.900000000000006, 45.1, 20.699999999999854, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.30000000000003, 36.900000000000034, 46.5, -50.00000000000044, 31.500000000000007, -50.00000000000044, 45.1, 33.70000000000004, 45.7, 47.5, 44.300000000000004, 43.50000000000001, 45.5, 47.3, 37.50000000000003, 47.1, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 45.7], "episode_lengths": [500, 46, 74, 500, 38, 58, 322, 32, 500, 186, 54, 162, 166, 20, 500, 60, 32, 500, 500, 500, 500, 26, 56, 90, 282, 38, 500, 500, 110, 74, 500, 500, 90, 78, 150, 500, 500, 106, 84, 500, 500, 500, 52, 500, 32, 500, 500, 62, 82, 90, 500, 74, 56, 132, 402, 500, 500, 500, 500, 500, 306, 344, 500, 44, 146, 56, 500, 50, 182, 500, 66, 90, 64, 62, 50, 294, 500, 500, 500, 138, 132, 36, 500, 186, 500, 50, 164, 44, 26, 58, 66, 46, 28, 126, 30, 500, 500, 74, 500, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37777395559133736, "mean_inference_ms": 1.2090921477668164, "mean_action_processing_ms": 0.1410853642158209, "mean_env_wait_ms": 0.08402716573966298, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03100132942199707, "StateBufferConnector_ms": 0.0020017623901367188, "ViewRequirementAgentConnector_ms": 0.11154603958129883}}, "episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.644999999999833, "episode_len_mean": 249.18, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.5, 42.70000000000001, -50.00000000000044, 46.3, 44.300000000000004, 17.899999999999814, 46.9, -50.00000000000044, 31.500000000000007, 44.7, 33.90000000000004, 33.500000000000036, 48.1, -50.00000000000044, 44.10000000000001, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 44.5, 41.100000000000016, 21.89999999999987, 46.3, -50.00000000000044, -50.00000000000044, 39.10000000000002, 42.70000000000001, -50.00000000000044, -50.00000000000044, 41.100000000000016, 42.30000000000001, 35.10000000000004, -50.00000000000044, -50.00000000000044, 39.50000000000002, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 43.900000000000006, 41.90000000000001, 41.100000000000016, -50.00000000000044, 42.70000000000001, 44.5, 36.900000000000034, 9.8999999999997, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.499999999999837, 15.699999999999783, -50.00000000000044, 45.7, 35.500000000000036, 44.5, -50.00000000000044, 45.1, 31.900000000000013, -50.00000000000044, 43.50000000000001, 41.100000000000016, 43.7, 43.900000000000006, 45.1, 20.699999999999854, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.30000000000003, 36.900000000000034, 46.5, -50.00000000000044, 31.500000000000007, -50.00000000000044, 45.1, 33.70000000000004, 45.7, 47.5, 44.300000000000004, 43.50000000000001, 45.5, 47.3, 37.50000000000003, 47.1, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 45.7], "episode_lengths": [500, 46, 74, 500, 38, 58, 322, 32, 500, 186, 54, 162, 166, 20, 500, 60, 32, 500, 500, 500, 500, 26, 56, 90, 282, 38, 500, 500, 110, 74, 500, 500, 90, 78, 150, 500, 500, 106, 84, 500, 500, 500, 52, 500, 32, 500, 500, 62, 82, 90, 500, 74, 56, 132, 402, 500, 500, 500, 500, 500, 306, 344, 500, 44, 146, 56, 500, 50, 182, 500, 66, 90, 64, 62, 50, 294, 500, 500, 500, 138, 132, 36, 500, 186, 500, 50, 164, 44, 26, 58, 66, 46, 28, 126, 30, 500, 500, 74, 500, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37777395559133736, "mean_inference_ms": 1.2090921477668164, "mean_action_processing_ms": 0.1410853642158209, "mean_env_wait_ms": 0.08402716573966298, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03100132942199707, "StateBufferConnector_ms": 0.0020017623901367188, "ViewRequirementAgentConnector_ms": 0.11154603958129883}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 492000, "num_agent_steps_trained": 492000, "num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5549.079966647075, "num_env_steps_trained_throughput_per_sec": 5549.079966647075, "timesteps_total": 492000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 492000, "timers": {"training_iteration_time_ms": 2260.739, "sample_time_ms": 1913.415, "load_time_ms": 11.436, "load_throughput": 1049328.018, "learn_time_ms": 324.475, "learn_throughput": 36982.813, "synch_weights_time_ms": 9.712}, "counters": {"num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_agent_steps_sampled": 492000, "num_agent_steps_trained": 492000}, "done": false, "episodes_total": 1848, "training_iteration": 41, "trial_id": "9f288_00017", "date": "2023-10-25_16-58-04", "timestamp": 1698249484, "time_this_iter_s": 2.1675186157226562, "time_total_s": 93.1964499950409, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 93.1964499950409, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 58.300000000000004, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.094947017729285e-14, "cur_lr": 0.0003, "total_loss": 5.85764757792155, "policy_loss": -0.0007841276625792185, "vf_loss": 5.858478466669719, "vf_explained_var": -1.3550122578938803e-06, "kl": 0.0008962764351148659, "entropy": 0.46832500398159027, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1245.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.5099999999998137, "episode_len_mean": 265.5, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 43.900000000000006, 41.90000000000001, 41.100000000000016, -50.00000000000044, 42.70000000000001, 44.5, 36.900000000000034, 9.8999999999997, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.499999999999837, 15.699999999999783, -50.00000000000044, 45.7, 35.500000000000036, 44.5, -50.00000000000044, 45.1, 31.900000000000013, -50.00000000000044, 43.50000000000001, 41.100000000000016, 43.7, 43.900000000000006, 45.1, 20.699999999999854, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.30000000000003, 36.900000000000034, 46.5, -50.00000000000044, 31.500000000000007, -50.00000000000044, 45.1, 33.70000000000004, 45.7, 47.5, 44.300000000000004, 43.50000000000001, 45.5, 47.3, 37.50000000000003, 47.1, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 45.7, -50.00000000000044, 42.70000000000001, 40.30000000000002, 28.499999999999964, 25.699999999999925, -50.00000000000044, 27.49999999999995, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 44.300000000000004, 43.50000000000001, 46.099999999999994, 44.5, -50.00000000000044, 36.50000000000003, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 47.7, 29.49999999999998, 45.1, 27.099999999999945, -50.00000000000044, 42.900000000000006, -50.00000000000044, 44.5, 6.299999999999649, 44.900000000000006], "episode_lengths": [500, 500, 500, 52, 500, 32, 500, 500, 62, 82, 90, 500, 74, 56, 132, 402, 500, 500, 500, 500, 500, 306, 344, 500, 44, 146, 56, 500, 50, 182, 500, 66, 90, 64, 62, 50, 294, 500, 500, 500, 138, 132, 36, 500, 186, 500, 50, 164, 44, 26, 58, 66, 46, 28, 126, 30, 500, 500, 74, 500, 44, 500, 74, 98, 216, 244, 500, 226, 500, 500, 500, 500, 500, 72, 58, 66, 40, 56, 500, 136, 500, 56, 500, 500, 44, 500, 500, 500, 52, 500, 24, 206, 50, 230, 500, 72, 500, 56, 438, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37802589804665276, "mean_inference_ms": 1.2090796990226282, "mean_action_processing_ms": 0.141171797375457, "mean_env_wait_ms": 0.08413360668599874, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03398752212524414, "StateBufferConnector_ms": 0.00500035285949707, "ViewRequirementAgentConnector_ms": 0.11577773094177246}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.5099999999998137, "episode_len_mean": 265.5, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 43.900000000000006, 41.90000000000001, 41.100000000000016, -50.00000000000044, 42.70000000000001, 44.5, 36.900000000000034, 9.8999999999997, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.499999999999837, 15.699999999999783, -50.00000000000044, 45.7, 35.500000000000036, 44.5, -50.00000000000044, 45.1, 31.900000000000013, -50.00000000000044, 43.50000000000001, 41.100000000000016, 43.7, 43.900000000000006, 45.1, 20.699999999999854, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.30000000000003, 36.900000000000034, 46.5, -50.00000000000044, 31.500000000000007, -50.00000000000044, 45.1, 33.70000000000004, 45.7, 47.5, 44.300000000000004, 43.50000000000001, 45.5, 47.3, 37.50000000000003, 47.1, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 45.7, -50.00000000000044, 42.70000000000001, 40.30000000000002, 28.499999999999964, 25.699999999999925, -50.00000000000044, 27.49999999999995, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 44.300000000000004, 43.50000000000001, 46.099999999999994, 44.5, -50.00000000000044, 36.50000000000003, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 47.7, 29.49999999999998, 45.1, 27.099999999999945, -50.00000000000044, 42.900000000000006, -50.00000000000044, 44.5, 6.299999999999649, 44.900000000000006], "episode_lengths": [500, 500, 500, 52, 500, 32, 500, 500, 62, 82, 90, 500, 74, 56, 132, 402, 500, 500, 500, 500, 500, 306, 344, 500, 44, 146, 56, 500, 50, 182, 500, 66, 90, 64, 62, 50, 294, 500, 500, 500, 138, 132, 36, 500, 186, 500, 50, 164, 44, 26, 58, 66, 46, 28, 126, 30, 500, 500, 74, 500, 44, 500, 74, 98, 216, 244, 500, 226, 500, 500, 500, 500, 500, 72, 58, 66, 40, 56, 500, 136, 500, 56, 500, 500, 44, 500, 500, 500, 52, 500, 24, 206, 50, 230, 500, 72, 500, 56, 438, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37802589804665276, "mean_inference_ms": 1.2090796990226282, "mean_action_processing_ms": 0.141171797375457, "mean_env_wait_ms": 0.08413360668599874, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03398752212524414, "StateBufferConnector_ms": 0.00500035285949707, "ViewRequirementAgentConnector_ms": 0.11577773094177246}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5258.1027551953275, "num_env_steps_trained_throughput_per_sec": 5258.1027551953275, "timesteps_total": 504000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 504000, "timers": {"training_iteration_time_ms": 2268.526, "sample_time_ms": 1916.536, "load_time_ms": 11.452, "load_throughput": 1047822.877, "learn_time_ms": 329.283, "learn_throughput": 36442.862, "synch_weights_time_ms": 9.554}, "counters": {"num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000}, "done": false, "episodes_total": 1887, "training_iteration": 42, "trial_id": "9f288_00017", "date": "2023-10-25_16-58-07", "timestamp": 1698249487, "time_this_iter_s": 2.287191390991211, "time_total_s": 95.4836413860321, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 95.4836413860321, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 57.20000000000001, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.547473508864643e-14, "cur_lr": 0.0003, "total_loss": 6.160094547271728, "policy_loss": 3.676021782060464e-05, "vf_loss": 6.160099220275879, "vf_explained_var": -1.0331471761067708e-06, "kl": 0.00019189247899475959, "entropy": 0.41440278391043345, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1275.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_agent_steps_sampled": 516000, "num_agent_steps_trained": 516000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.0229999999998034, "episode_len_mean": 275.34, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [36.30000000000003, 36.900000000000034, 46.5, -50.00000000000044, 31.500000000000007, -50.00000000000044, 45.1, 33.70000000000004, 45.7, 47.5, 44.300000000000004, 43.50000000000001, 45.5, 47.3, 37.50000000000003, 47.1, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 45.7, -50.00000000000044, 42.70000000000001, 40.30000000000002, 28.499999999999964, 25.699999999999925, -50.00000000000044, 27.49999999999995, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 44.300000000000004, 43.50000000000001, 46.099999999999994, 44.5, -50.00000000000044, 36.50000000000003, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 47.7, 29.49999999999998, 45.1, 27.099999999999945, -50.00000000000044, 42.900000000000006, -50.00000000000044, 44.5, 6.299999999999649, 44.900000000000006, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 44.7, -50.00000000000044, 46.9, 29.099999999999973, -50.00000000000044, 41.500000000000014, -50.00000000000044, 37.50000000000003, -50.00000000000044, 45.3, 17.899999999999814, 4.499999999999623, 32.90000000000003, 44.10000000000001, 41.90000000000001, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.70000000000004, 42.70000000000001, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, 42.500000000000014, -50.00000000000044], "episode_lengths": [138, 132, 36, 500, 186, 500, 50, 164, 44, 26, 58, 66, 46, 28, 126, 30, 500, 500, 74, 500, 44, 500, 74, 98, 216, 244, 500, 226, 500, 500, 500, 500, 500, 72, 58, 66, 40, 56, 500, 136, 500, 56, 500, 500, 44, 500, 500, 500, 52, 500, 24, 206, 50, 230, 500, 72, 500, 56, 438, 52, 500, 500, 70, 500, 54, 500, 32, 210, 500, 86, 500, 126, 500, 48, 322, 456, 172, 60, 82, 500, 54, 500, 500, 500, 500, 62, 500, 500, 500, 500, 164, 74, 44, 500, 500, 500, 28, 500, 76, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3777180215071067, "mean_inference_ms": 1.2086294439612808, "mean_action_processing_ms": 0.14111819636554218, "mean_env_wait_ms": 0.08411355727002183, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03297543525695801, "StateBufferConnector_ms": 0.007004976272583008, "ViewRequirementAgentConnector_ms": 0.12592720985412598}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.0229999999998034, "episode_len_mean": 275.34, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [36.30000000000003, 36.900000000000034, 46.5, -50.00000000000044, 31.500000000000007, -50.00000000000044, 45.1, 33.70000000000004, 45.7, 47.5, 44.300000000000004, 43.50000000000001, 45.5, 47.3, 37.50000000000003, 47.1, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 45.7, -50.00000000000044, 42.70000000000001, 40.30000000000002, 28.499999999999964, 25.699999999999925, -50.00000000000044, 27.49999999999995, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 44.300000000000004, 43.50000000000001, 46.099999999999994, 44.5, -50.00000000000044, 36.50000000000003, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 47.7, 29.49999999999998, 45.1, 27.099999999999945, -50.00000000000044, 42.900000000000006, -50.00000000000044, 44.5, 6.299999999999649, 44.900000000000006, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 44.7, -50.00000000000044, 46.9, 29.099999999999973, -50.00000000000044, 41.500000000000014, -50.00000000000044, 37.50000000000003, -50.00000000000044, 45.3, 17.899999999999814, 4.499999999999623, 32.90000000000003, 44.10000000000001, 41.90000000000001, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.70000000000004, 42.70000000000001, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, 42.500000000000014, -50.00000000000044], "episode_lengths": [138, 132, 36, 500, 186, 500, 50, 164, 44, 26, 58, 66, 46, 28, 126, 30, 500, 500, 74, 500, 44, 500, 74, 98, 216, 244, 500, 226, 500, 500, 500, 500, 500, 72, 58, 66, 40, 56, 500, 136, 500, 56, 500, 500, 44, 500, 500, 500, 52, 500, 24, 206, 50, 230, 500, 72, 500, 56, 438, 52, 500, 500, 70, 500, 54, 500, 32, 210, 500, 86, 500, 126, 500, 48, 322, 456, 172, 60, 82, 500, 54, 500, 500, 500, 500, 62, 500, 500, 500, 500, 164, 74, 44, 500, 500, 500, 28, 500, 76, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3777180215071067, "mean_inference_ms": 1.2086294439612808, "mean_action_processing_ms": 0.14111819636554218, "mean_env_wait_ms": 0.08411355727002183, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03297543525695801, "StateBufferConnector_ms": 0.007004976272583008, "ViewRequirementAgentConnector_ms": 0.12592720985412598}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 516000, "num_agent_steps_trained": 516000, "num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5434.637211242388, "num_env_steps_trained_throughput_per_sec": 5434.637211242388, "timesteps_total": 516000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 516000, "timers": {"training_iteration_time_ms": 2249.316, "sample_time_ms": 1907.698, "load_time_ms": 10.773, "load_throughput": 1113909.089, "learn_time_ms": 319.751, "learn_throughput": 37529.25, "synch_weights_time_ms": 9.638}, "counters": {"num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_agent_steps_sampled": 516000, "num_agent_steps_trained": 516000}, "done": false, "episodes_total": 1927, "training_iteration": 43, "trial_id": "9f288_00017", "date": "2023-10-25_16-58-09", "timestamp": 1698249489, "time_this_iter_s": 2.213063955307007, "time_total_s": 97.69670534133911, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 97.69670534133911, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 54.76666666666667, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.2737367544323214e-14, "cur_lr": 0.0003, "total_loss": 7.186100832621256, "policy_loss": -0.0005974796911080678, "vf_loss": 7.186749537785848, "vf_explained_var": -6.715456644694011e-07, "kl": 0.0006745611996734624, "entropy": 0.5122477541367213, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1305.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.36299999999980537, "episode_len_mean": 281.94, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [27.099999999999945, -50.00000000000044, 42.900000000000006, -50.00000000000044, 44.5, 6.299999999999649, 44.900000000000006, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 44.7, -50.00000000000044, 46.9, 29.099999999999973, -50.00000000000044, 41.500000000000014, -50.00000000000044, 37.50000000000003, -50.00000000000044, 45.3, 17.899999999999814, 4.499999999999623, 32.90000000000003, 44.10000000000001, 41.90000000000001, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.70000000000004, 42.70000000000001, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 45.1, 27.099999999999945, 44.900000000000006, 37.90000000000003, 40.70000000000002, -50.00000000000044, 43.900000000000006, -50.00000000000044, 32.100000000000016, 44.5, -50.00000000000044, 45.9, 45.5, 42.500000000000014, 36.10000000000004, -50.00000000000044, 43.10000000000001, 26.299999999999933, -50.00000000000044, 43.10000000000001, 37.90000000000003, 30.499999999999993, 35.500000000000036, 46.3, -50.00000000000044, 37.10000000000003, 30.29999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.499999999999964, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 46.699999999999996, -50.00000000000044, 35.500000000000036, -50.00000000000044, 43.10000000000001, 45.7, 40.500000000000014, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 33.90000000000004, 36.10000000000004, -50.00000000000044, -50.00000000000044, 44.5, 33.10000000000003], "episode_lengths": [230, 500, 72, 500, 56, 438, 52, 500, 500, 70, 500, 54, 500, 32, 210, 500, 86, 500, 126, 500, 48, 322, 456, 172, 60, 82, 500, 54, 500, 500, 500, 500, 62, 500, 500, 500, 500, 164, 74, 44, 500, 500, 500, 28, 500, 76, 500, 500, 50, 230, 52, 122, 94, 500, 62, 500, 180, 56, 500, 42, 46, 76, 140, 500, 70, 238, 500, 70, 122, 196, 146, 38, 500, 130, 198, 500, 500, 500, 216, 500, 500, 50, 500, 34, 500, 146, 500, 70, 44, 96, 500, 84, 500, 500, 162, 140, 500, 500, 56, 170]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3772988170620555, "mean_inference_ms": 1.2075711061735739, "mean_action_processing_ms": 0.1408217965323903, "mean_env_wait_ms": 0.08388115943606937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0290071964263916, "StateBufferConnector_ms": 0.00600433349609375, "ViewRequirementAgentConnector_ms": 0.12616229057312012}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.36299999999980537, "episode_len_mean": 281.94, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [27.099999999999945, -50.00000000000044, 42.900000000000006, -50.00000000000044, 44.5, 6.299999999999649, 44.900000000000006, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 44.7, -50.00000000000044, 46.9, 29.099999999999973, -50.00000000000044, 41.500000000000014, -50.00000000000044, 37.50000000000003, -50.00000000000044, 45.3, 17.899999999999814, 4.499999999999623, 32.90000000000003, 44.10000000000001, 41.90000000000001, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.70000000000004, 42.70000000000001, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 45.1, 27.099999999999945, 44.900000000000006, 37.90000000000003, 40.70000000000002, -50.00000000000044, 43.900000000000006, -50.00000000000044, 32.100000000000016, 44.5, -50.00000000000044, 45.9, 45.5, 42.500000000000014, 36.10000000000004, -50.00000000000044, 43.10000000000001, 26.299999999999933, -50.00000000000044, 43.10000000000001, 37.90000000000003, 30.499999999999993, 35.500000000000036, 46.3, -50.00000000000044, 37.10000000000003, 30.29999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.499999999999964, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 46.699999999999996, -50.00000000000044, 35.500000000000036, -50.00000000000044, 43.10000000000001, 45.7, 40.500000000000014, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 33.90000000000004, 36.10000000000004, -50.00000000000044, -50.00000000000044, 44.5, 33.10000000000003], "episode_lengths": [230, 500, 72, 500, 56, 438, 52, 500, 500, 70, 500, 54, 500, 32, 210, 500, 86, 500, 126, 500, 48, 322, 456, 172, 60, 82, 500, 54, 500, 500, 500, 500, 62, 500, 500, 500, 500, 164, 74, 44, 500, 500, 500, 28, 500, 76, 500, 500, 50, 230, 52, 122, 94, 500, 62, 500, 180, 56, 500, 42, 46, 76, 140, 500, 70, 238, 500, 70, 122, 196, 146, 38, 500, 130, 198, 500, 500, 500, 216, 500, 500, 50, 500, 34, 500, 146, 500, 70, 44, 96, 500, 84, 500, 500, 162, 140, 500, 500, 56, 170]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3772988170620555, "mean_inference_ms": 1.2075711061735739, "mean_action_processing_ms": 0.1408217965323903, "mean_env_wait_ms": 0.08388115943606937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0290071964263916, "StateBufferConnector_ms": 0.00600433349609375, "ViewRequirementAgentConnector_ms": 0.12616229057312012}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5023.568277519455, "num_env_steps_trained_throughput_per_sec": 5023.568277519455, "timesteps_total": 528000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 528000, "timers": {"training_iteration_time_ms": 2266.693, "sample_time_ms": 1910.507, "load_time_ms": 11.35, "load_throughput": 1057278.726, "learn_time_ms": 333.714, "learn_throughput": 35958.942, "synch_weights_time_ms": 9.567}, "counters": {"num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "done": false, "episodes_total": 1980, "training_iteration": 44, "trial_id": "9f288_00017", "date": "2023-10-25_16-58-11", "timestamp": 1698249491, "time_this_iter_s": 2.394587516784668, "time_total_s": 100.09129285812378, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 100.09129285812378, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 53.45, "ram_util_percent": 27.224999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1368683772161607e-14, "cur_lr": 0.0003, "total_loss": 6.4355579853057865, "policy_loss": -0.000692009429136912, "vf_loss": 6.436302232742309, "vf_explained_var": -9.715557098388672e-07, "kl": 0.0013931245117082844, "entropy": 0.5229244718949, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1335.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.59399999999985, "episode_len_mean": 234.72, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.70000000000002, -50.00000000000044, 43.900000000000006, -50.00000000000044, 32.100000000000016, 44.5, -50.00000000000044, 45.9, 45.5, 42.500000000000014, 36.10000000000004, -50.00000000000044, 43.10000000000001, 26.299999999999933, -50.00000000000044, 43.10000000000001, 37.90000000000003, 30.499999999999993, 35.500000000000036, 46.3, -50.00000000000044, 37.10000000000003, 30.29999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.499999999999964, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 46.699999999999996, -50.00000000000044, 35.500000000000036, -50.00000000000044, 43.10000000000001, 45.7, 40.500000000000014, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 33.90000000000004, 36.10000000000004, -50.00000000000044, -50.00000000000044, 44.5, 33.10000000000003, -50.00000000000044, 12.099999999999731, 32.90000000000003, -50.00000000000044, 45.7, 45.7, 44.900000000000006, -50.00000000000044, 45.5, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, 42.900000000000006, 39.90000000000002, 43.30000000000001, 28.09999999999996, 45.9, 42.30000000000001, 39.90000000000002, 40.500000000000014, 44.300000000000004, -50.00000000000044, -50.00000000000044, 44.300000000000004, 45.5, 43.30000000000001, 40.30000000000002, 44.900000000000006, 46.699999999999996, 46.099999999999994, -50.00000000000044, 45.1, 42.900000000000006, -50.00000000000044, 43.900000000000006, 43.10000000000001, 44.900000000000006, -50.00000000000044, 45.3, 44.10000000000001, 23.8999999999999, 37.90000000000003, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, 44.300000000000004, 38.700000000000024, 39.70000000000002], "episode_lengths": [94, 500, 62, 500, 180, 56, 500, 42, 46, 76, 140, 500, 70, 238, 500, 70, 122, 196, 146, 38, 500, 130, 198, 500, 500, 500, 216, 500, 500, 50, 500, 34, 500, 146, 500, 70, 44, 96, 500, 84, 500, 500, 162, 140, 500, 500, 56, 170, 500, 380, 172, 500, 44, 44, 52, 500, 46, 500, 72, 500, 500, 500, 96, 72, 102, 68, 220, 42, 78, 102, 96, 58, 500, 500, 58, 46, 68, 98, 52, 34, 40, 500, 50, 72, 500, 62, 70, 52, 500, 48, 60, 262, 122, 500, 86, 500, 500, 58, 114, 104]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37680271281637046, "mean_inference_ms": 1.2084726404199335, "mean_action_processing_ms": 0.1409720838979195, "mean_env_wait_ms": 0.08399018260700056, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029999732971191406, "StateBufferConnector_ms": 0.006001472473144531, "ViewRequirementAgentConnector_ms": 0.1230318546295166}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.59399999999985, "episode_len_mean": 234.72, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [40.70000000000002, -50.00000000000044, 43.900000000000006, -50.00000000000044, 32.100000000000016, 44.5, -50.00000000000044, 45.9, 45.5, 42.500000000000014, 36.10000000000004, -50.00000000000044, 43.10000000000001, 26.299999999999933, -50.00000000000044, 43.10000000000001, 37.90000000000003, 30.499999999999993, 35.500000000000036, 46.3, -50.00000000000044, 37.10000000000003, 30.29999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.499999999999964, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 46.699999999999996, -50.00000000000044, 35.500000000000036, -50.00000000000044, 43.10000000000001, 45.7, 40.500000000000014, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 33.90000000000004, 36.10000000000004, -50.00000000000044, -50.00000000000044, 44.5, 33.10000000000003, -50.00000000000044, 12.099999999999731, 32.90000000000003, -50.00000000000044, 45.7, 45.7, 44.900000000000006, -50.00000000000044, 45.5, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, 42.900000000000006, 39.90000000000002, 43.30000000000001, 28.09999999999996, 45.9, 42.30000000000001, 39.90000000000002, 40.500000000000014, 44.300000000000004, -50.00000000000044, -50.00000000000044, 44.300000000000004, 45.5, 43.30000000000001, 40.30000000000002, 44.900000000000006, 46.699999999999996, 46.099999999999994, -50.00000000000044, 45.1, 42.900000000000006, -50.00000000000044, 43.900000000000006, 43.10000000000001, 44.900000000000006, -50.00000000000044, 45.3, 44.10000000000001, 23.8999999999999, 37.90000000000003, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, 44.300000000000004, 38.700000000000024, 39.70000000000002], "episode_lengths": [94, 500, 62, 500, 180, 56, 500, 42, 46, 76, 140, 500, 70, 238, 500, 70, 122, 196, 146, 38, 500, 130, 198, 500, 500, 500, 216, 500, 500, 50, 500, 34, 500, 146, 500, 70, 44, 96, 500, 84, 500, 500, 162, 140, 500, 500, 56, 170, 500, 380, 172, 500, 44, 44, 52, 500, 46, 500, 72, 500, 500, 500, 96, 72, 102, 68, 220, 42, 78, 102, 96, 58, 500, 500, 58, 46, 68, 98, 52, 34, 40, 500, 50, 72, 500, 62, 70, 52, 500, 48, 60, 262, 122, 500, 86, 500, 500, 58, 114, 104]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37680271281637046, "mean_inference_ms": 1.2084726404199335, "mean_action_processing_ms": 0.1409720838979195, "mean_env_wait_ms": 0.08399018260700056, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029999732971191406, "StateBufferConnector_ms": 0.006001472473144531, "ViewRequirementAgentConnector_ms": 0.1230318546295166}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4872.074999426463, "num_env_steps_trained_throughput_per_sec": 4872.074999426463, "timesteps_total": 540000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 540000, "timers": {"training_iteration_time_ms": 2280.554, "sample_time_ms": 1936.317, "load_time_ms": 10.349, "load_throughput": 1159544.399, "learn_time_ms": 322.666, "learn_throughput": 37190.148, "synch_weights_time_ms": 9.667}, "counters": {"num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000}, "done": false, "episodes_total": 2032, "training_iteration": 45, "trial_id": "9f288_00017", "date": "2023-10-25_16-58-14", "timestamp": 1698249494, "time_this_iter_s": 2.467874526977539, "time_total_s": 102.55916738510132, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 102.55916738510132, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 59.800000000000004, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.684341886080803e-15, "cur_lr": 0.0003, "total_loss": 6.300059000651042, "policy_loss": -0.0007430982465545336, "vf_loss": 6.300851837793986, "vf_explained_var": -1.2000401814778646e-06, "kl": 0.0007736324963957486, "entropy": 0.4966222176949183, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1365.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.004999999999843, "episode_len_mean": 245.6, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 33.90000000000004, 36.10000000000004, -50.00000000000044, -50.00000000000044, 44.5, 33.10000000000003, -50.00000000000044, 12.099999999999731, 32.90000000000003, -50.00000000000044, 45.7, 45.7, 44.900000000000006, -50.00000000000044, 45.5, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, 42.900000000000006, 39.90000000000002, 43.30000000000001, 28.09999999999996, 45.9, 42.30000000000001, 39.90000000000002, 40.500000000000014, 44.300000000000004, -50.00000000000044, -50.00000000000044, 44.300000000000004, 45.5, 43.30000000000001, 40.30000000000002, 44.900000000000006, 46.699999999999996, 46.099999999999994, -50.00000000000044, 45.1, 42.900000000000006, -50.00000000000044, 43.900000000000006, 43.10000000000001, 44.900000000000006, -50.00000000000044, 45.3, 44.10000000000001, 23.8999999999999, 37.90000000000003, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, 44.300000000000004, 38.700000000000024, 39.70000000000002, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 23.499999999999893, 41.500000000000014, 31.900000000000013, 29.49999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, 35.30000000000004, 40.10000000000002, -50.00000000000044, 42.900000000000006, 44.300000000000004, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 29.49999999999998, -50.00000000000044, 28.29999999999996, 43.30000000000001, 28.699999999999967, -50.00000000000044, 47.3, 0.2999999999995637, -50.00000000000044, 45.7, -50.00000000000044, 44.10000000000001, 40.500000000000014, -50.00000000000044, -50.00000000000044, 33.90000000000004, -50.00000000000044, 40.30000000000002, 42.500000000000014], "episode_lengths": [500, 162, 140, 500, 500, 56, 170, 500, 380, 172, 500, 44, 44, 52, 500, 46, 500, 72, 500, 500, 500, 96, 72, 102, 68, 220, 42, 78, 102, 96, 58, 500, 500, 58, 46, 68, 98, 52, 34, 40, 500, 50, 72, 500, 62, 70, 52, 500, 48, 60, 262, 122, 500, 86, 500, 500, 58, 114, 104, 500, 500, 74, 500, 266, 86, 182, 206, 500, 500, 500, 142, 148, 100, 500, 72, 58, 52, 500, 500, 500, 78, 206, 500, 218, 68, 214, 500, 28, 498, 500, 44, 500, 60, 96, 500, 500, 162, 500, 98, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37708609092270506, "mean_inference_ms": 1.2079306866397745, "mean_action_processing_ms": 0.14055908755483873, "mean_env_wait_ms": 0.08402784269382052, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.032999515533447266, "StateBufferConnector_ms": 0.008000373840332031, "ViewRequirementAgentConnector_ms": 0.12801337242126465}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.004999999999843, "episode_len_mean": 245.6, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 33.90000000000004, 36.10000000000004, -50.00000000000044, -50.00000000000044, 44.5, 33.10000000000003, -50.00000000000044, 12.099999999999731, 32.90000000000003, -50.00000000000044, 45.7, 45.7, 44.900000000000006, -50.00000000000044, 45.5, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, 42.900000000000006, 39.90000000000002, 43.30000000000001, 28.09999999999996, 45.9, 42.30000000000001, 39.90000000000002, 40.500000000000014, 44.300000000000004, -50.00000000000044, -50.00000000000044, 44.300000000000004, 45.5, 43.30000000000001, 40.30000000000002, 44.900000000000006, 46.699999999999996, 46.099999999999994, -50.00000000000044, 45.1, 42.900000000000006, -50.00000000000044, 43.900000000000006, 43.10000000000001, 44.900000000000006, -50.00000000000044, 45.3, 44.10000000000001, 23.8999999999999, 37.90000000000003, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, 44.300000000000004, 38.700000000000024, 39.70000000000002, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 23.499999999999893, 41.500000000000014, 31.900000000000013, 29.49999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, 35.30000000000004, 40.10000000000002, -50.00000000000044, 42.900000000000006, 44.300000000000004, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 29.49999999999998, -50.00000000000044, 28.29999999999996, 43.30000000000001, 28.699999999999967, -50.00000000000044, 47.3, 0.2999999999995637, -50.00000000000044, 45.7, -50.00000000000044, 44.10000000000001, 40.500000000000014, -50.00000000000044, -50.00000000000044, 33.90000000000004, -50.00000000000044, 40.30000000000002, 42.500000000000014], "episode_lengths": [500, 162, 140, 500, 500, 56, 170, 500, 380, 172, 500, 44, 44, 52, 500, 46, 500, 72, 500, 500, 500, 96, 72, 102, 68, 220, 42, 78, 102, 96, 58, 500, 500, 58, 46, 68, 98, 52, 34, 40, 500, 50, 72, 500, 62, 70, 52, 500, 48, 60, 262, 122, 500, 86, 500, 500, 58, 114, 104, 500, 500, 74, 500, 266, 86, 182, 206, 500, 500, 500, 142, 148, 100, 500, 72, 58, 52, 500, 500, 500, 78, 206, 500, 218, 68, 214, 500, 28, 498, 500, 44, 500, 60, 96, 500, 500, 162, 500, 98, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37708609092270506, "mean_inference_ms": 1.2079306866397745, "mean_action_processing_ms": 0.14055908755483873, "mean_env_wait_ms": 0.08402784269382052, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.032999515533447266, "StateBufferConnector_ms": 0.008000373840332031, "ViewRequirementAgentConnector_ms": 0.12801337242126465}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000, "num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5213.644488530565, "num_env_steps_trained_throughput_per_sec": 5213.644488530565, "timesteps_total": 552000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 552000, "timers": {"training_iteration_time_ms": 2294.277, "sample_time_ms": 1936.589, "load_time_ms": 11.449, "load_throughput": 1048134.91, "learn_time_ms": 335.017, "learn_throughput": 35819.071, "synch_weights_time_ms": 9.767}, "counters": {"num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000}, "done": false, "episodes_total": 2073, "training_iteration": 46, "trial_id": "9f288_00017", "date": "2023-10-25_16-58-16", "timestamp": 1698249496, "time_this_iter_s": 2.3076515197753906, "time_total_s": 104.86681890487671, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 104.86681890487671, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 52.76666666666667, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.8421709430404017e-15, "cur_lr": 0.0003, "total_loss": 6.394696378707886, "policy_loss": -0.0002161458134651184, "vf_loss": 6.39496340751648, "vf_explained_var": -5.563100179036459e-07, "kl": 0.0004957162017679669, "entropy": 0.5089052259922028, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1395.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_agent_steps_sampled": 564000, "num_agent_steps_trained": 564000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.479999999999809, "episode_len_mean": 275.78, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.900000000000006, -50.00000000000044, 43.900000000000006, 43.10000000000001, 44.900000000000006, -50.00000000000044, 45.3, 44.10000000000001, 23.8999999999999, 37.90000000000003, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, 44.300000000000004, 38.700000000000024, 39.70000000000002, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 23.499999999999893, 41.500000000000014, 31.900000000000013, 29.49999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, 35.30000000000004, 40.10000000000002, -50.00000000000044, 42.900000000000006, 44.300000000000004, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 29.49999999999998, -50.00000000000044, 28.29999999999996, 43.30000000000001, 28.699999999999967, -50.00000000000044, 47.3, 0.2999999999995637, -50.00000000000044, 45.7, -50.00000000000044, 44.10000000000001, 40.500000000000014, -50.00000000000044, -50.00000000000044, 33.90000000000004, -50.00000000000044, 40.30000000000002, 42.500000000000014, 35.30000000000004, 44.5, -50.00000000000044, 30.699999999999996, 44.300000000000004, 44.7, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 40.90000000000002, 37.50000000000003, 39.50000000000002, 43.50000000000001, 46.3, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 11.699999999999726, 36.900000000000034, 45.1, 28.499999999999964, -50.00000000000044, 45.3], "episode_lengths": [72, 500, 62, 70, 52, 500, 48, 60, 262, 122, 500, 86, 500, 500, 58, 114, 104, 500, 500, 74, 500, 266, 86, 182, 206, 500, 500, 500, 142, 148, 100, 500, 72, 58, 52, 500, 500, 500, 78, 206, 500, 218, 68, 214, 500, 28, 498, 500, 44, 500, 60, 96, 500, 500, 162, 500, 98, 76, 148, 56, 500, 194, 58, 54, 500, 500, 82, 500, 500, 90, 500, 88, 500, 500, 46, 500, 500, 92, 126, 106, 66, 38, 68, 500, 500, 500, 500, 500, 62, 500, 500, 500, 32, 500, 384, 132, 50, 216, 500, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3771640434930134, "mean_inference_ms": 1.2082704175635994, "mean_action_processing_ms": 0.14076551202108456, "mean_env_wait_ms": 0.08387418844730847, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02599930763244629, "StateBufferConnector_ms": 0.010998010635375977, "ViewRequirementAgentConnector_ms": 0.1219930648803711}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.479999999999809, "episode_len_mean": 275.78, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.900000000000006, -50.00000000000044, 43.900000000000006, 43.10000000000001, 44.900000000000006, -50.00000000000044, 45.3, 44.10000000000001, 23.8999999999999, 37.90000000000003, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, 44.300000000000004, 38.700000000000024, 39.70000000000002, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 23.499999999999893, 41.500000000000014, 31.900000000000013, 29.49999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, 35.30000000000004, 40.10000000000002, -50.00000000000044, 42.900000000000006, 44.300000000000004, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 29.49999999999998, -50.00000000000044, 28.29999999999996, 43.30000000000001, 28.699999999999967, -50.00000000000044, 47.3, 0.2999999999995637, -50.00000000000044, 45.7, -50.00000000000044, 44.10000000000001, 40.500000000000014, -50.00000000000044, -50.00000000000044, 33.90000000000004, -50.00000000000044, 40.30000000000002, 42.500000000000014, 35.30000000000004, 44.5, -50.00000000000044, 30.699999999999996, 44.300000000000004, 44.7, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 40.90000000000002, 37.50000000000003, 39.50000000000002, 43.50000000000001, 46.3, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 11.699999999999726, 36.900000000000034, 45.1, 28.499999999999964, -50.00000000000044, 45.3], "episode_lengths": [72, 500, 62, 70, 52, 500, 48, 60, 262, 122, 500, 86, 500, 500, 58, 114, 104, 500, 500, 74, 500, 266, 86, 182, 206, 500, 500, 500, 142, 148, 100, 500, 72, 58, 52, 500, 500, 500, 78, 206, 500, 218, 68, 214, 500, 28, 498, 500, 44, 500, 60, 96, 500, 500, 162, 500, 98, 76, 148, 56, 500, 194, 58, 54, 500, 500, 82, 500, 500, 90, 500, 88, 500, 500, 46, 500, 500, 92, 126, 106, 66, 38, 68, 500, 500, 500, 500, 500, 62, 500, 500, 500, 32, 500, 384, 132, 50, 216, 500, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3771640434930134, "mean_inference_ms": 1.2082704175635994, "mean_action_processing_ms": 0.14076551202108456, "mean_env_wait_ms": 0.08387418844730847, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02599930763244629, "StateBufferConnector_ms": 0.010998010635375977, "ViewRequirementAgentConnector_ms": 0.1219930648803711}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 564000, "num_agent_steps_trained": 564000, "num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5366.1173568648655, "num_env_steps_trained_throughput_per_sec": 5366.1173568648655, "timesteps_total": 564000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 564000, "timers": {"training_iteration_time_ms": 2285.705, "sample_time_ms": 1936.713, "load_time_ms": 11.448, "load_throughput": 1048254.972, "learn_time_ms": 326.463, "learn_throughput": 36757.661, "synch_weights_time_ms": 9.626}, "counters": {"num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_agent_steps_sampled": 564000, "num_agent_steps_trained": 564000}, "done": false, "episodes_total": 2115, "training_iteration": 47, "trial_id": "9f288_00017", "date": "2023-10-25_16-58-19", "timestamp": 1698249499, "time_this_iter_s": 2.240251064300537, "time_total_s": 107.10706996917725, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 107.10706996917725, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 52.050000000000004, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.4210854715202008e-15, "cur_lr": 0.0003, "total_loss": 6.384113121032715, "policy_loss": -0.0004682379464308421, "vf_loss": 6.38463404973348, "vf_explained_var": -9.65595245361328e-07, "kl": 0.000995872692252912, "entropy": 0.5266719361146291, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1425.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.7669999999998044, "episode_len_mean": 277.9, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [47.3, 0.2999999999995637, -50.00000000000044, 45.7, -50.00000000000044, 44.10000000000001, 40.500000000000014, -50.00000000000044, -50.00000000000044, 33.90000000000004, -50.00000000000044, 40.30000000000002, 42.500000000000014, 35.30000000000004, 44.5, -50.00000000000044, 30.699999999999996, 44.300000000000004, 44.7, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 40.90000000000002, 37.50000000000003, 39.50000000000002, 43.50000000000001, 46.3, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 11.699999999999726, 36.900000000000034, 45.1, 28.499999999999964, -50.00000000000044, 45.3, 43.900000000000006, -50.00000000000044, -50.00000000000044, 45.9, 43.30000000000001, 44.900000000000006, 45.9, 45.7, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 32.90000000000003, 30.099999999999987, 32.700000000000024, 45.7, 30.699999999999996, 37.300000000000026, -50.00000000000044, -50.00000000000044, 38.90000000000002, -50.00000000000044, 31.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 45.1, 35.500000000000036, 3.699999999999612, -50.00000000000044, 33.90000000000004, 46.5, -50.00000000000044, 42.900000000000006, 44.900000000000006, -50.00000000000044, 32.90000000000003, -50.00000000000044, -50.00000000000044, 46.9, 39.70000000000002, -50.00000000000044, 47.5, -50.00000000000044], "episode_lengths": [28, 498, 500, 44, 500, 60, 96, 500, 500, 162, 500, 98, 76, 148, 56, 500, 194, 58, 54, 500, 500, 82, 500, 500, 90, 500, 88, 500, 500, 46, 500, 500, 92, 126, 106, 66, 38, 68, 500, 500, 500, 500, 500, 62, 500, 500, 500, 32, 500, 384, 132, 50, 216, 500, 48, 62, 500, 500, 42, 68, 52, 42, 44, 500, 66, 500, 500, 172, 200, 174, 44, 194, 128, 500, 500, 112, 500, 190, 500, 500, 500, 86, 50, 146, 464, 500, 162, 36, 500, 72, 52, 500, 172, 500, 500, 32, 104, 500, 26, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37704009860093884, "mean_inference_ms": 1.2081657165382083, "mean_action_processing_ms": 0.14067878736958478, "mean_env_wait_ms": 0.08397514552383097, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017993688583374023, "StateBufferConnector_ms": 0.009999752044677734, "ViewRequirementAgentConnector_ms": 0.1159822940826416}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.7669999999998044, "episode_len_mean": 277.9, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [47.3, 0.2999999999995637, -50.00000000000044, 45.7, -50.00000000000044, 44.10000000000001, 40.500000000000014, -50.00000000000044, -50.00000000000044, 33.90000000000004, -50.00000000000044, 40.30000000000002, 42.500000000000014, 35.30000000000004, 44.5, -50.00000000000044, 30.699999999999996, 44.300000000000004, 44.7, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 40.90000000000002, 37.50000000000003, 39.50000000000002, 43.50000000000001, 46.3, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 11.699999999999726, 36.900000000000034, 45.1, 28.499999999999964, -50.00000000000044, 45.3, 43.900000000000006, -50.00000000000044, -50.00000000000044, 45.9, 43.30000000000001, 44.900000000000006, 45.9, 45.7, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 32.90000000000003, 30.099999999999987, 32.700000000000024, 45.7, 30.699999999999996, 37.300000000000026, -50.00000000000044, -50.00000000000044, 38.90000000000002, -50.00000000000044, 31.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 45.1, 35.500000000000036, 3.699999999999612, -50.00000000000044, 33.90000000000004, 46.5, -50.00000000000044, 42.900000000000006, 44.900000000000006, -50.00000000000044, 32.90000000000003, -50.00000000000044, -50.00000000000044, 46.9, 39.70000000000002, -50.00000000000044, 47.5, -50.00000000000044], "episode_lengths": [28, 498, 500, 44, 500, 60, 96, 500, 500, 162, 500, 98, 76, 148, 56, 500, 194, 58, 54, 500, 500, 82, 500, 500, 90, 500, 88, 500, 500, 46, 500, 500, 92, 126, 106, 66, 38, 68, 500, 500, 500, 500, 500, 62, 500, 500, 500, 32, 500, 384, 132, 50, 216, 500, 48, 62, 500, 500, 42, 68, 52, 42, 44, 500, 66, 500, 500, 172, 200, 174, 44, 194, 128, 500, 500, 112, 500, 190, 500, 500, 500, 86, 50, 146, 464, 500, 162, 36, 500, 72, 52, 500, 172, 500, 500, 32, 104, 500, 26, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37704009860093884, "mean_inference_ms": 1.2081657165382083, "mean_action_processing_ms": 0.14067878736958478, "mean_env_wait_ms": 0.08397514552383097, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017993688583374023, "StateBufferConnector_ms": 0.009999752044677734, "ViewRequirementAgentConnector_ms": 0.1159822940826416}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5200.665762616032, "num_env_steps_trained_throughput_per_sec": 5200.665762616032, "timesteps_total": 576000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 576000, "timers": {"training_iteration_time_ms": 2290.272, "sample_time_ms": 1935.436, "load_time_ms": 11.376, "load_throughput": 1054850.161, "learn_time_ms": 332.611, "learn_throughput": 36078.221, "synch_weights_time_ms": 9.395}, "counters": {"num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "done": false, "episodes_total": 2160, "training_iteration": 48, "trial_id": "9f288_00017", "date": "2023-10-25_16-58-21", "timestamp": 1698249501, "time_this_iter_s": 2.312182903289795, "time_total_s": 109.41925287246704, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 109.41925287246704, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 58.866666666666674, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.105427357601004e-16, "cur_lr": 0.0003, "total_loss": 6.570624732971192, "policy_loss": -0.0003225955491264661, "vf_loss": 6.570999463399251, "vf_explained_var": -1.1165936787923178e-06, "kl": 0.0007537216689399884, "entropy": 0.5206778685251872, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1455.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 588000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.664999999999832, "episode_len_mean": 258.98, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.9, -50.00000000000044, 11.699999999999726, 36.900000000000034, 45.1, 28.499999999999964, -50.00000000000044, 45.3, 43.900000000000006, -50.00000000000044, -50.00000000000044, 45.9, 43.30000000000001, 44.900000000000006, 45.9, 45.7, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 32.90000000000003, 30.099999999999987, 32.700000000000024, 45.7, 30.699999999999996, 37.300000000000026, -50.00000000000044, -50.00000000000044, 38.90000000000002, -50.00000000000044, 31.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 45.1, 35.500000000000036, 3.699999999999612, -50.00000000000044, 33.90000000000004, 46.5, -50.00000000000044, 42.900000000000006, 44.900000000000006, -50.00000000000044, 32.90000000000003, -50.00000000000044, -50.00000000000044, 46.9, 39.70000000000002, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 45.9, 32.30000000000002, 36.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 46.9, 46.9, -50.00000000000044, -50.00000000000044, 34.30000000000004, 33.500000000000036, -50.00000000000044, 18.499999999999822, 46.5, -50.00000000000044, 37.70000000000003, 43.30000000000001, 42.30000000000001, 31.300000000000004, 41.70000000000002, -50.00000000000044, 42.30000000000001, -50.00000000000044, 40.70000000000002, -50.00000000000044, 46.099999999999994, 45.3, 38.10000000000002, 29.49999999999998, 31.900000000000013, 37.300000000000026, -50.00000000000044, 41.90000000000001, -50.00000000000044, 36.50000000000003, -50.00000000000044, 45.3, 36.70000000000003, 13.299999999999748, 43.10000000000001, 39.50000000000002, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 32, 500, 384, 132, 50, 216, 500, 48, 62, 500, 500, 42, 68, 52, 42, 44, 500, 66, 500, 500, 172, 200, 174, 44, 194, 128, 500, 500, 112, 500, 190, 500, 500, 500, 86, 50, 146, 464, 500, 162, 36, 500, 72, 52, 500, 172, 500, 500, 32, 104, 500, 26, 500, 500, 42, 178, 136, 500, 500, 500, 66, 32, 32, 500, 500, 158, 166, 500, 316, 36, 500, 124, 68, 78, 188, 84, 500, 78, 500, 94, 500, 40, 48, 120, 206, 182, 128, 500, 82, 500, 136, 500, 48, 134, 368, 70, 106, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37700611826859093, "mean_inference_ms": 1.2079567167789147, "mean_action_processing_ms": 0.14061769257409262, "mean_env_wait_ms": 0.08399877915332919, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02016139030456543, "StateBufferConnector_ms": 0.007002353668212891, "ViewRequirementAgentConnector_ms": 0.1219794750213623}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.664999999999832, "episode_len_mean": 258.98, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.9, -50.00000000000044, 11.699999999999726, 36.900000000000034, 45.1, 28.499999999999964, -50.00000000000044, 45.3, 43.900000000000006, -50.00000000000044, -50.00000000000044, 45.9, 43.30000000000001, 44.900000000000006, 45.9, 45.7, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 32.90000000000003, 30.099999999999987, 32.700000000000024, 45.7, 30.699999999999996, 37.300000000000026, -50.00000000000044, -50.00000000000044, 38.90000000000002, -50.00000000000044, 31.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 45.1, 35.500000000000036, 3.699999999999612, -50.00000000000044, 33.90000000000004, 46.5, -50.00000000000044, 42.900000000000006, 44.900000000000006, -50.00000000000044, 32.90000000000003, -50.00000000000044, -50.00000000000044, 46.9, 39.70000000000002, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 45.9, 32.30000000000002, 36.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 46.9, 46.9, -50.00000000000044, -50.00000000000044, 34.30000000000004, 33.500000000000036, -50.00000000000044, 18.499999999999822, 46.5, -50.00000000000044, 37.70000000000003, 43.30000000000001, 42.30000000000001, 31.300000000000004, 41.70000000000002, -50.00000000000044, 42.30000000000001, -50.00000000000044, 40.70000000000002, -50.00000000000044, 46.099999999999994, 45.3, 38.10000000000002, 29.49999999999998, 31.900000000000013, 37.300000000000026, -50.00000000000044, 41.90000000000001, -50.00000000000044, 36.50000000000003, -50.00000000000044, 45.3, 36.70000000000003, 13.299999999999748, 43.10000000000001, 39.50000000000002, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 32, 500, 384, 132, 50, 216, 500, 48, 62, 500, 500, 42, 68, 52, 42, 44, 500, 66, 500, 500, 172, 200, 174, 44, 194, 128, 500, 500, 112, 500, 190, 500, 500, 500, 86, 50, 146, 464, 500, 162, 36, 500, 72, 52, 500, 172, 500, 500, 32, 104, 500, 26, 500, 500, 42, 178, 136, 500, 500, 500, 66, 32, 32, 500, 500, 158, 166, 500, 316, 36, 500, 124, 68, 78, 188, 84, 500, 78, 500, 94, 500, 40, 48, 120, 206, 182, 128, 500, 82, 500, 136, 500, 48, 134, 368, 70, 106, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37700611826859093, "mean_inference_ms": 1.2079567167789147, "mean_action_processing_ms": 0.14061769257409262, "mean_env_wait_ms": 0.08399877915332919, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02016139030456543, "StateBufferConnector_ms": 0.007002353668212891, "ViewRequirementAgentConnector_ms": 0.1219794750213623}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 588000, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5641.154940741232, "num_env_steps_trained_throughput_per_sec": 5641.154940741232, "timesteps_total": 588000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 588000, "timers": {"training_iteration_time_ms": 2278.357, "sample_time_ms": 1935.073, "load_time_ms": 11.154, "load_throughput": 1075839.568, "learn_time_ms": 321.27, "learn_throughput": 37351.739, "synch_weights_time_ms": 9.304}, "counters": {"num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 588000}, "done": false, "episodes_total": 2206, "training_iteration": 49, "trial_id": "9f288_00017", "date": "2023-10-25_16-58-23", "timestamp": 1698249503, "time_this_iter_s": 2.132223606109619, "time_total_s": 111.55147647857666, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 111.55147647857666, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 59.76666666666666, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.552713678800502e-16, "cur_lr": 0.0003, "total_loss": 6.721979443232218, "policy_loss": -0.0009727939963340759, "vf_loss": 6.723004150390625, "vf_explained_var": -1.2556711832682292e-06, "kl": 0.0015014041051282826, "entropy": 0.5191807468732198, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1485.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.031999999999836, "episode_len_mean": 250.32, "episode_media": {}, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 45.9, 32.30000000000002, 36.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 46.9, 46.9, -50.00000000000044, -50.00000000000044, 34.30000000000004, 33.500000000000036, -50.00000000000044, 18.499999999999822, 46.5, -50.00000000000044, 37.70000000000003, 43.30000000000001, 42.30000000000001, 31.300000000000004, 41.70000000000002, -50.00000000000044, 42.30000000000001, -50.00000000000044, 40.70000000000002, -50.00000000000044, 46.099999999999994, 45.3, 38.10000000000002, 29.49999999999998, 31.900000000000013, 37.300000000000026, -50.00000000000044, 41.90000000000001, -50.00000000000044, 36.50000000000003, -50.00000000000044, 45.3, 36.70000000000003, 13.299999999999748, 43.10000000000001, 39.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 42.30000000000001, -50.00000000000044, 45.7, -50.00000000000044, 0.2999999999995637, -50.00000000000044, 43.900000000000006, -50.00000000000044, 39.50000000000002, 44.7, 38.700000000000024, 28.699999999999967, -50.00000000000044, 33.500000000000036, 40.30000000000002, 43.900000000000006, 43.50000000000001, -50.00000000000044, -50.00000000000044, 45.9, 42.10000000000001, 40.90000000000002, -50.00000000000044, -50.00000000000044, 9.499999999999694, -50.00000000000044, -50.00000000000044, 47.7, 44.300000000000004, -50.00000000000044, -50.00000000000044, 42.900000000000006, 43.30000000000001, 41.100000000000016, 43.7, 42.900000000000006, 47.3, 43.30000000000001, -50.00000000000044, 44.10000000000001, 34.70000000000004, -50.00000000000044, 41.90000000000001, 39.90000000000002, 43.900000000000006, 35.10000000000004, 44.5], "episode_lengths": [500, 26, 500, 500, 42, 178, 136, 500, 500, 500, 66, 32, 32, 500, 500, 158, 166, 500, 316, 36, 500, 124, 68, 78, 188, 84, 500, 78, 500, 94, 500, 40, 48, 120, 206, 182, 128, 500, 82, 500, 136, 500, 48, 134, 368, 70, 106, 500, 500, 500, 500, 500, 70, 78, 500, 44, 500, 498, 500, 62, 500, 106, 54, 114, 214, 500, 166, 98, 62, 66, 500, 500, 42, 80, 92, 500, 500, 406, 500, 500, 24, 58, 500, 500, 72, 68, 90, 64, 72, 28, 68, 500, 60, 154, 500, 82, 102, 62, 150, 56]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3770527955198766, "mean_inference_ms": 1.2077941532084626, "mean_action_processing_ms": 0.14085815447585642, "mean_env_wait_ms": 0.08395710454562909, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028171777725219727, "StateBufferConnector_ms": 0.0069997310638427734, "ViewRequirementAgentConnector_ms": 0.12299799919128418}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.031999999999836, "episode_len_mean": 250.32, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 45.9, 32.30000000000002, 36.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 46.9, 46.9, -50.00000000000044, -50.00000000000044, 34.30000000000004, 33.500000000000036, -50.00000000000044, 18.499999999999822, 46.5, -50.00000000000044, 37.70000000000003, 43.30000000000001, 42.30000000000001, 31.300000000000004, 41.70000000000002, -50.00000000000044, 42.30000000000001, -50.00000000000044, 40.70000000000002, -50.00000000000044, 46.099999999999994, 45.3, 38.10000000000002, 29.49999999999998, 31.900000000000013, 37.300000000000026, -50.00000000000044, 41.90000000000001, -50.00000000000044, 36.50000000000003, -50.00000000000044, 45.3, 36.70000000000003, 13.299999999999748, 43.10000000000001, 39.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 42.30000000000001, -50.00000000000044, 45.7, -50.00000000000044, 0.2999999999995637, -50.00000000000044, 43.900000000000006, -50.00000000000044, 39.50000000000002, 44.7, 38.700000000000024, 28.699999999999967, -50.00000000000044, 33.500000000000036, 40.30000000000002, 43.900000000000006, 43.50000000000001, -50.00000000000044, -50.00000000000044, 45.9, 42.10000000000001, 40.90000000000002, -50.00000000000044, -50.00000000000044, 9.499999999999694, -50.00000000000044, -50.00000000000044, 47.7, 44.300000000000004, -50.00000000000044, -50.00000000000044, 42.900000000000006, 43.30000000000001, 41.100000000000016, 43.7, 42.900000000000006, 47.3, 43.30000000000001, -50.00000000000044, 44.10000000000001, 34.70000000000004, -50.00000000000044, 41.90000000000001, 39.90000000000002, 43.900000000000006, 35.10000000000004, 44.5], "episode_lengths": [500, 26, 500, 500, 42, 178, 136, 500, 500, 500, 66, 32, 32, 500, 500, 158, 166, 500, 316, 36, 500, 124, 68, 78, 188, 84, 500, 78, 500, 94, 500, 40, 48, 120, 206, 182, 128, 500, 82, 500, 136, 500, 48, 134, 368, 70, 106, 500, 500, 500, 500, 500, 70, 78, 500, 44, 500, 498, 500, 62, 500, 106, 54, 114, 214, 500, 166, 98, 62, 66, 500, 500, 42, 80, 92, 500, 500, 406, 500, 500, 24, 58, 500, 500, 72, 68, 90, 64, 72, 28, 68, 500, 60, 154, 500, 82, 102, 62, 150, 56]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3770527955198766, "mean_inference_ms": 1.2077941532084626, "mean_action_processing_ms": 0.14085815447585642, "mean_env_wait_ms": 0.08395710454562909, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028171777725219727, "StateBufferConnector_ms": 0.0069997310638427734, "ViewRequirementAgentConnector_ms": 0.12299799919128418}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5304.097014691014, "num_env_steps_trained_throughput_per_sec": 5304.097014691014, "timesteps_total": 600000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 600000, "timers": {"training_iteration_time_ms": 2273.752, "sample_time_ms": 1935.607, "load_time_ms": 10.454, "load_throughput": 1147890.009, "learn_time_ms": 316.664, "learn_throughput": 37895.09, "synch_weights_time_ms": 9.573}, "counters": {"num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000}, "done": false, "episodes_total": 2257, "training_iteration": 50, "trial_id": "9f288_00017", "date": "2023-10-25_16-58-25", "timestamp": 1698249505, "time_this_iter_s": 2.2683985233306885, "time_total_s": 113.81987500190735, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 113.81987500190735, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 62.93333333333334, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.776356839400251e-16, "cur_lr": 0.0003, "total_loss": 6.553033129374186, "policy_loss": -0.0004924470869203408, "vf_loss": 6.553575897216797, "vf_explained_var": -8.424123128255208e-07, "kl": 0.0009827724127831061, "entropy": 0.5029928972323735, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1515.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.424999999999836, "episode_len_mean": 241.4, "episode_media": {}, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 42.30000000000001, -50.00000000000044, 45.7, -50.00000000000044, 0.2999999999995637, -50.00000000000044, 43.900000000000006, -50.00000000000044, 39.50000000000002, 44.7, 38.700000000000024, 28.699999999999967, -50.00000000000044, 33.500000000000036, 40.30000000000002, 43.900000000000006, 43.50000000000001, -50.00000000000044, -50.00000000000044, 45.9, 42.10000000000001, 40.90000000000002, -50.00000000000044, -50.00000000000044, 9.499999999999694, -50.00000000000044, -50.00000000000044, 47.7, 44.300000000000004, -50.00000000000044, -50.00000000000044, 42.900000000000006, 43.30000000000001, 41.100000000000016, 43.7, 42.900000000000006, 47.3, 43.30000000000001, -50.00000000000044, 44.10000000000001, 34.70000000000004, -50.00000000000044, 41.90000000000001, 39.90000000000002, 43.900000000000006, 35.10000000000004, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 45.1, 45.1, 43.900000000000006, 44.900000000000006, -50.00000000000044, 44.300000000000004, 46.099999999999994, -50.00000000000044, 37.90000000000003, 41.100000000000016, 41.500000000000014, 45.3, -50.00000000000044, 24.69999999999991, 47.7, 32.30000000000002, 46.3, -50.00000000000044, 27.49999999999995, -50.00000000000044, 37.10000000000003, 45.3, 47.3, -50.00000000000044, 25.29999999999992, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 45.1, -50.00000000000044, 46.9, -50.00000000000044, 18.29999999999982, -50.00000000000044, 44.300000000000004, 46.3, 43.50000000000001, 21.09999999999986, 30.499999999999993, 43.7, 46.3], "episode_lengths": [500, 500, 500, 70, 78, 500, 44, 500, 498, 500, 62, 500, 106, 54, 114, 214, 500, 166, 98, 62, 66, 500, 500, 42, 80, 92, 500, 500, 406, 500, 500, 24, 58, 500, 500, 72, 68, 90, 64, 72, 28, 68, 500, 60, 154, 500, 82, 102, 62, 150, 56, 500, 500, 500, 62, 50, 50, 62, 52, 500, 58, 40, 500, 122, 90, 86, 48, 500, 254, 24, 178, 38, 500, 226, 500, 130, 48, 28, 500, 248, 54, 500, 500, 500, 500, 500, 80, 50, 500, 32, 500, 318, 500, 58, 38, 66, 290, 196, 64, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3769477124643325, "mean_inference_ms": 1.207375228447174, "mean_action_processing_ms": 0.140472986695363, "mean_env_wait_ms": 0.08375451175273614, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025542259216308594, "StateBufferConnector_ms": 0.005004167556762695, "ViewRequirementAgentConnector_ms": 0.10269856452941895}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.424999999999836, "episode_len_mean": 241.4, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 42.30000000000001, -50.00000000000044, 45.7, -50.00000000000044, 0.2999999999995637, -50.00000000000044, 43.900000000000006, -50.00000000000044, 39.50000000000002, 44.7, 38.700000000000024, 28.699999999999967, -50.00000000000044, 33.500000000000036, 40.30000000000002, 43.900000000000006, 43.50000000000001, -50.00000000000044, -50.00000000000044, 45.9, 42.10000000000001, 40.90000000000002, -50.00000000000044, -50.00000000000044, 9.499999999999694, -50.00000000000044, -50.00000000000044, 47.7, 44.300000000000004, -50.00000000000044, -50.00000000000044, 42.900000000000006, 43.30000000000001, 41.100000000000016, 43.7, 42.900000000000006, 47.3, 43.30000000000001, -50.00000000000044, 44.10000000000001, 34.70000000000004, -50.00000000000044, 41.90000000000001, 39.90000000000002, 43.900000000000006, 35.10000000000004, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 45.1, 45.1, 43.900000000000006, 44.900000000000006, -50.00000000000044, 44.300000000000004, 46.099999999999994, -50.00000000000044, 37.90000000000003, 41.100000000000016, 41.500000000000014, 45.3, -50.00000000000044, 24.69999999999991, 47.7, 32.30000000000002, 46.3, -50.00000000000044, 27.49999999999995, -50.00000000000044, 37.10000000000003, 45.3, 47.3, -50.00000000000044, 25.29999999999992, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 45.1, -50.00000000000044, 46.9, -50.00000000000044, 18.29999999999982, -50.00000000000044, 44.300000000000004, 46.3, 43.50000000000001, 21.09999999999986, 30.499999999999993, 43.7, 46.3], "episode_lengths": [500, 500, 500, 70, 78, 500, 44, 500, 498, 500, 62, 500, 106, 54, 114, 214, 500, 166, 98, 62, 66, 500, 500, 42, 80, 92, 500, 500, 406, 500, 500, 24, 58, 500, 500, 72, 68, 90, 64, 72, 28, 68, 500, 60, 154, 500, 82, 102, 62, 150, 56, 500, 500, 500, 62, 50, 50, 62, 52, 500, 58, 40, 500, 122, 90, 86, 48, 500, 254, 24, 178, 38, 500, 226, 500, 130, 48, 28, 500, 248, 54, 500, 500, 500, 500, 500, 80, 50, 500, 32, 500, 318, 500, 58, 38, 66, 290, 196, 64, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3769477124643325, "mean_inference_ms": 1.207375228447174, "mean_action_processing_ms": 0.140472986695363, "mean_env_wait_ms": 0.08375451175273614, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025542259216308594, "StateBufferConnector_ms": 0.005004167556762695, "ViewRequirementAgentConnector_ms": 0.10269856452941895}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000, "num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5204.412883276483, "num_env_steps_trained_throughput_per_sec": 5204.412883276483, "timesteps_total": 612000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 612000, "timers": {"training_iteration_time_ms": 2288.074, "sample_time_ms": 1934.517, "load_time_ms": 11.228, "load_throughput": 1068771.325, "learn_time_ms": 331.532, "learn_throughput": 36195.648, "synch_weights_time_ms": 9.373}, "counters": {"num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000}, "done": false, "episodes_total": 2306, "training_iteration": 51, "trial_id": "9f288_00017", "date": "2023-10-25_16-58-28", "timestamp": 1698249508, "time_this_iter_s": 2.3107261657714844, "time_total_s": 116.13060116767883, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 116.13060116767883, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 57.333333333333336, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.881784197001255e-17, "cur_lr": 0.0003, "total_loss": 5.979355796178182, "policy_loss": -0.0006934838990370432, "vf_loss": 5.980098676681519, "vf_explained_var": -7.708867390950521e-07, "kl": 0.0006306633907873523, "entropy": 0.4933222492535909, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1545.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.207999999999835, "episode_len_mean": 248.56, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.10000000000001, 34.70000000000004, -50.00000000000044, 41.90000000000001, 39.90000000000002, 43.900000000000006, 35.10000000000004, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 45.1, 45.1, 43.900000000000006, 44.900000000000006, -50.00000000000044, 44.300000000000004, 46.099999999999994, -50.00000000000044, 37.90000000000003, 41.100000000000016, 41.500000000000014, 45.3, -50.00000000000044, 24.69999999999991, 47.7, 32.30000000000002, 46.3, -50.00000000000044, 27.49999999999995, -50.00000000000044, 37.10000000000003, 45.3, 47.3, -50.00000000000044, 25.29999999999992, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 45.1, -50.00000000000044, 46.9, -50.00000000000044, 18.29999999999982, -50.00000000000044, 44.300000000000004, 46.3, 43.50000000000001, 21.09999999999986, 30.499999999999993, 43.7, 46.3, 20.699999999999854, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 33.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 24.69999999999991, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 27.299999999999947, 38.10000000000002, 28.499999999999964, 34.10000000000004, -50.00000000000044, 43.7, 44.900000000000006, 45.5, 13.699999999999754, -50.00000000000044, -50.00000000000044, 37.90000000000003, 46.5, 42.70000000000001, -50.00000000000044, 44.300000000000004, 38.50000000000003, 43.50000000000001, 39.50000000000002, 42.500000000000014, 42.10000000000001, -50.00000000000044], "episode_lengths": [500, 60, 154, 500, 82, 102, 62, 150, 56, 500, 500, 500, 62, 50, 50, 62, 52, 500, 58, 40, 500, 122, 90, 86, 48, 500, 254, 24, 178, 38, 500, 226, 500, 130, 48, 28, 500, 248, 54, 500, 500, 500, 500, 500, 80, 50, 500, 32, 500, 318, 500, 58, 38, 66, 290, 196, 64, 38, 294, 70, 500, 500, 500, 500, 500, 62, 166, 500, 500, 500, 500, 72, 254, 46, 500, 500, 500, 64, 228, 120, 216, 160, 500, 64, 52, 46, 364, 500, 500, 122, 36, 74, 500, 58, 116, 66, 106, 76, 80, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37696680452332443, "mean_inference_ms": 1.2075994017587535, "mean_action_processing_ms": 0.14020447526048807, "mean_env_wait_ms": 0.08407257177083677, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020537376403808594, "StateBufferConnector_ms": 0.0060062408447265625, "ViewRequirementAgentConnector_ms": 0.09670209884643555}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.207999999999835, "episode_len_mean": 248.56, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.10000000000001, 34.70000000000004, -50.00000000000044, 41.90000000000001, 39.90000000000002, 43.900000000000006, 35.10000000000004, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 45.1, 45.1, 43.900000000000006, 44.900000000000006, -50.00000000000044, 44.300000000000004, 46.099999999999994, -50.00000000000044, 37.90000000000003, 41.100000000000016, 41.500000000000014, 45.3, -50.00000000000044, 24.69999999999991, 47.7, 32.30000000000002, 46.3, -50.00000000000044, 27.49999999999995, -50.00000000000044, 37.10000000000003, 45.3, 47.3, -50.00000000000044, 25.29999999999992, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 45.1, -50.00000000000044, 46.9, -50.00000000000044, 18.29999999999982, -50.00000000000044, 44.300000000000004, 46.3, 43.50000000000001, 21.09999999999986, 30.499999999999993, 43.7, 46.3, 20.699999999999854, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 33.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 24.69999999999991, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 27.299999999999947, 38.10000000000002, 28.499999999999964, 34.10000000000004, -50.00000000000044, 43.7, 44.900000000000006, 45.5, 13.699999999999754, -50.00000000000044, -50.00000000000044, 37.90000000000003, 46.5, 42.70000000000001, -50.00000000000044, 44.300000000000004, 38.50000000000003, 43.50000000000001, 39.50000000000002, 42.500000000000014, 42.10000000000001, -50.00000000000044], "episode_lengths": [500, 60, 154, 500, 82, 102, 62, 150, 56, 500, 500, 500, 62, 50, 50, 62, 52, 500, 58, 40, 500, 122, 90, 86, 48, 500, 254, 24, 178, 38, 500, 226, 500, 130, 48, 28, 500, 248, 54, 500, 500, 500, 500, 500, 80, 50, 500, 32, 500, 318, 500, 58, 38, 66, 290, 196, 64, 38, 294, 70, 500, 500, 500, 500, 500, 62, 166, 500, 500, 500, 500, 72, 254, 46, 500, 500, 500, 64, 228, 120, 216, 160, 500, 64, 52, 46, 364, 500, 500, 122, 36, 74, 500, 58, 116, 66, 106, 76, 80, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37696680452332443, "mean_inference_ms": 1.2075994017587535, "mean_action_processing_ms": 0.14020447526048807, "mean_env_wait_ms": 0.08407257177083677, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020537376403808594, "StateBufferConnector_ms": 0.0060062408447265625, "ViewRequirementAgentConnector_ms": 0.09670209884643555}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000, "num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5419.433864828908, "num_env_steps_trained_throughput_per_sec": 5419.433864828908, "timesteps_total": 624000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 624000, "timers": {"training_iteration_time_ms": 2281.28, "sample_time_ms": 1932.638, "load_time_ms": 11.411, "load_throughput": 1051577.377, "learn_time_ms": 326.268, "learn_throughput": 36779.558, "synch_weights_time_ms": 9.638}, "counters": {"num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "done": false, "episodes_total": 2348, "training_iteration": 52, "trial_id": "9f288_00017", "date": "2023-10-25_16-58-30", "timestamp": 1698249510, "time_this_iter_s": 2.219252109527588, "time_total_s": 118.34985327720642, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 118.34985327720642, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 54.93333333333334, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.4408920985006276e-17, "cur_lr": 0.0003, "total_loss": 6.757106018066406, "policy_loss": -0.0006385309000809988, "vf_loss": 6.757799768447876, "vf_explained_var": -1.1801719665527344e-06, "kl": 0.0013208092484224684, "entropy": 0.5523410151402156, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1575.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_agent_steps_sampled": 636000, "num_agent_steps_trained": 636000}, "sampler_results": {"episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.111999999999829, "episode_len_mean": 259.52, "episode_media": {}, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.29999999999982, -50.00000000000044, 44.300000000000004, 46.3, 43.50000000000001, 21.09999999999986, 30.499999999999993, 43.7, 46.3, 20.699999999999854, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 33.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 24.69999999999991, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 27.299999999999947, 38.10000000000002, 28.499999999999964, 34.10000000000004, -50.00000000000044, 43.7, 44.900000000000006, 45.5, 13.699999999999754, -50.00000000000044, -50.00000000000044, 37.90000000000003, 46.5, 42.70000000000001, -50.00000000000044, 44.300000000000004, 38.50000000000003, 43.50000000000001, 39.50000000000002, 42.500000000000014, 42.10000000000001, -50.00000000000044, -50.00000000000044, 41.30000000000001, 38.90000000000002, -50.00000000000044, -50.00000000000044, 32.700000000000024, 14.09999999999976, -50.00000000000044, -50.00000000000044, 43.50000000000001, 41.90000000000001, -50.00000000000044, -50.00000000000044, 46.3, 42.30000000000001, -50.00000000000044, 41.100000000000016, 43.50000000000001, -50.00000000000044, 28.29999999999996, 41.30000000000001, -50.00000000000044, 39.90000000000002, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 32.30000000000002, 42.900000000000006, -50.00000000000044, -50.00000000000044, 42.500000000000014, 21.89999999999987, 44.10000000000001, 45.3, 33.70000000000004, 44.900000000000006, 38.90000000000002, 3.699999999999612, 37.300000000000026, 35.70000000000003, 46.3, 23.499999999999893, -50.00000000000044, -50.00000000000044, 46.099999999999994, 45.7], "episode_lengths": [318, 500, 58, 38, 66, 290, 196, 64, 38, 294, 70, 500, 500, 500, 500, 500, 62, 166, 500, 500, 500, 500, 72, 254, 46, 500, 500, 500, 64, 228, 120, 216, 160, 500, 64, 52, 46, 364, 500, 500, 122, 36, 74, 500, 58, 116, 66, 106, 76, 80, 500, 500, 88, 112, 500, 500, 174, 360, 500, 500, 66, 82, 500, 500, 38, 78, 500, 90, 66, 500, 218, 88, 500, 102, 500, 72, 500, 500, 70, 500, 178, 72, 500, 500, 76, 282, 60, 48, 164, 52, 112, 464, 128, 144, 38, 266, 500, 500, 40, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37725007412785566, "mean_inference_ms": 1.2071690819657916, "mean_action_processing_ms": 0.140617764844855, "mean_env_wait_ms": 0.0843762781469492, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01898360252380371, "StateBufferConnector_ms": 0.007006168365478516, "ViewRequirementAgentConnector_ms": 0.10871624946594238}}, "episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.111999999999829, "episode_len_mean": 259.52, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [18.29999999999982, -50.00000000000044, 44.300000000000004, 46.3, 43.50000000000001, 21.09999999999986, 30.499999999999993, 43.7, 46.3, 20.699999999999854, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 33.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 24.69999999999991, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 27.299999999999947, 38.10000000000002, 28.499999999999964, 34.10000000000004, -50.00000000000044, 43.7, 44.900000000000006, 45.5, 13.699999999999754, -50.00000000000044, -50.00000000000044, 37.90000000000003, 46.5, 42.70000000000001, -50.00000000000044, 44.300000000000004, 38.50000000000003, 43.50000000000001, 39.50000000000002, 42.500000000000014, 42.10000000000001, -50.00000000000044, -50.00000000000044, 41.30000000000001, 38.90000000000002, -50.00000000000044, -50.00000000000044, 32.700000000000024, 14.09999999999976, -50.00000000000044, -50.00000000000044, 43.50000000000001, 41.90000000000001, -50.00000000000044, -50.00000000000044, 46.3, 42.30000000000001, -50.00000000000044, 41.100000000000016, 43.50000000000001, -50.00000000000044, 28.29999999999996, 41.30000000000001, -50.00000000000044, 39.90000000000002, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 32.30000000000002, 42.900000000000006, -50.00000000000044, -50.00000000000044, 42.500000000000014, 21.89999999999987, 44.10000000000001, 45.3, 33.70000000000004, 44.900000000000006, 38.90000000000002, 3.699999999999612, 37.300000000000026, 35.70000000000003, 46.3, 23.499999999999893, -50.00000000000044, -50.00000000000044, 46.099999999999994, 45.7], "episode_lengths": [318, 500, 58, 38, 66, 290, 196, 64, 38, 294, 70, 500, 500, 500, 500, 500, 62, 166, 500, 500, 500, 500, 72, 254, 46, 500, 500, 500, 64, 228, 120, 216, 160, 500, 64, 52, 46, 364, 500, 500, 122, 36, 74, 500, 58, 116, 66, 106, 76, 80, 500, 500, 88, 112, 500, 500, 174, 360, 500, 500, 66, 82, 500, 500, 38, 78, 500, 90, 66, 500, 218, 88, 500, 102, 500, 72, 500, 500, 70, 500, 178, 72, 500, 500, 76, 282, 60, 48, 164, 52, 112, 464, 128, 144, 38, 266, 500, 500, 40, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37725007412785566, "mean_inference_ms": 1.2071690819657916, "mean_action_processing_ms": 0.140617764844855, "mean_env_wait_ms": 0.0843762781469492, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01898360252380371, "StateBufferConnector_ms": 0.007006168365478516, "ViewRequirementAgentConnector_ms": 0.10871624946594238}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 636000, "num_agent_steps_trained": 636000, "num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5127.163654866495, "num_env_steps_trained_throughput_per_sec": 5127.163654866495, "timesteps_total": 636000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 636000, "timers": {"training_iteration_time_ms": 2294.615, "sample_time_ms": 1930.83, "load_time_ms": 12.011, "load_throughput": 999058.101, "learn_time_ms": 340.694, "learn_throughput": 35222.226, "synch_weights_time_ms": 9.711}, "counters": {"num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_agent_steps_sampled": 636000, "num_agent_steps_trained": 636000}, "done": false, "episodes_total": 2397, "training_iteration": 53, "trial_id": "9f288_00017", "date": "2023-10-25_16-58-32", "timestamp": 1698249512, "time_this_iter_s": 2.3454737663269043, "time_total_s": 120.69532704353333, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 120.69532704353333, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 52.849999999999994, "ram_util_percent": 27.224999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.2204460492503138e-17, "cur_lr": 0.0003, "total_loss": 7.257238833109538, "policy_loss": -0.0001348872979482015, "vf_loss": 7.257431141535441, "vf_explained_var": -7.271766662597656e-07, "kl": 0.0007391997507359822, "entropy": 0.5748337070147197, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1605.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000}, "sampler_results": {"episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.84799999999983, "episode_len_mean": 262.18, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.500000000000014, 42.10000000000001, -50.00000000000044, -50.00000000000044, 41.30000000000001, 38.90000000000002, -50.00000000000044, -50.00000000000044, 32.700000000000024, 14.09999999999976, -50.00000000000044, -50.00000000000044, 43.50000000000001, 41.90000000000001, -50.00000000000044, -50.00000000000044, 46.3, 42.30000000000001, -50.00000000000044, 41.100000000000016, 43.50000000000001, -50.00000000000044, 28.29999999999996, 41.30000000000001, -50.00000000000044, 39.90000000000002, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 32.30000000000002, 42.900000000000006, -50.00000000000044, -50.00000000000044, 42.500000000000014, 21.89999999999987, 44.10000000000001, 45.3, 33.70000000000004, 44.900000000000006, 38.90000000000002, 3.699999999999612, 37.300000000000026, 35.70000000000003, 46.3, 23.499999999999893, -50.00000000000044, -50.00000000000044, 46.099999999999994, 45.7, 16.699999999999797, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 18.29999999999982, 36.10000000000004, 33.90000000000004, 33.90000000000004, 8.099999999999675, 43.900000000000006, 19.09999999999983, 18.899999999999828, 40.30000000000002, -50.00000000000044, 38.300000000000026, -50.00000000000044, 39.10000000000002, 42.70000000000001, 44.7, 35.70000000000003, -50.00000000000044, 44.7, 46.099999999999994, 26.499999999999936, 45.3, 9.699999999999697, 30.499999999999993, 40.70000000000002, -50.00000000000044, 45.1, 44.900000000000006, 42.10000000000001, 7.09999999999966, -50.00000000000044, 32.700000000000024, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 45.5, 36.10000000000004, -50.00000000000044, 42.70000000000001, -50.00000000000044, 43.50000000000001, -50.00000000000044, 38.90000000000002], "episode_lengths": [76, 80, 500, 500, 88, 112, 500, 500, 174, 360, 500, 500, 66, 82, 500, 500, 38, 78, 500, 90, 66, 500, 218, 88, 500, 102, 500, 72, 500, 500, 70, 500, 178, 72, 500, 500, 76, 282, 60, 48, 164, 52, 112, 464, 128, 144, 38, 266, 500, 500, 40, 44, 334, 500, 500, 500, 500, 318, 140, 162, 162, 420, 62, 310, 312, 98, 500, 118, 500, 110, 74, 54, 144, 500, 54, 40, 236, 48, 404, 196, 94, 500, 50, 52, 80, 430, 500, 174, 500, 76, 500, 500, 46, 140, 500, 74, 500, 66, 500, 112]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37693697754098493, "mean_inference_ms": 1.206469054629681, "mean_action_processing_ms": 0.14072931512899978, "mean_env_wait_ms": 0.08424347399534877, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02276778221130371, "StateBufferConnector_ms": 0.004999876022338867, "ViewRequirementAgentConnector_ms": 0.1352834701538086}}, "episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.84799999999983, "episode_len_mean": 262.18, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.500000000000014, 42.10000000000001, -50.00000000000044, -50.00000000000044, 41.30000000000001, 38.90000000000002, -50.00000000000044, -50.00000000000044, 32.700000000000024, 14.09999999999976, -50.00000000000044, -50.00000000000044, 43.50000000000001, 41.90000000000001, -50.00000000000044, -50.00000000000044, 46.3, 42.30000000000001, -50.00000000000044, 41.100000000000016, 43.50000000000001, -50.00000000000044, 28.29999999999996, 41.30000000000001, -50.00000000000044, 39.90000000000002, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 32.30000000000002, 42.900000000000006, -50.00000000000044, -50.00000000000044, 42.500000000000014, 21.89999999999987, 44.10000000000001, 45.3, 33.70000000000004, 44.900000000000006, 38.90000000000002, 3.699999999999612, 37.300000000000026, 35.70000000000003, 46.3, 23.499999999999893, -50.00000000000044, -50.00000000000044, 46.099999999999994, 45.7, 16.699999999999797, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 18.29999999999982, 36.10000000000004, 33.90000000000004, 33.90000000000004, 8.099999999999675, 43.900000000000006, 19.09999999999983, 18.899999999999828, 40.30000000000002, -50.00000000000044, 38.300000000000026, -50.00000000000044, 39.10000000000002, 42.70000000000001, 44.7, 35.70000000000003, -50.00000000000044, 44.7, 46.099999999999994, 26.499999999999936, 45.3, 9.699999999999697, 30.499999999999993, 40.70000000000002, -50.00000000000044, 45.1, 44.900000000000006, 42.10000000000001, 7.09999999999966, -50.00000000000044, 32.700000000000024, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 45.5, 36.10000000000004, -50.00000000000044, 42.70000000000001, -50.00000000000044, 43.50000000000001, -50.00000000000044, 38.90000000000002], "episode_lengths": [76, 80, 500, 500, 88, 112, 500, 500, 174, 360, 500, 500, 66, 82, 500, 500, 38, 78, 500, 90, 66, 500, 218, 88, 500, 102, 500, 72, 500, 500, 70, 500, 178, 72, 500, 500, 76, 282, 60, 48, 164, 52, 112, 464, 128, 144, 38, 266, 500, 500, 40, 44, 334, 500, 500, 500, 500, 318, 140, 162, 162, 420, 62, 310, 312, 98, 500, 118, 500, 110, 74, 54, 144, 500, 54, 40, 236, 48, 404, 196, 94, 500, 50, 52, 80, 430, 500, 174, 500, 76, 500, 500, 46, 140, 500, 74, 500, 66, 500, 112]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37693697754098493, "mean_inference_ms": 1.206469054629681, "mean_action_processing_ms": 0.14072931512899978, "mean_env_wait_ms": 0.08424347399534877, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02276778221130371, "StateBufferConnector_ms": 0.004999876022338867, "ViewRequirementAgentConnector_ms": 0.1352834701538086}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5509.81202665116, "num_env_steps_trained_throughput_per_sec": 5509.81202665116, "timesteps_total": 648000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 648000, "timers": {"training_iteration_time_ms": 2273.534, "sample_time_ms": 1930.38, "load_time_ms": 11.109, "load_throughput": 1080177.956, "learn_time_ms": 320.965, "learn_throughput": 37387.226, "synch_weights_time_ms": 9.711}, "counters": {"num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000}, "done": false, "episodes_total": 2445, "training_iteration": 54, "trial_id": "9f288_00017", "date": "2023-10-25_16-58-34", "timestamp": 1698249514, "time_this_iter_s": 2.183959722518921, "time_total_s": 122.87928676605225, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 122.87928676605225, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 59.4, "ram_util_percent": 27.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1102230246251569e-17, "cur_lr": 0.0003, "total_loss": 6.677968215942383, "policy_loss": 4.581982890764872e-06, "vf_loss": 6.6780237833658855, "vf_explained_var": -7.867813110351562e-07, "kl": 0.00010407986050798475, "entropy": 0.6019641061623892, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1635.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_agent_steps_sampled": 660000, "num_agent_steps_trained": 660000}, "sampler_results": {"episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.961999999999843, "episode_len_mean": 251.1, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [37.300000000000026, 35.70000000000003, 46.3, 23.499999999999893, -50.00000000000044, -50.00000000000044, 46.099999999999994, 45.7, 16.699999999999797, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 18.29999999999982, 36.10000000000004, 33.90000000000004, 33.90000000000004, 8.099999999999675, 43.900000000000006, 19.09999999999983, 18.899999999999828, 40.30000000000002, -50.00000000000044, 38.300000000000026, -50.00000000000044, 39.10000000000002, 42.70000000000001, 44.7, 35.70000000000003, -50.00000000000044, 44.7, 46.099999999999994, 26.499999999999936, 45.3, 9.699999999999697, 30.499999999999993, 40.70000000000002, -50.00000000000044, 45.1, 44.900000000000006, 42.10000000000001, 7.09999999999966, -50.00000000000044, 32.700000000000024, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 45.5, 36.10000000000004, -50.00000000000044, 42.70000000000001, -50.00000000000044, 43.50000000000001, -50.00000000000044, 38.90000000000002, 10.299999999999706, -50.00000000000044, 44.7, -50.00000000000044, 34.10000000000004, 26.89999999999994, 38.10000000000002, 42.10000000000001, 2.0999999999995893, 34.50000000000004, 6.699999999999655, 44.10000000000001, 44.300000000000004, 18.099999999999817, 41.90000000000001, -50.00000000000044, 44.7, 35.30000000000004, 44.900000000000006, 34.30000000000004, 40.30000000000002, -50.00000000000044, -50.00000000000044, 37.90000000000003, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 43.900000000000006, -50.00000000000044, 45.9, 42.70000000000001, 43.30000000000001, 4.899999999999629, 41.500000000000014, 22.49999999999988, 39.70000000000002, 39.10000000000002, 38.700000000000024, 9.699999999999697, -50.00000000000044, 44.5, -50.00000000000044], "episode_lengths": [128, 144, 38, 266, 500, 500, 40, 44, 334, 500, 500, 500, 500, 318, 140, 162, 162, 420, 62, 310, 312, 98, 500, 118, 500, 110, 74, 54, 144, 500, 54, 40, 236, 48, 404, 196, 94, 500, 50, 52, 80, 430, 500, 174, 500, 76, 500, 500, 46, 140, 500, 74, 500, 66, 500, 112, 398, 500, 54, 500, 160, 232, 120, 80, 480, 156, 434, 60, 58, 320, 82, 500, 54, 148, 52, 158, 98, 500, 500, 122, 92, 500, 500, 500, 54, 62, 500, 42, 74, 68, 452, 86, 276, 104, 110, 114, 404, 500, 56, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3766532458064542, "mean_inference_ms": 1.2065355847803971, "mean_action_processing_ms": 0.14054828693629726, "mean_env_wait_ms": 0.08401083003203456, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025778532028198242, "StateBufferConnector_ms": 0.008003473281860352, "ViewRequirementAgentConnector_ms": 0.13934731483459473}}, "episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.961999999999843, "episode_len_mean": 251.1, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [37.300000000000026, 35.70000000000003, 46.3, 23.499999999999893, -50.00000000000044, -50.00000000000044, 46.099999999999994, 45.7, 16.699999999999797, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 18.29999999999982, 36.10000000000004, 33.90000000000004, 33.90000000000004, 8.099999999999675, 43.900000000000006, 19.09999999999983, 18.899999999999828, 40.30000000000002, -50.00000000000044, 38.300000000000026, -50.00000000000044, 39.10000000000002, 42.70000000000001, 44.7, 35.70000000000003, -50.00000000000044, 44.7, 46.099999999999994, 26.499999999999936, 45.3, 9.699999999999697, 30.499999999999993, 40.70000000000002, -50.00000000000044, 45.1, 44.900000000000006, 42.10000000000001, 7.09999999999966, -50.00000000000044, 32.700000000000024, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 45.5, 36.10000000000004, -50.00000000000044, 42.70000000000001, -50.00000000000044, 43.50000000000001, -50.00000000000044, 38.90000000000002, 10.299999999999706, -50.00000000000044, 44.7, -50.00000000000044, 34.10000000000004, 26.89999999999994, 38.10000000000002, 42.10000000000001, 2.0999999999995893, 34.50000000000004, 6.699999999999655, 44.10000000000001, 44.300000000000004, 18.099999999999817, 41.90000000000001, -50.00000000000044, 44.7, 35.30000000000004, 44.900000000000006, 34.30000000000004, 40.30000000000002, -50.00000000000044, -50.00000000000044, 37.90000000000003, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 43.900000000000006, -50.00000000000044, 45.9, 42.70000000000001, 43.30000000000001, 4.899999999999629, 41.500000000000014, 22.49999999999988, 39.70000000000002, 39.10000000000002, 38.700000000000024, 9.699999999999697, -50.00000000000044, 44.5, -50.00000000000044], "episode_lengths": [128, 144, 38, 266, 500, 500, 40, 44, 334, 500, 500, 500, 500, 318, 140, 162, 162, 420, 62, 310, 312, 98, 500, 118, 500, 110, 74, 54, 144, 500, 54, 40, 236, 48, 404, 196, 94, 500, 50, 52, 80, 430, 500, 174, 500, 76, 500, 500, 46, 140, 500, 74, 500, 66, 500, 112, 398, 500, 54, 500, 160, 232, 120, 80, 480, 156, 434, 60, 58, 320, 82, 500, 54, 148, 52, 158, 98, 500, 500, 122, 92, 500, 500, 500, 54, 62, 500, 42, 74, 68, 452, 86, 276, 104, 110, 114, 404, 500, 56, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3766532458064542, "mean_inference_ms": 1.2065355847803971, "mean_action_processing_ms": 0.14054828693629726, "mean_env_wait_ms": 0.08401083003203456, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025778532028198242, "StateBufferConnector_ms": 0.008003473281860352, "ViewRequirementAgentConnector_ms": 0.13934731483459473}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 660000, "num_agent_steps_trained": 660000, "num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5248.480018836765, "num_env_steps_trained_throughput_per_sec": 5248.480018836765, "timesteps_total": 660000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 660000, "timers": {"training_iteration_time_ms": 2255.97, "sample_time_ms": 1902.154, "load_time_ms": 12.008, "load_throughput": 999355.652, "learn_time_ms": 330.727, "learn_throughput": 36283.655, "synch_weights_time_ms": 9.611}, "counters": {"num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_agent_steps_sampled": 660000, "num_agent_steps_trained": 660000}, "done": false, "episodes_total": 2489, "training_iteration": 55, "trial_id": "9f288_00017", "date": "2023-10-25_16-58-37", "timestamp": 1698249517, "time_this_iter_s": 2.2903707027435303, "time_total_s": 125.16965746879578, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 125.16965746879578, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 58.86666666666667, "ram_util_percent": 27.266666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.5511151231257846e-18, "cur_lr": 0.0003, "total_loss": 7.224503310521444, "policy_loss": -0.00046743579829732574, "vf_loss": 7.2250306606292725, "vf_explained_var": -7.748603820800781e-07, "kl": 0.0014019392651559788, "entropy": 0.5997762660185496, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1665.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.24399999999986, "episode_len_mean": 238.3, "episode_media": {}, "episodes_this_iter": 55, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [38.90000000000002, 10.299999999999706, -50.00000000000044, 44.7, -50.00000000000044, 34.10000000000004, 26.89999999999994, 38.10000000000002, 42.10000000000001, 2.0999999999995893, 34.50000000000004, 6.699999999999655, 44.10000000000001, 44.300000000000004, 18.099999999999817, 41.90000000000001, -50.00000000000044, 44.7, 35.30000000000004, 44.900000000000006, 34.30000000000004, 40.30000000000002, -50.00000000000044, -50.00000000000044, 37.90000000000003, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 43.900000000000006, -50.00000000000044, 45.9, 42.70000000000001, 43.30000000000001, 4.899999999999629, 41.500000000000014, 22.49999999999988, 39.70000000000002, 39.10000000000002, 38.700000000000024, 9.699999999999697, -50.00000000000044, 44.5, -50.00000000000044, 20.699999999999854, 43.900000000000006, -50.00000000000044, 31.300000000000004, 40.70000000000002, 44.900000000000006, -50.00000000000044, 25.699999999999925, 44.10000000000001, -50.00000000000044, -50.00000000000044, 45.5, 16.29999999999979, 31.70000000000001, 40.10000000000002, 34.10000000000004, 44.900000000000006, -50.00000000000044, -50.00000000000044, 45.1, 28.699999999999967, 46.699999999999996, 5.299999999999635, 45.3, 16.8999999999998, -50.00000000000044, 40.90000000000002, -50.00000000000044, 39.70000000000002, 43.10000000000001, 36.50000000000003, -50.00000000000044, 44.7, 20.099999999999845, 41.30000000000001, 29.099999999999973, 41.90000000000001, 44.900000000000006, 42.500000000000014, -50.00000000000044, 36.70000000000003, 39.90000000000002, 36.900000000000034, 43.10000000000001, 26.89999999999994, -50.00000000000044, 35.500000000000036, -50.00000000000044, -50.00000000000044, 41.70000000000002, 38.700000000000024, 37.70000000000003, -50.00000000000044, 44.5, -50.00000000000044], "episode_lengths": [112, 398, 500, 54, 500, 160, 232, 120, 80, 480, 156, 434, 60, 58, 320, 82, 500, 54, 148, 52, 158, 98, 500, 500, 122, 92, 500, 500, 500, 54, 62, 500, 42, 74, 68, 452, 86, 276, 104, 110, 114, 404, 500, 56, 500, 294, 62, 500, 188, 94, 52, 500, 244, 60, 500, 500, 46, 338, 184, 100, 160, 52, 500, 500, 50, 214, 34, 448, 48, 332, 500, 92, 500, 104, 70, 136, 500, 54, 300, 88, 210, 82, 52, 76, 500, 134, 102, 132, 70, 232, 500, 146, 500, 500, 84, 114, 124, 500, 56, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37616962369258206, "mean_inference_ms": 1.2065306628526151, "mean_action_processing_ms": 0.1402041678961172, "mean_env_wait_ms": 0.08393443168374538, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030016660690307617, "StateBufferConnector_ms": 0.0070018768310546875, "ViewRequirementAgentConnector_ms": 0.12102460861206055}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.24399999999986, "episode_len_mean": 238.3, "episodes_this_iter": 55, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [38.90000000000002, 10.299999999999706, -50.00000000000044, 44.7, -50.00000000000044, 34.10000000000004, 26.89999999999994, 38.10000000000002, 42.10000000000001, 2.0999999999995893, 34.50000000000004, 6.699999999999655, 44.10000000000001, 44.300000000000004, 18.099999999999817, 41.90000000000001, -50.00000000000044, 44.7, 35.30000000000004, 44.900000000000006, 34.30000000000004, 40.30000000000002, -50.00000000000044, -50.00000000000044, 37.90000000000003, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 43.900000000000006, -50.00000000000044, 45.9, 42.70000000000001, 43.30000000000001, 4.899999999999629, 41.500000000000014, 22.49999999999988, 39.70000000000002, 39.10000000000002, 38.700000000000024, 9.699999999999697, -50.00000000000044, 44.5, -50.00000000000044, 20.699999999999854, 43.900000000000006, -50.00000000000044, 31.300000000000004, 40.70000000000002, 44.900000000000006, -50.00000000000044, 25.699999999999925, 44.10000000000001, -50.00000000000044, -50.00000000000044, 45.5, 16.29999999999979, 31.70000000000001, 40.10000000000002, 34.10000000000004, 44.900000000000006, -50.00000000000044, -50.00000000000044, 45.1, 28.699999999999967, 46.699999999999996, 5.299999999999635, 45.3, 16.8999999999998, -50.00000000000044, 40.90000000000002, -50.00000000000044, 39.70000000000002, 43.10000000000001, 36.50000000000003, -50.00000000000044, 44.7, 20.099999999999845, 41.30000000000001, 29.099999999999973, 41.90000000000001, 44.900000000000006, 42.500000000000014, -50.00000000000044, 36.70000000000003, 39.90000000000002, 36.900000000000034, 43.10000000000001, 26.89999999999994, -50.00000000000044, 35.500000000000036, -50.00000000000044, -50.00000000000044, 41.70000000000002, 38.700000000000024, 37.70000000000003, -50.00000000000044, 44.5, -50.00000000000044], "episode_lengths": [112, 398, 500, 54, 500, 160, 232, 120, 80, 480, 156, 434, 60, 58, 320, 82, 500, 54, 148, 52, 158, 98, 500, 500, 122, 92, 500, 500, 500, 54, 62, 500, 42, 74, 68, 452, 86, 276, 104, 110, 114, 404, 500, 56, 500, 294, 62, 500, 188, 94, 52, 500, 244, 60, 500, 500, 46, 338, 184, 100, 160, 52, 500, 500, 50, 214, 34, 448, 48, 332, 500, 92, 500, 104, 70, 136, 500, 54, 300, 88, 210, 82, 52, 76, 500, 134, 102, 132, 70, 232, 500, 146, 500, 500, 84, 114, 124, 500, 56, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37616962369258206, "mean_inference_ms": 1.2065306628526151, "mean_action_processing_ms": 0.1402041678961172, "mean_env_wait_ms": 0.08393443168374538, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030016660690307617, "StateBufferConnector_ms": 0.0070018768310546875, "ViewRequirementAgentConnector_ms": 0.12102460861206055}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000, "num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5353.363952055085, "num_env_steps_trained_throughput_per_sec": 5353.363952055085, "timesteps_total": 672000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 672000, "timers": {"training_iteration_time_ms": 2249.963, "sample_time_ms": 1896.155, "load_time_ms": 12.008, "load_throughput": 999345.731, "learn_time_ms": 330.766, "learn_throughput": 36279.444, "synch_weights_time_ms": 9.565}, "counters": {"num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "done": false, "episodes_total": 2544, "training_iteration": 56, "trial_id": "9f288_00017", "date": "2023-10-25_16-58-39", "timestamp": 1698249519, "time_this_iter_s": 2.2475790977478027, "time_total_s": 127.41723656654358, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 127.41723656654358, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 56.36666666666667, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.7755575615628923e-18, "cur_lr": 0.0003, "total_loss": 6.18293088277181, "policy_loss": -0.000599348172545433, "vf_loss": 6.183589235941569, "vf_explained_var": -9.695688883463541e-07, "kl": 0.001365211610048315, "entropy": 0.5908386846383412, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1695.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.836999999999852, "episode_len_mean": 247.34, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.699999999999697, -50.00000000000044, 44.5, -50.00000000000044, 20.699999999999854, 43.900000000000006, -50.00000000000044, 31.300000000000004, 40.70000000000002, 44.900000000000006, -50.00000000000044, 25.699999999999925, 44.10000000000001, -50.00000000000044, -50.00000000000044, 45.5, 16.29999999999979, 31.70000000000001, 40.10000000000002, 34.10000000000004, 44.900000000000006, -50.00000000000044, -50.00000000000044, 45.1, 28.699999999999967, 46.699999999999996, 5.299999999999635, 45.3, 16.8999999999998, -50.00000000000044, 40.90000000000002, -50.00000000000044, 39.70000000000002, 43.10000000000001, 36.50000000000003, -50.00000000000044, 44.7, 20.099999999999845, 41.30000000000001, 29.099999999999973, 41.90000000000001, 44.900000000000006, 42.500000000000014, -50.00000000000044, 36.70000000000003, 39.90000000000002, 36.900000000000034, 43.10000000000001, 26.89999999999994, -50.00000000000044, 35.500000000000036, -50.00000000000044, -50.00000000000044, 41.70000000000002, 38.700000000000024, 37.70000000000003, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 39.50000000000002, -50.00000000000044, 32.700000000000024, 43.30000000000001, 41.500000000000014, 40.90000000000002, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.10000000000004, -50.00000000000044, 26.299999999999933, 39.90000000000002, 42.30000000000001, 36.30000000000003, 43.50000000000001, -50.00000000000044, -50.00000000000044, 44.7, 17.099999999999802, 26.69999999999994, 16.699999999999797, 44.300000000000004, 36.10000000000004, 41.70000000000002, 45.9, 1.6999999999995836, 34.10000000000004, 41.100000000000016, 30.499999999999993, 20.099999999999845, 42.30000000000001, -50.00000000000044, 23.699999999999896, -50.00000000000044, 44.300000000000004, -50.00000000000044, 43.900000000000006, -50.00000000000044], "episode_lengths": [404, 500, 56, 500, 294, 62, 500, 188, 94, 52, 500, 244, 60, 500, 500, 46, 338, 184, 100, 160, 52, 500, 500, 50, 214, 34, 448, 48, 332, 500, 92, 500, 104, 70, 136, 500, 54, 300, 88, 210, 82, 52, 76, 500, 134, 102, 132, 70, 232, 500, 146, 500, 500, 84, 114, 124, 500, 56, 500, 500, 106, 500, 174, 68, 86, 92, 40, 500, 500, 500, 160, 500, 238, 102, 78, 138, 66, 500, 500, 54, 330, 234, 334, 58, 140, 84, 42, 484, 160, 90, 196, 300, 78, 500, 264, 500, 58, 500, 62, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37621038495985965, "mean_inference_ms": 1.2063183272603228, "mean_action_processing_ms": 0.14027976358036234, "mean_env_wait_ms": 0.08417385326425444, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029013872146606445, "StateBufferConnector_ms": 0.004999876022338867, "ViewRequirementAgentConnector_ms": 0.12402582168579102}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.836999999999852, "episode_len_mean": 247.34, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.699999999999697, -50.00000000000044, 44.5, -50.00000000000044, 20.699999999999854, 43.900000000000006, -50.00000000000044, 31.300000000000004, 40.70000000000002, 44.900000000000006, -50.00000000000044, 25.699999999999925, 44.10000000000001, -50.00000000000044, -50.00000000000044, 45.5, 16.29999999999979, 31.70000000000001, 40.10000000000002, 34.10000000000004, 44.900000000000006, -50.00000000000044, -50.00000000000044, 45.1, 28.699999999999967, 46.699999999999996, 5.299999999999635, 45.3, 16.8999999999998, -50.00000000000044, 40.90000000000002, -50.00000000000044, 39.70000000000002, 43.10000000000001, 36.50000000000003, -50.00000000000044, 44.7, 20.099999999999845, 41.30000000000001, 29.099999999999973, 41.90000000000001, 44.900000000000006, 42.500000000000014, -50.00000000000044, 36.70000000000003, 39.90000000000002, 36.900000000000034, 43.10000000000001, 26.89999999999994, -50.00000000000044, 35.500000000000036, -50.00000000000044, -50.00000000000044, 41.70000000000002, 38.700000000000024, 37.70000000000003, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 39.50000000000002, -50.00000000000044, 32.700000000000024, 43.30000000000001, 41.500000000000014, 40.90000000000002, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.10000000000004, -50.00000000000044, 26.299999999999933, 39.90000000000002, 42.30000000000001, 36.30000000000003, 43.50000000000001, -50.00000000000044, -50.00000000000044, 44.7, 17.099999999999802, 26.69999999999994, 16.699999999999797, 44.300000000000004, 36.10000000000004, 41.70000000000002, 45.9, 1.6999999999995836, 34.10000000000004, 41.100000000000016, 30.499999999999993, 20.099999999999845, 42.30000000000001, -50.00000000000044, 23.699999999999896, -50.00000000000044, 44.300000000000004, -50.00000000000044, 43.900000000000006, -50.00000000000044], "episode_lengths": [404, 500, 56, 500, 294, 62, 500, 188, 94, 52, 500, 244, 60, 500, 500, 46, 338, 184, 100, 160, 52, 500, 500, 50, 214, 34, 448, 48, 332, 500, 92, 500, 104, 70, 136, 500, 54, 300, 88, 210, 82, 52, 76, 500, 134, 102, 132, 70, 232, 500, 146, 500, 500, 84, 114, 124, 500, 56, 500, 500, 106, 500, 174, 68, 86, 92, 40, 500, 500, 500, 160, 500, 238, 102, 78, 138, 66, 500, 500, 54, 330, 234, 334, 58, 140, 84, 42, 484, 160, 90, 196, 300, 78, 500, 264, 500, 58, 500, 62, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37621038495985965, "mean_inference_ms": 1.2063183272603228, "mean_action_processing_ms": 0.14027976358036234, "mean_env_wait_ms": 0.08417385326425444, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029013872146606445, "StateBufferConnector_ms": 0.004999876022338867, "ViewRequirementAgentConnector_ms": 0.12402582168579102}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000, "num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4854.673504719335, "num_env_steps_trained_throughput_per_sec": 4854.673504719335, "timesteps_total": 684000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 684000, "timers": {"training_iteration_time_ms": 2273.522, "sample_time_ms": 1919.214, "load_time_ms": 11.987, "load_throughput": 1001055.081, "learn_time_ms": 331.307, "learn_throughput": 36220.19, "synch_weights_time_ms": 9.544}, "counters": {"num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000}, "done": false, "episodes_total": 2585, "training_iteration": 57, "trial_id": "9f288_00017", "date": "2023-10-25_16-58-42", "timestamp": 1698249522, "time_this_iter_s": 2.4758431911468506, "time_total_s": 129.89307975769043, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 129.89307975769043, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 49.05, "ram_util_percent": 27.224999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.3877787807814461e-18, "cur_lr": 0.0003, "total_loss": 7.5428080558776855, "policy_loss": -0.0012097184856732686, "vf_loss": 7.544071292877197, "vf_explained_var": -6.69558842976888e-07, "kl": 0.001974288420217363, "entropy": 0.534143457810084, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1725.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.290999999999858, "episode_len_mean": 232.82, "episode_media": {}, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 32.700000000000024, 43.30000000000001, 41.500000000000014, 40.90000000000002, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.10000000000004, -50.00000000000044, 26.299999999999933, 39.90000000000002, 42.30000000000001, 36.30000000000003, 43.50000000000001, -50.00000000000044, -50.00000000000044, 44.7, 17.099999999999802, 26.69999999999994, 16.699999999999797, 44.300000000000004, 36.10000000000004, 41.70000000000002, 45.9, 1.6999999999995836, 34.10000000000004, 41.100000000000016, 30.499999999999993, 20.099999999999845, 42.30000000000001, -50.00000000000044, 23.699999999999896, -50.00000000000044, 44.300000000000004, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 43.50000000000001, 37.50000000000003, 38.300000000000026, 2.699999999999598, 43.50000000000001, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.70000000000003, -50.00000000000044, -50.00000000000044, 45.5, 47.5, 36.70000000000003, 45.5, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 41.70000000000002, 38.700000000000024, 46.5, 40.30000000000002, 46.099999999999994, 45.5, 2.8999999999996007, 45.7, 43.30000000000001, -50.00000000000044, 37.10000000000003, 43.7, 46.099999999999994, 40.70000000000002, -50.00000000000044, 42.900000000000006, -50.00000000000044, 45.7, 45.1, 16.29999999999979, 33.70000000000004, 36.900000000000034, 42.30000000000001, 31.500000000000007, 37.300000000000026, 8.699999999999683, 37.90000000000003, -50.00000000000044, 32.100000000000016, 46.5, 43.30000000000001, -50.00000000000044, 46.3, 31.1, 46.099999999999994, 40.10000000000002, 43.7, 9.099999999999689], "episode_lengths": [500, 174, 68, 86, 92, 40, 500, 500, 500, 160, 500, 238, 102, 78, 138, 66, 500, 500, 54, 330, 234, 334, 58, 140, 84, 42, 484, 160, 90, 196, 300, 78, 500, 264, 500, 58, 500, 62, 500, 500, 66, 126, 118, 474, 66, 88, 500, 500, 500, 500, 500, 144, 500, 500, 46, 26, 134, 46, 500, 54, 500, 500, 84, 114, 36, 98, 40, 46, 472, 44, 68, 500, 130, 64, 40, 94, 500, 72, 500, 44, 50, 338, 164, 132, 78, 186, 128, 414, 122, 500, 180, 36, 68, 500, 38, 190, 40, 100, 64, 410]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37643765240156163, "mean_inference_ms": 1.2053673872465123, "mean_action_processing_ms": 0.1403635615701541, "mean_env_wait_ms": 0.08438651333690891, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016994714736938477, "StateBufferConnector_ms": 0.005997657775878906, "ViewRequirementAgentConnector_ms": 0.15002942085266113}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.290999999999858, "episode_len_mean": 232.82, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 32.700000000000024, 43.30000000000001, 41.500000000000014, 40.90000000000002, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.10000000000004, -50.00000000000044, 26.299999999999933, 39.90000000000002, 42.30000000000001, 36.30000000000003, 43.50000000000001, -50.00000000000044, -50.00000000000044, 44.7, 17.099999999999802, 26.69999999999994, 16.699999999999797, 44.300000000000004, 36.10000000000004, 41.70000000000002, 45.9, 1.6999999999995836, 34.10000000000004, 41.100000000000016, 30.499999999999993, 20.099999999999845, 42.30000000000001, -50.00000000000044, 23.699999999999896, -50.00000000000044, 44.300000000000004, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 43.50000000000001, 37.50000000000003, 38.300000000000026, 2.699999999999598, 43.50000000000001, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.70000000000003, -50.00000000000044, -50.00000000000044, 45.5, 47.5, 36.70000000000003, 45.5, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 41.70000000000002, 38.700000000000024, 46.5, 40.30000000000002, 46.099999999999994, 45.5, 2.8999999999996007, 45.7, 43.30000000000001, -50.00000000000044, 37.10000000000003, 43.7, 46.099999999999994, 40.70000000000002, -50.00000000000044, 42.900000000000006, -50.00000000000044, 45.7, 45.1, 16.29999999999979, 33.70000000000004, 36.900000000000034, 42.30000000000001, 31.500000000000007, 37.300000000000026, 8.699999999999683, 37.90000000000003, -50.00000000000044, 32.100000000000016, 46.5, 43.30000000000001, -50.00000000000044, 46.3, 31.1, 46.099999999999994, 40.10000000000002, 43.7, 9.099999999999689], "episode_lengths": [500, 174, 68, 86, 92, 40, 500, 500, 500, 160, 500, 238, 102, 78, 138, 66, 500, 500, 54, 330, 234, 334, 58, 140, 84, 42, 484, 160, 90, 196, 300, 78, 500, 264, 500, 58, 500, 62, 500, 500, 66, 126, 118, 474, 66, 88, 500, 500, 500, 500, 500, 144, 500, 500, 46, 26, 134, 46, 500, 54, 500, 500, 84, 114, 36, 98, 40, 46, 472, 44, 68, 500, 130, 64, 40, 94, 500, 72, 500, 44, 50, 338, 164, 132, 78, 186, 128, 414, 122, 500, 180, 36, 68, 500, 38, 190, 40, 100, 64, 410]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37643765240156163, "mean_inference_ms": 1.2053673872465123, "mean_action_processing_ms": 0.1403635615701541, "mean_env_wait_ms": 0.08438651333690891, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016994714736938477, "StateBufferConnector_ms": 0.005997657775878906, "ViewRequirementAgentConnector_ms": 0.15002942085266113}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000, "num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5283.300551280137, "num_env_steps_trained_throughput_per_sec": 5283.300551280137, "timesteps_total": 696000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 696000, "timers": {"training_iteration_time_ms": 2269.913, "sample_time_ms": 1919.873, "load_time_ms": 12.357, "load_throughput": 971096.649, "learn_time_ms": 326.709, "learn_throughput": 36729.971, "synch_weights_time_ms": 9.505}, "counters": {"num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000}, "done": false, "episodes_total": 2646, "training_iteration": 58, "trial_id": "9f288_00017", "date": "2023-10-25_16-58-44", "timestamp": 1698249524, "time_this_iter_s": 2.2763051986694336, "time_total_s": 132.16938495635986, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 132.16938495635986, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 60.199999999999996, "ram_util_percent": 27.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.938893903907231e-19, "cur_lr": 0.0003, "total_loss": 7.08368452390035, "policy_loss": -0.0003835206230481466, "vf_loss": 7.084117046991984, "vf_explained_var": -1.0768572489420573e-06, "kl": 0.0009230463358562702, "entropy": 0.49021963477134706, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1755.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_agent_steps_sampled": 708000, "num_agent_steps_trained": 708000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.56399999999986, "episode_len_mean": 225.08, "episode_media": {}, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 35.70000000000003, -50.00000000000044, -50.00000000000044, 45.5, 47.5, 36.70000000000003, 45.5, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 41.70000000000002, 38.700000000000024, 46.5, 40.30000000000002, 46.099999999999994, 45.5, 2.8999999999996007, 45.7, 43.30000000000001, -50.00000000000044, 37.10000000000003, 43.7, 46.099999999999994, 40.70000000000002, -50.00000000000044, 42.900000000000006, -50.00000000000044, 45.7, 45.1, 16.29999999999979, 33.70000000000004, 36.900000000000034, 42.30000000000001, 31.500000000000007, 37.300000000000026, 8.699999999999683, 37.90000000000003, -50.00000000000044, 32.100000000000016, 46.5, 43.30000000000001, -50.00000000000044, 46.3, 31.1, 46.099999999999994, 40.10000000000002, 43.7, 9.099999999999689, -50.00000000000044, 42.10000000000001, 22.299999999999876, -50.00000000000044, 37.50000000000003, 42.500000000000014, 41.90000000000001, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 19.69999999999984, 47.1, 43.7, 27.899999999999956, 13.499999999999751, 40.30000000000002, -50.00000000000044, 39.70000000000002, -50.00000000000044, 46.5, -50.00000000000044, 46.3, 44.900000000000006, 20.099999999999845, -50.00000000000044, 16.699999999999797, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 43.50000000000001, 44.10000000000001, 44.7, 43.10000000000001, -50.00000000000044, -50.00000000000044, 35.500000000000036, 26.69999999999994, 43.900000000000006, 41.30000000000001, -50.00000000000044, 44.900000000000006, 46.3, 45.5, 35.70000000000003, 43.900000000000006, -50.00000000000044, 41.90000000000001, -50.00000000000044], "episode_lengths": [500, 144, 500, 500, 46, 26, 134, 46, 500, 54, 500, 500, 84, 114, 36, 98, 40, 46, 472, 44, 68, 500, 130, 64, 40, 94, 500, 72, 500, 44, 50, 338, 164, 132, 78, 186, 128, 414, 122, 500, 180, 36, 68, 500, 38, 190, 40, 100, 64, 410, 500, 80, 278, 500, 126, 76, 82, 500, 500, 40, 500, 304, 30, 64, 222, 366, 98, 500, 104, 500, 36, 500, 38, 52, 300, 500, 334, 500, 500, 40, 500, 66, 60, 54, 70, 500, 500, 146, 234, 62, 88, 500, 52, 38, 46, 144, 62, 500, 82, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3769376335981949, "mean_inference_ms": 1.2056350962841287, "mean_action_processing_ms": 0.14064599296092478, "mean_env_wait_ms": 0.08426631327314635, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023000001907348633, "StateBufferConnector_ms": 0.010997533798217773, "ViewRequirementAgentConnector_ms": 0.13701391220092773}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.56399999999986, "episode_len_mean": 225.08, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 35.70000000000003, -50.00000000000044, -50.00000000000044, 45.5, 47.5, 36.70000000000003, 45.5, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 41.70000000000002, 38.700000000000024, 46.5, 40.30000000000002, 46.099999999999994, 45.5, 2.8999999999996007, 45.7, 43.30000000000001, -50.00000000000044, 37.10000000000003, 43.7, 46.099999999999994, 40.70000000000002, -50.00000000000044, 42.900000000000006, -50.00000000000044, 45.7, 45.1, 16.29999999999979, 33.70000000000004, 36.900000000000034, 42.30000000000001, 31.500000000000007, 37.300000000000026, 8.699999999999683, 37.90000000000003, -50.00000000000044, 32.100000000000016, 46.5, 43.30000000000001, -50.00000000000044, 46.3, 31.1, 46.099999999999994, 40.10000000000002, 43.7, 9.099999999999689, -50.00000000000044, 42.10000000000001, 22.299999999999876, -50.00000000000044, 37.50000000000003, 42.500000000000014, 41.90000000000001, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 19.69999999999984, 47.1, 43.7, 27.899999999999956, 13.499999999999751, 40.30000000000002, -50.00000000000044, 39.70000000000002, -50.00000000000044, 46.5, -50.00000000000044, 46.3, 44.900000000000006, 20.099999999999845, -50.00000000000044, 16.699999999999797, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 43.50000000000001, 44.10000000000001, 44.7, 43.10000000000001, -50.00000000000044, -50.00000000000044, 35.500000000000036, 26.69999999999994, 43.900000000000006, 41.30000000000001, -50.00000000000044, 44.900000000000006, 46.3, 45.5, 35.70000000000003, 43.900000000000006, -50.00000000000044, 41.90000000000001, -50.00000000000044], "episode_lengths": [500, 144, 500, 500, 46, 26, 134, 46, 500, 54, 500, 500, 84, 114, 36, 98, 40, 46, 472, 44, 68, 500, 130, 64, 40, 94, 500, 72, 500, 44, 50, 338, 164, 132, 78, 186, 128, 414, 122, 500, 180, 36, 68, 500, 38, 190, 40, 100, 64, 410, 500, 80, 278, 500, 126, 76, 82, 500, 500, 40, 500, 304, 30, 64, 222, 366, 98, 500, 104, 500, 36, 500, 38, 52, 300, 500, 334, 500, 500, 40, 500, 66, 60, 54, 70, 500, 500, 146, 234, 62, 88, 500, 52, 38, 46, 144, 62, 500, 82, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3769376335981949, "mean_inference_ms": 1.2056350962841287, "mean_action_processing_ms": 0.14064599296092478, "mean_env_wait_ms": 0.08426631327314635, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023000001907348633, "StateBufferConnector_ms": 0.010997533798217773, "ViewRequirementAgentConnector_ms": 0.13701391220092773}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 708000, "num_agent_steps_trained": 708000, "num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5290.9777434051275, "num_env_steps_trained_throughput_per_sec": 5290.9777434051275, "timesteps_total": 708000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 708000, "timers": {"training_iteration_time_ms": 2283.992, "sample_time_ms": 1924.268, "load_time_ms": 12.68, "load_throughput": 946336.203, "learn_time_ms": 335.985, "learn_throughput": 35715.843, "synch_weights_time_ms": 9.613}, "counters": {"num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_agent_steps_sampled": 708000, "num_agent_steps_trained": 708000}, "done": false, "episodes_total": 2696, "training_iteration": 59, "trial_id": "9f288_00017", "date": "2023-10-25_16-58-46", "timestamp": 1698249526, "time_this_iter_s": 2.274003267288208, "time_total_s": 134.44338822364807, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 134.44338822364807, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 58.333333333333336, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.4694469519536153e-19, "cur_lr": 0.0003, "total_loss": 6.1880468686421715, "policy_loss": -8.52464387814204e-05, "vf_loss": 6.188182655970255, "vf_explained_var": -1.247723897298177e-06, "kl": 0.00018929978813275739, "entropy": 0.5052506397167842, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1785.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.11199999999982, "episode_len_mean": 259.5, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 32.100000000000016, 46.5, 43.30000000000001, -50.00000000000044, 46.3, 31.1, 46.099999999999994, 40.10000000000002, 43.7, 9.099999999999689, -50.00000000000044, 42.10000000000001, 22.299999999999876, -50.00000000000044, 37.50000000000003, 42.500000000000014, 41.90000000000001, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 19.69999999999984, 47.1, 43.7, 27.899999999999956, 13.499999999999751, 40.30000000000002, -50.00000000000044, 39.70000000000002, -50.00000000000044, 46.5, -50.00000000000044, 46.3, 44.900000000000006, 20.099999999999845, -50.00000000000044, 16.699999999999797, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 43.50000000000001, 44.10000000000001, 44.7, 43.10000000000001, -50.00000000000044, -50.00000000000044, 35.500000000000036, 26.69999999999994, 43.900000000000006, 41.30000000000001, -50.00000000000044, 44.900000000000006, 46.3, 45.5, 35.70000000000003, 43.900000000000006, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 35.30000000000004, 46.699999999999996, 31.300000000000004, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 38.300000000000026, -50.00000000000044, 35.10000000000004, 45.1, 20.099999999999845, 45.3, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.499999999999893, 41.90000000000001, 42.500000000000014, 45.5, 40.500000000000014, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 180, 36, 68, 500, 38, 190, 40, 100, 64, 410, 500, 80, 278, 500, 126, 76, 82, 500, 500, 40, 500, 304, 30, 64, 222, 366, 98, 500, 104, 500, 36, 500, 38, 52, 300, 500, 334, 500, 500, 40, 500, 66, 60, 54, 70, 500, 500, 146, 234, 62, 88, 500, 52, 38, 46, 144, 62, 500, 82, 500, 500, 86, 500, 500, 44, 500, 500, 148, 34, 188, 500, 32, 500, 500, 56, 500, 500, 500, 48, 118, 500, 150, 50, 300, 48, 50, 500, 500, 500, 500, 266, 82, 76, 46, 96, 32, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37715736431797725, "mean_inference_ms": 1.2057393270928332, "mean_action_processing_ms": 0.1401199814005593, "mean_env_wait_ms": 0.08403345615262531, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030008554458618164, "StateBufferConnector_ms": 0.006998538970947266, "ViewRequirementAgentConnector_ms": 0.12700963020324707}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.11199999999982, "episode_len_mean": 259.5, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 32.100000000000016, 46.5, 43.30000000000001, -50.00000000000044, 46.3, 31.1, 46.099999999999994, 40.10000000000002, 43.7, 9.099999999999689, -50.00000000000044, 42.10000000000001, 22.299999999999876, -50.00000000000044, 37.50000000000003, 42.500000000000014, 41.90000000000001, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 19.69999999999984, 47.1, 43.7, 27.899999999999956, 13.499999999999751, 40.30000000000002, -50.00000000000044, 39.70000000000002, -50.00000000000044, 46.5, -50.00000000000044, 46.3, 44.900000000000006, 20.099999999999845, -50.00000000000044, 16.699999999999797, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 43.50000000000001, 44.10000000000001, 44.7, 43.10000000000001, -50.00000000000044, -50.00000000000044, 35.500000000000036, 26.69999999999994, 43.900000000000006, 41.30000000000001, -50.00000000000044, 44.900000000000006, 46.3, 45.5, 35.70000000000003, 43.900000000000006, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 35.30000000000004, 46.699999999999996, 31.300000000000004, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 38.300000000000026, -50.00000000000044, 35.10000000000004, 45.1, 20.099999999999845, 45.3, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.499999999999893, 41.90000000000001, 42.500000000000014, 45.5, 40.500000000000014, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 180, 36, 68, 500, 38, 190, 40, 100, 64, 410, 500, 80, 278, 500, 126, 76, 82, 500, 500, 40, 500, 304, 30, 64, 222, 366, 98, 500, 104, 500, 36, 500, 38, 52, 300, 500, 334, 500, 500, 40, 500, 66, 60, 54, 70, 500, 500, 146, 234, 62, 88, 500, 52, 38, 46, 144, 62, 500, 82, 500, 500, 86, 500, 500, 44, 500, 500, 148, 34, 188, 500, 32, 500, 500, 56, 500, 500, 500, 48, 118, 500, 150, 50, 300, 48, 50, 500, 500, 500, 500, 266, 82, 76, 46, 96, 32, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37715736431797725, "mean_inference_ms": 1.2057393270928332, "mean_action_processing_ms": 0.1401199814005593, "mean_env_wait_ms": 0.08403345615262531, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030008554458618164, "StateBufferConnector_ms": 0.006998538970947266, "ViewRequirementAgentConnector_ms": 0.12700963020324707}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5019.026703678408, "num_env_steps_trained_throughput_per_sec": 5019.026703678408, "timesteps_total": 720000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 720000, "timers": {"training_iteration_time_ms": 2296.842, "sample_time_ms": 1924.599, "load_time_ms": 13.428, "load_throughput": 893642.58, "learn_time_ms": 348.001, "learn_throughput": 34482.657, "synch_weights_time_ms": 9.369}, "counters": {"num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "done": false, "episodes_total": 2735, "training_iteration": 60, "trial_id": "9f288_00017", "date": "2023-10-25_16-58-49", "timestamp": 1698249529, "time_this_iter_s": 2.3958945274353027, "time_total_s": 136.83928275108337, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 136.83928275108337, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 49.824999999999996, "ram_util_percent": 27.25}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.7347234759768077e-19, "cur_lr": 0.0003, "total_loss": 6.029007784525553, "policy_loss": -0.0003721564697722594, "vf_loss": 6.029425811767578, "vf_explained_var": -1.0609626770019532e-06, "kl": 0.0009247395663938581, "entropy": 0.4578552931547165, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1815.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_agent_steps_sampled": 732000, "num_agent_steps_trained": 732000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.5289999999998043, "episode_len_mean": 270.28, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.099999999999994, -50.00000000000044, 43.50000000000001, 44.10000000000001, 44.7, 43.10000000000001, -50.00000000000044, -50.00000000000044, 35.500000000000036, 26.69999999999994, 43.900000000000006, 41.30000000000001, -50.00000000000044, 44.900000000000006, 46.3, 45.5, 35.70000000000003, 43.900000000000006, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 35.30000000000004, 46.699999999999996, 31.300000000000004, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 38.300000000000026, -50.00000000000044, 35.10000000000004, 45.1, 20.099999999999845, 45.3, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.499999999999893, 41.90000000000001, 42.500000000000014, 45.5, 40.500000000000014, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 45.3, 47.3, 39.10000000000002, 46.3, 44.5, 36.70000000000003, 24.899999999999913, 17.299999999999805, -50.00000000000044, 37.10000000000003, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 45.9, -50.00000000000044, 23.29999999999989, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 38.10000000000002, 12.899999999999743, 44.7, -50.00000000000044, -50.00000000000044, 47.3, 46.9, -50.00000000000044], "episode_lengths": [40, 500, 66, 60, 54, 70, 500, 500, 146, 234, 62, 88, 500, 52, 38, 46, 144, 62, 500, 82, 500, 500, 86, 500, 500, 44, 500, 500, 148, 34, 188, 500, 32, 500, 500, 56, 500, 500, 500, 48, 118, 500, 150, 50, 300, 48, 50, 500, 500, 500, 500, 266, 82, 76, 46, 96, 32, 500, 500, 500, 500, 500, 48, 48, 28, 110, 38, 56, 134, 252, 328, 500, 130, 500, 500, 46, 500, 500, 36, 500, 500, 500, 48, 500, 42, 500, 268, 46, 500, 500, 500, 70, 120, 372, 54, 500, 500, 28, 32, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37729298504381165, "mean_inference_ms": 1.2062061619174222, "mean_action_processing_ms": 0.14009376827181114, "mean_env_wait_ms": 0.08407510378633183, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029511451721191406, "StateBufferConnector_ms": 0.003025531768798828, "ViewRequirementAgentConnector_ms": 0.1200094223022461}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.5289999999998043, "episode_len_mean": 270.28, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.099999999999994, -50.00000000000044, 43.50000000000001, 44.10000000000001, 44.7, 43.10000000000001, -50.00000000000044, -50.00000000000044, 35.500000000000036, 26.69999999999994, 43.900000000000006, 41.30000000000001, -50.00000000000044, 44.900000000000006, 46.3, 45.5, 35.70000000000003, 43.900000000000006, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 35.30000000000004, 46.699999999999996, 31.300000000000004, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 38.300000000000026, -50.00000000000044, 35.10000000000004, 45.1, 20.099999999999845, 45.3, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.499999999999893, 41.90000000000001, 42.500000000000014, 45.5, 40.500000000000014, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 45.3, 47.3, 39.10000000000002, 46.3, 44.5, 36.70000000000003, 24.899999999999913, 17.299999999999805, -50.00000000000044, 37.10000000000003, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 45.9, -50.00000000000044, 23.29999999999989, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 38.10000000000002, 12.899999999999743, 44.7, -50.00000000000044, -50.00000000000044, 47.3, 46.9, -50.00000000000044], "episode_lengths": [40, 500, 66, 60, 54, 70, 500, 500, 146, 234, 62, 88, 500, 52, 38, 46, 144, 62, 500, 82, 500, 500, 86, 500, 500, 44, 500, 500, 148, 34, 188, 500, 32, 500, 500, 56, 500, 500, 500, 48, 118, 500, 150, 50, 300, 48, 50, 500, 500, 500, 500, 266, 82, 76, 46, 96, 32, 500, 500, 500, 500, 500, 48, 48, 28, 110, 38, 56, 134, 252, 328, 500, 130, 500, 500, 46, 500, 500, 36, 500, 500, 500, 48, 500, 42, 500, 268, 46, 500, 500, 500, 70, 120, 372, 54, 500, 500, 28, 32, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37729298504381165, "mean_inference_ms": 1.2062061619174222, "mean_action_processing_ms": 0.14009376827181114, "mean_env_wait_ms": 0.08407510378633183, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029511451721191406, "StateBufferConnector_ms": 0.003025531768798828, "ViewRequirementAgentConnector_ms": 0.1200094223022461}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 732000, "num_agent_steps_trained": 732000, "num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5394.989480490136, "num_env_steps_trained_throughput_per_sec": 5394.989480490136, "timesteps_total": 732000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 732000, "timers": {"training_iteration_time_ms": 2288.697, "sample_time_ms": 1925.821, "load_time_ms": 12.685, "load_throughput": 946005.368, "learn_time_ms": 339.188, "learn_throughput": 35378.65, "synch_weights_time_ms": 9.528}, "counters": {"num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_agent_steps_sampled": 732000, "num_agent_steps_trained": 732000}, "done": false, "episodes_total": 2775, "training_iteration": 61, "trial_id": "9f288_00017", "date": "2023-10-25_16-58-51", "timestamp": 1698249531, "time_this_iter_s": 2.2292826175689697, "time_total_s": 139.06856536865234, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 139.06856536865234, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 60.96666666666666, "ram_util_percent": 27.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.673617379884038e-20, "cur_lr": 0.0003, "total_loss": 6.349175548553466, "policy_loss": -0.0004948062870729094, "vf_loss": 6.349717156092326, "vf_explained_var": -8.225440979003907e-07, "kl": 0.0012558781962506297, "entropy": 0.46876105268796286, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1845.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 744000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.4870000000002074, "episode_len_mean": 280.42, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.499999999999893, 41.90000000000001, 42.500000000000014, 45.5, 40.500000000000014, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 45.3, 47.3, 39.10000000000002, 46.3, 44.5, 36.70000000000003, 24.899999999999913, 17.299999999999805, -50.00000000000044, 37.10000000000003, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 45.9, -50.00000000000044, 23.29999999999989, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 38.10000000000002, 12.899999999999743, 44.7, -50.00000000000044, -50.00000000000044, 47.3, 46.9, -50.00000000000044, -50.00000000000044, 47.5, 47.5, -50.00000000000044, 41.70000000000002, -50.00000000000044, 44.900000000000006, 34.70000000000004, 46.3, -50.00000000000044, 45.3, 44.900000000000006, -50.00000000000044, -50.00000000000044, 35.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 46.5, -50.00000000000044, 47.5, 26.09999999999993, 45.3, -50.00000000000044, 45.7, 33.10000000000003, -50.00000000000044, -50.00000000000044, 32.700000000000024, -50.00000000000044, 46.3, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 22.099999999999874, 44.900000000000006, 11.899999999999729, -50.00000000000044, -50.00000000000044, 33.10000000000003, 43.10000000000001, 42.30000000000001, -50.00000000000044], "episode_lengths": [50, 500, 500, 500, 500, 266, 82, 76, 46, 96, 32, 500, 500, 500, 500, 500, 48, 48, 28, 110, 38, 56, 134, 252, 328, 500, 130, 500, 500, 46, 500, 500, 36, 500, 500, 500, 48, 500, 42, 500, 268, 46, 500, 500, 500, 70, 120, 372, 54, 500, 500, 28, 32, 500, 500, 26, 26, 500, 84, 500, 52, 154, 38, 500, 48, 52, 500, 500, 148, 500, 500, 500, 42, 36, 500, 26, 240, 48, 500, 44, 170, 500, 500, 174, 500, 38, 28, 500, 500, 500, 54, 280, 52, 382, 500, 500, 170, 70, 78, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37703520617283287, "mean_inference_ms": 1.205482084624772, "mean_action_processing_ms": 0.13964325071352107, "mean_env_wait_ms": 0.08409731994607235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023496150970458984, "StateBufferConnector_ms": 0.005026578903198242, "ViewRequirementAgentConnector_ms": 0.12100028991699219}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.4870000000002074, "episode_len_mean": 280.42, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.499999999999893, 41.90000000000001, 42.500000000000014, 45.5, 40.500000000000014, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 45.3, 47.3, 39.10000000000002, 46.3, 44.5, 36.70000000000003, 24.899999999999913, 17.299999999999805, -50.00000000000044, 37.10000000000003, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 45.9, -50.00000000000044, 23.29999999999989, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 38.10000000000002, 12.899999999999743, 44.7, -50.00000000000044, -50.00000000000044, 47.3, 46.9, -50.00000000000044, -50.00000000000044, 47.5, 47.5, -50.00000000000044, 41.70000000000002, -50.00000000000044, 44.900000000000006, 34.70000000000004, 46.3, -50.00000000000044, 45.3, 44.900000000000006, -50.00000000000044, -50.00000000000044, 35.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 46.5, -50.00000000000044, 47.5, 26.09999999999993, 45.3, -50.00000000000044, 45.7, 33.10000000000003, -50.00000000000044, -50.00000000000044, 32.700000000000024, -50.00000000000044, 46.3, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 22.099999999999874, 44.900000000000006, 11.899999999999729, -50.00000000000044, -50.00000000000044, 33.10000000000003, 43.10000000000001, 42.30000000000001, -50.00000000000044], "episode_lengths": [50, 500, 500, 500, 500, 266, 82, 76, 46, 96, 32, 500, 500, 500, 500, 500, 48, 48, 28, 110, 38, 56, 134, 252, 328, 500, 130, 500, 500, 46, 500, 500, 36, 500, 500, 500, 48, 500, 42, 500, 268, 46, 500, 500, 500, 70, 120, 372, 54, 500, 500, 28, 32, 500, 500, 26, 26, 500, 84, 500, 52, 154, 38, 500, 48, 52, 500, 500, 148, 500, 500, 500, 42, 36, 500, 26, 240, 48, 500, 44, 170, 500, 500, 174, 500, 38, 28, 500, 500, 500, 54, 280, 52, 382, 500, 500, 170, 70, 78, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37703520617283287, "mean_inference_ms": 1.205482084624772, "mean_action_processing_ms": 0.13964325071352107, "mean_env_wait_ms": 0.08409731994607235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023496150970458984, "StateBufferConnector_ms": 0.005026578903198242, "ViewRequirementAgentConnector_ms": 0.12100028991699219}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 744000, "num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5025.247020794037, "num_env_steps_trained_throughput_per_sec": 5025.247020794037, "timesteps_total": 744000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 744000, "timers": {"training_iteration_time_ms": 2306.066, "sample_time_ms": 1925.867, "load_time_ms": 13.103, "load_throughput": 915790.232, "learn_time_ms": 356.09, "learn_throughput": 33699.33, "synch_weights_time_ms": 9.429}, "counters": {"num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 744000}, "done": false, "episodes_total": 2821, "training_iteration": 62, "trial_id": "9f288_00017", "date": "2023-10-25_16-58-53", "timestamp": 1698249533, "time_this_iter_s": 2.392971992492676, "time_total_s": 141.46153736114502, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 141.46153736114502, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 60.9, "ram_util_percent": 27.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.336808689942019e-20, "cur_lr": 0.0003, "total_loss": 6.523437706629435, "policy_loss": -0.000304369255900383, "vf_loss": 6.523787752787272, "vf_explained_var": -7.867813110351562e-07, "kl": 0.000734594566188207, "entropy": 0.4566116541624069, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1875.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -2.148000000000219, "episode_len_mean": 292.02, "episode_media": {}, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.9, -50.00000000000044, 23.29999999999989, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 38.10000000000002, 12.899999999999743, 44.7, -50.00000000000044, -50.00000000000044, 47.3, 46.9, -50.00000000000044, -50.00000000000044, 47.5, 47.5, -50.00000000000044, 41.70000000000002, -50.00000000000044, 44.900000000000006, 34.70000000000004, 46.3, -50.00000000000044, 45.3, 44.900000000000006, -50.00000000000044, -50.00000000000044, 35.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 46.5, -50.00000000000044, 47.5, 26.09999999999993, 45.3, -50.00000000000044, 45.7, 33.10000000000003, -50.00000000000044, -50.00000000000044, 32.700000000000024, -50.00000000000044, 46.3, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 22.099999999999874, 44.900000000000006, 11.899999999999729, -50.00000000000044, -50.00000000000044, 33.10000000000003, 43.10000000000001, 42.30000000000001, -50.00000000000044, 19.09999999999983, -50.00000000000044, -50.00000000000044, 8.899999999999686, 8.899999999999686, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.299999999999933, 46.5, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 36.900000000000034, -50.00000000000044, 45.1, 46.699999999999996, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 43.30000000000001, 46.5, 32.50000000000002, 38.90000000000002, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 44.900000000000006, 46.5, -50.00000000000044, 42.70000000000001, -50.00000000000044, 22.299999999999876, -50.00000000000044, -50.00000000000044], "episode_lengths": [42, 500, 268, 46, 500, 500, 500, 70, 120, 372, 54, 500, 500, 28, 32, 500, 500, 26, 26, 500, 84, 500, 52, 154, 38, 500, 48, 52, 500, 500, 148, 500, 500, 500, 42, 36, 500, 26, 240, 48, 500, 44, 170, 500, 500, 174, 500, 38, 28, 500, 500, 500, 54, 280, 52, 382, 500, 500, 170, 70, 78, 500, 310, 500, 500, 412, 412, 500, 500, 500, 238, 36, 500, 500, 36, 500, 132, 500, 50, 34, 500, 76, 500, 500, 68, 36, 176, 112, 500, 42, 500, 500, 52, 36, 500, 74, 500, 278, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37717936849951145, "mean_inference_ms": 1.2060116312701497, "mean_action_processing_ms": 0.14023912504796904, "mean_env_wait_ms": 0.08426564218056228, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018483877182006836, "StateBufferConnector_ms": 0.007023334503173828, "ViewRequirementAgentConnector_ms": 0.11477160453796387}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -2.148000000000219, "episode_len_mean": 292.02, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.9, -50.00000000000044, 23.29999999999989, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 38.10000000000002, 12.899999999999743, 44.7, -50.00000000000044, -50.00000000000044, 47.3, 46.9, -50.00000000000044, -50.00000000000044, 47.5, 47.5, -50.00000000000044, 41.70000000000002, -50.00000000000044, 44.900000000000006, 34.70000000000004, 46.3, -50.00000000000044, 45.3, 44.900000000000006, -50.00000000000044, -50.00000000000044, 35.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 46.5, -50.00000000000044, 47.5, 26.09999999999993, 45.3, -50.00000000000044, 45.7, 33.10000000000003, -50.00000000000044, -50.00000000000044, 32.700000000000024, -50.00000000000044, 46.3, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 22.099999999999874, 44.900000000000006, 11.899999999999729, -50.00000000000044, -50.00000000000044, 33.10000000000003, 43.10000000000001, 42.30000000000001, -50.00000000000044, 19.09999999999983, -50.00000000000044, -50.00000000000044, 8.899999999999686, 8.899999999999686, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.299999999999933, 46.5, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 36.900000000000034, -50.00000000000044, 45.1, 46.699999999999996, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 43.30000000000001, 46.5, 32.50000000000002, 38.90000000000002, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 44.900000000000006, 46.5, -50.00000000000044, 42.70000000000001, -50.00000000000044, 22.299999999999876, -50.00000000000044, -50.00000000000044], "episode_lengths": [42, 500, 268, 46, 500, 500, 500, 70, 120, 372, 54, 500, 500, 28, 32, 500, 500, 26, 26, 500, 84, 500, 52, 154, 38, 500, 48, 52, 500, 500, 148, 500, 500, 500, 42, 36, 500, 26, 240, 48, 500, 44, 170, 500, 500, 174, 500, 38, 28, 500, 500, 500, 54, 280, 52, 382, 500, 500, 170, 70, 78, 500, 310, 500, 500, 412, 412, 500, 500, 500, 238, 36, 500, 500, 36, 500, 132, 500, 50, 34, 500, 76, 500, 500, 68, 36, 176, 112, 500, 42, 500, 500, 52, 36, 500, 74, 500, 278, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37717936849951145, "mean_inference_ms": 1.2060116312701497, "mean_action_processing_ms": 0.14023912504796904, "mean_env_wait_ms": 0.08426564218056228, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018483877182006836, "StateBufferConnector_ms": 0.007023334503173828, "ViewRequirementAgentConnector_ms": 0.11477160453796387}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000, "num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5102.480466391793, "num_env_steps_trained_throughput_per_sec": 5102.480466391793, "timesteps_total": 756000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 756000, "timers": {"training_iteration_time_ms": 2307.098, "sample_time_ms": 1946.523, "load_time_ms": 12.304, "load_throughput": 975321.247, "learn_time_ms": 337.325, "learn_throughput": 35573.971, "synch_weights_time_ms": 9.37}, "counters": {"num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000}, "done": false, "episodes_total": 2859, "training_iteration": 63, "trial_id": "9f288_00017", "date": "2023-10-25_16-58-56", "timestamp": 1698249536, "time_this_iter_s": 2.3567957878112793, "time_total_s": 143.8183331489563, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 143.8183331489563, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 54.366666666666674, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.1684043449710096e-20, "cur_lr": 0.0003, "total_loss": 6.204842805862427, "policy_loss": -0.0007556828359762828, "vf_loss": 6.205639489491781, "vf_explained_var": -1.1801719665527344e-06, "kl": 0.0007533929948976947, "entropy": 0.41048999726772306, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1905.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "sampler_results": {"episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.1550000000002143, "episode_len_mean": 287.1, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 32.700000000000024, -50.00000000000044, 46.3, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 22.099999999999874, 44.900000000000006, 11.899999999999729, -50.00000000000044, -50.00000000000044, 33.10000000000003, 43.10000000000001, 42.30000000000001, -50.00000000000044, 19.09999999999983, -50.00000000000044, -50.00000000000044, 8.899999999999686, 8.899999999999686, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.299999999999933, 46.5, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 36.900000000000034, -50.00000000000044, 45.1, 46.699999999999996, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 43.30000000000001, 46.5, 32.50000000000002, 38.90000000000002, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 44.900000000000006, 46.5, -50.00000000000044, 42.70000000000001, -50.00000000000044, 22.299999999999876, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.50000000000003, 44.300000000000004, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 43.7, 42.10000000000001, 43.30000000000001, 45.7, -50.00000000000044, -50.00000000000044, 44.10000000000001, 44.7, 45.9, -50.00000000000044, 46.099999999999994, -50.00000000000044, 43.10000000000001, -50.00000000000044, 41.100000000000016, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.10000000000002, -50.00000000000044, 45.1, 36.10000000000004, 36.50000000000003, 45.5, 30.29999999999999, 46.3, 47.3, -50.00000000000044, 2.299999999999592, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, 48.1], "episode_lengths": [500, 174, 500, 38, 28, 500, 500, 500, 54, 280, 52, 382, 500, 500, 170, 70, 78, 500, 310, 500, 500, 412, 412, 500, 500, 500, 238, 36, 500, 500, 36, 500, 132, 500, 50, 34, 500, 76, 500, 500, 68, 36, 176, 112, 500, 42, 500, 500, 52, 36, 500, 74, 500, 278, 500, 500, 500, 116, 58, 500, 500, 30, 500, 64, 80, 68, 44, 500, 500, 60, 54, 42, 500, 40, 500, 70, 500, 90, 500, 42, 500, 500, 500, 120, 500, 50, 140, 136, 46, 198, 38, 28, 500, 478, 68, 500, 500, 500, 94, 20]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37723522492047307, "mean_inference_ms": 1.2061745391601166, "mean_action_processing_ms": 0.14033875654444278, "mean_env_wait_ms": 0.0842968866569614, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015996932983398438, "StateBufferConnector_ms": 0.006998300552368164, "ViewRequirementAgentConnector_ms": 0.11911153793334961}}, "episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.1550000000002143, "episode_len_mean": 287.1, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 32.700000000000024, -50.00000000000044, 46.3, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 22.099999999999874, 44.900000000000006, 11.899999999999729, -50.00000000000044, -50.00000000000044, 33.10000000000003, 43.10000000000001, 42.30000000000001, -50.00000000000044, 19.09999999999983, -50.00000000000044, -50.00000000000044, 8.899999999999686, 8.899999999999686, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.299999999999933, 46.5, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 36.900000000000034, -50.00000000000044, 45.1, 46.699999999999996, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 43.30000000000001, 46.5, 32.50000000000002, 38.90000000000002, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 44.900000000000006, 46.5, -50.00000000000044, 42.70000000000001, -50.00000000000044, 22.299999999999876, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.50000000000003, 44.300000000000004, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 43.7, 42.10000000000001, 43.30000000000001, 45.7, -50.00000000000044, -50.00000000000044, 44.10000000000001, 44.7, 45.9, -50.00000000000044, 46.099999999999994, -50.00000000000044, 43.10000000000001, -50.00000000000044, 41.100000000000016, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.10000000000002, -50.00000000000044, 45.1, 36.10000000000004, 36.50000000000003, 45.5, 30.29999999999999, 46.3, 47.3, -50.00000000000044, 2.299999999999592, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, 48.1], "episode_lengths": [500, 174, 500, 38, 28, 500, 500, 500, 54, 280, 52, 382, 500, 500, 170, 70, 78, 500, 310, 500, 500, 412, 412, 500, 500, 500, 238, 36, 500, 500, 36, 500, 132, 500, 50, 34, 500, 76, 500, 500, 68, 36, 176, 112, 500, 42, 500, 500, 52, 36, 500, 74, 500, 278, 500, 500, 500, 116, 58, 500, 500, 30, 500, 64, 80, 68, 44, 500, 500, 60, 54, 42, 500, 40, 500, 70, 500, 90, 500, 42, 500, 500, 500, 120, 500, 50, 140, 136, 46, 198, 38, 28, 500, 478, 68, 500, 500, 500, 94, 20]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37723522492047307, "mean_inference_ms": 1.2061745391601166, "mean_action_processing_ms": 0.14033875654444278, "mean_env_wait_ms": 0.0842968866569614, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015996932983398438, "StateBufferConnector_ms": 0.006998300552368164, "ViewRequirementAgentConnector_ms": 0.11911153793334961}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000, "num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4586.325524958981, "num_env_steps_trained_throughput_per_sec": 4586.325524958981, "timesteps_total": 768000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 768000, "timers": {"training_iteration_time_ms": 2350.952, "sample_time_ms": 1974.749, "load_time_ms": 13.421, "load_throughput": 894139.483, "learn_time_ms": 351.863, "learn_throughput": 34104.226, "synch_weights_time_ms": 9.444}, "counters": {"num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "done": false, "episodes_total": 2903, "training_iteration": 64, "trial_id": "9f288_00017", "date": "2023-10-25_16-58-58", "timestamp": 1698249538, "time_this_iter_s": 2.621260643005371, "time_total_s": 146.43959379196167, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 146.43959379196167, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 51.02499999999999, "ram_util_percent": 27.175}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.0842021724855048e-20, "cur_lr": 0.0003, "total_loss": 6.214570776621501, "policy_loss": -0.0005346303805708885, "vf_loss": 6.21515170733134, "vf_explained_var": -9.57647959391276e-07, "kl": 0.0009614983009318697, "entropy": 0.4648330758015315, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1935.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_agent_steps_sampled": 780000, "num_agent_steps_trained": 780000}, "sampler_results": {"episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.2069999999998196, "episode_len_mean": 253.54, "episode_media": {}, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.70000000000001, -50.00000000000044, 22.299999999999876, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.50000000000003, 44.300000000000004, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 43.7, 42.10000000000001, 43.30000000000001, 45.7, -50.00000000000044, -50.00000000000044, 44.10000000000001, 44.7, 45.9, -50.00000000000044, 46.099999999999994, -50.00000000000044, 43.10000000000001, -50.00000000000044, 41.100000000000016, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.10000000000002, -50.00000000000044, 45.1, 36.10000000000004, 36.50000000000003, 45.5, 30.29999999999999, 46.3, 47.3, -50.00000000000044, 2.299999999999592, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, 48.1, 45.9, 43.10000000000001, -50.00000000000044, 41.30000000000001, 46.099999999999994, 32.30000000000002, 41.70000000000002, -50.00000000000044, 47.1, 43.30000000000001, 44.10000000000001, 23.099999999999888, 47.5, 47.5, 47.3, -50.00000000000044, 45.1, 25.29999999999992, -50.00000000000044, 44.10000000000001, 46.099999999999994, 42.10000000000001, 44.5, -50.00000000000044, -50.00000000000044, 41.70000000000002, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.699999999999996, -50.00000000000044, 38.50000000000003, 35.500000000000036, -50.00000000000044, 46.5, -50.00000000000044, 45.5, -50.00000000000044, 46.699999999999996, 17.499999999999808, 46.9, -50.00000000000044, 26.69999999999994, -50.00000000000044, 47.1, -50.00000000000044, 45.5, 23.499999999999893, -50.00000000000044], "episode_lengths": [74, 500, 278, 500, 500, 500, 116, 58, 500, 500, 30, 500, 64, 80, 68, 44, 500, 500, 60, 54, 42, 500, 40, 500, 70, 500, 90, 500, 42, 500, 500, 500, 120, 500, 50, 140, 136, 46, 198, 38, 28, 500, 478, 68, 500, 500, 500, 94, 20, 42, 70, 500, 88, 40, 178, 84, 500, 30, 68, 60, 270, 26, 26, 28, 500, 50, 248, 500, 60, 40, 80, 56, 500, 500, 84, 94, 500, 500, 500, 500, 194, 500, 116, 146, 500, 36, 500, 46, 500, 34, 326, 32, 500, 234, 500, 30, 500, 46, 266, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3767893038584154, "mean_inference_ms": 1.2052125774361833, "mean_action_processing_ms": 0.13995159976905988, "mean_env_wait_ms": 0.08397103580602272, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01701951026916504, "StateBufferConnector_ms": 0.005000114440917969, "ViewRequirementAgentConnector_ms": 0.11637735366821289}}, "episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.2069999999998196, "episode_len_mean": 253.54, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.70000000000001, -50.00000000000044, 22.299999999999876, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.50000000000003, 44.300000000000004, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 43.7, 42.10000000000001, 43.30000000000001, 45.7, -50.00000000000044, -50.00000000000044, 44.10000000000001, 44.7, 45.9, -50.00000000000044, 46.099999999999994, -50.00000000000044, 43.10000000000001, -50.00000000000044, 41.100000000000016, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.10000000000002, -50.00000000000044, 45.1, 36.10000000000004, 36.50000000000003, 45.5, 30.29999999999999, 46.3, 47.3, -50.00000000000044, 2.299999999999592, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, 48.1, 45.9, 43.10000000000001, -50.00000000000044, 41.30000000000001, 46.099999999999994, 32.30000000000002, 41.70000000000002, -50.00000000000044, 47.1, 43.30000000000001, 44.10000000000001, 23.099999999999888, 47.5, 47.5, 47.3, -50.00000000000044, 45.1, 25.29999999999992, -50.00000000000044, 44.10000000000001, 46.099999999999994, 42.10000000000001, 44.5, -50.00000000000044, -50.00000000000044, 41.70000000000002, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.699999999999996, -50.00000000000044, 38.50000000000003, 35.500000000000036, -50.00000000000044, 46.5, -50.00000000000044, 45.5, -50.00000000000044, 46.699999999999996, 17.499999999999808, 46.9, -50.00000000000044, 26.69999999999994, -50.00000000000044, 47.1, -50.00000000000044, 45.5, 23.499999999999893, -50.00000000000044], "episode_lengths": [74, 500, 278, 500, 500, 500, 116, 58, 500, 500, 30, 500, 64, 80, 68, 44, 500, 500, 60, 54, 42, 500, 40, 500, 70, 500, 90, 500, 42, 500, 500, 500, 120, 500, 50, 140, 136, 46, 198, 38, 28, 500, 478, 68, 500, 500, 500, 94, 20, 42, 70, 500, 88, 40, 178, 84, 500, 30, 68, 60, 270, 26, 26, 28, 500, 50, 248, 500, 60, 40, 80, 56, 500, 500, 84, 94, 500, 500, 500, 500, 194, 500, 116, 146, 500, 36, 500, 46, 500, 34, 326, 32, 500, 234, 500, 30, 500, 46, 266, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3767893038584154, "mean_inference_ms": 1.2052125774361833, "mean_action_processing_ms": 0.13995159976905988, "mean_env_wait_ms": 0.08397103580602272, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01701951026916504, "StateBufferConnector_ms": 0.005000114440917969, "ViewRequirementAgentConnector_ms": 0.11637735366821289}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 780000, "num_agent_steps_trained": 780000, "num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5412.879370410145, "num_env_steps_trained_throughput_per_sec": 5412.879370410145, "timesteps_total": 780000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 780000, "timers": {"training_iteration_time_ms": 2344.008, "sample_time_ms": 1977.715, "load_time_ms": 12.722, "load_throughput": 943269.757, "learn_time_ms": 342.619, "learn_throughput": 35024.375, "synch_weights_time_ms": 9.498}, "counters": {"num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_agent_steps_sampled": 780000, "num_agent_steps_trained": 780000}, "done": false, "episodes_total": 2954, "training_iteration": 65, "trial_id": "9f288_00017", "date": "2023-10-25_16-59-00", "timestamp": 1698249540, "time_this_iter_s": 2.2219316959381104, "time_total_s": 148.66152548789978, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 148.66152548789978, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 55.06666666666666, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.421010862427524e-21, "cur_lr": 0.0003, "total_loss": 6.442831516265869, "policy_loss": -0.00016441034773985544, "vf_loss": 6.443036413192749, "vf_explained_var": -1.0013580322265625e-06, "kl": 0.00033174805309196624, "entropy": 0.40448521574338275, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1965.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000}, "sampler_results": {"episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.352999999999819, "episode_len_mean": 252.08, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.70000000000002, 48.1, 45.9, 43.10000000000001, -50.00000000000044, 41.30000000000001, 46.099999999999994, 32.30000000000002, 41.70000000000002, -50.00000000000044, 47.1, 43.30000000000001, 44.10000000000001, 23.099999999999888, 47.5, 47.5, 47.3, -50.00000000000044, 45.1, 25.29999999999992, -50.00000000000044, 44.10000000000001, 46.099999999999994, 42.10000000000001, 44.5, -50.00000000000044, -50.00000000000044, 41.70000000000002, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.699999999999996, -50.00000000000044, 38.50000000000003, 35.500000000000036, -50.00000000000044, 46.5, -50.00000000000044, 45.5, -50.00000000000044, 46.699999999999996, 17.499999999999808, 46.9, -50.00000000000044, 26.69999999999994, -50.00000000000044, 47.1, -50.00000000000044, 45.5, 23.499999999999893, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 8.299999999999677, 38.700000000000024, 39.90000000000002, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 13.299999999999748, 37.90000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 45.1, 44.900000000000006, 46.9, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 45.7, -50.00000000000044, 45.9, -50.00000000000044, 47.7, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 47.1, 45.7, 46.3, 40.10000000000002, 42.500000000000014, 43.10000000000001, -50.00000000000044, 43.7, 32.700000000000024, 44.900000000000006], "episode_lengths": [94, 20, 42, 70, 500, 88, 40, 178, 84, 500, 30, 68, 60, 270, 26, 26, 28, 500, 50, 248, 500, 60, 40, 80, 56, 500, 500, 84, 94, 500, 500, 500, 500, 194, 500, 116, 146, 500, 36, 500, 46, 500, 34, 326, 32, 500, 234, 500, 30, 500, 46, 266, 500, 500, 66, 500, 418, 114, 102, 500, 70, 500, 500, 368, 122, 500, 500, 500, 500, 48, 50, 52, 32, 500, 500, 78, 500, 500, 500, 50, 44, 500, 42, 500, 24, 500, 500, 38, 500, 500, 30, 44, 38, 100, 76, 70, 500, 64, 174, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3770665892225998, "mean_inference_ms": 1.2058575656342656, "mean_action_processing_ms": 0.13995324862897374, "mean_env_wait_ms": 0.0840238814050783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015019893646240234, "StateBufferConnector_ms": 0.0049953460693359375, "ViewRequirementAgentConnector_ms": 0.11501073837280273}}, "episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.352999999999819, "episode_len_mean": 252.08, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [40.70000000000002, 48.1, 45.9, 43.10000000000001, -50.00000000000044, 41.30000000000001, 46.099999999999994, 32.30000000000002, 41.70000000000002, -50.00000000000044, 47.1, 43.30000000000001, 44.10000000000001, 23.099999999999888, 47.5, 47.5, 47.3, -50.00000000000044, 45.1, 25.29999999999992, -50.00000000000044, 44.10000000000001, 46.099999999999994, 42.10000000000001, 44.5, -50.00000000000044, -50.00000000000044, 41.70000000000002, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.699999999999996, -50.00000000000044, 38.50000000000003, 35.500000000000036, -50.00000000000044, 46.5, -50.00000000000044, 45.5, -50.00000000000044, 46.699999999999996, 17.499999999999808, 46.9, -50.00000000000044, 26.69999999999994, -50.00000000000044, 47.1, -50.00000000000044, 45.5, 23.499999999999893, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 8.299999999999677, 38.700000000000024, 39.90000000000002, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 13.299999999999748, 37.90000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 45.1, 44.900000000000006, 46.9, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 45.7, -50.00000000000044, 45.9, -50.00000000000044, 47.7, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 47.1, 45.7, 46.3, 40.10000000000002, 42.500000000000014, 43.10000000000001, -50.00000000000044, 43.7, 32.700000000000024, 44.900000000000006], "episode_lengths": [94, 20, 42, 70, 500, 88, 40, 178, 84, 500, 30, 68, 60, 270, 26, 26, 28, 500, 50, 248, 500, 60, 40, 80, 56, 500, 500, 84, 94, 500, 500, 500, 500, 194, 500, 116, 146, 500, 36, 500, 46, 500, 34, 326, 32, 500, 234, 500, 30, 500, 46, 266, 500, 500, 66, 500, 418, 114, 102, 500, 70, 500, 500, 368, 122, 500, 500, 500, 500, 48, 50, 52, 32, 500, 500, 78, 500, 500, 500, 50, 44, 500, 42, 500, 24, 500, 500, 38, 500, 500, 30, 44, 38, 100, 76, 70, 500, 64, 174, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3770665892225998, "mean_inference_ms": 1.2058575656342656, "mean_action_processing_ms": 0.13995324862897374, "mean_env_wait_ms": 0.0840238814050783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015019893646240234, "StateBufferConnector_ms": 0.0049953460693359375, "ViewRequirementAgentConnector_ms": 0.11501073837280273}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000, "num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5239.183646787532, "num_env_steps_trained_throughput_per_sec": 5239.183646787532, "timesteps_total": 792000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 792000, "timers": {"training_iteration_time_ms": 2348.893, "sample_time_ms": 1985.447, "load_time_ms": 12.499, "load_throughput": 960075.079, "learn_time_ms": 339.851, "learn_throughput": 35309.579, "synch_weights_time_ms": 9.542}, "counters": {"num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000}, "done": false, "episodes_total": 3001, "training_iteration": 66, "trial_id": "9f288_00017", "date": "2023-10-25_16-59-03", "timestamp": 1698249543, "time_this_iter_s": 2.295369863510132, "time_total_s": 150.9568953514099, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 150.9568953514099, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 58.699999999999996, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.710505431213762e-21, "cur_lr": 0.0003, "total_loss": 6.11179370880127, "policy_loss": -0.0005958261589209239, "vf_loss": 6.11242577234904, "vf_explained_var": -1.4583269755045572e-06, "kl": 0.000594237220074471, "entropy": 0.3614421854416529, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1995.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 804000, "num_env_steps_trained": 804000, "num_agent_steps_sampled": 804000, "num_agent_steps_trained": 804000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -3.82800000000023, "episode_len_mean": 298.8, "episode_media": {}, "episodes_this_iter": 34, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 38.50000000000003, 35.500000000000036, -50.00000000000044, 46.5, -50.00000000000044, 45.5, -50.00000000000044, 46.699999999999996, 17.499999999999808, 46.9, -50.00000000000044, 26.69999999999994, -50.00000000000044, 47.1, -50.00000000000044, 45.5, 23.499999999999893, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 8.299999999999677, 38.700000000000024, 39.90000000000002, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 13.299999999999748, 37.90000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 45.1, 44.900000000000006, 46.9, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 45.7, -50.00000000000044, 45.9, -50.00000000000044, 47.7, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 47.1, 45.7, 46.3, 40.10000000000002, 42.500000000000014, 43.10000000000001, -50.00000000000044, 43.7, 32.700000000000024, 44.900000000000006, -50.00000000000044, -50.00000000000044, 12.499999999999737, -50.00000000000044, -50.00000000000044, 6.099999999999646, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 28.09999999999996, -50.00000000000044, 42.70000000000001, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 40.90000000000002, 46.3, -50.00000000000044, 42.900000000000006, 1.4999999999995808, -50.00000000000044, 45.7, -50.00000000000044, 34.50000000000004, 47.7, -50.00000000000044], "episode_lengths": [500, 116, 146, 500, 36, 500, 46, 500, 34, 326, 32, 500, 234, 500, 30, 500, 46, 266, 500, 500, 66, 500, 418, 114, 102, 500, 70, 500, 500, 368, 122, 500, 500, 500, 500, 48, 50, 52, 32, 500, 500, 78, 500, 500, 500, 50, 44, 500, 42, 500, 24, 500, 500, 38, 500, 500, 30, 44, 38, 100, 76, 70, 500, 64, 174, 52, 500, 500, 376, 500, 500, 440, 500, 42, 500, 500, 50, 500, 500, 500, 500, 58, 220, 500, 74, 500, 30, 500, 500, 92, 38, 500, 72, 486, 500, 44, 500, 156, 24, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3776591617277779, "mean_inference_ms": 1.2071087611171922, "mean_action_processing_ms": 0.14022650578419726, "mean_env_wait_ms": 0.08434824664485017, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022537708282470703, "StateBufferConnector_ms": 0.0039975643157958984, "ViewRequirementAgentConnector_ms": 0.12500596046447754}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -3.82800000000023, "episode_len_mean": 298.8, "episodes_this_iter": 34, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 38.50000000000003, 35.500000000000036, -50.00000000000044, 46.5, -50.00000000000044, 45.5, -50.00000000000044, 46.699999999999996, 17.499999999999808, 46.9, -50.00000000000044, 26.69999999999994, -50.00000000000044, 47.1, -50.00000000000044, 45.5, 23.499999999999893, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 8.299999999999677, 38.700000000000024, 39.90000000000002, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 13.299999999999748, 37.90000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 45.1, 44.900000000000006, 46.9, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 45.7, -50.00000000000044, 45.9, -50.00000000000044, 47.7, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 47.1, 45.7, 46.3, 40.10000000000002, 42.500000000000014, 43.10000000000001, -50.00000000000044, 43.7, 32.700000000000024, 44.900000000000006, -50.00000000000044, -50.00000000000044, 12.499999999999737, -50.00000000000044, -50.00000000000044, 6.099999999999646, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 28.09999999999996, -50.00000000000044, 42.70000000000001, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 40.90000000000002, 46.3, -50.00000000000044, 42.900000000000006, 1.4999999999995808, -50.00000000000044, 45.7, -50.00000000000044, 34.50000000000004, 47.7, -50.00000000000044], "episode_lengths": [500, 116, 146, 500, 36, 500, 46, 500, 34, 326, 32, 500, 234, 500, 30, 500, 46, 266, 500, 500, 66, 500, 418, 114, 102, 500, 70, 500, 500, 368, 122, 500, 500, 500, 500, 48, 50, 52, 32, 500, 500, 78, 500, 500, 500, 50, 44, 500, 42, 500, 24, 500, 500, 38, 500, 500, 30, 44, 38, 100, 76, 70, 500, 64, 174, 52, 500, 500, 376, 500, 500, 440, 500, 42, 500, 500, 50, 500, 500, 500, 500, 58, 220, 500, 74, 500, 30, 500, 500, 92, 38, 500, 72, 486, 500, 44, 500, 156, 24, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3776591617277779, "mean_inference_ms": 1.2071087611171922, "mean_action_processing_ms": 0.14022650578419726, "mean_env_wait_ms": 0.08434824664485017, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022537708282470703, "StateBufferConnector_ms": 0.0039975643157958984, "ViewRequirementAgentConnector_ms": 0.12500596046447754}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 804000, "num_agent_steps_trained": 804000, "num_env_steps_sampled": 804000, "num_env_steps_trained": 804000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5321.2486900832, "num_env_steps_trained_throughput_per_sec": 5321.2486900832, "timesteps_total": 804000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 804000, "timers": {"training_iteration_time_ms": 2327.22, "sample_time_ms": 1965.617, "load_time_ms": 12.32, "load_throughput": 974018.911, "learn_time_ms": 338.247, "learn_throughput": 35477.039, "synch_weights_time_ms": 9.478}, "counters": {"num_env_steps_sampled": 804000, "num_env_steps_trained": 804000, "num_agent_steps_sampled": 804000, "num_agent_steps_trained": 804000}, "done": false, "episodes_total": 3035, "training_iteration": 67, "trial_id": "9f288_00017", "date": "2023-10-25_16-59-05", "timestamp": 1698249545, "time_this_iter_s": 2.2600886821746826, "time_total_s": 153.2169840335846, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 153.2169840335846, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 54.62499999999999, "ram_util_percent": 27.224999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.355252715606881e-21, "cur_lr": 0.0003, "total_loss": 6.133458852767944, "policy_loss": -0.000751942644516627, "vf_loss": 6.134250100453695, "vf_explained_var": -1.152356465657552e-06, "kl": 0.0007519116879649346, "entropy": 0.3918765693902969, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2025.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 816000, "num_env_steps_trained": 816000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "sampler_results": {"episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.5269999999997963, "episode_len_mean": 270.3, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.9, -50.00000000000044, 47.7, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 47.1, 45.7, 46.3, 40.10000000000002, 42.500000000000014, 43.10000000000001, -50.00000000000044, 43.7, 32.700000000000024, 44.900000000000006, -50.00000000000044, -50.00000000000044, 12.499999999999737, -50.00000000000044, -50.00000000000044, 6.099999999999646, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 28.09999999999996, -50.00000000000044, 42.70000000000001, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 40.90000000000002, 46.3, -50.00000000000044, 42.900000000000006, 1.4999999999995808, -50.00000000000044, 45.7, -50.00000000000044, 34.50000000000004, 47.7, -50.00000000000044, 45.1, 47.1, 19.09999999999983, -50.00000000000044, 10.899999999999714, -50.00000000000044, 48.1, 34.10000000000004, 46.699999999999996, 36.70000000000003, -50.00000000000044, 45.5, -50.00000000000044, 27.099999999999945, 28.09999999999996, 42.70000000000001, -50.00000000000044, 46.3, 45.7, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 46.5, -50.00000000000044, 47.3, 43.50000000000001, -50.00000000000044, -50.00000000000044, 45.9, 45.3, 45.5, 45.3, 43.900000000000006, 47.9, -50.00000000000044, -50.00000000000044, 46.099999999999994, 39.300000000000026, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 48.1, 47.3], "episode_lengths": [42, 500, 24, 500, 500, 38, 500, 500, 30, 44, 38, 100, 76, 70, 500, 64, 174, 52, 500, 500, 376, 500, 500, 440, 500, 42, 500, 500, 50, 500, 500, 500, 500, 58, 220, 500, 74, 500, 30, 500, 500, 92, 38, 500, 72, 486, 500, 44, 500, 156, 24, 500, 50, 30, 310, 500, 392, 500, 20, 160, 34, 134, 500, 46, 500, 230, 220, 74, 500, 38, 44, 500, 36, 500, 500, 500, 500, 76, 36, 500, 28, 66, 500, 500, 42, 48, 46, 48, 62, 22, 500, 500, 40, 108, 88, 500, 500, 500, 20, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3776757993171605, "mean_inference_ms": 1.2073624759358559, "mean_action_processing_ms": 0.1405241121425666, "mean_env_wait_ms": 0.08426253837568148, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025515317916870117, "StateBufferConnector_ms": 0.0039980411529541016, "ViewRequirementAgentConnector_ms": 0.11722946166992188}}, "episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.5269999999997963, "episode_len_mean": 270.3, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.9, -50.00000000000044, 47.7, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 47.1, 45.7, 46.3, 40.10000000000002, 42.500000000000014, 43.10000000000001, -50.00000000000044, 43.7, 32.700000000000024, 44.900000000000006, -50.00000000000044, -50.00000000000044, 12.499999999999737, -50.00000000000044, -50.00000000000044, 6.099999999999646, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 28.09999999999996, -50.00000000000044, 42.70000000000001, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 40.90000000000002, 46.3, -50.00000000000044, 42.900000000000006, 1.4999999999995808, -50.00000000000044, 45.7, -50.00000000000044, 34.50000000000004, 47.7, -50.00000000000044, 45.1, 47.1, 19.09999999999983, -50.00000000000044, 10.899999999999714, -50.00000000000044, 48.1, 34.10000000000004, 46.699999999999996, 36.70000000000003, -50.00000000000044, 45.5, -50.00000000000044, 27.099999999999945, 28.09999999999996, 42.70000000000001, -50.00000000000044, 46.3, 45.7, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 46.5, -50.00000000000044, 47.3, 43.50000000000001, -50.00000000000044, -50.00000000000044, 45.9, 45.3, 45.5, 45.3, 43.900000000000006, 47.9, -50.00000000000044, -50.00000000000044, 46.099999999999994, 39.300000000000026, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 48.1, 47.3], "episode_lengths": [42, 500, 24, 500, 500, 38, 500, 500, 30, 44, 38, 100, 76, 70, 500, 64, 174, 52, 500, 500, 376, 500, 500, 440, 500, 42, 500, 500, 50, 500, 500, 500, 500, 58, 220, 500, 74, 500, 30, 500, 500, 92, 38, 500, 72, 486, 500, 44, 500, 156, 24, 500, 50, 30, 310, 500, 392, 500, 20, 160, 34, 134, 500, 46, 500, 230, 220, 74, 500, 38, 44, 500, 36, 500, 500, 500, 500, 76, 36, 500, 28, 66, 500, 500, 42, 48, 46, 48, 62, 22, 500, 500, 40, 108, 88, 500, 500, 500, 20, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3776757993171605, "mean_inference_ms": 1.2073624759358559, "mean_action_processing_ms": 0.1405241121425666, "mean_env_wait_ms": 0.08426253837568148, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025515317916870117, "StateBufferConnector_ms": 0.0039980411529541016, "ViewRequirementAgentConnector_ms": 0.11722946166992188}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000, "num_env_steps_sampled": 816000, "num_env_steps_trained": 816000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5175.808530353997, "num_env_steps_trained_throughput_per_sec": 5175.808530353997, "timesteps_total": 816000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 816000, "timers": {"training_iteration_time_ms": 2331.937, "sample_time_ms": 1966.048, "load_time_ms": 11.85, "load_throughput": 1012637.903, "learn_time_ms": 343.07, "learn_throughput": 34978.298, "synch_weights_time_ms": 9.318}, "counters": {"num_env_steps_sampled": 816000, "num_env_steps_trained": 816000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "done": false, "episodes_total": 3083, "training_iteration": 68, "trial_id": "9f288_00017", "date": "2023-10-25_16-59-07", "timestamp": 1698249547, "time_this_iter_s": 2.3234760761260986, "time_total_s": 155.5404601097107, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 155.5404601097107, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 59.93333333333334, "ram_util_percent": 27.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.776263578034405e-22, "cur_lr": 0.0003, "total_loss": 6.435036245981852, "policy_loss": 9.716798861821493e-06, "vf_loss": 6.435068845748901, "vf_explained_var": -1.1801719665527344e-06, "kl": 0.00019655395678720803, "entropy": 0.4230634739001592, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2055.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 828000, "num_env_steps_trained": 828000, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000}, "sampler_results": {"episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.8189999999997896, "episode_len_mean": 277.38, "episode_media": {}, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [47.1, -50.00000000000044, -50.00000000000044, 40.90000000000002, 46.3, -50.00000000000044, 42.900000000000006, 1.4999999999995808, -50.00000000000044, 45.7, -50.00000000000044, 34.50000000000004, 47.7, -50.00000000000044, 45.1, 47.1, 19.09999999999983, -50.00000000000044, 10.899999999999714, -50.00000000000044, 48.1, 34.10000000000004, 46.699999999999996, 36.70000000000003, -50.00000000000044, 45.5, -50.00000000000044, 27.099999999999945, 28.09999999999996, 42.70000000000001, -50.00000000000044, 46.3, 45.7, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 46.5, -50.00000000000044, 47.3, 43.50000000000001, -50.00000000000044, -50.00000000000044, 45.9, 45.3, 45.5, 45.3, 43.900000000000006, 47.9, -50.00000000000044, -50.00000000000044, 46.099999999999994, 39.300000000000026, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 48.1, 47.3, 13.499999999999751, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 0.8999999999995723, 47.1, 30.29999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 47.5, 44.900000000000006, -50.00000000000044, 7.499999999999666, 40.90000000000002, 44.300000000000004, -50.00000000000044, 39.50000000000002, -50.00000000000044, 45.3, 46.3, 46.699999999999996, -50.00000000000044, -50.00000000000044, 41.100000000000016, 8.899999999999686, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001], "episode_lengths": [30, 500, 500, 92, 38, 500, 72, 486, 500, 44, 500, 156, 24, 500, 50, 30, 310, 500, 392, 500, 20, 160, 34, 134, 500, 46, 500, 230, 220, 74, 500, 38, 44, 500, 36, 500, 500, 500, 500, 76, 36, 500, 28, 66, 500, 500, 42, 48, 46, 48, 62, 22, 500, 500, 40, 108, 88, 500, 500, 500, 20, 28, 366, 500, 500, 500, 500, 44, 492, 30, 198, 500, 500, 500, 500, 72, 26, 52, 500, 426, 92, 58, 500, 106, 500, 48, 38, 34, 500, 500, 90, 412, 500, 500, 66, 500, 500, 500, 500, 70]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3771132532837791, "mean_inference_ms": 1.207121479891868, "mean_action_processing_ms": 0.14052310246830146, "mean_env_wait_ms": 0.08424414870589297, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03051018714904785, "StateBufferConnector_ms": 0.004998207092285156, "ViewRequirementAgentConnector_ms": 0.10823583602905273}}, "episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.8189999999997896, "episode_len_mean": 277.38, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [47.1, -50.00000000000044, -50.00000000000044, 40.90000000000002, 46.3, -50.00000000000044, 42.900000000000006, 1.4999999999995808, -50.00000000000044, 45.7, -50.00000000000044, 34.50000000000004, 47.7, -50.00000000000044, 45.1, 47.1, 19.09999999999983, -50.00000000000044, 10.899999999999714, -50.00000000000044, 48.1, 34.10000000000004, 46.699999999999996, 36.70000000000003, -50.00000000000044, 45.5, -50.00000000000044, 27.099999999999945, 28.09999999999996, 42.70000000000001, -50.00000000000044, 46.3, 45.7, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 46.5, -50.00000000000044, 47.3, 43.50000000000001, -50.00000000000044, -50.00000000000044, 45.9, 45.3, 45.5, 45.3, 43.900000000000006, 47.9, -50.00000000000044, -50.00000000000044, 46.099999999999994, 39.300000000000026, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 48.1, 47.3, 13.499999999999751, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 0.8999999999995723, 47.1, 30.29999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 47.5, 44.900000000000006, -50.00000000000044, 7.499999999999666, 40.90000000000002, 44.300000000000004, -50.00000000000044, 39.50000000000002, -50.00000000000044, 45.3, 46.3, 46.699999999999996, -50.00000000000044, -50.00000000000044, 41.100000000000016, 8.899999999999686, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001], "episode_lengths": [30, 500, 500, 92, 38, 500, 72, 486, 500, 44, 500, 156, 24, 500, 50, 30, 310, 500, 392, 500, 20, 160, 34, 134, 500, 46, 500, 230, 220, 74, 500, 38, 44, 500, 36, 500, 500, 500, 500, 76, 36, 500, 28, 66, 500, 500, 42, 48, 46, 48, 62, 22, 500, 500, 40, 108, 88, 500, 500, 500, 20, 28, 366, 500, 500, 500, 500, 44, 492, 30, 198, 500, 500, 500, 500, 72, 26, 52, 500, 426, 92, 58, 500, 106, 500, 48, 38, 34, 500, 500, 90, 412, 500, 500, 66, 500, 500, 500, 500, 70]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3771132532837791, "mean_inference_ms": 1.207121479891868, "mean_action_processing_ms": 0.14052310246830146, "mean_env_wait_ms": 0.08424414870589297, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03051018714904785, "StateBufferConnector_ms": 0.004998207092285156, "ViewRequirementAgentConnector_ms": 0.10823583602905273}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000, "num_env_steps_sampled": 828000, "num_env_steps_trained": 828000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5444.92588576675, "num_env_steps_trained_throughput_per_sec": 5444.92588576675, "timesteps_total": 828000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 828000, "timers": {"training_iteration_time_ms": 2325.425, "sample_time_ms": 1959.272, "load_time_ms": 11.832, "load_throughput": 1014168.23, "learn_time_ms": 343.43, "learn_throughput": 34941.587, "synch_weights_time_ms": 9.211}, "counters": {"num_env_steps_sampled": 828000, "num_env_steps_trained": 828000, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000}, "done": false, "episodes_total": 3121, "training_iteration": 69, "trial_id": "9f288_00017", "date": "2023-10-25_16-59-10", "timestamp": 1698249550, "time_this_iter_s": 2.207885265350342, "time_total_s": 157.74834537506104, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 157.74834537506104, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 58.0, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.3881317890172025e-22, "cur_lr": 0.0003, "total_loss": 6.710369491577149, "policy_loss": -0.0004329094042380651, "vf_loss": 6.710843960444133, "vf_explained_var": -9.934107462565105e-07, "kl": 0.0006905671389461077, "entropy": 0.4159795542558034, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2085.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 840000, "num_env_steps_trained": 840000, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000}, "sampler_results": {"episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.379000000000214, "episode_len_mean": 279.34, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.3, 45.5, 45.3, 43.900000000000006, 47.9, -50.00000000000044, -50.00000000000044, 46.099999999999994, 39.300000000000026, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 48.1, 47.3, 13.499999999999751, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 0.8999999999995723, 47.1, 30.29999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 47.5, 44.900000000000006, -50.00000000000044, 7.499999999999666, 40.90000000000002, 44.300000000000004, -50.00000000000044, 39.50000000000002, -50.00000000000044, 45.3, 46.3, 46.699999999999996, -50.00000000000044, -50.00000000000044, 41.100000000000016, 8.899999999999686, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 42.70000000000001, 32.90000000000003, 46.5, 22.699999999999882, 44.300000000000004, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 45.1, 47.5, -50.00000000000044, -50.00000000000044, 45.7, 46.699999999999996, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 45.9, 44.7, 47.3, 45.7, 43.7, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 2.0999999999995893, 38.50000000000003, 46.9, 32.90000000000003, 46.5, -50.00000000000044, -50.00000000000044, 41.90000000000001], "episode_lengths": [48, 46, 48, 62, 22, 500, 500, 40, 108, 88, 500, 500, 500, 20, 28, 366, 500, 500, 500, 500, 44, 492, 30, 198, 500, 500, 500, 500, 72, 26, 52, 500, 426, 92, 58, 500, 106, 500, 48, 38, 34, 500, 500, 90, 412, 500, 500, 66, 500, 500, 500, 500, 70, 500, 74, 172, 36, 274, 58, 500, 86, 500, 500, 500, 500, 500, 500, 500, 58, 50, 26, 500, 500, 44, 34, 500, 36, 500, 500, 500, 32, 42, 54, 28, 44, 64, 42, 500, 500, 500, 32, 500, 480, 116, 32, 172, 36, 500, 500, 82]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37755227359603116, "mean_inference_ms": 1.2074226843221394, "mean_action_processing_ms": 0.1404685828654538, "mean_env_wait_ms": 0.08429872614436786, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020996809005737305, "StateBufferConnector_ms": 0.004996776580810547, "ViewRequirementAgentConnector_ms": 0.11422848701477051}}, "episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.379000000000214, "episode_len_mean": 279.34, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.3, 45.5, 45.3, 43.900000000000006, 47.9, -50.00000000000044, -50.00000000000044, 46.099999999999994, 39.300000000000026, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 48.1, 47.3, 13.499999999999751, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 0.8999999999995723, 47.1, 30.29999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 47.5, 44.900000000000006, -50.00000000000044, 7.499999999999666, 40.90000000000002, 44.300000000000004, -50.00000000000044, 39.50000000000002, -50.00000000000044, 45.3, 46.3, 46.699999999999996, -50.00000000000044, -50.00000000000044, 41.100000000000016, 8.899999999999686, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 42.70000000000001, 32.90000000000003, 46.5, 22.699999999999882, 44.300000000000004, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 45.1, 47.5, -50.00000000000044, -50.00000000000044, 45.7, 46.699999999999996, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 45.9, 44.7, 47.3, 45.7, 43.7, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 2.0999999999995893, 38.50000000000003, 46.9, 32.90000000000003, 46.5, -50.00000000000044, -50.00000000000044, 41.90000000000001], "episode_lengths": [48, 46, 48, 62, 22, 500, 500, 40, 108, 88, 500, 500, 500, 20, 28, 366, 500, 500, 500, 500, 44, 492, 30, 198, 500, 500, 500, 500, 72, 26, 52, 500, 426, 92, 58, 500, 106, 500, 48, 38, 34, 500, 500, 90, 412, 500, 500, 66, 500, 500, 500, 500, 70, 500, 74, 172, 36, 274, 58, 500, 86, 500, 500, 500, 500, 500, 500, 500, 58, 50, 26, 500, 500, 44, 34, 500, 36, 500, 500, 500, 32, 42, 54, 28, 44, 64, 42, 500, 500, 500, 32, 500, 480, 116, 32, 172, 36, 500, 500, 82]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37755227359603116, "mean_inference_ms": 1.2074226843221394, "mean_action_processing_ms": 0.1404685828654538, "mean_env_wait_ms": 0.08429872614436786, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020996809005737305, "StateBufferConnector_ms": 0.004996776580810547, "ViewRequirementAgentConnector_ms": 0.11422848701477051}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000, "num_env_steps_sampled": 840000, "num_env_steps_trained": 840000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5140.3577073427605, "num_env_steps_trained_throughput_per_sec": 5140.3577073427605, "timesteps_total": 840000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 840000, "timers": {"training_iteration_time_ms": 2319.781, "sample_time_ms": 1956.191, "load_time_ms": 11.654, "load_throughput": 1029693.987, "learn_time_ms": 340.755, "learn_throughput": 35215.885, "synch_weights_time_ms": 9.302}, "counters": {"num_env_steps_sampled": 840000, "num_env_steps_trained": 840000, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000}, "done": false, "episodes_total": 3168, "training_iteration": 70, "trial_id": "9f288_00017", "date": "2023-10-25_16-59-12", "timestamp": 1698249552, "time_this_iter_s": 2.3394665718078613, "time_total_s": 160.0878119468689, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 160.0878119468689, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 57.63333333333333, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.6940658945086012e-22, "cur_lr": 0.0003, "total_loss": 6.596379804611206, "policy_loss": -0.00018331840013464292, "vf_loss": 6.596605491638184, "vf_explained_var": -8.980433146158854e-07, "kl": 0.00044738284575416285, "entropy": 0.4240386118491491, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2115.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 852000, "num_env_steps_trained": 852000, "num_agent_steps_sampled": 852000, "num_agent_steps_trained": 852000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.797999999999824, "episode_len_mean": 242.64, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.10000000000001, -50.00000000000044, 42.70000000000001, 32.90000000000003, 46.5, 22.699999999999882, 44.300000000000004, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 45.1, 47.5, -50.00000000000044, -50.00000000000044, 45.7, 46.699999999999996, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 45.9, 44.7, 47.3, 45.7, 43.7, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 2.0999999999995893, 38.50000000000003, 46.9, 32.90000000000003, 46.5, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 11.899999999999729, 47.1, -50.00000000000044, 45.5, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.69999999999984, -50.00000000000044, 32.90000000000003, 46.699999999999996, 45.7, 39.10000000000002, 44.10000000000001, 45.9, 45.3, 41.100000000000016, 46.9, 46.3, -50.00000000000044, 46.699999999999996, 43.900000000000006, 39.300000000000026, 28.499999999999964, 45.3, -50.00000000000044, 47.1, 47.3, -50.00000000000044, 45.7, 42.30000000000001, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 46.099999999999994, -50.00000000000044, 46.699999999999996, 47.1, 40.500000000000014, -50.00000000000044, -50.00000000000044, 44.900000000000006, 33.30000000000003, 46.699999999999996, 27.099999999999945], "episode_lengths": [70, 500, 74, 172, 36, 274, 58, 500, 86, 500, 500, 500, 500, 500, 500, 500, 58, 50, 26, 500, 500, 44, 34, 500, 36, 500, 500, 500, 32, 42, 54, 28, 44, 64, 42, 500, 500, 500, 32, 500, 480, 116, 32, 172, 36, 500, 500, 82, 500, 500, 36, 500, 382, 30, 500, 46, 76, 500, 500, 500, 304, 500, 172, 34, 44, 110, 60, 42, 48, 90, 32, 38, 500, 34, 62, 108, 216, 48, 500, 30, 28, 500, 44, 78, 68, 500, 500, 500, 46, 40, 500, 34, 30, 96, 500, 500, 52, 168, 34, 230]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3773133335822388, "mean_inference_ms": 1.2060201057136846, "mean_action_processing_ms": 0.14005418702453776, "mean_env_wait_ms": 0.08405511367353448, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021005868911743164, "StateBufferConnector_ms": 0.0039975643157958984, "ViewRequirementAgentConnector_ms": 0.12322306632995605}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.797999999999824, "episode_len_mean": 242.64, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.10000000000001, -50.00000000000044, 42.70000000000001, 32.90000000000003, 46.5, 22.699999999999882, 44.300000000000004, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 45.1, 47.5, -50.00000000000044, -50.00000000000044, 45.7, 46.699999999999996, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 45.9, 44.7, 47.3, 45.7, 43.7, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 2.0999999999995893, 38.50000000000003, 46.9, 32.90000000000003, 46.5, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 11.899999999999729, 47.1, -50.00000000000044, 45.5, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.69999999999984, -50.00000000000044, 32.90000000000003, 46.699999999999996, 45.7, 39.10000000000002, 44.10000000000001, 45.9, 45.3, 41.100000000000016, 46.9, 46.3, -50.00000000000044, 46.699999999999996, 43.900000000000006, 39.300000000000026, 28.499999999999964, 45.3, -50.00000000000044, 47.1, 47.3, -50.00000000000044, 45.7, 42.30000000000001, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 46.099999999999994, -50.00000000000044, 46.699999999999996, 47.1, 40.500000000000014, -50.00000000000044, -50.00000000000044, 44.900000000000006, 33.30000000000003, 46.699999999999996, 27.099999999999945], "episode_lengths": [70, 500, 74, 172, 36, 274, 58, 500, 86, 500, 500, 500, 500, 500, 500, 500, 58, 50, 26, 500, 500, 44, 34, 500, 36, 500, 500, 500, 32, 42, 54, 28, 44, 64, 42, 500, 500, 500, 32, 500, 480, 116, 32, 172, 36, 500, 500, 82, 500, 500, 36, 500, 382, 30, 500, 46, 76, 500, 500, 500, 304, 500, 172, 34, 44, 110, 60, 42, 48, 90, 32, 38, 500, 34, 62, 108, 216, 48, 500, 30, 28, 500, 44, 78, 68, 500, 500, 500, 46, 40, 500, 34, 30, 96, 500, 500, 52, 168, 34, 230]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3773133335822388, "mean_inference_ms": 1.2060201057136846, "mean_action_processing_ms": 0.14005418702453776, "mean_env_wait_ms": 0.08405511367353448, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021005868911743164, "StateBufferConnector_ms": 0.0039975643157958984, "ViewRequirementAgentConnector_ms": 0.12322306632995605}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 852000, "num_agent_steps_trained": 852000, "num_env_steps_sampled": 852000, "num_env_steps_trained": 852000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5420.994686026656, "num_env_steps_trained_throughput_per_sec": 5420.994686026656, "timesteps_total": 852000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 852000, "timers": {"training_iteration_time_ms": 2318.714, "sample_time_ms": 1954.587, "load_time_ms": 11.824, "load_throughput": 1014873.735, "learn_time_ms": 340.781, "learn_throughput": 35213.27, "synch_weights_time_ms": 9.743}, "counters": {"num_env_steps_sampled": 852000, "num_env_steps_trained": 852000, "num_agent_steps_sampled": 852000, "num_agent_steps_trained": 852000}, "done": false, "episodes_total": 3220, "training_iteration": 71, "trial_id": "9f288_00017", "date": "2023-10-25_16-59-14", "timestamp": 1698249554, "time_this_iter_s": 2.2186155319213867, "time_total_s": 162.30642747879028, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 162.30642747879028, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 50.625, "ram_util_percent": 27.224999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.470329472543006e-23, "cur_lr": 0.0003, "total_loss": 5.6081210772196455, "policy_loss": -0.0003936969364682833, "vf_loss": 5.608555285135905, "vf_explained_var": -1.1960665384928385e-06, "kl": 0.00046884818775699464, "entropy": 0.40660566786924995, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2145.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 864000, "num_env_steps_trained": 864000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.5909999999998092, "episode_len_mean": 259.68, "episode_media": {}, "episodes_this_iter": 36, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 2.0999999999995893, 38.50000000000003, 46.9, 32.90000000000003, 46.5, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 11.899999999999729, 47.1, -50.00000000000044, 45.5, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.69999999999984, -50.00000000000044, 32.90000000000003, 46.699999999999996, 45.7, 39.10000000000002, 44.10000000000001, 45.9, 45.3, 41.100000000000016, 46.9, 46.3, -50.00000000000044, 46.699999999999996, 43.900000000000006, 39.300000000000026, 28.499999999999964, 45.3, -50.00000000000044, 47.1, 47.3, -50.00000000000044, 45.7, 42.30000000000001, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 46.099999999999994, -50.00000000000044, 46.699999999999996, 47.1, 40.500000000000014, -50.00000000000044, -50.00000000000044, 44.900000000000006, 33.30000000000003, 46.699999999999996, 27.099999999999945, -50.00000000000044, 45.1, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.70000000000003, 47.3, -50.00000000000044, 45.9, 37.10000000000003, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 40.500000000000014, -50.00000000000044, 35.70000000000003, 46.3, 47.1, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, 47.5, 2.0999999999995893, -50.00000000000044, -50.00000000000044, 44.7], "episode_lengths": [500, 500, 32, 500, 480, 116, 32, 172, 36, 500, 500, 82, 500, 500, 36, 500, 382, 30, 500, 46, 76, 500, 500, 500, 304, 500, 172, 34, 44, 110, 60, 42, 48, 90, 32, 38, 500, 34, 62, 108, 216, 48, 500, 30, 28, 500, 44, 78, 68, 500, 500, 500, 46, 40, 500, 34, 30, 96, 500, 500, 52, 168, 34, 230, 500, 50, 52, 500, 500, 500, 124, 28, 500, 42, 130, 500, 28, 500, 500, 500, 500, 500, 62, 500, 96, 500, 144, 38, 30, 26, 500, 500, 500, 118, 500, 26, 480, 500, 500, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37738147799303073, "mean_inference_ms": 1.2061556457396179, "mean_action_processing_ms": 0.13993044911462896, "mean_env_wait_ms": 0.0839928558689673, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028995275497436523, "StateBufferConnector_ms": 0.0029985904693603516, "ViewRequirementAgentConnector_ms": 0.1202242374420166}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.5909999999998092, "episode_len_mean": 259.68, "episodes_this_iter": 36, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 2.0999999999995893, 38.50000000000003, 46.9, 32.90000000000003, 46.5, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 11.899999999999729, 47.1, -50.00000000000044, 45.5, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.69999999999984, -50.00000000000044, 32.90000000000003, 46.699999999999996, 45.7, 39.10000000000002, 44.10000000000001, 45.9, 45.3, 41.100000000000016, 46.9, 46.3, -50.00000000000044, 46.699999999999996, 43.900000000000006, 39.300000000000026, 28.499999999999964, 45.3, -50.00000000000044, 47.1, 47.3, -50.00000000000044, 45.7, 42.30000000000001, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 46.099999999999994, -50.00000000000044, 46.699999999999996, 47.1, 40.500000000000014, -50.00000000000044, -50.00000000000044, 44.900000000000006, 33.30000000000003, 46.699999999999996, 27.099999999999945, -50.00000000000044, 45.1, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.70000000000003, 47.3, -50.00000000000044, 45.9, 37.10000000000003, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 40.500000000000014, -50.00000000000044, 35.70000000000003, 46.3, 47.1, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, 47.5, 2.0999999999995893, -50.00000000000044, -50.00000000000044, 44.7], "episode_lengths": [500, 500, 32, 500, 480, 116, 32, 172, 36, 500, 500, 82, 500, 500, 36, 500, 382, 30, 500, 46, 76, 500, 500, 500, 304, 500, 172, 34, 44, 110, 60, 42, 48, 90, 32, 38, 500, 34, 62, 108, 216, 48, 500, 30, 28, 500, 44, 78, 68, 500, 500, 500, 46, 40, 500, 34, 30, 96, 500, 500, 52, 168, 34, 230, 500, 50, 52, 500, 500, 500, 124, 28, 500, 42, 130, 500, 28, 500, 500, 500, 500, 500, 62, 500, 96, 500, 144, 38, 30, 26, 500, 500, 500, 118, 500, 26, 480, 500, 500, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37738147799303073, "mean_inference_ms": 1.2061556457396179, "mean_action_processing_ms": 0.13993044911462896, "mean_env_wait_ms": 0.0839928558689673, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028995275497436523, "StateBufferConnector_ms": 0.0029985904693603516, "ViewRequirementAgentConnector_ms": 0.1202242374420166}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000, "num_env_steps_sampled": 864000, "num_env_steps_trained": 864000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5201.707402222368, "num_env_steps_trained_throughput_per_sec": 5201.707402222368, "timesteps_total": 864000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 864000, "timers": {"training_iteration_time_ms": 2310.614, "sample_time_ms": 1957.693, "load_time_ms": 11.823, "load_throughput": 1015004.719, "learn_time_ms": 329.554, "learn_throughput": 36412.806, "synch_weights_time_ms": 9.764}, "counters": {"num_env_steps_sampled": 864000, "num_env_steps_trained": 864000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "done": false, "episodes_total": 3256, "training_iteration": 72, "trial_id": "9f288_00017", "date": "2023-10-25_16-59-17", "timestamp": 1698249557, "time_this_iter_s": 2.3109328746795654, "time_total_s": 164.61736035346985, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 164.61736035346985, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 61.46666666666667, "ram_util_percent": 27.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.235164736271503e-23, "cur_lr": 0.0003, "total_loss": 6.105807701746623, "policy_loss": -0.0002064096430937449, "vf_loss": 6.106056753794352, "vf_explained_var": -8.245309193929037e-07, "kl": 0.0006441813316541811, "entropy": 0.42749493221441903, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2175.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 876000, "num_env_steps_trained": 876000, "num_agent_steps_sampled": 876000, "num_agent_steps_trained": 876000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.6100000000002122, "episode_len_mean": 276.64, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [47.3, -50.00000000000044, 45.7, 42.30000000000001, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 46.099999999999994, -50.00000000000044, 46.699999999999996, 47.1, 40.500000000000014, -50.00000000000044, -50.00000000000044, 44.900000000000006, 33.30000000000003, 46.699999999999996, 27.099999999999945, -50.00000000000044, 45.1, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.70000000000003, 47.3, -50.00000000000044, 45.9, 37.10000000000003, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 40.500000000000014, -50.00000000000044, 35.70000000000003, 46.3, 47.1, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, 47.5, 2.0999999999995893, -50.00000000000044, -50.00000000000044, 44.7, 45.9, 2.0999999999995893, -50.00000000000044, -50.00000000000044, 18.899999999999828, -50.00000000000044, -50.00000000000044, 46.5, 46.099999999999994, -50.00000000000044, 36.70000000000003, 45.5, 47.1, 47.5, 46.5, -50.00000000000044, 42.900000000000006, -50.00000000000044, 30.099999999999987, 44.5, 40.10000000000002, -50.00000000000044, 45.1, 44.5, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 40.90000000000002, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 44.7], "episode_lengths": [28, 500, 44, 78, 68, 500, 500, 500, 46, 40, 500, 34, 30, 96, 500, 500, 52, 168, 34, 230, 500, 50, 52, 500, 500, 500, 124, 28, 500, 42, 130, 500, 28, 500, 500, 500, 500, 500, 62, 500, 96, 500, 144, 38, 30, 26, 500, 500, 500, 118, 500, 26, 480, 500, 500, 54, 42, 480, 500, 500, 312, 500, 500, 36, 40, 500, 134, 46, 30, 26, 36, 500, 72, 500, 200, 56, 100, 500, 50, 56, 500, 66, 500, 500, 500, 500, 500, 42, 92, 68, 500, 500, 500, 38, 82, 500, 500, 500, 30, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3773738701376779, "mean_inference_ms": 1.206761639200954, "mean_action_processing_ms": 0.14021985380493898, "mean_env_wait_ms": 0.08413511214524722, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02398824691772461, "StateBufferConnector_ms": 0.00899958610534668, "ViewRequirementAgentConnector_ms": 0.11498856544494629}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.6100000000002122, "episode_len_mean": 276.64, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [47.3, -50.00000000000044, 45.7, 42.30000000000001, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 46.099999999999994, -50.00000000000044, 46.699999999999996, 47.1, 40.500000000000014, -50.00000000000044, -50.00000000000044, 44.900000000000006, 33.30000000000003, 46.699999999999996, 27.099999999999945, -50.00000000000044, 45.1, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.70000000000003, 47.3, -50.00000000000044, 45.9, 37.10000000000003, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 40.500000000000014, -50.00000000000044, 35.70000000000003, 46.3, 47.1, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, 47.5, 2.0999999999995893, -50.00000000000044, -50.00000000000044, 44.7, 45.9, 2.0999999999995893, -50.00000000000044, -50.00000000000044, 18.899999999999828, -50.00000000000044, -50.00000000000044, 46.5, 46.099999999999994, -50.00000000000044, 36.70000000000003, 45.5, 47.1, 47.5, 46.5, -50.00000000000044, 42.900000000000006, -50.00000000000044, 30.099999999999987, 44.5, 40.10000000000002, -50.00000000000044, 45.1, 44.5, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 40.90000000000002, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 44.7], "episode_lengths": [28, 500, 44, 78, 68, 500, 500, 500, 46, 40, 500, 34, 30, 96, 500, 500, 52, 168, 34, 230, 500, 50, 52, 500, 500, 500, 124, 28, 500, 42, 130, 500, 28, 500, 500, 500, 500, 500, 62, 500, 96, 500, 144, 38, 30, 26, 500, 500, 500, 118, 500, 26, 480, 500, 500, 54, 42, 480, 500, 500, 312, 500, 500, 36, 40, 500, 134, 46, 30, 26, 36, 500, 72, 500, 200, 56, 100, 500, 50, 56, 500, 66, 500, 500, 500, 500, 500, 42, 92, 68, 500, 500, 500, 38, 82, 500, 500, 500, 30, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3773738701376779, "mean_inference_ms": 1.206761639200954, "mean_action_processing_ms": 0.14021985380493898, "mean_env_wait_ms": 0.08413511214524722, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02398824691772461, "StateBufferConnector_ms": 0.00899958610534668, "ViewRequirementAgentConnector_ms": 0.11498856544494629}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 876000, "num_agent_steps_trained": 876000, "num_env_steps_sampled": 876000, "num_env_steps_trained": 876000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5522.548167101811, "num_env_steps_trained_throughput_per_sec": 5522.548167101811, "timesteps_total": 876000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 876000, "timers": {"training_iteration_time_ms": 2292.825, "sample_time_ms": 1936.83, "load_time_ms": 12.023, "load_throughput": 998126.922, "learn_time_ms": 332.269, "learn_throughput": 36115.371, "synch_weights_time_ms": 9.924}, "counters": {"num_env_steps_sampled": 876000, "num_env_steps_trained": 876000, "num_agent_steps_sampled": 876000, "num_agent_steps_trained": 876000}, "done": false, "episodes_total": 3300, "training_iteration": 73, "trial_id": "9f288_00017", "date": "2023-10-25_16-59-19", "timestamp": 1698249559, "time_this_iter_s": 2.177910089492798, "time_total_s": 166.79527044296265, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 166.79527044296265, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 59.56666666666666, "ram_util_percent": 27.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.1175823681357516e-23, "cur_lr": 0.0003, "total_loss": 6.975456698735555, "policy_loss": -0.0005278778572877248, "vf_loss": 6.976031875610351, "vf_explained_var": -1.1285146077473958e-06, "kl": 0.0006505762732844052, "entropy": 0.47274285058180493, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2205.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 888000, "num_env_steps_trained": 888000, "num_agent_steps_sampled": 888000, "num_agent_steps_trained": 888000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.321999999999817, "episode_len_mean": 257.38, "episode_media": {}, "episodes_this_iter": 54, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.7, 45.9, 2.0999999999995893, -50.00000000000044, -50.00000000000044, 18.899999999999828, -50.00000000000044, -50.00000000000044, 46.5, 46.099999999999994, -50.00000000000044, 36.70000000000003, 45.5, 47.1, 47.5, 46.5, -50.00000000000044, 42.900000000000006, -50.00000000000044, 30.099999999999987, 44.5, 40.10000000000002, -50.00000000000044, 45.1, 44.5, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 40.90000000000002, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 44.7, 44.10000000000001, 43.10000000000001, 44.900000000000006, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 23.499999999999893, 46.9, 47.3, 41.30000000000001, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 31.500000000000007, 44.10000000000001, 26.09999999999993, 45.5, 41.90000000000001, -50.00000000000044, 20.099999999999845, 44.10000000000001, 45.5, 35.500000000000036, 41.30000000000001, -50.00000000000044, 45.5, 31.500000000000007, 44.5, 26.299999999999933, -50.00000000000044, -50.00000000000044, 37.70000000000003, 33.30000000000003, -50.00000000000044, 45.5, -50.00000000000044, 41.70000000000002, 45.3, -50.00000000000044, 44.300000000000004, -50.00000000000044, 41.500000000000014, 33.70000000000004, 45.9, 45.9], "episode_lengths": [500, 54, 42, 480, 500, 500, 312, 500, 500, 36, 40, 500, 134, 46, 30, 26, 36, 500, 72, 500, 200, 56, 100, 500, 50, 56, 500, 66, 500, 500, 500, 500, 500, 42, 92, 68, 500, 500, 500, 38, 82, 500, 500, 500, 30, 54, 60, 70, 52, 500, 500, 56, 500, 500, 500, 80, 266, 32, 28, 88, 500, 40, 500, 500, 500, 500, 82, 500, 186, 60, 240, 46, 82, 500, 300, 60, 46, 146, 88, 500, 46, 186, 56, 238, 500, 500, 124, 168, 500, 46, 500, 84, 48, 500, 58, 500, 86, 164, 42, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37738262919447796, "mean_inference_ms": 1.20589955069316, "mean_action_processing_ms": 0.1404112382100874, "mean_env_wait_ms": 0.08411750355309605, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029996156692504883, "StateBufferConnector_ms": 0.009000778198242188, "ViewRequirementAgentConnector_ms": 0.1149740219116211}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.321999999999817, "episode_len_mean": 257.38, "episodes_this_iter": 54, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.7, 45.9, 2.0999999999995893, -50.00000000000044, -50.00000000000044, 18.899999999999828, -50.00000000000044, -50.00000000000044, 46.5, 46.099999999999994, -50.00000000000044, 36.70000000000003, 45.5, 47.1, 47.5, 46.5, -50.00000000000044, 42.900000000000006, -50.00000000000044, 30.099999999999987, 44.5, 40.10000000000002, -50.00000000000044, 45.1, 44.5, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 40.90000000000002, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 44.7, 44.10000000000001, 43.10000000000001, 44.900000000000006, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 23.499999999999893, 46.9, 47.3, 41.30000000000001, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 31.500000000000007, 44.10000000000001, 26.09999999999993, 45.5, 41.90000000000001, -50.00000000000044, 20.099999999999845, 44.10000000000001, 45.5, 35.500000000000036, 41.30000000000001, -50.00000000000044, 45.5, 31.500000000000007, 44.5, 26.299999999999933, -50.00000000000044, -50.00000000000044, 37.70000000000003, 33.30000000000003, -50.00000000000044, 45.5, -50.00000000000044, 41.70000000000002, 45.3, -50.00000000000044, 44.300000000000004, -50.00000000000044, 41.500000000000014, 33.70000000000004, 45.9, 45.9], "episode_lengths": [500, 54, 42, 480, 500, 500, 312, 500, 500, 36, 40, 500, 134, 46, 30, 26, 36, 500, 72, 500, 200, 56, 100, 500, 50, 56, 500, 66, 500, 500, 500, 500, 500, 42, 92, 68, 500, 500, 500, 38, 82, 500, 500, 500, 30, 54, 60, 70, 52, 500, 500, 56, 500, 500, 500, 80, 266, 32, 28, 88, 500, 40, 500, 500, 500, 500, 82, 500, 186, 60, 240, 46, 82, 500, 300, 60, 46, 146, 88, 500, 46, 186, 56, 238, 500, 500, 124, 168, 500, 46, 500, 84, 48, 500, 58, 500, 86, 164, 42, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37738262919447796, "mean_inference_ms": 1.20589955069316, "mean_action_processing_ms": 0.1404112382100874, "mean_env_wait_ms": 0.08411750355309605, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029996156692504883, "StateBufferConnector_ms": 0.009000778198242188, "ViewRequirementAgentConnector_ms": 0.1149740219116211}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 888000, "num_agent_steps_trained": 888000, "num_env_steps_sampled": 888000, "num_env_steps_trained": 888000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5114.598413012299, "num_env_steps_trained_throughput_per_sec": 5114.598413012299, "timesteps_total": 888000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 888000, "timers": {"training_iteration_time_ms": 2265.701, "sample_time_ms": 1904.774, "load_time_ms": 12.103, "load_throughput": 991455.755, "learn_time_ms": 337.115, "learn_throughput": 35596.214, "synch_weights_time_ms": 9.928}, "counters": {"num_env_steps_sampled": 888000, "num_env_steps_trained": 888000, "num_agent_steps_sampled": 888000, "num_agent_steps_trained": 888000}, "done": false, "episodes_total": 3354, "training_iteration": 74, "trial_id": "9f288_00017", "date": "2023-10-25_16-59-21", "timestamp": 1698249561, "time_this_iter_s": 2.351839303970337, "time_total_s": 169.14710974693298, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 169.14710974693298, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 58.76666666666667, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.0587911840678758e-23, "cur_lr": 0.0003, "total_loss": 6.634288422266642, "policy_loss": 2.9845245201916744e-05, "vf_loss": 6.634301535288492, "vf_explained_var": -8.205572764078777e-07, "kl": 0.00021568745534589578, "entropy": 0.42804238696893054, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2235.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 900000, "num_env_steps_trained": 900000, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.0839999999997993, "episode_len_mean": 279.74, "episode_media": {}, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 46.3, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 44.7, 44.10000000000001, 43.10000000000001, 44.900000000000006, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 23.499999999999893, 46.9, 47.3, 41.30000000000001, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 31.500000000000007, 44.10000000000001, 26.09999999999993, 45.5, 41.90000000000001, -50.00000000000044, 20.099999999999845, 44.10000000000001, 45.5, 35.500000000000036, 41.30000000000001, -50.00000000000044, 45.5, 31.500000000000007, 44.5, 26.299999999999933, -50.00000000000044, -50.00000000000044, 37.70000000000003, 33.30000000000003, -50.00000000000044, 45.5, -50.00000000000044, 41.70000000000002, 45.3, -50.00000000000044, 44.300000000000004, -50.00000000000044, 41.500000000000014, 33.70000000000004, 45.9, 45.9, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 43.30000000000001, 45.3, -50.00000000000044, -50.00000000000044, 37.50000000000003, 8.299999999999677, -50.00000000000044, -50.00000000000044, 14.499999999999766, 7.299999999999663, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 43.7, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.299999999999905, -50.00000000000044, 36.900000000000034, 5.099999999999632, -50.00000000000044, 37.90000000000003, 37.10000000000003, 43.7, 14.899999999999771, 46.3], "episode_lengths": [500, 500, 38, 82, 500, 500, 500, 30, 54, 60, 70, 52, 500, 500, 56, 500, 500, 500, 80, 266, 32, 28, 88, 500, 40, 500, 500, 500, 500, 82, 500, 186, 60, 240, 46, 82, 500, 300, 60, 46, 146, 88, 500, 46, 186, 56, 238, 500, 500, 124, 168, 500, 46, 500, 84, 48, 500, 58, 500, 86, 164, 42, 42, 500, 500, 82, 500, 68, 48, 500, 500, 126, 418, 500, 500, 356, 428, 500, 500, 500, 56, 64, 36, 500, 500, 500, 46, 500, 500, 500, 258, 500, 132, 450, 500, 122, 130, 64, 352, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37753242995854264, "mean_inference_ms": 1.205699298054985, "mean_action_processing_ms": 0.1401103457903298, "mean_env_wait_ms": 0.08410443231894044, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030991792678833008, "StateBufferConnector_ms": 0.009002685546875, "ViewRequirementAgentConnector_ms": 0.13698124885559082}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.0839999999997993, "episode_len_mean": 279.74, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 46.3, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 44.7, 44.10000000000001, 43.10000000000001, 44.900000000000006, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 23.499999999999893, 46.9, 47.3, 41.30000000000001, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 31.500000000000007, 44.10000000000001, 26.09999999999993, 45.5, 41.90000000000001, -50.00000000000044, 20.099999999999845, 44.10000000000001, 45.5, 35.500000000000036, 41.30000000000001, -50.00000000000044, 45.5, 31.500000000000007, 44.5, 26.299999999999933, -50.00000000000044, -50.00000000000044, 37.70000000000003, 33.30000000000003, -50.00000000000044, 45.5, -50.00000000000044, 41.70000000000002, 45.3, -50.00000000000044, 44.300000000000004, -50.00000000000044, 41.500000000000014, 33.70000000000004, 45.9, 45.9, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 43.30000000000001, 45.3, -50.00000000000044, -50.00000000000044, 37.50000000000003, 8.299999999999677, -50.00000000000044, -50.00000000000044, 14.499999999999766, 7.299999999999663, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 43.7, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.299999999999905, -50.00000000000044, 36.900000000000034, 5.099999999999632, -50.00000000000044, 37.90000000000003, 37.10000000000003, 43.7, 14.899999999999771, 46.3], "episode_lengths": [500, 500, 38, 82, 500, 500, 500, 30, 54, 60, 70, 52, 500, 500, 56, 500, 500, 500, 80, 266, 32, 28, 88, 500, 40, 500, 500, 500, 500, 82, 500, 186, 60, 240, 46, 82, 500, 300, 60, 46, 146, 88, 500, 46, 186, 56, 238, 500, 500, 124, 168, 500, 46, 500, 84, 48, 500, 58, 500, 86, 164, 42, 42, 500, 500, 82, 500, 68, 48, 500, 500, 126, 418, 500, 500, 356, 428, 500, 500, 500, 56, 64, 36, 500, 500, 500, 46, 500, 500, 500, 258, 500, 132, 450, 500, 122, 130, 64, 352, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37753242995854264, "mean_inference_ms": 1.205699298054985, "mean_action_processing_ms": 0.1401103457903298, "mean_env_wait_ms": 0.08410443231894044, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030991792678833008, "StateBufferConnector_ms": 0.009002685546875, "ViewRequirementAgentConnector_ms": 0.13698124885559082}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000, "num_env_steps_sampled": 900000, "num_env_steps_trained": 900000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5695.521484132104, "num_env_steps_trained_throughput_per_sec": 5695.521484132104, "timesteps_total": 900000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 900000, "timers": {"training_iteration_time_ms": 2254.699, "sample_time_ms": 1905.213, "load_time_ms": 11.805, "load_throughput": 1016560.692, "learn_time_ms": 326.01, "learn_throughput": 36808.696, "synch_weights_time_ms": 9.87}, "counters": {"num_env_steps_sampled": 900000, "num_env_steps_trained": 900000, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000}, "done": false, "episodes_total": 3391, "training_iteration": 75, "trial_id": "9f288_00017", "date": "2023-10-25_16-59-23", "timestamp": 1698249563, "time_this_iter_s": 2.1119182109832764, "time_total_s": 171.25902795791626, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 171.25902795791626, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 54.03333333333333, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.293955920339379e-24, "cur_lr": 0.0003, "total_loss": 5.96515843073527, "policy_loss": -0.0003891150156656901, "vf_loss": 5.965594736735026, "vf_explained_var": -9.020169576009114e-07, "kl": 0.0008044850490781149, "entropy": 0.47204386790593467, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2265.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 912000, "num_env_steps_trained": 912000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "sampler_results": {"episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.5169999999998094, "episode_len_mean": 270.44, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.5, 26.299999999999933, -50.00000000000044, -50.00000000000044, 37.70000000000003, 33.30000000000003, -50.00000000000044, 45.5, -50.00000000000044, 41.70000000000002, 45.3, -50.00000000000044, 44.300000000000004, -50.00000000000044, 41.500000000000014, 33.70000000000004, 45.9, 45.9, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 43.30000000000001, 45.3, -50.00000000000044, -50.00000000000044, 37.50000000000003, 8.299999999999677, -50.00000000000044, -50.00000000000044, 14.499999999999766, 7.299999999999663, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 43.7, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.299999999999905, -50.00000000000044, 36.900000000000034, 5.099999999999632, -50.00000000000044, 37.90000000000003, 37.10000000000003, 43.7, 14.899999999999771, 46.3, -50.00000000000044, 43.7, 46.3, -50.00000000000044, 17.899999999999814, -50.00000000000044, 34.900000000000034, 13.299999999999748, -50.00000000000044, 44.5, 45.3, 43.900000000000006, 42.70000000000001, -50.00000000000044, 22.899999999999885, 42.900000000000006, 44.900000000000006, -50.00000000000044, 46.099999999999994, 45.5, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 42.900000000000006, -50.00000000000044, 44.7, 40.30000000000002, 41.500000000000014, 45.7, 27.299999999999947, -50.00000000000044, 41.70000000000002, -50.00000000000044, 45.1, 35.10000000000004, 42.30000000000001, 45.3, 38.50000000000003, 35.70000000000003, -50.00000000000044, 45.9, -50.00000000000044, 41.100000000000016, -50.00000000000044], "episode_lengths": [56, 238, 500, 500, 124, 168, 500, 46, 500, 84, 48, 500, 58, 500, 86, 164, 42, 42, 500, 500, 82, 500, 68, 48, 500, 500, 126, 418, 500, 500, 356, 428, 500, 500, 500, 56, 64, 36, 500, 500, 500, 46, 500, 500, 500, 258, 500, 132, 450, 500, 122, 130, 64, 352, 38, 500, 64, 38, 500, 322, 500, 152, 368, 500, 56, 48, 62, 74, 500, 272, 72, 52, 500, 40, 46, 500, 500, 64, 500, 72, 500, 54, 98, 86, 44, 228, 500, 84, 500, 50, 150, 78, 48, 116, 144, 500, 42, 500, 90, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3775647861255319, "mean_inference_ms": 1.205392543529273, "mean_action_processing_ms": 0.14019455991935645, "mean_env_wait_ms": 0.08398034882185866, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026508808135986328, "StateBufferConnector_ms": 0.009015798568725586, "ViewRequirementAgentConnector_ms": 0.13153600692749023}}, "episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.5169999999998094, "episode_len_mean": 270.44, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.5, 26.299999999999933, -50.00000000000044, -50.00000000000044, 37.70000000000003, 33.30000000000003, -50.00000000000044, 45.5, -50.00000000000044, 41.70000000000002, 45.3, -50.00000000000044, 44.300000000000004, -50.00000000000044, 41.500000000000014, 33.70000000000004, 45.9, 45.9, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 43.30000000000001, 45.3, -50.00000000000044, -50.00000000000044, 37.50000000000003, 8.299999999999677, -50.00000000000044, -50.00000000000044, 14.499999999999766, 7.299999999999663, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 43.7, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.299999999999905, -50.00000000000044, 36.900000000000034, 5.099999999999632, -50.00000000000044, 37.90000000000003, 37.10000000000003, 43.7, 14.899999999999771, 46.3, -50.00000000000044, 43.7, 46.3, -50.00000000000044, 17.899999999999814, -50.00000000000044, 34.900000000000034, 13.299999999999748, -50.00000000000044, 44.5, 45.3, 43.900000000000006, 42.70000000000001, -50.00000000000044, 22.899999999999885, 42.900000000000006, 44.900000000000006, -50.00000000000044, 46.099999999999994, 45.5, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 42.900000000000006, -50.00000000000044, 44.7, 40.30000000000002, 41.500000000000014, 45.7, 27.299999999999947, -50.00000000000044, 41.70000000000002, -50.00000000000044, 45.1, 35.10000000000004, 42.30000000000001, 45.3, 38.50000000000003, 35.70000000000003, -50.00000000000044, 45.9, -50.00000000000044, 41.100000000000016, -50.00000000000044], "episode_lengths": [56, 238, 500, 500, 124, 168, 500, 46, 500, 84, 48, 500, 58, 500, 86, 164, 42, 42, 500, 500, 82, 500, 68, 48, 500, 500, 126, 418, 500, 500, 356, 428, 500, 500, 500, 56, 64, 36, 500, 500, 500, 46, 500, 500, 500, 258, 500, 132, 450, 500, 122, 130, 64, 352, 38, 500, 64, 38, 500, 322, 500, 152, 368, 500, 56, 48, 62, 74, 500, 272, 72, 52, 500, 40, 46, 500, 500, 64, 500, 72, 500, 54, 98, 86, 44, 228, 500, 84, 500, 50, 150, 78, 48, 116, 144, 500, 42, 500, 90, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3775647861255319, "mean_inference_ms": 1.205392543529273, "mean_action_processing_ms": 0.14019455991935645, "mean_env_wait_ms": 0.08398034882185866, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026508808135986328, "StateBufferConnector_ms": 0.009015798568725586, "ViewRequirementAgentConnector_ms": 0.13153600692749023}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000, "num_env_steps_sampled": 912000, "num_env_steps_trained": 912000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5400.979033555796, "num_env_steps_trained_throughput_per_sec": 5400.979033555796, "timesteps_total": 912000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 912000, "timers": {"training_iteration_time_ms": 2247.838, "sample_time_ms": 1902.058, "load_time_ms": 11.305, "load_throughput": 1061446.033, "learn_time_ms": 322.597, "learn_throughput": 37198.083, "synch_weights_time_ms": 10.073}, "counters": {"num_env_steps_sampled": 912000, "num_env_steps_trained": 912000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "done": false, "episodes_total": 3436, "training_iteration": 76, "trial_id": "9f288_00017", "date": "2023-10-25_16-59-26", "timestamp": 1698249566, "time_this_iter_s": 2.2278127670288086, "time_total_s": 173.48684072494507, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 173.48684072494507, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 59.6, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.6469779601696894e-24, "cur_lr": 0.0003, "total_loss": 6.403087759017945, "policy_loss": -0.0005213435118397077, "vf_loss": 6.4036610921223955, "vf_explained_var": -1.2795130411783853e-06, "kl": 0.001449472150488873, "entropy": 0.5198830882708232, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2295.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 924000, "num_env_steps_trained": 924000, "num_agent_steps_sampled": 924000, "num_agent_steps_trained": 924000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.727999999999835, "episode_len_mean": 243.38, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.099999999999632, -50.00000000000044, 37.90000000000003, 37.10000000000003, 43.7, 14.899999999999771, 46.3, -50.00000000000044, 43.7, 46.3, -50.00000000000044, 17.899999999999814, -50.00000000000044, 34.900000000000034, 13.299999999999748, -50.00000000000044, 44.5, 45.3, 43.900000000000006, 42.70000000000001, -50.00000000000044, 22.899999999999885, 42.900000000000006, 44.900000000000006, -50.00000000000044, 46.099999999999994, 45.5, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 42.900000000000006, -50.00000000000044, 44.7, 40.30000000000002, 41.500000000000014, 45.7, 27.299999999999947, -50.00000000000044, 41.70000000000002, -50.00000000000044, 45.1, 35.10000000000004, 42.30000000000001, 45.3, 38.50000000000003, 35.70000000000003, -50.00000000000044, 45.9, -50.00000000000044, 41.100000000000016, -50.00000000000044, 1.099999999999575, 42.900000000000006, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 42.10000000000001, 37.10000000000003, 45.5, 43.30000000000001, 45.7, 34.70000000000004, 40.500000000000014, -50.00000000000044, 44.10000000000001, 38.10000000000002, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 46.699999999999996, 46.699999999999996, 40.90000000000002, 45.9, 37.90000000000003, 21.699999999999868, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 11.699999999999726, 37.90000000000003, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.7, 44.300000000000004, 45.3, 43.30000000000001, -50.00000000000044, 45.5, -50.00000000000044, 46.099999999999994, -50.00000000000044], "episode_lengths": [450, 500, 122, 130, 64, 352, 38, 500, 64, 38, 500, 322, 500, 152, 368, 500, 56, 48, 62, 74, 500, 272, 72, 52, 500, 40, 46, 500, 500, 64, 500, 72, 500, 54, 98, 86, 44, 228, 500, 84, 500, 50, 150, 78, 48, 116, 144, 500, 42, 500, 90, 500, 490, 72, 42, 500, 500, 500, 62, 500, 80, 130, 46, 68, 44, 154, 96, 500, 60, 120, 500, 60, 500, 500, 34, 34, 92, 42, 122, 284, 500, 500, 500, 500, 52, 384, 122, 94, 500, 500, 500, 24, 58, 48, 68, 500, 46, 500, 40, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.377123049417287, "mean_inference_ms": 1.205190245459977, "mean_action_processing_ms": 0.14033230015359324, "mean_env_wait_ms": 0.08373675696620722, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019507408142089844, "StateBufferConnector_ms": 0.006014108657836914, "ViewRequirementAgentConnector_ms": 0.1305539608001709}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.727999999999835, "episode_len_mean": 243.38, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [5.099999999999632, -50.00000000000044, 37.90000000000003, 37.10000000000003, 43.7, 14.899999999999771, 46.3, -50.00000000000044, 43.7, 46.3, -50.00000000000044, 17.899999999999814, -50.00000000000044, 34.900000000000034, 13.299999999999748, -50.00000000000044, 44.5, 45.3, 43.900000000000006, 42.70000000000001, -50.00000000000044, 22.899999999999885, 42.900000000000006, 44.900000000000006, -50.00000000000044, 46.099999999999994, 45.5, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 42.900000000000006, -50.00000000000044, 44.7, 40.30000000000002, 41.500000000000014, 45.7, 27.299999999999947, -50.00000000000044, 41.70000000000002, -50.00000000000044, 45.1, 35.10000000000004, 42.30000000000001, 45.3, 38.50000000000003, 35.70000000000003, -50.00000000000044, 45.9, -50.00000000000044, 41.100000000000016, -50.00000000000044, 1.099999999999575, 42.900000000000006, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 42.10000000000001, 37.10000000000003, 45.5, 43.30000000000001, 45.7, 34.70000000000004, 40.500000000000014, -50.00000000000044, 44.10000000000001, 38.10000000000002, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 46.699999999999996, 46.699999999999996, 40.90000000000002, 45.9, 37.90000000000003, 21.699999999999868, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 11.699999999999726, 37.90000000000003, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.7, 44.300000000000004, 45.3, 43.30000000000001, -50.00000000000044, 45.5, -50.00000000000044, 46.099999999999994, -50.00000000000044], "episode_lengths": [450, 500, 122, 130, 64, 352, 38, 500, 64, 38, 500, 322, 500, 152, 368, 500, 56, 48, 62, 74, 500, 272, 72, 52, 500, 40, 46, 500, 500, 64, 500, 72, 500, 54, 98, 86, 44, 228, 500, 84, 500, 50, 150, 78, 48, 116, 144, 500, 42, 500, 90, 500, 490, 72, 42, 500, 500, 500, 62, 500, 80, 130, 46, 68, 44, 154, 96, 500, 60, 120, 500, 60, 500, 500, 34, 34, 92, 42, 122, 284, 500, 500, 500, 500, 52, 384, 122, 94, 500, 500, 500, 24, 58, 48, 68, 500, 46, 500, 40, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.377123049417287, "mean_inference_ms": 1.205190245459977, "mean_action_processing_ms": 0.14033230015359324, "mean_env_wait_ms": 0.08373675696620722, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019507408142089844, "StateBufferConnector_ms": 0.006014108657836914, "ViewRequirementAgentConnector_ms": 0.1305539608001709}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 924000, "num_agent_steps_trained": 924000, "num_env_steps_sampled": 924000, "num_env_steps_trained": 924000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5396.902538863021, "num_env_steps_trained_throughput_per_sec": 5396.902538863021, "timesteps_total": 924000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 924000, "timers": {"training_iteration_time_ms": 2244.676, "sample_time_ms": 1894.584, "load_time_ms": 12.452, "load_throughput": 963681.668, "learn_time_ms": 325.729, "learn_throughput": 36840.493, "synch_weights_time_ms": 10.01}, "counters": {"num_env_steps_sampled": 924000, "num_env_steps_trained": 924000, "num_agent_steps_sampled": 924000, "num_agent_steps_trained": 924000}, "done": false, "episodes_total": 3484, "training_iteration": 77, "trial_id": "9f288_00017", "date": "2023-10-25_16-59-28", "timestamp": 1698249568, "time_this_iter_s": 2.2332303524017334, "time_total_s": 175.7200710773468, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 175.7200710773468, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 51.35, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.3234889800848447e-24, "cur_lr": 0.0003, "total_loss": 6.565362612406413, "policy_loss": -0.0005483227471510569, "vf_loss": 6.565961662928263, "vf_explained_var": -9.218851725260417e-07, "kl": 0.0008427334482121295, "entropy": 0.5065819929043452, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2325.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 936000, "num_env_steps_trained": 936000, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.4029999999998086, "episode_len_mean": 271.56, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.1, 35.10000000000004, 42.30000000000001, 45.3, 38.50000000000003, 35.70000000000003, -50.00000000000044, 45.9, -50.00000000000044, 41.100000000000016, -50.00000000000044, 1.099999999999575, 42.900000000000006, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 42.10000000000001, 37.10000000000003, 45.5, 43.30000000000001, 45.7, 34.70000000000004, 40.500000000000014, -50.00000000000044, 44.10000000000001, 38.10000000000002, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 46.699999999999996, 46.699999999999996, 40.90000000000002, 45.9, 37.90000000000003, 21.699999999999868, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 11.699999999999726, 37.90000000000003, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.7, 44.300000000000004, 45.3, 43.30000000000001, -50.00000000000044, 45.5, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 12.099999999999731, 19.499999999999837, 44.5, -50.00000000000044, 34.10000000000004, -50.00000000000044, 44.5, 43.7, 33.30000000000003, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, 33.90000000000004, -50.00000000000044, 45.3, -50.00000000000044, 41.70000000000002, 41.30000000000001, 43.30000000000001, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 12.899999999999743, 39.70000000000002, -50.00000000000044, 31.300000000000004, 34.900000000000034], "episode_lengths": [500, 50, 150, 78, 48, 116, 144, 500, 42, 500, 90, 500, 490, 72, 42, 500, 500, 500, 62, 500, 80, 130, 46, 68, 44, 154, 96, 500, 60, 120, 500, 60, 500, 500, 34, 34, 92, 42, 122, 284, 500, 500, 500, 500, 52, 384, 122, 94, 500, 500, 500, 24, 58, 48, 68, 500, 46, 500, 40, 500, 500, 500, 500, 64, 380, 306, 56, 500, 160, 500, 56, 64, 168, 500, 500, 130, 500, 102, 500, 500, 162, 500, 48, 500, 84, 88, 68, 500, 64, 500, 500, 500, 500, 500, 54, 372, 104, 500, 188, 152]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3770690108743976, "mean_inference_ms": 1.204965440098134, "mean_action_processing_ms": 0.1401422636756541, "mean_env_wait_ms": 0.08363270712424795, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01600027084350586, "StateBufferConnector_ms": 0.008020162582397461, "ViewRequirementAgentConnector_ms": 0.1290450096130371}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.4029999999998086, "episode_len_mean": 271.56, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.1, 35.10000000000004, 42.30000000000001, 45.3, 38.50000000000003, 35.70000000000003, -50.00000000000044, 45.9, -50.00000000000044, 41.100000000000016, -50.00000000000044, 1.099999999999575, 42.900000000000006, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 42.10000000000001, 37.10000000000003, 45.5, 43.30000000000001, 45.7, 34.70000000000004, 40.500000000000014, -50.00000000000044, 44.10000000000001, 38.10000000000002, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 46.699999999999996, 46.699999999999996, 40.90000000000002, 45.9, 37.90000000000003, 21.699999999999868, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 11.699999999999726, 37.90000000000003, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.7, 44.300000000000004, 45.3, 43.30000000000001, -50.00000000000044, 45.5, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 12.099999999999731, 19.499999999999837, 44.5, -50.00000000000044, 34.10000000000004, -50.00000000000044, 44.5, 43.7, 33.30000000000003, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, 33.90000000000004, -50.00000000000044, 45.3, -50.00000000000044, 41.70000000000002, 41.30000000000001, 43.30000000000001, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 12.899999999999743, 39.70000000000002, -50.00000000000044, 31.300000000000004, 34.900000000000034], "episode_lengths": [500, 50, 150, 78, 48, 116, 144, 500, 42, 500, 90, 500, 490, 72, 42, 500, 500, 500, 62, 500, 80, 130, 46, 68, 44, 154, 96, 500, 60, 120, 500, 60, 500, 500, 34, 34, 92, 42, 122, 284, 500, 500, 500, 500, 52, 384, 122, 94, 500, 500, 500, 24, 58, 48, 68, 500, 46, 500, 40, 500, 500, 500, 500, 64, 380, 306, 56, 500, 160, 500, 56, 64, 168, 500, 500, 130, 500, 102, 500, 500, 162, 500, 48, 500, 84, 88, 68, 500, 64, 500, 500, 500, 500, 500, 54, 372, 104, 500, 188, 152]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3770690108743976, "mean_inference_ms": 1.204965440098134, "mean_action_processing_ms": 0.1401422636756541, "mean_env_wait_ms": 0.08363270712424795, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01600027084350586, "StateBufferConnector_ms": 0.008020162582397461, "ViewRequirementAgentConnector_ms": 0.1290450096130371}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000, "num_env_steps_sampled": 936000, "num_env_steps_trained": 936000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5346.515520214967, "num_env_steps_trained_throughput_per_sec": 5346.515520214967, "timesteps_total": 936000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 936000, "timers": {"training_iteration_time_ms": 2237.274, "sample_time_ms": 1896.652, "load_time_ms": 11.752, "load_throughput": 1021095.76, "learn_time_ms": 316.893, "learn_throughput": 37867.657, "synch_weights_time_ms": 10.069}, "counters": {"num_env_steps_sampled": 936000, "num_env_steps_trained": 936000, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000}, "done": false, "episodes_total": 3524, "training_iteration": 78, "trial_id": "9f288_00017", "date": "2023-10-25_16-59-30", "timestamp": 1698249570, "time_this_iter_s": 2.2494475841522217, "time_total_s": 177.96951866149902, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 177.96951866149902, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 59.93333333333334, "ram_util_percent": 27.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.617444900424224e-25, "cur_lr": 0.0003, "total_loss": 6.805252520243327, "policy_loss": -0.0004958288123210271, "vf_loss": 6.805801296234131, "vf_explained_var": -6.794929504394531e-07, "kl": 0.0005775133633522481, "entropy": 0.5300780852635701, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2355.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 948000, "num_env_steps_trained": 948000, "num_agent_steps_sampled": 948000, "num_agent_steps_trained": 948000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.924999999999813, "episode_len_mean": 266.36, "episode_media": {}, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [47.7, 44.300000000000004, 45.3, 43.30000000000001, -50.00000000000044, 45.5, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 12.099999999999731, 19.499999999999837, 44.5, -50.00000000000044, 34.10000000000004, -50.00000000000044, 44.5, 43.7, 33.30000000000003, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, 33.90000000000004, -50.00000000000044, 45.3, -50.00000000000044, 41.70000000000002, 41.30000000000001, 43.30000000000001, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 12.899999999999743, 39.70000000000002, -50.00000000000044, 31.300000000000004, 34.900000000000034, -50.00000000000044, 46.9, 37.50000000000003, 45.5, 40.90000000000002, 16.29999999999979, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, 10.499999999999709, 28.699999999999967, 43.50000000000001, 39.90000000000002, 44.5, 42.500000000000014, 42.70000000000001, -50.00000000000044, -50.00000000000044, 40.70000000000002, 33.500000000000036, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, 45.5, 44.10000000000001, 17.499999999999808, -50.00000000000044, 46.9, 43.30000000000001, -50.00000000000044, 45.1, 35.900000000000034, 46.5, 42.900000000000006, 16.09999999999979, 43.7, 46.5, 45.9, 46.3, -50.00000000000044, 46.5, -50.00000000000044, 8.299999999999677, 43.900000000000006, 45.7, -50.00000000000044, -50.00000000000044], "episode_lengths": [24, 58, 48, 68, 500, 46, 500, 40, 500, 500, 500, 500, 64, 380, 306, 56, 500, 160, 500, 56, 64, 168, 500, 500, 130, 500, 102, 500, 500, 162, 500, 48, 500, 84, 88, 68, 500, 64, 500, 500, 500, 500, 500, 54, 372, 104, 500, 188, 152, 500, 32, 126, 46, 92, 338, 500, 500, 500, 500, 94, 500, 396, 214, 66, 102, 56, 76, 74, 500, 500, 94, 166, 500, 500, 98, 500, 46, 60, 326, 500, 32, 68, 500, 50, 142, 36, 72, 340, 64, 36, 42, 38, 500, 36, 500, 418, 62, 44, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3772666557810407, "mean_inference_ms": 1.2054488558531287, "mean_action_processing_ms": 0.14031922354875978, "mean_env_wait_ms": 0.08389462312213386, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015096664428710938, "StateBufferConnector_ms": 0.009019851684570312, "ViewRequirementAgentConnector_ms": 0.11301970481872559}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.924999999999813, "episode_len_mean": 266.36, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [47.7, 44.300000000000004, 45.3, 43.30000000000001, -50.00000000000044, 45.5, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 12.099999999999731, 19.499999999999837, 44.5, -50.00000000000044, 34.10000000000004, -50.00000000000044, 44.5, 43.7, 33.30000000000003, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, 33.90000000000004, -50.00000000000044, 45.3, -50.00000000000044, 41.70000000000002, 41.30000000000001, 43.30000000000001, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 12.899999999999743, 39.70000000000002, -50.00000000000044, 31.300000000000004, 34.900000000000034, -50.00000000000044, 46.9, 37.50000000000003, 45.5, 40.90000000000002, 16.29999999999979, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, 10.499999999999709, 28.699999999999967, 43.50000000000001, 39.90000000000002, 44.5, 42.500000000000014, 42.70000000000001, -50.00000000000044, -50.00000000000044, 40.70000000000002, 33.500000000000036, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, 45.5, 44.10000000000001, 17.499999999999808, -50.00000000000044, 46.9, 43.30000000000001, -50.00000000000044, 45.1, 35.900000000000034, 46.5, 42.900000000000006, 16.09999999999979, 43.7, 46.5, 45.9, 46.3, -50.00000000000044, 46.5, -50.00000000000044, 8.299999999999677, 43.900000000000006, 45.7, -50.00000000000044, -50.00000000000044], "episode_lengths": [24, 58, 48, 68, 500, 46, 500, 40, 500, 500, 500, 500, 64, 380, 306, 56, 500, 160, 500, 56, 64, 168, 500, 500, 130, 500, 102, 500, 500, 162, 500, 48, 500, 84, 88, 68, 500, 64, 500, 500, 500, 500, 500, 54, 372, 104, 500, 188, 152, 500, 32, 126, 46, 92, 338, 500, 500, 500, 500, 94, 500, 396, 214, 66, 102, 56, 76, 74, 500, 500, 94, 166, 500, 500, 98, 500, 46, 60, 326, 500, 32, 68, 500, 50, 142, 36, 72, 340, 64, 36, 42, 38, 500, 36, 500, 418, 62, 44, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3772666557810407, "mean_inference_ms": 1.2054488558531287, "mean_action_processing_ms": 0.14031922354875978, "mean_env_wait_ms": 0.08389462312213386, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015096664428710938, "StateBufferConnector_ms": 0.009019851684570312, "ViewRequirementAgentConnector_ms": 0.11301970481872559}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 948000, "num_agent_steps_trained": 948000, "num_env_steps_sampled": 948000, "num_env_steps_trained": 948000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5268.601201302233, "num_env_steps_trained_throughput_per_sec": 5268.601201302233, "timesteps_total": 948000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 948000, "timers": {"training_iteration_time_ms": 2244.749, "sample_time_ms": 1896.556, "load_time_ms": 12.569, "load_throughput": 954697.42, "learn_time_ms": 323.649, "learn_throughput": 37077.185, "synch_weights_time_ms": 10.172}, "counters": {"num_env_steps_sampled": 948000, "num_env_steps_trained": 948000, "num_agent_steps_sampled": 948000, "num_agent_steps_trained": 948000}, "done": false, "episodes_total": 3575, "training_iteration": 79, "trial_id": "9f288_00017", "date": "2023-10-25_16-59-32", "timestamp": 1698249572, "time_this_iter_s": 2.2824761867523193, "time_total_s": 180.25199484825134, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 180.25199484825134, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 58.13333333333333, "ram_util_percent": 27.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.308722450212112e-25, "cur_lr": 0.0003, "total_loss": 6.933884890874227, "policy_loss": -0.00017400657137235006, "vf_loss": 6.934112215042115, "vf_explained_var": -1.0251998901367187e-06, "kl": 0.0008406524694995217, "entropy": 0.5335221777359644, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2385.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 960000, "num_env_steps_trained": 960000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.202999999999854, "episode_len_mean": 233.68, "episode_media": {}, "episodes_this_iter": 54, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.29999999999979, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, 10.499999999999709, 28.699999999999967, 43.50000000000001, 39.90000000000002, 44.5, 42.500000000000014, 42.70000000000001, -50.00000000000044, -50.00000000000044, 40.70000000000002, 33.500000000000036, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, 45.5, 44.10000000000001, 17.499999999999808, -50.00000000000044, 46.9, 43.30000000000001, -50.00000000000044, 45.1, 35.900000000000034, 46.5, 42.900000000000006, 16.09999999999979, 43.7, 46.5, 45.9, 46.3, -50.00000000000044, 46.5, -50.00000000000044, 8.299999999999677, 43.900000000000006, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002, 45.7, 41.30000000000001, 27.299999999999947, 33.70000000000004, 41.30000000000001, 45.3, 47.1, -50.00000000000044, 45.9, 43.30000000000001, -50.00000000000044, 45.7, -50.00000000000044, 42.900000000000006, 45.1, 42.500000000000014, 38.700000000000024, -50.00000000000044, 46.099999999999994, -50.00000000000044, 36.70000000000003, 40.30000000000002, 43.30000000000001, 43.50000000000001, -50.00000000000044, 42.30000000000001, 45.3, 41.30000000000001, -50.00000000000044, 27.699999999999953, 34.30000000000004, 29.299999999999976, 39.70000000000002, 33.70000000000004, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 42.10000000000001, 11.099999999999717, 45.9, 33.500000000000036, -50.00000000000044, 4.699999999999626, 11.29999999999972, 39.90000000000002, 39.300000000000026, -50.00000000000044, 46.3, 5.099999999999632, 36.900000000000034, 46.3], "episode_lengths": [338, 500, 500, 500, 500, 94, 500, 396, 214, 66, 102, 56, 76, 74, 500, 500, 94, 166, 500, 500, 98, 500, 46, 60, 326, 500, 32, 68, 500, 50, 142, 36, 72, 340, 64, 36, 42, 38, 500, 36, 500, 418, 62, 44, 500, 500, 500, 106, 44, 88, 228, 164, 88, 48, 30, 500, 42, 68, 500, 44, 500, 72, 50, 76, 114, 500, 40, 500, 134, 98, 68, 66, 500, 78, 48, 88, 500, 224, 158, 208, 104, 164, 500, 54, 500, 500, 80, 390, 42, 166, 500, 454, 388, 102, 108, 500, 38, 450, 132, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3768252671032732, "mean_inference_ms": 1.2046694989779123, "mean_action_processing_ms": 0.14020835241673177, "mean_env_wait_ms": 0.08374367043089365, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017093896865844727, "StateBufferConnector_ms": 0.0040013790130615234, "ViewRequirementAgentConnector_ms": 0.09707283973693848}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.202999999999854, "episode_len_mean": 233.68, "episodes_this_iter": 54, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [16.29999999999979, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, 10.499999999999709, 28.699999999999967, 43.50000000000001, 39.90000000000002, 44.5, 42.500000000000014, 42.70000000000001, -50.00000000000044, -50.00000000000044, 40.70000000000002, 33.500000000000036, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, 45.5, 44.10000000000001, 17.499999999999808, -50.00000000000044, 46.9, 43.30000000000001, -50.00000000000044, 45.1, 35.900000000000034, 46.5, 42.900000000000006, 16.09999999999979, 43.7, 46.5, 45.9, 46.3, -50.00000000000044, 46.5, -50.00000000000044, 8.299999999999677, 43.900000000000006, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002, 45.7, 41.30000000000001, 27.299999999999947, 33.70000000000004, 41.30000000000001, 45.3, 47.1, -50.00000000000044, 45.9, 43.30000000000001, -50.00000000000044, 45.7, -50.00000000000044, 42.900000000000006, 45.1, 42.500000000000014, 38.700000000000024, -50.00000000000044, 46.099999999999994, -50.00000000000044, 36.70000000000003, 40.30000000000002, 43.30000000000001, 43.50000000000001, -50.00000000000044, 42.30000000000001, 45.3, 41.30000000000001, -50.00000000000044, 27.699999999999953, 34.30000000000004, 29.299999999999976, 39.70000000000002, 33.70000000000004, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 42.10000000000001, 11.099999999999717, 45.9, 33.500000000000036, -50.00000000000044, 4.699999999999626, 11.29999999999972, 39.90000000000002, 39.300000000000026, -50.00000000000044, 46.3, 5.099999999999632, 36.900000000000034, 46.3], "episode_lengths": [338, 500, 500, 500, 500, 94, 500, 396, 214, 66, 102, 56, 76, 74, 500, 500, 94, 166, 500, 500, 98, 500, 46, 60, 326, 500, 32, 68, 500, 50, 142, 36, 72, 340, 64, 36, 42, 38, 500, 36, 500, 418, 62, 44, 500, 500, 500, 106, 44, 88, 228, 164, 88, 48, 30, 500, 42, 68, 500, 44, 500, 72, 50, 76, 114, 500, 40, 500, 134, 98, 68, 66, 500, 78, 48, 88, 500, 224, 158, 208, 104, 164, 500, 54, 500, 500, 80, 390, 42, 166, 500, 454, 388, 102, 108, 500, 38, 450, 132, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3768252671032732, "mean_inference_ms": 1.2046694989779123, "mean_action_processing_ms": 0.14020835241673177, "mean_env_wait_ms": 0.08374367043089365, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017093896865844727, "StateBufferConnector_ms": 0.0040013790130615234, "ViewRequirementAgentConnector_ms": 0.09707283973693848}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000, "num_env_steps_sampled": 960000, "num_env_steps_trained": 960000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5446.862740090238, "num_env_steps_trained_throughput_per_sec": 5446.862740090238, "timesteps_total": 960000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 960000, "timers": {"training_iteration_time_ms": 2231.549, "sample_time_ms": 1893.739, "load_time_ms": 11.8, "load_throughput": 1016932.452, "learn_time_ms": 314.091, "learn_throughput": 38205.544, "synch_weights_time_ms": 10.217}, "counters": {"num_env_steps_sampled": 960000, "num_env_steps_trained": 960000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "done": false, "episodes_total": 3629, "training_iteration": 80, "trial_id": "9f288_00017", "date": "2023-10-25_16-59-35", "timestamp": 1698249575, "time_this_iter_s": 2.208098888397217, "time_total_s": 182.46009373664856, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 182.46009373664856, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 58.833333333333336, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.654361225106056e-25, "cur_lr": 0.0003, "total_loss": 6.674061711629232, "policy_loss": -0.0007499465097983678, "vf_loss": 6.674865372975668, "vf_explained_var": -1.160303751627604e-06, "kl": 0.0013932345309086713, "entropy": 0.5377915134032567, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2415.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 972000, "num_env_steps_trained": 972000, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.014999999999829, "episode_len_mean": 255.5, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002, 45.7, 41.30000000000001, 27.299999999999947, 33.70000000000004, 41.30000000000001, 45.3, 47.1, -50.00000000000044, 45.9, 43.30000000000001, -50.00000000000044, 45.7, -50.00000000000044, 42.900000000000006, 45.1, 42.500000000000014, 38.700000000000024, -50.00000000000044, 46.099999999999994, -50.00000000000044, 36.70000000000003, 40.30000000000002, 43.30000000000001, 43.50000000000001, -50.00000000000044, 42.30000000000001, 45.3, 41.30000000000001, -50.00000000000044, 27.699999999999953, 34.30000000000004, 29.299999999999976, 39.70000000000002, 33.70000000000004, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 42.10000000000001, 11.099999999999717, 45.9, 33.500000000000036, -50.00000000000044, 4.699999999999626, 11.29999999999972, 39.90000000000002, 39.300000000000026, -50.00000000000044, 46.3, 5.099999999999632, 36.900000000000034, 46.3, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 35.500000000000036, 44.900000000000006, 33.90000000000004, 42.70000000000001, -50.00000000000044, -50.00000000000044, 45.7, 44.5, -50.00000000000044, 43.50000000000001, 46.3, -50.00000000000044, 30.9, -50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, 26.69999999999994, 1.6999999999995836, 43.50000000000001, 44.300000000000004, -50.00000000000044, 35.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 12.299999999999734, 40.90000000000002, 41.90000000000001, 41.70000000000002, 40.70000000000002, 44.10000000000001], "episode_lengths": [44, 500, 500, 500, 106, 44, 88, 228, 164, 88, 48, 30, 500, 42, 68, 500, 44, 500, 72, 50, 76, 114, 500, 40, 500, 134, 98, 68, 66, 500, 78, 48, 88, 500, 224, 158, 208, 104, 164, 500, 54, 500, 500, 80, 390, 42, 166, 500, 454, 388, 102, 108, 500, 38, 450, 132, 38, 500, 500, 54, 500, 500, 146, 52, 162, 74, 500, 500, 44, 56, 500, 66, 38, 500, 192, 500, 500, 102, 500, 234, 484, 66, 58, 500, 142, 500, 500, 500, 500, 500, 64, 500, 500, 500, 378, 92, 82, 84, 94, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37676249328210304, "mean_inference_ms": 1.2031858157207065, "mean_action_processing_ms": 0.1396634094284903, "mean_env_wait_ms": 0.08366114481030466, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01851344108581543, "StateBufferConnector_ms": 0.003996849060058594, "ViewRequirementAgentConnector_ms": 0.0830850601196289}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.014999999999829, "episode_len_mean": 255.5, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002, 45.7, 41.30000000000001, 27.299999999999947, 33.70000000000004, 41.30000000000001, 45.3, 47.1, -50.00000000000044, 45.9, 43.30000000000001, -50.00000000000044, 45.7, -50.00000000000044, 42.900000000000006, 45.1, 42.500000000000014, 38.700000000000024, -50.00000000000044, 46.099999999999994, -50.00000000000044, 36.70000000000003, 40.30000000000002, 43.30000000000001, 43.50000000000001, -50.00000000000044, 42.30000000000001, 45.3, 41.30000000000001, -50.00000000000044, 27.699999999999953, 34.30000000000004, 29.299999999999976, 39.70000000000002, 33.70000000000004, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 42.10000000000001, 11.099999999999717, 45.9, 33.500000000000036, -50.00000000000044, 4.699999999999626, 11.29999999999972, 39.90000000000002, 39.300000000000026, -50.00000000000044, 46.3, 5.099999999999632, 36.900000000000034, 46.3, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 35.500000000000036, 44.900000000000006, 33.90000000000004, 42.70000000000001, -50.00000000000044, -50.00000000000044, 45.7, 44.5, -50.00000000000044, 43.50000000000001, 46.3, -50.00000000000044, 30.9, -50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, 26.69999999999994, 1.6999999999995836, 43.50000000000001, 44.300000000000004, -50.00000000000044, 35.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 12.299999999999734, 40.90000000000002, 41.90000000000001, 41.70000000000002, 40.70000000000002, 44.10000000000001], "episode_lengths": [44, 500, 500, 500, 106, 44, 88, 228, 164, 88, 48, 30, 500, 42, 68, 500, 44, 500, 72, 50, 76, 114, 500, 40, 500, 134, 98, 68, 66, 500, 78, 48, 88, 500, 224, 158, 208, 104, 164, 500, 54, 500, 500, 80, 390, 42, 166, 500, 454, 388, 102, 108, 500, 38, 450, 132, 38, 500, 500, 54, 500, 500, 146, 52, 162, 74, 500, 500, 44, 56, 500, 66, 38, 500, 192, 500, 500, 102, 500, 234, 484, 66, 58, 500, 142, 500, 500, 500, 500, 500, 64, 500, 500, 500, 378, 92, 82, 84, 94, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37676249328210304, "mean_inference_ms": 1.2031858157207065, "mean_action_processing_ms": 0.1396634094284903, "mean_env_wait_ms": 0.08366114481030466, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01851344108581543, "StateBufferConnector_ms": 0.003996849060058594, "ViewRequirementAgentConnector_ms": 0.0830850601196289}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000, "num_env_steps_sampled": 972000, "num_env_steps_trained": 972000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5243.845195256252, "num_env_steps_trained_throughput_per_sec": 5243.845195256252, "timesteps_total": 972000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 972000, "timers": {"training_iteration_time_ms": 2239.028, "sample_time_ms": 1890.737, "load_time_ms": 12.602, "load_throughput": 952249.965, "learn_time_ms": 324.194, "learn_throughput": 37014.884, "synch_weights_time_ms": 9.692}, "counters": {"num_env_steps_sampled": 972000, "num_env_steps_trained": 972000, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000}, "done": false, "episodes_total": 3672, "training_iteration": 81, "trial_id": "9f288_00017", "date": "2023-10-25_16-59-37", "timestamp": 1698249577, "time_this_iter_s": 2.2930870056152344, "time_total_s": 184.7531807422638, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 184.7531807422638, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 58.199999999999996, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.27180612553028e-26, "cur_lr": 0.0003, "total_loss": 7.069554980595907, "policy_loss": -0.0008916246394316355, "vf_loss": 7.070501708984375, "vf_explained_var": -9.814898173014322e-07, "kl": 0.0014919829967993791, "entropy": 0.5511194348335267, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2445.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 984000, "num_env_steps_trained": 984000, "num_agent_steps_sampled": 984000, "num_agent_steps_trained": 984000}, "sampler_results": {"episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.538999999999826, "episode_len_mean": 270.3, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.099999999999717, 45.9, 33.500000000000036, -50.00000000000044, 4.699999999999626, 11.29999999999972, 39.90000000000002, 39.300000000000026, -50.00000000000044, 46.3, 5.099999999999632, 36.900000000000034, 46.3, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 35.500000000000036, 44.900000000000006, 33.90000000000004, 42.70000000000001, -50.00000000000044, -50.00000000000044, 45.7, 44.5, -50.00000000000044, 43.50000000000001, 46.3, -50.00000000000044, 30.9, -50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, 26.69999999999994, 1.6999999999995836, 43.50000000000001, 44.300000000000004, -50.00000000000044, 35.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 12.299999999999734, 40.90000000000002, 41.90000000000001, 41.70000000000002, 40.70000000000002, 44.10000000000001, -50.00000000000044, 20.899999999999856, 38.700000000000024, 42.500000000000014, -50.00000000000044, 11.899999999999729, 34.70000000000004, -50.00000000000044, 29.099999999999973, -50.00000000000044, 21.89999999999987, -50.00000000000044, 40.90000000000002, 38.90000000000002, 45.3, 44.300000000000004, -50.00000000000044, 45.3, 40.10000000000002, 14.299999999999763, 34.50000000000004, -50.00000000000044, -50.00000000000044, 1.6999999999995836, 13.299999999999748, 34.30000000000004, 27.899999999999956, 42.900000000000006, 42.900000000000006, 45.7, 42.500000000000014, -50.00000000000044, 41.30000000000001, 34.10000000000004, 17.899999999999814, 16.699999999999797, 27.099999999999945, 41.90000000000001, 42.10000000000001, 46.099999999999994, 28.499999999999964, 22.299999999999876, 19.09999999999983, 22.099999999999874], "episode_lengths": [390, 42, 166, 500, 454, 388, 102, 108, 500, 38, 450, 132, 38, 500, 500, 54, 500, 500, 146, 52, 162, 74, 500, 500, 44, 56, 500, 66, 38, 500, 192, 500, 500, 102, 500, 234, 484, 66, 58, 500, 142, 500, 500, 500, 500, 500, 64, 500, 500, 500, 378, 92, 82, 84, 94, 60, 500, 292, 114, 76, 500, 382, 154, 500, 210, 500, 282, 500, 92, 112, 48, 58, 500, 48, 100, 358, 156, 500, 500, 484, 368, 158, 222, 72, 72, 44, 76, 500, 88, 160, 322, 334, 230, 82, 80, 40, 216, 278, 310, 280]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3772966312031413, "mean_inference_ms": 1.2037163267749509, "mean_action_processing_ms": 0.13984552743069817, "mean_env_wait_ms": 0.08377175821199598, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01951742172241211, "StateBufferConnector_ms": 0.0049970149993896484, "ViewRequirementAgentConnector_ms": 0.09401345252990723}}, "episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.538999999999826, "episode_len_mean": 270.3, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [11.099999999999717, 45.9, 33.500000000000036, -50.00000000000044, 4.699999999999626, 11.29999999999972, 39.90000000000002, 39.300000000000026, -50.00000000000044, 46.3, 5.099999999999632, 36.900000000000034, 46.3, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 35.500000000000036, 44.900000000000006, 33.90000000000004, 42.70000000000001, -50.00000000000044, -50.00000000000044, 45.7, 44.5, -50.00000000000044, 43.50000000000001, 46.3, -50.00000000000044, 30.9, -50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, 26.69999999999994, 1.6999999999995836, 43.50000000000001, 44.300000000000004, -50.00000000000044, 35.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 12.299999999999734, 40.90000000000002, 41.90000000000001, 41.70000000000002, 40.70000000000002, 44.10000000000001, -50.00000000000044, 20.899999999999856, 38.700000000000024, 42.500000000000014, -50.00000000000044, 11.899999999999729, 34.70000000000004, -50.00000000000044, 29.099999999999973, -50.00000000000044, 21.89999999999987, -50.00000000000044, 40.90000000000002, 38.90000000000002, 45.3, 44.300000000000004, -50.00000000000044, 45.3, 40.10000000000002, 14.299999999999763, 34.50000000000004, -50.00000000000044, -50.00000000000044, 1.6999999999995836, 13.299999999999748, 34.30000000000004, 27.899999999999956, 42.900000000000006, 42.900000000000006, 45.7, 42.500000000000014, -50.00000000000044, 41.30000000000001, 34.10000000000004, 17.899999999999814, 16.699999999999797, 27.099999999999945, 41.90000000000001, 42.10000000000001, 46.099999999999994, 28.499999999999964, 22.299999999999876, 19.09999999999983, 22.099999999999874], "episode_lengths": [390, 42, 166, 500, 454, 388, 102, 108, 500, 38, 450, 132, 38, 500, 500, 54, 500, 500, 146, 52, 162, 74, 500, 500, 44, 56, 500, 66, 38, 500, 192, 500, 500, 102, 500, 234, 484, 66, 58, 500, 142, 500, 500, 500, 500, 500, 64, 500, 500, 500, 378, 92, 82, 84, 94, 60, 500, 292, 114, 76, 500, 382, 154, 500, 210, 500, 282, 500, 92, 112, 48, 58, 500, 48, 100, 358, 156, 500, 500, 484, 368, 158, 222, 72, 72, 44, 76, 500, 88, 160, 322, 334, 230, 82, 80, 40, 216, 278, 310, 280]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3772966312031413, "mean_inference_ms": 1.2037163267749509, "mean_action_processing_ms": 0.13984552743069817, "mean_env_wait_ms": 0.08377175821199598, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01951742172241211, "StateBufferConnector_ms": 0.0049970149993896484, "ViewRequirementAgentConnector_ms": 0.09401345252990723}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 984000, "num_agent_steps_trained": 984000, "num_env_steps_sampled": 984000, "num_env_steps_trained": 984000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5565.754029372241, "num_env_steps_trained_throughput_per_sec": 5565.754029372241, "timesteps_total": 984000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 984000, "timers": {"training_iteration_time_ms": 2223.938, "sample_time_ms": 1885.309, "load_time_ms": 11.802, "load_throughput": 1016813.295, "learn_time_ms": 315.429, "learn_throughput": 38043.444, "synch_weights_time_ms": 9.492}, "counters": {"num_env_steps_sampled": 984000, "num_env_steps_trained": 984000, "num_agent_steps_sampled": 984000, "num_agent_steps_trained": 984000}, "done": false, "episodes_total": 3716, "training_iteration": 82, "trial_id": "9f288_00017", "date": "2023-10-25_16-59-39", "timestamp": 1698249579, "time_this_iter_s": 2.161040782928467, "time_total_s": 186.91422152519226, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 186.91422152519226, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 54.199999999999996, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.13590306276514e-26, "cur_lr": 0.0003, "total_loss": 7.113298193613688, "policy_loss": -0.0008477292954921723, "vf_loss": 7.114204772313436, "vf_explained_var": -8.821487426757813e-07, "kl": 0.002071338751579788, "entropy": 0.5890912036101024, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2475.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 996000, "num_env_steps_trained": 996000, "num_agent_steps_sampled": 996000, "num_agent_steps_trained": 996000}, "sampler_results": {"episode_reward_max": 46.099999999999994, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.033999999999837, "episode_len_mean": 260.36, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 12.299999999999734, 40.90000000000002, 41.90000000000001, 41.70000000000002, 40.70000000000002, 44.10000000000001, -50.00000000000044, 20.899999999999856, 38.700000000000024, 42.500000000000014, -50.00000000000044, 11.899999999999729, 34.70000000000004, -50.00000000000044, 29.099999999999973, -50.00000000000044, 21.89999999999987, -50.00000000000044, 40.90000000000002, 38.90000000000002, 45.3, 44.300000000000004, -50.00000000000044, 45.3, 40.10000000000002, 14.299999999999763, 34.50000000000004, -50.00000000000044, -50.00000000000044, 1.6999999999995836, 13.299999999999748, 34.30000000000004, 27.899999999999956, 42.900000000000006, 42.900000000000006, 45.7, 42.500000000000014, -50.00000000000044, 41.30000000000001, 34.10000000000004, 17.899999999999814, 16.699999999999797, 27.099999999999945, 41.90000000000001, 42.10000000000001, 46.099999999999994, 28.499999999999964, 22.299999999999876, 19.09999999999983, 22.099999999999874, 4.299999999999621, -50.00000000000044, 41.500000000000014, 44.300000000000004, 39.10000000000002, 17.69999999999981, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, 35.70000000000003, 42.30000000000001, 36.10000000000004, 36.900000000000034, 41.100000000000016, 36.10000000000004, 45.1, 44.900000000000006, 40.70000000000002, 45.1, -50.00000000000044, 46.099999999999994, 38.90000000000002, -50.00000000000044, 43.30000000000001, 41.70000000000002, -50.00000000000044, 13.299999999999748, 45.9, -50.00000000000044, -50.00000000000044, 38.700000000000024, 30.099999999999987, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, 44.900000000000006, 44.5, -50.00000000000044, 33.90000000000004, -50.00000000000044, -50.00000000000044, 14.299999999999763, -50.00000000000044], "episode_lengths": [500, 500, 378, 92, 82, 84, 94, 60, 500, 292, 114, 76, 500, 382, 154, 500, 210, 500, 282, 500, 92, 112, 48, 58, 500, 48, 100, 358, 156, 500, 500, 484, 368, 158, 222, 72, 72, 44, 76, 500, 88, 160, 322, 334, 230, 82, 80, 40, 216, 278, 310, 280, 458, 500, 86, 58, 110, 324, 500, 500, 500, 84, 144, 78, 140, 132, 90, 140, 50, 52, 94, 50, 500, 40, 112, 500, 68, 84, 500, 368, 42, 500, 500, 114, 200, 500, 500, 500, 500, 102, 500, 500, 52, 56, 500, 162, 500, 500, 358, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.376901358025321, "mean_inference_ms": 1.2030760863359322, "mean_action_processing_ms": 0.13996240464241702, "mean_env_wait_ms": 0.0837013193107229, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02400660514831543, "StateBufferConnector_ms": 0.0029997825622558594, "ViewRequirementAgentConnector_ms": 0.11700272560119629}}, "episode_reward_max": 46.099999999999994, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.033999999999837, "episode_len_mean": 260.36, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 12.299999999999734, 40.90000000000002, 41.90000000000001, 41.70000000000002, 40.70000000000002, 44.10000000000001, -50.00000000000044, 20.899999999999856, 38.700000000000024, 42.500000000000014, -50.00000000000044, 11.899999999999729, 34.70000000000004, -50.00000000000044, 29.099999999999973, -50.00000000000044, 21.89999999999987, -50.00000000000044, 40.90000000000002, 38.90000000000002, 45.3, 44.300000000000004, -50.00000000000044, 45.3, 40.10000000000002, 14.299999999999763, 34.50000000000004, -50.00000000000044, -50.00000000000044, 1.6999999999995836, 13.299999999999748, 34.30000000000004, 27.899999999999956, 42.900000000000006, 42.900000000000006, 45.7, 42.500000000000014, -50.00000000000044, 41.30000000000001, 34.10000000000004, 17.899999999999814, 16.699999999999797, 27.099999999999945, 41.90000000000001, 42.10000000000001, 46.099999999999994, 28.499999999999964, 22.299999999999876, 19.09999999999983, 22.099999999999874, 4.299999999999621, -50.00000000000044, 41.500000000000014, 44.300000000000004, 39.10000000000002, 17.69999999999981, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, 35.70000000000003, 42.30000000000001, 36.10000000000004, 36.900000000000034, 41.100000000000016, 36.10000000000004, 45.1, 44.900000000000006, 40.70000000000002, 45.1, -50.00000000000044, 46.099999999999994, 38.90000000000002, -50.00000000000044, 43.30000000000001, 41.70000000000002, -50.00000000000044, 13.299999999999748, 45.9, -50.00000000000044, -50.00000000000044, 38.700000000000024, 30.099999999999987, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, 44.900000000000006, 44.5, -50.00000000000044, 33.90000000000004, -50.00000000000044, -50.00000000000044, 14.299999999999763, -50.00000000000044], "episode_lengths": [500, 500, 378, 92, 82, 84, 94, 60, 500, 292, 114, 76, 500, 382, 154, 500, 210, 500, 282, 500, 92, 112, 48, 58, 500, 48, 100, 358, 156, 500, 500, 484, 368, 158, 222, 72, 72, 44, 76, 500, 88, 160, 322, 334, 230, 82, 80, 40, 216, 278, 310, 280, 458, 500, 86, 58, 110, 324, 500, 500, 500, 84, 144, 78, 140, 132, 90, 140, 50, 52, 94, 50, 500, 40, 112, 500, 68, 84, 500, 368, 42, 500, 500, 114, 200, 500, 500, 500, 500, 102, 500, 500, 52, 56, 500, 162, 500, 500, 358, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.376901358025321, "mean_inference_ms": 1.2030760863359322, "mean_action_processing_ms": 0.13996240464241702, "mean_env_wait_ms": 0.0837013193107229, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02400660514831543, "StateBufferConnector_ms": 0.0029997825622558594, "ViewRequirementAgentConnector_ms": 0.11700272560119629}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 996000, "num_agent_steps_trained": 996000, "num_env_steps_sampled": 996000, "num_env_steps_trained": 996000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5257.191608906997, "num_env_steps_trained_throughput_per_sec": 5257.191608906997, "timesteps_total": 996000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 996000, "timers": {"training_iteration_time_ms": 2234.906, "sample_time_ms": 1885.692, "load_time_ms": 12.705, "load_throughput": 944494.657, "learn_time_ms": 325.157, "learn_throughput": 36905.254, "synch_weights_time_ms": 9.445}, "counters": {"num_env_steps_sampled": 996000, "num_env_steps_trained": 996000, "num_agent_steps_sampled": 996000, "num_agent_steps_trained": 996000}, "done": false, "episodes_total": 3764, "training_iteration": 83, "trial_id": "9f288_00017", "date": "2023-10-25_16-59-41", "timestamp": 1698249581, "time_this_iter_s": 2.287585496902466, "time_total_s": 189.20180702209473, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 189.20180702209473, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 50.9, "ram_util_percent": 27.224999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.06795153138257e-26, "cur_lr": 0.0003, "total_loss": 6.403968667984008, "policy_loss": -0.0008190105358759562, "vf_loss": 6.404842472076416, "vf_explained_var": -9.894371032714845e-07, "kl": 0.0016531488877584858, "entropy": 0.5477352162202199, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2505.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1008000, "num_env_steps_trained": 1008000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.924999999999828, "episode_len_mean": 266.4, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [34.10000000000004, 17.899999999999814, 16.699999999999797, 27.099999999999945, 41.90000000000001, 42.10000000000001, 46.099999999999994, 28.499999999999964, 22.299999999999876, 19.09999999999983, 22.099999999999874, 4.299999999999621, -50.00000000000044, 41.500000000000014, 44.300000000000004, 39.10000000000002, 17.69999999999981, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, 35.70000000000003, 42.30000000000001, 36.10000000000004, 36.900000000000034, 41.100000000000016, 36.10000000000004, 45.1, 44.900000000000006, 40.70000000000002, 45.1, -50.00000000000044, 46.099999999999994, 38.90000000000002, -50.00000000000044, 43.30000000000001, 41.70000000000002, -50.00000000000044, 13.299999999999748, 45.9, -50.00000000000044, -50.00000000000044, 38.700000000000024, 30.099999999999987, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, 44.900000000000006, 44.5, -50.00000000000044, 33.90000000000004, -50.00000000000044, -50.00000000000044, 14.299999999999763, -50.00000000000044, -50.00000000000044, 42.70000000000001, 24.899999999999913, 44.7, 39.10000000000002, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, 33.30000000000003, 46.099999999999994, -50.00000000000044, -50.00000000000044, 26.09999999999993, 44.300000000000004, 34.30000000000004, 32.100000000000016, -50.00000000000044, 43.7, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 40.70000000000002, 43.10000000000001, 26.499999999999936, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.300000000000026, -50.00000000000044, 20.299999999999848, 39.300000000000026, -50.00000000000044, 44.900000000000006, 46.9, 43.30000000000001, 36.50000000000003, 39.10000000000002], "episode_lengths": [160, 322, 334, 230, 82, 80, 40, 216, 278, 310, 280, 458, 500, 86, 58, 110, 324, 500, 500, 500, 84, 144, 78, 140, 132, 90, 140, 50, 52, 94, 50, 500, 40, 112, 500, 68, 84, 500, 368, 42, 500, 500, 114, 200, 500, 500, 500, 500, 102, 500, 500, 52, 56, 500, 162, 500, 500, 358, 500, 500, 74, 252, 54, 110, 500, 500, 98, 500, 168, 40, 500, 500, 240, 58, 158, 180, 500, 64, 54, 500, 500, 500, 78, 94, 70, 236, 500, 500, 500, 500, 128, 500, 298, 108, 500, 52, 32, 68, 136, 110]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3768996957681328, "mean_inference_ms": 1.2026980563754872, "mean_action_processing_ms": 0.13977108602799374, "mean_env_wait_ms": 0.08360276494901779, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02400040626525879, "StateBufferConnector_ms": 0.003998517990112305, "ViewRequirementAgentConnector_ms": 0.1099703311920166}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.924999999999828, "episode_len_mean": 266.4, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [34.10000000000004, 17.899999999999814, 16.699999999999797, 27.099999999999945, 41.90000000000001, 42.10000000000001, 46.099999999999994, 28.499999999999964, 22.299999999999876, 19.09999999999983, 22.099999999999874, 4.299999999999621, -50.00000000000044, 41.500000000000014, 44.300000000000004, 39.10000000000002, 17.69999999999981, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, 35.70000000000003, 42.30000000000001, 36.10000000000004, 36.900000000000034, 41.100000000000016, 36.10000000000004, 45.1, 44.900000000000006, 40.70000000000002, 45.1, -50.00000000000044, 46.099999999999994, 38.90000000000002, -50.00000000000044, 43.30000000000001, 41.70000000000002, -50.00000000000044, 13.299999999999748, 45.9, -50.00000000000044, -50.00000000000044, 38.700000000000024, 30.099999999999987, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, 44.900000000000006, 44.5, -50.00000000000044, 33.90000000000004, -50.00000000000044, -50.00000000000044, 14.299999999999763, -50.00000000000044, -50.00000000000044, 42.70000000000001, 24.899999999999913, 44.7, 39.10000000000002, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, 33.30000000000003, 46.099999999999994, -50.00000000000044, -50.00000000000044, 26.09999999999993, 44.300000000000004, 34.30000000000004, 32.100000000000016, -50.00000000000044, 43.7, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 40.70000000000002, 43.10000000000001, 26.499999999999936, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.300000000000026, -50.00000000000044, 20.299999999999848, 39.300000000000026, -50.00000000000044, 44.900000000000006, 46.9, 43.30000000000001, 36.50000000000003, 39.10000000000002], "episode_lengths": [160, 322, 334, 230, 82, 80, 40, 216, 278, 310, 280, 458, 500, 86, 58, 110, 324, 500, 500, 500, 84, 144, 78, 140, 132, 90, 140, 50, 52, 94, 50, 500, 40, 112, 500, 68, 84, 500, 368, 42, 500, 500, 114, 200, 500, 500, 500, 500, 102, 500, 500, 52, 56, 500, 162, 500, 500, 358, 500, 500, 74, 252, 54, 110, 500, 500, 98, 500, 168, 40, 500, 500, 240, 58, 158, 180, 500, 64, 54, 500, 500, 500, 78, 94, 70, 236, 500, 500, 500, 500, 128, 500, 298, 108, 500, 52, 32, 68, 136, 110]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3768996957681328, "mean_inference_ms": 1.2026980563754872, "mean_action_processing_ms": 0.13977108602799374, "mean_env_wait_ms": 0.08360276494901779, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02400040626525879, "StateBufferConnector_ms": 0.003998517990112305, "ViewRequirementAgentConnector_ms": 0.1099703311920166}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000, "num_env_steps_sampled": 1008000, "num_env_steps_trained": 1008000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5439.609130462694, "num_env_steps_trained_throughput_per_sec": 5439.609130462694, "timesteps_total": 1008000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1008000, "timers": {"training_iteration_time_ms": 2220.987, "sample_time_ms": 1887.21, "load_time_ms": 11.832, "load_throughput": 1014188.666, "learn_time_ms": 310.571, "learn_throughput": 38638.57, "synch_weights_time_ms": 9.469}, "counters": {"num_env_steps_sampled": 1008000, "num_env_steps_trained": 1008000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "done": false, "episodes_total": 3805, "training_iteration": 84, "trial_id": "9f288_00017", "date": "2023-10-25_16-59-44", "timestamp": 1698249584, "time_this_iter_s": 2.211879014968872, "time_total_s": 191.4136860370636, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 191.4136860370636, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 59.599999999999994, "ram_util_percent": 27.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.033975765691285e-26, "cur_lr": 0.0003, "total_loss": 6.299926376342773, "policy_loss": -2.349348117907842e-05, "vf_loss": 6.299998426437378, "vf_explained_var": -9.338061014811198e-07, "kl": 9.531675205730987e-05, "entropy": 0.48500022292137146, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2535.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1020000, "num_env_steps_trained": 1020000, "num_agent_steps_sampled": 1020000, "num_agent_steps_trained": 1020000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -2.309000000000209, "episode_len_mean": 298.64, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.9, -50.00000000000044, -50.00000000000044, 38.700000000000024, 30.099999999999987, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, 44.900000000000006, 44.5, -50.00000000000044, 33.90000000000004, -50.00000000000044, -50.00000000000044, 14.299999999999763, -50.00000000000044, -50.00000000000044, 42.70000000000001, 24.899999999999913, 44.7, 39.10000000000002, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, 33.30000000000003, 46.099999999999994, -50.00000000000044, -50.00000000000044, 26.09999999999993, 44.300000000000004, 34.30000000000004, 32.100000000000016, -50.00000000000044, 43.7, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 40.70000000000002, 43.10000000000001, 26.499999999999936, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.300000000000026, -50.00000000000044, 20.299999999999848, 39.300000000000026, -50.00000000000044, 44.900000000000006, 46.9, 43.30000000000001, 36.50000000000003, 39.10000000000002, -50.00000000000044, 31.900000000000013, 46.5, 45.5, 32.90000000000003, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 4.699999999999626, 28.499999999999964, 13.299999999999748, 45.1, -50.00000000000044, 45.1, 25.499999999999922, 42.10000000000001, 37.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 46.5, 47.1, 10.099999999999703, -50.00000000000044, -50.00000000000044, 34.30000000000004, 38.50000000000003, -50.00000000000044, -50.00000000000044, 35.900000000000034, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 28.499999999999964, -50.00000000000044], "episode_lengths": [42, 500, 500, 114, 200, 500, 500, 500, 500, 102, 500, 500, 52, 56, 500, 162, 500, 500, 358, 500, 500, 74, 252, 54, 110, 500, 500, 98, 500, 168, 40, 500, 500, 240, 58, 158, 180, 500, 64, 54, 500, 500, 500, 78, 94, 70, 236, 500, 500, 500, 500, 128, 500, 298, 108, 500, 52, 32, 68, 136, 110, 500, 182, 36, 46, 172, 90, 500, 500, 500, 500, 454, 216, 368, 50, 500, 50, 246, 80, 126, 500, 500, 500, 52, 36, 30, 400, 500, 500, 158, 116, 500, 500, 142, 500, 500, 52, 500, 216, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3767168766638522, "mean_inference_ms": 1.203185726322888, "mean_action_processing_ms": 0.13985875246430976, "mean_env_wait_ms": 0.0839721445293768, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01599740982055664, "StateBufferConnector_ms": 0.0039975643157958984, "ViewRequirementAgentConnector_ms": 0.12096810340881348}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -2.309000000000209, "episode_len_mean": 298.64, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.9, -50.00000000000044, -50.00000000000044, 38.700000000000024, 30.099999999999987, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, 44.900000000000006, 44.5, -50.00000000000044, 33.90000000000004, -50.00000000000044, -50.00000000000044, 14.299999999999763, -50.00000000000044, -50.00000000000044, 42.70000000000001, 24.899999999999913, 44.7, 39.10000000000002, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, 33.30000000000003, 46.099999999999994, -50.00000000000044, -50.00000000000044, 26.09999999999993, 44.300000000000004, 34.30000000000004, 32.100000000000016, -50.00000000000044, 43.7, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 40.70000000000002, 43.10000000000001, 26.499999999999936, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.300000000000026, -50.00000000000044, 20.299999999999848, 39.300000000000026, -50.00000000000044, 44.900000000000006, 46.9, 43.30000000000001, 36.50000000000003, 39.10000000000002, -50.00000000000044, 31.900000000000013, 46.5, 45.5, 32.90000000000003, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 4.699999999999626, 28.499999999999964, 13.299999999999748, 45.1, -50.00000000000044, 45.1, 25.499999999999922, 42.10000000000001, 37.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 46.5, 47.1, 10.099999999999703, -50.00000000000044, -50.00000000000044, 34.30000000000004, 38.50000000000003, -50.00000000000044, -50.00000000000044, 35.900000000000034, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 28.499999999999964, -50.00000000000044], "episode_lengths": [42, 500, 500, 114, 200, 500, 500, 500, 500, 102, 500, 500, 52, 56, 500, 162, 500, 500, 358, 500, 500, 74, 252, 54, 110, 500, 500, 98, 500, 168, 40, 500, 500, 240, 58, 158, 180, 500, 64, 54, 500, 500, 500, 78, 94, 70, 236, 500, 500, 500, 500, 128, 500, 298, 108, 500, 52, 32, 68, 136, 110, 500, 182, 36, 46, 172, 90, 500, 500, 500, 500, 454, 216, 368, 50, 500, 50, 246, 80, 126, 500, 500, 500, 52, 36, 30, 400, 500, 500, 158, 116, 500, 500, 142, 500, 500, 52, 500, 216, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3767168766638522, "mean_inference_ms": 1.203185726322888, "mean_action_processing_ms": 0.13985875246430976, "mean_env_wait_ms": 0.0839721445293768, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01599740982055664, "StateBufferConnector_ms": 0.0039975643157958984, "ViewRequirementAgentConnector_ms": 0.12096810340881348}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1020000, "num_agent_steps_trained": 1020000, "num_env_steps_sampled": 1020000, "num_env_steps_trained": 1020000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5299.993502903002, "num_env_steps_trained_throughput_per_sec": 5299.993502903002, "timesteps_total": 1020000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1020000, "timers": {"training_iteration_time_ms": 2236.711, "sample_time_ms": 1881.063, "load_time_ms": 12.731, "load_throughput": 942596.71, "learn_time_ms": 331.56, "learn_throughput": 36192.511, "synch_weights_time_ms": 9.55}, "counters": {"num_env_steps_sampled": 1020000, "num_env_steps_trained": 1020000, "num_agent_steps_sampled": 1020000, "num_agent_steps_trained": 1020000}, "done": false, "episodes_total": 3844, "training_iteration": 85, "trial_id": "9f288_00017", "date": "2023-10-25_16-59-46", "timestamp": 1698249586, "time_this_iter_s": 2.2699673175811768, "time_total_s": 193.68365335464478, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 193.68365335464478, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 58.1, "ram_util_percent": 27.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.169878828456425e-27, "cur_lr": 0.0003, "total_loss": 6.466102043787639, "policy_loss": -0.0002493470907211304, "vf_loss": 6.466400035222372, "vf_explained_var": -1.0927518208821614e-06, "kl": 0.0006502455205496933, "entropy": 0.4871424525976181, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2565.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1032000, "num_env_steps_trained": 1032000, "num_agent_steps_sampled": 1032000, "num_agent_steps_trained": 1032000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.20500000000019766, "episode_len_mean": 287.62, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 42.30000000000001, 40.70000000000002, 43.10000000000001, 26.499999999999936, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.300000000000026, -50.00000000000044, 20.299999999999848, 39.300000000000026, -50.00000000000044, 44.900000000000006, 46.9, 43.30000000000001, 36.50000000000003, 39.10000000000002, -50.00000000000044, 31.900000000000013, 46.5, 45.5, 32.90000000000003, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 4.699999999999626, 28.499999999999964, 13.299999999999748, 45.1, -50.00000000000044, 45.1, 25.499999999999922, 42.10000000000001, 37.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 46.5, 47.1, 10.099999999999703, -50.00000000000044, -50.00000000000044, 34.30000000000004, 38.50000000000003, -50.00000000000044, -50.00000000000044, 35.900000000000034, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 28.499999999999964, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 29.49999999999998, 43.10000000000001, -50.00000000000044, -50.00000000000044, 23.29999999999989, -50.00000000000044, 35.900000000000034, 41.70000000000002, 44.900000000000006, 34.900000000000034, 42.30000000000001, -50.00000000000044, 42.10000000000001, 44.300000000000004, -50.00000000000044, 39.90000000000002, -50.00000000000044, 45.7, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 28.699999999999967, 44.7, 46.099999999999994, -50.00000000000044, 40.500000000000014, 36.900000000000034, 32.700000000000024, -50.00000000000044, 37.300000000000026, -50.00000000000044, 39.10000000000002, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 78, 94, 70, 236, 500, 500, 500, 500, 128, 500, 298, 108, 500, 52, 32, 68, 136, 110, 500, 182, 36, 46, 172, 90, 500, 500, 500, 500, 454, 216, 368, 50, 500, 50, 246, 80, 126, 500, 500, 500, 52, 36, 30, 400, 500, 500, 158, 116, 500, 500, 142, 500, 500, 52, 500, 216, 500, 500, 500, 130, 500, 58, 500, 500, 206, 70, 500, 500, 268, 500, 142, 84, 52, 152, 78, 500, 80, 58, 500, 102, 500, 44, 500, 62, 500, 500, 214, 54, 40, 500, 96, 132, 174, 500, 128, 500, 110, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.376821107509153, "mean_inference_ms": 1.203555582096331, "mean_action_processing_ms": 0.13982925898491838, "mean_env_wait_ms": 0.08400916578681197, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02900075912475586, "StateBufferConnector_ms": 0.005996227264404297, "ViewRequirementAgentConnector_ms": 0.1299724578857422}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.20500000000019766, "episode_len_mean": 287.62, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 42.30000000000001, 40.70000000000002, 43.10000000000001, 26.499999999999936, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.300000000000026, -50.00000000000044, 20.299999999999848, 39.300000000000026, -50.00000000000044, 44.900000000000006, 46.9, 43.30000000000001, 36.50000000000003, 39.10000000000002, -50.00000000000044, 31.900000000000013, 46.5, 45.5, 32.90000000000003, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 4.699999999999626, 28.499999999999964, 13.299999999999748, 45.1, -50.00000000000044, 45.1, 25.499999999999922, 42.10000000000001, 37.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 46.5, 47.1, 10.099999999999703, -50.00000000000044, -50.00000000000044, 34.30000000000004, 38.50000000000003, -50.00000000000044, -50.00000000000044, 35.900000000000034, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 28.499999999999964, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 29.49999999999998, 43.10000000000001, -50.00000000000044, -50.00000000000044, 23.29999999999989, -50.00000000000044, 35.900000000000034, 41.70000000000002, 44.900000000000006, 34.900000000000034, 42.30000000000001, -50.00000000000044, 42.10000000000001, 44.300000000000004, -50.00000000000044, 39.90000000000002, -50.00000000000044, 45.7, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 28.699999999999967, 44.7, 46.099999999999994, -50.00000000000044, 40.500000000000014, 36.900000000000034, 32.700000000000024, -50.00000000000044, 37.300000000000026, -50.00000000000044, 39.10000000000002, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 78, 94, 70, 236, 500, 500, 500, 500, 128, 500, 298, 108, 500, 52, 32, 68, 136, 110, 500, 182, 36, 46, 172, 90, 500, 500, 500, 500, 454, 216, 368, 50, 500, 50, 246, 80, 126, 500, 500, 500, 52, 36, 30, 400, 500, 500, 158, 116, 500, 500, 142, 500, 500, 52, 500, 216, 500, 500, 500, 130, 500, 58, 500, 500, 206, 70, 500, 500, 268, 500, 142, 84, 52, 152, 78, 500, 80, 58, 500, 102, 500, 44, 500, 62, 500, 500, 214, 54, 40, 500, 96, 132, 174, 500, 128, 500, 110, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.376821107509153, "mean_inference_ms": 1.203555582096331, "mean_action_processing_ms": 0.13982925898491838, "mean_env_wait_ms": 0.08400916578681197, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02900075912475586, "StateBufferConnector_ms": 0.005996227264404297, "ViewRequirementAgentConnector_ms": 0.1299724578857422}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1032000, "num_agent_steps_trained": 1032000, "num_env_steps_sampled": 1032000, "num_env_steps_trained": 1032000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5528.696930009516, "num_env_steps_trained_throughput_per_sec": 5528.696930009516, "timesteps_total": 1032000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1032000, "timers": {"training_iteration_time_ms": 2231.578, "sample_time_ms": 1882.669, "load_time_ms": 12.353, "load_throughput": 971460.269, "learn_time_ms": 325.371, "learn_throughput": 36880.965, "synch_weights_time_ms": 9.281}, "counters": {"num_env_steps_sampled": 1032000, "num_env_steps_trained": 1032000, "num_agent_steps_sampled": 1032000, "num_agent_steps_trained": 1032000}, "done": false, "episodes_total": 3886, "training_iteration": 86, "trial_id": "9f288_00017", "date": "2023-10-25_16-59-48", "timestamp": 1698249588, "time_this_iter_s": 2.176222324371338, "time_total_s": 195.8598756790161, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 195.8598756790161, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 60.833333333333336, "ram_util_percent": 27.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.5849394142282123e-27, "cur_lr": 0.0003, "total_loss": 6.947909148534139, "policy_loss": -0.00032887086272239687, "vf_loss": 6.948292700449626, "vf_explained_var": -9.417533874511719e-07, "kl": 0.0004332895691087894, "entropy": 0.5467122813065847, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2595.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1044000, "num_env_steps_trained": 1044000, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000}, "sampler_results": {"episode_reward_max": 46.099999999999994, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.7580000000001972, "episode_len_mean": 288.14, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 34.30000000000004, 38.50000000000003, -50.00000000000044, -50.00000000000044, 35.900000000000034, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 28.499999999999964, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 29.49999999999998, 43.10000000000001, -50.00000000000044, -50.00000000000044, 23.29999999999989, -50.00000000000044, 35.900000000000034, 41.70000000000002, 44.900000000000006, 34.900000000000034, 42.30000000000001, -50.00000000000044, 42.10000000000001, 44.300000000000004, -50.00000000000044, 39.90000000000002, -50.00000000000044, 45.7, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 28.699999999999967, 44.7, 46.099999999999994, -50.00000000000044, 40.500000000000014, 36.900000000000034, 32.700000000000024, -50.00000000000044, 37.300000000000026, -50.00000000000044, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, 43.30000000000001, 9.8999999999997, 40.500000000000014, -50.00000000000044, -50.00000000000044, 39.70000000000002, -50.00000000000044, 28.09999999999996, 13.899999999999757, 44.7, 43.900000000000006, 44.900000000000006, -50.00000000000044, -50.00000000000044, 20.099999999999845, -50.00000000000044, -50.00000000000044, 39.10000000000002, 35.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, 27.299999999999947, 44.300000000000004, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 44.7, 40.500000000000014, 42.70000000000001, 38.300000000000026, 36.70000000000003, 43.900000000000006, 23.099999999999888, -50.00000000000044, 44.300000000000004, -50.00000000000044, 40.70000000000002, 44.10000000000001], "episode_lengths": [500, 158, 116, 500, 500, 142, 500, 500, 52, 500, 216, 500, 500, 500, 130, 500, 58, 500, 500, 206, 70, 500, 500, 268, 500, 142, 84, 52, 152, 78, 500, 80, 58, 500, 102, 500, 44, 500, 62, 500, 500, 214, 54, 40, 500, 96, 132, 174, 500, 128, 500, 110, 500, 500, 500, 102, 68, 402, 96, 500, 500, 104, 500, 220, 362, 54, 62, 52, 500, 500, 300, 500, 500, 110, 148, 500, 500, 500, 104, 228, 58, 500, 500, 40, 500, 500, 500, 66, 54, 96, 74, 118, 134, 62, 270, 500, 58, 500, 94, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3768480648302875, "mean_inference_ms": 1.2035612245108833, "mean_action_processing_ms": 0.1398529134937807, "mean_env_wait_ms": 0.08386583783110517, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03400588035583496, "StateBufferConnector_ms": 0.006999015808105469, "ViewRequirementAgentConnector_ms": 0.1260085105895996}}, "episode_reward_max": 46.099999999999994, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.7580000000001972, "episode_len_mean": 288.14, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 34.30000000000004, 38.50000000000003, -50.00000000000044, -50.00000000000044, 35.900000000000034, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 28.499999999999964, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 29.49999999999998, 43.10000000000001, -50.00000000000044, -50.00000000000044, 23.29999999999989, -50.00000000000044, 35.900000000000034, 41.70000000000002, 44.900000000000006, 34.900000000000034, 42.30000000000001, -50.00000000000044, 42.10000000000001, 44.300000000000004, -50.00000000000044, 39.90000000000002, -50.00000000000044, 45.7, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 28.699999999999967, 44.7, 46.099999999999994, -50.00000000000044, 40.500000000000014, 36.900000000000034, 32.700000000000024, -50.00000000000044, 37.300000000000026, -50.00000000000044, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, 43.30000000000001, 9.8999999999997, 40.500000000000014, -50.00000000000044, -50.00000000000044, 39.70000000000002, -50.00000000000044, 28.09999999999996, 13.899999999999757, 44.7, 43.900000000000006, 44.900000000000006, -50.00000000000044, -50.00000000000044, 20.099999999999845, -50.00000000000044, -50.00000000000044, 39.10000000000002, 35.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, 27.299999999999947, 44.300000000000004, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 44.7, 40.500000000000014, 42.70000000000001, 38.300000000000026, 36.70000000000003, 43.900000000000006, 23.099999999999888, -50.00000000000044, 44.300000000000004, -50.00000000000044, 40.70000000000002, 44.10000000000001], "episode_lengths": [500, 158, 116, 500, 500, 142, 500, 500, 52, 500, 216, 500, 500, 500, 130, 500, 58, 500, 500, 206, 70, 500, 500, 268, 500, 142, 84, 52, 152, 78, 500, 80, 58, 500, 102, 500, 44, 500, 62, 500, 500, 214, 54, 40, 500, 96, 132, 174, 500, 128, 500, 110, 500, 500, 500, 102, 68, 402, 96, 500, 500, 104, 500, 220, 362, 54, 62, 52, 500, 500, 300, 500, 500, 110, 148, 500, 500, 500, 104, 228, 58, 500, 500, 40, 500, 500, 500, 66, 54, 96, 74, 118, 134, 62, 270, 500, 58, 500, 94, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3768480648302875, "mean_inference_ms": 1.2035612245108833, "mean_action_processing_ms": 0.1398529134937807, "mean_env_wait_ms": 0.08386583783110517, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03400588035583496, "StateBufferConnector_ms": 0.006999015808105469, "ViewRequirementAgentConnector_ms": 0.1260085105895996}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000, "num_env_steps_sampled": 1044000, "num_env_steps_trained": 1044000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5328.369808304596, "num_env_steps_trained_throughput_per_sec": 5328.369808304596, "timesteps_total": 1044000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1044000, "timers": {"training_iteration_time_ms": 2234.438, "sample_time_ms": 1880.66, "load_time_ms": 11.759, "load_throughput": 1020516.06, "learn_time_ms": 330.852, "learn_throughput": 36270.006, "synch_weights_time_ms": 9.462}, "counters": {"num_env_steps_sampled": 1044000, "num_env_steps_trained": 1044000, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000}, "done": false, "episodes_total": 3932, "training_iteration": 87, "trial_id": "9f288_00017", "date": "2023-10-25_16-59-50", "timestamp": 1698249590, "time_this_iter_s": 2.2576072216033936, "time_total_s": 198.1174829006195, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 198.1174829006195, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 59.1, "ram_util_percent": 27.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.2924697071141062e-27, "cur_lr": 0.0003, "total_loss": 6.412636391321818, "policy_loss": 1.3227760791778565e-05, "vf_loss": 6.412674697240194, "vf_explained_var": -1.0251998901367187e-06, "kl": 0.0002320675489045243, "entropy": 0.5152970572312673, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2625.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1056000, "num_env_steps_trained": 1056000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.8869999999998415, "episode_len_mean": 246.78, "episode_media": {}, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, 43.30000000000001, 9.8999999999997, 40.500000000000014, -50.00000000000044, -50.00000000000044, 39.70000000000002, -50.00000000000044, 28.09999999999996, 13.899999999999757, 44.7, 43.900000000000006, 44.900000000000006, -50.00000000000044, -50.00000000000044, 20.099999999999845, -50.00000000000044, -50.00000000000044, 39.10000000000002, 35.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, 27.299999999999947, 44.300000000000004, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 44.7, 40.500000000000014, 42.70000000000001, 38.300000000000026, 36.70000000000003, 43.900000000000006, 23.099999999999888, -50.00000000000044, 44.300000000000004, -50.00000000000044, 40.70000000000002, 44.10000000000001, -50.00000000000044, -50.00000000000044, 45.5, 45.9, -50.00000000000044, 41.30000000000001, 44.7, 44.7, 34.30000000000004, -50.00000000000044, 44.900000000000006, 47.7, 46.099999999999994, 41.30000000000001, 40.30000000000002, -50.00000000000044, -50.00000000000044, 34.10000000000004, 45.5, 40.10000000000002, 42.30000000000001, 44.900000000000006, 44.5, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.300000000000004, 41.500000000000014, 37.90000000000003, 45.1, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, 47.3, 30.29999999999999, -50.00000000000044, 45.3, -50.00000000000044, 37.50000000000003, 44.10000000000001, 16.29999999999979, 26.89999999999994, 38.90000000000002, -50.00000000000044, 33.500000000000036, 35.500000000000036, -50.00000000000044, 45.1, 25.499999999999922], "episode_lengths": [110, 500, 500, 500, 102, 68, 402, 96, 500, 500, 104, 500, 220, 362, 54, 62, 52, 500, 500, 300, 500, 500, 110, 148, 500, 500, 500, 104, 228, 58, 500, 500, 40, 500, 500, 500, 66, 54, 96, 74, 118, 134, 62, 270, 500, 58, 500, 94, 60, 500, 500, 46, 42, 500, 88, 54, 54, 158, 500, 52, 24, 40, 88, 98, 500, 500, 160, 46, 100, 78, 52, 56, 40, 500, 500, 58, 86, 122, 50, 34, 500, 500, 500, 96, 28, 198, 500, 48, 500, 126, 60, 338, 232, 112, 500, 166, 146, 500, 50, 246]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37614769209340293, "mean_inference_ms": 1.2022763771246243, "mean_action_processing_ms": 0.1396341591654849, "mean_env_wait_ms": 0.08359960543598488, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0380091667175293, "StateBufferConnector_ms": 0.006000518798828125, "ViewRequirementAgentConnector_ms": 0.11703681945800781}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.8869999999998415, "episode_len_mean": 246.78, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, 43.30000000000001, 9.8999999999997, 40.500000000000014, -50.00000000000044, -50.00000000000044, 39.70000000000002, -50.00000000000044, 28.09999999999996, 13.899999999999757, 44.7, 43.900000000000006, 44.900000000000006, -50.00000000000044, -50.00000000000044, 20.099999999999845, -50.00000000000044, -50.00000000000044, 39.10000000000002, 35.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, 27.299999999999947, 44.300000000000004, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 44.7, 40.500000000000014, 42.70000000000001, 38.300000000000026, 36.70000000000003, 43.900000000000006, 23.099999999999888, -50.00000000000044, 44.300000000000004, -50.00000000000044, 40.70000000000002, 44.10000000000001, -50.00000000000044, -50.00000000000044, 45.5, 45.9, -50.00000000000044, 41.30000000000001, 44.7, 44.7, 34.30000000000004, -50.00000000000044, 44.900000000000006, 47.7, 46.099999999999994, 41.30000000000001, 40.30000000000002, -50.00000000000044, -50.00000000000044, 34.10000000000004, 45.5, 40.10000000000002, 42.30000000000001, 44.900000000000006, 44.5, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.300000000000004, 41.500000000000014, 37.90000000000003, 45.1, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, 47.3, 30.29999999999999, -50.00000000000044, 45.3, -50.00000000000044, 37.50000000000003, 44.10000000000001, 16.29999999999979, 26.89999999999994, 38.90000000000002, -50.00000000000044, 33.500000000000036, 35.500000000000036, -50.00000000000044, 45.1, 25.499999999999922], "episode_lengths": [110, 500, 500, 500, 102, 68, 402, 96, 500, 500, 104, 500, 220, 362, 54, 62, 52, 500, 500, 300, 500, 500, 110, 148, 500, 500, 500, 104, 228, 58, 500, 500, 40, 500, 500, 500, 66, 54, 96, 74, 118, 134, 62, 270, 500, 58, 500, 94, 60, 500, 500, 46, 42, 500, 88, 54, 54, 158, 500, 52, 24, 40, 88, 98, 500, 500, 160, 46, 100, 78, 52, 56, 40, 500, 500, 58, 86, 122, 50, 34, 500, 500, 500, 96, 28, 198, 500, 48, 500, 126, 60, 338, 232, 112, 500, 166, 146, 500, 50, 246]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37614769209340293, "mean_inference_ms": 1.2022763771246243, "mean_action_processing_ms": 0.1396341591654849, "mean_env_wait_ms": 0.08359960543598488, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0380091667175293, "StateBufferConnector_ms": 0.006000518798828125, "ViewRequirementAgentConnector_ms": 0.11703681945800781}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000, "num_env_steps_sampled": 1056000, "num_env_steps_trained": 1056000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4738.00196536392, "num_env_steps_trained_throughput_per_sec": 4738.00196536392, "timesteps_total": 1056000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1056000, "timers": {"training_iteration_time_ms": 2263.264, "sample_time_ms": 1905.074, "load_time_ms": 12.759, "load_throughput": 940521.802, "learn_time_ms": 334.32, "learn_throughput": 35893.78, "synch_weights_time_ms": 9.406}, "counters": {"num_env_steps_sampled": 1056000, "num_env_steps_trained": 1056000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "done": false, "episodes_total": 3983, "training_iteration": 88, "trial_id": "9f288_00017", "date": "2023-10-25_16-59-53", "timestamp": 1698249593, "time_this_iter_s": 2.5377116203308105, "time_total_s": 200.65519452095032, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 200.65519452095032, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 47.775, "ram_util_percent": 27.25}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.462348535570531e-28, "cur_lr": 0.0003, "total_loss": 7.003922589619955, "policy_loss": -0.0015676638732353846, "vf_loss": 7.005545870463053, "vf_explained_var": -9.338061014811198e-07, "kl": 0.002153219608491478, "entropy": 0.5560778518517812, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2655.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1068000, "num_env_steps_trained": 1068000, "num_agent_steps_sampled": 1068000, "num_agent_steps_trained": 1068000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.819999999999853, "episode_len_mean": 232.48, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 41.30000000000001, 44.7, 44.7, 34.30000000000004, -50.00000000000044, 44.900000000000006, 47.7, 46.099999999999994, 41.30000000000001, 40.30000000000002, -50.00000000000044, -50.00000000000044, 34.10000000000004, 45.5, 40.10000000000002, 42.30000000000001, 44.900000000000006, 44.5, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.300000000000004, 41.500000000000014, 37.90000000000003, 45.1, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, 47.3, 30.29999999999999, -50.00000000000044, 45.3, -50.00000000000044, 37.50000000000003, 44.10000000000001, 16.29999999999979, 26.89999999999994, 38.90000000000002, -50.00000000000044, 33.500000000000036, 35.500000000000036, -50.00000000000044, 45.1, 25.499999999999922, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, 24.69999999999991, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 47.5, -50.00000000000044, 46.099999999999994, -50.00000000000044, 41.30000000000001, 41.30000000000001, 38.90000000000002, 18.899999999999828, 42.30000000000001, 18.499999999999822, 45.3, -50.00000000000044, 36.10000000000004, 46.5, -50.00000000000044, 37.70000000000003, 38.10000000000002, 41.500000000000014, 31.900000000000013, -50.00000000000044, 20.699999999999854, -50.00000000000044, -50.00000000000044, 45.3, 40.90000000000002, -50.00000000000044, 46.5, -50.00000000000044, 45.3, 43.900000000000006, 12.899999999999743, 37.300000000000026, 47.3, 38.50000000000003, 38.50000000000003, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 38.90000000000002, -50.00000000000044, 46.5, 47.1, 42.30000000000001], "episode_lengths": [500, 88, 54, 54, 158, 500, 52, 24, 40, 88, 98, 500, 500, 160, 46, 100, 78, 52, 56, 40, 500, 500, 58, 86, 122, 50, 34, 500, 500, 500, 96, 28, 198, 500, 48, 500, 126, 60, 338, 232, 112, 500, 166, 146, 500, 50, 246, 500, 500, 500, 96, 254, 500, 500, 52, 500, 26, 500, 40, 500, 88, 88, 112, 312, 78, 316, 48, 500, 140, 36, 500, 124, 120, 86, 182, 500, 294, 500, 500, 48, 92, 500, 36, 500, 48, 62, 372, 128, 28, 116, 116, 500, 500, 70, 500, 112, 500, 36, 30, 78]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37595799657791207, "mean_inference_ms": 1.201890752340068, "mean_action_processing_ms": 0.13979881365158245, "mean_env_wait_ms": 0.08332474175637565, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03100728988647461, "StateBufferConnector_ms": 0.007997512817382812, "ViewRequirementAgentConnector_ms": 0.11803030967712402}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.819999999999853, "episode_len_mean": 232.48, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 41.30000000000001, 44.7, 44.7, 34.30000000000004, -50.00000000000044, 44.900000000000006, 47.7, 46.099999999999994, 41.30000000000001, 40.30000000000002, -50.00000000000044, -50.00000000000044, 34.10000000000004, 45.5, 40.10000000000002, 42.30000000000001, 44.900000000000006, 44.5, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.300000000000004, 41.500000000000014, 37.90000000000003, 45.1, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, 47.3, 30.29999999999999, -50.00000000000044, 45.3, -50.00000000000044, 37.50000000000003, 44.10000000000001, 16.29999999999979, 26.89999999999994, 38.90000000000002, -50.00000000000044, 33.500000000000036, 35.500000000000036, -50.00000000000044, 45.1, 25.499999999999922, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, 24.69999999999991, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 47.5, -50.00000000000044, 46.099999999999994, -50.00000000000044, 41.30000000000001, 41.30000000000001, 38.90000000000002, 18.899999999999828, 42.30000000000001, 18.499999999999822, 45.3, -50.00000000000044, 36.10000000000004, 46.5, -50.00000000000044, 37.70000000000003, 38.10000000000002, 41.500000000000014, 31.900000000000013, -50.00000000000044, 20.699999999999854, -50.00000000000044, -50.00000000000044, 45.3, 40.90000000000002, -50.00000000000044, 46.5, -50.00000000000044, 45.3, 43.900000000000006, 12.899999999999743, 37.300000000000026, 47.3, 38.50000000000003, 38.50000000000003, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 38.90000000000002, -50.00000000000044, 46.5, 47.1, 42.30000000000001], "episode_lengths": [500, 88, 54, 54, 158, 500, 52, 24, 40, 88, 98, 500, 500, 160, 46, 100, 78, 52, 56, 40, 500, 500, 58, 86, 122, 50, 34, 500, 500, 500, 96, 28, 198, 500, 48, 500, 126, 60, 338, 232, 112, 500, 166, 146, 500, 50, 246, 500, 500, 500, 96, 254, 500, 500, 52, 500, 26, 500, 40, 500, 88, 88, 112, 312, 78, 316, 48, 500, 140, 36, 500, 124, 120, 86, 182, 500, 294, 500, 500, 48, 92, 500, 36, 500, 48, 62, 372, 128, 28, 116, 116, 500, 500, 70, 500, 112, 500, 36, 30, 78]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37595799657791207, "mean_inference_ms": 1.201890752340068, "mean_action_processing_ms": 0.13979881365158245, "mean_env_wait_ms": 0.08332474175637565, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03100728988647461, "StateBufferConnector_ms": 0.007997512817382812, "ViewRequirementAgentConnector_ms": 0.11803030967712402}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1068000, "num_agent_steps_trained": 1068000, "num_env_steps_sampled": 1068000, "num_env_steps_trained": 1068000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5417.263984866169, "num_env_steps_trained_throughput_per_sec": 5417.263984866169, "timesteps_total": 1068000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1068000, "timers": {"training_iteration_time_ms": 2257.014, "sample_time_ms": 1905.238, "load_time_ms": 12.16, "load_throughput": 986852.489, "learn_time_ms": 328.405, "learn_throughput": 36540.226, "synch_weights_time_ms": 9.405}, "counters": {"num_env_steps_sampled": 1068000, "num_env_steps_trained": 1068000, "num_agent_steps_sampled": 1068000, "num_agent_steps_trained": 1068000}, "done": false, "episodes_total": 4036, "training_iteration": 89, "trial_id": "9f288_00017", "date": "2023-10-25_16-59-55", "timestamp": 1698249595, "time_this_iter_s": 2.220139980316162, "time_total_s": 202.87533450126648, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 202.87533450126648, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 60.166666666666664, "ram_util_percent": 27.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.2311742677852654e-28, "cur_lr": 0.0003, "total_loss": 6.552051528294881, "policy_loss": -0.0006205608447392781, "vf_loss": 6.552723550796509, "vf_explained_var": -9.258588155110677e-07, "kl": 0.0010752617829136095, "entropy": 0.5152432938416799, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2685.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1080000, "num_env_steps_trained": 1080000, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.940999999999859, "episode_len_mean": 236.28, "episode_media": {}, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 40.500000000000014, 24.69999999999991, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 47.5, -50.00000000000044, 46.099999999999994, -50.00000000000044, 41.30000000000001, 41.30000000000001, 38.90000000000002, 18.899999999999828, 42.30000000000001, 18.499999999999822, 45.3, -50.00000000000044, 36.10000000000004, 46.5, -50.00000000000044, 37.70000000000003, 38.10000000000002, 41.500000000000014, 31.900000000000013, -50.00000000000044, 20.699999999999854, -50.00000000000044, -50.00000000000044, 45.3, 40.90000000000002, -50.00000000000044, 46.5, -50.00000000000044, 45.3, 43.900000000000006, 12.899999999999743, 37.300000000000026, 47.3, 38.50000000000003, 38.50000000000003, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 38.90000000000002, -50.00000000000044, 46.5, 47.1, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 39.50000000000002, -50.00000000000044, 38.700000000000024, 35.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.900000000000034, 45.9, 45.1, 41.90000000000001, 46.5, 45.9, 36.70000000000003, 31.1, 18.29999999999982, 41.30000000000001, 40.90000000000002, -50.00000000000044, 38.50000000000003, 41.70000000000002, 23.699999999999896, -50.00000000000044, 26.89999999999994, 23.29999999999989, 43.7, 43.7, 45.7, 40.90000000000002, 30.9, 32.50000000000002, -50.00000000000044, 43.10000000000001, 36.70000000000003, -50.00000000000044, 43.30000000000001, 42.500000000000014, 42.30000000000001, 43.50000000000001, -50.00000000000044, -50.00000000000044, 20.699999999999854, 43.50000000000001, -50.00000000000044, 30.9], "episode_lengths": [500, 96, 254, 500, 500, 52, 500, 26, 500, 40, 500, 88, 88, 112, 312, 78, 316, 48, 500, 140, 36, 500, 124, 120, 86, 182, 500, 294, 500, 500, 48, 92, 500, 36, 500, 48, 62, 372, 128, 28, 116, 116, 500, 500, 70, 500, 112, 500, 36, 30, 78, 500, 500, 500, 52, 106, 500, 114, 146, 500, 500, 500, 132, 42, 50, 82, 36, 42, 134, 190, 318, 88, 92, 500, 116, 84, 264, 500, 232, 268, 64, 64, 44, 92, 192, 176, 500, 70, 134, 500, 68, 76, 78, 66, 500, 500, 294, 66, 500, 192]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3762431542364215, "mean_inference_ms": 1.2019582088014225, "mean_action_processing_ms": 0.13973903536710186, "mean_env_wait_ms": 0.0835493572028139, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021999597549438477, "StateBufferConnector_ms": 0.005998134613037109, "ViewRequirementAgentConnector_ms": 0.13080549240112305}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.940999999999859, "episode_len_mean": 236.28, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 40.500000000000014, 24.69999999999991, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 47.5, -50.00000000000044, 46.099999999999994, -50.00000000000044, 41.30000000000001, 41.30000000000001, 38.90000000000002, 18.899999999999828, 42.30000000000001, 18.499999999999822, 45.3, -50.00000000000044, 36.10000000000004, 46.5, -50.00000000000044, 37.70000000000003, 38.10000000000002, 41.500000000000014, 31.900000000000013, -50.00000000000044, 20.699999999999854, -50.00000000000044, -50.00000000000044, 45.3, 40.90000000000002, -50.00000000000044, 46.5, -50.00000000000044, 45.3, 43.900000000000006, 12.899999999999743, 37.300000000000026, 47.3, 38.50000000000003, 38.50000000000003, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 38.90000000000002, -50.00000000000044, 46.5, 47.1, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 39.50000000000002, -50.00000000000044, 38.700000000000024, 35.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.900000000000034, 45.9, 45.1, 41.90000000000001, 46.5, 45.9, 36.70000000000003, 31.1, 18.29999999999982, 41.30000000000001, 40.90000000000002, -50.00000000000044, 38.50000000000003, 41.70000000000002, 23.699999999999896, -50.00000000000044, 26.89999999999994, 23.29999999999989, 43.7, 43.7, 45.7, 40.90000000000002, 30.9, 32.50000000000002, -50.00000000000044, 43.10000000000001, 36.70000000000003, -50.00000000000044, 43.30000000000001, 42.500000000000014, 42.30000000000001, 43.50000000000001, -50.00000000000044, -50.00000000000044, 20.699999999999854, 43.50000000000001, -50.00000000000044, 30.9], "episode_lengths": [500, 96, 254, 500, 500, 52, 500, 26, 500, 40, 500, 88, 88, 112, 312, 78, 316, 48, 500, 140, 36, 500, 124, 120, 86, 182, 500, 294, 500, 500, 48, 92, 500, 36, 500, 48, 62, 372, 128, 28, 116, 116, 500, 500, 70, 500, 112, 500, 36, 30, 78, 500, 500, 500, 52, 106, 500, 114, 146, 500, 500, 500, 132, 42, 50, 82, 36, 42, 134, 190, 318, 88, 92, 500, 116, 84, 264, 500, 232, 268, 64, 64, 44, 92, 192, 176, 500, 70, 134, 500, 68, 76, 78, 66, 500, 500, 294, 66, 500, 192]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3762431542364215, "mean_inference_ms": 1.2019582088014225, "mean_action_processing_ms": 0.13973903536710186, "mean_env_wait_ms": 0.0835493572028139, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021999597549438477, "StateBufferConnector_ms": 0.005998134613037109, "ViewRequirementAgentConnector_ms": 0.13080549240112305}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000, "num_env_steps_sampled": 1080000, "num_env_steps_trained": 1080000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5178.460490915973, "num_env_steps_trained_throughput_per_sec": 5178.460490915973, "timesteps_total": 1080000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1080000, "timers": {"training_iteration_time_ms": 2268.496, "sample_time_ms": 1904.146, "load_time_ms": 12.96, "load_throughput": 925930.693, "learn_time_ms": 340.267, "learn_throughput": 35266.387, "synch_weights_time_ms": 9.318}, "counters": {"num_env_steps_sampled": 1080000, "num_env_steps_trained": 1080000, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000}, "done": false, "episodes_total": 4085, "training_iteration": 90, "trial_id": "9f288_00017", "date": "2023-10-25_16-59-58", "timestamp": 1698249598, "time_this_iter_s": 2.3220789432525635, "time_total_s": 205.19741344451904, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 205.19741344451904, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 58.633333333333326, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.6155871338926327e-28, "cur_lr": 0.0003, "total_loss": 7.383182573318481, "policy_loss": -0.0005129297574361165, "vf_loss": 7.383750502268473, "vf_explained_var": -1.0649363199869792e-06, "kl": 0.0008574401733540072, "entropy": 0.5505958040555318, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2715.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1092000, "num_env_steps_trained": 1092000, "num_agent_steps_sampled": 1092000, "num_agent_steps_trained": 1092000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 17.005999999999887, "episode_len_mean": 210.7, "episode_media": {}, "episodes_this_iter": 60, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 36.900000000000034, 45.9, 45.1, 41.90000000000001, 46.5, 45.9, 36.70000000000003, 31.1, 18.29999999999982, 41.30000000000001, 40.90000000000002, -50.00000000000044, 38.50000000000003, 41.70000000000002, 23.699999999999896, -50.00000000000044, 26.89999999999994, 23.29999999999989, 43.7, 43.7, 45.7, 40.90000000000002, 30.9, 32.50000000000002, -50.00000000000044, 43.10000000000001, 36.70000000000003, -50.00000000000044, 43.30000000000001, 42.500000000000014, 42.30000000000001, 43.50000000000001, -50.00000000000044, -50.00000000000044, 20.699999999999854, 43.50000000000001, -50.00000000000044, 30.9, 20.699999999999854, 39.70000000000002, -50.00000000000044, 41.500000000000014, -50.00000000000044, 29.099999999999973, -50.00000000000044, -50.00000000000044, 45.3, 46.699999999999996, 39.10000000000002, -50.00000000000044, -50.00000000000044, 45.1, 45.3, 43.30000000000001, -50.00000000000044, 2.699999999999598, 42.500000000000014, 1.6999999999995836, -50.00000000000044, -50.00000000000044, 43.900000000000006, 36.900000000000034, 43.50000000000001, 29.69999999999998, 47.1, 31.500000000000007, 40.10000000000002, 41.70000000000002, -50.00000000000044, 46.099999999999994, 37.90000000000003, 36.70000000000003, 40.30000000000002, -50.00000000000044, 43.50000000000001, 32.700000000000024, 47.1, 44.300000000000004, 46.699999999999996, 31.300000000000004, 33.500000000000036, 44.5, 31.500000000000007, 38.300000000000026, 46.5, 44.5, -50.00000000000044, 44.5, 41.100000000000016, -50.00000000000044, -50.00000000000044, 38.10000000000002, 39.90000000000002, 40.90000000000002, -50.00000000000044, 39.90000000000002, 40.10000000000002, 45.1], "episode_lengths": [500, 500, 132, 42, 50, 82, 36, 42, 134, 190, 318, 88, 92, 500, 116, 84, 264, 500, 232, 268, 64, 64, 44, 92, 192, 176, 500, 70, 134, 500, 68, 76, 78, 66, 500, 500, 294, 66, 500, 192, 294, 104, 500, 86, 500, 210, 500, 500, 48, 34, 110, 500, 500, 50, 48, 68, 500, 474, 76, 484, 500, 500, 62, 132, 66, 204, 30, 186, 100, 84, 500, 40, 122, 134, 98, 500, 66, 174, 30, 58, 34, 188, 166, 56, 186, 118, 36, 56, 500, 56, 90, 500, 500, 120, 102, 92, 500, 102, 100, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37646997686651007, "mean_inference_ms": 1.203205674216308, "mean_action_processing_ms": 0.14006555487897426, "mean_env_wait_ms": 0.08393542004155403, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031005144119262695, "StateBufferConnector_ms": 0.001999378204345703, "ViewRequirementAgentConnector_ms": 0.12776684761047363}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 17.005999999999887, "episode_len_mean": 210.7, "episodes_this_iter": 60, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 36.900000000000034, 45.9, 45.1, 41.90000000000001, 46.5, 45.9, 36.70000000000003, 31.1, 18.29999999999982, 41.30000000000001, 40.90000000000002, -50.00000000000044, 38.50000000000003, 41.70000000000002, 23.699999999999896, -50.00000000000044, 26.89999999999994, 23.29999999999989, 43.7, 43.7, 45.7, 40.90000000000002, 30.9, 32.50000000000002, -50.00000000000044, 43.10000000000001, 36.70000000000003, -50.00000000000044, 43.30000000000001, 42.500000000000014, 42.30000000000001, 43.50000000000001, -50.00000000000044, -50.00000000000044, 20.699999999999854, 43.50000000000001, -50.00000000000044, 30.9, 20.699999999999854, 39.70000000000002, -50.00000000000044, 41.500000000000014, -50.00000000000044, 29.099999999999973, -50.00000000000044, -50.00000000000044, 45.3, 46.699999999999996, 39.10000000000002, -50.00000000000044, -50.00000000000044, 45.1, 45.3, 43.30000000000001, -50.00000000000044, 2.699999999999598, 42.500000000000014, 1.6999999999995836, -50.00000000000044, -50.00000000000044, 43.900000000000006, 36.900000000000034, 43.50000000000001, 29.69999999999998, 47.1, 31.500000000000007, 40.10000000000002, 41.70000000000002, -50.00000000000044, 46.099999999999994, 37.90000000000003, 36.70000000000003, 40.30000000000002, -50.00000000000044, 43.50000000000001, 32.700000000000024, 47.1, 44.300000000000004, 46.699999999999996, 31.300000000000004, 33.500000000000036, 44.5, 31.500000000000007, 38.300000000000026, 46.5, 44.5, -50.00000000000044, 44.5, 41.100000000000016, -50.00000000000044, -50.00000000000044, 38.10000000000002, 39.90000000000002, 40.90000000000002, -50.00000000000044, 39.90000000000002, 40.10000000000002, 45.1], "episode_lengths": [500, 500, 132, 42, 50, 82, 36, 42, 134, 190, 318, 88, 92, 500, 116, 84, 264, 500, 232, 268, 64, 64, 44, 92, 192, 176, 500, 70, 134, 500, 68, 76, 78, 66, 500, 500, 294, 66, 500, 192, 294, 104, 500, 86, 500, 210, 500, 500, 48, 34, 110, 500, 500, 50, 48, 68, 500, 474, 76, 484, 500, 500, 62, 132, 66, 204, 30, 186, 100, 84, 500, 40, 122, 134, 98, 500, 66, 174, 30, 58, 34, 188, 166, 56, 186, 118, 36, 56, 500, 56, 90, 500, 500, 120, 102, 92, 500, 102, 100, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37646997686651007, "mean_inference_ms": 1.203205674216308, "mean_action_processing_ms": 0.14006555487897426, "mean_env_wait_ms": 0.08393542004155403, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031005144119262695, "StateBufferConnector_ms": 0.001999378204345703, "ViewRequirementAgentConnector_ms": 0.12776684761047363}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1092000, "num_agent_steps_trained": 1092000, "num_env_steps_sampled": 1092000, "num_env_steps_trained": 1092000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5357.361799120519, "num_env_steps_trained_throughput_per_sec": 5357.361799120519, "timesteps_total": 1092000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1092000, "timers": {"training_iteration_time_ms": 2263.647, "sample_time_ms": 1909.137, "load_time_ms": 12.265, "load_throughput": 978402.145, "learn_time_ms": 331.024, "learn_throughput": 36251.176, "synch_weights_time_ms": 9.34}, "counters": {"num_env_steps_sampled": 1092000, "num_env_steps_trained": 1092000, "num_agent_steps_sampled": 1092000, "num_agent_steps_trained": 1092000}, "done": false, "episodes_total": 4145, "training_iteration": 91, "trial_id": "9f288_00017", "date": "2023-10-25_17-00-00", "timestamp": 1698249600, "time_this_iter_s": 2.2449073791503906, "time_total_s": 207.44232082366943, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 207.44232082366943, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 56.4, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.077935669463164e-29, "cur_lr": 0.0003, "total_loss": 7.068010854721069, "policy_loss": 2.51998504002889e-05, "vf_loss": 7.068041785558065, "vf_explained_var": -1.0927518208821614e-06, "kl": 8.831762508331546e-05, "entropy": 0.5623651524384816, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2745.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1104000, "num_env_steps_trained": 1104000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 18.39099999999989, "episode_len_mean": 201.86, "episode_media": {}, "episodes_this_iter": 55, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.30000000000001, -50.00000000000044, 2.699999999999598, 42.500000000000014, 1.6999999999995836, -50.00000000000044, -50.00000000000044, 43.900000000000006, 36.900000000000034, 43.50000000000001, 29.69999999999998, 47.1, 31.500000000000007, 40.10000000000002, 41.70000000000002, -50.00000000000044, 46.099999999999994, 37.90000000000003, 36.70000000000003, 40.30000000000002, -50.00000000000044, 43.50000000000001, 32.700000000000024, 47.1, 44.300000000000004, 46.699999999999996, 31.300000000000004, 33.500000000000036, 44.5, 31.500000000000007, 38.300000000000026, 46.5, 44.5, -50.00000000000044, 44.5, 41.100000000000016, -50.00000000000044, -50.00000000000044, 38.10000000000002, 39.90000000000002, 40.90000000000002, -50.00000000000044, 39.90000000000002, 40.10000000000002, 45.1, -50.00000000000044, 45.1, 44.10000000000001, 41.90000000000001, 41.500000000000014, 41.500000000000014, -50.00000000000044, -50.00000000000044, 43.50000000000001, 37.50000000000003, 46.5, -50.00000000000044, 34.30000000000004, 35.30000000000004, -50.00000000000044, 43.50000000000001, 37.300000000000026, 0.49999999999956657, 37.300000000000026, 45.5, 22.299999999999876, 34.900000000000034, -50.00000000000044, -50.00000000000044, 43.50000000000001, 42.30000000000001, 45.3, 37.90000000000003, 35.900000000000034, 44.300000000000004, 39.70000000000002, -50.00000000000044, 14.699999999999768, -50.00000000000044, 46.9, 46.099999999999994, 39.90000000000002, 36.70000000000003, 46.099999999999994, 35.30000000000004, -50.00000000000044, 44.10000000000001, 41.100000000000016, 40.70000000000002, 46.3, 38.10000000000002, 42.10000000000001, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 38.10000000000002, 43.10000000000001], "episode_lengths": [68, 500, 474, 76, 484, 500, 500, 62, 132, 66, 204, 30, 186, 100, 84, 500, 40, 122, 134, 98, 500, 66, 174, 30, 58, 34, 188, 166, 56, 186, 118, 36, 56, 500, 56, 90, 500, 500, 120, 102, 92, 500, 102, 100, 50, 500, 50, 60, 82, 86, 86, 500, 500, 66, 126, 36, 500, 158, 148, 500, 66, 128, 496, 128, 46, 278, 152, 500, 500, 66, 78, 48, 122, 142, 58, 104, 500, 354, 500, 32, 40, 102, 134, 40, 148, 500, 60, 90, 94, 38, 120, 80, 500, 80, 500, 500, 34, 500, 120, 70]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37669779843465323, "mean_inference_ms": 1.2032485237524506, "mean_action_processing_ms": 0.1400832615869896, "mean_env_wait_ms": 0.0838811772394099, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03500556945800781, "StateBufferConnector_ms": 0.002000093460083008, "ViewRequirementAgentConnector_ms": 0.11282801628112793}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 18.39099999999989, "episode_len_mean": 201.86, "episodes_this_iter": 55, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.30000000000001, -50.00000000000044, 2.699999999999598, 42.500000000000014, 1.6999999999995836, -50.00000000000044, -50.00000000000044, 43.900000000000006, 36.900000000000034, 43.50000000000001, 29.69999999999998, 47.1, 31.500000000000007, 40.10000000000002, 41.70000000000002, -50.00000000000044, 46.099999999999994, 37.90000000000003, 36.70000000000003, 40.30000000000002, -50.00000000000044, 43.50000000000001, 32.700000000000024, 47.1, 44.300000000000004, 46.699999999999996, 31.300000000000004, 33.500000000000036, 44.5, 31.500000000000007, 38.300000000000026, 46.5, 44.5, -50.00000000000044, 44.5, 41.100000000000016, -50.00000000000044, -50.00000000000044, 38.10000000000002, 39.90000000000002, 40.90000000000002, -50.00000000000044, 39.90000000000002, 40.10000000000002, 45.1, -50.00000000000044, 45.1, 44.10000000000001, 41.90000000000001, 41.500000000000014, 41.500000000000014, -50.00000000000044, -50.00000000000044, 43.50000000000001, 37.50000000000003, 46.5, -50.00000000000044, 34.30000000000004, 35.30000000000004, -50.00000000000044, 43.50000000000001, 37.300000000000026, 0.49999999999956657, 37.300000000000026, 45.5, 22.299999999999876, 34.900000000000034, -50.00000000000044, -50.00000000000044, 43.50000000000001, 42.30000000000001, 45.3, 37.90000000000003, 35.900000000000034, 44.300000000000004, 39.70000000000002, -50.00000000000044, 14.699999999999768, -50.00000000000044, 46.9, 46.099999999999994, 39.90000000000002, 36.70000000000003, 46.099999999999994, 35.30000000000004, -50.00000000000044, 44.10000000000001, 41.100000000000016, 40.70000000000002, 46.3, 38.10000000000002, 42.10000000000001, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 38.10000000000002, 43.10000000000001], "episode_lengths": [68, 500, 474, 76, 484, 500, 500, 62, 132, 66, 204, 30, 186, 100, 84, 500, 40, 122, 134, 98, 500, 66, 174, 30, 58, 34, 188, 166, 56, 186, 118, 36, 56, 500, 56, 90, 500, 500, 120, 102, 92, 500, 102, 100, 50, 500, 50, 60, 82, 86, 86, 500, 500, 66, 126, 36, 500, 158, 148, 500, 66, 128, 496, 128, 46, 278, 152, 500, 500, 66, 78, 48, 122, 142, 58, 104, 500, 354, 500, 32, 40, 102, 134, 40, 148, 500, 60, 90, 94, 38, 120, 80, 500, 80, 500, 500, 34, 500, 120, 70]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37669779843465323, "mean_inference_ms": 1.2032485237524506, "mean_action_processing_ms": 0.1400832615869896, "mean_env_wait_ms": 0.0838811772394099, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03500556945800781, "StateBufferConnector_ms": 0.002000093460083008, "ViewRequirementAgentConnector_ms": 0.11282801628112793}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000, "num_env_steps_sampled": 1104000, "num_env_steps_trained": 1104000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5237.52136095757, "num_env_steps_trained_throughput_per_sec": 5237.52136095757, "timesteps_total": 1104000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1104000, "timers": {"training_iteration_time_ms": 2277.059, "sample_time_ms": 1913.417, "load_time_ms": 12.966, "load_throughput": 925508.443, "learn_time_ms": 339.478, "learn_throughput": 35348.359, "synch_weights_time_ms": 9.52}, "counters": {"num_env_steps_sampled": 1104000, "num_env_steps_trained": 1104000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "done": false, "episodes_total": 4200, "training_iteration": 92, "trial_id": "9f288_00017", "date": "2023-10-25_17-00-02", "timestamp": 1698249602, "time_this_iter_s": 2.295276403427124, "time_total_s": 209.73759722709656, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 209.73759722709656, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 50.775, "ram_util_percent": 27.25}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.038967834731582e-29, "cur_lr": 0.0003, "total_loss": 6.740973711013794, "policy_loss": -0.00023605376482009887, "vf_loss": 6.741260878245035, "vf_explained_var": -1.0013580322265625e-06, "kl": 0.0005366948599468439, "entropy": 0.5121071964502335, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2775.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1116000, "num_env_steps_trained": 1116000, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.713999999999855, "episode_len_mean": 233.56, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.1, -50.00000000000044, 45.1, 44.10000000000001, 41.90000000000001, 41.500000000000014, 41.500000000000014, -50.00000000000044, -50.00000000000044, 43.50000000000001, 37.50000000000003, 46.5, -50.00000000000044, 34.30000000000004, 35.30000000000004, -50.00000000000044, 43.50000000000001, 37.300000000000026, 0.49999999999956657, 37.300000000000026, 45.5, 22.299999999999876, 34.900000000000034, -50.00000000000044, -50.00000000000044, 43.50000000000001, 42.30000000000001, 45.3, 37.90000000000003, 35.900000000000034, 44.300000000000004, 39.70000000000002, -50.00000000000044, 14.699999999999768, -50.00000000000044, 46.9, 46.099999999999994, 39.90000000000002, 36.70000000000003, 46.099999999999994, 35.30000000000004, -50.00000000000044, 44.10000000000001, 41.100000000000016, 40.70000000000002, 46.3, 38.10000000000002, 42.10000000000001, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 38.10000000000002, 43.10000000000001, -50.00000000000044, 45.1, 32.30000000000002, 6.499999999999652, 40.30000000000002, -50.00000000000044, 27.699999999999953, -50.00000000000044, 24.899999999999913, 44.5, 46.099999999999994, 13.899999999999757, 44.7, 43.900000000000006, 41.500000000000014, 43.7, 46.699999999999996, 21.299999999999862, 31.500000000000007, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.299999999999933, 28.499999999999964, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, 42.70000000000001, 41.30000000000001, -50.00000000000044, 38.90000000000002, 28.29999999999996, 43.900000000000006, 45.7, 44.10000000000001, 39.300000000000026], "episode_lengths": [50, 500, 50, 60, 82, 86, 86, 500, 500, 66, 126, 36, 500, 158, 148, 500, 66, 128, 496, 128, 46, 278, 152, 500, 500, 66, 78, 48, 122, 142, 58, 104, 500, 354, 500, 32, 40, 102, 134, 40, 148, 500, 60, 90, 94, 38, 120, 80, 500, 80, 500, 500, 34, 500, 120, 70, 500, 50, 178, 436, 98, 500, 224, 500, 252, 56, 40, 362, 54, 62, 86, 64, 34, 288, 186, 52, 500, 500, 500, 500, 500, 500, 500, 500, 238, 216, 500, 500, 500, 118, 500, 74, 88, 500, 112, 218, 62, 44, 60, 108]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3764698862013395, "mean_inference_ms": 1.2016328933497413, "mean_action_processing_ms": 0.13971017890897286, "mean_env_wait_ms": 0.08356386994828512, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03099536895751953, "StateBufferConnector_ms": 0.00299835205078125, "ViewRequirementAgentConnector_ms": 0.11388158798217773}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.713999999999855, "episode_len_mean": 233.56, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.1, -50.00000000000044, 45.1, 44.10000000000001, 41.90000000000001, 41.500000000000014, 41.500000000000014, -50.00000000000044, -50.00000000000044, 43.50000000000001, 37.50000000000003, 46.5, -50.00000000000044, 34.30000000000004, 35.30000000000004, -50.00000000000044, 43.50000000000001, 37.300000000000026, 0.49999999999956657, 37.300000000000026, 45.5, 22.299999999999876, 34.900000000000034, -50.00000000000044, -50.00000000000044, 43.50000000000001, 42.30000000000001, 45.3, 37.90000000000003, 35.900000000000034, 44.300000000000004, 39.70000000000002, -50.00000000000044, 14.699999999999768, -50.00000000000044, 46.9, 46.099999999999994, 39.90000000000002, 36.70000000000003, 46.099999999999994, 35.30000000000004, -50.00000000000044, 44.10000000000001, 41.100000000000016, 40.70000000000002, 46.3, 38.10000000000002, 42.10000000000001, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 38.10000000000002, 43.10000000000001, -50.00000000000044, 45.1, 32.30000000000002, 6.499999999999652, 40.30000000000002, -50.00000000000044, 27.699999999999953, -50.00000000000044, 24.899999999999913, 44.5, 46.099999999999994, 13.899999999999757, 44.7, 43.900000000000006, 41.500000000000014, 43.7, 46.699999999999996, 21.299999999999862, 31.500000000000007, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.299999999999933, 28.499999999999964, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, 42.70000000000001, 41.30000000000001, -50.00000000000044, 38.90000000000002, 28.29999999999996, 43.900000000000006, 45.7, 44.10000000000001, 39.300000000000026], "episode_lengths": [50, 500, 50, 60, 82, 86, 86, 500, 500, 66, 126, 36, 500, 158, 148, 500, 66, 128, 496, 128, 46, 278, 152, 500, 500, 66, 78, 48, 122, 142, 58, 104, 500, 354, 500, 32, 40, 102, 134, 40, 148, 500, 60, 90, 94, 38, 120, 80, 500, 80, 500, 500, 34, 500, 120, 70, 500, 50, 178, 436, 98, 500, 224, 500, 252, 56, 40, 362, 54, 62, 86, 64, 34, 288, 186, 52, 500, 500, 500, 500, 500, 500, 500, 500, 238, 216, 500, 500, 500, 118, 500, 74, 88, 500, 112, 218, 62, 44, 60, 108]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3764698862013395, "mean_inference_ms": 1.2016328933497413, "mean_action_processing_ms": 0.13971017890897286, "mean_env_wait_ms": 0.08356386994828512, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03099536895751953, "StateBufferConnector_ms": 0.00299835205078125, "ViewRequirementAgentConnector_ms": 0.11388158798217773}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000, "num_env_steps_sampled": 1116000, "num_env_steps_trained": 1116000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5471.362978098089, "num_env_steps_trained_throughput_per_sec": 5471.362978098089, "timesteps_total": 1116000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1116000, "timers": {"training_iteration_time_ms": 2268.124, "sample_time_ms": 1914.252, "load_time_ms": 11.837, "load_throughput": 1013812.782, "learn_time_ms": 330.973, "learn_throughput": 36256.746, "synch_weights_time_ms": 9.383}, "counters": {"num_env_steps_sampled": 1116000, "num_env_steps_trained": 1116000, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000}, "done": false, "episodes_total": 4244, "training_iteration": 93, "trial_id": "9f288_00017", "date": "2023-10-25_17-00-04", "timestamp": 1698249604, "time_this_iter_s": 2.198232650756836, "time_total_s": 211.9358298778534, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 211.9358298778534, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 60.03333333333333, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.019483917365791e-29, "cur_lr": 0.0003, "total_loss": 7.202661164601644, "policy_loss": 2.0168907940387727e-05, "vf_loss": 7.202693621317546, "vf_explained_var": -9.695688883463541e-07, "kl": 4.116069085284835e-05, "entropy": 0.5259934951861699, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2805.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1128000, "num_env_steps_trained": 1128000, "num_agent_steps_sampled": 1128000, "num_agent_steps_trained": 1128000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.503999999999821, "episode_len_mean": 265.6, "episode_media": {}, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 38.10000000000002, 43.10000000000001, -50.00000000000044, 45.1, 32.30000000000002, 6.499999999999652, 40.30000000000002, -50.00000000000044, 27.699999999999953, -50.00000000000044, 24.899999999999913, 44.5, 46.099999999999994, 13.899999999999757, 44.7, 43.900000000000006, 41.500000000000014, 43.7, 46.699999999999996, 21.299999999999862, 31.500000000000007, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.299999999999933, 28.499999999999964, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, 42.70000000000001, 41.30000000000001, -50.00000000000044, 38.90000000000002, 28.29999999999996, 43.900000000000006, 45.7, 44.10000000000001, 39.300000000000026, -50.00000000000044, 40.30000000000002, 43.30000000000001, 38.700000000000024, 43.7, -50.00000000000044, 41.500000000000014, 45.7, 43.7, -50.00000000000044, -50.00000000000044, 5.299999999999635, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 43.30000000000001, -50.00000000000044, 43.900000000000006, 46.3, 3.0999999999996035, 26.09999999999993, 36.900000000000034, 33.70000000000004, -50.00000000000044, 4.299999999999621, 34.900000000000034, 45.7, -50.00000000000044, 43.50000000000001, 44.7, 23.499999999999893, -50.00000000000044, 22.299999999999876, 47.1, 25.29999999999992, -50.00000000000044, -50.00000000000044, 45.3, 38.50000000000003, -50.00000000000044, -50.00000000000044, 43.900000000000006, 44.5, -50.00000000000044, 42.10000000000001, 36.50000000000003, 36.30000000000003, -50.00000000000044, 45.5], "episode_lengths": [500, 500, 34, 500, 120, 70, 500, 50, 178, 436, 98, 500, 224, 500, 252, 56, 40, 362, 54, 62, 86, 64, 34, 288, 186, 52, 500, 500, 500, 500, 500, 500, 500, 500, 238, 216, 500, 500, 500, 118, 500, 74, 88, 500, 112, 218, 62, 44, 60, 108, 500, 98, 68, 114, 64, 500, 86, 44, 64, 500, 500, 448, 500, 500, 500, 38, 68, 500, 62, 38, 470, 240, 132, 164, 500, 458, 152, 44, 500, 66, 54, 266, 500, 278, 30, 248, 500, 500, 48, 116, 500, 500, 62, 56, 500, 80, 136, 138, 500, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37680339813856234, "mean_inference_ms": 1.201425307318037, "mean_action_processing_ms": 0.13948615356596863, "mean_env_wait_ms": 0.08377282726654861, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022988319396972656, "StateBufferConnector_ms": 0.009001016616821289, "ViewRequirementAgentConnector_ms": 0.0990152359008789}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.503999999999821, "episode_len_mean": 265.6, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 38.10000000000002, 43.10000000000001, -50.00000000000044, 45.1, 32.30000000000002, 6.499999999999652, 40.30000000000002, -50.00000000000044, 27.699999999999953, -50.00000000000044, 24.899999999999913, 44.5, 46.099999999999994, 13.899999999999757, 44.7, 43.900000000000006, 41.500000000000014, 43.7, 46.699999999999996, 21.299999999999862, 31.500000000000007, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.299999999999933, 28.499999999999964, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, 42.70000000000001, 41.30000000000001, -50.00000000000044, 38.90000000000002, 28.29999999999996, 43.900000000000006, 45.7, 44.10000000000001, 39.300000000000026, -50.00000000000044, 40.30000000000002, 43.30000000000001, 38.700000000000024, 43.7, -50.00000000000044, 41.500000000000014, 45.7, 43.7, -50.00000000000044, -50.00000000000044, 5.299999999999635, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 43.30000000000001, -50.00000000000044, 43.900000000000006, 46.3, 3.0999999999996035, 26.09999999999993, 36.900000000000034, 33.70000000000004, -50.00000000000044, 4.299999999999621, 34.900000000000034, 45.7, -50.00000000000044, 43.50000000000001, 44.7, 23.499999999999893, -50.00000000000044, 22.299999999999876, 47.1, 25.29999999999992, -50.00000000000044, -50.00000000000044, 45.3, 38.50000000000003, -50.00000000000044, -50.00000000000044, 43.900000000000006, 44.5, -50.00000000000044, 42.10000000000001, 36.50000000000003, 36.30000000000003, -50.00000000000044, 45.5], "episode_lengths": [500, 500, 34, 500, 120, 70, 500, 50, 178, 436, 98, 500, 224, 500, 252, 56, 40, 362, 54, 62, 86, 64, 34, 288, 186, 52, 500, 500, 500, 500, 500, 500, 500, 500, 238, 216, 500, 500, 500, 118, 500, 74, 88, 500, 112, 218, 62, 44, 60, 108, 500, 98, 68, 114, 64, 500, 86, 44, 64, 500, 500, 448, 500, 500, 500, 38, 68, 500, 62, 38, 470, 240, 132, 164, 500, 458, 152, 44, 500, 66, 54, 266, 500, 278, 30, 248, 500, 500, 48, 116, 500, 500, 62, 56, 500, 80, 136, 138, 500, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37680339813856234, "mean_inference_ms": 1.201425307318037, "mean_action_processing_ms": 0.13948615356596863, "mean_env_wait_ms": 0.08377282726654861, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022988319396972656, "StateBufferConnector_ms": 0.009001016616821289, "ViewRequirementAgentConnector_ms": 0.0990152359008789}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1128000, "num_agent_steps_trained": 1128000, "num_env_steps_sampled": 1128000, "num_env_steps_trained": 1128000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5097.196289508434, "num_env_steps_trained_throughput_per_sec": 5097.196289508434, "timesteps_total": 1128000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1128000, "timers": {"training_iteration_time_ms": 2282.943, "sample_time_ms": 1919.044, "load_time_ms": 12.49, "load_throughput": 960780.664, "learn_time_ms": 340.248, "learn_throughput": 35268.389, "synch_weights_time_ms": 9.382}, "counters": {"num_env_steps_sampled": 1128000, "num_env_steps_trained": 1128000, "num_agent_steps_sampled": 1128000, "num_agent_steps_trained": 1128000}, "done": false, "episodes_total": 4294, "training_iteration": 94, "trial_id": "9f288_00017", "date": "2023-10-25_17-00-07", "timestamp": 1698249607, "time_this_iter_s": 2.358258008956909, "time_total_s": 214.2940878868103, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 214.2940878868103, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 59.833333333333336, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.0097419586828954e-29, "cur_lr": 0.0003, "total_loss": 6.3024438381195065, "policy_loss": -0.0004424884760131439, "vf_loss": 6.302935361862183, "vf_explained_var": -8.980433146158854e-07, "kl": 0.0006708287071712486, "entropy": 0.48950652877489725, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2835.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1140000, "num_env_steps_trained": 1140000, "num_agent_steps_sampled": 1140000, "num_agent_steps_trained": 1140000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.484999999999822, "episode_len_mean": 260.78, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 42.70000000000001, 41.30000000000001, -50.00000000000044, 38.90000000000002, 28.29999999999996, 43.900000000000006, 45.7, 44.10000000000001, 39.300000000000026, -50.00000000000044, 40.30000000000002, 43.30000000000001, 38.700000000000024, 43.7, -50.00000000000044, 41.500000000000014, 45.7, 43.7, -50.00000000000044, -50.00000000000044, 5.299999999999635, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 43.30000000000001, -50.00000000000044, 43.900000000000006, 46.3, 3.0999999999996035, 26.09999999999993, 36.900000000000034, 33.70000000000004, -50.00000000000044, 4.299999999999621, 34.900000000000034, 45.7, -50.00000000000044, 43.50000000000001, 44.7, 23.499999999999893, -50.00000000000044, 22.299999999999876, 47.1, 25.29999999999992, -50.00000000000044, -50.00000000000044, 45.3, 38.50000000000003, -50.00000000000044, -50.00000000000044, 43.900000000000006, 44.5, -50.00000000000044, 42.10000000000001, 36.50000000000003, 36.30000000000003, -50.00000000000044, 45.5, -50.00000000000044, 44.10000000000001, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 18.29999999999982, -50.00000000000044, 43.900000000000006, 31.70000000000001, 39.10000000000002, 42.70000000000001, -50.00000000000044, 44.10000000000001, 46.5, -50.00000000000044, 37.50000000000003, 36.900000000000034, 45.7, -50.00000000000044, 47.1, 46.699999999999996, 39.300000000000026, 46.3, -50.00000000000044, 41.70000000000002, -50.00000000000044, 32.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 11.899999999999729, 38.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 74, 88, 500, 112, 218, 62, 44, 60, 108, 500, 98, 68, 114, 64, 500, 86, 44, 64, 500, 500, 448, 500, 500, 500, 38, 68, 500, 62, 38, 470, 240, 132, 164, 500, 458, 152, 44, 500, 66, 54, 266, 500, 278, 30, 248, 500, 500, 48, 116, 500, 500, 62, 56, 500, 80, 136, 138, 500, 46, 500, 60, 64, 500, 500, 500, 62, 318, 500, 62, 184, 110, 74, 500, 60, 36, 500, 126, 132, 44, 500, 30, 34, 108, 38, 500, 84, 500, 178, 500, 500, 500, 500, 32, 500, 382, 118, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37662491367069706, "mean_inference_ms": 1.201096018627931, "mean_action_processing_ms": 0.1394396592643388, "mean_env_wait_ms": 0.0837205392980957, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023993253707885742, "StateBufferConnector_ms": 0.008000850677490234, "ViewRequirementAgentConnector_ms": 0.10200190544128418}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.484999999999822, "episode_len_mean": 260.78, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 42.70000000000001, 41.30000000000001, -50.00000000000044, 38.90000000000002, 28.29999999999996, 43.900000000000006, 45.7, 44.10000000000001, 39.300000000000026, -50.00000000000044, 40.30000000000002, 43.30000000000001, 38.700000000000024, 43.7, -50.00000000000044, 41.500000000000014, 45.7, 43.7, -50.00000000000044, -50.00000000000044, 5.299999999999635, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 43.30000000000001, -50.00000000000044, 43.900000000000006, 46.3, 3.0999999999996035, 26.09999999999993, 36.900000000000034, 33.70000000000004, -50.00000000000044, 4.299999999999621, 34.900000000000034, 45.7, -50.00000000000044, 43.50000000000001, 44.7, 23.499999999999893, -50.00000000000044, 22.299999999999876, 47.1, 25.29999999999992, -50.00000000000044, -50.00000000000044, 45.3, 38.50000000000003, -50.00000000000044, -50.00000000000044, 43.900000000000006, 44.5, -50.00000000000044, 42.10000000000001, 36.50000000000003, 36.30000000000003, -50.00000000000044, 45.5, -50.00000000000044, 44.10000000000001, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 18.29999999999982, -50.00000000000044, 43.900000000000006, 31.70000000000001, 39.10000000000002, 42.70000000000001, -50.00000000000044, 44.10000000000001, 46.5, -50.00000000000044, 37.50000000000003, 36.900000000000034, 45.7, -50.00000000000044, 47.1, 46.699999999999996, 39.300000000000026, 46.3, -50.00000000000044, 41.70000000000002, -50.00000000000044, 32.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 11.899999999999729, 38.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 74, 88, 500, 112, 218, 62, 44, 60, 108, 500, 98, 68, 114, 64, 500, 86, 44, 64, 500, 500, 448, 500, 500, 500, 38, 68, 500, 62, 38, 470, 240, 132, 164, 500, 458, 152, 44, 500, 66, 54, 266, 500, 278, 30, 248, 500, 500, 48, 116, 500, 500, 62, 56, 500, 80, 136, 138, 500, 46, 500, 60, 64, 500, 500, 500, 62, 318, 500, 62, 184, 110, 74, 500, 60, 36, 500, 126, 132, 44, 500, 30, 34, 108, 38, 500, 84, 500, 178, 500, 500, 500, 500, 32, 500, 382, 118, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37662491367069706, "mean_inference_ms": 1.201096018627931, "mean_action_processing_ms": 0.1394396592643388, "mean_env_wait_ms": 0.0837205392980957, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023993253707885742, "StateBufferConnector_ms": 0.008000850677490234, "ViewRequirementAgentConnector_ms": 0.10200190544128418}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1140000, "num_agent_steps_trained": 1140000, "num_env_steps_sampled": 1140000, "num_env_steps_trained": 1140000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5348.904764450258, "num_env_steps_trained_throughput_per_sec": 5348.904764450258, "timesteps_total": 1140000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1140000, "timers": {"training_iteration_time_ms": 2280.873, "sample_time_ms": 1926.725, "load_time_ms": 11.869, "load_throughput": 1011071.564, "learn_time_ms": 331.162, "learn_throughput": 36236.081, "synch_weights_time_ms": 9.338}, "counters": {"num_env_steps_sampled": 1140000, "num_env_steps_trained": 1140000, "num_agent_steps_sampled": 1140000, "num_agent_steps_trained": 1140000}, "done": false, "episodes_total": 4334, "training_iteration": 95, "trial_id": "9f288_00017", "date": "2023-10-25_17-00-09", "timestamp": 1698249609, "time_this_iter_s": 2.248443365097046, "time_total_s": 216.54253125190735, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 216.54253125190735, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 57.4, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.048709793414477e-30, "cur_lr": 0.0003, "total_loss": 6.883727057774862, "policy_loss": -0.00015211304028828939, "vf_loss": 6.88392809232076, "vf_explained_var": -9.894371032714845e-07, "kl": 0.00035252521352617804, "entropy": 0.4884242683649063, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2865.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1152000, "num_env_steps_trained": 1152000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.615999999999806, "episode_len_mean": 274.44, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [47.1, 25.29999999999992, -50.00000000000044, -50.00000000000044, 45.3, 38.50000000000003, -50.00000000000044, -50.00000000000044, 43.900000000000006, 44.5, -50.00000000000044, 42.10000000000001, 36.50000000000003, 36.30000000000003, -50.00000000000044, 45.5, -50.00000000000044, 44.10000000000001, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 18.29999999999982, -50.00000000000044, 43.900000000000006, 31.70000000000001, 39.10000000000002, 42.70000000000001, -50.00000000000044, 44.10000000000001, 46.5, -50.00000000000044, 37.50000000000003, 36.900000000000034, 45.7, -50.00000000000044, 47.1, 46.699999999999996, 39.300000000000026, 46.3, -50.00000000000044, 41.70000000000002, -50.00000000000044, 32.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 11.899999999999729, 38.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 10.699999999999712, -50.00000000000044, 44.900000000000006, 43.10000000000001, 18.099999999999817, 46.099999999999994, 45.3, 42.500000000000014, -50.00000000000044, -50.00000000000044, 43.30000000000001, 3.499999999999609, 17.69999999999981, 28.09999999999996, 13.699999999999754, 37.90000000000003, 46.099999999999994, 43.7, 14.09999999999976, 45.3, 38.90000000000002, 42.900000000000006, 33.70000000000004, 39.90000000000002, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 42.900000000000006, 42.500000000000014, 23.699999999999896, -50.00000000000044, -50.00000000000044], "episode_lengths": [30, 248, 500, 500, 48, 116, 500, 500, 62, 56, 500, 80, 136, 138, 500, 46, 500, 60, 64, 500, 500, 500, 62, 318, 500, 62, 184, 110, 74, 500, 60, 36, 500, 126, 132, 44, 500, 30, 34, 108, 38, 500, 84, 500, 178, 500, 500, 500, 500, 32, 500, 382, 118, 500, 500, 500, 500, 500, 30, 48, 500, 500, 500, 394, 500, 52, 70, 320, 40, 48, 76, 500, 500, 68, 466, 324, 220, 364, 122, 40, 64, 360, 48, 112, 72, 164, 102, 58, 500, 500, 500, 500, 500, 74, 500, 72, 76, 264, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37649816454856, "mean_inference_ms": 1.201445631987567, "mean_action_processing_ms": 0.13986047231393914, "mean_env_wait_ms": 0.08372668627201277, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029994487762451172, "StateBufferConnector_ms": 0.007000923156738281, "ViewRequirementAgentConnector_ms": 0.11497712135314941}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.615999999999806, "episode_len_mean": 274.44, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [47.1, 25.29999999999992, -50.00000000000044, -50.00000000000044, 45.3, 38.50000000000003, -50.00000000000044, -50.00000000000044, 43.900000000000006, 44.5, -50.00000000000044, 42.10000000000001, 36.50000000000003, 36.30000000000003, -50.00000000000044, 45.5, -50.00000000000044, 44.10000000000001, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 18.29999999999982, -50.00000000000044, 43.900000000000006, 31.70000000000001, 39.10000000000002, 42.70000000000001, -50.00000000000044, 44.10000000000001, 46.5, -50.00000000000044, 37.50000000000003, 36.900000000000034, 45.7, -50.00000000000044, 47.1, 46.699999999999996, 39.300000000000026, 46.3, -50.00000000000044, 41.70000000000002, -50.00000000000044, 32.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 11.899999999999729, 38.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 10.699999999999712, -50.00000000000044, 44.900000000000006, 43.10000000000001, 18.099999999999817, 46.099999999999994, 45.3, 42.500000000000014, -50.00000000000044, -50.00000000000044, 43.30000000000001, 3.499999999999609, 17.69999999999981, 28.09999999999996, 13.699999999999754, 37.90000000000003, 46.099999999999994, 43.7, 14.09999999999976, 45.3, 38.90000000000002, 42.900000000000006, 33.70000000000004, 39.90000000000002, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 42.900000000000006, 42.500000000000014, 23.699999999999896, -50.00000000000044, -50.00000000000044], "episode_lengths": [30, 248, 500, 500, 48, 116, 500, 500, 62, 56, 500, 80, 136, 138, 500, 46, 500, 60, 64, 500, 500, 500, 62, 318, 500, 62, 184, 110, 74, 500, 60, 36, 500, 126, 132, 44, 500, 30, 34, 108, 38, 500, 84, 500, 178, 500, 500, 500, 500, 32, 500, 382, 118, 500, 500, 500, 500, 500, 30, 48, 500, 500, 500, 394, 500, 52, 70, 320, 40, 48, 76, 500, 500, 68, 466, 324, 220, 364, 122, 40, 64, 360, 48, 112, 72, 164, 102, 58, 500, 500, 500, 500, 500, 74, 500, 72, 76, 264, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37649816454856, "mean_inference_ms": 1.201445631987567, "mean_action_processing_ms": 0.13986047231393914, "mean_env_wait_ms": 0.08372668627201277, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029994487762451172, "StateBufferConnector_ms": 0.007000923156738281, "ViewRequirementAgentConnector_ms": 0.11497712135314941}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000, "num_env_steps_sampled": 1152000, "num_env_steps_trained": 1152000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5288.518259921163, "num_env_steps_trained_throughput_per_sec": 5288.518259921163, "timesteps_total": 1152000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1152000, "timers": {"training_iteration_time_ms": 2290.73, "sample_time_ms": 1922.695, "load_time_ms": 12.454, "load_throughput": 963511.946, "learn_time_ms": 344.494, "learn_throughput": 34833.651, "synch_weights_time_ms": 9.407}, "counters": {"num_env_steps_sampled": 1152000, "num_env_steps_trained": 1152000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "done": false, "episodes_total": 4378, "training_iteration": 96, "trial_id": "9f288_00017", "date": "2023-10-25_17-00-11", "timestamp": 1698249611, "time_this_iter_s": 2.274064064025879, "time_total_s": 218.81659531593323, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 218.81659531593323, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 55.0, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.5243548967072386e-30, "cur_lr": 0.0003, "total_loss": 6.3852405230204266, "policy_loss": -0.00040972878535588584, "vf_loss": 6.38570335706075, "vf_explained_var": -9.457270304361979e-07, "kl": 0.0008106476274974739, "entropy": 0.5317399968703588, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2895.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1164000, "num_env_steps_trained": 1164000, "num_agent_steps_sampled": 1164000, "num_agent_steps_trained": 1164000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.2650000000002153, "episode_len_mean": 288.2, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 11.899999999999729, 38.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 10.699999999999712, -50.00000000000044, 44.900000000000006, 43.10000000000001, 18.099999999999817, 46.099999999999994, 45.3, 42.500000000000014, -50.00000000000044, -50.00000000000044, 43.30000000000001, 3.499999999999609, 17.69999999999981, 28.09999999999996, 13.699999999999754, 37.90000000000003, 46.099999999999994, 43.7, 14.09999999999976, 45.3, 38.90000000000002, 42.900000000000006, 33.70000000000004, 39.90000000000002, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 42.900000000000006, 42.500000000000014, 23.699999999999896, -50.00000000000044, -50.00000000000044, 45.7, 44.7, 36.70000000000003, -50.00000000000044, 42.30000000000001, -50.00000000000044, 45.1, 43.10000000000001, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 41.70000000000002, 43.900000000000006, 35.500000000000036, 43.7, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 42.900000000000006, 45.1, -50.00000000000044, -50.00000000000044, 43.30000000000001, 40.30000000000002, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 40.30000000000002, 44.7, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 47.1, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 500, 500, 32, 500, 382, 118, 500, 500, 500, 500, 500, 30, 48, 500, 500, 500, 394, 500, 52, 70, 320, 40, 48, 76, 500, 500, 68, 466, 324, 220, 364, 122, 40, 64, 360, 48, 112, 72, 164, 102, 58, 500, 500, 500, 500, 500, 74, 500, 72, 76, 264, 500, 500, 44, 54, 134, 500, 78, 500, 50, 70, 46, 500, 500, 500, 62, 84, 62, 146, 64, 90, 500, 500, 500, 36, 72, 50, 500, 500, 68, 98, 500, 500, 56, 500, 98, 54, 48, 500, 500, 500, 500, 500, 500, 46, 30, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3762352694765221, "mean_inference_ms": 1.2017051025308734, "mean_action_processing_ms": 0.13968476670921465, "mean_env_wait_ms": 0.08379144368901159, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02698516845703125, "StateBufferConnector_ms": 0.008015632629394531, "ViewRequirementAgentConnector_ms": 0.1271040439605713}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.2650000000002153, "episode_len_mean": 288.2, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 11.899999999999729, 38.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 10.699999999999712, -50.00000000000044, 44.900000000000006, 43.10000000000001, 18.099999999999817, 46.099999999999994, 45.3, 42.500000000000014, -50.00000000000044, -50.00000000000044, 43.30000000000001, 3.499999999999609, 17.69999999999981, 28.09999999999996, 13.699999999999754, 37.90000000000003, 46.099999999999994, 43.7, 14.09999999999976, 45.3, 38.90000000000002, 42.900000000000006, 33.70000000000004, 39.90000000000002, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 42.900000000000006, 42.500000000000014, 23.699999999999896, -50.00000000000044, -50.00000000000044, 45.7, 44.7, 36.70000000000003, -50.00000000000044, 42.30000000000001, -50.00000000000044, 45.1, 43.10000000000001, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 41.70000000000002, 43.900000000000006, 35.500000000000036, 43.7, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 42.900000000000006, 45.1, -50.00000000000044, -50.00000000000044, 43.30000000000001, 40.30000000000002, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 40.30000000000002, 44.7, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 47.1, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 500, 500, 32, 500, 382, 118, 500, 500, 500, 500, 500, 30, 48, 500, 500, 500, 394, 500, 52, 70, 320, 40, 48, 76, 500, 500, 68, 466, 324, 220, 364, 122, 40, 64, 360, 48, 112, 72, 164, 102, 58, 500, 500, 500, 500, 500, 74, 500, 72, 76, 264, 500, 500, 44, 54, 134, 500, 78, 500, 50, 70, 46, 500, 500, 500, 62, 84, 62, 146, 64, 90, 500, 500, 500, 36, 72, 50, 500, 500, 68, 98, 500, 500, 56, 500, 98, 54, 48, 500, 500, 500, 500, 500, 500, 46, 30, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3762352694765221, "mean_inference_ms": 1.2017051025308734, "mean_action_processing_ms": 0.13968476670921465, "mean_env_wait_ms": 0.08379144368901159, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02698516845703125, "StateBufferConnector_ms": 0.008015632629394531, "ViewRequirementAgentConnector_ms": 0.1271040439605713}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1164000, "num_agent_steps_trained": 1164000, "num_env_steps_sampled": 1164000, "num_env_steps_trained": 1164000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5345.83067537521, "num_env_steps_trained_throughput_per_sec": 5345.83067537521, "timesteps_total": 1164000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1164000, "timers": {"training_iteration_time_ms": 2289.995, "sample_time_ms": 1929.092, "load_time_ms": 12.278, "load_throughput": 977334.429, "learn_time_ms": 337.489, "learn_throughput": 35556.746, "synch_weights_time_ms": 9.456}, "counters": {"num_env_steps_sampled": 1164000, "num_env_steps_trained": 1164000, "num_agent_steps_sampled": 1164000, "num_agent_steps_trained": 1164000}, "done": false, "episodes_total": 4423, "training_iteration": 97, "trial_id": "9f288_00017", "date": "2023-10-25_17-00-14", "timestamp": 1698249614, "time_this_iter_s": 2.2497360706329346, "time_total_s": 221.06633138656616, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 221.06633138656616, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 51.575, "ram_util_percent": 27.224999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.2621774483536193e-30, "cur_lr": 0.0003, "total_loss": 6.122870477040609, "policy_loss": -0.000283683929592371, "vf_loss": 6.123200527826945, "vf_explained_var": -1.1046727498372397e-06, "kl": 0.000763720894508424, "entropy": 0.46385855178038277, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2925.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1176000, "num_env_steps_trained": 1176000, "num_agent_steps_sampled": 1176000, "num_agent_steps_trained": 1176000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.4180000000002039, "episode_len_mean": 274.72, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 42.900000000000006, 42.500000000000014, 23.699999999999896, -50.00000000000044, -50.00000000000044, 45.7, 44.7, 36.70000000000003, -50.00000000000044, 42.30000000000001, -50.00000000000044, 45.1, 43.10000000000001, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 41.70000000000002, 43.900000000000006, 35.500000000000036, 43.7, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 42.900000000000006, 45.1, -50.00000000000044, -50.00000000000044, 43.30000000000001, 40.30000000000002, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 40.30000000000002, 44.7, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 41.70000000000002, 45.3, 32.90000000000003, 45.1, 38.700000000000024, 40.70000000000002, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002, -50.00000000000044, -50.00000000000044, 10.299999999999706, 43.7, 43.900000000000006, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 47.3, 46.699999999999996, 46.5, 45.9, 46.099999999999994, 41.70000000000002, 45.1, -50.00000000000044, 45.3, -50.00000000000044, 37.90000000000003, 26.89999999999994, -50.00000000000044, 35.900000000000034, 45.9, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 500, 500, 74, 500, 72, 76, 264, 500, 500, 44, 54, 134, 500, 78, 500, 50, 70, 46, 500, 500, 500, 62, 84, 62, 146, 64, 90, 500, 500, 500, 36, 72, 50, 500, 500, 68, 98, 500, 500, 56, 500, 98, 54, 48, 500, 500, 500, 500, 500, 500, 46, 30, 500, 500, 500, 42, 500, 84, 48, 172, 50, 114, 94, 104, 500, 500, 500, 106, 500, 500, 398, 64, 62, 500, 500, 44, 500, 500, 28, 34, 36, 42, 40, 84, 50, 500, 48, 500, 122, 232, 500, 142, 42, 500, 64, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37639588526691364, "mean_inference_ms": 1.201703728967828, "mean_action_processing_ms": 0.13938213125091373, "mean_env_wait_ms": 0.08375625971538757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02298879623413086, "StateBufferConnector_ms": 0.007017612457275391, "ViewRequirementAgentConnector_ms": 0.1481034755706787}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.4180000000002039, "episode_len_mean": 274.72, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 42.900000000000006, 42.500000000000014, 23.699999999999896, -50.00000000000044, -50.00000000000044, 45.7, 44.7, 36.70000000000003, -50.00000000000044, 42.30000000000001, -50.00000000000044, 45.1, 43.10000000000001, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 41.70000000000002, 43.900000000000006, 35.500000000000036, 43.7, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 42.900000000000006, 45.1, -50.00000000000044, -50.00000000000044, 43.30000000000001, 40.30000000000002, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 40.30000000000002, 44.7, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 41.70000000000002, 45.3, 32.90000000000003, 45.1, 38.700000000000024, 40.70000000000002, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002, -50.00000000000044, -50.00000000000044, 10.299999999999706, 43.7, 43.900000000000006, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 47.3, 46.699999999999996, 46.5, 45.9, 46.099999999999994, 41.70000000000002, 45.1, -50.00000000000044, 45.3, -50.00000000000044, 37.90000000000003, 26.89999999999994, -50.00000000000044, 35.900000000000034, 45.9, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 500, 500, 74, 500, 72, 76, 264, 500, 500, 44, 54, 134, 500, 78, 500, 50, 70, 46, 500, 500, 500, 62, 84, 62, 146, 64, 90, 500, 500, 500, 36, 72, 50, 500, 500, 68, 98, 500, 500, 56, 500, 98, 54, 48, 500, 500, 500, 500, 500, 500, 46, 30, 500, 500, 500, 42, 500, 84, 48, 172, 50, 114, 94, 104, 500, 500, 500, 106, 500, 500, 398, 64, 62, 500, 500, 44, 500, 500, 28, 34, 36, 42, 40, 84, 50, 500, 48, 500, 122, 232, 500, 142, 42, 500, 64, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37639588526691364, "mean_inference_ms": 1.201703728967828, "mean_action_processing_ms": 0.13938213125091373, "mean_env_wait_ms": 0.08375625971538757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02298879623413086, "StateBufferConnector_ms": 0.007017612457275391, "ViewRequirementAgentConnector_ms": 0.1481034755706787}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1176000, "num_agent_steps_trained": 1176000, "num_env_steps_sampled": 1176000, "num_env_steps_trained": 1176000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5245.074735959828, "num_env_steps_trained_throughput_per_sec": 5245.074735959828, "timesteps_total": 1176000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1176000, "timers": {"training_iteration_time_ms": 2265.509, "sample_time_ms": 1898.282, "load_time_ms": 12.146, "load_throughput": 987999.293, "learn_time_ms": 343.845, "learn_throughput": 34899.455, "synch_weights_time_ms": 9.557}, "counters": {"num_env_steps_sampled": 1176000, "num_env_steps_trained": 1176000, "num_agent_steps_sampled": 1176000, "num_agent_steps_trained": 1176000}, "done": false, "episodes_total": 4467, "training_iteration": 98, "trial_id": "9f288_00017", "date": "2023-10-25_17-00-16", "timestamp": 1698249616, "time_this_iter_s": 2.291855812072754, "time_total_s": 223.35818719863892, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 223.35818719863892, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 58.800000000000004, "ram_util_percent": 27.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.3108872417680965e-31, "cur_lr": 0.0003, "total_loss": 6.539803059895833, "policy_loss": -0.00020597949624061583, "vf_loss": 6.540056419372559, "vf_explained_var": -9.258588155110677e-07, "kl": 0.0005405767937493995, "entropy": 0.4742343544960022, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2955.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1188000, "num_env_steps_trained": 1188000, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.0660000000002086, "episode_len_mean": 281.2, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 41.70000000000002, 45.3, 32.90000000000003, 45.1, 38.700000000000024, 40.70000000000002, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002, -50.00000000000044, -50.00000000000044, 10.299999999999706, 43.7, 43.900000000000006, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 47.3, 46.699999999999996, 46.5, 45.9, 46.099999999999994, 41.70000000000002, 45.1, -50.00000000000044, 45.3, -50.00000000000044, 37.90000000000003, 26.89999999999994, -50.00000000000044, 35.900000000000034, 45.9, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.299999999999933, -50.00000000000044, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, 46.3, -50.00000000000044, 16.29999999999979, 40.70000000000002, 37.10000000000003, 45.3, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 36.900000000000034, 46.699999999999996, -50.00000000000044, 46.9, 45.9, 44.300000000000004, 41.500000000000014, 44.7, -50.00000000000044, 23.8999999999999, 18.099999999999817, 45.9, 46.3, -50.00000000000044, -50.00000000000044, 28.89999999999997, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 45.3, -50.00000000000044, 47.1], "episode_lengths": [48, 500, 500, 500, 500, 500, 500, 46, 30, 500, 500, 500, 42, 500, 84, 48, 172, 50, 114, 94, 104, 500, 500, 500, 106, 500, 500, 398, 64, 62, 500, 500, 44, 500, 500, 28, 34, 36, 42, 40, 84, 50, 500, 48, 500, 122, 232, 500, 142, 42, 500, 64, 500, 500, 500, 238, 500, 124, 500, 500, 500, 500, 84, 38, 500, 338, 94, 130, 48, 500, 500, 46, 500, 500, 50, 500, 132, 34, 500, 32, 42, 58, 86, 54, 500, 262, 320, 42, 38, 500, 500, 212, 500, 500, 500, 500, 70, 48, 500, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3763567055517949, "mean_inference_ms": 1.2020686342805134, "mean_action_processing_ms": 0.13956384421677806, "mean_env_wait_ms": 0.08386153137811835, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0190126895904541, "StateBufferConnector_ms": 0.003998517990112305, "ViewRequirementAgentConnector_ms": 0.13592028617858887}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.0660000000002086, "episode_len_mean": 281.2, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 41.70000000000002, 45.3, 32.90000000000003, 45.1, 38.700000000000024, 40.70000000000002, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002, -50.00000000000044, -50.00000000000044, 10.299999999999706, 43.7, 43.900000000000006, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 47.3, 46.699999999999996, 46.5, 45.9, 46.099999999999994, 41.70000000000002, 45.1, -50.00000000000044, 45.3, -50.00000000000044, 37.90000000000003, 26.89999999999994, -50.00000000000044, 35.900000000000034, 45.9, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.299999999999933, -50.00000000000044, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, 46.3, -50.00000000000044, 16.29999999999979, 40.70000000000002, 37.10000000000003, 45.3, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 36.900000000000034, 46.699999999999996, -50.00000000000044, 46.9, 45.9, 44.300000000000004, 41.500000000000014, 44.7, -50.00000000000044, 23.8999999999999, 18.099999999999817, 45.9, 46.3, -50.00000000000044, -50.00000000000044, 28.89999999999997, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 45.3, -50.00000000000044, 47.1], "episode_lengths": [48, 500, 500, 500, 500, 500, 500, 46, 30, 500, 500, 500, 42, 500, 84, 48, 172, 50, 114, 94, 104, 500, 500, 500, 106, 500, 500, 398, 64, 62, 500, 500, 44, 500, 500, 28, 34, 36, 42, 40, 84, 50, 500, 48, 500, 122, 232, 500, 142, 42, 500, 64, 500, 500, 500, 238, 500, 124, 500, 500, 500, 500, 84, 38, 500, 338, 94, 130, 48, 500, 500, 46, 500, 500, 50, 500, 132, 34, 500, 32, 42, 58, 86, 54, 500, 262, 320, 42, 38, 500, 500, 212, 500, 500, 500, 500, 70, 48, 500, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3763567055517949, "mean_inference_ms": 1.2020686342805134, "mean_action_processing_ms": 0.13956384421677806, "mean_env_wait_ms": 0.08386153137811835, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0190126895904541, "StateBufferConnector_ms": 0.003998517990112305, "ViewRequirementAgentConnector_ms": 0.13592028617858887}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000, "num_env_steps_sampled": 1188000, "num_env_steps_trained": 1188000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5330.0434215407395, "num_env_steps_trained_throughput_per_sec": 5330.0434215407395, "timesteps_total": 1188000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1188000, "timers": {"training_iteration_time_ms": 2269.134, "sample_time_ms": 1904.004, "load_time_ms": 11.721, "load_throughput": 1023812.534, "learn_time_ms": 342.316, "learn_throughput": 35055.338, "synch_weights_time_ms": 9.513}, "counters": {"num_env_steps_sampled": 1188000, "num_env_steps_trained": 1188000, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000}, "done": false, "episodes_total": 4512, "training_iteration": 99, "trial_id": "9f288_00017", "date": "2023-10-25_17-00-18", "timestamp": 1698249618, "time_this_iter_s": 2.256446599960327, "time_total_s": 225.61463379859924, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 225.61463379859924, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 58.03333333333334, "ram_util_percent": 27.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.1554436208840483e-31, "cur_lr": 0.0003, "total_loss": 6.099365091323852, "policy_loss": -0.0004654043664534887, "vf_loss": 6.0998749256134035, "vf_explained_var": -8.304913838704427e-07, "kl": 0.0008010246216940686, "entropy": 0.44401977956295013, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2985.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1200000, "num_env_steps_trained": 1200000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.7989999999998165, "episode_len_mean": 257.62, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.900000000000034, 45.9, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.299999999999933, -50.00000000000044, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, 46.3, -50.00000000000044, 16.29999999999979, 40.70000000000002, 37.10000000000003, 45.3, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 36.900000000000034, 46.699999999999996, -50.00000000000044, 46.9, 45.9, 44.300000000000004, 41.500000000000014, 44.7, -50.00000000000044, 23.8999999999999, 18.099999999999817, 45.9, 46.3, -50.00000000000044, -50.00000000000044, 28.89999999999997, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 45.3, -50.00000000000044, 47.1, 29.299999999999976, -50.00000000000044, 44.5, 44.900000000000006, 46.3, 46.3, 47.3, 37.10000000000003, -50.00000000000044, 41.100000000000016, -50.00000000000044, 45.3, 46.3, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.900000000000034, 47.5, -50.00000000000044, 40.10000000000002, 3.899999999999615, -50.00000000000044, 27.899999999999956, -50.00000000000044, 36.10000000000004, 20.49999999999985, 42.70000000000001, 44.7, 42.900000000000006, 46.699999999999996, 46.9, -50.00000000000044, 45.3, 45.7, 46.099999999999994, 46.3, -50.00000000000044, 41.70000000000002, 13.299999999999748, 39.10000000000002, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 36.30000000000003, 46.9], "episode_lengths": [142, 42, 500, 64, 500, 500, 500, 238, 500, 124, 500, 500, 500, 500, 84, 38, 500, 338, 94, 130, 48, 500, 500, 46, 500, 500, 50, 500, 132, 34, 500, 32, 42, 58, 86, 54, 500, 262, 320, 42, 38, 500, 500, 212, 500, 500, 500, 500, 70, 48, 500, 30, 208, 500, 56, 52, 38, 38, 28, 130, 500, 90, 500, 48, 38, 32, 500, 500, 500, 152, 26, 500, 100, 462, 500, 222, 500, 140, 296, 74, 54, 72, 34, 32, 500, 48, 44, 40, 38, 500, 84, 368, 110, 500, 500, 40, 500, 500, 138, 32]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37618352286943013, "mean_inference_ms": 1.2016754555522058, "mean_action_processing_ms": 0.13958411841078924, "mean_env_wait_ms": 0.08376936415908481, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018016338348388672, "StateBufferConnector_ms": 0.0030045509338378906, "ViewRequirementAgentConnector_ms": 0.13467097282409668}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.7989999999998165, "episode_len_mean": 257.62, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [35.900000000000034, 45.9, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.299999999999933, -50.00000000000044, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, 46.3, -50.00000000000044, 16.29999999999979, 40.70000000000002, 37.10000000000003, 45.3, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 36.900000000000034, 46.699999999999996, -50.00000000000044, 46.9, 45.9, 44.300000000000004, 41.500000000000014, 44.7, -50.00000000000044, 23.8999999999999, 18.099999999999817, 45.9, 46.3, -50.00000000000044, -50.00000000000044, 28.89999999999997, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 45.3, -50.00000000000044, 47.1, 29.299999999999976, -50.00000000000044, 44.5, 44.900000000000006, 46.3, 46.3, 47.3, 37.10000000000003, -50.00000000000044, 41.100000000000016, -50.00000000000044, 45.3, 46.3, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.900000000000034, 47.5, -50.00000000000044, 40.10000000000002, 3.899999999999615, -50.00000000000044, 27.899999999999956, -50.00000000000044, 36.10000000000004, 20.49999999999985, 42.70000000000001, 44.7, 42.900000000000006, 46.699999999999996, 46.9, -50.00000000000044, 45.3, 45.7, 46.099999999999994, 46.3, -50.00000000000044, 41.70000000000002, 13.299999999999748, 39.10000000000002, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 36.30000000000003, 46.9], "episode_lengths": [142, 42, 500, 64, 500, 500, 500, 238, 500, 124, 500, 500, 500, 500, 84, 38, 500, 338, 94, 130, 48, 500, 500, 46, 500, 500, 50, 500, 132, 34, 500, 32, 42, 58, 86, 54, 500, 262, 320, 42, 38, 500, 500, 212, 500, 500, 500, 500, 70, 48, 500, 30, 208, 500, 56, 52, 38, 38, 28, 130, 500, 90, 500, 48, 38, 32, 500, 500, 500, 152, 26, 500, 100, 462, 500, 222, 500, 140, 296, 74, 54, 72, 34, 32, 500, 48, 44, 40, 38, 500, 84, 368, 110, 500, 500, 40, 500, 500, 138, 32]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37618352286943013, "mean_inference_ms": 1.2016754555522058, "mean_action_processing_ms": 0.13958411841078924, "mean_env_wait_ms": 0.08376936415908481, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018016338348388672, "StateBufferConnector_ms": 0.0030045509338378906, "ViewRequirementAgentConnector_ms": 0.13467097282409668}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000, "num_env_steps_sampled": 1200000, "num_env_steps_trained": 1200000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5106.677982902878, "num_env_steps_trained_throughput_per_sec": 5106.677982902878, "timesteps_total": 1200000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1200000, "timers": {"training_iteration_time_ms": 2272.391, "sample_time_ms": 1907.005, "load_time_ms": 11.421, "load_throughput": 1050710.255, "learn_time_ms": 342.95, "learn_throughput": 34990.498, "synch_weights_time_ms": 9.434}, "counters": {"num_env_steps_sampled": 1200000, "num_env_steps_trained": 1200000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "done": false, "episodes_total": 4560, "training_iteration": 100, "trial_id": "9f288_00017", "date": "2023-10-25_17-00-21", "timestamp": 1698249621, "time_this_iter_s": 2.3548848628997803, "time_total_s": 227.96951866149902, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 227.96951866149902, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 59.833333333333336, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.5777218104420241e-31, "cur_lr": 0.0003, "total_loss": 6.176799456278483, "policy_loss": -0.0004895376662413279, "vf_loss": 6.177331511179606, "vf_explained_var": -9.57647959391276e-07, "kl": 0.0007519344244845646, "entropy": 0.4248668243487676, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 3015.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1212000, "num_env_steps_trained": 1212000, "num_agent_steps_sampled": 1212000, "num_agent_steps_trained": 1212000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.569999999999796, "episode_len_mean": 274.88, "episode_media": {}, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.099999999999817, 45.9, 46.3, -50.00000000000044, -50.00000000000044, 28.89999999999997, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 45.3, -50.00000000000044, 47.1, 29.299999999999976, -50.00000000000044, 44.5, 44.900000000000006, 46.3, 46.3, 47.3, 37.10000000000003, -50.00000000000044, 41.100000000000016, -50.00000000000044, 45.3, 46.3, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.900000000000034, 47.5, -50.00000000000044, 40.10000000000002, 3.899999999999615, -50.00000000000044, 27.899999999999956, -50.00000000000044, 36.10000000000004, 20.49999999999985, 42.70000000000001, 44.7, 42.900000000000006, 46.699999999999996, 46.9, -50.00000000000044, 45.3, 45.7, 46.099999999999994, 46.3, -50.00000000000044, 41.70000000000002, 13.299999999999748, 39.10000000000002, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 36.30000000000003, 46.9, -50.00000000000044, 46.3, 42.900000000000006, -50.00000000000044, -50.00000000000044, 8.899999999999686, -50.00000000000044, -50.00000000000044, 21.699999999999868, -50.00000000000044, 16.09999999999979, 43.900000000000006, 47.1, 44.5, 45.1, 26.299999999999933, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 45.3, -50.00000000000044, 11.099999999999717, -50.00000000000044, 45.1, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, 45.7], "episode_lengths": [320, 42, 38, 500, 500, 212, 500, 500, 500, 500, 70, 48, 500, 30, 208, 500, 56, 52, 38, 38, 28, 130, 500, 90, 500, 48, 38, 32, 500, 500, 500, 152, 26, 500, 100, 462, 500, 222, 500, 140, 296, 74, 54, 72, 34, 32, 500, 48, 44, 40, 38, 500, 84, 368, 110, 500, 500, 40, 500, 500, 138, 32, 500, 38, 72, 500, 500, 412, 500, 500, 284, 500, 340, 62, 30, 56, 50, 238, 46, 500, 500, 500, 500, 500, 500, 60, 48, 500, 390, 500, 50, 500, 30, 500, 500, 500, 500, 500, 114, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37638764656791696, "mean_inference_ms": 1.2015405876990861, "mean_action_processing_ms": 0.13951404868754136, "mean_env_wait_ms": 0.08370219760763728, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01801753044128418, "StateBufferConnector_ms": 0.006006956100463867, "ViewRequirementAgentConnector_ms": 0.1346902847290039}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.569999999999796, "episode_len_mean": 274.88, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [18.099999999999817, 45.9, 46.3, -50.00000000000044, -50.00000000000044, 28.89999999999997, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 45.3, -50.00000000000044, 47.1, 29.299999999999976, -50.00000000000044, 44.5, 44.900000000000006, 46.3, 46.3, 47.3, 37.10000000000003, -50.00000000000044, 41.100000000000016, -50.00000000000044, 45.3, 46.3, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.900000000000034, 47.5, -50.00000000000044, 40.10000000000002, 3.899999999999615, -50.00000000000044, 27.899999999999956, -50.00000000000044, 36.10000000000004, 20.49999999999985, 42.70000000000001, 44.7, 42.900000000000006, 46.699999999999996, 46.9, -50.00000000000044, 45.3, 45.7, 46.099999999999994, 46.3, -50.00000000000044, 41.70000000000002, 13.299999999999748, 39.10000000000002, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 36.30000000000003, 46.9, -50.00000000000044, 46.3, 42.900000000000006, -50.00000000000044, -50.00000000000044, 8.899999999999686, -50.00000000000044, -50.00000000000044, 21.699999999999868, -50.00000000000044, 16.09999999999979, 43.900000000000006, 47.1, 44.5, 45.1, 26.299999999999933, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 45.3, -50.00000000000044, 11.099999999999717, -50.00000000000044, 45.1, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, 45.7], "episode_lengths": [320, 42, 38, 500, 500, 212, 500, 500, 500, 500, 70, 48, 500, 30, 208, 500, 56, 52, 38, 38, 28, 130, 500, 90, 500, 48, 38, 32, 500, 500, 500, 152, 26, 500, 100, 462, 500, 222, 500, 140, 296, 74, 54, 72, 34, 32, 500, 48, 44, 40, 38, 500, 84, 368, 110, 500, 500, 40, 500, 500, 138, 32, 500, 38, 72, 500, 500, 412, 500, 500, 284, 500, 340, 62, 30, 56, 50, 238, 46, 500, 500, 500, 500, 500, 500, 60, 48, 500, 390, 500, 50, 500, 30, 500, 500, 500, 500, 500, 114, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37638764656791696, "mean_inference_ms": 1.2015405876990861, "mean_action_processing_ms": 0.13951404868754136, "mean_env_wait_ms": 0.08370219760763728, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01801753044128418, "StateBufferConnector_ms": 0.006006956100463867, "ViewRequirementAgentConnector_ms": 0.1346902847290039}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1212000, "num_agent_steps_trained": 1212000, "num_env_steps_sampled": 1212000, "num_env_steps_trained": 1212000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5568.754215429934, "num_env_steps_trained_throughput_per_sec": 5568.754215429934, "timesteps_total": 1212000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1212000, "timers": {"training_iteration_time_ms": 2263.889, "sample_time_ms": 1910.371, "load_time_ms": 11.114, "load_throughput": 1079705.252, "learn_time_ms": 331.482, "learn_throughput": 36201.024, "synch_weights_time_ms": 9.437}, "counters": {"num_env_steps_sampled": 1212000, "num_env_steps_trained": 1212000, "num_agent_steps_sampled": 1212000, "num_agent_steps_trained": 1212000}, "done": false, "episodes_total": 4598, "training_iteration": 101, "trial_id": "9f288_00017", "date": "2023-10-25_17-00-23", "timestamp": 1698249623, "time_this_iter_s": 2.1598777770996094, "time_total_s": 230.12939643859863, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 230.12939643859863, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 53.56666666666666, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.888609052210121e-32, "cur_lr": 0.0003, "total_loss": 6.605353275934855, "policy_loss": -0.0004115966459115346, "vf_loss": 6.605812613169352, "vf_explained_var": -1.0132789611816406e-06, "kl": 0.0007651444023281329, "entropy": 0.4777298947175344, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 3045.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1224000, "num_env_steps_trained": 1224000, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.9920000000002183, "episode_len_mean": 290.46, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.3, 45.7, 46.099999999999994, 46.3, -50.00000000000044, 41.70000000000002, 13.299999999999748, 39.10000000000002, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 36.30000000000003, 46.9, -50.00000000000044, 46.3, 42.900000000000006, -50.00000000000044, -50.00000000000044, 8.899999999999686, -50.00000000000044, -50.00000000000044, 21.699999999999868, -50.00000000000044, 16.09999999999979, 43.900000000000006, 47.1, 44.5, 45.1, 26.299999999999933, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 45.3, -50.00000000000044, 11.099999999999717, -50.00000000000044, 45.1, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, 45.7, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 30.499999999999993, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 46.099999999999994, 46.5, 44.900000000000006, 27.899999999999956, 38.300000000000026, -50.00000000000044, 42.900000000000006, 42.900000000000006, 42.500000000000014, -50.00000000000044, -50.00000000000044, 44.900000000000006, 44.7, 47.5, -50.00000000000044, 29.099999999999973, -50.00000000000044, 38.700000000000024, -50.00000000000044, 45.1, -50.00000000000044, 46.9, 8.299999999999677, 41.100000000000016, -50.00000000000044, 30.099999999999987, 44.300000000000004, 41.90000000000001, -50.00000000000044, 23.8999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 40.90000000000002], "episode_lengths": [500, 48, 44, 40, 38, 500, 84, 368, 110, 500, 500, 40, 500, 500, 138, 32, 500, 38, 72, 500, 500, 412, 500, 500, 284, 500, 340, 62, 30, 56, 50, 238, 46, 500, 500, 500, 500, 500, 500, 60, 48, 500, 390, 500, 50, 500, 30, 500, 500, 500, 500, 500, 114, 44, 500, 500, 46, 500, 196, 500, 500, 500, 30, 500, 40, 36, 52, 222, 118, 500, 72, 72, 76, 500, 500, 52, 54, 26, 500, 210, 500, 114, 500, 50, 500, 32, 418, 90, 500, 200, 58, 82, 500, 262, 500, 500, 500, 500, 40, 92]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37641702088719886, "mean_inference_ms": 1.201530773335098, "mean_action_processing_ms": 0.13963926172950228, "mean_env_wait_ms": 0.08358144688399724, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019997119903564453, "StateBufferConnector_ms": 0.006001710891723633, "ViewRequirementAgentConnector_ms": 0.11552023887634277}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.9920000000002183, "episode_len_mean": 290.46, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.3, 45.7, 46.099999999999994, 46.3, -50.00000000000044, 41.70000000000002, 13.299999999999748, 39.10000000000002, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 36.30000000000003, 46.9, -50.00000000000044, 46.3, 42.900000000000006, -50.00000000000044, -50.00000000000044, 8.899999999999686, -50.00000000000044, -50.00000000000044, 21.699999999999868, -50.00000000000044, 16.09999999999979, 43.900000000000006, 47.1, 44.5, 45.1, 26.299999999999933, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 45.3, -50.00000000000044, 11.099999999999717, -50.00000000000044, 45.1, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, 45.7, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 30.499999999999993, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 46.099999999999994, 46.5, 44.900000000000006, 27.899999999999956, 38.300000000000026, -50.00000000000044, 42.900000000000006, 42.900000000000006, 42.500000000000014, -50.00000000000044, -50.00000000000044, 44.900000000000006, 44.7, 47.5, -50.00000000000044, 29.099999999999973, -50.00000000000044, 38.700000000000024, -50.00000000000044, 45.1, -50.00000000000044, 46.9, 8.299999999999677, 41.100000000000016, -50.00000000000044, 30.099999999999987, 44.300000000000004, 41.90000000000001, -50.00000000000044, 23.8999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 40.90000000000002], "episode_lengths": [500, 48, 44, 40, 38, 500, 84, 368, 110, 500, 500, 40, 500, 500, 138, 32, 500, 38, 72, 500, 500, 412, 500, 500, 284, 500, 340, 62, 30, 56, 50, 238, 46, 500, 500, 500, 500, 500, 500, 60, 48, 500, 390, 500, 50, 500, 30, 500, 500, 500, 500, 500, 114, 44, 500, 500, 46, 500, 196, 500, 500, 500, 30, 500, 40, 36, 52, 222, 118, 500, 72, 72, 76, 500, 500, 52, 54, 26, 500, 210, 500, 114, 500, 50, 500, 32, 418, 90, 500, 200, 58, 82, 500, 262, 500, 500, 500, 500, 40, 92]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37641702088719886, "mean_inference_ms": 1.201530773335098, "mean_action_processing_ms": 0.13963926172950228, "mean_env_wait_ms": 0.08358144688399724, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019997119903564453, "StateBufferConnector_ms": 0.006001710891723633, "ViewRequirementAgentConnector_ms": 0.11552023887634277}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000, "num_env_steps_sampled": 1224000, "num_env_steps_trained": 1224000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5411.112036884235, "num_env_steps_trained_throughput_per_sec": 5411.112036884235, "timesteps_total": 1224000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1224000, "timers": {"training_iteration_time_ms": 2256.638, "sample_time_ms": 1910.301, "load_time_ms": 10.614, "load_throughput": 1130537.622, "learn_time_ms": 324.846, "learn_throughput": 36940.637, "synch_weights_time_ms": 9.394}, "counters": {"num_env_steps_sampled": 1224000, "num_env_steps_trained": 1224000, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000}, "done": false, "episodes_total": 4644, "training_iteration": 102, "trial_id": "9f288_00017", "date": "2023-10-25_17-00-25", "timestamp": 1698249625, "time_this_iter_s": 2.2226760387420654, "time_total_s": 232.3520724773407, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 232.3520724773407, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 57.199999999999996, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.9443045261050603e-32, "cur_lr": 0.0003, "total_loss": 6.77379674911499, "policy_loss": -0.000512455931554238, "vf_loss": 6.774359782536824, "vf_explained_var": -1.0251998901367187e-06, "kl": 0.0011803869920034534, "entropy": 0.5058128505945205, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 3075.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1236000, "num_env_steps_trained": 1236000, "num_agent_steps_sampled": 1236000, "num_agent_steps_trained": 1236000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.871999999999819, "episode_len_mean": 261.9, "episode_media": {}, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, 45.7, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 30.499999999999993, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 46.099999999999994, 46.5, 44.900000000000006, 27.899999999999956, 38.300000000000026, -50.00000000000044, 42.900000000000006, 42.900000000000006, 42.500000000000014, -50.00000000000044, -50.00000000000044, 44.900000000000006, 44.7, 47.5, -50.00000000000044, 29.099999999999973, -50.00000000000044, 38.700000000000024, -50.00000000000044, 45.1, -50.00000000000044, 46.9, 8.299999999999677, 41.100000000000016, -50.00000000000044, 30.099999999999987, 44.300000000000004, 41.90000000000001, -50.00000000000044, 23.8999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 40.90000000000002, -50.00000000000044, 44.7, 12.69999999999974, 47.3, 45.5, 38.50000000000003, -50.00000000000044, -50.00000000000044, 42.70000000000001, 17.499999999999808, 28.09999999999996, -50.00000000000044, 44.10000000000001, 45.7, 38.50000000000003, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 42.30000000000001, 46.9, 39.90000000000002, 42.30000000000001, 3.2999999999996064, 42.500000000000014, 43.30000000000001, 44.10000000000001, 46.099999999999994, 47.7, -50.00000000000044, 31.70000000000001, 46.099999999999994, 13.299999999999748, -50.00000000000044, -50.00000000000044, 39.10000000000002, 45.1, -50.00000000000044, 18.699999999999825, -50.00000000000044, 40.10000000000002, 43.50000000000001, -50.00000000000044, 46.5, -50.00000000000044, 27.099999999999945, 40.90000000000002, 31.70000000000001, -50.00000000000044], "episode_lengths": [500, 500, 500, 114, 44, 500, 500, 46, 500, 196, 500, 500, 500, 30, 500, 40, 36, 52, 222, 118, 500, 72, 72, 76, 500, 500, 52, 54, 26, 500, 210, 500, 114, 500, 50, 500, 32, 418, 90, 500, 200, 58, 82, 500, 262, 500, 500, 500, 500, 40, 92, 500, 54, 374, 28, 46, 116, 500, 500, 74, 326, 220, 500, 60, 44, 116, 500, 34, 500, 500, 78, 32, 102, 78, 468, 76, 68, 60, 40, 24, 500, 184, 40, 368, 500, 500, 110, 50, 500, 314, 500, 100, 66, 500, 36, 500, 230, 92, 184, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3761518758948049, "mean_inference_ms": 1.2000427143409396, "mean_action_processing_ms": 0.1393436627982844, "mean_env_wait_ms": 0.08341883850082944, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025994062423706055, "StateBufferConnector_ms": 0.006003618240356445, "ViewRequirementAgentConnector_ms": 0.10497403144836426}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.871999999999819, "episode_len_mean": 261.9, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, 45.7, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 30.499999999999993, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 46.099999999999994, 46.5, 44.900000000000006, 27.899999999999956, 38.300000000000026, -50.00000000000044, 42.900000000000006, 42.900000000000006, 42.500000000000014, -50.00000000000044, -50.00000000000044, 44.900000000000006, 44.7, 47.5, -50.00000000000044, 29.099999999999973, -50.00000000000044, 38.700000000000024, -50.00000000000044, 45.1, -50.00000000000044, 46.9, 8.299999999999677, 41.100000000000016, -50.00000000000044, 30.099999999999987, 44.300000000000004, 41.90000000000001, -50.00000000000044, 23.8999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 40.90000000000002, -50.00000000000044, 44.7, 12.69999999999974, 47.3, 45.5, 38.50000000000003, -50.00000000000044, -50.00000000000044, 42.70000000000001, 17.499999999999808, 28.09999999999996, -50.00000000000044, 44.10000000000001, 45.7, 38.50000000000003, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 42.30000000000001, 46.9, 39.90000000000002, 42.30000000000001, 3.2999999999996064, 42.500000000000014, 43.30000000000001, 44.10000000000001, 46.099999999999994, 47.7, -50.00000000000044, 31.70000000000001, 46.099999999999994, 13.299999999999748, -50.00000000000044, -50.00000000000044, 39.10000000000002, 45.1, -50.00000000000044, 18.699999999999825, -50.00000000000044, 40.10000000000002, 43.50000000000001, -50.00000000000044, 46.5, -50.00000000000044, 27.099999999999945, 40.90000000000002, 31.70000000000001, -50.00000000000044], "episode_lengths": [500, 500, 500, 114, 44, 500, 500, 46, 500, 196, 500, 500, 500, 30, 500, 40, 36, 52, 222, 118, 500, 72, 72, 76, 500, 500, 52, 54, 26, 500, 210, 500, 114, 500, 50, 500, 32, 418, 90, 500, 200, 58, 82, 500, 262, 500, 500, 500, 500, 40, 92, 500, 54, 374, 28, 46, 116, 500, 500, 74, 326, 220, 500, 60, 44, 116, 500, 34, 500, 500, 78, 32, 102, 78, 468, 76, 68, 60, 40, 24, 500, 184, 40, 368, 500, 500, 110, 50, 500, 314, 500, 100, 66, 500, 36, 500, 230, 92, 184, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3761518758948049, "mean_inference_ms": 1.2000427143409396, "mean_action_processing_ms": 0.1393436627982844, "mean_env_wait_ms": 0.08341883850082944, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025994062423706055, "StateBufferConnector_ms": 0.006003618240356445, "ViewRequirementAgentConnector_ms": 0.10497403144836426}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1236000, "num_agent_steps_trained": 1236000, "num_env_steps_sampled": 1236000, "num_env_steps_trained": 1236000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5144.821839416488, "num_env_steps_trained_throughput_per_sec": 5144.821839416488, "timesteps_total": 1236000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1236000, "timers": {"training_iteration_time_ms": 2270.559, "sample_time_ms": 1914.05, "load_time_ms": 11.769, "load_throughput": 1019658.072, "learn_time_ms": 333.787, "learn_throughput": 35951.046, "synch_weights_time_ms": 9.371}, "counters": {"num_env_steps_sampled": 1236000, "num_env_steps_trained": 1236000, "num_agent_steps_sampled": 1236000, "num_agent_steps_trained": 1236000}, "done": false, "episodes_total": 4693, "training_iteration": 103, "trial_id": "9f288_00017", "date": "2023-10-25_17-00-27", "timestamp": 1698249627, "time_this_iter_s": 2.337994337081909, "time_total_s": 234.6900668144226, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 234.6900668144226, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 52.22500000000001, "ram_util_percent": 27.224999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.9721522630525302e-32, "cur_lr": 0.0003, "total_loss": 7.228176752726237, "policy_loss": -0.0003636388729015986, "vf_loss": 7.2285881519317625, "vf_explained_var": -8.980433146158854e-07, "kl": 0.0008635317754018009, "entropy": 0.47764783998330435, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 3105.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1248000, "num_env_steps_trained": 1248000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.493999999999824, "episode_len_mean": 255.74, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 40.90000000000002, -50.00000000000044, 44.7, 12.69999999999974, 47.3, 45.5, 38.50000000000003, -50.00000000000044, -50.00000000000044, 42.70000000000001, 17.499999999999808, 28.09999999999996, -50.00000000000044, 44.10000000000001, 45.7, 38.50000000000003, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 42.30000000000001, 46.9, 39.90000000000002, 42.30000000000001, 3.2999999999996064, 42.500000000000014, 43.30000000000001, 44.10000000000001, 46.099999999999994, 47.7, -50.00000000000044, 31.70000000000001, 46.099999999999994, 13.299999999999748, -50.00000000000044, -50.00000000000044, 39.10000000000002, 45.1, -50.00000000000044, 18.699999999999825, -50.00000000000044, 40.10000000000002, 43.50000000000001, -50.00000000000044, 46.5, -50.00000000000044, 27.099999999999945, 40.90000000000002, 31.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 21.89999999999987, 42.70000000000001, 44.300000000000004, 41.70000000000002, 46.9, 42.70000000000001, 41.30000000000001, -50.00000000000044, 42.70000000000001, 39.10000000000002, -50.00000000000044, 46.3, 43.7, -50.00000000000044, 2.699999999999598, 5.499999999999638, 44.10000000000001, 39.50000000000002, 44.7, 17.899999999999814, -50.00000000000044, 47.1, 46.699999999999996, -50.00000000000044, 36.70000000000003, 44.900000000000006, -50.00000000000044, 39.10000000000002, 3.699999999999612, 13.699999999999754, -50.00000000000044, -50.00000000000044, 44.10000000000001, 45.7, 20.899999999999856, -50.00000000000044, 16.499999999999794, -50.00000000000044, 40.90000000000002, 41.100000000000016, -50.00000000000044, 21.89999999999987, -50.00000000000044, 17.499999999999808], "episode_lengths": [500, 500, 500, 40, 92, 500, 54, 374, 28, 46, 116, 500, 500, 74, 326, 220, 500, 60, 44, 116, 500, 34, 500, 500, 78, 32, 102, 78, 468, 76, 68, 60, 40, 24, 500, 184, 40, 368, 500, 500, 110, 50, 500, 314, 500, 100, 66, 500, 36, 500, 230, 92, 184, 500, 500, 500, 282, 74, 58, 84, 32, 74, 88, 500, 74, 110, 500, 38, 64, 500, 474, 446, 60, 106, 54, 322, 500, 30, 34, 500, 134, 52, 500, 110, 464, 364, 500, 500, 60, 44, 292, 500, 336, 500, 92, 90, 500, 282, 500, 326]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37611586199571206, "mean_inference_ms": 1.1999217985171875, "mean_action_processing_ms": 0.1391941485885254, "mean_env_wait_ms": 0.08339468920876116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023990869522094727, "StateBufferConnector_ms": 0.009021759033203125, "ViewRequirementAgentConnector_ms": 0.11498546600341797}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.493999999999824, "episode_len_mean": 255.74, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 40.90000000000002, -50.00000000000044, 44.7, 12.69999999999974, 47.3, 45.5, 38.50000000000003, -50.00000000000044, -50.00000000000044, 42.70000000000001, 17.499999999999808, 28.09999999999996, -50.00000000000044, 44.10000000000001, 45.7, 38.50000000000003, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 42.30000000000001, 46.9, 39.90000000000002, 42.30000000000001, 3.2999999999996064, 42.500000000000014, 43.30000000000001, 44.10000000000001, 46.099999999999994, 47.7, -50.00000000000044, 31.70000000000001, 46.099999999999994, 13.299999999999748, -50.00000000000044, -50.00000000000044, 39.10000000000002, 45.1, -50.00000000000044, 18.699999999999825, -50.00000000000044, 40.10000000000002, 43.50000000000001, -50.00000000000044, 46.5, -50.00000000000044, 27.099999999999945, 40.90000000000002, 31.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 21.89999999999987, 42.70000000000001, 44.300000000000004, 41.70000000000002, 46.9, 42.70000000000001, 41.30000000000001, -50.00000000000044, 42.70000000000001, 39.10000000000002, -50.00000000000044, 46.3, 43.7, -50.00000000000044, 2.699999999999598, 5.499999999999638, 44.10000000000001, 39.50000000000002, 44.7, 17.899999999999814, -50.00000000000044, 47.1, 46.699999999999996, -50.00000000000044, 36.70000000000003, 44.900000000000006, -50.00000000000044, 39.10000000000002, 3.699999999999612, 13.699999999999754, -50.00000000000044, -50.00000000000044, 44.10000000000001, 45.7, 20.899999999999856, -50.00000000000044, 16.499999999999794, -50.00000000000044, 40.90000000000002, 41.100000000000016, -50.00000000000044, 21.89999999999987, -50.00000000000044, 17.499999999999808], "episode_lengths": [500, 500, 500, 40, 92, 500, 54, 374, 28, 46, 116, 500, 500, 74, 326, 220, 500, 60, 44, 116, 500, 34, 500, 500, 78, 32, 102, 78, 468, 76, 68, 60, 40, 24, 500, 184, 40, 368, 500, 500, 110, 50, 500, 314, 500, 100, 66, 500, 36, 500, 230, 92, 184, 500, 500, 500, 282, 74, 58, 84, 32, 74, 88, 500, 74, 110, 500, 38, 64, 500, 474, 446, 60, 106, 54, 322, 500, 30, 34, 500, 134, 52, 500, 110, 464, 364, 500, 500, 60, 44, 292, 500, 336, 500, 92, 90, 500, 282, 500, 326]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37611586199571206, "mean_inference_ms": 1.1999217985171875, "mean_action_processing_ms": 0.1391941485885254, "mean_env_wait_ms": 0.08339468920876116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023990869522094727, "StateBufferConnector_ms": 0.009021759033203125, "ViewRequirementAgentConnector_ms": 0.11498546600341797}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000, "num_env_steps_sampled": 1248000, "num_env_steps_trained": 1248000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5537.45227225594, "num_env_steps_trained_throughput_per_sec": 5537.45227225594, "timesteps_total": 1248000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1248000, "timers": {"training_iteration_time_ms": 2251.841, "sample_time_ms": 1909.259, "load_time_ms": 10.905, "load_throughput": 1100441.168, "learn_time_ms": 320.725, "learn_throughput": 37415.202, "synch_weights_time_ms": 9.272}, "counters": {"num_env_steps_sampled": 1248000, "num_env_steps_trained": 1248000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "done": false, "episodes_total": 4739, "training_iteration": 104, "trial_id": "9f288_00017", "date": "2023-10-25_17-00-30", "timestamp": 1698249630, "time_this_iter_s": 2.1720633506774902, "time_total_s": 236.8621301651001, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 236.8621301651001, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 57.29999999999999, "ram_util_percent": 27.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.860761315262651e-33, "cur_lr": 0.0003, "total_loss": 6.626164738337199, "policy_loss": -0.0005590992048382759, "vf_loss": 6.626776170730591, "vf_explained_var": -1.0331471761067708e-06, "kl": 0.0014099524573415085, "entropy": 0.5221404065688451, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 3135.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1260000, "num_env_steps_trained": 1260000, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.17299999999983, "episode_len_mean": 253.96, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.5, -50.00000000000044, 27.099999999999945, 40.90000000000002, 31.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 21.89999999999987, 42.70000000000001, 44.300000000000004, 41.70000000000002, 46.9, 42.70000000000001, 41.30000000000001, -50.00000000000044, 42.70000000000001, 39.10000000000002, -50.00000000000044, 46.3, 43.7, -50.00000000000044, 2.699999999999598, 5.499999999999638, 44.10000000000001, 39.50000000000002, 44.7, 17.899999999999814, -50.00000000000044, 47.1, 46.699999999999996, -50.00000000000044, 36.70000000000003, 44.900000000000006, -50.00000000000044, 39.10000000000002, 3.699999999999612, 13.699999999999754, -50.00000000000044, -50.00000000000044, 44.10000000000001, 45.7, 20.899999999999856, -50.00000000000044, 16.499999999999794, -50.00000000000044, 40.90000000000002, 41.100000000000016, -50.00000000000044, 21.89999999999987, -50.00000000000044, 17.499999999999808, 11.499999999999723, 44.10000000000001, -50.00000000000044, 43.900000000000006, -50.00000000000044, 15.299999999999777, 32.700000000000024, 46.699999999999996, 43.30000000000001, 46.099999999999994, -50.00000000000044, 37.50000000000003, 20.899999999999856, -50.00000000000044, 45.5, 26.299999999999933, 28.89999999999997, 45.3, 45.5, 45.5, 37.10000000000003, -50.00000000000044, 40.500000000000014, 32.100000000000016, 33.500000000000036, -50.00000000000044, 46.3, 46.3, 22.699999999999882, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 42.500000000000014, 38.90000000000002, 11.699999999999726, 43.10000000000001, 42.70000000000001, 43.30000000000001, -50.00000000000044, 46.699999999999996, -50.00000000000044, 38.50000000000003, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044], "episode_lengths": [500, 36, 500, 230, 92, 184, 500, 500, 500, 282, 74, 58, 84, 32, 74, 88, 500, 74, 110, 500, 38, 64, 500, 474, 446, 60, 106, 54, 322, 500, 30, 34, 500, 134, 52, 500, 110, 464, 364, 500, 500, 60, 44, 292, 500, 336, 500, 92, 90, 500, 282, 500, 326, 386, 60, 500, 62, 500, 348, 174, 34, 68, 40, 500, 126, 292, 500, 46, 238, 212, 48, 46, 46, 130, 500, 96, 180, 166, 500, 38, 38, 274, 500, 64, 500, 500, 76, 112, 384, 70, 74, 68, 500, 34, 500, 116, 500, 500, 58, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3762103705402865, "mean_inference_ms": 1.200235706444822, "mean_action_processing_ms": 0.13932067342246468, "mean_env_wait_ms": 0.08336738798379241, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023995637893676758, "StateBufferConnector_ms": 0.007019996643066406, "ViewRequirementAgentConnector_ms": 0.13297557830810547}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.17299999999983, "episode_len_mean": 253.96, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.5, -50.00000000000044, 27.099999999999945, 40.90000000000002, 31.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 21.89999999999987, 42.70000000000001, 44.300000000000004, 41.70000000000002, 46.9, 42.70000000000001, 41.30000000000001, -50.00000000000044, 42.70000000000001, 39.10000000000002, -50.00000000000044, 46.3, 43.7, -50.00000000000044, 2.699999999999598, 5.499999999999638, 44.10000000000001, 39.50000000000002, 44.7, 17.899999999999814, -50.00000000000044, 47.1, 46.699999999999996, -50.00000000000044, 36.70000000000003, 44.900000000000006, -50.00000000000044, 39.10000000000002, 3.699999999999612, 13.699999999999754, -50.00000000000044, -50.00000000000044, 44.10000000000001, 45.7, 20.899999999999856, -50.00000000000044, 16.499999999999794, -50.00000000000044, 40.90000000000002, 41.100000000000016, -50.00000000000044, 21.89999999999987, -50.00000000000044, 17.499999999999808, 11.499999999999723, 44.10000000000001, -50.00000000000044, 43.900000000000006, -50.00000000000044, 15.299999999999777, 32.700000000000024, 46.699999999999996, 43.30000000000001, 46.099999999999994, -50.00000000000044, 37.50000000000003, 20.899999999999856, -50.00000000000044, 45.5, 26.299999999999933, 28.89999999999997, 45.3, 45.5, 45.5, 37.10000000000003, -50.00000000000044, 40.500000000000014, 32.100000000000016, 33.500000000000036, -50.00000000000044, 46.3, 46.3, 22.699999999999882, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 42.500000000000014, 38.90000000000002, 11.699999999999726, 43.10000000000001, 42.70000000000001, 43.30000000000001, -50.00000000000044, 46.699999999999996, -50.00000000000044, 38.50000000000003, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044], "episode_lengths": [500, 36, 500, 230, 92, 184, 500, 500, 500, 282, 74, 58, 84, 32, 74, 88, 500, 74, 110, 500, 38, 64, 500, 474, 446, 60, 106, 54, 322, 500, 30, 34, 500, 134, 52, 500, 110, 464, 364, 500, 500, 60, 44, 292, 500, 336, 500, 92, 90, 500, 282, 500, 326, 386, 60, 500, 62, 500, 348, 174, 34, 68, 40, 500, 126, 292, 500, 46, 238, 212, 48, 46, 46, 130, 500, 96, 180, 166, 500, 38, 38, 274, 500, 64, 500, 500, 76, 112, 384, 70, 74, 68, 500, 34, 500, 116, 500, 500, 58, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3762103705402865, "mean_inference_ms": 1.200235706444822, "mean_action_processing_ms": 0.13932067342246468, "mean_env_wait_ms": 0.08336738798379241, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023995637893676758, "StateBufferConnector_ms": 0.007019996643066406, "ViewRequirementAgentConnector_ms": 0.13297557830810547}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000, "num_env_steps_sampled": 1260000, "num_env_steps_trained": 1260000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5192.295146265662, "num_env_steps_trained_throughput_per_sec": 5192.295146265662, "timesteps_total": 1260000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1260000, "timers": {"training_iteration_time_ms": 2258.608, "sample_time_ms": 1910.651, "load_time_ms": 11.234, "load_throughput": 1068201.986, "learn_time_ms": 325.507, "learn_throughput": 36865.61, "synch_weights_time_ms": 9.437}, "counters": {"num_env_steps_sampled": 1260000, "num_env_steps_trained": 1260000, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000}, "done": false, "episodes_total": 4786, "training_iteration": 105, "trial_id": "9f288_00017", "date": "2023-10-25_17-00-32", "timestamp": 1698249632, "time_this_iter_s": 2.3161139488220215, "time_total_s": 239.17824411392212, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 239.17824411392212, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 59.53333333333333, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.9303806576313254e-33, "cur_lr": 0.0003, "total_loss": 6.4006765206654865, "policy_loss": -0.0004915861102441947, "vf_loss": 6.401217842102051, "vf_explained_var": -1.0132789611816406e-06, "kl": 0.0010234207933156843, "entropy": 0.4973255624373754, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 3165.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1272000, "num_env_steps_trained": 1272000, "num_agent_steps_sampled": 1272000, "num_agent_steps_trained": 1272000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.502999999999823, "episode_len_mean": 260.6, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.499999999999794, -50.00000000000044, 40.90000000000002, 41.100000000000016, -50.00000000000044, 21.89999999999987, -50.00000000000044, 17.499999999999808, 11.499999999999723, 44.10000000000001, -50.00000000000044, 43.900000000000006, -50.00000000000044, 15.299999999999777, 32.700000000000024, 46.699999999999996, 43.30000000000001, 46.099999999999994, -50.00000000000044, 37.50000000000003, 20.899999999999856, -50.00000000000044, 45.5, 26.299999999999933, 28.89999999999997, 45.3, 45.5, 45.5, 37.10000000000003, -50.00000000000044, 40.500000000000014, 32.100000000000016, 33.500000000000036, -50.00000000000044, 46.3, 46.3, 22.699999999999882, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 42.500000000000014, 38.90000000000002, 11.699999999999726, 43.10000000000001, 42.70000000000001, 43.30000000000001, -50.00000000000044, 46.699999999999996, -50.00000000000044, 38.50000000000003, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 25.29999999999992, -50.00000000000044, 43.7, 44.900000000000006, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 37.90000000000003, 47.5, -50.00000000000044, -50.00000000000044, 40.90000000000002, 43.900000000000006, 43.7, 36.10000000000004, -50.00000000000044, -50.00000000000044, 31.500000000000007, 45.9, 46.9, 23.699999999999896, -50.00000000000044, 35.70000000000003, -50.00000000000044, 42.70000000000001, 45.9, 33.500000000000036, 40.500000000000014, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 42.500000000000014, 47.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5], "episode_lengths": [336, 500, 92, 90, 500, 282, 500, 326, 386, 60, 500, 62, 500, 348, 174, 34, 68, 40, 500, 126, 292, 500, 46, 238, 212, 48, 46, 46, 130, 500, 96, 180, 166, 500, 38, 38, 274, 500, 64, 500, 500, 76, 112, 384, 70, 74, 68, 500, 34, 500, 116, 500, 500, 58, 500, 248, 500, 64, 52, 52, 500, 500, 500, 38, 122, 26, 500, 500, 92, 62, 64, 140, 500, 500, 186, 42, 32, 264, 500, 144, 500, 74, 42, 166, 96, 34, 500, 500, 500, 500, 500, 56, 500, 76, 22, 500, 500, 500, 500, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3761178398035617, "mean_inference_ms": 1.1998376206253447, "mean_action_processing_ms": 0.13949199536923326, "mean_env_wait_ms": 0.08348631860857053, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02500128746032715, "StateBufferConnector_ms": 0.00099945068359375, "ViewRequirementAgentConnector_ms": 0.11899471282958984}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.502999999999823, "episode_len_mean": 260.6, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [16.499999999999794, -50.00000000000044, 40.90000000000002, 41.100000000000016, -50.00000000000044, 21.89999999999987, -50.00000000000044, 17.499999999999808, 11.499999999999723, 44.10000000000001, -50.00000000000044, 43.900000000000006, -50.00000000000044, 15.299999999999777, 32.700000000000024, 46.699999999999996, 43.30000000000001, 46.099999999999994, -50.00000000000044, 37.50000000000003, 20.899999999999856, -50.00000000000044, 45.5, 26.299999999999933, 28.89999999999997, 45.3, 45.5, 45.5, 37.10000000000003, -50.00000000000044, 40.500000000000014, 32.100000000000016, 33.500000000000036, -50.00000000000044, 46.3, 46.3, 22.699999999999882, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 42.500000000000014, 38.90000000000002, 11.699999999999726, 43.10000000000001, 42.70000000000001, 43.30000000000001, -50.00000000000044, 46.699999999999996, -50.00000000000044, 38.50000000000003, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 25.29999999999992, -50.00000000000044, 43.7, 44.900000000000006, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 37.90000000000003, 47.5, -50.00000000000044, -50.00000000000044, 40.90000000000002, 43.900000000000006, 43.7, 36.10000000000004, -50.00000000000044, -50.00000000000044, 31.500000000000007, 45.9, 46.9, 23.699999999999896, -50.00000000000044, 35.70000000000003, -50.00000000000044, 42.70000000000001, 45.9, 33.500000000000036, 40.500000000000014, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 42.500000000000014, 47.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5], "episode_lengths": [336, 500, 92, 90, 500, 282, 500, 326, 386, 60, 500, 62, 500, 348, 174, 34, 68, 40, 500, 126, 292, 500, 46, 238, 212, 48, 46, 46, 130, 500, 96, 180, 166, 500, 38, 38, 274, 500, 64, 500, 500, 76, 112, 384, 70, 74, 68, 500, 34, 500, 116, 500, 500, 58, 500, 248, 500, 64, 52, 52, 500, 500, 500, 38, 122, 26, 500, 500, 92, 62, 64, 140, 500, 500, 186, 42, 32, 264, 500, 144, 500, 74, 42, 166, 96, 34, 500, 500, 500, 500, 500, 56, 500, 76, 22, 500, 500, 500, 500, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3761178398035617, "mean_inference_ms": 1.1998376206253447, "mean_action_processing_ms": 0.13949199536923326, "mean_env_wait_ms": 0.08348631860857053, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02500128746032715, "StateBufferConnector_ms": 0.00099945068359375, "ViewRequirementAgentConnector_ms": 0.11899471282958984}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1272000, "num_agent_steps_trained": 1272000, "num_env_steps_sampled": 1272000, "num_env_steps_trained": 1272000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5439.911321432571, "num_env_steps_trained_throughput_per_sec": 5439.911321432571, "timesteps_total": 1272000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1272000, "timers": {"training_iteration_time_ms": 2252.293, "sample_time_ms": 1914.305, "load_time_ms": 10.749, "load_throughput": 1116392.173, "learn_time_ms": 315.925, "learn_throughput": 37983.739, "synch_weights_time_ms": 9.534}, "counters": {"num_env_steps_sampled": 1272000, "num_env_steps_trained": 1272000, "num_agent_steps_sampled": 1272000, "num_agent_steps_trained": 1272000}, "done": false, "episodes_total": 4831, "training_iteration": 106, "trial_id": "9f288_00017", "date": "2023-10-25_17-00-34", "timestamp": 1698249634, "time_this_iter_s": 2.2107396125793457, "time_total_s": 241.38898372650146, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 241.38898372650146, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 57.599999999999994, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.4651903288156627e-33, "cur_lr": 0.0003, "total_loss": 6.698901700973511, "policy_loss": -0.00039077332864205044, "vf_loss": 6.6993464152018225, "vf_explained_var": -9.973843892415365e-07, "kl": 0.0007732427056794222, "entropy": 0.5392600347598394, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 3195.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1284000, "num_env_steps_trained": 1284000, "num_agent_steps_sampled": 1284000, "num_agent_steps_trained": 1284000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.13799999999980223, "episode_len_mean": 279.18, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.699999999999726, 43.10000000000001, 42.70000000000001, 43.30000000000001, -50.00000000000044, 46.699999999999996, -50.00000000000044, 38.50000000000003, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 25.29999999999992, -50.00000000000044, 43.7, 44.900000000000006, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 37.90000000000003, 47.5, -50.00000000000044, -50.00000000000044, 40.90000000000002, 43.900000000000006, 43.7, 36.10000000000004, -50.00000000000044, -50.00000000000044, 31.500000000000007, 45.9, 46.9, 23.699999999999896, -50.00000000000044, 35.70000000000003, -50.00000000000044, 42.70000000000001, 45.9, 33.500000000000036, 40.500000000000014, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 42.500000000000014, 47.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 43.7, -50.00000000000044, 24.099999999999902, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 41.70000000000002, 40.90000000000002, 43.7, 26.299999999999933, -50.00000000000044, 41.90000000000001, -50.00000000000044, 42.10000000000001, -50.00000000000044, 22.899999999999885, -50.00000000000044, 44.7, 29.49999999999998, 44.7, -50.00000000000044, -50.00000000000044, 42.10000000000001, 38.10000000000002, -50.00000000000044, -50.00000000000044, 26.299999999999933, -50.00000000000044, 42.30000000000001, 33.10000000000003, 44.300000000000004, 37.50000000000003, -50.00000000000044, 29.49999999999998, 37.70000000000003, -50.00000000000044, 45.3], "episode_lengths": [384, 70, 74, 68, 500, 34, 500, 116, 500, 500, 58, 500, 248, 500, 64, 52, 52, 500, 500, 500, 38, 122, 26, 500, 500, 92, 62, 64, 140, 500, 500, 186, 42, 32, 264, 500, 144, 500, 74, 42, 166, 96, 34, 500, 500, 500, 500, 500, 56, 500, 76, 22, 500, 500, 500, 500, 36, 500, 64, 500, 260, 500, 34, 500, 500, 500, 500, 500, 52, 84, 92, 64, 238, 500, 82, 500, 80, 500, 272, 500, 54, 206, 54, 500, 500, 80, 120, 500, 500, 238, 500, 78, 170, 58, 126, 500, 206, 124, 500, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3763896714076529, "mean_inference_ms": 1.2003100600449712, "mean_action_processing_ms": 0.13947700297664156, "mean_env_wait_ms": 0.08362794799524444, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0240020751953125, "StateBufferConnector_ms": 0.0040018558502197266, "ViewRequirementAgentConnector_ms": 0.10800480842590332}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.13799999999980223, "episode_len_mean": 279.18, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [11.699999999999726, 43.10000000000001, 42.70000000000001, 43.30000000000001, -50.00000000000044, 46.699999999999996, -50.00000000000044, 38.50000000000003, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 25.29999999999992, -50.00000000000044, 43.7, 44.900000000000006, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 37.90000000000003, 47.5, -50.00000000000044, -50.00000000000044, 40.90000000000002, 43.900000000000006, 43.7, 36.10000000000004, -50.00000000000044, -50.00000000000044, 31.500000000000007, 45.9, 46.9, 23.699999999999896, -50.00000000000044, 35.70000000000003, -50.00000000000044, 42.70000000000001, 45.9, 33.500000000000036, 40.500000000000014, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 42.500000000000014, 47.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 43.7, -50.00000000000044, 24.099999999999902, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 41.70000000000002, 40.90000000000002, 43.7, 26.299999999999933, -50.00000000000044, 41.90000000000001, -50.00000000000044, 42.10000000000001, -50.00000000000044, 22.899999999999885, -50.00000000000044, 44.7, 29.49999999999998, 44.7, -50.00000000000044, -50.00000000000044, 42.10000000000001, 38.10000000000002, -50.00000000000044, -50.00000000000044, 26.299999999999933, -50.00000000000044, 42.30000000000001, 33.10000000000003, 44.300000000000004, 37.50000000000003, -50.00000000000044, 29.49999999999998, 37.70000000000003, -50.00000000000044, 45.3], "episode_lengths": [384, 70, 74, 68, 500, 34, 500, 116, 500, 500, 58, 500, 248, 500, 64, 52, 52, 500, 500, 500, 38, 122, 26, 500, 500, 92, 62, 64, 140, 500, 500, 186, 42, 32, 264, 500, 144, 500, 74, 42, 166, 96, 34, 500, 500, 500, 500, 500, 56, 500, 76, 22, 500, 500, 500, 500, 36, 500, 64, 500, 260, 500, 34, 500, 500, 500, 500, 500, 52, 84, 92, 64, 238, 500, 82, 500, 80, 500, 272, 500, 54, 206, 54, 500, 500, 80, 120, 500, 500, 238, 500, 78, 170, 58, 126, 500, 206, 124, 500, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3763896714076529, "mean_inference_ms": 1.2003100600449712, "mean_action_processing_ms": 0.13947700297664156, "mean_env_wait_ms": 0.08362794799524444, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0240020751953125, "StateBufferConnector_ms": 0.0040018558502197266, "ViewRequirementAgentConnector_ms": 0.10800480842590332}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1284000, "num_agent_steps_trained": 1284000, "num_env_steps_sampled": 1284000, "num_env_steps_trained": 1284000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5176.7076559075995, "num_env_steps_trained_throughput_per_sec": 5176.7076559075995, "timesteps_total": 1284000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1284000, "timers": {"training_iteration_time_ms": 2259.627, "sample_time_ms": 1908.684, "load_time_ms": 11.242, "load_throughput": 1067458.903, "learn_time_ms": 328.472, "learn_throughput": 36532.747, "synch_weights_time_ms": 9.349}, "counters": {"num_env_steps_sampled": 1284000, "num_env_steps_trained": 1284000, "num_agent_steps_sampled": 1284000, "num_agent_steps_trained": 1284000}, "done": false, "episodes_total": 4874, "training_iteration": 107, "trial_id": "9f288_00017", "date": "2023-10-25_17-00-37", "timestamp": 1698249637, "time_this_iter_s": 2.3230700492858887, "time_total_s": 243.71205377578735, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 243.71205377578735, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 56.800000000000004, "ram_util_percent": 27.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.2325951644078314e-33, "cur_lr": 0.0003, "total_loss": 6.5268412113189695, "policy_loss": -0.00024587583417693776, "vf_loss": 6.5271394888559975, "vf_explained_var": -1.0569890340169271e-06, "kl": 0.001012537206117751, "entropy": 0.5231379648049672, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 3225.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1296000, "num_env_steps_trained": 1296000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.03999999999980588, "episode_len_mean": 280.16, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 42.500000000000014, 47.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 43.7, -50.00000000000044, 24.099999999999902, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 41.70000000000002, 40.90000000000002, 43.7, 26.299999999999933, -50.00000000000044, 41.90000000000001, -50.00000000000044, 42.10000000000001, -50.00000000000044, 22.899999999999885, -50.00000000000044, 44.7, 29.49999999999998, 44.7, -50.00000000000044, -50.00000000000044, 42.10000000000001, 38.10000000000002, -50.00000000000044, -50.00000000000044, 26.299999999999933, -50.00000000000044, 42.30000000000001, 33.10000000000003, 44.300000000000004, 37.50000000000003, -50.00000000000044, 29.49999999999998, 37.70000000000003, -50.00000000000044, 45.3, 38.300000000000026, 44.300000000000004, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, 43.900000000000006, 43.50000000000001, 44.300000000000004, 32.90000000000003, -50.00000000000044, -50.00000000000044, 36.10000000000004, 40.90000000000002, -50.00000000000044, -50.00000000000044, 42.500000000000014, 45.5, 42.10000000000001, 42.900000000000006, 43.10000000000001, 28.499999999999964, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 46.3, 23.29999999999989, -50.00000000000044, -50.00000000000044, 33.30000000000003, 30.099999999999987, 39.10000000000002, 39.50000000000002, -50.00000000000044, 44.5, -50.00000000000044, 36.10000000000004, -50.00000000000044, -50.00000000000044, 43.900000000000006, 32.30000000000002, 42.10000000000001, 46.3], "episode_lengths": [500, 500, 56, 500, 76, 22, 500, 500, 500, 500, 36, 500, 64, 500, 260, 500, 34, 500, 500, 500, 500, 500, 52, 84, 92, 64, 238, 500, 82, 500, 80, 500, 272, 500, 54, 206, 54, 500, 500, 80, 120, 500, 500, 238, 500, 78, 170, 58, 126, 500, 206, 124, 500, 48, 118, 58, 500, 102, 500, 500, 62, 66, 58, 172, 500, 500, 140, 92, 500, 500, 76, 46, 80, 72, 70, 216, 500, 500, 500, 70, 500, 500, 38, 268, 500, 500, 168, 200, 110, 106, 500, 56, 500, 140, 500, 500, 62, 178, 80, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3764165052520675, "mean_inference_ms": 1.1999462599686468, "mean_action_processing_ms": 0.1390859946477911, "mean_env_wait_ms": 0.08351299781477264, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01899886131286621, "StateBufferConnector_ms": 0.008003473281860352, "ViewRequirementAgentConnector_ms": 0.11281514167785645}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.03999999999980588, "episode_len_mean": 280.16, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 42.500000000000014, 47.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 43.7, -50.00000000000044, 24.099999999999902, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 41.70000000000002, 40.90000000000002, 43.7, 26.299999999999933, -50.00000000000044, 41.90000000000001, -50.00000000000044, 42.10000000000001, -50.00000000000044, 22.899999999999885, -50.00000000000044, 44.7, 29.49999999999998, 44.7, -50.00000000000044, -50.00000000000044, 42.10000000000001, 38.10000000000002, -50.00000000000044, -50.00000000000044, 26.299999999999933, -50.00000000000044, 42.30000000000001, 33.10000000000003, 44.300000000000004, 37.50000000000003, -50.00000000000044, 29.49999999999998, 37.70000000000003, -50.00000000000044, 45.3, 38.300000000000026, 44.300000000000004, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, 43.900000000000006, 43.50000000000001, 44.300000000000004, 32.90000000000003, -50.00000000000044, -50.00000000000044, 36.10000000000004, 40.90000000000002, -50.00000000000044, -50.00000000000044, 42.500000000000014, 45.5, 42.10000000000001, 42.900000000000006, 43.10000000000001, 28.499999999999964, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 46.3, 23.29999999999989, -50.00000000000044, -50.00000000000044, 33.30000000000003, 30.099999999999987, 39.10000000000002, 39.50000000000002, -50.00000000000044, 44.5, -50.00000000000044, 36.10000000000004, -50.00000000000044, -50.00000000000044, 43.900000000000006, 32.30000000000002, 42.10000000000001, 46.3], "episode_lengths": [500, 500, 56, 500, 76, 22, 500, 500, 500, 500, 36, 500, 64, 500, 260, 500, 34, 500, 500, 500, 500, 500, 52, 84, 92, 64, 238, 500, 82, 500, 80, 500, 272, 500, 54, 206, 54, 500, 500, 80, 120, 500, 500, 238, 500, 78, 170, 58, 126, 500, 206, 124, 500, 48, 118, 58, 500, 102, 500, 500, 62, 66, 58, 172, 500, 500, 140, 92, 500, 500, 76, 46, 80, 72, 70, 216, 500, 500, 500, 70, 500, 500, 38, 268, 500, 500, 168, 200, 110, 106, 500, 56, 500, 140, 500, 500, 62, 178, 80, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3764165052520675, "mean_inference_ms": 1.1999462599686468, "mean_action_processing_ms": 0.1390859946477911, "mean_env_wait_ms": 0.08351299781477264, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01899886131286621, "StateBufferConnector_ms": 0.008003473281860352, "ViewRequirementAgentConnector_ms": 0.11281514167785645}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000, "num_env_steps_sampled": 1296000, "num_env_steps_trained": 1296000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5083.794307508477, "num_env_steps_trained_throughput_per_sec": 5083.794307508477, "timesteps_total": 1296000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1296000, "timers": {"training_iteration_time_ms": 2266.885, "sample_time_ms": 1913.572, "load_time_ms": 11.203, "load_throughput": 1071111.745, "learn_time_ms": 330.899, "learn_throughput": 36264.832, "synch_weights_time_ms": 9.43}, "counters": {"num_env_steps_sampled": 1296000, "num_env_steps_trained": 1296000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "done": false, "episodes_total": 4920, "training_iteration": 108, "trial_id": "9f288_00017", "date": "2023-10-25_17-00-39", "timestamp": 1698249639, "time_this_iter_s": 2.36543607711792, "time_total_s": 246.07748985290527, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 246.07748985290527, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 50.89999999999999, "ram_util_percent": 27.25}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.162975822039157e-34, "cur_lr": 0.0003, "total_loss": 6.287002229690552, "policy_loss": -0.0009780658408999443, "vf_loss": 6.288031721115113, "vf_explained_var": -1.0172526041666667e-06, "kl": 0.0015294415086027394, "entropy": 0.51425954302152, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 3255.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1308000, "num_env_steps_trained": 1308000, "num_agent_steps_sampled": 1308000, "num_agent_steps_trained": 1308000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.340999999999818, "episode_len_mean": 272.18, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 26.299999999999933, -50.00000000000044, 42.30000000000001, 33.10000000000003, 44.300000000000004, 37.50000000000003, -50.00000000000044, 29.49999999999998, 37.70000000000003, -50.00000000000044, 45.3, 38.300000000000026, 44.300000000000004, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, 43.900000000000006, 43.50000000000001, 44.300000000000004, 32.90000000000003, -50.00000000000044, -50.00000000000044, 36.10000000000004, 40.90000000000002, -50.00000000000044, -50.00000000000044, 42.500000000000014, 45.5, 42.10000000000001, 42.900000000000006, 43.10000000000001, 28.499999999999964, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 46.3, 23.29999999999989, -50.00000000000044, -50.00000000000044, 33.30000000000003, 30.099999999999987, 39.10000000000002, 39.50000000000002, -50.00000000000044, 44.5, -50.00000000000044, 36.10000000000004, -50.00000000000044, -50.00000000000044, 43.900000000000006, 32.30000000000002, 42.10000000000001, 46.3, -50.00000000000044, -50.00000000000044, 42.10000000000001, 43.7, -50.00000000000044, -50.00000000000044, 29.099999999999973, -50.00000000000044, 43.50000000000001, 44.5, -50.00000000000044, 25.29999999999992, 36.900000000000034, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 22.899999999999885, -50.00000000000044, 45.1, -50.00000000000044, 42.10000000000001, 45.9, 43.50000000000001, 44.5, -50.00000000000044, -50.00000000000044, 31.900000000000013, -50.00000000000044, 26.299999999999933, 34.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 46.3, 29.299999999999976, 25.099999999999916, 45.3, 41.70000000000002], "episode_lengths": [500, 500, 238, 500, 78, 170, 58, 126, 500, 206, 124, 500, 48, 118, 58, 500, 102, 500, 500, 62, 66, 58, 172, 500, 500, 140, 92, 500, 500, 76, 46, 80, 72, 70, 216, 500, 500, 500, 70, 500, 500, 38, 268, 500, 500, 168, 200, 110, 106, 500, 56, 500, 140, 500, 500, 62, 178, 80, 38, 500, 500, 80, 64, 500, 500, 210, 500, 66, 56, 500, 248, 132, 76, 500, 500, 500, 272, 500, 50, 500, 80, 42, 66, 56, 500, 500, 182, 500, 238, 152, 500, 500, 500, 30, 500, 38, 208, 250, 48, 84]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37634377698914606, "mean_inference_ms": 1.200292555370661, "mean_action_processing_ms": 0.13902834818524773, "mean_env_wait_ms": 0.08361338427285492, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015824556350708008, "StateBufferConnector_ms": 0.008002758026123047, "ViewRequirementAgentConnector_ms": 0.13156604766845703}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.340999999999818, "episode_len_mean": 272.18, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 26.299999999999933, -50.00000000000044, 42.30000000000001, 33.10000000000003, 44.300000000000004, 37.50000000000003, -50.00000000000044, 29.49999999999998, 37.70000000000003, -50.00000000000044, 45.3, 38.300000000000026, 44.300000000000004, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, 43.900000000000006, 43.50000000000001, 44.300000000000004, 32.90000000000003, -50.00000000000044, -50.00000000000044, 36.10000000000004, 40.90000000000002, -50.00000000000044, -50.00000000000044, 42.500000000000014, 45.5, 42.10000000000001, 42.900000000000006, 43.10000000000001, 28.499999999999964, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 46.3, 23.29999999999989, -50.00000000000044, -50.00000000000044, 33.30000000000003, 30.099999999999987, 39.10000000000002, 39.50000000000002, -50.00000000000044, 44.5, -50.00000000000044, 36.10000000000004, -50.00000000000044, -50.00000000000044, 43.900000000000006, 32.30000000000002, 42.10000000000001, 46.3, -50.00000000000044, -50.00000000000044, 42.10000000000001, 43.7, -50.00000000000044, -50.00000000000044, 29.099999999999973, -50.00000000000044, 43.50000000000001, 44.5, -50.00000000000044, 25.29999999999992, 36.900000000000034, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 22.899999999999885, -50.00000000000044, 45.1, -50.00000000000044, 42.10000000000001, 45.9, 43.50000000000001, 44.5, -50.00000000000044, -50.00000000000044, 31.900000000000013, -50.00000000000044, 26.299999999999933, 34.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 46.3, 29.299999999999976, 25.099999999999916, 45.3, 41.70000000000002], "episode_lengths": [500, 500, 238, 500, 78, 170, 58, 126, 500, 206, 124, 500, 48, 118, 58, 500, 102, 500, 500, 62, 66, 58, 172, 500, 500, 140, 92, 500, 500, 76, 46, 80, 72, 70, 216, 500, 500, 500, 70, 500, 500, 38, 268, 500, 500, 168, 200, 110, 106, 500, 56, 500, 140, 500, 500, 62, 178, 80, 38, 500, 500, 80, 64, 500, 500, 210, 500, 66, 56, 500, 248, 132, 76, 500, 500, 500, 272, 500, 50, 500, 80, 42, 66, 56, 500, 500, 182, 500, 238, 152, 500, 500, 500, 30, 500, 38, 208, 250, 48, 84]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37634377698914606, "mean_inference_ms": 1.200292555370661, "mean_action_processing_ms": 0.13902834818524773, "mean_env_wait_ms": 0.08361338427285492, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015824556350708008, "StateBufferConnector_ms": 0.008002758026123047, "ViewRequirementAgentConnector_ms": 0.13156604766845703}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1308000, "num_agent_steps_trained": 1308000, "num_env_steps_sampled": 1308000, "num_env_steps_trained": 1308000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5317.041092208925, "num_env_steps_trained_throughput_per_sec": 5317.041092208925, "timesteps_total": 1308000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1308000, "timers": {"training_iteration_time_ms": 2267.435, "sample_time_ms": 1907.456, "load_time_ms": 12.538, "load_throughput": 957115.626, "learn_time_ms": 336.139, "learn_throughput": 35699.503, "synch_weights_time_ms": 9.423}, "counters": {"num_env_steps_sampled": 1308000, "num_env_steps_trained": 1308000, "num_agent_steps_sampled": 1308000, "num_agent_steps_trained": 1308000}, "done": false, "episodes_total": 4961, "training_iteration": 109, "trial_id": "9f288_00017", "date": "2023-10-25_17-00-41", "timestamp": 1698249641, "time_this_iter_s": 2.2616703510284424, "time_total_s": 248.33916020393372, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 248.33916020393372, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 59.133333333333326, "ram_util_percent": 27.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.0814879110195784e-34, "cur_lr": 0.0003, "total_loss": 6.259354750315349, "policy_loss": -0.0011630514791856209, "vf_loss": 6.260568936665853, "vf_explained_var": -9.61621602376302e-07, "kl": 0.0013923067406002095, "entropy": 0.5114286690950394, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 3285.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1320000, "num_env_steps_trained": 1320000, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.7480000000001997, "episode_len_mean": 288.04, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 46.3, 23.29999999999989, -50.00000000000044, -50.00000000000044, 33.30000000000003, 30.099999999999987, 39.10000000000002, 39.50000000000002, -50.00000000000044, 44.5, -50.00000000000044, 36.10000000000004, -50.00000000000044, -50.00000000000044, 43.900000000000006, 32.30000000000002, 42.10000000000001, 46.3, -50.00000000000044, -50.00000000000044, 42.10000000000001, 43.7, -50.00000000000044, -50.00000000000044, 29.099999999999973, -50.00000000000044, 43.50000000000001, 44.5, -50.00000000000044, 25.29999999999992, 36.900000000000034, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 22.899999999999885, -50.00000000000044, 45.1, -50.00000000000044, 42.10000000000001, 45.9, 43.50000000000001, 44.5, -50.00000000000044, -50.00000000000044, 31.900000000000013, -50.00000000000044, 26.299999999999933, 34.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 46.3, 29.299999999999976, 25.099999999999916, 45.3, 41.70000000000002, -50.00000000000044, 39.10000000000002, 41.100000000000016, 26.69999999999994, 44.7, -50.00000000000044, 21.699999999999868, -50.00000000000044, -50.00000000000044, 35.70000000000003, -50.00000000000044, -50.00000000000044, 26.09999999999993, -50.00000000000044, -50.00000000000044, 43.50000000000001, 24.69999999999991, -50.00000000000044, 45.5, -50.00000000000044, 45.5, 43.30000000000001, 42.10000000000001, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 20.699999999999854, -50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, 42.500000000000014, 32.100000000000016, 39.10000000000002, -50.00000000000044, 44.7, 44.900000000000006], "episode_lengths": [500, 500, 38, 268, 500, 500, 168, 200, 110, 106, 500, 56, 500, 140, 500, 500, 62, 178, 80, 38, 500, 500, 80, 64, 500, 500, 210, 500, 66, 56, 500, 248, 132, 76, 500, 500, 500, 272, 500, 50, 500, 80, 42, 66, 56, 500, 500, 182, 500, 238, 152, 500, 500, 500, 30, 500, 38, 208, 250, 48, 84, 500, 110, 90, 234, 54, 500, 284, 500, 500, 144, 500, 500, 240, 500, 500, 66, 254, 500, 46, 500, 46, 68, 80, 500, 500, 48, 500, 294, 500, 500, 102, 500, 500, 76, 180, 110, 500, 54, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3762545295242263, "mean_inference_ms": 1.2007318972785015, "mean_action_processing_ms": 0.13923041710966572, "mean_env_wait_ms": 0.0839360331559822, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024847745895385742, "StateBufferConnector_ms": 0.003999471664428711, "ViewRequirementAgentConnector_ms": 0.13453412055969238}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.7480000000001997, "episode_len_mean": 288.04, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 46.3, 23.29999999999989, -50.00000000000044, -50.00000000000044, 33.30000000000003, 30.099999999999987, 39.10000000000002, 39.50000000000002, -50.00000000000044, 44.5, -50.00000000000044, 36.10000000000004, -50.00000000000044, -50.00000000000044, 43.900000000000006, 32.30000000000002, 42.10000000000001, 46.3, -50.00000000000044, -50.00000000000044, 42.10000000000001, 43.7, -50.00000000000044, -50.00000000000044, 29.099999999999973, -50.00000000000044, 43.50000000000001, 44.5, -50.00000000000044, 25.29999999999992, 36.900000000000034, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 22.899999999999885, -50.00000000000044, 45.1, -50.00000000000044, 42.10000000000001, 45.9, 43.50000000000001, 44.5, -50.00000000000044, -50.00000000000044, 31.900000000000013, -50.00000000000044, 26.299999999999933, 34.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 46.3, 29.299999999999976, 25.099999999999916, 45.3, 41.70000000000002, -50.00000000000044, 39.10000000000002, 41.100000000000016, 26.69999999999994, 44.7, -50.00000000000044, 21.699999999999868, -50.00000000000044, -50.00000000000044, 35.70000000000003, -50.00000000000044, -50.00000000000044, 26.09999999999993, -50.00000000000044, -50.00000000000044, 43.50000000000001, 24.69999999999991, -50.00000000000044, 45.5, -50.00000000000044, 45.5, 43.30000000000001, 42.10000000000001, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 20.699999999999854, -50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, 42.500000000000014, 32.100000000000016, 39.10000000000002, -50.00000000000044, 44.7, 44.900000000000006], "episode_lengths": [500, 500, 38, 268, 500, 500, 168, 200, 110, 106, 500, 56, 500, 140, 500, 500, 62, 178, 80, 38, 500, 500, 80, 64, 500, 500, 210, 500, 66, 56, 500, 248, 132, 76, 500, 500, 500, 272, 500, 50, 500, 80, 42, 66, 56, 500, 500, 182, 500, 238, 152, 500, 500, 500, 30, 500, 38, 208, 250, 48, 84, 500, 110, 90, 234, 54, 500, 284, 500, 500, 144, 500, 500, 240, 500, 500, 66, 254, 500, 46, 500, 46, 68, 80, 500, 500, 48, 500, 294, 500, 500, 102, 500, 500, 76, 180, 110, 500, 54, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3762545295242263, "mean_inference_ms": 1.2007318972785015, "mean_action_processing_ms": 0.13923041710966572, "mean_env_wait_ms": 0.0839360331559822, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024847745895385742, "StateBufferConnector_ms": 0.003999471664428711, "ViewRequirementAgentConnector_ms": 0.13453412055969238}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000, "num_env_steps_sampled": 1320000, "num_env_steps_trained": 1320000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5480.959163672002, "num_env_steps_trained_throughput_per_sec": 5480.959163672002, "timesteps_total": 1320000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1320000, "timers": {"training_iteration_time_ms": 2251.389, "sample_time_ms": 1909.731, "load_time_ms": 12.138, "load_throughput": 988653.311, "learn_time_ms": 318.085, "learn_throughput": 37725.81, "synch_weights_time_ms": 9.556}, "counters": {"num_env_steps_sampled": 1320000, "num_env_steps_trained": 1320000, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000}, "done": false, "episodes_total": 5000, "training_iteration": 110, "trial_id": "9f288_00017", "date": "2023-10-25_17-00-43", "timestamp": 1698249643, "time_this_iter_s": 2.194091796875, "time_total_s": 250.53325200080872, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 250.53325200080872, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 58.23333333333333, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.5407439555097892e-34, "cur_lr": 0.0003, "total_loss": 6.56929677327474, "policy_loss": -0.0008514455053955317, "vf_loss": 6.570203606287638, "vf_explained_var": -9.417533874511719e-07, "kl": 0.001119462323466299, "entropy": 0.5545946568250656, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 3315.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1332000, "num_env_steps_trained": 1332000, "num_agent_steps_sampled": 1332000, "num_agent_steps_trained": 1332000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.1009999999998055, "episode_len_mean": 284.6, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.5, -50.00000000000044, -50.00000000000044, 31.900000000000013, -50.00000000000044, 26.299999999999933, 34.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 46.3, 29.299999999999976, 25.099999999999916, 45.3, 41.70000000000002, -50.00000000000044, 39.10000000000002, 41.100000000000016, 26.69999999999994, 44.7, -50.00000000000044, 21.699999999999868, -50.00000000000044, -50.00000000000044, 35.70000000000003, -50.00000000000044, -50.00000000000044, 26.09999999999993, -50.00000000000044, -50.00000000000044, 43.50000000000001, 24.69999999999991, -50.00000000000044, 45.5, -50.00000000000044, 45.5, 43.30000000000001, 42.10000000000001, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 20.699999999999854, -50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, 42.500000000000014, 32.100000000000016, 39.10000000000002, -50.00000000000044, 44.7, 44.900000000000006, -50.00000000000044, 45.5, 33.500000000000036, 43.50000000000001, -50.00000000000044, -50.00000000000044, 41.70000000000002, 20.099999999999845, -50.00000000000044, 40.90000000000002, 36.30000000000003, 25.29999999999992, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 9.499999999999694, 43.900000000000006, 42.500000000000014, 34.50000000000004, -50.00000000000044, 44.10000000000001, -50.00000000000044, 43.900000000000006, 7.299999999999663, 33.500000000000036, 41.30000000000001, 44.10000000000001, -50.00000000000044, 46.3, 2.499999999999595, 44.300000000000004, 42.500000000000014, -50.00000000000044, 6.499999999999652, 42.500000000000014, -50.00000000000044, 37.90000000000003, 6.099999999999646, 18.499999999999822, 43.7, 31.1], "episode_lengths": [56, 500, 500, 182, 500, 238, 152, 500, 500, 500, 30, 500, 38, 208, 250, 48, 84, 500, 110, 90, 234, 54, 500, 284, 500, 500, 144, 500, 500, 240, 500, 500, 66, 254, 500, 46, 500, 46, 68, 80, 500, 500, 48, 500, 294, 500, 500, 102, 500, 500, 76, 180, 110, 500, 54, 52, 500, 46, 166, 66, 500, 500, 84, 300, 500, 92, 138, 248, 500, 500, 46, 500, 500, 500, 406, 62, 76, 156, 500, 60, 500, 62, 428, 166, 88, 60, 500, 38, 476, 58, 76, 500, 436, 76, 500, 122, 440, 316, 64, 190]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37654193908173056, "mean_inference_ms": 1.200881556686422, "mean_action_processing_ms": 0.13922188002950167, "mean_env_wait_ms": 0.08382583439987393, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02102184295654297, "StateBufferConnector_ms": 0.010999441146850586, "ViewRequirementAgentConnector_ms": 0.13071417808532715}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.1009999999998055, "episode_len_mean": 284.6, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.5, -50.00000000000044, -50.00000000000044, 31.900000000000013, -50.00000000000044, 26.299999999999933, 34.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 46.3, 29.299999999999976, 25.099999999999916, 45.3, 41.70000000000002, -50.00000000000044, 39.10000000000002, 41.100000000000016, 26.69999999999994, 44.7, -50.00000000000044, 21.699999999999868, -50.00000000000044, -50.00000000000044, 35.70000000000003, -50.00000000000044, -50.00000000000044, 26.09999999999993, -50.00000000000044, -50.00000000000044, 43.50000000000001, 24.69999999999991, -50.00000000000044, 45.5, -50.00000000000044, 45.5, 43.30000000000001, 42.10000000000001, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 20.699999999999854, -50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, 42.500000000000014, 32.100000000000016, 39.10000000000002, -50.00000000000044, 44.7, 44.900000000000006, -50.00000000000044, 45.5, 33.500000000000036, 43.50000000000001, -50.00000000000044, -50.00000000000044, 41.70000000000002, 20.099999999999845, -50.00000000000044, 40.90000000000002, 36.30000000000003, 25.29999999999992, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 9.499999999999694, 43.900000000000006, 42.500000000000014, 34.50000000000004, -50.00000000000044, 44.10000000000001, -50.00000000000044, 43.900000000000006, 7.299999999999663, 33.500000000000036, 41.30000000000001, 44.10000000000001, -50.00000000000044, 46.3, 2.499999999999595, 44.300000000000004, 42.500000000000014, -50.00000000000044, 6.499999999999652, 42.500000000000014, -50.00000000000044, 37.90000000000003, 6.099999999999646, 18.499999999999822, 43.7, 31.1], "episode_lengths": [56, 500, 500, 182, 500, 238, 152, 500, 500, 500, 30, 500, 38, 208, 250, 48, 84, 500, 110, 90, 234, 54, 500, 284, 500, 500, 144, 500, 500, 240, 500, 500, 66, 254, 500, 46, 500, 46, 68, 80, 500, 500, 48, 500, 294, 500, 500, 102, 500, 500, 76, 180, 110, 500, 54, 52, 500, 46, 166, 66, 500, 500, 84, 300, 500, 92, 138, 248, 500, 500, 46, 500, 500, 500, 406, 62, 76, 156, 500, 60, 500, 62, 428, 166, 88, 60, 500, 38, 476, 58, 76, 500, 436, 76, 500, 122, 440, 316, 64, 190]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37654193908173056, "mean_inference_ms": 1.200881556686422, "mean_action_processing_ms": 0.13922188002950167, "mean_env_wait_ms": 0.08382583439987393, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02102184295654297, "StateBufferConnector_ms": 0.010999441146850586, "ViewRequirementAgentConnector_ms": 0.13071417808532715}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1332000, "num_agent_steps_trained": 1332000, "num_env_steps_sampled": 1332000, "num_env_steps_trained": 1332000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5276.616265955397, "num_env_steps_trained_throughput_per_sec": 5276.616265955397, "timesteps_total": 1332000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1332000, "timers": {"training_iteration_time_ms": 2263.319, "sample_time_ms": 1903.995, "load_time_ms": 12.238, "load_throughput": 980546.501, "learn_time_ms": 335.452, "learn_throughput": 35772.654, "synch_weights_time_ms": 9.634}, "counters": {"num_env_steps_sampled": 1332000, "num_env_steps_trained": 1332000, "num_agent_steps_sampled": 1332000, "num_agent_steps_trained": 1332000}, "done": false, "episodes_total": 5044, "training_iteration": 111, "trial_id": "9f288_00017", "date": "2023-10-25_17-00-46", "timestamp": 1698249646, "time_this_iter_s": 2.2791829109191895, "time_total_s": 252.8124349117279, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 252.8124349117279, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 57.9, "ram_util_percent": 27.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.703719777548946e-35, "cur_lr": 0.0003, "total_loss": 6.994206953048706, "policy_loss": -0.0006267901510000229, "vf_loss": 6.994886986414591, "vf_explained_var": -1.0013580322265625e-06, "kl": 0.001391083192527276, "entropy": 0.5334864387909571, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 3345.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1344000, "num_env_steps_trained": 1344000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.9029999999998064, "episode_len_mean": 276.6, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, 42.500000000000014, 32.100000000000016, 39.10000000000002, -50.00000000000044, 44.7, 44.900000000000006, -50.00000000000044, 45.5, 33.500000000000036, 43.50000000000001, -50.00000000000044, -50.00000000000044, 41.70000000000002, 20.099999999999845, -50.00000000000044, 40.90000000000002, 36.30000000000003, 25.29999999999992, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 9.499999999999694, 43.900000000000006, 42.500000000000014, 34.50000000000004, -50.00000000000044, 44.10000000000001, -50.00000000000044, 43.900000000000006, 7.299999999999663, 33.500000000000036, 41.30000000000001, 44.10000000000001, -50.00000000000044, 46.3, 2.499999999999595, 44.300000000000004, 42.500000000000014, -50.00000000000044, 6.499999999999652, 42.500000000000014, -50.00000000000044, 37.90000000000003, 6.099999999999646, 18.499999999999822, 43.7, 31.1, -50.00000000000044, 46.5, -50.00000000000044, 45.7, 44.10000000000001, 41.90000000000001, 39.300000000000026, 15.899999999999785, 46.099999999999994, -50.00000000000044, -50.00000000000044, 40.70000000000002, 40.10000000000002, 46.3, -50.00000000000044, 12.69999999999974, 38.700000000000024, 44.5, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 44.300000000000004, 18.29999999999982, -50.00000000000044, 24.899999999999913, 0.09999999999956088, -50.00000000000044, -50.00000000000044, 46.9, 43.7, 23.099999999999888, -50.00000000000044, 35.500000000000036, -50.00000000000044, 45.3, 44.300000000000004, -50.00000000000044, 43.7, -50.00000000000044, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 102, 500, 500, 76, 180, 110, 500, 54, 52, 500, 46, 166, 66, 500, 500, 84, 300, 500, 92, 138, 248, 500, 500, 46, 500, 500, 500, 406, 62, 76, 156, 500, 60, 500, 62, 428, 166, 88, 60, 500, 38, 476, 58, 76, 500, 436, 76, 500, 122, 440, 316, 64, 190, 500, 36, 500, 44, 60, 82, 108, 342, 40, 500, 500, 94, 100, 38, 500, 374, 114, 56, 34, 500, 500, 500, 88, 58, 318, 500, 252, 500, 500, 500, 32, 64, 270, 500, 146, 500, 48, 58, 500, 64, 500, 124, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3764180361656743, "mean_inference_ms": 1.2007419110779767, "mean_action_processing_ms": 0.1392185258976157, "mean_env_wait_ms": 0.08368334161163885, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016004562377929688, "StateBufferConnector_ms": 0.012999534606933594, "ViewRequirementAgentConnector_ms": 0.12699031829833984}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.9029999999998064, "episode_len_mean": 276.6, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, 42.500000000000014, 32.100000000000016, 39.10000000000002, -50.00000000000044, 44.7, 44.900000000000006, -50.00000000000044, 45.5, 33.500000000000036, 43.50000000000001, -50.00000000000044, -50.00000000000044, 41.70000000000002, 20.099999999999845, -50.00000000000044, 40.90000000000002, 36.30000000000003, 25.29999999999992, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 9.499999999999694, 43.900000000000006, 42.500000000000014, 34.50000000000004, -50.00000000000044, 44.10000000000001, -50.00000000000044, 43.900000000000006, 7.299999999999663, 33.500000000000036, 41.30000000000001, 44.10000000000001, -50.00000000000044, 46.3, 2.499999999999595, 44.300000000000004, 42.500000000000014, -50.00000000000044, 6.499999999999652, 42.500000000000014, -50.00000000000044, 37.90000000000003, 6.099999999999646, 18.499999999999822, 43.7, 31.1, -50.00000000000044, 46.5, -50.00000000000044, 45.7, 44.10000000000001, 41.90000000000001, 39.300000000000026, 15.899999999999785, 46.099999999999994, -50.00000000000044, -50.00000000000044, 40.70000000000002, 40.10000000000002, 46.3, -50.00000000000044, 12.69999999999974, 38.700000000000024, 44.5, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 44.300000000000004, 18.29999999999982, -50.00000000000044, 24.899999999999913, 0.09999999999956088, -50.00000000000044, -50.00000000000044, 46.9, 43.7, 23.099999999999888, -50.00000000000044, 35.500000000000036, -50.00000000000044, 45.3, 44.300000000000004, -50.00000000000044, 43.7, -50.00000000000044, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 102, 500, 500, 76, 180, 110, 500, 54, 52, 500, 46, 166, 66, 500, 500, 84, 300, 500, 92, 138, 248, 500, 500, 46, 500, 500, 500, 406, 62, 76, 156, 500, 60, 500, 62, 428, 166, 88, 60, 500, 38, 476, 58, 76, 500, 436, 76, 500, 122, 440, 316, 64, 190, 500, 36, 500, 44, 60, 82, 108, 342, 40, 500, 500, 94, 100, 38, 500, 374, 114, 56, 34, 500, 500, 500, 88, 58, 318, 500, 252, 500, 500, 500, 32, 64, 270, 500, 146, 500, 48, 58, 500, 64, 500, 124, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3764180361656743, "mean_inference_ms": 1.2007419110779767, "mean_action_processing_ms": 0.1392185258976157, "mean_env_wait_ms": 0.08368334161163885, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016004562377929688, "StateBufferConnector_ms": 0.012999534606933594, "ViewRequirementAgentConnector_ms": 0.12699031829833984}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000, "num_env_steps_sampled": 1344000, "num_env_steps_trained": 1344000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5291.086760784586, "num_env_steps_trained_throughput_per_sec": 5291.086760784586, "timesteps_total": 1344000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1344000, "timers": {"training_iteration_time_ms": 2268.35, "sample_time_ms": 1904.933, "load_time_ms": 12.437, "load_throughput": 964852.9, "learn_time_ms": 338.847, "learn_throughput": 35414.254, "synch_weights_time_ms": 10.133}, "counters": {"num_env_steps_sampled": 1344000, "num_env_steps_trained": 1344000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "done": false, "episodes_total": 5089, "training_iteration": 112, "trial_id": "9f288_00017", "date": "2023-10-25_17-00-48", "timestamp": 1698249648, "time_this_iter_s": 2.272963047027588, "time_total_s": 255.0853979587555, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 255.0853979587555, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 51.975, "ram_util_percent": 27.224999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.851859888774473e-35, "cur_lr": 0.0003, "total_loss": 5.974584976832072, "policy_loss": -0.0007261859873930614, "vf_loss": 5.9753633340199785, "vf_explained_var": -9.934107462565105e-07, "kl": 0.0012162775035752323, "entropy": 0.5224882562955221, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 3375.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1356000, "num_env_steps_trained": 1356000, "num_agent_steps_sampled": 1356000, "num_agent_steps_trained": 1356000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.7459999999998077, "episode_len_mean": 273.16, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.10000000000001, -50.00000000000044, 46.3, 2.499999999999595, 44.300000000000004, 42.500000000000014, -50.00000000000044, 6.499999999999652, 42.500000000000014, -50.00000000000044, 37.90000000000003, 6.099999999999646, 18.499999999999822, 43.7, 31.1, -50.00000000000044, 46.5, -50.00000000000044, 45.7, 44.10000000000001, 41.90000000000001, 39.300000000000026, 15.899999999999785, 46.099999999999994, -50.00000000000044, -50.00000000000044, 40.70000000000002, 40.10000000000002, 46.3, -50.00000000000044, 12.69999999999974, 38.700000000000024, 44.5, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 44.300000000000004, 18.29999999999982, -50.00000000000044, 24.899999999999913, 0.09999999999956088, -50.00000000000044, -50.00000000000044, 46.9, 43.7, 23.099999999999888, -50.00000000000044, 35.500000000000036, -50.00000000000044, 45.3, 44.300000000000004, -50.00000000000044, 43.7, -50.00000000000044, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.30000000000004, 32.50000000000002, 40.70000000000002, 44.900000000000006, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 46.3, 41.100000000000016, 45.9, -50.00000000000044, 45.5, 46.099999999999994, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 27.49999999999995, 45.9, 41.30000000000001, 16.29999999999979, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.7, 21.699999999999868, 32.30000000000002, 43.50000000000001, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 45.9, 36.70000000000003], "episode_lengths": [60, 500, 38, 476, 58, 76, 500, 436, 76, 500, 122, 440, 316, 64, 190, 500, 36, 500, 44, 60, 82, 108, 342, 40, 500, 500, 94, 100, 38, 500, 374, 114, 56, 34, 500, 500, 500, 88, 58, 318, 500, 252, 500, 500, 500, 32, 64, 270, 500, 146, 500, 48, 58, 500, 64, 500, 124, 500, 500, 500, 500, 500, 158, 176, 94, 52, 500, 68, 500, 500, 38, 90, 42, 500, 46, 40, 500, 50, 500, 500, 226, 42, 88, 338, 500, 500, 500, 500, 24, 284, 178, 66, 500, 78, 500, 500, 500, 66, 42, 134]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3762107243893834, "mean_inference_ms": 1.2005735699872397, "mean_action_processing_ms": 0.13918735451419162, "mean_env_wait_ms": 0.08349657810934902, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024996280670166016, "StateBufferConnector_ms": 0.00899958610534668, "ViewRequirementAgentConnector_ms": 0.11798572540283203}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.7459999999998077, "episode_len_mean": 273.16, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.10000000000001, -50.00000000000044, 46.3, 2.499999999999595, 44.300000000000004, 42.500000000000014, -50.00000000000044, 6.499999999999652, 42.500000000000014, -50.00000000000044, 37.90000000000003, 6.099999999999646, 18.499999999999822, 43.7, 31.1, -50.00000000000044, 46.5, -50.00000000000044, 45.7, 44.10000000000001, 41.90000000000001, 39.300000000000026, 15.899999999999785, 46.099999999999994, -50.00000000000044, -50.00000000000044, 40.70000000000002, 40.10000000000002, 46.3, -50.00000000000044, 12.69999999999974, 38.700000000000024, 44.5, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 44.300000000000004, 18.29999999999982, -50.00000000000044, 24.899999999999913, 0.09999999999956088, -50.00000000000044, -50.00000000000044, 46.9, 43.7, 23.099999999999888, -50.00000000000044, 35.500000000000036, -50.00000000000044, 45.3, 44.300000000000004, -50.00000000000044, 43.7, -50.00000000000044, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.30000000000004, 32.50000000000002, 40.70000000000002, 44.900000000000006, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 46.3, 41.100000000000016, 45.9, -50.00000000000044, 45.5, 46.099999999999994, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 27.49999999999995, 45.9, 41.30000000000001, 16.29999999999979, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.7, 21.699999999999868, 32.30000000000002, 43.50000000000001, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 45.9, 36.70000000000003], "episode_lengths": [60, 500, 38, 476, 58, 76, 500, 436, 76, 500, 122, 440, 316, 64, 190, 500, 36, 500, 44, 60, 82, 108, 342, 40, 500, 500, 94, 100, 38, 500, 374, 114, 56, 34, 500, 500, 500, 88, 58, 318, 500, 252, 500, 500, 500, 32, 64, 270, 500, 146, 500, 48, 58, 500, 64, 500, 124, 500, 500, 500, 500, 500, 158, 176, 94, 52, 500, 68, 500, 500, 38, 90, 42, 500, 46, 40, 500, 50, 500, 500, 226, 42, 88, 338, 500, 500, 500, 500, 24, 284, 178, 66, 500, 78, 500, 500, 500, 66, 42, 134]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3762107243893834, "mean_inference_ms": 1.2005735699872397, "mean_action_processing_ms": 0.13918735451419162, "mean_env_wait_ms": 0.08349657810934902, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024996280670166016, "StateBufferConnector_ms": 0.00899958610534668, "ViewRequirementAgentConnector_ms": 0.11798572540283203}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1356000, "num_agent_steps_trained": 1356000, "num_env_steps_sampled": 1356000, "num_env_steps_trained": 1356000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5089.538050306611, "num_env_steps_trained_throughput_per_sec": 5089.538050306611, "timesteps_total": 1356000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1356000, "timers": {"training_iteration_time_ms": 2270.883, "sample_time_ms": 1905.564, "load_time_ms": 12.383, "load_throughput": 969094.13, "learn_time_ms": 340.771, "learn_throughput": 35214.283, "synch_weights_time_ms": 10.18}, "counters": {"num_env_steps_sampled": 1356000, "num_env_steps_trained": 1356000, "num_agent_steps_sampled": 1356000, "num_agent_steps_trained": 1356000}, "done": false, "episodes_total": 5129, "training_iteration": 113, "trial_id": "9f288_00017", "date": "2023-10-25_17-00-50", "timestamp": 1698249650, "time_this_iter_s": 2.3637046813964844, "time_total_s": 257.449102640152, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 257.449102640152, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 60.333333333333336, "ram_util_percent": 27.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.9259299443872365e-35, "cur_lr": 0.0003, "total_loss": 6.395576858520508, "policy_loss": -0.00016974210739135743, "vf_loss": 6.395796505610148, "vf_explained_var": -1.0013580322265625e-06, "kl": 0.00040974850479926774, "entropy": 0.4982568730910619, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 3405.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1368000, "num_env_steps_trained": 1368000, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.264999999999817, "episode_len_mean": 262.96, "episode_media": {}, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.500000000000036, -50.00000000000044, 45.3, 44.300000000000004, -50.00000000000044, 43.7, -50.00000000000044, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.30000000000004, 32.50000000000002, 40.70000000000002, 44.900000000000006, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 46.3, 41.100000000000016, 45.9, -50.00000000000044, 45.5, 46.099999999999994, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 27.49999999999995, 45.9, 41.30000000000001, 16.29999999999979, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.7, 21.699999999999868, 32.30000000000002, 43.50000000000001, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 45.9, 36.70000000000003, -50.00000000000044, 44.900000000000006, 47.1, 39.10000000000002, 46.3, 44.10000000000001, -50.00000000000044, 41.30000000000001, -50.00000000000044, 42.900000000000006, 43.30000000000001, 36.900000000000034, 40.90000000000002, 0.49999999999956657, 44.5, 34.30000000000004, -50.00000000000044, 45.9, 36.50000000000003, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, 44.300000000000004, -50.00000000000044, 28.89999999999997, 18.29999999999982, -50.00000000000044, 43.50000000000001, 43.900000000000006, 18.699999999999825, 47.7, -50.00000000000044, 27.49999999999995, -50.00000000000044, 44.300000000000004, -50.00000000000044, 24.299999999999905, -50.00000000000044, 44.10000000000001, 45.1, 42.30000000000001, 46.699999999999996, 19.499999999999837, 45.1], "episode_lengths": [146, 500, 48, 58, 500, 64, 500, 124, 500, 500, 500, 500, 500, 158, 176, 94, 52, 500, 68, 500, 500, 38, 90, 42, 500, 46, 40, 500, 50, 500, 500, 226, 42, 88, 338, 500, 500, 500, 500, 24, 284, 178, 66, 500, 78, 500, 500, 500, 66, 42, 134, 500, 52, 30, 110, 38, 60, 500, 88, 500, 72, 68, 132, 92, 496, 56, 158, 500, 42, 136, 500, 32, 500, 500, 500, 500, 500, 100, 58, 500, 212, 318, 500, 66, 62, 314, 24, 500, 226, 500, 58, 500, 258, 500, 60, 50, 78, 34, 306, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3763172894081521, "mean_inference_ms": 1.2003400905117299, "mean_action_processing_ms": 0.13920866446279415, "mean_env_wait_ms": 0.08355264307968824, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02600264549255371, "StateBufferConnector_ms": 0.007997751235961914, "ViewRequirementAgentConnector_ms": 0.13191676139831543}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.264999999999817, "episode_len_mean": 262.96, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [35.500000000000036, -50.00000000000044, 45.3, 44.300000000000004, -50.00000000000044, 43.7, -50.00000000000044, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.30000000000004, 32.50000000000002, 40.70000000000002, 44.900000000000006, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 46.3, 41.100000000000016, 45.9, -50.00000000000044, 45.5, 46.099999999999994, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 27.49999999999995, 45.9, 41.30000000000001, 16.29999999999979, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.7, 21.699999999999868, 32.30000000000002, 43.50000000000001, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 45.9, 36.70000000000003, -50.00000000000044, 44.900000000000006, 47.1, 39.10000000000002, 46.3, 44.10000000000001, -50.00000000000044, 41.30000000000001, -50.00000000000044, 42.900000000000006, 43.30000000000001, 36.900000000000034, 40.90000000000002, 0.49999999999956657, 44.5, 34.30000000000004, -50.00000000000044, 45.9, 36.50000000000003, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, 44.300000000000004, -50.00000000000044, 28.89999999999997, 18.29999999999982, -50.00000000000044, 43.50000000000001, 43.900000000000006, 18.699999999999825, 47.7, -50.00000000000044, 27.49999999999995, -50.00000000000044, 44.300000000000004, -50.00000000000044, 24.299999999999905, -50.00000000000044, 44.10000000000001, 45.1, 42.30000000000001, 46.699999999999996, 19.499999999999837, 45.1], "episode_lengths": [146, 500, 48, 58, 500, 64, 500, 124, 500, 500, 500, 500, 500, 158, 176, 94, 52, 500, 68, 500, 500, 38, 90, 42, 500, 46, 40, 500, 50, 500, 500, 226, 42, 88, 338, 500, 500, 500, 500, 24, 284, 178, 66, 500, 78, 500, 500, 500, 66, 42, 134, 500, 52, 30, 110, 38, 60, 500, 88, 500, 72, 68, 132, 92, 496, 56, 158, 500, 42, 136, 500, 32, 500, 500, 500, 500, 500, 100, 58, 500, 212, 318, 500, 66, 62, 314, 24, 500, 226, 500, 58, 500, 258, 500, 60, 50, 78, 34, 306, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3763172894081521, "mean_inference_ms": 1.2003400905117299, "mean_action_processing_ms": 0.13920866446279415, "mean_env_wait_ms": 0.08355264307968824, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02600264549255371, "StateBufferConnector_ms": 0.007997751235961914, "ViewRequirementAgentConnector_ms": 0.13191676139831543}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000, "num_env_steps_sampled": 1368000, "num_env_steps_trained": 1368000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5416.896094247677, "num_env_steps_trained_throughput_per_sec": 5416.896094247677, "timesteps_total": 1368000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1368000, "timers": {"training_iteration_time_ms": 2275.706, "sample_time_ms": 1905.802, "load_time_ms": 12.367, "load_throughput": 970351.517, "learn_time_ms": 345.346, "learn_throughput": 34747.746, "synch_weights_time_ms": 10.305}, "counters": {"num_env_steps_sampled": 1368000, "num_env_steps_trained": 1368000, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000}, "done": false, "episodes_total": 5178, "training_iteration": 114, "trial_id": "9f288_00017", "date": "2023-10-25_17-00-53", "timestamp": 1698249653, "time_this_iter_s": 2.220290422439575, "time_total_s": 259.66939306259155, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 259.66939306259155, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 59.133333333333326, "ram_util_percent": 27.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.629649721936182e-36, "cur_lr": 0.0003, "total_loss": 6.066411193211874, "policy_loss": -0.00014516585894549887, "vf_loss": 6.06660369237264, "vf_explained_var": -9.854634602864584e-07, "kl": 0.0003282956157704575, "entropy": 0.4718919058640798, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 3435.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1380000, "num_env_steps_trained": 1380000, "num_agent_steps_sampled": 1380000, "num_agent_steps_trained": 1380000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.504999999999832, "episode_len_mean": 240.6, "episode_media": {}, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.9, 36.70000000000003, -50.00000000000044, 44.900000000000006, 47.1, 39.10000000000002, 46.3, 44.10000000000001, -50.00000000000044, 41.30000000000001, -50.00000000000044, 42.900000000000006, 43.30000000000001, 36.900000000000034, 40.90000000000002, 0.49999999999956657, 44.5, 34.30000000000004, -50.00000000000044, 45.9, 36.50000000000003, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, 44.300000000000004, -50.00000000000044, 28.89999999999997, 18.29999999999982, -50.00000000000044, 43.50000000000001, 43.900000000000006, 18.699999999999825, 47.7, -50.00000000000044, 27.49999999999995, -50.00000000000044, 44.300000000000004, -50.00000000000044, 24.299999999999905, -50.00000000000044, 44.10000000000001, 45.1, 42.30000000000001, 46.699999999999996, 19.499999999999837, 45.1, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 45.1, 44.5, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 47.5, -50.00000000000044, 46.099999999999994, 42.30000000000001, 44.900000000000006, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 45.5, 47.5, -50.00000000000044, 44.10000000000001, 45.7, 1.099999999999575, 46.099999999999994, 46.5, -50.00000000000044, 42.30000000000001, -50.00000000000044, 46.3, 46.9, 46.099999999999994, -50.00000000000044, 37.10000000000003, 43.900000000000006, 46.5, -50.00000000000044, -50.00000000000044, 42.500000000000014, 13.499999999999751, 41.100000000000016, 42.30000000000001, -50.00000000000044, 43.30000000000001, 35.70000000000003], "episode_lengths": [42, 134, 500, 52, 30, 110, 38, 60, 500, 88, 500, 72, 68, 132, 92, 496, 56, 158, 500, 42, 136, 500, 32, 500, 500, 500, 500, 500, 100, 58, 500, 212, 318, 500, 66, 62, 314, 24, 500, 226, 500, 58, 500, 258, 500, 60, 50, 78, 34, 306, 50, 500, 500, 34, 500, 50, 56, 500, 500, 40, 500, 26, 500, 40, 78, 52, 62, 500, 500, 500, 30, 500, 500, 46, 26, 500, 60, 44, 490, 40, 36, 500, 78, 500, 38, 32, 40, 500, 130, 62, 36, 500, 500, 76, 366, 90, 78, 500, 68, 144]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3762516612557566, "mean_inference_ms": 1.2002694116913069, "mean_action_processing_ms": 0.1391959478022148, "mean_env_wait_ms": 0.0837085270147939, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02400684356689453, "StateBufferConnector_ms": 0.004995822906494141, "ViewRequirementAgentConnector_ms": 0.1269066333770752}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.504999999999832, "episode_len_mean": 240.6, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.9, 36.70000000000003, -50.00000000000044, 44.900000000000006, 47.1, 39.10000000000002, 46.3, 44.10000000000001, -50.00000000000044, 41.30000000000001, -50.00000000000044, 42.900000000000006, 43.30000000000001, 36.900000000000034, 40.90000000000002, 0.49999999999956657, 44.5, 34.30000000000004, -50.00000000000044, 45.9, 36.50000000000003, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, 44.300000000000004, -50.00000000000044, 28.89999999999997, 18.29999999999982, -50.00000000000044, 43.50000000000001, 43.900000000000006, 18.699999999999825, 47.7, -50.00000000000044, 27.49999999999995, -50.00000000000044, 44.300000000000004, -50.00000000000044, 24.299999999999905, -50.00000000000044, 44.10000000000001, 45.1, 42.30000000000001, 46.699999999999996, 19.499999999999837, 45.1, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 45.1, 44.5, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 47.5, -50.00000000000044, 46.099999999999994, 42.30000000000001, 44.900000000000006, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 45.5, 47.5, -50.00000000000044, 44.10000000000001, 45.7, 1.099999999999575, 46.099999999999994, 46.5, -50.00000000000044, 42.30000000000001, -50.00000000000044, 46.3, 46.9, 46.099999999999994, -50.00000000000044, 37.10000000000003, 43.900000000000006, 46.5, -50.00000000000044, -50.00000000000044, 42.500000000000014, 13.499999999999751, 41.100000000000016, 42.30000000000001, -50.00000000000044, 43.30000000000001, 35.70000000000003], "episode_lengths": [42, 134, 500, 52, 30, 110, 38, 60, 500, 88, 500, 72, 68, 132, 92, 496, 56, 158, 500, 42, 136, 500, 32, 500, 500, 500, 500, 500, 100, 58, 500, 212, 318, 500, 66, 62, 314, 24, 500, 226, 500, 58, 500, 258, 500, 60, 50, 78, 34, 306, 50, 500, 500, 34, 500, 50, 56, 500, 500, 40, 500, 26, 500, 40, 78, 52, 62, 500, 500, 500, 30, 500, 500, 46, 26, 500, 60, 44, 490, 40, 36, 500, 78, 500, 38, 32, 40, 500, 130, 62, 36, 500, 500, 76, 366, 90, 78, 500, 68, 144]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3762516612557566, "mean_inference_ms": 1.2002694116913069, "mean_action_processing_ms": 0.1391959478022148, "mean_env_wait_ms": 0.0837085270147939, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02400684356689453, "StateBufferConnector_ms": 0.004995822906494141, "ViewRequirementAgentConnector_ms": 0.1269066333770752}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1380000, "num_agent_steps_trained": 1380000, "num_env_steps_sampled": 1380000, "num_env_steps_trained": 1380000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5227.947674454838, "num_env_steps_trained_throughput_per_sec": 5227.947674454838, "timesteps_total": 1380000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1380000, "timers": {"training_iteration_time_ms": 2274.13, "sample_time_ms": 1904.153, "load_time_ms": 12.659, "load_throughput": 947958.143, "learn_time_ms": 345.355, "learn_throughput": 34746.87, "synch_weights_time_ms": 10.078}, "counters": {"num_env_steps_sampled": 1380000, "num_env_steps_trained": 1380000, "num_agent_steps_sampled": 1380000, "num_agent_steps_trained": 1380000}, "done": false, "episodes_total": 5227, "training_iteration": 115, "trial_id": "9f288_00017", "date": "2023-10-25_17-00-55", "timestamp": 1698249655, "time_this_iter_s": 2.300943374633789, "time_total_s": 261.97033643722534, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 261.97033643722534, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 59.1, "ram_util_percent": 27.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.814824860968091e-36, "cur_lr": 0.0003, "total_loss": 6.38031743367513, "policy_loss": -0.00017235080401102701, "vf_loss": 6.380541245142619, "vf_explained_var": -9.695688883463541e-07, "kl": 0.0004906870036696394, "entropy": 0.5149138222138087, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 3465.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1392000, "num_env_steps_trained": 1392000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.486999999999814, "episode_len_mean": 250.76, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.1, 42.30000000000001, 46.699999999999996, 19.499999999999837, 45.1, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 45.1, 44.5, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 47.5, -50.00000000000044, 46.099999999999994, 42.30000000000001, 44.900000000000006, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 45.5, 47.5, -50.00000000000044, 44.10000000000001, 45.7, 1.099999999999575, 46.099999999999994, 46.5, -50.00000000000044, 42.30000000000001, -50.00000000000044, 46.3, 46.9, 46.099999999999994, -50.00000000000044, 37.10000000000003, 43.900000000000006, 46.5, -50.00000000000044, -50.00000000000044, 42.500000000000014, 13.499999999999751, 41.100000000000016, 42.30000000000001, -50.00000000000044, 43.30000000000001, 35.70000000000003, -50.00000000000044, -50.00000000000044, 45.9, 46.3, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, 46.3, 0.49999999999956657, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 46.9, 46.699999999999996, 17.69999999999981, 23.699999999999896, 13.499999999999751, -50.00000000000044, 41.30000000000001, 47.5, 46.9, 43.50000000000001, -50.00000000000044, -50.00000000000044, 42.500000000000014, 44.900000000000006, 43.50000000000001, 46.5, 44.10000000000001, -50.00000000000044, 44.5, 40.500000000000014, 40.500000000000014, -50.00000000000044, 3.899999999999615, 46.099999999999994, 29.69999999999998, 18.899999999999828, -50.00000000000044, -50.00000000000044], "episode_lengths": [50, 78, 34, 306, 50, 500, 500, 34, 500, 50, 56, 500, 500, 40, 500, 26, 500, 40, 78, 52, 62, 500, 500, 500, 30, 500, 500, 46, 26, 500, 60, 44, 490, 40, 36, 500, 78, 500, 38, 32, 40, 500, 130, 62, 36, 500, 500, 76, 366, 90, 78, 500, 68, 144, 500, 500, 42, 38, 500, 500, 48, 500, 500, 500, 500, 112, 38, 496, 500, 500, 500, 48, 32, 34, 324, 264, 366, 500, 88, 26, 32, 66, 500, 500, 76, 52, 66, 36, 60, 500, 56, 96, 96, 500, 462, 40, 204, 312, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37642170491112154, "mean_inference_ms": 1.201073838367279, "mean_action_processing_ms": 0.13920146468243452, "mean_env_wait_ms": 0.08384095010135313, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02300548553466797, "StateBufferConnector_ms": 0.0030012130737304688, "ViewRequirementAgentConnector_ms": 0.11696028709411621}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.486999999999814, "episode_len_mean": 250.76, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.1, 42.30000000000001, 46.699999999999996, 19.499999999999837, 45.1, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 45.1, 44.5, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 47.5, -50.00000000000044, 46.099999999999994, 42.30000000000001, 44.900000000000006, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 45.5, 47.5, -50.00000000000044, 44.10000000000001, 45.7, 1.099999999999575, 46.099999999999994, 46.5, -50.00000000000044, 42.30000000000001, -50.00000000000044, 46.3, 46.9, 46.099999999999994, -50.00000000000044, 37.10000000000003, 43.900000000000006, 46.5, -50.00000000000044, -50.00000000000044, 42.500000000000014, 13.499999999999751, 41.100000000000016, 42.30000000000001, -50.00000000000044, 43.30000000000001, 35.70000000000003, -50.00000000000044, -50.00000000000044, 45.9, 46.3, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, 46.3, 0.49999999999956657, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 46.9, 46.699999999999996, 17.69999999999981, 23.699999999999896, 13.499999999999751, -50.00000000000044, 41.30000000000001, 47.5, 46.9, 43.50000000000001, -50.00000000000044, -50.00000000000044, 42.500000000000014, 44.900000000000006, 43.50000000000001, 46.5, 44.10000000000001, -50.00000000000044, 44.5, 40.500000000000014, 40.500000000000014, -50.00000000000044, 3.899999999999615, 46.099999999999994, 29.69999999999998, 18.899999999999828, -50.00000000000044, -50.00000000000044], "episode_lengths": [50, 78, 34, 306, 50, 500, 500, 34, 500, 50, 56, 500, 500, 40, 500, 26, 500, 40, 78, 52, 62, 500, 500, 500, 30, 500, 500, 46, 26, 500, 60, 44, 490, 40, 36, 500, 78, 500, 38, 32, 40, 500, 130, 62, 36, 500, 500, 76, 366, 90, 78, 500, 68, 144, 500, 500, 42, 38, 500, 500, 48, 500, 500, 500, 500, 112, 38, 496, 500, 500, 500, 48, 32, 34, 324, 264, 366, 500, 88, 26, 32, 66, 500, 500, 76, 52, 66, 36, 60, 500, 56, 96, 96, 500, 462, 40, 204, 312, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37642170491112154, "mean_inference_ms": 1.201073838367279, "mean_action_processing_ms": 0.13920146468243452, "mean_env_wait_ms": 0.08384095010135313, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02300548553466797, "StateBufferConnector_ms": 0.0030012130737304688, "ViewRequirementAgentConnector_ms": 0.11696028709411621}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000, "num_env_steps_sampled": 1392000, "num_env_steps_trained": 1392000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5400.038559712139, "num_env_steps_trained_throughput_per_sec": 5400.038559712139, "timesteps_total": 1392000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1392000, "timers": {"training_iteration_time_ms": 2275.759, "sample_time_ms": 1905.576, "load_time_ms": 12.558, "load_throughput": 955569.25, "learn_time_ms": 345.804, "learn_throughput": 34701.779, "synch_weights_time_ms": 10.036}, "counters": {"num_env_steps_sampled": 1392000, "num_env_steps_trained": 1392000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "done": false, "episodes_total": 5273, "training_iteration": 116, "trial_id": "9f288_00017", "date": "2023-10-25_17-00-57", "timestamp": 1698249657, "time_this_iter_s": 2.2272074222564697, "time_total_s": 264.1975438594818, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 264.1975438594818, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 54.03333333333334, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.4074124304840456e-36, "cur_lr": 0.0003, "total_loss": 6.430745315551758, "policy_loss": -0.0004562193527817726, "vf_loss": 6.431250206629435, "vf_explained_var": -9.735425313313801e-07, "kl": 0.0010495917106557802, "entropy": 0.4851468781630198, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 3495.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1404000, "num_env_steps_trained": 1404000, "num_agent_steps_sampled": 1404000, "num_agent_steps_trained": 1404000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.4669999999998184, "episode_len_mean": 260.96, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.500000000000014, 13.499999999999751, 41.100000000000016, 42.30000000000001, -50.00000000000044, 43.30000000000001, 35.70000000000003, -50.00000000000044, -50.00000000000044, 45.9, 46.3, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, 46.3, 0.49999999999956657, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 46.9, 46.699999999999996, 17.69999999999981, 23.699999999999896, 13.499999999999751, -50.00000000000044, 41.30000000000001, 47.5, 46.9, 43.50000000000001, -50.00000000000044, -50.00000000000044, 42.500000000000014, 44.900000000000006, 43.50000000000001, 46.5, 44.10000000000001, -50.00000000000044, 44.5, 40.500000000000014, 40.500000000000014, -50.00000000000044, 3.899999999999615, 46.099999999999994, 29.69999999999998, 18.899999999999828, -50.00000000000044, -50.00000000000044, 11.099999999999717, -50.00000000000044, 42.70000000000001, -50.00000000000044, 45.3, -50.00000000000044, 29.69999999999998, -50.00000000000044, -50.00000000000044, 47.3, 43.10000000000001, -50.00000000000044, 42.10000000000001, -50.00000000000044, 38.700000000000024, -50.00000000000044, -50.00000000000044, 43.50000000000001, 46.3, -50.00000000000044, 46.9, -50.00000000000044, 47.1, 46.099999999999994, -50.00000000000044, 33.70000000000004, 47.1, 40.10000000000002, -50.00000000000044, 22.899999999999885, -50.00000000000044, 21.09999999999986, 44.300000000000004, -50.00000000000044, -50.00000000000044, 31.900000000000013, 38.90000000000002, 37.90000000000003, 39.70000000000002, -50.00000000000044, 33.30000000000003, -50.00000000000044, 44.900000000000006, 41.70000000000002, 46.5, 45.9, 36.70000000000003], "episode_lengths": [76, 366, 90, 78, 500, 68, 144, 500, 500, 42, 38, 500, 500, 48, 500, 500, 500, 500, 112, 38, 496, 500, 500, 500, 48, 32, 34, 324, 264, 366, 500, 88, 26, 32, 66, 500, 500, 76, 52, 66, 36, 60, 500, 56, 96, 96, 500, 462, 40, 204, 312, 500, 500, 390, 500, 74, 500, 48, 500, 204, 500, 500, 28, 70, 500, 80, 500, 114, 500, 500, 66, 38, 500, 32, 500, 30, 40, 500, 164, 30, 100, 500, 272, 500, 290, 58, 500, 500, 182, 112, 122, 104, 500, 168, 500, 52, 84, 36, 42, 134]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.376543832301537, "mean_inference_ms": 1.2003062747753148, "mean_action_processing_ms": 0.1391252399338735, "mean_env_wait_ms": 0.08374276759122083, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021006345748901367, "StateBufferConnector_ms": 0.003002643585205078, "ViewRequirementAgentConnector_ms": 0.12503385543823242}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.4669999999998184, "episode_len_mean": 260.96, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.500000000000014, 13.499999999999751, 41.100000000000016, 42.30000000000001, -50.00000000000044, 43.30000000000001, 35.70000000000003, -50.00000000000044, -50.00000000000044, 45.9, 46.3, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, 46.3, 0.49999999999956657, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 46.9, 46.699999999999996, 17.69999999999981, 23.699999999999896, 13.499999999999751, -50.00000000000044, 41.30000000000001, 47.5, 46.9, 43.50000000000001, -50.00000000000044, -50.00000000000044, 42.500000000000014, 44.900000000000006, 43.50000000000001, 46.5, 44.10000000000001, -50.00000000000044, 44.5, 40.500000000000014, 40.500000000000014, -50.00000000000044, 3.899999999999615, 46.099999999999994, 29.69999999999998, 18.899999999999828, -50.00000000000044, -50.00000000000044, 11.099999999999717, -50.00000000000044, 42.70000000000001, -50.00000000000044, 45.3, -50.00000000000044, 29.69999999999998, -50.00000000000044, -50.00000000000044, 47.3, 43.10000000000001, -50.00000000000044, 42.10000000000001, -50.00000000000044, 38.700000000000024, -50.00000000000044, -50.00000000000044, 43.50000000000001, 46.3, -50.00000000000044, 46.9, -50.00000000000044, 47.1, 46.099999999999994, -50.00000000000044, 33.70000000000004, 47.1, 40.10000000000002, -50.00000000000044, 22.899999999999885, -50.00000000000044, 21.09999999999986, 44.300000000000004, -50.00000000000044, -50.00000000000044, 31.900000000000013, 38.90000000000002, 37.90000000000003, 39.70000000000002, -50.00000000000044, 33.30000000000003, -50.00000000000044, 44.900000000000006, 41.70000000000002, 46.5, 45.9, 36.70000000000003], "episode_lengths": [76, 366, 90, 78, 500, 68, 144, 500, 500, 42, 38, 500, 500, 48, 500, 500, 500, 500, 112, 38, 496, 500, 500, 500, 48, 32, 34, 324, 264, 366, 500, 88, 26, 32, 66, 500, 500, 76, 52, 66, 36, 60, 500, 56, 96, 96, 500, 462, 40, 204, 312, 500, 500, 390, 500, 74, 500, 48, 500, 204, 500, 500, 28, 70, 500, 80, 500, 114, 500, 500, 66, 38, 500, 32, 500, 30, 40, 500, 164, 30, 100, 500, 272, 500, 290, 58, 500, 500, 182, 112, 122, 104, 500, 168, 500, 52, 84, 36, 42, 134]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.376543832301537, "mean_inference_ms": 1.2003062747753148, "mean_action_processing_ms": 0.1391252399338735, "mean_env_wait_ms": 0.08374276759122083, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021006345748901367, "StateBufferConnector_ms": 0.003002643585205078, "ViewRequirementAgentConnector_ms": 0.12503385543823242}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1404000, "num_agent_steps_trained": 1404000, "num_env_steps_sampled": 1404000, "num_env_steps_trained": 1404000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5079.876294478246, "num_env_steps_trained_throughput_per_sec": 5079.876294478246, "timesteps_total": 1404000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1404000, "timers": {"training_iteration_time_ms": 2280.178, "sample_time_ms": 1908.698, "load_time_ms": 12.488, "load_throughput": 960949.424, "learn_time_ms": 347.167, "learn_throughput": 34565.498, "synch_weights_time_ms": 9.939}, "counters": {"num_env_steps_sampled": 1404000, "num_env_steps_trained": 1404000, "num_agent_steps_sampled": 1404000, "num_agent_steps_trained": 1404000}, "done": false, "episodes_total": 5320, "training_iteration": 117, "trial_id": "9f288_00017", "date": "2023-10-25_17-01-00", "timestamp": 1698249660, "time_this_iter_s": 2.368263006210327, "time_total_s": 266.56580686569214, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 266.56580686569214, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 52.95, "ram_util_percent": 27.25}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.2037062152420228e-36, "cur_lr": 0.0003, "total_loss": 6.344903294245402, "policy_loss": -0.000917236382762591, "vf_loss": 6.3458673318227135, "vf_explained_var": -9.775161743164062e-07, "kl": 0.0011963167401442358, "entropy": 0.46832952201366423, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 3525.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1416000, "num_env_steps_trained": 1416000, "num_agent_steps_sampled": 1416000, "num_agent_steps_trained": 1416000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.360999999999822, "episode_len_mean": 262.02, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.5, 40.500000000000014, 40.500000000000014, -50.00000000000044, 3.899999999999615, 46.099999999999994, 29.69999999999998, 18.899999999999828, -50.00000000000044, -50.00000000000044, 11.099999999999717, -50.00000000000044, 42.70000000000001, -50.00000000000044, 45.3, -50.00000000000044, 29.69999999999998, -50.00000000000044, -50.00000000000044, 47.3, 43.10000000000001, -50.00000000000044, 42.10000000000001, -50.00000000000044, 38.700000000000024, -50.00000000000044, -50.00000000000044, 43.50000000000001, 46.3, -50.00000000000044, 46.9, -50.00000000000044, 47.1, 46.099999999999994, -50.00000000000044, 33.70000000000004, 47.1, 40.10000000000002, -50.00000000000044, 22.899999999999885, -50.00000000000044, 21.09999999999986, 44.300000000000004, -50.00000000000044, -50.00000000000044, 31.900000000000013, 38.90000000000002, 37.90000000000003, 39.70000000000002, -50.00000000000044, 33.30000000000003, -50.00000000000044, 44.900000000000006, 41.70000000000002, 46.5, 45.9, 36.70000000000003, -50.00000000000044, -50.00000000000044, 45.5, 47.5, 36.10000000000004, -50.00000000000044, -50.00000000000044, 11.499999999999723, -50.00000000000044, 24.899999999999913, -50.00000000000044, 37.90000000000003, 45.7, 45.5, 39.70000000000002, 14.09999999999976, -50.00000000000044, 36.30000000000003, 41.500000000000014, 44.7, 44.300000000000004, 47.3, -50.00000000000044, 45.1, 20.49999999999985, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.299999999999933, 38.90000000000002, -50.00000000000044, -50.00000000000044, 44.900000000000006, 45.7, -50.00000000000044, -50.00000000000044, 38.50000000000003, -50.00000000000044, 41.70000000000002, 36.30000000000003, 44.5, 46.5, 34.10000000000004], "episode_lengths": [56, 96, 96, 500, 462, 40, 204, 312, 500, 500, 390, 500, 74, 500, 48, 500, 204, 500, 500, 28, 70, 500, 80, 500, 114, 500, 500, 66, 38, 500, 32, 500, 30, 40, 500, 164, 30, 100, 500, 272, 500, 290, 58, 500, 500, 182, 112, 122, 104, 500, 168, 500, 52, 84, 36, 42, 134, 500, 500, 46, 26, 140, 500, 500, 386, 500, 252, 500, 122, 44, 46, 104, 360, 500, 138, 86, 54, 58, 28, 500, 50, 296, 500, 500, 500, 238, 112, 500, 500, 52, 44, 500, 500, 116, 500, 84, 138, 56, 36, 160]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3766381337941877, "mean_inference_ms": 1.1990864178183707, "mean_action_processing_ms": 0.1390366262401254, "mean_env_wait_ms": 0.08355683740293209, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021007299423217773, "StateBufferConnector_ms": 0.0060062408447265625, "ViewRequirementAgentConnector_ms": 0.12300419807434082}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.360999999999822, "episode_len_mean": 262.02, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.5, 40.500000000000014, 40.500000000000014, -50.00000000000044, 3.899999999999615, 46.099999999999994, 29.69999999999998, 18.899999999999828, -50.00000000000044, -50.00000000000044, 11.099999999999717, -50.00000000000044, 42.70000000000001, -50.00000000000044, 45.3, -50.00000000000044, 29.69999999999998, -50.00000000000044, -50.00000000000044, 47.3, 43.10000000000001, -50.00000000000044, 42.10000000000001, -50.00000000000044, 38.700000000000024, -50.00000000000044, -50.00000000000044, 43.50000000000001, 46.3, -50.00000000000044, 46.9, -50.00000000000044, 47.1, 46.099999999999994, -50.00000000000044, 33.70000000000004, 47.1, 40.10000000000002, -50.00000000000044, 22.899999999999885, -50.00000000000044, 21.09999999999986, 44.300000000000004, -50.00000000000044, -50.00000000000044, 31.900000000000013, 38.90000000000002, 37.90000000000003, 39.70000000000002, -50.00000000000044, 33.30000000000003, -50.00000000000044, 44.900000000000006, 41.70000000000002, 46.5, 45.9, 36.70000000000003, -50.00000000000044, -50.00000000000044, 45.5, 47.5, 36.10000000000004, -50.00000000000044, -50.00000000000044, 11.499999999999723, -50.00000000000044, 24.899999999999913, -50.00000000000044, 37.90000000000003, 45.7, 45.5, 39.70000000000002, 14.09999999999976, -50.00000000000044, 36.30000000000003, 41.500000000000014, 44.7, 44.300000000000004, 47.3, -50.00000000000044, 45.1, 20.49999999999985, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.299999999999933, 38.90000000000002, -50.00000000000044, -50.00000000000044, 44.900000000000006, 45.7, -50.00000000000044, -50.00000000000044, 38.50000000000003, -50.00000000000044, 41.70000000000002, 36.30000000000003, 44.5, 46.5, 34.10000000000004], "episode_lengths": [56, 96, 96, 500, 462, 40, 204, 312, 500, 500, 390, 500, 74, 500, 48, 500, 204, 500, 500, 28, 70, 500, 80, 500, 114, 500, 500, 66, 38, 500, 32, 500, 30, 40, 500, 164, 30, 100, 500, 272, 500, 290, 58, 500, 500, 182, 112, 122, 104, 500, 168, 500, 52, 84, 36, 42, 134, 500, 500, 46, 26, 140, 500, 500, 386, 500, 252, 500, 122, 44, 46, 104, 360, 500, 138, 86, 54, 58, 28, 500, 50, 296, 500, 500, 500, 238, 112, 500, 500, 52, 44, 500, 500, 116, 500, 84, 138, 56, 36, 160]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3766381337941877, "mean_inference_ms": 1.1990864178183707, "mean_action_processing_ms": 0.1390366262401254, "mean_env_wait_ms": 0.08355683740293209, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021007299423217773, "StateBufferConnector_ms": 0.0060062408447265625, "ViewRequirementAgentConnector_ms": 0.12300419807434082}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1416000, "num_agent_steps_trained": 1416000, "num_env_steps_sampled": 1416000, "num_env_steps_trained": 1416000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5374.291504071109, "num_env_steps_trained_throughput_per_sec": 5374.291504071109, "timesteps_total": 1416000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1416000, "timers": {"training_iteration_time_ms": 2267.419, "sample_time_ms": 1910.149, "load_time_ms": 11.659, "load_throughput": 1029281.265, "learn_time_ms": 333.968, "learn_throughput": 35931.533, "synch_weights_time_ms": 9.757}, "counters": {"num_env_steps_sampled": 1416000, "num_env_steps_trained": 1416000, "num_agent_steps_sampled": 1416000, "num_agent_steps_trained": 1416000}, "done": false, "episodes_total": 5363, "training_iteration": 118, "trial_id": "9f288_00017", "date": "2023-10-25_17-01-02", "timestamp": 1698249662, "time_this_iter_s": 2.238842487335205, "time_total_s": 268.80464935302734, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 268.80464935302734, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 60.866666666666674, "ram_util_percent": 27.266666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.018531076210114e-37, "cur_lr": 0.0003, "total_loss": 7.202830918629965, "policy_loss": -0.0008715849369764328, "vf_loss": 7.2037522474924724, "vf_explained_var": -9.735425313313801e-07, "kl": 0.001053492578871129, "entropy": 0.4960162917772929, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 3555.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1428000, "num_env_steps_trained": 1428000, "num_agent_steps_sampled": 1428000, "num_agent_steps_trained": 1428000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.527999999999816, "episode_len_mean": 265.34, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.70000000000002, -50.00000000000044, 33.30000000000003, -50.00000000000044, 44.900000000000006, 41.70000000000002, 46.5, 45.9, 36.70000000000003, -50.00000000000044, -50.00000000000044, 45.5, 47.5, 36.10000000000004, -50.00000000000044, -50.00000000000044, 11.499999999999723, -50.00000000000044, 24.899999999999913, -50.00000000000044, 37.90000000000003, 45.7, 45.5, 39.70000000000002, 14.09999999999976, -50.00000000000044, 36.30000000000003, 41.500000000000014, 44.7, 44.300000000000004, 47.3, -50.00000000000044, 45.1, 20.49999999999985, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.299999999999933, 38.90000000000002, -50.00000000000044, -50.00000000000044, 44.900000000000006, 45.7, -50.00000000000044, -50.00000000000044, 38.50000000000003, -50.00000000000044, 41.70000000000002, 36.30000000000003, 44.5, 46.5, 34.10000000000004, -50.00000000000044, 45.3, 41.70000000000002, 42.30000000000001, -50.00000000000044, 46.3, 47.3, -50.00000000000044, 45.3, -50.00000000000044, 44.300000000000004, 33.500000000000036, 40.10000000000002, -50.00000000000044, 19.899999999999842, -50.00000000000044, -50.00000000000044, 44.10000000000001, 46.3, 5.499999999999638, -50.00000000000044, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 45.3, 44.7, -50.00000000000044, 43.30000000000001, 39.50000000000002, -50.00000000000044, 42.900000000000006, -50.00000000000044, 5.499999999999638, -50.00000000000044, -50.00000000000044, 30.099999999999987, 43.900000000000006, -50.00000000000044, -50.00000000000044, 45.3, 45.3, 36.10000000000004, 10.899999999999714, -50.00000000000044, 21.09999999999986], "episode_lengths": [104, 500, 168, 500, 52, 84, 36, 42, 134, 500, 500, 46, 26, 140, 500, 500, 386, 500, 252, 500, 122, 44, 46, 104, 360, 500, 138, 86, 54, 58, 28, 500, 50, 296, 500, 500, 500, 238, 112, 500, 500, 52, 44, 500, 500, 116, 500, 84, 138, 56, 36, 160, 500, 48, 84, 78, 500, 38, 28, 500, 48, 500, 58, 166, 100, 500, 302, 500, 500, 60, 38, 446, 500, 500, 104, 500, 500, 70, 500, 48, 54, 500, 68, 106, 500, 72, 500, 446, 500, 500, 200, 62, 500, 500, 48, 48, 140, 392, 500, 290]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3767005352690599, "mean_inference_ms": 1.199456240986057, "mean_action_processing_ms": 0.13880330048074188, "mean_env_wait_ms": 0.08372514205998635, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02800774574279785, "StateBufferConnector_ms": 0.006003141403198242, "ViewRequirementAgentConnector_ms": 0.13997578620910645}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.527999999999816, "episode_len_mean": 265.34, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [39.70000000000002, -50.00000000000044, 33.30000000000003, -50.00000000000044, 44.900000000000006, 41.70000000000002, 46.5, 45.9, 36.70000000000003, -50.00000000000044, -50.00000000000044, 45.5, 47.5, 36.10000000000004, -50.00000000000044, -50.00000000000044, 11.499999999999723, -50.00000000000044, 24.899999999999913, -50.00000000000044, 37.90000000000003, 45.7, 45.5, 39.70000000000002, 14.09999999999976, -50.00000000000044, 36.30000000000003, 41.500000000000014, 44.7, 44.300000000000004, 47.3, -50.00000000000044, 45.1, 20.49999999999985, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.299999999999933, 38.90000000000002, -50.00000000000044, -50.00000000000044, 44.900000000000006, 45.7, -50.00000000000044, -50.00000000000044, 38.50000000000003, -50.00000000000044, 41.70000000000002, 36.30000000000003, 44.5, 46.5, 34.10000000000004, -50.00000000000044, 45.3, 41.70000000000002, 42.30000000000001, -50.00000000000044, 46.3, 47.3, -50.00000000000044, 45.3, -50.00000000000044, 44.300000000000004, 33.500000000000036, 40.10000000000002, -50.00000000000044, 19.899999999999842, -50.00000000000044, -50.00000000000044, 44.10000000000001, 46.3, 5.499999999999638, -50.00000000000044, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 45.3, 44.7, -50.00000000000044, 43.30000000000001, 39.50000000000002, -50.00000000000044, 42.900000000000006, -50.00000000000044, 5.499999999999638, -50.00000000000044, -50.00000000000044, 30.099999999999987, 43.900000000000006, -50.00000000000044, -50.00000000000044, 45.3, 45.3, 36.10000000000004, 10.899999999999714, -50.00000000000044, 21.09999999999986], "episode_lengths": [104, 500, 168, 500, 52, 84, 36, 42, 134, 500, 500, 46, 26, 140, 500, 500, 386, 500, 252, 500, 122, 44, 46, 104, 360, 500, 138, 86, 54, 58, 28, 500, 50, 296, 500, 500, 500, 238, 112, 500, 500, 52, 44, 500, 500, 116, 500, 84, 138, 56, 36, 160, 500, 48, 84, 78, 500, 38, 28, 500, 48, 500, 58, 166, 100, 500, 302, 500, 500, 60, 38, 446, 500, 500, 104, 500, 500, 70, 500, 48, 54, 500, 68, 106, 500, 72, 500, 446, 500, 500, 200, 62, 500, 500, 48, 48, 140, 392, 500, 290]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3767005352690599, "mean_inference_ms": 1.199456240986057, "mean_action_processing_ms": 0.13880330048074188, "mean_env_wait_ms": 0.08372514205998635, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02800774574279785, "StateBufferConnector_ms": 0.006003141403198242, "ViewRequirementAgentConnector_ms": 0.13997578620910645}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1428000, "num_agent_steps_trained": 1428000, "num_env_steps_sampled": 1428000, "num_env_steps_trained": 1428000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5260.717668837326, "num_env_steps_trained_throughput_per_sec": 5260.717668837326, "timesteps_total": 1428000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1428000, "timers": {"training_iteration_time_ms": 2269.835, "sample_time_ms": 1911.291, "load_time_ms": 11.148, "load_throughput": 1076407.871, "learn_time_ms": 335.732, "learn_throughput": 35742.807, "synch_weights_time_ms": 9.778}, "counters": {"num_env_steps_sampled": 1428000, "num_env_steps_trained": 1428000, "num_agent_steps_sampled": 1428000, "num_agent_steps_trained": 1428000}, "done": false, "episodes_total": 5411, "training_iteration": 119, "trial_id": "9f288_00017", "date": "2023-10-25_17-01-04", "timestamp": 1698249664, "time_this_iter_s": 2.286057949066162, "time_total_s": 271.0907073020935, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 271.0907073020935, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 58.36666666666667, "ram_util_percent": 27.266666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.009265538105057e-37, "cur_lr": 0.0003, "total_loss": 6.324593385060628, "policy_loss": -0.00029498753137886525, "vf_loss": 6.324935611089071, "vf_explained_var": -9.854634602864584e-07, "kl": 0.0008098613273811377, "entropy": 0.4714354892571767, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 3585.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1440000, "num_env_steps_trained": 1440000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.870999999999815, "episode_len_mean": 266.9, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 38.50000000000003, -50.00000000000044, 41.70000000000002, 36.30000000000003, 44.5, 46.5, 34.10000000000004, -50.00000000000044, 45.3, 41.70000000000002, 42.30000000000001, -50.00000000000044, 46.3, 47.3, -50.00000000000044, 45.3, -50.00000000000044, 44.300000000000004, 33.500000000000036, 40.10000000000002, -50.00000000000044, 19.899999999999842, -50.00000000000044, -50.00000000000044, 44.10000000000001, 46.3, 5.499999999999638, -50.00000000000044, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 45.3, 44.7, -50.00000000000044, 43.30000000000001, 39.50000000000002, -50.00000000000044, 42.900000000000006, -50.00000000000044, 5.499999999999638, -50.00000000000044, -50.00000000000044, 30.099999999999987, 43.900000000000006, -50.00000000000044, -50.00000000000044, 45.3, 45.3, 36.10000000000004, 10.899999999999714, -50.00000000000044, 21.09999999999986, 43.900000000000006, 26.299999999999933, 38.300000000000026, 46.099999999999994, -50.00000000000044, 40.500000000000014, -50.00000000000044, 22.299999999999876, 42.70000000000001, 34.10000000000004, -50.00000000000044, -50.00000000000044, 31.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 43.7, -50.00000000000044, 44.900000000000006, 41.70000000000002, -50.00000000000044, 35.70000000000003, 47.7, 39.300000000000026, 34.70000000000004, 46.099999999999994, 46.5, 46.3, 44.300000000000004, -50.00000000000044, 46.699999999999996, 14.499999999999766, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 33.10000000000003, 46.3, -50.00000000000044, -50.00000000000044, 25.29999999999992], "episode_lengths": [500, 116, 500, 84, 138, 56, 36, 160, 500, 48, 84, 78, 500, 38, 28, 500, 48, 500, 58, 166, 100, 500, 302, 500, 500, 60, 38, 446, 500, 500, 104, 500, 500, 70, 500, 48, 54, 500, 68, 106, 500, 72, 500, 446, 500, 500, 200, 62, 500, 500, 48, 48, 140, 392, 500, 290, 62, 238, 118, 40, 500, 96, 500, 278, 74, 160, 500, 500, 184, 500, 500, 500, 500, 32, 64, 500, 52, 84, 500, 144, 24, 108, 154, 40, 36, 38, 58, 500, 34, 356, 500, 500, 500, 500, 28, 170, 38, 500, 500, 248]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3763852928097671, "mean_inference_ms": 1.200230677068682, "mean_action_processing_ms": 0.13896016159317423, "mean_env_wait_ms": 0.08381572260008856, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03500676155090332, "StateBufferConnector_ms": 0.006997585296630859, "ViewRequirementAgentConnector_ms": 0.12502050399780273}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.870999999999815, "episode_len_mean": 266.9, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 38.50000000000003, -50.00000000000044, 41.70000000000002, 36.30000000000003, 44.5, 46.5, 34.10000000000004, -50.00000000000044, 45.3, 41.70000000000002, 42.30000000000001, -50.00000000000044, 46.3, 47.3, -50.00000000000044, 45.3, -50.00000000000044, 44.300000000000004, 33.500000000000036, 40.10000000000002, -50.00000000000044, 19.899999999999842, -50.00000000000044, -50.00000000000044, 44.10000000000001, 46.3, 5.499999999999638, -50.00000000000044, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 45.3, 44.7, -50.00000000000044, 43.30000000000001, 39.50000000000002, -50.00000000000044, 42.900000000000006, -50.00000000000044, 5.499999999999638, -50.00000000000044, -50.00000000000044, 30.099999999999987, 43.900000000000006, -50.00000000000044, -50.00000000000044, 45.3, 45.3, 36.10000000000004, 10.899999999999714, -50.00000000000044, 21.09999999999986, 43.900000000000006, 26.299999999999933, 38.300000000000026, 46.099999999999994, -50.00000000000044, 40.500000000000014, -50.00000000000044, 22.299999999999876, 42.70000000000001, 34.10000000000004, -50.00000000000044, -50.00000000000044, 31.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 43.7, -50.00000000000044, 44.900000000000006, 41.70000000000002, -50.00000000000044, 35.70000000000003, 47.7, 39.300000000000026, 34.70000000000004, 46.099999999999994, 46.5, 46.3, 44.300000000000004, -50.00000000000044, 46.699999999999996, 14.499999999999766, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 33.10000000000003, 46.3, -50.00000000000044, -50.00000000000044, 25.29999999999992], "episode_lengths": [500, 116, 500, 84, 138, 56, 36, 160, 500, 48, 84, 78, 500, 38, 28, 500, 48, 500, 58, 166, 100, 500, 302, 500, 500, 60, 38, 446, 500, 500, 104, 500, 500, 70, 500, 48, 54, 500, 68, 106, 500, 72, 500, 446, 500, 500, 200, 62, 500, 500, 48, 48, 140, 392, 500, 290, 62, 238, 118, 40, 500, 96, 500, 278, 74, 160, 500, 500, 184, 500, 500, 500, 500, 32, 64, 500, 52, 84, 500, 144, 24, 108, 154, 40, 36, 38, 58, 500, 34, 356, 500, 500, 500, 500, 28, 170, 38, 500, 500, 248]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3763852928097671, "mean_inference_ms": 1.200230677068682, "mean_action_processing_ms": 0.13896016159317423, "mean_env_wait_ms": 0.08381572260008856, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03500676155090332, "StateBufferConnector_ms": 0.006997585296630859, "ViewRequirementAgentConnector_ms": 0.12502050399780273}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000, "num_env_steps_sampled": 1440000, "num_env_steps_trained": 1440000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5392.055137074024, "num_env_steps_trained_throughput_per_sec": 5392.055137074024, "timesteps_total": 1440000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1440000, "timers": {"training_iteration_time_ms": 2273.345, "sample_time_ms": 1908.012, "load_time_ms": 11.318, "load_throughput": 1060301.164, "learn_time_ms": 342.549, "learn_throughput": 35031.525, "synch_weights_time_ms": 9.681}, "counters": {"num_env_steps_sampled": 1440000, "num_env_steps_trained": 1440000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "done": false, "episodes_total": 5455, "training_iteration": 120, "trial_id": "9f288_00017", "date": "2023-10-25_17-01-06", "timestamp": 1698249666, "time_this_iter_s": 2.2294962406158447, "time_total_s": 273.32020354270935, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 273.32020354270935, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 56.70000000000001, "ram_util_percent": 27.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.5046327690525285e-37, "cur_lr": 0.0003, "total_loss": 6.466309038798014, "policy_loss": -0.00042721784363190335, "vf_loss": 6.46677885055542, "vf_explained_var": -9.854634602864584e-07, "kl": 0.0008054903480323598, "entropy": 0.4268395960330963, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 3615.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1452000, "num_env_steps_trained": 1452000, "num_agent_steps_sampled": 1452000, "num_agent_steps_trained": 1452000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.492999999999816, "episode_len_mean": 260.68, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [30.099999999999987, 43.900000000000006, -50.00000000000044, -50.00000000000044, 45.3, 45.3, 36.10000000000004, 10.899999999999714, -50.00000000000044, 21.09999999999986, 43.900000000000006, 26.299999999999933, 38.300000000000026, 46.099999999999994, -50.00000000000044, 40.500000000000014, -50.00000000000044, 22.299999999999876, 42.70000000000001, 34.10000000000004, -50.00000000000044, -50.00000000000044, 31.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 43.7, -50.00000000000044, 44.900000000000006, 41.70000000000002, -50.00000000000044, 35.70000000000003, 47.7, 39.300000000000026, 34.70000000000004, 46.099999999999994, 46.5, 46.3, 44.300000000000004, -50.00000000000044, 46.699999999999996, 14.499999999999766, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 33.10000000000003, 46.3, -50.00000000000044, -50.00000000000044, 25.29999999999992, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, 45.3, 45.1, 46.5, 43.30000000000001, 47.1, 45.5, 46.699999999999996, 46.5, 8.49999999999968, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, 40.70000000000002, -50.00000000000044, 46.099999999999994, -50.00000000000044, 43.900000000000006, -50.00000000000044, 34.900000000000034, 41.30000000000001, 46.9, 45.5, -50.00000000000044, 44.900000000000006, 47.1, 7.699999999999669, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 42.500000000000014, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 33.10000000000003, 42.500000000000014], "episode_lengths": [200, 62, 500, 500, 48, 48, 140, 392, 500, 290, 62, 238, 118, 40, 500, 96, 500, 278, 74, 160, 500, 500, 184, 500, 500, 500, 500, 32, 64, 500, 52, 84, 500, 144, 24, 108, 154, 40, 36, 38, 58, 500, 34, 356, 500, 500, 500, 500, 28, 170, 38, 500, 500, 248, 500, 500, 500, 500, 96, 48, 50, 36, 68, 30, 46, 34, 36, 416, 500, 500, 500, 98, 500, 94, 500, 40, 500, 62, 500, 152, 88, 32, 46, 500, 52, 30, 424, 500, 500, 36, 500, 76, 44, 500, 500, 500, 500, 50, 170, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.376141229429458, "mean_inference_ms": 1.1998594360022314, "mean_action_processing_ms": 0.13918936822045144, "mean_env_wait_ms": 0.08362525793813046, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023998022079467773, "StateBufferConnector_ms": 0.008997440338134766, "ViewRequirementAgentConnector_ms": 0.11503124237060547}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.492999999999816, "episode_len_mean": 260.68, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [30.099999999999987, 43.900000000000006, -50.00000000000044, -50.00000000000044, 45.3, 45.3, 36.10000000000004, 10.899999999999714, -50.00000000000044, 21.09999999999986, 43.900000000000006, 26.299999999999933, 38.300000000000026, 46.099999999999994, -50.00000000000044, 40.500000000000014, -50.00000000000044, 22.299999999999876, 42.70000000000001, 34.10000000000004, -50.00000000000044, -50.00000000000044, 31.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 43.7, -50.00000000000044, 44.900000000000006, 41.70000000000002, -50.00000000000044, 35.70000000000003, 47.7, 39.300000000000026, 34.70000000000004, 46.099999999999994, 46.5, 46.3, 44.300000000000004, -50.00000000000044, 46.699999999999996, 14.499999999999766, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 33.10000000000003, 46.3, -50.00000000000044, -50.00000000000044, 25.29999999999992, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, 45.3, 45.1, 46.5, 43.30000000000001, 47.1, 45.5, 46.699999999999996, 46.5, 8.49999999999968, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, 40.70000000000002, -50.00000000000044, 46.099999999999994, -50.00000000000044, 43.900000000000006, -50.00000000000044, 34.900000000000034, 41.30000000000001, 46.9, 45.5, -50.00000000000044, 44.900000000000006, 47.1, 7.699999999999669, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 42.500000000000014, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 33.10000000000003, 42.500000000000014], "episode_lengths": [200, 62, 500, 500, 48, 48, 140, 392, 500, 290, 62, 238, 118, 40, 500, 96, 500, 278, 74, 160, 500, 500, 184, 500, 500, 500, 500, 32, 64, 500, 52, 84, 500, 144, 24, 108, 154, 40, 36, 38, 58, 500, 34, 356, 500, 500, 500, 500, 28, 170, 38, 500, 500, 248, 500, 500, 500, 500, 96, 48, 50, 36, 68, 30, 46, 34, 36, 416, 500, 500, 500, 98, 500, 94, 500, 40, 500, 62, 500, 152, 88, 32, 46, 500, 52, 30, 424, 500, 500, 36, 500, 76, 44, 500, 500, 500, 500, 50, 170, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.376141229429458, "mean_inference_ms": 1.1998594360022314, "mean_action_processing_ms": 0.13918936822045144, "mean_env_wait_ms": 0.08362525793813046, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023998022079467773, "StateBufferConnector_ms": 0.008997440338134766, "ViewRequirementAgentConnector_ms": 0.11503124237060547}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1452000, "num_agent_steps_trained": 1452000, "num_env_steps_sampled": 1452000, "num_env_steps_trained": 1452000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5145.308864832572, "num_env_steps_trained_throughput_per_sec": 5145.308864832572, "timesteps_total": 1452000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1452000, "timers": {"training_iteration_time_ms": 2279.149, "sample_time_ms": 1909.196, "load_time_ms": 12.015, "load_throughput": 998786.493, "learn_time_ms": 346.561, "learn_throughput": 34625.97, "synch_weights_time_ms": 9.691}, "counters": {"num_env_steps_sampled": 1452000, "num_env_steps_trained": 1452000, "num_agent_steps_sampled": 1452000, "num_agent_steps_trained": 1452000}, "done": false, "episodes_total": 5501, "training_iteration": 121, "trial_id": "9f288_00017", "date": "2023-10-25_17-01-09", "timestamp": 1698249669, "time_this_iter_s": 2.3372268676757812, "time_total_s": 275.65743041038513, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 275.65743041038513, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 51.3, "ram_util_percent": 27.25}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.523163845262643e-38, "cur_lr": 0.0003, "total_loss": 6.050099039077759, "policy_loss": -0.00043804599748303494, "vf_loss": 6.050576543807983, "vf_explained_var": -9.973843892415365e-07, "kl": 0.000853994073834959, "entropy": 0.3936866084734599, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 3645.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1464000, "num_env_steps_trained": 1464000, "num_agent_steps_sampled": 1464000, "num_agent_steps_trained": 1464000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.8510000000002151, "episode_len_mean": 284.04, "episode_media": {}, "episodes_this_iter": 35, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.300000000000026, 34.70000000000004, 46.099999999999994, 46.5, 46.3, 44.300000000000004, -50.00000000000044, 46.699999999999996, 14.499999999999766, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 33.10000000000003, 46.3, -50.00000000000044, -50.00000000000044, 25.29999999999992, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, 45.3, 45.1, 46.5, 43.30000000000001, 47.1, 45.5, 46.699999999999996, 46.5, 8.49999999999968, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, 40.70000000000002, -50.00000000000044, 46.099999999999994, -50.00000000000044, 43.900000000000006, -50.00000000000044, 34.900000000000034, 41.30000000000001, 46.9, 45.5, -50.00000000000044, 44.900000000000006, 47.1, 7.699999999999669, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 42.500000000000014, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 33.10000000000003, 42.500000000000014, -50.00000000000044, 45.3, 35.70000000000003, 46.3, -50.00000000000044, 26.89999999999994, 46.9, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.099999999999987, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 46.699999999999996, -50.00000000000044, 46.699999999999996, 34.50000000000004], "episode_lengths": [108, 154, 40, 36, 38, 58, 500, 34, 356, 500, 500, 500, 500, 28, 170, 38, 500, 500, 248, 500, 500, 500, 500, 96, 48, 50, 36, 68, 30, 46, 34, 36, 416, 500, 500, 500, 98, 500, 94, 500, 40, 500, 62, 500, 152, 88, 32, 46, 500, 52, 30, 424, 500, 500, 36, 500, 76, 44, 500, 500, 500, 500, 50, 170, 76, 500, 48, 144, 38, 500, 232, 32, 500, 500, 54, 500, 40, 500, 500, 500, 50, 500, 500, 500, 200, 500, 500, 500, 500, 500, 500, 40, 500, 500, 500, 64, 34, 500, 34, 156]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3762659580118686, "mean_inference_ms": 1.2003013883782463, "mean_action_processing_ms": 0.13917111494528334, "mean_env_wait_ms": 0.0836507092559489, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021001100540161133, "StateBufferConnector_ms": 0.009000301361083984, "ViewRequirementAgentConnector_ms": 0.09699082374572754}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.8510000000002151, "episode_len_mean": 284.04, "episodes_this_iter": 35, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [39.300000000000026, 34.70000000000004, 46.099999999999994, 46.5, 46.3, 44.300000000000004, -50.00000000000044, 46.699999999999996, 14.499999999999766, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 33.10000000000003, 46.3, -50.00000000000044, -50.00000000000044, 25.29999999999992, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, 45.3, 45.1, 46.5, 43.30000000000001, 47.1, 45.5, 46.699999999999996, 46.5, 8.49999999999968, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, 40.70000000000002, -50.00000000000044, 46.099999999999994, -50.00000000000044, 43.900000000000006, -50.00000000000044, 34.900000000000034, 41.30000000000001, 46.9, 45.5, -50.00000000000044, 44.900000000000006, 47.1, 7.699999999999669, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 42.500000000000014, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 33.10000000000003, 42.500000000000014, -50.00000000000044, 45.3, 35.70000000000003, 46.3, -50.00000000000044, 26.89999999999994, 46.9, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.099999999999987, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 46.699999999999996, -50.00000000000044, 46.699999999999996, 34.50000000000004], "episode_lengths": [108, 154, 40, 36, 38, 58, 500, 34, 356, 500, 500, 500, 500, 28, 170, 38, 500, 500, 248, 500, 500, 500, 500, 96, 48, 50, 36, 68, 30, 46, 34, 36, 416, 500, 500, 500, 98, 500, 94, 500, 40, 500, 62, 500, 152, 88, 32, 46, 500, 52, 30, 424, 500, 500, 36, 500, 76, 44, 500, 500, 500, 500, 50, 170, 76, 500, 48, 144, 38, 500, 232, 32, 500, 500, 54, 500, 40, 500, 500, 500, 50, 500, 500, 500, 200, 500, 500, 500, 500, 500, 500, 40, 500, 500, 500, 64, 34, 500, 34, 156]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3762659580118686, "mean_inference_ms": 1.2003013883782463, "mean_action_processing_ms": 0.13917111494528334, "mean_env_wait_ms": 0.0836507092559489, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021001100540161133, "StateBufferConnector_ms": 0.009000301361083984, "ViewRequirementAgentConnector_ms": 0.09699082374572754}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1464000, "num_agent_steps_trained": 1464000, "num_env_steps_sampled": 1464000, "num_env_steps_trained": 1464000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5596.0440055022445, "num_env_steps_trained_throughput_per_sec": 5596.0440055022445, "timesteps_total": 1464000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1464000, "timers": {"training_iteration_time_ms": 2266.789, "sample_time_ms": 1909.159, "load_time_ms": 11.612, "load_throughput": 1033453.136, "learn_time_ms": 335.015, "learn_throughput": 35819.341, "synch_weights_time_ms": 9.215}, "counters": {"num_env_steps_sampled": 1464000, "num_env_steps_trained": 1464000, "num_agent_steps_sampled": 1464000, "num_agent_steps_trained": 1464000}, "done": false, "episodes_total": 5536, "training_iteration": 122, "trial_id": "9f288_00017", "date": "2023-10-25_17-01-11", "timestamp": 1698249671, "time_this_iter_s": 2.1487503051757812, "time_total_s": 277.8061807155609, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 277.8061807155609, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 60.53333333333333, "ram_util_percent": 27.266666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.7615819226313213e-38, "cur_lr": 0.0003, "total_loss": 6.311528078715006, "policy_loss": -1.4773538957039516e-05, "vf_loss": 6.311583105723063, "vf_explained_var": -9.65595245361328e-07, "kl": 0.0002492409710233308, "entropy": 0.4027795195579529, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 3675.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1476000, "num_env_steps_trained": 1476000, "num_agent_steps_sampled": 1476000, "num_agent_steps_trained": 1476000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -4.122000000000228, "episode_len_mean": 291.72, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.9, 45.5, -50.00000000000044, 44.900000000000006, 47.1, 7.699999999999669, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 42.500000000000014, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 33.10000000000003, 42.500000000000014, -50.00000000000044, 45.3, 35.70000000000003, 46.3, -50.00000000000044, 26.89999999999994, 46.9, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.099999999999987, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 46.699999999999996, -50.00000000000044, 46.699999999999996, 34.50000000000004, -50.00000000000044, -50.00000000000044, 21.89999999999987, -50.00000000000044, 42.70000000000001, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.5, 45.3, 47.5, -50.00000000000044, 43.7, -50.00000000000044, 46.099999999999994, -50.00000000000044, 45.5, 29.899999999999984, 47.5, 46.3, -50.00000000000044, 46.5, 27.699999999999953, 45.7, 44.7, -50.00000000000044, -50.00000000000044, 46.3, 46.699999999999996, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 47.5, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 23.699999999999896, 46.5], "episode_lengths": [32, 46, 500, 52, 30, 424, 500, 500, 36, 500, 76, 44, 500, 500, 500, 500, 50, 170, 76, 500, 48, 144, 38, 500, 232, 32, 500, 500, 54, 500, 40, 500, 500, 500, 50, 500, 500, 500, 200, 500, 500, 500, 500, 500, 500, 40, 500, 500, 500, 64, 34, 500, 34, 156, 500, 500, 282, 500, 74, 500, 40, 500, 500, 56, 48, 26, 500, 64, 500, 40, 500, 46, 202, 26, 38, 500, 36, 224, 44, 54, 500, 500, 38, 34, 500, 98, 500, 500, 36, 500, 500, 74, 500, 26, 500, 64, 500, 500, 264, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37644115062502015, "mean_inference_ms": 1.1995751125993004, "mean_action_processing_ms": 0.13911332547867875, "mean_env_wait_ms": 0.08364937503053539, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023005247116088867, "StateBufferConnector_ms": 0.010409355163574219, "ViewRequirementAgentConnector_ms": 0.10200285911560059}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -4.122000000000228, "episode_len_mean": 291.72, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.9, 45.5, -50.00000000000044, 44.900000000000006, 47.1, 7.699999999999669, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 42.500000000000014, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 33.10000000000003, 42.500000000000014, -50.00000000000044, 45.3, 35.70000000000003, 46.3, -50.00000000000044, 26.89999999999994, 46.9, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.099999999999987, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 46.699999999999996, -50.00000000000044, 46.699999999999996, 34.50000000000004, -50.00000000000044, -50.00000000000044, 21.89999999999987, -50.00000000000044, 42.70000000000001, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.5, 45.3, 47.5, -50.00000000000044, 43.7, -50.00000000000044, 46.099999999999994, -50.00000000000044, 45.5, 29.899999999999984, 47.5, 46.3, -50.00000000000044, 46.5, 27.699999999999953, 45.7, 44.7, -50.00000000000044, -50.00000000000044, 46.3, 46.699999999999996, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 47.5, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 23.699999999999896, 46.5], "episode_lengths": [32, 46, 500, 52, 30, 424, 500, 500, 36, 500, 76, 44, 500, 500, 500, 500, 50, 170, 76, 500, 48, 144, 38, 500, 232, 32, 500, 500, 54, 500, 40, 500, 500, 500, 50, 500, 500, 500, 200, 500, 500, 500, 500, 500, 500, 40, 500, 500, 500, 64, 34, 500, 34, 156, 500, 500, 282, 500, 74, 500, 40, 500, 500, 56, 48, 26, 500, 64, 500, 40, 500, 46, 202, 26, 38, 500, 36, 224, 44, 54, 500, 500, 38, 34, 500, 98, 500, 500, 36, 500, 500, 74, 500, 26, 500, 64, 500, 500, 264, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37644115062502015, "mean_inference_ms": 1.1995751125993004, "mean_action_processing_ms": 0.13911332547867875, "mean_env_wait_ms": 0.08364937503053539, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023005247116088867, "StateBufferConnector_ms": 0.010409355163574219, "ViewRequirementAgentConnector_ms": 0.10200285911560059}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1476000, "num_agent_steps_trained": 1476000, "num_env_steps_sampled": 1476000, "num_env_steps_trained": 1476000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5497.93733059141, "num_env_steps_trained_throughput_per_sec": 5497.93733059141, "timesteps_total": 1476000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1476000, "timers": {"training_iteration_time_ms": 2249.275, "sample_time_ms": 1901.63, "load_time_ms": 10.837, "load_throughput": 1107268.131, "learn_time_ms": 325.815, "learn_throughput": 36830.764, "synch_weights_time_ms": 9.191}, "counters": {"num_env_steps_sampled": 1476000, "num_env_steps_trained": 1476000, "num_agent_steps_sampled": 1476000, "num_agent_steps_trained": 1476000}, "done": false, "episodes_total": 5582, "training_iteration": 123, "trial_id": "9f288_00017", "date": "2023-10-25_17-01-13", "timestamp": 1698249673, "time_this_iter_s": 2.187314987182617, "time_total_s": 279.99349570274353, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 279.99349570274353, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 58.36666666666667, "ram_util_percent": 27.266666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.8807909613156606e-38, "cur_lr": 0.0003, "total_loss": 6.334561904271443, "policy_loss": -0.00012089374164740245, "vf_loss": 6.334726254145305, "vf_explained_var": -9.775161743164062e-07, "kl": 0.0002772682642178855, "entropy": 0.433245379726092, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 3705.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1488000, "num_env_steps_trained": 1488000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.5009999999998134, "episode_len_mean": 260.58, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 46.699999999999996, -50.00000000000044, 46.699999999999996, 34.50000000000004, -50.00000000000044, -50.00000000000044, 21.89999999999987, -50.00000000000044, 42.70000000000001, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.5, 45.3, 47.5, -50.00000000000044, 43.7, -50.00000000000044, 46.099999999999994, -50.00000000000044, 45.5, 29.899999999999984, 47.5, 46.3, -50.00000000000044, 46.5, 27.699999999999953, 45.7, 44.7, -50.00000000000044, -50.00000000000044, 46.3, 46.699999999999996, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 47.5, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 23.699999999999896, 46.5, 41.100000000000016, 29.099999999999973, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.10000000000003, 39.10000000000002, -50.00000000000044, 20.299999999999848, 46.3, -50.00000000000044, -50.00000000000044, 44.5, 46.699999999999996, 38.90000000000002, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 45.7, 31.1, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 39.300000000000026, 34.30000000000004, -50.00000000000044, 36.10000000000004, 28.699999999999967, 45.7, 47.3, -50.00000000000044, 16.8999999999998, 45.9, 28.29999999999996, 46.099999999999994, 28.699999999999967, 46.3, 35.900000000000034, 43.10000000000001, -50.00000000000044, 44.10000000000001], "episode_lengths": [500, 500, 500, 64, 34, 500, 34, 156, 500, 500, 282, 500, 74, 500, 40, 500, 500, 56, 48, 26, 500, 64, 500, 40, 500, 46, 202, 26, 38, 500, 36, 224, 44, 54, 500, 500, 38, 34, 500, 98, 500, 500, 36, 500, 500, 74, 500, 26, 500, 64, 500, 500, 264, 36, 90, 210, 34, 500, 500, 500, 130, 110, 500, 298, 38, 500, 500, 56, 34, 112, 500, 38, 500, 500, 44, 190, 36, 500, 500, 500, 500, 32, 108, 158, 500, 140, 214, 44, 28, 500, 332, 42, 218, 40, 214, 38, 142, 70, 500, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37665428953617874, "mean_inference_ms": 1.1990034682616955, "mean_action_processing_ms": 0.1390089010258031, "mean_env_wait_ms": 0.08345893714113674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027012109756469727, "StateBufferConnector_ms": 0.006408214569091797, "ViewRequirementAgentConnector_ms": 0.11299824714660645}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.5009999999998134, "episode_len_mean": 260.58, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 46.699999999999996, -50.00000000000044, 46.699999999999996, 34.50000000000004, -50.00000000000044, -50.00000000000044, 21.89999999999987, -50.00000000000044, 42.70000000000001, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.5, 45.3, 47.5, -50.00000000000044, 43.7, -50.00000000000044, 46.099999999999994, -50.00000000000044, 45.5, 29.899999999999984, 47.5, 46.3, -50.00000000000044, 46.5, 27.699999999999953, 45.7, 44.7, -50.00000000000044, -50.00000000000044, 46.3, 46.699999999999996, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 47.5, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 23.699999999999896, 46.5, 41.100000000000016, 29.099999999999973, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.10000000000003, 39.10000000000002, -50.00000000000044, 20.299999999999848, 46.3, -50.00000000000044, -50.00000000000044, 44.5, 46.699999999999996, 38.90000000000002, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 45.7, 31.1, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 39.300000000000026, 34.30000000000004, -50.00000000000044, 36.10000000000004, 28.699999999999967, 45.7, 47.3, -50.00000000000044, 16.8999999999998, 45.9, 28.29999999999996, 46.099999999999994, 28.699999999999967, 46.3, 35.900000000000034, 43.10000000000001, -50.00000000000044, 44.10000000000001], "episode_lengths": [500, 500, 500, 64, 34, 500, 34, 156, 500, 500, 282, 500, 74, 500, 40, 500, 500, 56, 48, 26, 500, 64, 500, 40, 500, 46, 202, 26, 38, 500, 36, 224, 44, 54, 500, 500, 38, 34, 500, 98, 500, 500, 36, 500, 500, 74, 500, 26, 500, 64, 500, 500, 264, 36, 90, 210, 34, 500, 500, 500, 130, 110, 500, 298, 38, 500, 500, 56, 34, 112, 500, 38, 500, 500, 44, 190, 36, 500, 500, 500, 500, 32, 108, 158, 500, 140, 214, 44, 28, 500, 332, 42, 218, 40, 214, 38, 142, 70, 500, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37665428953617874, "mean_inference_ms": 1.1990034682616955, "mean_action_processing_ms": 0.1390089010258031, "mean_env_wait_ms": 0.08345893714113674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027012109756469727, "StateBufferConnector_ms": 0.006408214569091797, "ViewRequirementAgentConnector_ms": 0.11299824714660645}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000, "num_env_steps_sampled": 1488000, "num_env_steps_trained": 1488000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5096.9609112456055, "num_env_steps_trained_throughput_per_sec": 5096.9609112456055, "timesteps_total": 1488000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1488000, "timers": {"training_iteration_time_ms": 2263.18, "sample_time_ms": 1901.491, "load_time_ms": 11.822, "load_throughput": 1015086.601, "learn_time_ms": 338.96, "learn_throughput": 35402.419, "synch_weights_time_ms": 9.006}, "counters": {"num_env_steps_sampled": 1488000, "num_env_steps_trained": 1488000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "done": false, "episodes_total": 5628, "training_iteration": 124, "trial_id": "9f288_00017", "date": "2023-10-25_17-01-16", "timestamp": 1698249676, "time_this_iter_s": 2.360344409942627, "time_total_s": 282.35384011268616, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 282.35384011268616, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 59.96666666666667, "ram_util_percent": 27.266666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.403954806578303e-39, "cur_lr": 0.0003, "total_loss": 6.677083237965902, "policy_loss": -0.0003166268269220988, "vf_loss": 6.677444807688395, "vf_explained_var": -1.0132789611816406e-06, "kl": 0.0005097888826981034, "entropy": 0.4492207070191701, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 3735.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1500000, "num_env_steps_trained": 1500000, "num_agent_steps_sampled": 1500000, "num_agent_steps_trained": 1500000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.391999999999848, "episode_len_mean": 236.76, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [23.699999999999896, 46.5, 41.100000000000016, 29.099999999999973, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.10000000000003, 39.10000000000002, -50.00000000000044, 20.299999999999848, 46.3, -50.00000000000044, -50.00000000000044, 44.5, 46.699999999999996, 38.90000000000002, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 45.7, 31.1, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 39.300000000000026, 34.30000000000004, -50.00000000000044, 36.10000000000004, 28.699999999999967, 45.7, 47.3, -50.00000000000044, 16.8999999999998, 45.9, 28.29999999999996, 46.099999999999994, 28.699999999999967, 46.3, 35.900000000000034, 43.10000000000001, -50.00000000000044, 44.10000000000001, -50.00000000000044, 43.50000000000001, -50.00000000000044, 46.5, 12.099999999999731, 45.5, 45.1, 43.900000000000006, 45.1, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 12.099999999999731, 28.499999999999964, 40.90000000000002, 39.10000000000002, 47.1, -50.00000000000044, 29.299999999999976, 42.30000000000001, 18.699999999999825, 42.500000000000014, -50.00000000000044, 47.3, 44.5, -50.00000000000044, 12.69999999999974, 46.099999999999994, 34.10000000000004, 46.699999999999996, 45.9, -50.00000000000044, 47.1, 33.70000000000004, 37.50000000000003, 47.3, 45.5, -50.00000000000044, -50.00000000000044, 43.900000000000006, 43.7, 38.50000000000003, -50.00000000000044, 46.5, 43.10000000000001, -50.00000000000044, -50.00000000000044, 33.90000000000004, 28.699999999999967, -50.00000000000044, -50.00000000000044], "episode_lengths": [264, 36, 90, 210, 34, 500, 500, 500, 130, 110, 500, 298, 38, 500, 500, 56, 34, 112, 500, 38, 500, 500, 44, 190, 36, 500, 500, 500, 500, 32, 108, 158, 500, 140, 214, 44, 28, 500, 332, 42, 218, 40, 214, 38, 142, 70, 500, 60, 500, 66, 500, 36, 380, 46, 50, 62, 50, 30, 500, 500, 500, 380, 216, 92, 110, 30, 500, 208, 78, 314, 76, 500, 28, 56, 500, 374, 40, 160, 34, 42, 500, 30, 164, 126, 28, 46, 500, 500, 62, 64, 116, 500, 36, 70, 500, 500, 162, 214, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37661993338682287, "mean_inference_ms": 1.1994943169297607, "mean_action_processing_ms": 0.13899887313212106, "mean_env_wait_ms": 0.08354969627301528, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03000664710998535, "StateBufferConnector_ms": 0.0030014514923095703, "ViewRequirementAgentConnector_ms": 0.11993074417114258}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.391999999999848, "episode_len_mean": 236.76, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [23.699999999999896, 46.5, 41.100000000000016, 29.099999999999973, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.10000000000003, 39.10000000000002, -50.00000000000044, 20.299999999999848, 46.3, -50.00000000000044, -50.00000000000044, 44.5, 46.699999999999996, 38.90000000000002, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 45.7, 31.1, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 39.300000000000026, 34.30000000000004, -50.00000000000044, 36.10000000000004, 28.699999999999967, 45.7, 47.3, -50.00000000000044, 16.8999999999998, 45.9, 28.29999999999996, 46.099999999999994, 28.699999999999967, 46.3, 35.900000000000034, 43.10000000000001, -50.00000000000044, 44.10000000000001, -50.00000000000044, 43.50000000000001, -50.00000000000044, 46.5, 12.099999999999731, 45.5, 45.1, 43.900000000000006, 45.1, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 12.099999999999731, 28.499999999999964, 40.90000000000002, 39.10000000000002, 47.1, -50.00000000000044, 29.299999999999976, 42.30000000000001, 18.699999999999825, 42.500000000000014, -50.00000000000044, 47.3, 44.5, -50.00000000000044, 12.69999999999974, 46.099999999999994, 34.10000000000004, 46.699999999999996, 45.9, -50.00000000000044, 47.1, 33.70000000000004, 37.50000000000003, 47.3, 45.5, -50.00000000000044, -50.00000000000044, 43.900000000000006, 43.7, 38.50000000000003, -50.00000000000044, 46.5, 43.10000000000001, -50.00000000000044, -50.00000000000044, 33.90000000000004, 28.699999999999967, -50.00000000000044, -50.00000000000044], "episode_lengths": [264, 36, 90, 210, 34, 500, 500, 500, 130, 110, 500, 298, 38, 500, 500, 56, 34, 112, 500, 38, 500, 500, 44, 190, 36, 500, 500, 500, 500, 32, 108, 158, 500, 140, 214, 44, 28, 500, 332, 42, 218, 40, 214, 38, 142, 70, 500, 60, 500, 66, 500, 36, 380, 46, 50, 62, 50, 30, 500, 500, 500, 380, 216, 92, 110, 30, 500, 208, 78, 314, 76, 500, 28, 56, 500, 374, 40, 160, 34, 42, 500, 30, 164, 126, 28, 46, 500, 500, 62, 64, 116, 500, 36, 70, 500, 500, 162, 214, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37661993338682287, "mean_inference_ms": 1.1994943169297607, "mean_action_processing_ms": 0.13899887313212106, "mean_env_wait_ms": 0.08354969627301528, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03000664710998535, "StateBufferConnector_ms": 0.0030014514923095703, "ViewRequirementAgentConnector_ms": 0.11993074417114258}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1500000, "num_agent_steps_trained": 1500000, "num_env_steps_sampled": 1500000, "num_env_steps_trained": 1500000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5420.759980096887, "num_env_steps_trained_throughput_per_sec": 5420.759980096887, "timesteps_total": 1500000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1500000, "timers": {"training_iteration_time_ms": 2255.016, "sample_time_ms": 1898.201, "load_time_ms": 11.299, "load_throughput": 1062057.492, "learn_time_ms": 334.572, "learn_throughput": 35866.67, "synch_weights_time_ms": 9.063}, "counters": {"num_env_steps_sampled": 1500000, "num_env_steps_trained": 1500000, "num_agent_steps_sampled": 1500000, "num_agent_steps_trained": 1500000}, "done": true, "episodes_total": 5680, "training_iteration": 125, "trial_id": "9f288_00017", "date": "2023-10-25_17-01-18", "timestamp": 1698249678, "time_this_iter_s": 2.218712329864502, "time_total_s": 284.57255244255066, "pid": 18720, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 284.57255244255066, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 57.133333333333326, "ram_util_percent": 27.233333333333334}}
