{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000007, "cur_lr": 0.0003, "total_loss": 9.470144462585449, "policy_loss": -0.0017436298231283823, "vf_loss": 9.471407636006672, "vf_explained_var": 3.244479497273763e-05, "kl": 0.002759616029646052, "entropy": 0.7128815690676371, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 8.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "sampler_results": {"episode_reward_max": 41.500000000000014, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -34.148000000000366, "episode_len_mean": 441.68, "episode_media": {}, "episodes_this_iter": 25, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 32.100000000000016, 2.499999999999595, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, 31.900000000000013, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 180, 476, 500, 500, 500, 500, 500, 500, 500, 500, 500, 86, 500, 500, 500, 500, 500, 500, 500, 118, 500, 182, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3817363742824558, "mean_inference_ms": 1.221415960824454, "mean_action_processing_ms": 0.1415240395438302, "mean_env_wait_ms": 0.08301501507525678, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020005226135253906, "StateBufferConnector_ms": 0.019995689392089844, "ViewRequirementAgentConnector_ms": 0.1520671844482422}}, "episode_reward_max": 41.500000000000014, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -34.148000000000366, "episode_len_mean": 441.68, "episodes_this_iter": 25, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 32.100000000000016, 2.499999999999595, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, 31.900000000000013, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 180, 476, 500, 500, 500, 500, 500, 500, 500, 500, 500, 86, 500, 500, 500, 500, 500, 500, 500, 118, 500, 182, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3817363742824558, "mean_inference_ms": 1.221415960824454, "mean_action_processing_ms": 0.1415240395438302, "mean_env_wait_ms": 0.08301501507525678, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020005226135253906, "StateBufferConnector_ms": 0.019995689392089844, "ViewRequirementAgentConnector_ms": 0.1520671844482422}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5881.431282931519, "num_env_steps_trained_throughput_per_sec": 5881.431282931519, "timesteps_total": 12000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 2040.32, "sample_time_ms": 1917.042, "load_time_ms": 6.999, "load_throughput": 1714585.181, "learn_time_ms": 103.508, "learn_throughput": 115933.607, "synch_weights_time_ms": 10.77}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "episodes_total": 25, "training_iteration": 1, "trial_id": "9f288_00019", "date": "2023-10-25_17-06-35", "timestamp": 1698249995, "time_this_iter_s": 2.045457124710083, "time_total_s": 2.045457124710083, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 2.045457124710083, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 60.46666666666666, "ram_util_percent": 27.03333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000003, "cur_lr": 0.0003, "total_loss": 9.021643575032552, "policy_loss": -0.002665838599205017, "vf_loss": 9.024042765299479, "vf_explained_var": 0.00029622316360473634, "kl": 0.0033839285739721467, "entropy": 0.7181938370068868, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 23.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "sampler_results": {"episode_reward_max": 45.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -13.931147540983881, "episode_len_mean": 369.27868852459017, "episode_media": {}, "episodes_this_iter": 36, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 32.100000000000016, 2.499999999999595, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, 31.900000000000013, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 18.899999999999828, -50.00000000000044, 16.8999999999998, 42.10000000000001, 34.70000000000004, 7.699999999999669, 34.900000000000034, 24.899999999999913, 32.700000000000024, -50.00000000000044, -50.00000000000044, 10.499999999999709, -50.00000000000044, 33.30000000000003, -50.00000000000044, 19.899999999999842, -50.00000000000044, 22.899999999999885, 42.30000000000001, -50.00000000000044, 45.9, -50.00000000000044, 27.099999999999945, 28.499999999999964, 35.500000000000036, 41.90000000000001, 1.099999999999575, 38.50000000000003, 39.10000000000002, -50.00000000000044, 35.500000000000036, -50.00000000000044, -50.00000000000044, 19.09999999999983], "episode_lengths": [500, 180, 476, 500, 500, 500, 500, 500, 500, 500, 500, 500, 86, 500, 500, 500, 500, 500, 500, 500, 118, 500, 182, 500, 500, 500, 500, 312, 500, 332, 80, 154, 424, 152, 252, 174, 500, 500, 396, 500, 168, 500, 302, 500, 272, 78, 500, 42, 500, 230, 216, 146, 82, 490, 116, 110, 500, 146, 500, 500, 310]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38054978145977497, "mean_inference_ms": 1.2179791305781362, "mean_action_processing_ms": 0.14145719994169556, "mean_env_wait_ms": 0.08207470319924523, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024586818257316213, "StateBufferConnector_ms": 0.00819495466888928, "ViewRequirementAgentConnector_ms": 0.13280618386190446}}, "episode_reward_max": 45.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -13.931147540983881, "episode_len_mean": 369.27868852459017, "episodes_this_iter": 36, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 32.100000000000016, 2.499999999999595, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, 31.900000000000013, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 18.899999999999828, -50.00000000000044, 16.8999999999998, 42.10000000000001, 34.70000000000004, 7.699999999999669, 34.900000000000034, 24.899999999999913, 32.700000000000024, -50.00000000000044, -50.00000000000044, 10.499999999999709, -50.00000000000044, 33.30000000000003, -50.00000000000044, 19.899999999999842, -50.00000000000044, 22.899999999999885, 42.30000000000001, -50.00000000000044, 45.9, -50.00000000000044, 27.099999999999945, 28.499999999999964, 35.500000000000036, 41.90000000000001, 1.099999999999575, 38.50000000000003, 39.10000000000002, -50.00000000000044, 35.500000000000036, -50.00000000000044, -50.00000000000044, 19.09999999999983], "episode_lengths": [500, 180, 476, 500, 500, 500, 500, 500, 500, 500, 500, 500, 86, 500, 500, 500, 500, 500, 500, 500, 118, 500, 182, 500, 500, 500, 500, 312, 500, 332, 80, 154, 424, 152, 252, 174, 500, 500, 396, 500, 168, 500, 302, 500, 272, 78, 500, 42, 500, 230, 216, 146, 82, 490, 116, 110, 500, 146, 500, 500, 310]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38054978145977497, "mean_inference_ms": 1.2179791305781362, "mean_action_processing_ms": 0.14145719994169556, "mean_env_wait_ms": 0.08207470319924523, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024586818257316213, "StateBufferConnector_ms": 0.00819495466888928, "ViewRequirementAgentConnector_ms": 0.13280618386190446}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5873.535588107443, "num_env_steps_trained_throughput_per_sec": 5873.535588107443, "timesteps_total": 24000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 2041.691, "sample_time_ms": 1919.521, "load_time_ms": 6.999, "load_throughput": 1714497.573, "learn_time_ms": 102.891, "learn_throughput": 116627.772, "synch_weights_time_ms": 10.779}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "episodes_total": 61, "training_iteration": 2, "trial_id": "9f288_00019", "date": "2023-10-25_17-06-37", "timestamp": 1698249997, "time_this_iter_s": 2.0480620861053467, "time_total_s": 4.09351921081543, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 4.09351921081543, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 63.26666666666667, "ram_util_percent": 27.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.05000000000000002, "cur_lr": 0.0003, "total_loss": 9.004858907063802, "policy_loss": -0.0025472573935985563, "vf_loss": 9.007321230570476, "vf_explained_var": -3.540515899658203e-05, "kl": 0.0031205000673556545, "entropy": 0.7113630016644795, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 38.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "sampler_results": {"episode_reward_max": 45.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -4.038000000000228, "episode_len_mean": 330.96, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.499999999999595, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, 31.900000000000013, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 18.899999999999828, -50.00000000000044, 16.8999999999998, 42.10000000000001, 34.70000000000004, 7.699999999999669, 34.900000000000034, 24.899999999999913, 32.700000000000024, -50.00000000000044, -50.00000000000044, 10.499999999999709, -50.00000000000044, 33.30000000000003, -50.00000000000044, 19.899999999999842, -50.00000000000044, 22.899999999999885, 42.30000000000001, -50.00000000000044, 45.9, -50.00000000000044, 27.099999999999945, 28.499999999999964, 35.500000000000036, 41.90000000000001, 1.099999999999575, 38.50000000000003, 39.10000000000002, -50.00000000000044, 35.500000000000036, -50.00000000000044, -50.00000000000044, 19.09999999999983, 38.10000000000002, 40.90000000000002, 32.90000000000003, -50.00000000000044, 31.900000000000013, 36.30000000000003, -50.00000000000044, 35.500000000000036, -50.00000000000044, 7.699999999999669, 12.899999999999743, 39.300000000000026, 27.699999999999953, 41.70000000000002, 36.10000000000004, 39.90000000000002, 6.299999999999649, -50.00000000000044, 35.30000000000004, -50.00000000000044, 7.299999999999663, 32.50000000000002, 23.099999999999888, 40.70000000000002, -50.00000000000044, 12.69999999999974, 17.69999999999981, 41.30000000000001, 45.7, 9.099999999999689, 13.099999999999746, -50.00000000000044, 45.9, 38.10000000000002, 36.900000000000034, -50.00000000000044, 40.90000000000002, 24.499999999999908, -50.00000000000044, -50.00000000000044, 36.10000000000004], "episode_lengths": [476, 500, 500, 500, 500, 500, 500, 500, 500, 500, 86, 500, 500, 500, 500, 500, 500, 500, 118, 500, 182, 500, 500, 500, 500, 312, 500, 332, 80, 154, 424, 152, 252, 174, 500, 500, 396, 500, 168, 500, 302, 500, 272, 78, 500, 42, 500, 230, 216, 146, 82, 490, 116, 110, 500, 146, 500, 500, 310, 120, 92, 172, 500, 182, 138, 500, 146, 500, 424, 372, 108, 224, 84, 140, 102, 438, 500, 148, 500, 428, 176, 270, 94, 500, 374, 324, 88, 44, 410, 370, 500, 42, 120, 132, 500, 92, 256, 500, 500, 140]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38030171040746885, "mean_inference_ms": 1.216710565744975, "mean_action_processing_ms": 0.1412197050550126, "mean_env_wait_ms": 0.08244608005479796, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023998260498046875, "StateBufferConnector_ms": 0.012997150421142578, "ViewRequirementAgentConnector_ms": 0.1370220184326172}}, "episode_reward_max": 45.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -4.038000000000228, "episode_len_mean": 330.96, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [2.499999999999595, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, 31.900000000000013, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 18.899999999999828, -50.00000000000044, 16.8999999999998, 42.10000000000001, 34.70000000000004, 7.699999999999669, 34.900000000000034, 24.899999999999913, 32.700000000000024, -50.00000000000044, -50.00000000000044, 10.499999999999709, -50.00000000000044, 33.30000000000003, -50.00000000000044, 19.899999999999842, -50.00000000000044, 22.899999999999885, 42.30000000000001, -50.00000000000044, 45.9, -50.00000000000044, 27.099999999999945, 28.499999999999964, 35.500000000000036, 41.90000000000001, 1.099999999999575, 38.50000000000003, 39.10000000000002, -50.00000000000044, 35.500000000000036, -50.00000000000044, -50.00000000000044, 19.09999999999983, 38.10000000000002, 40.90000000000002, 32.90000000000003, -50.00000000000044, 31.900000000000013, 36.30000000000003, -50.00000000000044, 35.500000000000036, -50.00000000000044, 7.699999999999669, 12.899999999999743, 39.300000000000026, 27.699999999999953, 41.70000000000002, 36.10000000000004, 39.90000000000002, 6.299999999999649, -50.00000000000044, 35.30000000000004, -50.00000000000044, 7.299999999999663, 32.50000000000002, 23.099999999999888, 40.70000000000002, -50.00000000000044, 12.69999999999974, 17.69999999999981, 41.30000000000001, 45.7, 9.099999999999689, 13.099999999999746, -50.00000000000044, 45.9, 38.10000000000002, 36.900000000000034, -50.00000000000044, 40.90000000000002, 24.499999999999908, -50.00000000000044, -50.00000000000044, 36.10000000000004], "episode_lengths": [476, 500, 500, 500, 500, 500, 500, 500, 500, 500, 86, 500, 500, 500, 500, 500, 500, 500, 118, 500, 182, 500, 500, 500, 500, 312, 500, 332, 80, 154, 424, 152, 252, 174, 500, 500, 396, 500, 168, 500, 302, 500, 272, 78, 500, 42, 500, 230, 216, 146, 82, 490, 116, 110, 500, 146, 500, 500, 310, 120, 92, 172, 500, 182, 138, 500, 146, 500, 424, 372, 108, 224, 84, 140, 102, 438, 500, 148, 500, 428, 176, 270, 94, 500, 374, 324, 88, 44, 410, 370, 500, 42, 120, 132, 500, 92, 256, 500, 500, 140]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38030171040746885, "mean_inference_ms": 1.216710565744975, "mean_action_processing_ms": 0.1412197050550126, "mean_env_wait_ms": 0.08244608005479796, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023998260498046875, "StateBufferConnector_ms": 0.012997150421142578, "ViewRequirementAgentConnector_ms": 0.1370220184326172}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5606.223428256557, "num_env_steps_trained_throughput_per_sec": 5606.223428256557, "timesteps_total": 36000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 2074.62, "sample_time_ms": 1913.347, "load_time_ms": 7.333, "load_throughput": 1636499.984, "learn_time_ms": 141.818, "learn_throughput": 84615.702, "synch_weights_time_ms": 10.789}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "episodes_total": 102, "training_iteration": 3, "trial_id": "9f288_00019", "date": "2023-10-25_17-06-39", "timestamp": 1698249999, "time_this_iter_s": 2.144979953765869, "time_total_s": 6.238499164581299, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 6.238499164581299, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 63.13333333333333, "ram_util_percent": 27.133333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.02500000000000001, "cur_lr": 0.0003, "total_loss": 9.160215123494465, "policy_loss": -0.0010113423069318137, "vf_loss": 9.161234029134114, "vf_explained_var": -2.6750564575195313e-05, "kl": 0.0024294293841345886, "entropy": 0.6822364886601766, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 53.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "sampler_results": {"episode_reward_max": 45.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.26699999999986, "episode_len_mean": 263.1, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [27.099999999999945, 28.499999999999964, 35.500000000000036, 41.90000000000001, 1.099999999999575, 38.50000000000003, 39.10000000000002, -50.00000000000044, 35.500000000000036, -50.00000000000044, -50.00000000000044, 19.09999999999983, 38.10000000000002, 40.90000000000002, 32.90000000000003, -50.00000000000044, 31.900000000000013, 36.30000000000003, -50.00000000000044, 35.500000000000036, -50.00000000000044, 7.699999999999669, 12.899999999999743, 39.300000000000026, 27.699999999999953, 41.70000000000002, 36.10000000000004, 39.90000000000002, 6.299999999999649, -50.00000000000044, 35.30000000000004, -50.00000000000044, 7.299999999999663, 32.50000000000002, 23.099999999999888, 40.70000000000002, -50.00000000000044, 12.69999999999974, 17.69999999999981, 41.30000000000001, 45.7, 9.099999999999689, 13.099999999999746, -50.00000000000044, 45.9, 38.10000000000002, 36.900000000000034, -50.00000000000044, 40.90000000000002, 24.499999999999908, -50.00000000000044, -50.00000000000044, 36.10000000000004, 25.099999999999916, 25.899999999999928, 38.700000000000024, 39.70000000000002, 25.29999999999992, -50.00000000000044, 34.70000000000004, 37.10000000000003, -50.00000000000044, 38.700000000000024, 5.899999999999643, 41.30000000000001, 37.90000000000003, 44.900000000000006, 31.900000000000013, 38.10000000000002, 33.500000000000036, 44.5, 26.89999999999994, 37.10000000000003, 43.10000000000001, 40.10000000000002, 42.10000000000001, 3.699999999999612, 38.700000000000024, 22.099999999999874, -50.00000000000044, 30.499999999999993, 39.50000000000002, 39.70000000000002, 28.89999999999997, -50.00000000000044, -50.00000000000044, 33.500000000000036, 33.30000000000003, -50.00000000000044, 4.299999999999621, -50.00000000000044, 44.900000000000006, -50.00000000000044, 31.1, 28.09999999999996, -50.00000000000044, 24.499999999999908, -50.00000000000044, 20.49999999999985, 26.499999999999936], "episode_lengths": [230, 216, 146, 82, 490, 116, 110, 500, 146, 500, 500, 310, 120, 92, 172, 500, 182, 138, 500, 146, 500, 424, 372, 108, 224, 84, 140, 102, 438, 500, 148, 500, 428, 176, 270, 94, 500, 374, 324, 88, 44, 410, 370, 500, 42, 120, 132, 500, 92, 256, 500, 500, 140, 250, 242, 114, 104, 248, 500, 154, 130, 500, 114, 442, 88, 122, 52, 182, 120, 166, 56, 232, 130, 70, 100, 80, 464, 114, 280, 500, 196, 106, 104, 212, 500, 500, 166, 168, 500, 458, 500, 52, 500, 190, 220, 500, 256, 500, 296, 236]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3847000991870397, "mean_inference_ms": 1.2324847602749454, "mean_action_processing_ms": 0.14372529312581844, "mean_env_wait_ms": 0.08338708394514396, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02493572235107422, "StateBufferConnector_ms": 0.010994672775268555, "ViewRequirementAgentConnector_ms": 0.13901615142822266}}, "episode_reward_max": 45.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.26699999999986, "episode_len_mean": 263.1, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [27.099999999999945, 28.499999999999964, 35.500000000000036, 41.90000000000001, 1.099999999999575, 38.50000000000003, 39.10000000000002, -50.00000000000044, 35.500000000000036, -50.00000000000044, -50.00000000000044, 19.09999999999983, 38.10000000000002, 40.90000000000002, 32.90000000000003, -50.00000000000044, 31.900000000000013, 36.30000000000003, -50.00000000000044, 35.500000000000036, -50.00000000000044, 7.699999999999669, 12.899999999999743, 39.300000000000026, 27.699999999999953, 41.70000000000002, 36.10000000000004, 39.90000000000002, 6.299999999999649, -50.00000000000044, 35.30000000000004, -50.00000000000044, 7.299999999999663, 32.50000000000002, 23.099999999999888, 40.70000000000002, -50.00000000000044, 12.69999999999974, 17.69999999999981, 41.30000000000001, 45.7, 9.099999999999689, 13.099999999999746, -50.00000000000044, 45.9, 38.10000000000002, 36.900000000000034, -50.00000000000044, 40.90000000000002, 24.499999999999908, -50.00000000000044, -50.00000000000044, 36.10000000000004, 25.099999999999916, 25.899999999999928, 38.700000000000024, 39.70000000000002, 25.29999999999992, -50.00000000000044, 34.70000000000004, 37.10000000000003, -50.00000000000044, 38.700000000000024, 5.899999999999643, 41.30000000000001, 37.90000000000003, 44.900000000000006, 31.900000000000013, 38.10000000000002, 33.500000000000036, 44.5, 26.89999999999994, 37.10000000000003, 43.10000000000001, 40.10000000000002, 42.10000000000001, 3.699999999999612, 38.700000000000024, 22.099999999999874, -50.00000000000044, 30.499999999999993, 39.50000000000002, 39.70000000000002, 28.89999999999997, -50.00000000000044, -50.00000000000044, 33.500000000000036, 33.30000000000003, -50.00000000000044, 4.299999999999621, -50.00000000000044, 44.900000000000006, -50.00000000000044, 31.1, 28.09999999999996, -50.00000000000044, 24.499999999999908, -50.00000000000044, 20.49999999999985, 26.499999999999936], "episode_lengths": [230, 216, 146, 82, 490, 116, 110, 500, 146, 500, 500, 310, 120, 92, 172, 500, 182, 138, 500, 146, 500, 424, 372, 108, 224, 84, 140, 102, 438, 500, 148, 500, 428, 176, 270, 94, 500, 374, 324, 88, 44, 410, 370, 500, 42, 120, 132, 500, 92, 256, 500, 500, 140, 250, 242, 114, 104, 248, 500, 154, 130, 500, 114, 442, 88, 122, 52, 182, 120, 166, 56, 232, 130, 70, 100, 80, 464, 114, 280, 500, 196, 106, 104, 212, 500, 500, 166, 168, 500, 458, 500, 52, 500, 190, 220, 500, 256, 500, 296, 236]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3847000991870397, "mean_inference_ms": 1.2324847602749454, "mean_action_processing_ms": 0.14372529312581844, "mean_env_wait_ms": 0.08338708394514396, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02493572235107422, "StateBufferConnector_ms": 0.010994672775268555, "ViewRequirementAgentConnector_ms": 0.13901615142822266}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4837.369372237081, "num_env_steps_trained_throughput_per_sec": 4837.369372237081, "timesteps_total": 48000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 2176.137, "sample_time_ms": 1972.76, "load_time_ms": 10.249, "load_throughput": 1170796.141, "learn_time_ms": 181.119, "learn_throughput": 66254.752, "synch_weights_time_ms": 10.758}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "episodes_total": 149, "training_iteration": 4, "trial_id": "9f288_00019", "date": "2023-10-25_17-06-41", "timestamp": 1698250001, "time_this_iter_s": 2.486682653427124, "time_total_s": 8.725181818008423, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 8.725181818008423, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 63.175, "ram_util_percent": 27.224999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.012500000000000004, "cur_lr": 0.0003, "total_loss": 8.96844736735026, "policy_loss": 4.765720417102178e-05, "vf_loss": 8.968460591634114, "vf_explained_var": -1.0744730631510417e-05, "kl": 0.00015646577380721283, "entropy": 0.6277903358141581, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 68.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "sampler_results": {"episode_reward_max": 46.099999999999994, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.083999999999866, "episode_len_mean": 249.92, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [38.10000000000002, 36.900000000000034, -50.00000000000044, 40.90000000000002, 24.499999999999908, -50.00000000000044, -50.00000000000044, 36.10000000000004, 25.099999999999916, 25.899999999999928, 38.700000000000024, 39.70000000000002, 25.29999999999992, -50.00000000000044, 34.70000000000004, 37.10000000000003, -50.00000000000044, 38.700000000000024, 5.899999999999643, 41.30000000000001, 37.90000000000003, 44.900000000000006, 31.900000000000013, 38.10000000000002, 33.500000000000036, 44.5, 26.89999999999994, 37.10000000000003, 43.10000000000001, 40.10000000000002, 42.10000000000001, 3.699999999999612, 38.700000000000024, 22.099999999999874, -50.00000000000044, 30.499999999999993, 39.50000000000002, 39.70000000000002, 28.89999999999997, -50.00000000000044, -50.00000000000044, 33.500000000000036, 33.30000000000003, -50.00000000000044, 4.299999999999621, -50.00000000000044, 44.900000000000006, -50.00000000000044, 31.1, 28.09999999999996, -50.00000000000044, 24.499999999999908, -50.00000000000044, 20.49999999999985, 26.499999999999936, -50.00000000000044, 39.50000000000002, 46.099999999999994, 40.10000000000002, 33.500000000000036, 35.900000000000034, -50.00000000000044, 32.700000000000024, 14.299999999999763, 41.70000000000002, 9.299999999999692, 36.10000000000004, -50.00000000000044, 37.90000000000003, -50.00000000000044, 30.9, 35.500000000000036, -50.00000000000044, 6.8999999999996575, 39.10000000000002, 38.10000000000002, 44.10000000000001, 43.10000000000001, -50.00000000000044, -50.00000000000044, 15.099999999999774, 36.900000000000034, 3.699999999999612, 42.10000000000001, 31.300000000000004, 41.90000000000001, 27.899999999999956, 43.7, 41.30000000000001, 42.70000000000001, -50.00000000000044, 29.49999999999998, 36.30000000000003, -50.00000000000044, 34.900000000000034, -50.00000000000044, 41.70000000000002, 32.30000000000002, 43.50000000000001, -50.00000000000044], "episode_lengths": [120, 132, 500, 92, 256, 500, 500, 140, 250, 242, 114, 104, 248, 500, 154, 130, 500, 114, 442, 88, 122, 52, 182, 120, 166, 56, 232, 130, 70, 100, 80, 464, 114, 280, 500, 196, 106, 104, 212, 500, 500, 166, 168, 500, 458, 500, 52, 500, 190, 220, 500, 256, 500, 296, 236, 500, 106, 40, 100, 166, 142, 500, 174, 358, 84, 408, 140, 500, 122, 500, 192, 146, 500, 432, 110, 120, 60, 70, 500, 500, 350, 132, 464, 80, 188, 82, 222, 64, 88, 74, 500, 206, 138, 500, 152, 500, 84, 178, 66, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.394427030637522, "mean_inference_ms": 1.2672156345110153, "mean_action_processing_ms": 0.14893233679247203, "mean_env_wait_ms": 0.08650901665909945, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02792954444885254, "StateBufferConnector_ms": 0.006994962692260742, "ViewRequirementAgentConnector_ms": 0.13379454612731934}}, "episode_reward_max": 46.099999999999994, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.083999999999866, "episode_len_mean": 249.92, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [38.10000000000002, 36.900000000000034, -50.00000000000044, 40.90000000000002, 24.499999999999908, -50.00000000000044, -50.00000000000044, 36.10000000000004, 25.099999999999916, 25.899999999999928, 38.700000000000024, 39.70000000000002, 25.29999999999992, -50.00000000000044, 34.70000000000004, 37.10000000000003, -50.00000000000044, 38.700000000000024, 5.899999999999643, 41.30000000000001, 37.90000000000003, 44.900000000000006, 31.900000000000013, 38.10000000000002, 33.500000000000036, 44.5, 26.89999999999994, 37.10000000000003, 43.10000000000001, 40.10000000000002, 42.10000000000001, 3.699999999999612, 38.700000000000024, 22.099999999999874, -50.00000000000044, 30.499999999999993, 39.50000000000002, 39.70000000000002, 28.89999999999997, -50.00000000000044, -50.00000000000044, 33.500000000000036, 33.30000000000003, -50.00000000000044, 4.299999999999621, -50.00000000000044, 44.900000000000006, -50.00000000000044, 31.1, 28.09999999999996, -50.00000000000044, 24.499999999999908, -50.00000000000044, 20.49999999999985, 26.499999999999936, -50.00000000000044, 39.50000000000002, 46.099999999999994, 40.10000000000002, 33.500000000000036, 35.900000000000034, -50.00000000000044, 32.700000000000024, 14.299999999999763, 41.70000000000002, 9.299999999999692, 36.10000000000004, -50.00000000000044, 37.90000000000003, -50.00000000000044, 30.9, 35.500000000000036, -50.00000000000044, 6.8999999999996575, 39.10000000000002, 38.10000000000002, 44.10000000000001, 43.10000000000001, -50.00000000000044, -50.00000000000044, 15.099999999999774, 36.900000000000034, 3.699999999999612, 42.10000000000001, 31.300000000000004, 41.90000000000001, 27.899999999999956, 43.7, 41.30000000000001, 42.70000000000001, -50.00000000000044, 29.49999999999998, 36.30000000000003, -50.00000000000044, 34.900000000000034, -50.00000000000044, 41.70000000000002, 32.30000000000002, 43.50000000000001, -50.00000000000044], "episode_lengths": [120, 132, 500, 92, 256, 500, 500, 140, 250, 242, 114, 104, 248, 500, 154, 130, 500, 114, 442, 88, 122, 52, 182, 120, 166, 56, 232, 130, 70, 100, 80, 464, 114, 280, 500, 196, 106, 104, 212, 500, 500, 166, 168, 500, 458, 500, 52, 500, 190, 220, 500, 256, 500, 296, 236, 500, 106, 40, 100, 166, 142, 500, 174, 358, 84, 408, 140, 500, 122, 500, 192, 146, 500, 432, 110, 120, 60, 70, 500, 500, 350, 132, 464, 80, 188, 82, 222, 64, 88, 74, 500, 206, 138, 500, 152, 500, 84, 178, 66, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.394427030637522, "mean_inference_ms": 1.2672156345110153, "mean_action_processing_ms": 0.14893233679247203, "mean_env_wait_ms": 0.08650901665909945, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02792954444885254, "StateBufferConnector_ms": 0.006994962692260742, "ViewRequirementAgentConnector_ms": 0.13379454612731934}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4225.62219892735, "num_env_steps_trained_throughput_per_sec": 4225.62219892735, "timesteps_total": 60000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 2308.674, "sample_time_ms": 2088.547, "load_time_ms": 11.364, "load_throughput": 1055976.636, "learn_time_ms": 196.813, "learn_throughput": 60971.726, "synch_weights_time_ms": 10.749}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "episodes_total": 194, "training_iteration": 5, "trial_id": "9f288_00019", "date": "2023-10-25_17-06-44", "timestamp": 1698250004, "time_this_iter_s": 2.844595193862915, "time_total_s": 11.569777011871338, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 11.569777011871338, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 61.8, "ram_util_percent": 27.325000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.006250000000000002, "cur_lr": 0.0003, "total_loss": 8.70510654449463, "policy_loss": -0.0004303718606630961, "vf_loss": 8.705593681335449, "vf_explained_var": -9.74734624226888e-06, "kl": 0.0007890000887679586, "entropy": 0.6184282382329305, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 83.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "sampler_results": {"episode_reward_max": 46.099999999999994, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.6799999999998265, "episode_len_mean": 283.86, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [33.500000000000036, 33.30000000000003, -50.00000000000044, 4.299999999999621, -50.00000000000044, 44.900000000000006, -50.00000000000044, 31.1, 28.09999999999996, -50.00000000000044, 24.499999999999908, -50.00000000000044, 20.49999999999985, 26.499999999999936, -50.00000000000044, 39.50000000000002, 46.099999999999994, 40.10000000000002, 33.500000000000036, 35.900000000000034, -50.00000000000044, 32.700000000000024, 14.299999999999763, 41.70000000000002, 9.299999999999692, 36.10000000000004, -50.00000000000044, 37.90000000000003, -50.00000000000044, 30.9, 35.500000000000036, -50.00000000000044, 6.8999999999996575, 39.10000000000002, 38.10000000000002, 44.10000000000001, 43.10000000000001, -50.00000000000044, -50.00000000000044, 15.099999999999774, 36.900000000000034, 3.699999999999612, 42.10000000000001, 31.300000000000004, 41.90000000000001, 27.899999999999956, 43.7, 41.30000000000001, 42.70000000000001, -50.00000000000044, 29.49999999999998, 36.30000000000003, -50.00000000000044, 34.900000000000034, -50.00000000000044, 41.70000000000002, 32.30000000000002, 43.50000000000001, -50.00000000000044, -50.00000000000044, 26.69999999999994, 37.90000000000003, 33.30000000000003, 44.5, -50.00000000000044, -50.00000000000044, 42.500000000000014, 27.699999999999953, 34.900000000000034, -50.00000000000044, -50.00000000000044, 37.10000000000003, 42.500000000000014, 36.70000000000003, 28.499999999999964, 32.30000000000002, -50.00000000000044, -50.00000000000044, 38.90000000000002, -50.00000000000044, -50.00000000000044, 44.300000000000004, 1.299999999999578, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, 45.3, 25.899999999999928, 40.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.70000000000003, -50.00000000000044, -50.00000000000044, 23.8999999999999, 11.899999999999729, 38.700000000000024], "episode_lengths": [166, 168, 500, 458, 500, 52, 500, 190, 220, 500, 256, 500, 296, 236, 500, 106, 40, 100, 166, 142, 500, 174, 358, 84, 408, 140, 500, 122, 500, 192, 146, 500, 432, 110, 120, 60, 70, 500, 500, 350, 132, 464, 80, 188, 82, 222, 64, 88, 74, 500, 206, 138, 500, 152, 500, 84, 178, 66, 500, 500, 234, 122, 168, 56, 500, 500, 76, 224, 152, 500, 500, 130, 76, 134, 216, 178, 500, 500, 112, 500, 500, 58, 488, 500, 500, 500, 92, 500, 48, 242, 98, 500, 500, 500, 144, 500, 500, 262, 382, 114]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3995359738874681, "mean_inference_ms": 1.2859811198612243, "mean_action_processing_ms": 0.15012981975761058, "mean_env_wait_ms": 0.08885244502073103, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027008533477783203, "StateBufferConnector_ms": 0.004804134368896484, "ViewRequirementAgentConnector_ms": 0.13274574279785156}}, "episode_reward_max": 46.099999999999994, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.6799999999998265, "episode_len_mean": 283.86, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [33.500000000000036, 33.30000000000003, -50.00000000000044, 4.299999999999621, -50.00000000000044, 44.900000000000006, -50.00000000000044, 31.1, 28.09999999999996, -50.00000000000044, 24.499999999999908, -50.00000000000044, 20.49999999999985, 26.499999999999936, -50.00000000000044, 39.50000000000002, 46.099999999999994, 40.10000000000002, 33.500000000000036, 35.900000000000034, -50.00000000000044, 32.700000000000024, 14.299999999999763, 41.70000000000002, 9.299999999999692, 36.10000000000004, -50.00000000000044, 37.90000000000003, -50.00000000000044, 30.9, 35.500000000000036, -50.00000000000044, 6.8999999999996575, 39.10000000000002, 38.10000000000002, 44.10000000000001, 43.10000000000001, -50.00000000000044, -50.00000000000044, 15.099999999999774, 36.900000000000034, 3.699999999999612, 42.10000000000001, 31.300000000000004, 41.90000000000001, 27.899999999999956, 43.7, 41.30000000000001, 42.70000000000001, -50.00000000000044, 29.49999999999998, 36.30000000000003, -50.00000000000044, 34.900000000000034, -50.00000000000044, 41.70000000000002, 32.30000000000002, 43.50000000000001, -50.00000000000044, -50.00000000000044, 26.69999999999994, 37.90000000000003, 33.30000000000003, 44.5, -50.00000000000044, -50.00000000000044, 42.500000000000014, 27.699999999999953, 34.900000000000034, -50.00000000000044, -50.00000000000044, 37.10000000000003, 42.500000000000014, 36.70000000000003, 28.499999999999964, 32.30000000000002, -50.00000000000044, -50.00000000000044, 38.90000000000002, -50.00000000000044, -50.00000000000044, 44.300000000000004, 1.299999999999578, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, 45.3, 25.899999999999928, 40.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.70000000000003, -50.00000000000044, -50.00000000000044, 23.8999999999999, 11.899999999999729, 38.700000000000024], "episode_lengths": [166, 168, 500, 458, 500, 52, 500, 190, 220, 500, 256, 500, 296, 236, 500, 106, 40, 100, 166, 142, 500, 174, 358, 84, 408, 140, 500, 122, 500, 192, 146, 500, 432, 110, 120, 60, 70, 500, 500, 350, 132, 464, 80, 188, 82, 222, 64, 88, 74, 500, 206, 138, 500, 152, 500, 84, 178, 66, 500, 500, 234, 122, 168, 56, 500, 500, 76, 224, 152, 500, 500, 130, 76, 134, 216, 178, 500, 500, 112, 500, 500, 58, 488, 500, 500, 500, 92, 500, 48, 242, 98, 500, 500, 500, 144, 500, 500, 262, 382, 114]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3995359738874681, "mean_inference_ms": 1.2859811198612243, "mean_action_processing_ms": 0.15012981975761058, "mean_env_wait_ms": 0.08885244502073103, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027008533477783203, "StateBufferConnector_ms": 0.004804134368896484, "ViewRequirementAgentConnector_ms": 0.13274574279785156}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4643.338001428105, "num_env_steps_trained_throughput_per_sec": 4643.338001428105, "timesteps_total": 72000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 2354.62, "sample_time_ms": 2128.937, "load_time_ms": 11.47, "load_throughput": 1046229.25, "learn_time_ms": 202.088, "learn_throughput": 59380.178, "synch_weights_time_ms": 10.957}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "episodes_total": 235, "training_iteration": 6, "trial_id": "9f288_00019", "date": "2023-10-25_17-06-47", "timestamp": 1698250007, "time_this_iter_s": 2.5893454551696777, "time_total_s": 14.159122467041016, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 14.159122467041016, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 64.53333333333333, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.003125000000000001, "cur_lr": 0.0003, "total_loss": 8.592834536234538, "policy_loss": -0.0001712252482927094, "vf_loss": 8.593064753214518, "vf_explained_var": 2.455711364746094e-06, "kl": 0.00033173065498128077, "entropy": 0.6011795481046041, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 98.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "sampler_results": {"episode_reward_max": 45.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.441999999999823, "episode_len_mean": 276.22, "episode_media": {}, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [36.30000000000003, -50.00000000000044, 34.900000000000034, -50.00000000000044, 41.70000000000002, 32.30000000000002, 43.50000000000001, -50.00000000000044, -50.00000000000044, 26.69999999999994, 37.90000000000003, 33.30000000000003, 44.5, -50.00000000000044, -50.00000000000044, 42.500000000000014, 27.699999999999953, 34.900000000000034, -50.00000000000044, -50.00000000000044, 37.10000000000003, 42.500000000000014, 36.70000000000003, 28.499999999999964, 32.30000000000002, -50.00000000000044, -50.00000000000044, 38.90000000000002, -50.00000000000044, -50.00000000000044, 44.300000000000004, 1.299999999999578, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, 45.3, 25.899999999999928, 40.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.70000000000003, -50.00000000000044, -50.00000000000044, 23.8999999999999, 11.899999999999729, 38.700000000000024, -50.00000000000044, 39.300000000000026, -50.00000000000044, 41.500000000000014, -50.00000000000044, 45.7, -50.00000000000044, 45.3, 28.89999999999997, 33.30000000000003, -50.00000000000044, 40.70000000000002, 33.70000000000004, 43.10000000000001, 43.900000000000006, 4.299999999999621, 45.7, 36.10000000000004, 16.29999999999979, 43.900000000000006, -50.00000000000044, 38.90000000000002, 32.100000000000016, -50.00000000000044, 16.29999999999979, -50.00000000000044, -50.00000000000044, 23.29999999999989, 45.1, 43.7, 42.500000000000014, 0.09999999999956088, 40.500000000000014, 36.10000000000004, 43.50000000000001, 29.69999999999998, 40.30000000000002, 15.299999999999777, 43.7, 45.9, 40.10000000000002, 43.50000000000001, -50.00000000000044, 34.70000000000004, 43.50000000000001, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [138, 500, 152, 500, 84, 178, 66, 500, 500, 234, 122, 168, 56, 500, 500, 76, 224, 152, 500, 500, 130, 76, 134, 216, 178, 500, 500, 112, 500, 500, 58, 488, 500, 500, 500, 92, 500, 48, 242, 98, 500, 500, 500, 144, 500, 500, 262, 382, 114, 500, 108, 500, 86, 500, 44, 500, 48, 212, 168, 500, 94, 164, 70, 62, 458, 44, 140, 338, 62, 500, 112, 180, 500, 338, 500, 500, 268, 50, 64, 76, 500, 96, 140, 66, 204, 98, 348, 64, 42, 100, 66, 500, 154, 66, 500, 500, 68, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40569689508449513, "mean_inference_ms": 1.2996210270171493, "mean_action_processing_ms": 0.15076762991659154, "mean_env_wait_ms": 0.09049052849083936, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03300642967224121, "StateBufferConnector_ms": 0.004805326461791992, "ViewRequirementAgentConnector_ms": 0.12796330451965332}}, "episode_reward_max": 45.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.441999999999823, "episode_len_mean": 276.22, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [36.30000000000003, -50.00000000000044, 34.900000000000034, -50.00000000000044, 41.70000000000002, 32.30000000000002, 43.50000000000001, -50.00000000000044, -50.00000000000044, 26.69999999999994, 37.90000000000003, 33.30000000000003, 44.5, -50.00000000000044, -50.00000000000044, 42.500000000000014, 27.699999999999953, 34.900000000000034, -50.00000000000044, -50.00000000000044, 37.10000000000003, 42.500000000000014, 36.70000000000003, 28.499999999999964, 32.30000000000002, -50.00000000000044, -50.00000000000044, 38.90000000000002, -50.00000000000044, -50.00000000000044, 44.300000000000004, 1.299999999999578, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, 45.3, 25.899999999999928, 40.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.70000000000003, -50.00000000000044, -50.00000000000044, 23.8999999999999, 11.899999999999729, 38.700000000000024, -50.00000000000044, 39.300000000000026, -50.00000000000044, 41.500000000000014, -50.00000000000044, 45.7, -50.00000000000044, 45.3, 28.89999999999997, 33.30000000000003, -50.00000000000044, 40.70000000000002, 33.70000000000004, 43.10000000000001, 43.900000000000006, 4.299999999999621, 45.7, 36.10000000000004, 16.29999999999979, 43.900000000000006, -50.00000000000044, 38.90000000000002, 32.100000000000016, -50.00000000000044, 16.29999999999979, -50.00000000000044, -50.00000000000044, 23.29999999999989, 45.1, 43.7, 42.500000000000014, 0.09999999999956088, 40.500000000000014, 36.10000000000004, 43.50000000000001, 29.69999999999998, 40.30000000000002, 15.299999999999777, 43.7, 45.9, 40.10000000000002, 43.50000000000001, -50.00000000000044, 34.70000000000004, 43.50000000000001, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [138, 500, 152, 500, 84, 178, 66, 500, 500, 234, 122, 168, 56, 500, 500, 76, 224, 152, 500, 500, 130, 76, 134, 216, 178, 500, 500, 112, 500, 500, 58, 488, 500, 500, 500, 92, 500, 48, 242, 98, 500, 500, 500, 144, 500, 500, 262, 382, 114, 500, 108, 500, 86, 500, 44, 500, 48, 212, 168, 500, 94, 164, 70, 62, 458, 44, 140, 338, 62, 500, 112, 180, 500, 338, 500, 500, 268, 50, 64, 76, 500, 96, 140, 66, 204, 98, 348, 64, 42, 100, 66, 500, 154, 66, 500, 500, 68, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40569689508449513, "mean_inference_ms": 1.2996210270171493, "mean_action_processing_ms": 0.15076762991659154, "mean_env_wait_ms": 0.09049052849083936, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03300642967224121, "StateBufferConnector_ms": 0.004805326461791992, "ViewRequirementAgentConnector_ms": 0.12796330451965332}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4661.587342162552, "num_env_steps_trained_throughput_per_sec": 4661.587342162552, "timesteps_total": 84000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 2385.993, "sample_time_ms": 2148.162, "load_time_ms": 11.688, "load_throughput": 1026679.613, "learn_time_ms": 213.748, "learn_throughput": 56140.757, "synch_weights_time_ms": 11.106}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "episodes_total": 286, "training_iteration": 7, "trial_id": "9f288_00019", "date": "2023-10-25_17-06-49", "timestamp": 1698250009, "time_this_iter_s": 2.580228328704834, "time_total_s": 16.73935079574585, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 16.73935079574585, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 64.425, "ram_util_percent": 27.375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0015625000000000005, "cur_lr": 0.0003, "total_loss": 8.381487401326497, "policy_loss": 5.184685190518697e-05, "vf_loss": 8.381495602925618, "vf_explained_var": 4.963080088297526e-06, "kl": 0.0003451554228073898, "entropy": 0.602149514357249, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 113.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.809999999999832, "episode_len_mean": 262.56, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 23.8999999999999, 11.899999999999729, 38.700000000000024, -50.00000000000044, 39.300000000000026, -50.00000000000044, 41.500000000000014, -50.00000000000044, 45.7, -50.00000000000044, 45.3, 28.89999999999997, 33.30000000000003, -50.00000000000044, 40.70000000000002, 33.70000000000004, 43.10000000000001, 43.900000000000006, 4.299999999999621, 45.7, 36.10000000000004, 16.29999999999979, 43.900000000000006, -50.00000000000044, 38.90000000000002, 32.100000000000016, -50.00000000000044, 16.29999999999979, -50.00000000000044, -50.00000000000044, 23.29999999999989, 45.1, 43.7, 42.500000000000014, 0.09999999999956088, 40.500000000000014, 36.10000000000004, 43.50000000000001, 29.69999999999998, 40.30000000000002, 15.299999999999777, 43.7, 45.9, 40.10000000000002, 43.50000000000001, -50.00000000000044, 34.70000000000004, 43.50000000000001, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, 42.500000000000014, 43.900000000000006, 46.099999999999994, 22.899999999999885, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 36.10000000000004, 37.90000000000003, 25.899999999999928, 41.500000000000014, 46.699999999999996, -50.00000000000044, 46.099999999999994, -50.00000000000044, 30.499999999999993, 24.899999999999913, 37.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.900000000000034, -50.00000000000044, 42.500000000000014, 36.50000000000003, 44.5, 41.70000000000002, 44.5, 44.300000000000004, 42.70000000000001, 10.299999999999706, 38.50000000000003, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.70000000000003], "episode_lengths": [500, 500, 262, 382, 114, 500, 108, 500, 86, 500, 44, 500, 48, 212, 168, 500, 94, 164, 70, 62, 458, 44, 140, 338, 62, 500, 112, 180, 500, 338, 500, 500, 268, 50, 64, 76, 500, 96, 140, 66, 204, 98, 348, 64, 42, 100, 66, 500, 154, 66, 500, 500, 68, 500, 500, 500, 100, 500, 500, 76, 62, 40, 272, 500, 500, 500, 78, 500, 140, 122, 242, 86, 34, 500, 40, 500, 196, 252, 128, 500, 500, 500, 500, 132, 500, 76, 136, 56, 84, 56, 58, 74, 398, 116, 500, 102, 500, 500, 500, 144]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4122638325210443, "mean_inference_ms": 1.3183641800083077, "mean_action_processing_ms": 0.15275403425967093, "mean_env_wait_ms": 0.09233503400610048, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029993534088134766, "StateBufferConnector_ms": 0.004010438919067383, "ViewRequirementAgentConnector_ms": 0.13800358772277832}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.809999999999832, "episode_len_mean": 262.56, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 23.8999999999999, 11.899999999999729, 38.700000000000024, -50.00000000000044, 39.300000000000026, -50.00000000000044, 41.500000000000014, -50.00000000000044, 45.7, -50.00000000000044, 45.3, 28.89999999999997, 33.30000000000003, -50.00000000000044, 40.70000000000002, 33.70000000000004, 43.10000000000001, 43.900000000000006, 4.299999999999621, 45.7, 36.10000000000004, 16.29999999999979, 43.900000000000006, -50.00000000000044, 38.90000000000002, 32.100000000000016, -50.00000000000044, 16.29999999999979, -50.00000000000044, -50.00000000000044, 23.29999999999989, 45.1, 43.7, 42.500000000000014, 0.09999999999956088, 40.500000000000014, 36.10000000000004, 43.50000000000001, 29.69999999999998, 40.30000000000002, 15.299999999999777, 43.7, 45.9, 40.10000000000002, 43.50000000000001, -50.00000000000044, 34.70000000000004, 43.50000000000001, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, 42.500000000000014, 43.900000000000006, 46.099999999999994, 22.899999999999885, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 36.10000000000004, 37.90000000000003, 25.899999999999928, 41.500000000000014, 46.699999999999996, -50.00000000000044, 46.099999999999994, -50.00000000000044, 30.499999999999993, 24.899999999999913, 37.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.900000000000034, -50.00000000000044, 42.500000000000014, 36.50000000000003, 44.5, 41.70000000000002, 44.5, 44.300000000000004, 42.70000000000001, 10.299999999999706, 38.50000000000003, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.70000000000003], "episode_lengths": [500, 500, 262, 382, 114, 500, 108, 500, 86, 500, 44, 500, 48, 212, 168, 500, 94, 164, 70, 62, 458, 44, 140, 338, 62, 500, 112, 180, 500, 338, 500, 500, 268, 50, 64, 76, 500, 96, 140, 66, 204, 98, 348, 64, 42, 100, 66, 500, 154, 66, 500, 500, 68, 500, 500, 500, 100, 500, 500, 76, 62, 40, 272, 500, 500, 500, 78, 500, 140, 122, 242, 86, 34, 500, 40, 500, 196, 252, 128, 500, 500, 500, 500, 132, 500, 76, 136, 56, 84, 56, 58, 74, 398, 116, 500, 102, 500, 500, 500, 144]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4122638325210443, "mean_inference_ms": 1.3183641800083077, "mean_action_processing_ms": 0.15275403425967093, "mean_env_wait_ms": 0.09233503400610048, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029993534088134766, "StateBufferConnector_ms": 0.004010438919067383, "ViewRequirementAgentConnector_ms": 0.13800358772277832}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4965.361791662491, "num_env_steps_trained_throughput_per_sec": 4965.361791662491, "timesteps_total": 96000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 2389.836, "sample_time_ms": 2166.484, "load_time_ms": 10.977, "load_throughput": 1093185.958, "learn_time_ms": 199.53, "learn_throughput": 60141.357, "synch_weights_time_ms": 11.468}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "episodes_total": 330, "training_iteration": 8, "trial_id": "9f288_00019", "date": "2023-10-25_17-06-52", "timestamp": 1698250012, "time_this_iter_s": 2.4217402935028076, "time_total_s": 19.161091089248657, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 19.161091089248657, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 68.775, "ram_util_percent": 27.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0007812500000000003, "cur_lr": 0.0003, "total_loss": 8.447737757364909, "policy_loss": -0.0003672391176223755, "vf_loss": 8.448164304097494, "vf_explained_var": 1.1881192525227865e-06, "kl": 0.0006172563515178808, "entropy": 0.5959768335024516, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 128.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.818999999999842, "episode_len_mean": 257.44, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.10000000000002, 43.50000000000001, -50.00000000000044, 34.70000000000004, 43.50000000000001, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, 42.500000000000014, 43.900000000000006, 46.099999999999994, 22.899999999999885, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 36.10000000000004, 37.90000000000003, 25.899999999999928, 41.500000000000014, 46.699999999999996, -50.00000000000044, 46.099999999999994, -50.00000000000044, 30.499999999999993, 24.899999999999913, 37.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.900000000000034, -50.00000000000044, 42.500000000000014, 36.50000000000003, 44.5, 41.70000000000002, 44.5, 44.300000000000004, 42.70000000000001, 10.299999999999706, 38.50000000000003, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.70000000000003, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, 42.70000000000001, 33.30000000000003, 39.70000000000002, 45.9, 37.300000000000026, -50.00000000000044, 34.900000000000034, -50.00000000000044, 42.30000000000001, 39.300000000000026, -50.00000000000044, 39.90000000000002, 42.70000000000001, -50.00000000000044, -50.00000000000044, 35.10000000000004, -50.00000000000044, 44.300000000000004, 35.30000000000004, 38.10000000000002, 34.10000000000004, 44.300000000000004, -50.00000000000044, 40.10000000000002, 26.89999999999994, -50.00000000000044, 43.7, 40.70000000000002, 34.30000000000004, 38.90000000000002, 32.700000000000024, 37.300000000000026, 39.300000000000026, -50.00000000000044, 45.7, -50.00000000000044, 33.70000000000004, 46.9, 42.70000000000001, -50.00000000000044, 33.70000000000004], "episode_lengths": [100, 66, 500, 154, 66, 500, 500, 68, 500, 500, 500, 100, 500, 500, 76, 62, 40, 272, 500, 500, 500, 78, 500, 140, 122, 242, 86, 34, 500, 40, 500, 196, 252, 128, 500, 500, 500, 500, 132, 500, 76, 136, 56, 84, 56, 58, 74, 398, 116, 500, 102, 500, 500, 500, 144, 500, 118, 500, 500, 74, 168, 104, 42, 128, 500, 152, 500, 78, 108, 500, 102, 74, 500, 500, 150, 500, 58, 148, 120, 160, 58, 500, 100, 232, 500, 64, 94, 158, 112, 174, 128, 108, 500, 44, 500, 164, 32, 74, 500, 164]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41839180554264616, "mean_inference_ms": 1.3354091359334885, "mean_action_processing_ms": 0.15419739531516488, "mean_env_wait_ms": 0.09297797848087327, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0319979190826416, "StateBufferConnector_ms": 0.0029981136322021484, "ViewRequirementAgentConnector_ms": 0.14697551727294922}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.818999999999842, "episode_len_mean": 257.44, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [40.10000000000002, 43.50000000000001, -50.00000000000044, 34.70000000000004, 43.50000000000001, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, 42.500000000000014, 43.900000000000006, 46.099999999999994, 22.899999999999885, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 36.10000000000004, 37.90000000000003, 25.899999999999928, 41.500000000000014, 46.699999999999996, -50.00000000000044, 46.099999999999994, -50.00000000000044, 30.499999999999993, 24.899999999999913, 37.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.900000000000034, -50.00000000000044, 42.500000000000014, 36.50000000000003, 44.5, 41.70000000000002, 44.5, 44.300000000000004, 42.70000000000001, 10.299999999999706, 38.50000000000003, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.70000000000003, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, 42.70000000000001, 33.30000000000003, 39.70000000000002, 45.9, 37.300000000000026, -50.00000000000044, 34.900000000000034, -50.00000000000044, 42.30000000000001, 39.300000000000026, -50.00000000000044, 39.90000000000002, 42.70000000000001, -50.00000000000044, -50.00000000000044, 35.10000000000004, -50.00000000000044, 44.300000000000004, 35.30000000000004, 38.10000000000002, 34.10000000000004, 44.300000000000004, -50.00000000000044, 40.10000000000002, 26.89999999999994, -50.00000000000044, 43.7, 40.70000000000002, 34.30000000000004, 38.90000000000002, 32.700000000000024, 37.300000000000026, 39.300000000000026, -50.00000000000044, 45.7, -50.00000000000044, 33.70000000000004, 46.9, 42.70000000000001, -50.00000000000044, 33.70000000000004], "episode_lengths": [100, 66, 500, 154, 66, 500, 500, 68, 500, 500, 500, 100, 500, 500, 76, 62, 40, 272, 500, 500, 500, 78, 500, 140, 122, 242, 86, 34, 500, 40, 500, 196, 252, 128, 500, 500, 500, 500, 132, 500, 76, 136, 56, 84, 56, 58, 74, 398, 116, 500, 102, 500, 500, 500, 144, 500, 118, 500, 500, 74, 168, 104, 42, 128, 500, 152, 500, 78, 108, 500, 102, 74, 500, 500, 150, 500, 58, 148, 120, 160, 58, 500, 100, 232, 500, 64, 94, 158, 112, 174, 128, 108, 500, 44, 500, 164, 32, 74, 500, 164]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41839180554264616, "mean_inference_ms": 1.3354091359334885, "mean_action_processing_ms": 0.15419739531516488, "mean_env_wait_ms": 0.09297797848087327, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0319979190826416, "StateBufferConnector_ms": 0.0029981136322021484, "ViewRequirementAgentConnector_ms": 0.14697551727294922}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4803.823080406761, "num_env_steps_trained_throughput_per_sec": 4803.823080406761, "timesteps_total": 108000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 2401.856, "sample_time_ms": 2174.718, "load_time_ms": 11.062, "load_throughput": 1084816.921, "learn_time_ms": 203.439, "learn_throughput": 58985.703, "synch_weights_time_ms": 11.302}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "done": false, "episodes_total": 375, "training_iteration": 9, "trial_id": "9f288_00019", "date": "2023-10-25_17-06-54", "timestamp": 1698250014, "time_this_iter_s": 2.503007411956787, "time_total_s": 21.664098501205444, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 21.664098501205444, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 77.23333333333333, "ram_util_percent": 27.53333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.00039062500000000013, "cur_lr": 0.0003, "total_loss": 8.265289910634358, "policy_loss": -9.93351141611735e-05, "vf_loss": 8.26545165379842, "vf_explained_var": -4.498163859049479e-06, "kl": 0.00044602851278246667, "entropy": 0.6247272690137228, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 143.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.034999999999837, "episode_len_mean": 265.3, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.70000000000002, 44.5, 44.300000000000004, 42.70000000000001, 10.299999999999706, 38.50000000000003, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.70000000000003, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, 42.70000000000001, 33.30000000000003, 39.70000000000002, 45.9, 37.300000000000026, -50.00000000000044, 34.900000000000034, -50.00000000000044, 42.30000000000001, 39.300000000000026, -50.00000000000044, 39.90000000000002, 42.70000000000001, -50.00000000000044, -50.00000000000044, 35.10000000000004, -50.00000000000044, 44.300000000000004, 35.30000000000004, 38.10000000000002, 34.10000000000004, 44.300000000000004, -50.00000000000044, 40.10000000000002, 26.89999999999994, -50.00000000000044, 43.7, 40.70000000000002, 34.30000000000004, 38.90000000000002, 32.700000000000024, 37.300000000000026, 39.300000000000026, -50.00000000000044, 45.7, -50.00000000000044, 33.70000000000004, 46.9, 42.70000000000001, -50.00000000000044, 33.70000000000004, -50.00000000000044, 21.699999999999868, 41.30000000000001, 42.10000000000001, 41.30000000000001, 41.100000000000016, 33.10000000000003, 16.29999999999979, -50.00000000000044, -50.00000000000044, 13.099999999999746, -50.00000000000044, 25.499999999999922, -50.00000000000044, 35.30000000000004, 17.299999999999805, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 29.099999999999973, 44.300000000000004, 43.7, 18.29999999999982, 43.7, 40.10000000000002, -50.00000000000044, 32.100000000000016, 35.500000000000036, 42.900000000000006, 12.69999999999974, 15.299999999999777, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, 35.900000000000034], "episode_lengths": [84, 56, 58, 74, 398, 116, 500, 102, 500, 500, 500, 144, 500, 118, 500, 500, 74, 168, 104, 42, 128, 500, 152, 500, 78, 108, 500, 102, 74, 500, 500, 150, 500, 58, 148, 120, 160, 58, 500, 100, 232, 500, 64, 94, 158, 112, 174, 128, 108, 500, 44, 500, 164, 32, 74, 500, 164, 500, 284, 88, 80, 88, 90, 170, 338, 500, 500, 370, 500, 246, 500, 148, 328, 500, 54, 500, 500, 500, 30, 500, 210, 58, 64, 318, 64, 100, 500, 180, 146, 72, 374, 348, 500, 500, 500, 500, 118, 500, 500, 142]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41861923377559285, "mean_inference_ms": 1.3380733851948967, "mean_action_processing_ms": 0.15536036157265076, "mean_env_wait_ms": 0.09271240937669395, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02495598793029785, "StateBufferConnector_ms": 0.0019981861114501953, "ViewRequirementAgentConnector_ms": 0.15191960334777832}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.034999999999837, "episode_len_mean": 265.3, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [41.70000000000002, 44.5, 44.300000000000004, 42.70000000000001, 10.299999999999706, 38.50000000000003, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.70000000000003, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, 42.70000000000001, 33.30000000000003, 39.70000000000002, 45.9, 37.300000000000026, -50.00000000000044, 34.900000000000034, -50.00000000000044, 42.30000000000001, 39.300000000000026, -50.00000000000044, 39.90000000000002, 42.70000000000001, -50.00000000000044, -50.00000000000044, 35.10000000000004, -50.00000000000044, 44.300000000000004, 35.30000000000004, 38.10000000000002, 34.10000000000004, 44.300000000000004, -50.00000000000044, 40.10000000000002, 26.89999999999994, -50.00000000000044, 43.7, 40.70000000000002, 34.30000000000004, 38.90000000000002, 32.700000000000024, 37.300000000000026, 39.300000000000026, -50.00000000000044, 45.7, -50.00000000000044, 33.70000000000004, 46.9, 42.70000000000001, -50.00000000000044, 33.70000000000004, -50.00000000000044, 21.699999999999868, 41.30000000000001, 42.10000000000001, 41.30000000000001, 41.100000000000016, 33.10000000000003, 16.29999999999979, -50.00000000000044, -50.00000000000044, 13.099999999999746, -50.00000000000044, 25.499999999999922, -50.00000000000044, 35.30000000000004, 17.299999999999805, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 29.099999999999973, 44.300000000000004, 43.7, 18.29999999999982, 43.7, 40.10000000000002, -50.00000000000044, 32.100000000000016, 35.500000000000036, 42.900000000000006, 12.69999999999974, 15.299999999999777, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, 35.900000000000034], "episode_lengths": [84, 56, 58, 74, 398, 116, 500, 102, 500, 500, 500, 144, 500, 118, 500, 500, 74, 168, 104, 42, 128, 500, 152, 500, 78, 108, 500, 102, 74, 500, 500, 150, 500, 58, 148, 120, 160, 58, 500, 100, 232, 500, 64, 94, 158, 112, 174, 128, 108, 500, 44, 500, 164, 32, 74, 500, 164, 500, 284, 88, 80, 88, 90, 170, 338, 500, 500, 370, 500, 246, 500, 148, 328, 500, 54, 500, 500, 500, 30, 500, 210, 58, 64, 318, 64, 100, 500, 180, 146, 72, 374, 348, 500, 500, 500, 500, 118, 500, 500, 142]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41861923377559285, "mean_inference_ms": 1.3380733851948967, "mean_action_processing_ms": 0.15536036157265076, "mean_env_wait_ms": 0.09271240937669395, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02495598793029785, "StateBufferConnector_ms": 0.0019981861114501953, "ViewRequirementAgentConnector_ms": 0.15191960334777832}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4601.375833063565, "num_env_steps_trained_throughput_per_sec": 4601.375833063565, "timesteps_total": 120000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 2422.462, "sample_time_ms": 2183.821, "load_time_ms": 13.315, "load_throughput": 901241.75, "learn_time_ms": 212.852, "learn_throughput": 56377.239, "synch_weights_time_ms": 11.172}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "episodes_total": 418, "training_iteration": 10, "trial_id": "9f288_00019", "date": "2023-10-25_17-06-57", "timestamp": 1698250017, "time_this_iter_s": 2.612912893295288, "time_total_s": 24.277011394500732, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 24.277011394500732, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 53.55, "ram_util_percent": 27.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.00019531250000000007, "cur_lr": 0.0003, "total_loss": 7.332811546325684, "policy_loss": -0.00026697292923927307, "vf_loss": 7.33313528696696, "vf_explained_var": -1.5298525492350261e-06, "kl": 0.00035637636963201655, "entropy": 0.5669385194778442, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 158.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.315999999999825, "episode_len_mean": 267.48, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [33.70000000000004, 46.9, 42.70000000000001, -50.00000000000044, 33.70000000000004, -50.00000000000044, 21.699999999999868, 41.30000000000001, 42.10000000000001, 41.30000000000001, 41.100000000000016, 33.10000000000003, 16.29999999999979, -50.00000000000044, -50.00000000000044, 13.099999999999746, -50.00000000000044, 25.499999999999922, -50.00000000000044, 35.30000000000004, 17.299999999999805, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 29.099999999999973, 44.300000000000004, 43.7, 18.29999999999982, 43.7, 40.10000000000002, -50.00000000000044, 32.100000000000016, 35.500000000000036, 42.900000000000006, 12.69999999999974, 15.299999999999777, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, 35.900000000000034, 24.099999999999902, -50.00000000000044, 40.30000000000002, -50.00000000000044, 34.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.30000000000004, 44.300000000000004, 21.299999999999862, -50.00000000000044, 39.90000000000002, -50.00000000000044, 39.300000000000026, 38.300000000000026, -50.00000000000044, 36.10000000000004, 23.699999999999896, -50.00000000000044, 46.699999999999996, 43.7, 43.900000000000006, 44.300000000000004, 41.30000000000001, 44.5, 13.299999999999748, 44.900000000000006, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 44.10000000000001, 37.10000000000003, 45.9, 45.3, 43.900000000000006, 42.70000000000001, 44.7, -50.00000000000044, 45.9, 40.30000000000002, 39.70000000000002, 43.10000000000001, -50.00000000000044, 20.099999999999845, 43.7, -50.00000000000044], "episode_lengths": [164, 32, 74, 500, 164, 500, 284, 88, 80, 88, 90, 170, 338, 500, 500, 370, 500, 246, 500, 148, 328, 500, 54, 500, 500, 500, 30, 500, 210, 58, 64, 318, 64, 100, 500, 180, 146, 72, 374, 348, 500, 500, 500, 500, 118, 500, 500, 142, 260, 500, 98, 500, 158, 500, 500, 500, 500, 148, 58, 288, 500, 102, 500, 108, 118, 500, 140, 264, 500, 34, 64, 62, 58, 88, 56, 368, 52, 76, 500, 500, 500, 58, 500, 500, 60, 130, 42, 48, 62, 74, 54, 500, 42, 98, 104, 70, 500, 300, 64, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41629771639202834, "mean_inference_ms": 1.3320222873595549, "mean_action_processing_ms": 0.15458967744804872, "mean_env_wait_ms": 0.09188264197737044, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021950244903564453, "StateBufferConnector_ms": 0.0050048828125, "ViewRequirementAgentConnector_ms": 0.12093806266784668}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.315999999999825, "episode_len_mean": 267.48, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [33.70000000000004, 46.9, 42.70000000000001, -50.00000000000044, 33.70000000000004, -50.00000000000044, 21.699999999999868, 41.30000000000001, 42.10000000000001, 41.30000000000001, 41.100000000000016, 33.10000000000003, 16.29999999999979, -50.00000000000044, -50.00000000000044, 13.099999999999746, -50.00000000000044, 25.499999999999922, -50.00000000000044, 35.30000000000004, 17.299999999999805, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 29.099999999999973, 44.300000000000004, 43.7, 18.29999999999982, 43.7, 40.10000000000002, -50.00000000000044, 32.100000000000016, 35.500000000000036, 42.900000000000006, 12.69999999999974, 15.299999999999777, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, 35.900000000000034, 24.099999999999902, -50.00000000000044, 40.30000000000002, -50.00000000000044, 34.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.30000000000004, 44.300000000000004, 21.299999999999862, -50.00000000000044, 39.90000000000002, -50.00000000000044, 39.300000000000026, 38.300000000000026, -50.00000000000044, 36.10000000000004, 23.699999999999896, -50.00000000000044, 46.699999999999996, 43.7, 43.900000000000006, 44.300000000000004, 41.30000000000001, 44.5, 13.299999999999748, 44.900000000000006, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 44.10000000000001, 37.10000000000003, 45.9, 45.3, 43.900000000000006, 42.70000000000001, 44.7, -50.00000000000044, 45.9, 40.30000000000002, 39.70000000000002, 43.10000000000001, -50.00000000000044, 20.099999999999845, 43.7, -50.00000000000044], "episode_lengths": [164, 32, 74, 500, 164, 500, 284, 88, 80, 88, 90, 170, 338, 500, 500, 370, 500, 246, 500, 148, 328, 500, 54, 500, 500, 500, 30, 500, 210, 58, 64, 318, 64, 100, 500, 180, 146, 72, 374, 348, 500, 500, 500, 500, 118, 500, 500, 142, 260, 500, 98, 500, 158, 500, 500, 500, 500, 148, 58, 288, 500, 102, 500, 108, 118, 500, 140, 264, 500, 34, 64, 62, 58, 88, 56, 368, 52, 76, 500, 500, 500, 58, 500, 500, 60, 130, 42, 48, 62, 74, 54, 500, 42, 98, 104, 70, 500, 300, 64, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41629771639202834, "mean_inference_ms": 1.3320222873595549, "mean_action_processing_ms": 0.15458967744804872, "mean_env_wait_ms": 0.09188264197737044, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021950244903564453, "StateBufferConnector_ms": 0.0050048828125, "ViewRequirementAgentConnector_ms": 0.12093806266784668}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5532.4562521029075, "num_env_steps_trained_throughput_per_sec": 5532.4562521029075, "timesteps_total": 132000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 132000, "timers": {"training_iteration_time_ms": 2435.332, "sample_time_ms": 2197.107, "load_time_ms": 13.315, "load_throughput": 901236.908, "learn_time_ms": 212.558, "learn_throughput": 56455.234, "synch_weights_time_ms": 11.05}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "done": false, "episodes_total": 470, "training_iteration": 11, "trial_id": "9f288_00019", "date": "2023-10-25_17-06-59", "timestamp": 1698250019, "time_this_iter_s": 2.1750130653381348, "time_total_s": 26.452024459838867, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 26.452024459838867, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 65.53333333333335, "ram_util_percent": 27.53333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.765625000000003e-05, "cur_lr": 0.0003, "total_loss": 6.725507036844889, "policy_loss": -4.543637235959371e-05, "vf_loss": 6.725607617696126, "vf_explained_var": 2.408027648925781e-06, "kl": 0.00019660866422555046, "entropy": 0.5502736091613769, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 173.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.5999999999998264, "episode_len_mean": 264.62, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, 35.900000000000034, 24.099999999999902, -50.00000000000044, 40.30000000000002, -50.00000000000044, 34.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.30000000000004, 44.300000000000004, 21.299999999999862, -50.00000000000044, 39.90000000000002, -50.00000000000044, 39.300000000000026, 38.300000000000026, -50.00000000000044, 36.10000000000004, 23.699999999999896, -50.00000000000044, 46.699999999999996, 43.7, 43.900000000000006, 44.300000000000004, 41.30000000000001, 44.5, 13.299999999999748, 44.900000000000006, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 44.10000000000001, 37.10000000000003, 45.9, 45.3, 43.900000000000006, 42.70000000000001, 44.7, -50.00000000000044, 45.9, 40.30000000000002, 39.70000000000002, 43.10000000000001, -50.00000000000044, 20.099999999999845, 43.7, -50.00000000000044, -50.00000000000044, 43.50000000000001, 28.89999999999997, 44.5, 16.09999999999979, -50.00000000000044, 27.299999999999947, 41.500000000000014, 38.90000000000002, -50.00000000000044, 37.10000000000003, 34.70000000000004, -50.00000000000044, 45.1, 45.1, 39.70000000000002, 41.30000000000001, -50.00000000000044, 27.099999999999945, -50.00000000000044, 44.900000000000006, 40.70000000000002, 46.3, 37.70000000000003, 13.099999999999746, 33.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.10000000000004, 35.70000000000003, -50.00000000000044, 34.900000000000034, -50.00000000000044, 44.7, -50.00000000000044], "episode_lengths": [500, 118, 500, 500, 142, 260, 500, 98, 500, 158, 500, 500, 500, 500, 148, 58, 288, 500, 102, 500, 108, 118, 500, 140, 264, 500, 34, 64, 62, 58, 88, 56, 368, 52, 76, 500, 500, 500, 58, 500, 500, 60, 130, 42, 48, 62, 74, 54, 500, 42, 98, 104, 70, 500, 300, 64, 500, 500, 66, 212, 56, 340, 500, 228, 86, 112, 500, 130, 154, 500, 50, 50, 104, 88, 500, 230, 500, 52, 94, 38, 124, 370, 164, 500, 500, 500, 500, 54, 500, 94, 500, 500, 500, 150, 144, 500, 152, 500, 54, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41558283346937747, "mean_inference_ms": 1.3283721341429036, "mean_action_processing_ms": 0.1540511230463053, "mean_env_wait_ms": 0.09172668585656503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026986122131347656, "StateBufferConnector_ms": 0.009006261825561523, "ViewRequirementAgentConnector_ms": 0.10698533058166504}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.5999999999998264, "episode_len_mean": 264.62, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, 35.900000000000034, 24.099999999999902, -50.00000000000044, 40.30000000000002, -50.00000000000044, 34.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.30000000000004, 44.300000000000004, 21.299999999999862, -50.00000000000044, 39.90000000000002, -50.00000000000044, 39.300000000000026, 38.300000000000026, -50.00000000000044, 36.10000000000004, 23.699999999999896, -50.00000000000044, 46.699999999999996, 43.7, 43.900000000000006, 44.300000000000004, 41.30000000000001, 44.5, 13.299999999999748, 44.900000000000006, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 44.10000000000001, 37.10000000000003, 45.9, 45.3, 43.900000000000006, 42.70000000000001, 44.7, -50.00000000000044, 45.9, 40.30000000000002, 39.70000000000002, 43.10000000000001, -50.00000000000044, 20.099999999999845, 43.7, -50.00000000000044, -50.00000000000044, 43.50000000000001, 28.89999999999997, 44.5, 16.09999999999979, -50.00000000000044, 27.299999999999947, 41.500000000000014, 38.90000000000002, -50.00000000000044, 37.10000000000003, 34.70000000000004, -50.00000000000044, 45.1, 45.1, 39.70000000000002, 41.30000000000001, -50.00000000000044, 27.099999999999945, -50.00000000000044, 44.900000000000006, 40.70000000000002, 46.3, 37.70000000000003, 13.099999999999746, 33.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.10000000000004, 35.70000000000003, -50.00000000000044, 34.900000000000034, -50.00000000000044, 44.7, -50.00000000000044], "episode_lengths": [500, 118, 500, 500, 142, 260, 500, 98, 500, 158, 500, 500, 500, 500, 148, 58, 288, 500, 102, 500, 108, 118, 500, 140, 264, 500, 34, 64, 62, 58, 88, 56, 368, 52, 76, 500, 500, 500, 58, 500, 500, 60, 130, 42, 48, 62, 74, 54, 500, 42, 98, 104, 70, 500, 300, 64, 500, 500, 66, 212, 56, 340, 500, 228, 86, 112, 500, 130, 154, 500, 50, 50, 104, 88, 500, 230, 500, 52, 94, 38, 124, 370, 164, 500, 500, 500, 500, 54, 500, 94, 500, 500, 500, 150, 144, 500, 152, 500, 54, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41558283346937747, "mean_inference_ms": 1.3283721341429036, "mean_action_processing_ms": 0.1540511230463053, "mean_env_wait_ms": 0.09172668585656503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026986122131347656, "StateBufferConnector_ms": 0.009006261825561523, "ViewRequirementAgentConnector_ms": 0.10698533058166504}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5604.406859266516, "num_env_steps_trained_throughput_per_sec": 5604.406859266516, "timesteps_total": 144000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 2445.143, "sample_time_ms": 2207.213, "load_time_ms": 13.215, "load_throughput": 908070.94, "learn_time_ms": 212.544, "learn_throughput": 56459.028, "synch_weights_time_ms": 10.869}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "episodes_total": 513, "training_iteration": 12, "trial_id": "9f288_00019", "date": "2023-10-25_17-07-01", "timestamp": 1698250021, "time_this_iter_s": 2.146218776702881, "time_total_s": 28.598243236541748, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 28.598243236541748, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 65.03333333333333, "ram_util_percent": 27.46666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.8828125000000016e-05, "cur_lr": 0.0003, "total_loss": 6.497638543446858, "policy_loss": -0.0002863049507141113, "vf_loss": 6.497976938883464, "vf_explained_var": -1.1642773946126303e-06, "kl": 0.00028173792272809803, "entropy": 0.5214115659395854, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 188.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "sampler_results": {"episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.812999999999831, "episode_len_mean": 257.52, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.900000000000006, 42.70000000000001, 44.7, -50.00000000000044, 45.9, 40.30000000000002, 39.70000000000002, 43.10000000000001, -50.00000000000044, 20.099999999999845, 43.7, -50.00000000000044, -50.00000000000044, 43.50000000000001, 28.89999999999997, 44.5, 16.09999999999979, -50.00000000000044, 27.299999999999947, 41.500000000000014, 38.90000000000002, -50.00000000000044, 37.10000000000003, 34.70000000000004, -50.00000000000044, 45.1, 45.1, 39.70000000000002, 41.30000000000001, -50.00000000000044, 27.099999999999945, -50.00000000000044, 44.900000000000006, 40.70000000000002, 46.3, 37.70000000000003, 13.099999999999746, 33.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.10000000000004, 35.70000000000003, -50.00000000000044, 34.900000000000034, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.499999999999837, 44.10000000000001, 12.099999999999731, 43.10000000000001, 42.10000000000001, 8.299999999999677, 38.300000000000026, 36.900000000000034, 15.699999999999783, 19.09999999999983, -50.00000000000044, 44.300000000000004, 42.900000000000006, 39.50000000000002, -50.00000000000044, -50.00000000000044, 42.900000000000006, 30.9, 45.1, 46.099999999999994, 46.099999999999994, -50.00000000000044, -50.00000000000044, 45.5, 32.700000000000024, 21.09999999999986, -50.00000000000044, -50.00000000000044, 38.50000000000003, 46.099999999999994, 46.3, 43.30000000000001, 41.100000000000016, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 36.900000000000034, -50.00000000000044, 44.5], "episode_lengths": [62, 74, 54, 500, 42, 98, 104, 70, 500, 300, 64, 500, 500, 66, 212, 56, 340, 500, 228, 86, 112, 500, 130, 154, 500, 50, 50, 104, 88, 500, 230, 500, 52, 94, 38, 124, 370, 164, 500, 500, 500, 500, 54, 500, 94, 500, 500, 500, 150, 144, 500, 152, 500, 54, 500, 500, 500, 500, 306, 60, 380, 70, 80, 418, 118, 132, 344, 310, 500, 58, 72, 106, 500, 500, 72, 192, 50, 40, 40, 500, 500, 46, 174, 290, 500, 500, 116, 40, 38, 68, 90, 500, 40, 500, 500, 50, 500, 132, 500, 56]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41416868119869354, "mean_inference_ms": 1.3239866374273725, "mean_action_processing_ms": 0.15385089865864912, "mean_env_wait_ms": 0.09158440240615054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03299140930175781, "StateBufferConnector_ms": 0.009001016616821289, "ViewRequirementAgentConnector_ms": 0.10975003242492676}}, "episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.812999999999831, "episode_len_mean": 257.52, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.900000000000006, 42.70000000000001, 44.7, -50.00000000000044, 45.9, 40.30000000000002, 39.70000000000002, 43.10000000000001, -50.00000000000044, 20.099999999999845, 43.7, -50.00000000000044, -50.00000000000044, 43.50000000000001, 28.89999999999997, 44.5, 16.09999999999979, -50.00000000000044, 27.299999999999947, 41.500000000000014, 38.90000000000002, -50.00000000000044, 37.10000000000003, 34.70000000000004, -50.00000000000044, 45.1, 45.1, 39.70000000000002, 41.30000000000001, -50.00000000000044, 27.099999999999945, -50.00000000000044, 44.900000000000006, 40.70000000000002, 46.3, 37.70000000000003, 13.099999999999746, 33.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.10000000000004, 35.70000000000003, -50.00000000000044, 34.900000000000034, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.499999999999837, 44.10000000000001, 12.099999999999731, 43.10000000000001, 42.10000000000001, 8.299999999999677, 38.300000000000026, 36.900000000000034, 15.699999999999783, 19.09999999999983, -50.00000000000044, 44.300000000000004, 42.900000000000006, 39.50000000000002, -50.00000000000044, -50.00000000000044, 42.900000000000006, 30.9, 45.1, 46.099999999999994, 46.099999999999994, -50.00000000000044, -50.00000000000044, 45.5, 32.700000000000024, 21.09999999999986, -50.00000000000044, -50.00000000000044, 38.50000000000003, 46.099999999999994, 46.3, 43.30000000000001, 41.100000000000016, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 36.900000000000034, -50.00000000000044, 44.5], "episode_lengths": [62, 74, 54, 500, 42, 98, 104, 70, 500, 300, 64, 500, 500, 66, 212, 56, 340, 500, 228, 86, 112, 500, 130, 154, 500, 50, 50, 104, 88, 500, 230, 500, 52, 94, 38, 124, 370, 164, 500, 500, 500, 500, 54, 500, 94, 500, 500, 500, 150, 144, 500, 152, 500, 54, 500, 500, 500, 500, 306, 60, 380, 70, 80, 418, 118, 132, 344, 310, 500, 58, 72, 106, 500, 500, 72, 192, 50, 40, 40, 500, 500, 46, 174, 290, 500, 500, 116, 40, 38, 68, 90, 500, 40, 500, 500, 50, 500, 132, 500, 56]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41416868119869354, "mean_inference_ms": 1.3239866374273725, "mean_action_processing_ms": 0.15385089865864912, "mean_env_wait_ms": 0.09158440240615054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03299140930175781, "StateBufferConnector_ms": 0.009001016616821289, "ViewRequirementAgentConnector_ms": 0.10975003242492676}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5452.346663864572, "num_env_steps_trained_throughput_per_sec": 5452.346663864572, "timesteps_total": 156000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 156000, "timers": {"training_iteration_time_ms": 2451.184, "sample_time_ms": 2213.992, "load_time_ms": 13.215, "load_throughput": 908049.643, "learn_time_ms": 211.786, "learn_throughput": 56661.101, "synch_weights_time_ms": 10.788}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "done": false, "episodes_total": 558, "training_iteration": 13, "trial_id": "9f288_00019", "date": "2023-10-25_17-07-04", "timestamp": 1698250024, "time_this_iter_s": 2.205883264541626, "time_total_s": 30.804126501083374, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 30.804126501083374, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 63.70000000000001, "ram_util_percent": 27.433333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.4414062500000008e-05, "cur_lr": 0.0003, "total_loss": 5.981209309895833, "policy_loss": -0.0004936193426450093, "vf_loss": 5.981757481892903, "vf_explained_var": -1.426537831624349e-06, "kl": 0.0009653415700995538, "entropy": 0.5449527104695638, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 203.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "sampler_results": {"episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.4130000000002043, "episode_len_mean": 289.7, "episode_media": {}, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [33.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.10000000000004, 35.70000000000003, -50.00000000000044, 34.900000000000034, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.499999999999837, 44.10000000000001, 12.099999999999731, 43.10000000000001, 42.10000000000001, 8.299999999999677, 38.300000000000026, 36.900000000000034, 15.699999999999783, 19.09999999999983, -50.00000000000044, 44.300000000000004, 42.900000000000006, 39.50000000000002, -50.00000000000044, -50.00000000000044, 42.900000000000006, 30.9, 45.1, 46.099999999999994, 46.099999999999994, -50.00000000000044, -50.00000000000044, 45.5, 32.700000000000024, 21.09999999999986, -50.00000000000044, -50.00000000000044, 38.50000000000003, 46.099999999999994, 46.3, 43.30000000000001, 41.100000000000016, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 36.900000000000034, -50.00000000000044, 44.5, -50.00000000000044, 39.90000000000002, 37.90000000000003, 36.900000000000034, 44.7, 41.30000000000001, 45.9, 1.8999999999995865, 44.900000000000006, 45.5, 18.499999999999822, -50.00000000000044, 43.7, 8.899999999999686, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 43.30000000000001, 36.900000000000034, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, 33.10000000000003, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.300000000000026, 46.099999999999994, -50.00000000000044, -50.00000000000044], "episode_lengths": [164, 500, 500, 500, 500, 54, 500, 94, 500, 500, 500, 150, 144, 500, 152, 500, 54, 500, 500, 500, 500, 306, 60, 380, 70, 80, 418, 118, 132, 344, 310, 500, 58, 72, 106, 500, 500, 72, 192, 50, 40, 40, 500, 500, 46, 174, 290, 500, 500, 116, 40, 38, 68, 90, 500, 40, 500, 500, 50, 500, 132, 500, 56, 500, 102, 122, 132, 54, 88, 42, 482, 52, 46, 316, 500, 64, 412, 500, 500, 500, 500, 66, 68, 132, 500, 500, 92, 500, 170, 500, 500, 82, 500, 500, 500, 500, 108, 40, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4124619413806855, "mean_inference_ms": 1.319335917395323, "mean_action_processing_ms": 0.15305336008555506, "mean_env_wait_ms": 0.09107203402297827, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020998001098632812, "StateBufferConnector_ms": 0.007999420166015625, "ViewRequirementAgentConnector_ms": 0.1210165023803711}}, "episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.4130000000002043, "episode_len_mean": 289.7, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [33.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.10000000000004, 35.70000000000003, -50.00000000000044, 34.900000000000034, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.499999999999837, 44.10000000000001, 12.099999999999731, 43.10000000000001, 42.10000000000001, 8.299999999999677, 38.300000000000026, 36.900000000000034, 15.699999999999783, 19.09999999999983, -50.00000000000044, 44.300000000000004, 42.900000000000006, 39.50000000000002, -50.00000000000044, -50.00000000000044, 42.900000000000006, 30.9, 45.1, 46.099999999999994, 46.099999999999994, -50.00000000000044, -50.00000000000044, 45.5, 32.700000000000024, 21.09999999999986, -50.00000000000044, -50.00000000000044, 38.50000000000003, 46.099999999999994, 46.3, 43.30000000000001, 41.100000000000016, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 36.900000000000034, -50.00000000000044, 44.5, -50.00000000000044, 39.90000000000002, 37.90000000000003, 36.900000000000034, 44.7, 41.30000000000001, 45.9, 1.8999999999995865, 44.900000000000006, 45.5, 18.499999999999822, -50.00000000000044, 43.7, 8.899999999999686, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 43.30000000000001, 36.900000000000034, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, 33.10000000000003, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.300000000000026, 46.099999999999994, -50.00000000000044, -50.00000000000044], "episode_lengths": [164, 500, 500, 500, 500, 54, 500, 94, 500, 500, 500, 150, 144, 500, 152, 500, 54, 500, 500, 500, 500, 306, 60, 380, 70, 80, 418, 118, 132, 344, 310, 500, 58, 72, 106, 500, 500, 72, 192, 50, 40, 40, 500, 500, 46, 174, 290, 500, 500, 116, 40, 38, 68, 90, 500, 40, 500, 500, 50, 500, 132, 500, 56, 500, 102, 122, 132, 54, 88, 42, 482, 52, 46, 316, 500, 64, 412, 500, 500, 500, 500, 66, 68, 132, 500, 500, 92, 500, 170, 500, 500, 82, 500, 500, 500, 500, 108, 40, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4124619413806855, "mean_inference_ms": 1.319335917395323, "mean_action_processing_ms": 0.15305336008555506, "mean_env_wait_ms": 0.09107203402297827, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020998001098632812, "StateBufferConnector_ms": 0.007999420166015625, "ViewRequirementAgentConnector_ms": 0.1210165023803711}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5404.595054672889, "num_env_steps_trained_throughput_per_sec": 5404.595054672889, "timesteps_total": 168000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 168000, "timers": {"training_iteration_time_ms": 2425.148, "sample_time_ms": 2193.913, "load_time_ms": 13.115, "load_throughput": 914967.824, "learn_time_ms": 205.999, "learn_throughput": 58252.8, "synch_weights_time_ms": 10.718}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "done": false, "episodes_total": 595, "training_iteration": 14, "trial_id": "9f288_00019", "date": "2023-10-25_17-07-06", "timestamp": 1698250026, "time_this_iter_s": 2.2253470420837402, "time_total_s": 33.029473543167114, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 33.029473543167114, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 61.06666666666666, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.2207031250000004e-05, "cur_lr": 0.0003, "total_loss": 6.127297083536784, "policy_loss": -0.00017880996068318685, "vf_loss": 6.1275276184082035, "vf_explained_var": 9.139378865559896e-07, "kl": 0.0004174424144290848, "entropy": 0.5182341078917185, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 218.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.5049999999997992, "episode_len_mean": 280.52, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.700000000000024, 21.09999999999986, -50.00000000000044, -50.00000000000044, 38.50000000000003, 46.099999999999994, 46.3, 43.30000000000001, 41.100000000000016, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 36.900000000000034, -50.00000000000044, 44.5, -50.00000000000044, 39.90000000000002, 37.90000000000003, 36.900000000000034, 44.7, 41.30000000000001, 45.9, 1.8999999999995865, 44.900000000000006, 45.5, 18.499999999999822, -50.00000000000044, 43.7, 8.899999999999686, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 43.30000000000001, 36.900000000000034, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, 33.10000000000003, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.300000000000026, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 33.10000000000003, 47.1, 11.29999999999972, -50.00000000000044, -50.00000000000044, 30.699999999999996, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 12.69999999999974, 43.7, 41.30000000000001, 40.10000000000002, 44.300000000000004, -50.00000000000044, -50.00000000000044, 43.50000000000001, 41.30000000000001, 44.300000000000004, 44.5, 32.100000000000016, 45.5, -50.00000000000044, 38.700000000000024, 44.5, 44.7, 45.7, -50.00000000000044, 39.10000000000002, 36.10000000000004, -50.00000000000044], "episode_lengths": [174, 290, 500, 500, 116, 40, 38, 68, 90, 500, 40, 500, 500, 50, 500, 132, 500, 56, 500, 102, 122, 132, 54, 88, 42, 482, 52, 46, 316, 500, 64, 412, 500, 500, 500, 500, 66, 68, 132, 500, 500, 92, 500, 170, 500, 500, 82, 500, 500, 500, 500, 108, 40, 500, 500, 500, 500, 76, 500, 48, 500, 500, 170, 30, 388, 500, 500, 194, 500, 500, 58, 500, 500, 72, 500, 500, 56, 500, 374, 64, 88, 100, 58, 500, 500, 66, 88, 58, 56, 180, 46, 500, 114, 56, 54, 44, 500, 110, 140, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4109530064294976, "mean_inference_ms": 1.3144088566539016, "mean_action_processing_ms": 0.15137674886699154, "mean_env_wait_ms": 0.09047502007901852, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028002262115478516, "StateBufferConnector_ms": 0.00900125503540039, "ViewRequirementAgentConnector_ms": 0.11578106880187988}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.5049999999997992, "episode_len_mean": 280.52, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [32.700000000000024, 21.09999999999986, -50.00000000000044, -50.00000000000044, 38.50000000000003, 46.099999999999994, 46.3, 43.30000000000001, 41.100000000000016, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 36.900000000000034, -50.00000000000044, 44.5, -50.00000000000044, 39.90000000000002, 37.90000000000003, 36.900000000000034, 44.7, 41.30000000000001, 45.9, 1.8999999999995865, 44.900000000000006, 45.5, 18.499999999999822, -50.00000000000044, 43.7, 8.899999999999686, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 43.30000000000001, 36.900000000000034, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, 33.10000000000003, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.300000000000026, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 33.10000000000003, 47.1, 11.29999999999972, -50.00000000000044, -50.00000000000044, 30.699999999999996, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 12.69999999999974, 43.7, 41.30000000000001, 40.10000000000002, 44.300000000000004, -50.00000000000044, -50.00000000000044, 43.50000000000001, 41.30000000000001, 44.300000000000004, 44.5, 32.100000000000016, 45.5, -50.00000000000044, 38.700000000000024, 44.5, 44.7, 45.7, -50.00000000000044, 39.10000000000002, 36.10000000000004, -50.00000000000044], "episode_lengths": [174, 290, 500, 500, 116, 40, 38, 68, 90, 500, 40, 500, 500, 50, 500, 132, 500, 56, 500, 102, 122, 132, 54, 88, 42, 482, 52, 46, 316, 500, 64, 412, 500, 500, 500, 500, 66, 68, 132, 500, 500, 92, 500, 170, 500, 500, 82, 500, 500, 500, 500, 108, 40, 500, 500, 500, 500, 76, 500, 48, 500, 500, 170, 30, 388, 500, 500, 194, 500, 500, 58, 500, 500, 72, 500, 500, 56, 500, 374, 64, 88, 100, 58, 500, 500, 66, 88, 58, 56, 180, 46, 500, 114, 56, 54, 44, 500, 110, 140, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4109530064294976, "mean_inference_ms": 1.3144088566539016, "mean_action_processing_ms": 0.15137674886699154, "mean_env_wait_ms": 0.09047502007901852, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028002262115478516, "StateBufferConnector_ms": 0.00900125503540039, "ViewRequirementAgentConnector_ms": 0.11578106880187988}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5874.210806419988, "num_env_steps_trained_throughput_per_sec": 5874.210806419988, "timesteps_total": 180000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 180000, "timers": {"training_iteration_time_ms": 2345.548, "sample_time_ms": 2131.541, "load_time_ms": 12.133, "load_throughput": 989043.805, "learn_time_ms": 189.729, "learn_throughput": 63248.242, "synch_weights_time_ms": 10.544}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "done": false, "episodes_total": 640, "training_iteration": 15, "trial_id": "9f288_00019", "date": "2023-10-25_17-07-08", "timestamp": 1698250028, "time_this_iter_s": 2.048552989959717, "time_total_s": 35.07802653312683, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 35.07802653312683, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 59.699999999999996, "ram_util_percent": 27.433333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.103515625000002e-06, "cur_lr": 0.0003, "total_loss": 7.032413705190023, "policy_loss": -0.000590825080871582, "vf_loss": 7.03305918375651, "vf_explained_var": 1.7921129862467448e-06, "kl": 0.000556552305438629, "entropy": 0.5457219918568929, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 233.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.651999999999848, "episode_len_mean": 234.16, "episode_media": {}, "episodes_this_iter": 59, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.3, -50.00000000000044, -50.00000000000044, 33.10000000000003, 47.1, 11.29999999999972, -50.00000000000044, -50.00000000000044, 30.699999999999996, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 12.69999999999974, 43.7, 41.30000000000001, 40.10000000000002, 44.300000000000004, -50.00000000000044, -50.00000000000044, 43.50000000000001, 41.30000000000001, 44.300000000000004, 44.5, 32.100000000000016, 45.5, -50.00000000000044, 38.700000000000024, 44.5, 44.7, 45.7, -50.00000000000044, 39.10000000000002, 36.10000000000004, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 44.900000000000006, 42.500000000000014, 44.900000000000006, 46.099999999999994, -50.00000000000044, 41.100000000000016, -50.00000000000044, 37.90000000000003, -50.00000000000044, 46.3, 35.70000000000003, 39.300000000000026, 41.100000000000016, 41.30000000000001, -50.00000000000044, 43.30000000000001, 41.90000000000001, 45.9, 32.100000000000016, 42.30000000000001, 4.699999999999626, 37.50000000000003, 15.899999999999785, 45.7, 44.300000000000004, -50.00000000000044, 29.099999999999973, 40.90000000000002, 44.300000000000004, 18.699999999999825, 46.099999999999994, 43.50000000000001, 22.099999999999874, -50.00000000000044, -50.00000000000044, 37.90000000000003, 42.500000000000014, 46.699999999999996, -50.00000000000044, 18.899999999999828, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 47.3, 45.5, 41.70000000000002, 46.099999999999994, 46.5, -50.00000000000044, 38.700000000000024, -50.00000000000044, 44.900000000000006, 36.900000000000034, -50.00000000000044, 42.10000000000001], "episode_lengths": [48, 500, 500, 170, 30, 388, 500, 500, 194, 500, 500, 58, 500, 500, 72, 500, 500, 56, 500, 374, 64, 88, 100, 58, 500, 500, 66, 88, 58, 56, 180, 46, 500, 114, 56, 54, 44, 500, 110, 140, 500, 500, 42, 500, 52, 76, 52, 40, 500, 90, 500, 122, 500, 38, 144, 108, 90, 88, 500, 68, 82, 42, 180, 78, 454, 126, 342, 44, 58, 500, 210, 92, 58, 314, 40, 66, 280, 500, 500, 122, 76, 34, 500, 312, 500, 72, 500, 500, 28, 46, 84, 40, 36, 500, 114, 500, 52, 132, 500, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.408642733266022, "mean_inference_ms": 1.3072777575154388, "mean_action_processing_ms": 0.15075847355577784, "mean_env_wait_ms": 0.09002570866064896, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03456234931945801, "StateBufferConnector_ms": 0.00800013542175293, "ViewRequirementAgentConnector_ms": 0.10303449630737305}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.651999999999848, "episode_len_mean": 234.16, "episodes_this_iter": 59, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.3, -50.00000000000044, -50.00000000000044, 33.10000000000003, 47.1, 11.29999999999972, -50.00000000000044, -50.00000000000044, 30.699999999999996, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 12.69999999999974, 43.7, 41.30000000000001, 40.10000000000002, 44.300000000000004, -50.00000000000044, -50.00000000000044, 43.50000000000001, 41.30000000000001, 44.300000000000004, 44.5, 32.100000000000016, 45.5, -50.00000000000044, 38.700000000000024, 44.5, 44.7, 45.7, -50.00000000000044, 39.10000000000002, 36.10000000000004, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 44.900000000000006, 42.500000000000014, 44.900000000000006, 46.099999999999994, -50.00000000000044, 41.100000000000016, -50.00000000000044, 37.90000000000003, -50.00000000000044, 46.3, 35.70000000000003, 39.300000000000026, 41.100000000000016, 41.30000000000001, -50.00000000000044, 43.30000000000001, 41.90000000000001, 45.9, 32.100000000000016, 42.30000000000001, 4.699999999999626, 37.50000000000003, 15.899999999999785, 45.7, 44.300000000000004, -50.00000000000044, 29.099999999999973, 40.90000000000002, 44.300000000000004, 18.699999999999825, 46.099999999999994, 43.50000000000001, 22.099999999999874, -50.00000000000044, -50.00000000000044, 37.90000000000003, 42.500000000000014, 46.699999999999996, -50.00000000000044, 18.899999999999828, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 47.3, 45.5, 41.70000000000002, 46.099999999999994, 46.5, -50.00000000000044, 38.700000000000024, -50.00000000000044, 44.900000000000006, 36.900000000000034, -50.00000000000044, 42.10000000000001], "episode_lengths": [48, 500, 500, 170, 30, 388, 500, 500, 194, 500, 500, 58, 500, 500, 72, 500, 500, 56, 500, 374, 64, 88, 100, 58, 500, 500, 66, 88, 58, 56, 180, 46, 500, 114, 56, 54, 44, 500, 110, 140, 500, 500, 42, 500, 52, 76, 52, 40, 500, 90, 500, 122, 500, 38, 144, 108, 90, 88, 500, 68, 82, 42, 180, 78, 454, 126, 342, 44, 58, 500, 210, 92, 58, 314, 40, 66, 280, 500, 500, 122, 76, 34, 500, 312, 500, 72, 500, 500, 28, 46, 84, 40, 36, 500, 114, 500, 52, 132, 500, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.408642733266022, "mean_inference_ms": 1.3072777575154388, "mean_action_processing_ms": 0.15075847355577784, "mean_env_wait_ms": 0.09002570866064896, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03456234931945801, "StateBufferConnector_ms": 0.00800013542175293, "ViewRequirementAgentConnector_ms": 0.10303449630737305}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5471.094749453697, "num_env_steps_trained_throughput_per_sec": 5471.094749453697, "timesteps_total": 192000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 2306.448, "sample_time_ms": 2091.192, "load_time_ms": 11.733, "load_throughput": 1022749.446, "learn_time_ms": 191.412, "learn_throughput": 62692.042, "synch_weights_time_ms": 10.309}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "episodes_total": 699, "training_iteration": 16, "trial_id": "9f288_00019", "date": "2023-10-25_17-07-10", "timestamp": 1698250030, "time_this_iter_s": 2.198340654373169, "time_total_s": 37.2763671875, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 37.2763671875, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 63.23333333333333, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.051757812500001e-06, "cur_lr": 0.0003, "total_loss": 6.791529432932536, "policy_loss": -0.0005692791426554322, "vf_loss": 6.79214719136556, "vf_explained_var": -4.76837158203125e-07, "kl": 0.0006202232713045911, "entropy": 0.48357308506965635, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 248.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.787999999999829, "episode_len_mean": 252.76, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 44.900000000000006, 42.500000000000014, 44.900000000000006, 46.099999999999994, -50.00000000000044, 41.100000000000016, -50.00000000000044, 37.90000000000003, -50.00000000000044, 46.3, 35.70000000000003, 39.300000000000026, 41.100000000000016, 41.30000000000001, -50.00000000000044, 43.30000000000001, 41.90000000000001, 45.9, 32.100000000000016, 42.30000000000001, 4.699999999999626, 37.50000000000003, 15.899999999999785, 45.7, 44.300000000000004, -50.00000000000044, 29.099999999999973, 40.90000000000002, 44.300000000000004, 18.699999999999825, 46.099999999999994, 43.50000000000001, 22.099999999999874, -50.00000000000044, -50.00000000000044, 37.90000000000003, 42.500000000000014, 46.699999999999996, -50.00000000000044, 18.899999999999828, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 47.3, 45.5, 41.70000000000002, 46.099999999999994, 46.5, -50.00000000000044, 38.700000000000024, -50.00000000000044, 44.900000000000006, 36.900000000000034, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 26.89999999999994, 45.5, 46.3, 17.099999999999802, -50.00000000000044, -50.00000000000044, 38.700000000000024, -50.00000000000044, 45.7, 9.299999999999692, 41.70000000000002, 43.10000000000001, 44.10000000000001, 42.10000000000001, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 38.90000000000002, 45.9, -50.00000000000044, -50.00000000000044, 28.89999999999997, 42.10000000000001, -50.00000000000044, -50.00000000000044, 28.89999999999997, -50.00000000000044, -50.00000000000044, 30.29999999999999, -50.00000000000044, 42.30000000000001, -50.00000000000044], "episode_lengths": [500, 500, 42, 500, 52, 76, 52, 40, 500, 90, 500, 122, 500, 38, 144, 108, 90, 88, 500, 68, 82, 42, 180, 78, 454, 126, 342, 44, 58, 500, 210, 92, 58, 314, 40, 66, 280, 500, 500, 122, 76, 34, 500, 312, 500, 72, 500, 500, 28, 46, 84, 40, 36, 500, 114, 500, 52, 132, 500, 80, 500, 500, 46, 500, 500, 500, 44, 232, 46, 38, 330, 500, 500, 114, 500, 44, 408, 84, 70, 60, 80, 500, 500, 42, 500, 112, 42, 500, 500, 212, 80, 500, 500, 212, 500, 500, 198, 500, 78, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.406593138709355, "mean_inference_ms": 1.3024917595053298, "mean_action_processing_ms": 0.15125567322187128, "mean_env_wait_ms": 0.08991413093643215, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03355240821838379, "StateBufferConnector_ms": 0.004997730255126953, "ViewRequirementAgentConnector_ms": 0.11204981803894043}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.787999999999829, "episode_len_mean": 252.76, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 44.900000000000006, 42.500000000000014, 44.900000000000006, 46.099999999999994, -50.00000000000044, 41.100000000000016, -50.00000000000044, 37.90000000000003, -50.00000000000044, 46.3, 35.70000000000003, 39.300000000000026, 41.100000000000016, 41.30000000000001, -50.00000000000044, 43.30000000000001, 41.90000000000001, 45.9, 32.100000000000016, 42.30000000000001, 4.699999999999626, 37.50000000000003, 15.899999999999785, 45.7, 44.300000000000004, -50.00000000000044, 29.099999999999973, 40.90000000000002, 44.300000000000004, 18.699999999999825, 46.099999999999994, 43.50000000000001, 22.099999999999874, -50.00000000000044, -50.00000000000044, 37.90000000000003, 42.500000000000014, 46.699999999999996, -50.00000000000044, 18.899999999999828, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 47.3, 45.5, 41.70000000000002, 46.099999999999994, 46.5, -50.00000000000044, 38.700000000000024, -50.00000000000044, 44.900000000000006, 36.900000000000034, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 26.89999999999994, 45.5, 46.3, 17.099999999999802, -50.00000000000044, -50.00000000000044, 38.700000000000024, -50.00000000000044, 45.7, 9.299999999999692, 41.70000000000002, 43.10000000000001, 44.10000000000001, 42.10000000000001, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 38.90000000000002, 45.9, -50.00000000000044, -50.00000000000044, 28.89999999999997, 42.10000000000001, -50.00000000000044, -50.00000000000044, 28.89999999999997, -50.00000000000044, -50.00000000000044, 30.29999999999999, -50.00000000000044, 42.30000000000001, -50.00000000000044], "episode_lengths": [500, 500, 42, 500, 52, 76, 52, 40, 500, 90, 500, 122, 500, 38, 144, 108, 90, 88, 500, 68, 82, 42, 180, 78, 454, 126, 342, 44, 58, 500, 210, 92, 58, 314, 40, 66, 280, 500, 500, 122, 76, 34, 500, 312, 500, 72, 500, 500, 28, 46, 84, 40, 36, 500, 114, 500, 52, 132, 500, 80, 500, 500, 46, 500, 500, 500, 44, 232, 46, 38, 330, 500, 500, 114, 500, 44, 408, 84, 70, 60, 80, 500, 500, 42, 500, 112, 42, 500, 500, 212, 80, 500, 500, 212, 500, 500, 198, 500, 78, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.406593138709355, "mean_inference_ms": 1.3024917595053298, "mean_action_processing_ms": 0.15125567322187128, "mean_env_wait_ms": 0.08991413093643215, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03355240821838379, "StateBufferConnector_ms": 0.004997730255126953, "ViewRequirementAgentConnector_ms": 0.11204981803894043}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5399.807982120386, "num_env_steps_trained_throughput_per_sec": 5399.807982120386, "timesteps_total": 204000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 204000, "timers": {"training_iteration_time_ms": 2271.255, "sample_time_ms": 2053.577, "load_time_ms": 11.93, "load_throughput": 1005840.358, "learn_time_ms": 193.836, "learn_throughput": 61907.967, "synch_weights_time_ms": 10.009}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "done": false, "episodes_total": 739, "training_iteration": 17, "trial_id": "9f288_00019", "date": "2023-10-25_17-07-12", "timestamp": 1698250032, "time_this_iter_s": 2.227299213409424, "time_total_s": 39.503666400909424, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 39.503666400909424, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 58.46666666666666, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.5258789062500005e-06, "cur_lr": 0.0003, "total_loss": 6.552782090504964, "policy_loss": -0.0007242975135644277, "vf_loss": 6.553557395935059, "vf_explained_var": 8.225440979003907e-07, "kl": 0.0011897530210717377, "entropy": 0.5095946331818898, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 263.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.5689999999998024, "episode_len_mean": 279.88, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 47.3, 45.5, 41.70000000000002, 46.099999999999994, 46.5, -50.00000000000044, 38.700000000000024, -50.00000000000044, 44.900000000000006, 36.900000000000034, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 26.89999999999994, 45.5, 46.3, 17.099999999999802, -50.00000000000044, -50.00000000000044, 38.700000000000024, -50.00000000000044, 45.7, 9.299999999999692, 41.70000000000002, 43.10000000000001, 44.10000000000001, 42.10000000000001, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 38.90000000000002, 45.9, -50.00000000000044, -50.00000000000044, 28.89999999999997, 42.10000000000001, -50.00000000000044, -50.00000000000044, 28.89999999999997, -50.00000000000044, -50.00000000000044, 30.29999999999999, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 43.10000000000001, -50.00000000000044, -50.00000000000044, 33.10000000000003, 41.90000000000001, 38.50000000000003, 20.49999999999985, 42.30000000000001, -50.00000000000044, 25.29999999999992, 36.70000000000003, 35.500000000000036, -50.00000000000044, 17.499999999999808, -50.00000000000044, 21.09999999999986, 41.100000000000016, 46.099999999999994, -50.00000000000044, 46.099999999999994, 46.3, -50.00000000000044, 28.699999999999967, -50.00000000000044, -50.00000000000044, 44.7, 45.7, 38.10000000000002, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.70000000000004, 47.1, 27.899999999999956, 40.500000000000014], "episode_lengths": [500, 72, 500, 500, 28, 46, 84, 40, 36, 500, 114, 500, 52, 132, 500, 80, 500, 500, 46, 500, 500, 500, 44, 232, 46, 38, 330, 500, 500, 114, 500, 44, 408, 84, 70, 60, 80, 500, 500, 42, 500, 112, 42, 500, 500, 212, 80, 500, 500, 212, 500, 500, 198, 500, 78, 500, 500, 500, 500, 44, 70, 500, 500, 170, 82, 116, 296, 78, 500, 248, 134, 146, 500, 326, 500, 290, 90, 40, 500, 40, 38, 500, 214, 500, 500, 54, 44, 120, 34, 500, 500, 500, 46, 500, 500, 500, 164, 30, 222, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4050617834253303, "mean_inference_ms": 1.2981600110435954, "mean_action_processing_ms": 0.15047845931717332, "mean_env_wait_ms": 0.0897381795144106, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.036997079849243164, "StateBufferConnector_ms": 0.00799870491027832, "ViewRequirementAgentConnector_ms": 0.1085348129272461}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.5689999999998024, "episode_len_mean": 279.88, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 47.3, 45.5, 41.70000000000002, 46.099999999999994, 46.5, -50.00000000000044, 38.700000000000024, -50.00000000000044, 44.900000000000006, 36.900000000000034, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 26.89999999999994, 45.5, 46.3, 17.099999999999802, -50.00000000000044, -50.00000000000044, 38.700000000000024, -50.00000000000044, 45.7, 9.299999999999692, 41.70000000000002, 43.10000000000001, 44.10000000000001, 42.10000000000001, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 38.90000000000002, 45.9, -50.00000000000044, -50.00000000000044, 28.89999999999997, 42.10000000000001, -50.00000000000044, -50.00000000000044, 28.89999999999997, -50.00000000000044, -50.00000000000044, 30.29999999999999, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 43.10000000000001, -50.00000000000044, -50.00000000000044, 33.10000000000003, 41.90000000000001, 38.50000000000003, 20.49999999999985, 42.30000000000001, -50.00000000000044, 25.29999999999992, 36.70000000000003, 35.500000000000036, -50.00000000000044, 17.499999999999808, -50.00000000000044, 21.09999999999986, 41.100000000000016, 46.099999999999994, -50.00000000000044, 46.099999999999994, 46.3, -50.00000000000044, 28.699999999999967, -50.00000000000044, -50.00000000000044, 44.7, 45.7, 38.10000000000002, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.70000000000004, 47.1, 27.899999999999956, 40.500000000000014], "episode_lengths": [500, 72, 500, 500, 28, 46, 84, 40, 36, 500, 114, 500, 52, 132, 500, 80, 500, 500, 46, 500, 500, 500, 44, 232, 46, 38, 330, 500, 500, 114, 500, 44, 408, 84, 70, 60, 80, 500, 500, 42, 500, 112, 42, 500, 500, 212, 80, 500, 500, 212, 500, 500, 198, 500, 78, 500, 500, 500, 500, 44, 70, 500, 500, 170, 82, 116, 296, 78, 500, 248, 134, 146, 500, 326, 500, 290, 90, 40, 500, 40, 38, 500, 214, 500, 500, 54, 44, 120, 34, 500, 500, 500, 46, 500, 500, 500, 164, 30, 222, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4050617834253303, "mean_inference_ms": 1.2981600110435954, "mean_action_processing_ms": 0.15047845931717332, "mean_env_wait_ms": 0.0897381795144106, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.036997079849243164, "StateBufferConnector_ms": 0.00799870491027832, "ViewRequirementAgentConnector_ms": 0.1085348129272461}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5424.157022749353, "num_env_steps_trained_throughput_per_sec": 5424.157022749353, "timesteps_total": 216000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 216000, "timers": {"training_iteration_time_ms": 2250.814, "sample_time_ms": 2019.032, "load_time_ms": 12.53, "load_throughput": 957685.647, "learn_time_ms": 207.74, "learn_throughput": 57764.541, "synch_weights_time_ms": 9.609}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "done": false, "episodes_total": 783, "training_iteration": 18, "trial_id": "9f288_00019", "date": "2023-10-25_17-07-15", "timestamp": 1698250035, "time_this_iter_s": 2.2173235416412354, "time_total_s": 41.72098994255066, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 41.72098994255066, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 57.43333333333334, "ram_util_percent": 27.433333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.629394531250003e-07, "cur_lr": 0.0003, "total_loss": 6.058689816792806, "policy_loss": 2.3768345514933267e-05, "vf_loss": 6.058715375264486, "vf_explained_var": -1.5894571940104167e-06, "kl": 1.4278357836398451e-05, "entropy": 0.4923966566721598, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 278.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.2879999999998035, "episode_len_mean": 277.7, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.9, -50.00000000000044, -50.00000000000044, 28.89999999999997, 42.10000000000001, -50.00000000000044, -50.00000000000044, 28.89999999999997, -50.00000000000044, -50.00000000000044, 30.29999999999999, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 43.10000000000001, -50.00000000000044, -50.00000000000044, 33.10000000000003, 41.90000000000001, 38.50000000000003, 20.49999999999985, 42.30000000000001, -50.00000000000044, 25.29999999999992, 36.70000000000003, 35.500000000000036, -50.00000000000044, 17.499999999999808, -50.00000000000044, 21.09999999999986, 41.100000000000016, 46.099999999999994, -50.00000000000044, 46.099999999999994, 46.3, -50.00000000000044, 28.699999999999967, -50.00000000000044, -50.00000000000044, 44.7, 45.7, 38.10000000000002, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.70000000000004, 47.1, 27.899999999999956, 40.500000000000014, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, 45.7, 19.499999999999837, -50.00000000000044, 45.1, 45.3, 0.09999999999956088, 43.900000000000006, 46.099999999999994, 46.3, 46.5, 39.90000000000002, 40.30000000000002, 42.900000000000006, 42.500000000000014, 41.70000000000002, 42.10000000000001, 46.9, 38.700000000000024, 11.499999999999723, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 42.900000000000006, 43.900000000000006, 47.3, -50.00000000000044, -50.00000000000044], "episode_lengths": [42, 500, 500, 212, 80, 500, 500, 212, 500, 500, 198, 500, 78, 500, 500, 500, 500, 44, 70, 500, 500, 170, 82, 116, 296, 78, 500, 248, 134, 146, 500, 326, 500, 290, 90, 40, 500, 40, 38, 500, 214, 500, 500, 54, 44, 120, 34, 500, 500, 500, 46, 500, 500, 500, 164, 30, 222, 96, 500, 36, 500, 500, 130, 500, 44, 306, 500, 50, 48, 500, 62, 40, 38, 36, 102, 98, 72, 76, 84, 80, 32, 114, 386, 500, 500, 500, 500, 500, 72, 500, 90, 500, 500, 58, 500, 72, 62, 28, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4038765003267797, "mean_inference_ms": 1.2943849344346663, "mean_action_processing_ms": 0.14999121359732914, "mean_env_wait_ms": 0.08938504030646417, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029969453811645508, "StateBufferConnector_ms": 0.004998445510864258, "ViewRequirementAgentConnector_ms": 0.11899876594543457}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.2879999999998035, "episode_len_mean": 277.7, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.9, -50.00000000000044, -50.00000000000044, 28.89999999999997, 42.10000000000001, -50.00000000000044, -50.00000000000044, 28.89999999999997, -50.00000000000044, -50.00000000000044, 30.29999999999999, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 43.10000000000001, -50.00000000000044, -50.00000000000044, 33.10000000000003, 41.90000000000001, 38.50000000000003, 20.49999999999985, 42.30000000000001, -50.00000000000044, 25.29999999999992, 36.70000000000003, 35.500000000000036, -50.00000000000044, 17.499999999999808, -50.00000000000044, 21.09999999999986, 41.100000000000016, 46.099999999999994, -50.00000000000044, 46.099999999999994, 46.3, -50.00000000000044, 28.699999999999967, -50.00000000000044, -50.00000000000044, 44.7, 45.7, 38.10000000000002, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.70000000000004, 47.1, 27.899999999999956, 40.500000000000014, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, 45.7, 19.499999999999837, -50.00000000000044, 45.1, 45.3, 0.09999999999956088, 43.900000000000006, 46.099999999999994, 46.3, 46.5, 39.90000000000002, 40.30000000000002, 42.900000000000006, 42.500000000000014, 41.70000000000002, 42.10000000000001, 46.9, 38.700000000000024, 11.499999999999723, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 42.900000000000006, 43.900000000000006, 47.3, -50.00000000000044, -50.00000000000044], "episode_lengths": [42, 500, 500, 212, 80, 500, 500, 212, 500, 500, 198, 500, 78, 500, 500, 500, 500, 44, 70, 500, 500, 170, 82, 116, 296, 78, 500, 248, 134, 146, 500, 326, 500, 290, 90, 40, 500, 40, 38, 500, 214, 500, 500, 54, 44, 120, 34, 500, 500, 500, 46, 500, 500, 500, 164, 30, 222, 96, 500, 36, 500, 500, 130, 500, 44, 306, 500, 50, 48, 500, 62, 40, 38, 36, 102, 98, 72, 76, 84, 80, 32, 114, 386, 500, 500, 500, 500, 500, 72, 500, 90, 500, 500, 58, 500, 72, 62, 28, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4038765003267797, "mean_inference_ms": 1.2943849344346663, "mean_action_processing_ms": 0.14999121359732914, "mean_env_wait_ms": 0.08938504030646417, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029969453811645508, "StateBufferConnector_ms": 0.004998445510864258, "ViewRequirementAgentConnector_ms": 0.11899876594543457}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5183.405817623827, "num_env_steps_trained_throughput_per_sec": 5183.405817623827, "timesteps_total": 228000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 228000, "timers": {"training_iteration_time_ms": 2232.521, "sample_time_ms": 1990.705, "load_time_ms": 12.256, "load_throughput": 979093.031, "learn_time_ms": 218.173, "learn_throughput": 55002.228, "synch_weights_time_ms": 9.484}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "done": false, "episodes_total": 825, "training_iteration": 19, "trial_id": "9f288_00019", "date": "2023-10-25_17-07-17", "timestamp": 1698250037, "time_this_iter_s": 2.3200767040252686, "time_total_s": 44.04106664657593, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 44.04106664657593, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 55.625, "ram_util_percent": 27.475}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.8146972656250013e-07, "cur_lr": 0.0003, "total_loss": 6.462950261433919, "policy_loss": -0.00039294858773549396, "vf_loss": 6.463393370310466, "vf_explained_var": -3.910064697265625e-06, "kl": 0.0003750747355785696, "entropy": 0.5004091401894887, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 293.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.905999999999798, "episode_len_mean": 281.52, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [28.699999999999967, -50.00000000000044, -50.00000000000044, 44.7, 45.7, 38.10000000000002, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.70000000000004, 47.1, 27.899999999999956, 40.500000000000014, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, 45.7, 19.499999999999837, -50.00000000000044, 45.1, 45.3, 0.09999999999956088, 43.900000000000006, 46.099999999999994, 46.3, 46.5, 39.90000000000002, 40.30000000000002, 42.900000000000006, 42.500000000000014, 41.70000000000002, 42.10000000000001, 46.9, 38.700000000000024, 11.499999999999723, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 42.900000000000006, 43.900000000000006, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, 38.10000000000002, 20.299999999999848, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.900000000000013, 31.70000000000001, 28.699999999999967, 41.70000000000002, 23.29999999999989, -50.00000000000044, -50.00000000000044, 27.899999999999956, 39.70000000000002, 40.500000000000014, -50.00000000000044, -50.00000000000044, 46.099999999999994, 44.300000000000004, 2.699999999999598, 37.300000000000026, 6.099999999999646, 37.50000000000003, 41.70000000000002, 42.500000000000014, -50.00000000000044, 40.70000000000002, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044], "episode_lengths": [214, 500, 500, 54, 44, 120, 34, 500, 500, 500, 46, 500, 500, 500, 164, 30, 222, 96, 500, 36, 500, 500, 130, 500, 44, 306, 500, 50, 48, 500, 62, 40, 38, 36, 102, 98, 72, 76, 84, 80, 32, 114, 386, 500, 500, 500, 500, 500, 72, 500, 90, 500, 500, 58, 500, 72, 62, 28, 500, 500, 500, 500, 500, 28, 500, 500, 120, 298, 500, 500, 28, 500, 500, 500, 182, 184, 214, 84, 268, 500, 500, 222, 104, 96, 500, 500, 40, 58, 474, 128, 440, 126, 84, 76, 500, 94, 500, 64, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4037891234304459, "mean_inference_ms": 1.29271223599333, "mean_action_processing_ms": 0.14939251884498123, "mean_env_wait_ms": 0.0891281145244311, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02400374412536621, "StateBufferConnector_ms": 0.004999399185180664, "ViewRequirementAgentConnector_ms": 0.14599108695983887}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.905999999999798, "episode_len_mean": 281.52, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [28.699999999999967, -50.00000000000044, -50.00000000000044, 44.7, 45.7, 38.10000000000002, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.70000000000004, 47.1, 27.899999999999956, 40.500000000000014, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, 45.7, 19.499999999999837, -50.00000000000044, 45.1, 45.3, 0.09999999999956088, 43.900000000000006, 46.099999999999994, 46.3, 46.5, 39.90000000000002, 40.30000000000002, 42.900000000000006, 42.500000000000014, 41.70000000000002, 42.10000000000001, 46.9, 38.700000000000024, 11.499999999999723, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 42.900000000000006, 43.900000000000006, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, 38.10000000000002, 20.299999999999848, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.900000000000013, 31.70000000000001, 28.699999999999967, 41.70000000000002, 23.29999999999989, -50.00000000000044, -50.00000000000044, 27.899999999999956, 39.70000000000002, 40.500000000000014, -50.00000000000044, -50.00000000000044, 46.099999999999994, 44.300000000000004, 2.699999999999598, 37.300000000000026, 6.099999999999646, 37.50000000000003, 41.70000000000002, 42.500000000000014, -50.00000000000044, 40.70000000000002, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044], "episode_lengths": [214, 500, 500, 54, 44, 120, 34, 500, 500, 500, 46, 500, 500, 500, 164, 30, 222, 96, 500, 36, 500, 500, 130, 500, 44, 306, 500, 50, 48, 500, 62, 40, 38, 36, 102, 98, 72, 76, 84, 80, 32, 114, 386, 500, 500, 500, 500, 500, 72, 500, 90, 500, 500, 58, 500, 72, 62, 28, 500, 500, 500, 500, 500, 28, 500, 500, 120, 298, 500, 500, 28, 500, 500, 500, 182, 184, 214, 84, 268, 500, 500, 222, 104, 96, 500, 500, 40, 58, 474, 128, 440, 126, 84, 76, 500, 94, 500, 64, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4037891234304459, "mean_inference_ms": 1.29271223599333, "mean_action_processing_ms": 0.14939251884498123, "mean_env_wait_ms": 0.0891281145244311, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02400374412536621, "StateBufferConnector_ms": 0.004999399185180664, "ViewRequirementAgentConnector_ms": 0.14599108695983887}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5512.1255124531845, "num_env_steps_trained_throughput_per_sec": 5512.1255124531845, "timesteps_total": 240000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 2189.431, "sample_time_ms": 1965.742, "load_time_ms": 9.597, "load_throughput": 1250419.807, "learn_time_ms": 202.636, "learn_throughput": 59219.472, "synch_weights_time_ms": 9.454}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "episodes_total": 865, "training_iteration": 20, "trial_id": "9f288_00019", "date": "2023-10-25_17-07-19", "timestamp": 1698250039, "time_this_iter_s": 2.1820192337036133, "time_total_s": 46.22308588027954, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 46.22308588027954, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 65.73333333333333, "ram_util_percent": 27.433333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.9073486328125006e-07, "cur_lr": 0.0003, "total_loss": 7.169468466440836, "policy_loss": -0.0005790309359629948, "vf_loss": 7.1701026598612465, "vf_explained_var": -2.447764078776042e-06, "kl": 0.0008473026778043883, "entropy": 0.5510822772979737, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 308.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.9309999999997991, "episode_len_mean": 286.28, "episode_media": {}, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 42.900000000000006, 43.900000000000006, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, 38.10000000000002, 20.299999999999848, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.900000000000013, 31.70000000000001, 28.699999999999967, 41.70000000000002, 23.29999999999989, -50.00000000000044, -50.00000000000044, 27.899999999999956, 39.70000000000002, 40.500000000000014, -50.00000000000044, -50.00000000000044, 46.099999999999994, 44.300000000000004, 2.699999999999598, 37.300000000000026, 6.099999999999646, 37.50000000000003, 41.70000000000002, 42.500000000000014, -50.00000000000044, 40.70000000000002, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 32.100000000000016, 44.900000000000006, 45.5, 45.5, -50.00000000000044, 35.900000000000034, 40.70000000000002, -50.00000000000044, 46.3, 46.9, -50.00000000000044, 44.7, 45.1, 45.1, -50.00000000000044, 5.299999999999635, 43.30000000000001, -50.00000000000044, 18.29999999999982, 45.1, 30.099999999999987, 44.7, 44.5, 19.899999999999842, 19.499999999999837, 44.5, 21.699999999999868, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 44.900000000000006, -50.00000000000044, 34.70000000000004, -50.00000000000044, 30.699999999999996, 28.09999999999996, -50.00000000000044, 36.900000000000034, 42.70000000000001, -50.00000000000044, 24.299999999999905, 21.09999999999986, -50.00000000000044], "episode_lengths": [500, 500, 58, 500, 72, 62, 28, 500, 500, 500, 500, 500, 28, 500, 500, 120, 298, 500, 500, 28, 500, 500, 500, 182, 184, 214, 84, 268, 500, 500, 222, 104, 96, 500, 500, 40, 58, 474, 128, 440, 126, 84, 76, 500, 94, 500, 64, 500, 500, 500, 500, 54, 500, 500, 180, 52, 46, 46, 500, 142, 94, 500, 38, 32, 500, 54, 50, 50, 500, 448, 68, 500, 318, 50, 200, 54, 56, 302, 306, 56, 284, 72, 500, 500, 500, 70, 500, 52, 500, 154, 500, 194, 220, 500, 132, 74, 500, 258, 290, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40408447005698184, "mean_inference_ms": 1.2927214243333034, "mean_action_processing_ms": 0.14952724910465037, "mean_env_wait_ms": 0.08872514824308447, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01900196075439453, "StateBufferConnector_ms": 0.007002115249633789, "ViewRequirementAgentConnector_ms": 0.15200471878051758}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.9309999999997991, "episode_len_mean": 286.28, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 42.900000000000006, 43.900000000000006, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, 38.10000000000002, 20.299999999999848, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.900000000000013, 31.70000000000001, 28.699999999999967, 41.70000000000002, 23.29999999999989, -50.00000000000044, -50.00000000000044, 27.899999999999956, 39.70000000000002, 40.500000000000014, -50.00000000000044, -50.00000000000044, 46.099999999999994, 44.300000000000004, 2.699999999999598, 37.300000000000026, 6.099999999999646, 37.50000000000003, 41.70000000000002, 42.500000000000014, -50.00000000000044, 40.70000000000002, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 32.100000000000016, 44.900000000000006, 45.5, 45.5, -50.00000000000044, 35.900000000000034, 40.70000000000002, -50.00000000000044, 46.3, 46.9, -50.00000000000044, 44.7, 45.1, 45.1, -50.00000000000044, 5.299999999999635, 43.30000000000001, -50.00000000000044, 18.29999999999982, 45.1, 30.099999999999987, 44.7, 44.5, 19.899999999999842, 19.499999999999837, 44.5, 21.699999999999868, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 44.900000000000006, -50.00000000000044, 34.70000000000004, -50.00000000000044, 30.699999999999996, 28.09999999999996, -50.00000000000044, 36.900000000000034, 42.70000000000001, -50.00000000000044, 24.299999999999905, 21.09999999999986, -50.00000000000044], "episode_lengths": [500, 500, 58, 500, 72, 62, 28, 500, 500, 500, 500, 500, 28, 500, 500, 120, 298, 500, 500, 28, 500, 500, 500, 182, 184, 214, 84, 268, 500, 500, 222, 104, 96, 500, 500, 40, 58, 474, 128, 440, 126, 84, 76, 500, 94, 500, 64, 500, 500, 500, 500, 54, 500, 500, 180, 52, 46, 46, 500, 142, 94, 500, 38, 32, 500, 54, 50, 50, 500, 448, 68, 500, 318, 50, 200, 54, 56, 302, 306, 56, 284, 72, 500, 500, 500, 70, 500, 52, 500, 154, 500, 194, 220, 500, 132, 74, 500, 258, 290, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40408447005698184, "mean_inference_ms": 1.2927214243333034, "mean_action_processing_ms": 0.14952724910465037, "mean_env_wait_ms": 0.08872514824308447, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01900196075439453, "StateBufferConnector_ms": 0.007002115249633789, "ViewRequirementAgentConnector_ms": 0.15200471878051758}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5194.863765984675, "num_env_steps_trained_throughput_per_sec": 5194.863765984675, "timesteps_total": 252000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 252000, "timers": {"training_iteration_time_ms": 2203.526, "sample_time_ms": 1960.858, "load_time_ms": 9.997, "load_throughput": 1200381.782, "learn_time_ms": 220.888, "learn_throughput": 54326.129, "synch_weights_time_ms": 9.781}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "done": false, "episodes_total": 916, "training_iteration": 21, "trial_id": "9f288_00019", "date": "2023-10-25_17-07-22", "timestamp": 1698250042, "time_this_iter_s": 2.317972183227539, "time_total_s": 48.54105806350708, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 48.54105806350708, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 65.60000000000001, "ram_util_percent": 27.333333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.536743164062503e-08, "cur_lr": 0.0003, "total_loss": 6.6986210187276205, "policy_loss": -0.0003054144481817881, "vf_loss": 6.698981348673502, "vf_explained_var": -1.049041748046875e-06, "kl": 0.0005585150526485449, "entropy": 0.549573814868927, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 323.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.255999999999831, "episode_len_mean": 258.1, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.70000000000002, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 32.100000000000016, 44.900000000000006, 45.5, 45.5, -50.00000000000044, 35.900000000000034, 40.70000000000002, -50.00000000000044, 46.3, 46.9, -50.00000000000044, 44.7, 45.1, 45.1, -50.00000000000044, 5.299999999999635, 43.30000000000001, -50.00000000000044, 18.29999999999982, 45.1, 30.099999999999987, 44.7, 44.5, 19.899999999999842, 19.499999999999837, 44.5, 21.699999999999868, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 44.900000000000006, -50.00000000000044, 34.70000000000004, -50.00000000000044, 30.699999999999996, 28.09999999999996, -50.00000000000044, 36.900000000000034, 42.70000000000001, -50.00000000000044, 24.299999999999905, 21.09999999999986, -50.00000000000044, 45.9, 40.500000000000014, 44.7, 42.900000000000006, 43.10000000000001, 39.90000000000002, 46.3, 31.70000000000001, -50.00000000000044, 43.7, 41.90000000000001, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 42.900000000000006, -50.00000000000044, 20.899999999999856, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, 44.900000000000006, -50.00000000000044, 37.300000000000026, -50.00000000000044, 47.5, 42.500000000000014, 10.499999999999709, -50.00000000000044, 22.299999999999876, 29.299999999999976, 34.10000000000004, 34.50000000000004, 29.69999999999998, 36.10000000000004, 42.500000000000014, -50.00000000000044, -50.00000000000044, 44.900000000000006, 21.499999999999865, 39.10000000000002, 43.10000000000001, 6.699999999999655], "episode_lengths": [94, 500, 64, 500, 500, 500, 500, 54, 500, 500, 180, 52, 46, 46, 500, 142, 94, 500, 38, 32, 500, 54, 50, 50, 500, 448, 68, 500, 318, 50, 200, 54, 56, 302, 306, 56, 284, 72, 500, 500, 500, 70, 500, 52, 500, 154, 500, 194, 220, 500, 132, 74, 500, 258, 290, 500, 42, 96, 54, 72, 70, 102, 38, 184, 500, 64, 82, 500, 500, 40, 500, 72, 500, 292, 500, 500, 500, 96, 52, 500, 128, 500, 26, 76, 396, 500, 278, 208, 160, 156, 204, 140, 76, 500, 500, 52, 286, 110, 70, 434]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4034255258971489, "mean_inference_ms": 1.2910864431213755, "mean_action_processing_ms": 0.14977294257836132, "mean_env_wait_ms": 0.08860040993683983, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031000852584838867, "StateBufferConnector_ms": 0.007999897003173828, "ViewRequirementAgentConnector_ms": 0.13000273704528809}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.255999999999831, "episode_len_mean": 258.1, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [40.70000000000002, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 32.100000000000016, 44.900000000000006, 45.5, 45.5, -50.00000000000044, 35.900000000000034, 40.70000000000002, -50.00000000000044, 46.3, 46.9, -50.00000000000044, 44.7, 45.1, 45.1, -50.00000000000044, 5.299999999999635, 43.30000000000001, -50.00000000000044, 18.29999999999982, 45.1, 30.099999999999987, 44.7, 44.5, 19.899999999999842, 19.499999999999837, 44.5, 21.699999999999868, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 44.900000000000006, -50.00000000000044, 34.70000000000004, -50.00000000000044, 30.699999999999996, 28.09999999999996, -50.00000000000044, 36.900000000000034, 42.70000000000001, -50.00000000000044, 24.299999999999905, 21.09999999999986, -50.00000000000044, 45.9, 40.500000000000014, 44.7, 42.900000000000006, 43.10000000000001, 39.90000000000002, 46.3, 31.70000000000001, -50.00000000000044, 43.7, 41.90000000000001, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 42.900000000000006, -50.00000000000044, 20.899999999999856, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, 44.900000000000006, -50.00000000000044, 37.300000000000026, -50.00000000000044, 47.5, 42.500000000000014, 10.499999999999709, -50.00000000000044, 22.299999999999876, 29.299999999999976, 34.10000000000004, 34.50000000000004, 29.69999999999998, 36.10000000000004, 42.500000000000014, -50.00000000000044, -50.00000000000044, 44.900000000000006, 21.499999999999865, 39.10000000000002, 43.10000000000001, 6.699999999999655], "episode_lengths": [94, 500, 64, 500, 500, 500, 500, 54, 500, 500, 180, 52, 46, 46, 500, 142, 94, 500, 38, 32, 500, 54, 50, 50, 500, 448, 68, 500, 318, 50, 200, 54, 56, 302, 306, 56, 284, 72, 500, 500, 500, 70, 500, 52, 500, 154, 500, 194, 220, 500, 132, 74, 500, 258, 290, 500, 42, 96, 54, 72, 70, 102, 38, 184, 500, 64, 82, 500, 500, 40, 500, 72, 500, 292, 500, 500, 500, 96, 52, 500, 128, 500, 26, 76, 396, 500, 278, 208, 160, 156, 204, 140, 76, 500, 500, 52, 286, 110, 70, 434]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4034255258971489, "mean_inference_ms": 1.2910864431213755, "mean_action_processing_ms": 0.14977294257836132, "mean_env_wait_ms": 0.08860040993683983, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031000852584838867, "StateBufferConnector_ms": 0.007999897003173828, "ViewRequirementAgentConnector_ms": 0.13000273704528809}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5442.68081263171, "num_env_steps_trained_throughput_per_sec": 5442.68081263171, "timesteps_total": 264000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 264000, "timers": {"training_iteration_time_ms": 2209.889, "sample_time_ms": 1953.561, "load_time_ms": 10.297, "load_throughput": 1165391.978, "learn_time_ms": 233.94, "learn_throughput": 51295.234, "synch_weights_time_ms": 9.989}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "done": false, "episodes_total": 960, "training_iteration": 22, "trial_id": "9f288_00019", "date": "2023-10-25_17-07-24", "timestamp": 1698250044, "time_this_iter_s": 2.2102041244506836, "time_total_s": 50.751262187957764, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 50.751262187957764, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 60.46666666666666, "ram_util_percent": 27.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.7683715820312516e-08, "cur_lr": 0.0003, "total_loss": 7.125813166300456, "policy_loss": 1.1281482875347137e-05, "vf_loss": 7.125852139790853, "vf_explained_var": -7.947285970052084e-07, "kl": 6.534495708289493e-05, "entropy": 0.5028982778390249, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 338.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.53699999999983, "episode_len_mean": 260.28, "episode_media": {}, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 36.900000000000034, 42.70000000000001, -50.00000000000044, 24.299999999999905, 21.09999999999986, -50.00000000000044, 45.9, 40.500000000000014, 44.7, 42.900000000000006, 43.10000000000001, 39.90000000000002, 46.3, 31.70000000000001, -50.00000000000044, 43.7, 41.90000000000001, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 42.900000000000006, -50.00000000000044, 20.899999999999856, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, 44.900000000000006, -50.00000000000044, 37.300000000000026, -50.00000000000044, 47.5, 42.500000000000014, 10.499999999999709, -50.00000000000044, 22.299999999999876, 29.299999999999976, 34.10000000000004, 34.50000000000004, 29.69999999999998, 36.10000000000004, 42.500000000000014, -50.00000000000044, -50.00000000000044, 44.900000000000006, 21.499999999999865, 39.10000000000002, 43.10000000000001, 6.699999999999655, -50.00000000000044, 25.499999999999922, 40.90000000000002, -50.00000000000044, -50.00000000000044, 40.500000000000014, 34.30000000000004, -50.00000000000044, 41.100000000000016, 44.7, -50.00000000000044, 41.100000000000016, 38.300000000000026, 35.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 47.1, 20.099999999999845, -50.00000000000044, 40.10000000000002, -50.00000000000044, 40.500000000000014, 15.699999999999783, -50.00000000000044, 36.50000000000003, 46.099999999999994, -50.00000000000044, 43.30000000000001, 41.500000000000014, -50.00000000000044, 46.099999999999994, 44.7, 0.8999999999995723, 43.30000000000001, 44.10000000000001, -50.00000000000044, 45.1, 28.09999999999996, 44.5, 36.900000000000034], "episode_lengths": [500, 132, 74, 500, 258, 290, 500, 42, 96, 54, 72, 70, 102, 38, 184, 500, 64, 82, 500, 500, 40, 500, 72, 500, 292, 500, 500, 500, 96, 52, 500, 128, 500, 26, 76, 396, 500, 278, 208, 160, 156, 204, 140, 76, 500, 500, 52, 286, 110, 70, 434, 500, 246, 92, 500, 500, 96, 158, 500, 90, 54, 500, 90, 118, 150, 500, 500, 500, 500, 34, 72, 500, 500, 500, 46, 500, 30, 300, 500, 100, 500, 96, 344, 500, 136, 40, 500, 68, 86, 500, 40, 54, 492, 68, 60, 500, 50, 220, 56, 132]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40428373566240855, "mean_inference_ms": 1.2908128407723622, "mean_action_processing_ms": 0.14929857677597386, "mean_env_wait_ms": 0.08857233001212003, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03500080108642578, "StateBufferConnector_ms": 0.009992837905883789, "ViewRequirementAgentConnector_ms": 0.14453792572021484}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.53699999999983, "episode_len_mean": 260.28, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 36.900000000000034, 42.70000000000001, -50.00000000000044, 24.299999999999905, 21.09999999999986, -50.00000000000044, 45.9, 40.500000000000014, 44.7, 42.900000000000006, 43.10000000000001, 39.90000000000002, 46.3, 31.70000000000001, -50.00000000000044, 43.7, 41.90000000000001, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 42.900000000000006, -50.00000000000044, 20.899999999999856, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, 44.900000000000006, -50.00000000000044, 37.300000000000026, -50.00000000000044, 47.5, 42.500000000000014, 10.499999999999709, -50.00000000000044, 22.299999999999876, 29.299999999999976, 34.10000000000004, 34.50000000000004, 29.69999999999998, 36.10000000000004, 42.500000000000014, -50.00000000000044, -50.00000000000044, 44.900000000000006, 21.499999999999865, 39.10000000000002, 43.10000000000001, 6.699999999999655, -50.00000000000044, 25.499999999999922, 40.90000000000002, -50.00000000000044, -50.00000000000044, 40.500000000000014, 34.30000000000004, -50.00000000000044, 41.100000000000016, 44.7, -50.00000000000044, 41.100000000000016, 38.300000000000026, 35.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 47.1, 20.099999999999845, -50.00000000000044, 40.10000000000002, -50.00000000000044, 40.500000000000014, 15.699999999999783, -50.00000000000044, 36.50000000000003, 46.099999999999994, -50.00000000000044, 43.30000000000001, 41.500000000000014, -50.00000000000044, 46.099999999999994, 44.7, 0.8999999999995723, 43.30000000000001, 44.10000000000001, -50.00000000000044, 45.1, 28.09999999999996, 44.5, 36.900000000000034], "episode_lengths": [500, 132, 74, 500, 258, 290, 500, 42, 96, 54, 72, 70, 102, 38, 184, 500, 64, 82, 500, 500, 40, 500, 72, 500, 292, 500, 500, 500, 96, 52, 500, 128, 500, 26, 76, 396, 500, 278, 208, 160, 156, 204, 140, 76, 500, 500, 52, 286, 110, 70, 434, 500, 246, 92, 500, 500, 96, 158, 500, 90, 54, 500, 90, 118, 150, 500, 500, 500, 500, 34, 72, 500, 500, 500, 46, 500, 30, 300, 500, 100, 500, 96, 344, 500, 136, 40, 500, 68, 86, 500, 40, 54, 492, 68, 60, 500, 50, 220, 56, 132]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40428373566240855, "mean_inference_ms": 1.2908128407723622, "mean_action_processing_ms": 0.14929857677597386, "mean_env_wait_ms": 0.08857233001212003, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03500080108642578, "StateBufferConnector_ms": 0.009992837905883789, "ViewRequirementAgentConnector_ms": 0.14453792572021484}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4790.019574388386, "num_env_steps_trained_throughput_per_sec": 4790.019574388386, "timesteps_total": 276000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 276000, "timers": {"training_iteration_time_ms": 2240.321, "sample_time_ms": 1970.151, "load_time_ms": 11.296, "load_throughput": 1062277.162, "learn_time_ms": 246.767, "learn_throughput": 48628.959, "synch_weights_time_ms": 10.113}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000}, "done": false, "episodes_total": 1009, "training_iteration": 23, "trial_id": "9f288_00019", "date": "2023-10-25_17-07-26", "timestamp": 1698250046, "time_this_iter_s": 2.5102078914642334, "time_total_s": 53.261470079422, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 53.261470079422, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 63.975, "ram_util_percent": 27.475}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.3841857910156258e-08, "cur_lr": 0.0003, "total_loss": 6.345875072479248, "policy_loss": -0.0002007340391476949, "vf_loss": 6.346128908793132, "vf_explained_var": -8.662541707356771e-07, "kl": 0.00028229018239045445, "entropy": 0.5321096897125244, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 353.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.771999999999837, "episode_len_mean": 252.94, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.900000000000006, 21.499999999999865, 39.10000000000002, 43.10000000000001, 6.699999999999655, -50.00000000000044, 25.499999999999922, 40.90000000000002, -50.00000000000044, -50.00000000000044, 40.500000000000014, 34.30000000000004, -50.00000000000044, 41.100000000000016, 44.7, -50.00000000000044, 41.100000000000016, 38.300000000000026, 35.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 47.1, 20.099999999999845, -50.00000000000044, 40.10000000000002, -50.00000000000044, 40.500000000000014, 15.699999999999783, -50.00000000000044, 36.50000000000003, 46.099999999999994, -50.00000000000044, 43.30000000000001, 41.500000000000014, -50.00000000000044, 46.099999999999994, 44.7, 0.8999999999995723, 43.30000000000001, 44.10000000000001, -50.00000000000044, 45.1, 28.09999999999996, 44.5, 36.900000000000034, 43.30000000000001, 28.699999999999967, -50.00000000000044, 40.90000000000002, 30.9, 24.69999999999991, 44.900000000000006, 29.099999999999973, -50.00000000000044, 42.10000000000001, 42.500000000000014, 42.10000000000001, 42.900000000000006, -50.00000000000044, 40.90000000000002, 46.3, 43.50000000000001, 32.700000000000024, 42.500000000000014, 44.300000000000004, 47.3, 36.50000000000003, -50.00000000000044, 41.90000000000001, -50.00000000000044, 32.30000000000002, 31.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 46.5, 34.50000000000004, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 42.70000000000001, 4.299999999999621, 44.5, 29.099999999999973, 39.90000000000002, -50.00000000000044], "episode_lengths": [500, 52, 286, 110, 70, 434, 500, 246, 92, 500, 500, 96, 158, 500, 90, 54, 500, 90, 118, 150, 500, 500, 500, 500, 34, 72, 500, 500, 500, 46, 500, 30, 300, 500, 100, 500, 96, 344, 500, 136, 40, 500, 68, 86, 500, 40, 54, 492, 68, 60, 500, 50, 220, 56, 132, 68, 214, 500, 92, 192, 254, 52, 210, 500, 80, 76, 80, 72, 500, 92, 38, 66, 174, 76, 58, 28, 136, 500, 82, 500, 178, 190, 500, 500, 500, 500, 78, 500, 36, 156, 500, 500, 46, 500, 74, 458, 56, 210, 102, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40512694211954087, "mean_inference_ms": 1.2928867195828122, "mean_action_processing_ms": 0.14933034241901624, "mean_env_wait_ms": 0.08890308330461451, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02799677848815918, "StateBufferConnector_ms": 0.0069980621337890625, "ViewRequirementAgentConnector_ms": 0.14552044868469238}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.771999999999837, "episode_len_mean": 252.94, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.900000000000006, 21.499999999999865, 39.10000000000002, 43.10000000000001, 6.699999999999655, -50.00000000000044, 25.499999999999922, 40.90000000000002, -50.00000000000044, -50.00000000000044, 40.500000000000014, 34.30000000000004, -50.00000000000044, 41.100000000000016, 44.7, -50.00000000000044, 41.100000000000016, 38.300000000000026, 35.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 47.1, 20.099999999999845, -50.00000000000044, 40.10000000000002, -50.00000000000044, 40.500000000000014, 15.699999999999783, -50.00000000000044, 36.50000000000003, 46.099999999999994, -50.00000000000044, 43.30000000000001, 41.500000000000014, -50.00000000000044, 46.099999999999994, 44.7, 0.8999999999995723, 43.30000000000001, 44.10000000000001, -50.00000000000044, 45.1, 28.09999999999996, 44.5, 36.900000000000034, 43.30000000000001, 28.699999999999967, -50.00000000000044, 40.90000000000002, 30.9, 24.69999999999991, 44.900000000000006, 29.099999999999973, -50.00000000000044, 42.10000000000001, 42.500000000000014, 42.10000000000001, 42.900000000000006, -50.00000000000044, 40.90000000000002, 46.3, 43.50000000000001, 32.700000000000024, 42.500000000000014, 44.300000000000004, 47.3, 36.50000000000003, -50.00000000000044, 41.90000000000001, -50.00000000000044, 32.30000000000002, 31.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 46.5, 34.50000000000004, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 42.70000000000001, 4.299999999999621, 44.5, 29.099999999999973, 39.90000000000002, -50.00000000000044], "episode_lengths": [500, 52, 286, 110, 70, 434, 500, 246, 92, 500, 500, 96, 158, 500, 90, 54, 500, 90, 118, 150, 500, 500, 500, 500, 34, 72, 500, 500, 500, 46, 500, 30, 300, 500, 100, 500, 96, 344, 500, 136, 40, 500, 68, 86, 500, 40, 54, 492, 68, 60, 500, 50, 220, 56, 132, 68, 214, 500, 92, 192, 254, 52, 210, 500, 80, 76, 80, 72, 500, 92, 38, 66, 174, 76, 58, 28, 136, 500, 82, 500, 178, 190, 500, 500, 500, 500, 78, 500, 36, 156, 500, 500, 46, 500, 74, 458, 56, 210, 102, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40512694211954087, "mean_inference_ms": 1.2928867195828122, "mean_action_processing_ms": 0.14933034241901624, "mean_env_wait_ms": 0.08890308330461451, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02799677848815918, "StateBufferConnector_ms": 0.0069980621337890625, "ViewRequirementAgentConnector_ms": 0.14552044868469238}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4934.7234816809905, "num_env_steps_trained_throughput_per_sec": 4934.7234816809905, "timesteps_total": 288000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 2261.462, "sample_time_ms": 1982.091, "load_time_ms": 11.197, "load_throughput": 1071759.498, "learn_time_ms": 256.065, "learn_throughput": 46863.143, "synch_weights_time_ms": 10.017}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "episodes_total": 1054, "training_iteration": 24, "trial_id": "9f288_00019", "date": "2023-10-25_17-07-29", "timestamp": 1698250049, "time_this_iter_s": 2.4367451667785645, "time_total_s": 55.69821524620056, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 55.69821524620056, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 72.53333333333335, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1920928955078129e-08, "cur_lr": 0.0003, "total_loss": 6.547834682464599, "policy_loss": -0.00025175213813781737, "vf_loss": 6.548139508565267, "vf_explained_var": 1.2914339701334636e-06, "kl": 0.0005154573929303296, "entropy": 0.5303691883881887, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 368.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 14.14599999999987, "episode_len_mean": 219.26, "episode_media": {}, "episodes_this_iter": 58, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.90000000000002, 30.9, 24.69999999999991, 44.900000000000006, 29.099999999999973, -50.00000000000044, 42.10000000000001, 42.500000000000014, 42.10000000000001, 42.900000000000006, -50.00000000000044, 40.90000000000002, 46.3, 43.50000000000001, 32.700000000000024, 42.500000000000014, 44.300000000000004, 47.3, 36.50000000000003, -50.00000000000044, 41.90000000000001, -50.00000000000044, 32.30000000000002, 31.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 46.5, 34.50000000000004, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 42.70000000000001, 4.299999999999621, 44.5, 29.099999999999973, 39.90000000000002, -50.00000000000044, 20.899999999999856, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 46.5, 44.900000000000006, 25.899999999999928, 42.70000000000001, 33.10000000000003, 43.30000000000001, -50.00000000000044, -50.00000000000044, 9.8999999999997, -50.00000000000044, 41.90000000000001, 36.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.899999999999913, 35.500000000000036, 42.70000000000001, 43.50000000000001, -50.00000000000044, 19.69999999999984, 42.70000000000001, 45.3, 44.300000000000004, 42.30000000000001, 41.90000000000001, 43.900000000000006, 46.3, 46.5, 47.7, 42.500000000000014, 37.70000000000003, 42.70000000000001, -50.00000000000044, 39.300000000000026, 46.3, 42.30000000000001, -50.00000000000044, 42.70000000000001, 27.49999999999995, 41.90000000000001, 46.3, -50.00000000000044, 33.70000000000004, 46.699999999999996, 45.9, 41.70000000000002, 46.9, 33.30000000000003, 45.3, 44.7], "episode_lengths": [92, 192, 254, 52, 210, 500, 80, 76, 80, 72, 500, 92, 38, 66, 174, 76, 58, 28, 136, 500, 82, 500, 178, 190, 500, 500, 500, 500, 78, 500, 36, 156, 500, 500, 46, 500, 74, 458, 56, 210, 102, 500, 292, 500, 500, 46, 500, 500, 36, 52, 242, 74, 170, 68, 500, 500, 402, 500, 82, 134, 500, 500, 500, 500, 252, 146, 74, 66, 500, 304, 74, 48, 58, 78, 82, 62, 38, 36, 24, 76, 124, 74, 500, 108, 38, 78, 500, 74, 226, 82, 38, 500, 164, 34, 42, 84, 32, 168, 48, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40542037376498813, "mean_inference_ms": 1.2927272684409996, "mean_action_processing_ms": 0.14891094046399356, "mean_env_wait_ms": 0.08897996393168675, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0290067195892334, "StateBufferConnector_ms": 0.00400233268737793, "ViewRequirementAgentConnector_ms": 0.12195920944213867}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 14.14599999999987, "episode_len_mean": 219.26, "episodes_this_iter": 58, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [40.90000000000002, 30.9, 24.69999999999991, 44.900000000000006, 29.099999999999973, -50.00000000000044, 42.10000000000001, 42.500000000000014, 42.10000000000001, 42.900000000000006, -50.00000000000044, 40.90000000000002, 46.3, 43.50000000000001, 32.700000000000024, 42.500000000000014, 44.300000000000004, 47.3, 36.50000000000003, -50.00000000000044, 41.90000000000001, -50.00000000000044, 32.30000000000002, 31.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 46.5, 34.50000000000004, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 42.70000000000001, 4.299999999999621, 44.5, 29.099999999999973, 39.90000000000002, -50.00000000000044, 20.899999999999856, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 46.5, 44.900000000000006, 25.899999999999928, 42.70000000000001, 33.10000000000003, 43.30000000000001, -50.00000000000044, -50.00000000000044, 9.8999999999997, -50.00000000000044, 41.90000000000001, 36.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.899999999999913, 35.500000000000036, 42.70000000000001, 43.50000000000001, -50.00000000000044, 19.69999999999984, 42.70000000000001, 45.3, 44.300000000000004, 42.30000000000001, 41.90000000000001, 43.900000000000006, 46.3, 46.5, 47.7, 42.500000000000014, 37.70000000000003, 42.70000000000001, -50.00000000000044, 39.300000000000026, 46.3, 42.30000000000001, -50.00000000000044, 42.70000000000001, 27.49999999999995, 41.90000000000001, 46.3, -50.00000000000044, 33.70000000000004, 46.699999999999996, 45.9, 41.70000000000002, 46.9, 33.30000000000003, 45.3, 44.7], "episode_lengths": [92, 192, 254, 52, 210, 500, 80, 76, 80, 72, 500, 92, 38, 66, 174, 76, 58, 28, 136, 500, 82, 500, 178, 190, 500, 500, 500, 500, 78, 500, 36, 156, 500, 500, 46, 500, 74, 458, 56, 210, 102, 500, 292, 500, 500, 46, 500, 500, 36, 52, 242, 74, 170, 68, 500, 500, 402, 500, 82, 134, 500, 500, 500, 500, 252, 146, 74, 66, 500, 304, 74, 48, 58, 78, 82, 62, 38, 36, 24, 76, 124, 74, 500, 108, 38, 78, 500, 74, 226, 82, 38, 500, 164, 34, 42, 84, 32, 168, 48, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40542037376498813, "mean_inference_ms": 1.2927272684409996, "mean_action_processing_ms": 0.14891094046399356, "mean_env_wait_ms": 0.08897996393168675, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0290067195892334, "StateBufferConnector_ms": 0.00400233268737793, "ViewRequirementAgentConnector_ms": 0.12195920944213867}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5576.198422407408, "num_env_steps_trained_throughput_per_sec": 5576.198422407408, "timesteps_total": 300000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 300000, "timers": {"training_iteration_time_ms": 2272.38, "sample_time_ms": 1983.294, "load_time_ms": 11.497, "load_throughput": 1043787.624, "learn_time_ms": 265.676, "learn_throughput": 45167.754, "synch_weights_time_ms": 10.02}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "done": false, "episodes_total": 1112, "training_iteration": 25, "trial_id": "9f288_00019", "date": "2023-10-25_17-07-31", "timestamp": 1698250051, "time_this_iter_s": 2.156999349594116, "time_total_s": 57.85521459579468, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 57.85521459579468, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 56.93333333333334, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.9604644775390645e-09, "cur_lr": 0.0003, "total_loss": 6.136553700764974, "policy_loss": -0.00017247324188550314, "vf_loss": 6.136773745218913, "vf_explained_var": -1.33514404296875e-06, "kl": 0.00033445912692968703, "entropy": 0.4748639424641927, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 383.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.1439999999998225, "episode_len_mean": 259.18, "episode_media": {}, "episodes_this_iter": 34, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.5, -50.00000000000044, 42.70000000000001, 4.299999999999621, 44.5, 29.099999999999973, 39.90000000000002, -50.00000000000044, 20.899999999999856, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 46.5, 44.900000000000006, 25.899999999999928, 42.70000000000001, 33.10000000000003, 43.30000000000001, -50.00000000000044, -50.00000000000044, 9.8999999999997, -50.00000000000044, 41.90000000000001, 36.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.899999999999913, 35.500000000000036, 42.70000000000001, 43.50000000000001, -50.00000000000044, 19.69999999999984, 42.70000000000001, 45.3, 44.300000000000004, 42.30000000000001, 41.90000000000001, 43.900000000000006, 46.3, 46.5, 47.7, 42.500000000000014, 37.70000000000003, 42.70000000000001, -50.00000000000044, 39.300000000000026, 46.3, 42.30000000000001, -50.00000000000044, 42.70000000000001, 27.49999999999995, 41.90000000000001, 46.3, -50.00000000000044, 33.70000000000004, 46.699999999999996, 45.9, 41.70000000000002, 46.9, 33.30000000000003, 45.3, 44.7, -50.00000000000044, 33.30000000000003, -50.00000000000044, 44.300000000000004, -50.00000000000044, 45.1, 47.1, -50.00000000000044, 38.90000000000002, -50.00000000000044, 12.099999999999731, 37.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.70000000000004, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 44.5, 44.900000000000006, 27.899999999999956, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [46, 500, 74, 458, 56, 210, 102, 500, 292, 500, 500, 46, 500, 500, 36, 52, 242, 74, 170, 68, 500, 500, 402, 500, 82, 134, 500, 500, 500, 500, 252, 146, 74, 66, 500, 304, 74, 48, 58, 78, 82, 62, 38, 36, 24, 76, 124, 74, 500, 108, 38, 78, 500, 74, 226, 82, 38, 500, 164, 34, 42, 84, 32, 168, 48, 54, 500, 168, 500, 58, 500, 50, 30, 500, 112, 500, 380, 128, 500, 500, 500, 500, 500, 500, 500, 500, 500, 154, 500, 36, 500, 500, 56, 52, 222, 42, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40560597169447843, "mean_inference_ms": 1.2920987450281598, "mean_action_processing_ms": 0.1488114269957991, "mean_env_wait_ms": 0.08884414160807463, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029005765914916992, "StateBufferConnector_ms": 0.006001710891723633, "ViewRequirementAgentConnector_ms": 0.11796450614929199}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.1439999999998225, "episode_len_mean": 259.18, "episodes_this_iter": 34, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.5, -50.00000000000044, 42.70000000000001, 4.299999999999621, 44.5, 29.099999999999973, 39.90000000000002, -50.00000000000044, 20.899999999999856, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 46.5, 44.900000000000006, 25.899999999999928, 42.70000000000001, 33.10000000000003, 43.30000000000001, -50.00000000000044, -50.00000000000044, 9.8999999999997, -50.00000000000044, 41.90000000000001, 36.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.899999999999913, 35.500000000000036, 42.70000000000001, 43.50000000000001, -50.00000000000044, 19.69999999999984, 42.70000000000001, 45.3, 44.300000000000004, 42.30000000000001, 41.90000000000001, 43.900000000000006, 46.3, 46.5, 47.7, 42.500000000000014, 37.70000000000003, 42.70000000000001, -50.00000000000044, 39.300000000000026, 46.3, 42.30000000000001, -50.00000000000044, 42.70000000000001, 27.49999999999995, 41.90000000000001, 46.3, -50.00000000000044, 33.70000000000004, 46.699999999999996, 45.9, 41.70000000000002, 46.9, 33.30000000000003, 45.3, 44.7, -50.00000000000044, 33.30000000000003, -50.00000000000044, 44.300000000000004, -50.00000000000044, 45.1, 47.1, -50.00000000000044, 38.90000000000002, -50.00000000000044, 12.099999999999731, 37.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.70000000000004, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 44.5, 44.900000000000006, 27.899999999999956, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [46, 500, 74, 458, 56, 210, 102, 500, 292, 500, 500, 46, 500, 500, 36, 52, 242, 74, 170, 68, 500, 500, 402, 500, 82, 134, 500, 500, 500, 500, 252, 146, 74, 66, 500, 304, 74, 48, 58, 78, 82, 62, 38, 36, 24, 76, 124, 74, 500, 108, 38, 78, 500, 74, 226, 82, 38, 500, 164, 34, 42, 84, 32, 168, 48, 54, 500, 168, 500, 58, 500, 50, 30, 500, 112, 500, 380, 128, 500, 500, 500, 500, 500, 500, 500, 500, 500, 154, 500, 36, 500, 500, 56, 52, 222, 42, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40560597169447843, "mean_inference_ms": 1.2920987450281598, "mean_action_processing_ms": 0.1488114269957991, "mean_env_wait_ms": 0.08884414160807463, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029005765914916992, "StateBufferConnector_ms": 0.006001710891723633, "ViewRequirementAgentConnector_ms": 0.11796450614929199}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5035.665007676312, "num_env_steps_trained_throughput_per_sec": 5035.665007676312, "timesteps_total": 312000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 312000, "timers": {"training_iteration_time_ms": 2291.346, "sample_time_ms": 1998.554, "load_time_ms": 12.397, "load_throughput": 968013.109, "learn_time_ms": 268.147, "learn_throughput": 44751.626, "synch_weights_time_ms": 10.355}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "done": false, "episodes_total": 1146, "training_iteration": 26, "trial_id": "9f288_00019", "date": "2023-10-25_17-07-33", "timestamp": 1698250053, "time_this_iter_s": 2.388000011444092, "time_total_s": 60.24321460723877, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 60.24321460723877, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 59.5, "ram_util_percent": 27.625000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.9802322387695322e-09, "cur_lr": 0.0003, "total_loss": 6.5741013844807945, "policy_loss": -0.0002415568878253301, "vf_loss": 6.574393399556478, "vf_explained_var": -1.243750254313151e-06, "kl": 0.00023107943901171286, "entropy": 0.5045545796553293, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 398.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.789999999999809, "episode_len_mean": 272.68, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.70000000000001, -50.00000000000044, 39.300000000000026, 46.3, 42.30000000000001, -50.00000000000044, 42.70000000000001, 27.49999999999995, 41.90000000000001, 46.3, -50.00000000000044, 33.70000000000004, 46.699999999999996, 45.9, 41.70000000000002, 46.9, 33.30000000000003, 45.3, 44.7, -50.00000000000044, 33.30000000000003, -50.00000000000044, 44.300000000000004, -50.00000000000044, 45.1, 47.1, -50.00000000000044, 38.90000000000002, -50.00000000000044, 12.099999999999731, 37.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.70000000000004, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 44.5, 44.900000000000006, 27.899999999999956, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 39.50000000000002, 45.1, -50.00000000000044, 41.30000000000001, 23.29999999999989, 36.70000000000003, -50.00000000000044, 45.3, 29.299999999999976, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 40.70000000000002, 46.699999999999996, 34.10000000000004, 37.10000000000003, -50.00000000000044, -50.00000000000044, 45.1, 40.10000000000002, -50.00000000000044, -50.00000000000044, 43.10000000000001, 43.30000000000001, 38.90000000000002, -50.00000000000044, 39.90000000000002, -50.00000000000044, 20.699999999999854, 28.699999999999967, -50.00000000000044, 43.50000000000001, 45.7, -50.00000000000044, 38.50000000000003, 45.3, 3.2999999999996064, 43.30000000000001, -50.00000000000044, 41.70000000000002, 39.50000000000002, -50.00000000000044, -50.00000000000044], "episode_lengths": [74, 500, 108, 38, 78, 500, 74, 226, 82, 38, 500, 164, 34, 42, 84, 32, 168, 48, 54, 500, 168, 500, 58, 500, 50, 30, 500, 112, 500, 380, 128, 500, 500, 500, 500, 500, 500, 500, 500, 500, 154, 500, 36, 500, 500, 56, 52, 222, 42, 500, 500, 500, 500, 500, 500, 50, 106, 50, 500, 88, 268, 134, 500, 48, 208, 500, 500, 56, 500, 94, 34, 160, 130, 500, 500, 50, 100, 500, 500, 70, 68, 112, 500, 102, 500, 294, 214, 500, 66, 44, 500, 116, 48, 468, 68, 500, 84, 106, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40568286000759973, "mean_inference_ms": 1.290281557364114, "mean_action_processing_ms": 0.14889471174318902, "mean_env_wait_ms": 0.08887289286426465, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027003049850463867, "StateBufferConnector_ms": 0.007001161575317383, "ViewRequirementAgentConnector_ms": 0.12299537658691406}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.789999999999809, "episode_len_mean": 272.68, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.70000000000001, -50.00000000000044, 39.300000000000026, 46.3, 42.30000000000001, -50.00000000000044, 42.70000000000001, 27.49999999999995, 41.90000000000001, 46.3, -50.00000000000044, 33.70000000000004, 46.699999999999996, 45.9, 41.70000000000002, 46.9, 33.30000000000003, 45.3, 44.7, -50.00000000000044, 33.30000000000003, -50.00000000000044, 44.300000000000004, -50.00000000000044, 45.1, 47.1, -50.00000000000044, 38.90000000000002, -50.00000000000044, 12.099999999999731, 37.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.70000000000004, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 44.5, 44.900000000000006, 27.899999999999956, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 39.50000000000002, 45.1, -50.00000000000044, 41.30000000000001, 23.29999999999989, 36.70000000000003, -50.00000000000044, 45.3, 29.299999999999976, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 40.70000000000002, 46.699999999999996, 34.10000000000004, 37.10000000000003, -50.00000000000044, -50.00000000000044, 45.1, 40.10000000000002, -50.00000000000044, -50.00000000000044, 43.10000000000001, 43.30000000000001, 38.90000000000002, -50.00000000000044, 39.90000000000002, -50.00000000000044, 20.699999999999854, 28.699999999999967, -50.00000000000044, 43.50000000000001, 45.7, -50.00000000000044, 38.50000000000003, 45.3, 3.2999999999996064, 43.30000000000001, -50.00000000000044, 41.70000000000002, 39.50000000000002, -50.00000000000044, -50.00000000000044], "episode_lengths": [74, 500, 108, 38, 78, 500, 74, 226, 82, 38, 500, 164, 34, 42, 84, 32, 168, 48, 54, 500, 168, 500, 58, 500, 50, 30, 500, 112, 500, 380, 128, 500, 500, 500, 500, 500, 500, 500, 500, 500, 154, 500, 36, 500, 500, 56, 52, 222, 42, 500, 500, 500, 500, 500, 500, 50, 106, 50, 500, 88, 268, 134, 500, 48, 208, 500, 500, 56, 500, 94, 34, 160, 130, 500, 500, 50, 100, 500, 500, 70, 68, 112, 500, 102, 500, 294, 214, 500, 66, 44, 500, 116, 48, 468, 68, 500, 84, 106, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40568286000759973, "mean_inference_ms": 1.290281557364114, "mean_action_processing_ms": 0.14889471174318902, "mean_env_wait_ms": 0.08887289286426465, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027003049850463867, "StateBufferConnector_ms": 0.007001161575317383, "ViewRequirementAgentConnector_ms": 0.12299537658691406}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5632.51194757336, "num_env_steps_trained_throughput_per_sec": 5632.51194757336, "timesteps_total": 324000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 324000, "timers": {"training_iteration_time_ms": 2282.164, "sample_time_ms": 2000.366, "load_time_ms": 11.699, "load_throughput": 1025688.195, "learn_time_ms": 257.951, "learn_throughput": 46520.455, "synch_weights_time_ms": 10.455}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "done": false, "episodes_total": 1193, "training_iteration": 27, "trial_id": "9f288_00019", "date": "2023-10-25_17-07-36", "timestamp": 1698250056, "time_this_iter_s": 2.1364853382110596, "time_total_s": 62.37969994544983, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 62.37969994544983, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 61.099999999999994, "ram_util_percent": 27.633333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.4901161193847661e-09, "cur_lr": 0.0003, "total_loss": 6.184434000651041, "policy_loss": -0.00027649328112602236, "vf_loss": 6.184759108225505, "vf_explained_var": 3.695487976074219e-07, "kl": 0.00047365977075060074, "entropy": 0.4853845218817393, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 413.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.714999999999821, "episode_len_mean": 258.48, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.900000000000006, 27.899999999999956, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 39.50000000000002, 45.1, -50.00000000000044, 41.30000000000001, 23.29999999999989, 36.70000000000003, -50.00000000000044, 45.3, 29.299999999999976, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 40.70000000000002, 46.699999999999996, 34.10000000000004, 37.10000000000003, -50.00000000000044, -50.00000000000044, 45.1, 40.10000000000002, -50.00000000000044, -50.00000000000044, 43.10000000000001, 43.30000000000001, 38.90000000000002, -50.00000000000044, 39.90000000000002, -50.00000000000044, 20.699999999999854, 28.699999999999967, -50.00000000000044, 43.50000000000001, 45.7, -50.00000000000044, 38.50000000000003, 45.3, 3.2999999999996064, 43.30000000000001, -50.00000000000044, 41.70000000000002, 39.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 36.50000000000003, -50.00000000000044, -50.00000000000044, 43.7, 42.70000000000001, 46.3, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 46.9, 22.899999999999885, 36.900000000000034, 36.70000000000003, 13.899999999999757, 41.70000000000002, 45.9, 32.700000000000024, 46.9, 46.9, 42.500000000000014, 44.300000000000004, 7.499999999999666, 46.3, 45.7, -50.00000000000044, 27.299999999999947, 46.699999999999996, 47.1, 44.300000000000004, -50.00000000000044, 19.899999999999842, 14.09999999999976, 38.300000000000026, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 45.7], "episode_lengths": [52, 222, 42, 500, 500, 500, 500, 500, 500, 50, 106, 50, 500, 88, 268, 134, 500, 48, 208, 500, 500, 56, 500, 94, 34, 160, 130, 500, 500, 50, 100, 500, 500, 70, 68, 112, 500, 102, 500, 294, 214, 500, 66, 44, 500, 116, 48, 468, 68, 500, 84, 106, 500, 500, 500, 500, 500, 58, 136, 500, 500, 64, 74, 38, 42, 500, 500, 500, 36, 500, 32, 272, 132, 134, 362, 84, 42, 174, 32, 32, 76, 58, 426, 38, 44, 500, 228, 34, 30, 58, 500, 302, 360, 118, 500, 500, 36, 500, 500, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40489649543512835, "mean_inference_ms": 1.2859953690460182, "mean_action_processing_ms": 0.14898005222249366, "mean_env_wait_ms": 0.08889076991441006, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028998613357543945, "StateBufferConnector_ms": 0.004000186920166016, "ViewRequirementAgentConnector_ms": 0.13098907470703125}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.714999999999821, "episode_len_mean": 258.48, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.900000000000006, 27.899999999999956, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 39.50000000000002, 45.1, -50.00000000000044, 41.30000000000001, 23.29999999999989, 36.70000000000003, -50.00000000000044, 45.3, 29.299999999999976, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 40.70000000000002, 46.699999999999996, 34.10000000000004, 37.10000000000003, -50.00000000000044, -50.00000000000044, 45.1, 40.10000000000002, -50.00000000000044, -50.00000000000044, 43.10000000000001, 43.30000000000001, 38.90000000000002, -50.00000000000044, 39.90000000000002, -50.00000000000044, 20.699999999999854, 28.699999999999967, -50.00000000000044, 43.50000000000001, 45.7, -50.00000000000044, 38.50000000000003, 45.3, 3.2999999999996064, 43.30000000000001, -50.00000000000044, 41.70000000000002, 39.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 36.50000000000003, -50.00000000000044, -50.00000000000044, 43.7, 42.70000000000001, 46.3, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 46.9, 22.899999999999885, 36.900000000000034, 36.70000000000003, 13.899999999999757, 41.70000000000002, 45.9, 32.700000000000024, 46.9, 46.9, 42.500000000000014, 44.300000000000004, 7.499999999999666, 46.3, 45.7, -50.00000000000044, 27.299999999999947, 46.699999999999996, 47.1, 44.300000000000004, -50.00000000000044, 19.899999999999842, 14.09999999999976, 38.300000000000026, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 45.7], "episode_lengths": [52, 222, 42, 500, 500, 500, 500, 500, 500, 50, 106, 50, 500, 88, 268, 134, 500, 48, 208, 500, 500, 56, 500, 94, 34, 160, 130, 500, 500, 50, 100, 500, 500, 70, 68, 112, 500, 102, 500, 294, 214, 500, 66, 44, 500, 116, 48, 468, 68, 500, 84, 106, 500, 500, 500, 500, 500, 58, 136, 500, 500, 64, 74, 38, 42, 500, 500, 500, 36, 500, 32, 272, 132, 134, 362, 84, 42, 174, 32, 32, 76, 58, 426, 38, 44, 500, 228, 34, 30, 58, 500, 302, 360, 118, 500, 500, 36, 500, 500, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40489649543512835, "mean_inference_ms": 1.2859953690460182, "mean_action_processing_ms": 0.14898005222249366, "mean_env_wait_ms": 0.08889076991441006, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028998613357543945, "StateBufferConnector_ms": 0.004000186920166016, "ViewRequirementAgentConnector_ms": 0.13098907470703125}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5434.850819687532, "num_env_steps_trained_throughput_per_sec": 5434.850819687532, "timesteps_total": 336000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 336000, "timers": {"training_iteration_time_ms": 2281.729, "sample_time_ms": 1995.634, "load_time_ms": 12.2, "load_throughput": 983629.794, "learn_time_ms": 261.847, "learn_throughput": 45828.248, "synch_weights_time_ms": 10.355}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "done": false, "episodes_total": 1239, "training_iteration": 28, "trial_id": "9f288_00019", "date": "2023-10-25_17-07-38", "timestamp": 1698250058, "time_this_iter_s": 2.2129666805267334, "time_total_s": 64.59266662597656, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 64.59266662597656, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 59.63333333333333, "ram_util_percent": 27.633333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.450580596923831e-10, "cur_lr": 0.0003, "total_loss": 6.851667277018229, "policy_loss": 4.8548107345898944e-05, "vf_loss": 6.851670964558919, "vf_explained_var": -1.231829325358073e-07, "kl": 0.0001817056540782384, "entropy": 0.5226699233055114, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 428.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.391999999999809, "episode_len_mean": 266.7, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [38.50000000000003, 45.3, 3.2999999999996064, 43.30000000000001, -50.00000000000044, 41.70000000000002, 39.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 36.50000000000003, -50.00000000000044, -50.00000000000044, 43.7, 42.70000000000001, 46.3, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 46.9, 22.899999999999885, 36.900000000000034, 36.70000000000003, 13.899999999999757, 41.70000000000002, 45.9, 32.700000000000024, 46.9, 46.9, 42.500000000000014, 44.300000000000004, 7.499999999999666, 46.3, 45.7, -50.00000000000044, 27.299999999999947, 46.699999999999996, 47.1, 44.300000000000004, -50.00000000000044, 19.899999999999842, 14.09999999999976, 38.300000000000026, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 2.499999999999595, 33.10000000000003, 39.300000000000026, -50.00000000000044, 45.3, 42.10000000000001, 42.10000000000001, 44.5, -50.00000000000044, -50.00000000000044, 46.3, 32.100000000000016, -50.00000000000044, -50.00000000000044, 11.499999999999723, -50.00000000000044, 20.299999999999848, 42.70000000000001, 42.900000000000006, 22.899999999999885, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 46.699999999999996, 42.30000000000001, 46.3, 44.900000000000006, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 45.9, 19.499999999999837, -50.00000000000044, 42.900000000000006], "episode_lengths": [116, 48, 468, 68, 500, 84, 106, 500, 500, 500, 500, 500, 58, 136, 500, 500, 64, 74, 38, 42, 500, 500, 500, 36, 500, 32, 272, 132, 134, 362, 84, 42, 174, 32, 32, 76, 58, 426, 38, 44, 500, 228, 34, 30, 58, 500, 302, 360, 118, 500, 500, 36, 500, 500, 44, 500, 500, 476, 170, 108, 500, 48, 80, 80, 56, 500, 500, 38, 180, 500, 500, 386, 500, 298, 74, 72, 272, 500, 500, 500, 76, 500, 500, 500, 500, 50, 34, 78, 38, 52, 500, 42, 500, 500, 56, 500, 42, 306, 500, 72]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4039077989455433, "mean_inference_ms": 1.282730678756782, "mean_action_processing_ms": 0.14844117671507648, "mean_env_wait_ms": 0.08880025587334844, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023003101348876953, "StateBufferConnector_ms": 0.0040051937103271484, "ViewRequirementAgentConnector_ms": 0.12796330451965332}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.391999999999809, "episode_len_mean": 266.7, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [38.50000000000003, 45.3, 3.2999999999996064, 43.30000000000001, -50.00000000000044, 41.70000000000002, 39.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 36.50000000000003, -50.00000000000044, -50.00000000000044, 43.7, 42.70000000000001, 46.3, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 46.9, 22.899999999999885, 36.900000000000034, 36.70000000000003, 13.899999999999757, 41.70000000000002, 45.9, 32.700000000000024, 46.9, 46.9, 42.500000000000014, 44.300000000000004, 7.499999999999666, 46.3, 45.7, -50.00000000000044, 27.299999999999947, 46.699999999999996, 47.1, 44.300000000000004, -50.00000000000044, 19.899999999999842, 14.09999999999976, 38.300000000000026, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 2.499999999999595, 33.10000000000003, 39.300000000000026, -50.00000000000044, 45.3, 42.10000000000001, 42.10000000000001, 44.5, -50.00000000000044, -50.00000000000044, 46.3, 32.100000000000016, -50.00000000000044, -50.00000000000044, 11.499999999999723, -50.00000000000044, 20.299999999999848, 42.70000000000001, 42.900000000000006, 22.899999999999885, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 46.699999999999996, 42.30000000000001, 46.3, 44.900000000000006, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 45.9, 19.499999999999837, -50.00000000000044, 42.900000000000006], "episode_lengths": [116, 48, 468, 68, 500, 84, 106, 500, 500, 500, 500, 500, 58, 136, 500, 500, 64, 74, 38, 42, 500, 500, 500, 36, 500, 32, 272, 132, 134, 362, 84, 42, 174, 32, 32, 76, 58, 426, 38, 44, 500, 228, 34, 30, 58, 500, 302, 360, 118, 500, 500, 36, 500, 500, 44, 500, 500, 476, 170, 108, 500, 48, 80, 80, 56, 500, 500, 38, 180, 500, 500, 386, 500, 298, 74, 72, 272, 500, 500, 500, 76, 500, 500, 500, 500, 50, 34, 78, 38, 52, 500, 42, 500, 500, 56, 500, 42, 306, 500, 72]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4039077989455433, "mean_inference_ms": 1.282730678756782, "mean_action_processing_ms": 0.14844117671507648, "mean_env_wait_ms": 0.08880025587334844, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023003101348876953, "StateBufferConnector_ms": 0.0040051937103271484, "ViewRequirementAgentConnector_ms": 0.12796330451965332}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5712.209405259646, "num_env_steps_trained_throughput_per_sec": 5712.209405259646, "timesteps_total": 348000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 348000, "timers": {"training_iteration_time_ms": 2260.297, "sample_time_ms": 1986.994, "load_time_ms": 12.202, "load_throughput": 983449.13, "learn_time_ms": 248.725, "learn_throughput": 48246.016, "synch_weights_time_ms": 10.683}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000}, "done": false, "episodes_total": 1284, "training_iteration": 29, "trial_id": "9f288_00019", "date": "2023-10-25_17-07-40", "timestamp": 1698250060, "time_this_iter_s": 2.106759786605835, "time_total_s": 66.6994264125824, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 66.6994264125824, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 57.800000000000004, "ram_util_percent": 27.633333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.7252902984619153e-10, "cur_lr": 0.0003, "total_loss": 7.092080752054851, "policy_loss": -6.494348247845968e-05, "vf_loss": 7.092193508148194, "vf_explained_var": 1.4781951904296875e-06, "kl": 0.00015117592206479458, "entropy": 0.4800961911678314, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 443.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.054999999999804, "episode_len_mean": 275.04, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [38.300000000000026, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 2.499999999999595, 33.10000000000003, 39.300000000000026, -50.00000000000044, 45.3, 42.10000000000001, 42.10000000000001, 44.5, -50.00000000000044, -50.00000000000044, 46.3, 32.100000000000016, -50.00000000000044, -50.00000000000044, 11.499999999999723, -50.00000000000044, 20.299999999999848, 42.70000000000001, 42.900000000000006, 22.899999999999885, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 46.699999999999996, 42.30000000000001, 46.3, 44.900000000000006, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 45.9, 19.499999999999837, -50.00000000000044, 42.900000000000006, 26.89999999999994, 46.699999999999996, 41.500000000000014, 42.500000000000014, 25.499999999999922, 44.7, 42.70000000000001, -50.00000000000044, 40.30000000000002, 45.3, 17.69999999999981, 38.10000000000002, 42.500000000000014, -50.00000000000044, 40.90000000000002, 46.3, -50.00000000000044, -50.00000000000044, 32.30000000000002, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.70000000000003, 39.90000000000002, -50.00000000000044, 40.500000000000014, -50.00000000000044, 41.500000000000014, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, 45.7, 46.9, 24.099999999999902, 34.70000000000004, 35.70000000000003, -50.00000000000044, 47.3, 46.9, 42.900000000000006, -50.00000000000044, 5.099999999999632, -50.00000000000044, 43.50000000000001], "episode_lengths": [118, 500, 500, 36, 500, 500, 44, 500, 500, 476, 170, 108, 500, 48, 80, 80, 56, 500, 500, 38, 180, 500, 500, 386, 500, 298, 74, 72, 272, 500, 500, 500, 76, 500, 500, 500, 500, 50, 34, 78, 38, 52, 500, 42, 500, 500, 56, 500, 42, 306, 500, 72, 232, 34, 86, 76, 246, 54, 74, 500, 98, 48, 324, 120, 76, 500, 92, 38, 500, 500, 178, 42, 500, 500, 500, 500, 500, 134, 102, 500, 96, 500, 86, 500, 104, 500, 500, 44, 32, 260, 154, 144, 500, 28, 32, 72, 500, 450, 500, 66]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.403166533180447, "mean_inference_ms": 1.2804749859751825, "mean_action_processing_ms": 0.14800512545997163, "mean_env_wait_ms": 0.08854934574229674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020000457763671875, "StateBufferConnector_ms": 0.012006759643554688, "ViewRequirementAgentConnector_ms": 0.11698579788208008}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.054999999999804, "episode_len_mean": 275.04, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [38.300000000000026, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 2.499999999999595, 33.10000000000003, 39.300000000000026, -50.00000000000044, 45.3, 42.10000000000001, 42.10000000000001, 44.5, -50.00000000000044, -50.00000000000044, 46.3, 32.100000000000016, -50.00000000000044, -50.00000000000044, 11.499999999999723, -50.00000000000044, 20.299999999999848, 42.70000000000001, 42.900000000000006, 22.899999999999885, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 46.699999999999996, 42.30000000000001, 46.3, 44.900000000000006, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 45.9, 19.499999999999837, -50.00000000000044, 42.900000000000006, 26.89999999999994, 46.699999999999996, 41.500000000000014, 42.500000000000014, 25.499999999999922, 44.7, 42.70000000000001, -50.00000000000044, 40.30000000000002, 45.3, 17.69999999999981, 38.10000000000002, 42.500000000000014, -50.00000000000044, 40.90000000000002, 46.3, -50.00000000000044, -50.00000000000044, 32.30000000000002, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.70000000000003, 39.90000000000002, -50.00000000000044, 40.500000000000014, -50.00000000000044, 41.500000000000014, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, 45.7, 46.9, 24.099999999999902, 34.70000000000004, 35.70000000000003, -50.00000000000044, 47.3, 46.9, 42.900000000000006, -50.00000000000044, 5.099999999999632, -50.00000000000044, 43.50000000000001], "episode_lengths": [118, 500, 500, 36, 500, 500, 44, 500, 500, 476, 170, 108, 500, 48, 80, 80, 56, 500, 500, 38, 180, 500, 500, 386, 500, 298, 74, 72, 272, 500, 500, 500, 76, 500, 500, 500, 500, 50, 34, 78, 38, 52, 500, 42, 500, 500, 56, 500, 42, 306, 500, 72, 232, 34, 86, 76, 246, 54, 74, 500, 98, 48, 324, 120, 76, 500, 92, 38, 500, 500, 178, 42, 500, 500, 500, 500, 500, 134, 102, 500, 96, 500, 86, 500, 104, 500, 500, 44, 32, 260, 154, 144, 500, 28, 32, 72, 500, 450, 500, 66]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.403166533180447, "mean_inference_ms": 1.2804749859751825, "mean_action_processing_ms": 0.14800512545997163, "mean_env_wait_ms": 0.08854934574229674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020000457763671875, "StateBufferConnector_ms": 0.012006759643554688, "ViewRequirementAgentConnector_ms": 0.11698579788208008}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5344.388872737204, "num_env_steps_trained_throughput_per_sec": 5344.388872737204, "timesteps_total": 360000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 360000, "timers": {"training_iteration_time_ms": 2267.03, "sample_time_ms": 1981.499, "load_time_ms": 12.784, "load_throughput": 938681.786, "learn_time_ms": 260.44, "learn_throughput": 46075.835, "synch_weights_time_ms": 10.613}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "done": false, "episodes_total": 1332, "training_iteration": 30, "trial_id": "9f288_00019", "date": "2023-10-25_17-07-42", "timestamp": 1698250062, "time_this_iter_s": 2.2503390312194824, "time_total_s": 68.94976544380188, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 68.94976544380188, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 64.06666666666666, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.8626451492309577e-10, "cur_lr": 0.0003, "total_loss": 6.656366443634033, "policy_loss": 9.992631773153941e-05, "vf_loss": 6.656314881642659, "vf_explained_var": -1.1165936787923178e-06, "kl": 0.00010816726864391058, "entropy": 0.4834463159243266, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 458.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.4989999999998105, "episode_len_mean": 270.62, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.900000000000006, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 45.9, 19.499999999999837, -50.00000000000044, 42.900000000000006, 26.89999999999994, 46.699999999999996, 41.500000000000014, 42.500000000000014, 25.499999999999922, 44.7, 42.70000000000001, -50.00000000000044, 40.30000000000002, 45.3, 17.69999999999981, 38.10000000000002, 42.500000000000014, -50.00000000000044, 40.90000000000002, 46.3, -50.00000000000044, -50.00000000000044, 32.30000000000002, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.70000000000003, 39.90000000000002, -50.00000000000044, 40.500000000000014, -50.00000000000044, 41.500000000000014, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, 45.7, 46.9, 24.099999999999902, 34.70000000000004, 35.70000000000003, -50.00000000000044, 47.3, 46.9, 42.900000000000006, -50.00000000000044, 5.099999999999632, -50.00000000000044, 43.50000000000001, -50.00000000000044, 30.699999999999996, 41.30000000000001, 35.900000000000034, -50.00000000000044, 46.9, -50.00000000000044, 35.900000000000034, 7.699999999999669, 44.5, 0.09999999999956088, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 43.10000000000001, 44.900000000000006, -50.00000000000044, 28.09999999999996, -50.00000000000044, 16.699999999999797, 45.1, -50.00000000000044, 44.5, -50.00000000000044, 46.699999999999996, 9.699999999999697, -50.00000000000044, 43.30000000000001, 43.50000000000001, -50.00000000000044, 35.30000000000004, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 47.1, 43.10000000000001, 42.30000000000001], "episode_lengths": [52, 500, 42, 500, 500, 56, 500, 42, 306, 500, 72, 232, 34, 86, 76, 246, 54, 74, 500, 98, 48, 324, 120, 76, 500, 92, 38, 500, 500, 178, 42, 500, 500, 500, 500, 500, 134, 102, 500, 96, 500, 86, 500, 104, 500, 500, 44, 32, 260, 154, 144, 500, 28, 32, 72, 500, 450, 500, 66, 500, 194, 88, 142, 500, 32, 500, 142, 424, 56, 500, 500, 500, 30, 500, 500, 70, 52, 500, 220, 500, 334, 50, 500, 56, 500, 34, 404, 500, 68, 66, 500, 148, 500, 500, 82, 500, 500, 30, 70, 78]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4023697220138648, "mean_inference_ms": 1.2781659116713797, "mean_action_processing_ms": 0.147918113152069, "mean_env_wait_ms": 0.08849530740229238, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025996923446655273, "StateBufferConnector_ms": 0.013439416885375977, "ViewRequirementAgentConnector_ms": 0.11897015571594238}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.4989999999998105, "episode_len_mean": 270.62, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.900000000000006, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 45.9, 19.499999999999837, -50.00000000000044, 42.900000000000006, 26.89999999999994, 46.699999999999996, 41.500000000000014, 42.500000000000014, 25.499999999999922, 44.7, 42.70000000000001, -50.00000000000044, 40.30000000000002, 45.3, 17.69999999999981, 38.10000000000002, 42.500000000000014, -50.00000000000044, 40.90000000000002, 46.3, -50.00000000000044, -50.00000000000044, 32.30000000000002, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.70000000000003, 39.90000000000002, -50.00000000000044, 40.500000000000014, -50.00000000000044, 41.500000000000014, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, 45.7, 46.9, 24.099999999999902, 34.70000000000004, 35.70000000000003, -50.00000000000044, 47.3, 46.9, 42.900000000000006, -50.00000000000044, 5.099999999999632, -50.00000000000044, 43.50000000000001, -50.00000000000044, 30.699999999999996, 41.30000000000001, 35.900000000000034, -50.00000000000044, 46.9, -50.00000000000044, 35.900000000000034, 7.699999999999669, 44.5, 0.09999999999956088, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 43.10000000000001, 44.900000000000006, -50.00000000000044, 28.09999999999996, -50.00000000000044, 16.699999999999797, 45.1, -50.00000000000044, 44.5, -50.00000000000044, 46.699999999999996, 9.699999999999697, -50.00000000000044, 43.30000000000001, 43.50000000000001, -50.00000000000044, 35.30000000000004, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 47.1, 43.10000000000001, 42.30000000000001], "episode_lengths": [52, 500, 42, 500, 500, 56, 500, 42, 306, 500, 72, 232, 34, 86, 76, 246, 54, 74, 500, 98, 48, 324, 120, 76, 500, 92, 38, 500, 500, 178, 42, 500, 500, 500, 500, 500, 134, 102, 500, 96, 500, 86, 500, 104, 500, 500, 44, 32, 260, 154, 144, 500, 28, 32, 72, 500, 450, 500, 66, 500, 194, 88, 142, 500, 32, 500, 142, 424, 56, 500, 500, 500, 30, 500, 500, 70, 52, 500, 220, 500, 334, 50, 500, 56, 500, 34, 404, 500, 68, 66, 500, 148, 500, 500, 82, 500, 500, 30, 70, 78]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4023697220138648, "mean_inference_ms": 1.2781659116713797, "mean_action_processing_ms": 0.147918113152069, "mean_env_wait_ms": 0.08849530740229238, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025996923446655273, "StateBufferConnector_ms": 0.013439416885375977, "ViewRequirementAgentConnector_ms": 0.11897015571594238}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5914.184966100597, "num_env_steps_trained_throughput_per_sec": 5914.184966100597, "timesteps_total": 372000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 372000, "timers": {"training_iteration_time_ms": 2238.934, "sample_time_ms": 1969.202, "load_time_ms": 12.784, "load_throughput": 938657.277, "learn_time_ms": 244.999, "learn_throughput": 48979.701, "synch_weights_time_ms": 10.255}, "counters": {"num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000}, "done": false, "episodes_total": 1373, "training_iteration": 31, "trial_id": "9f288_00019", "date": "2023-10-25_17-07-44", "timestamp": 1698250064, "time_this_iter_s": 2.0338118076324463, "time_total_s": 70.98357725143433, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 70.98357725143433, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 60.03333333333333, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.313225746154788e-11, "cur_lr": 0.0003, "total_loss": 6.2677120526631676, "policy_loss": -0.00044298022985458376, "vf_loss": 6.268200206756592, "vf_explained_var": -8.940696716308594e-07, "kl": 0.0005655558209194093, "entropy": 0.45166242321332295, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 473.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.135999999999805, "episode_len_mean": 269.24, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.7, 46.9, 24.099999999999902, 34.70000000000004, 35.70000000000003, -50.00000000000044, 47.3, 46.9, 42.900000000000006, -50.00000000000044, 5.099999999999632, -50.00000000000044, 43.50000000000001, -50.00000000000044, 30.699999999999996, 41.30000000000001, 35.900000000000034, -50.00000000000044, 46.9, -50.00000000000044, 35.900000000000034, 7.699999999999669, 44.5, 0.09999999999956088, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 43.10000000000001, 44.900000000000006, -50.00000000000044, 28.09999999999996, -50.00000000000044, 16.699999999999797, 45.1, -50.00000000000044, 44.5, -50.00000000000044, 46.699999999999996, 9.699999999999697, -50.00000000000044, 43.30000000000001, 43.50000000000001, -50.00000000000044, 35.30000000000004, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 47.1, 43.10000000000001, 42.30000000000001, -50.00000000000044, 28.499999999999964, 39.300000000000026, -50.00000000000044, 45.5, 47.1, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 40.90000000000002, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 46.099999999999994, 45.9, 46.3, 44.7, 34.50000000000004, 43.900000000000006, 46.699999999999996, 35.70000000000003, 47.5, 46.5, 45.5, 46.9, -50.00000000000044, 9.499999999999694, -50.00000000000044, 46.099999999999994, -50.00000000000044, 30.499999999999993, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.499999999999964, 46.699999999999996], "episode_lengths": [500, 44, 32, 260, 154, 144, 500, 28, 32, 72, 500, 450, 500, 66, 500, 194, 88, 142, 500, 32, 500, 142, 424, 56, 500, 500, 500, 30, 500, 500, 70, 52, 500, 220, 500, 334, 50, 500, 56, 500, 34, 404, 500, 68, 66, 500, 148, 500, 500, 82, 500, 500, 30, 70, 78, 500, 216, 108, 500, 46, 30, 500, 42, 500, 500, 92, 46, 500, 500, 500, 500, 54, 500, 500, 40, 42, 38, 54, 156, 62, 34, 144, 26, 36, 46, 32, 500, 406, 500, 40, 500, 196, 36, 500, 500, 500, 500, 500, 216, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40198897464607547, "mean_inference_ms": 1.2757689002932984, "mean_action_processing_ms": 0.14749183291974455, "mean_env_wait_ms": 0.08862462635285465, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02599167823791504, "StateBufferConnector_ms": 0.0074350833892822266, "ViewRequirementAgentConnector_ms": 0.09698724746704102}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.135999999999805, "episode_len_mean": 269.24, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.7, 46.9, 24.099999999999902, 34.70000000000004, 35.70000000000003, -50.00000000000044, 47.3, 46.9, 42.900000000000006, -50.00000000000044, 5.099999999999632, -50.00000000000044, 43.50000000000001, -50.00000000000044, 30.699999999999996, 41.30000000000001, 35.900000000000034, -50.00000000000044, 46.9, -50.00000000000044, 35.900000000000034, 7.699999999999669, 44.5, 0.09999999999956088, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 43.10000000000001, 44.900000000000006, -50.00000000000044, 28.09999999999996, -50.00000000000044, 16.699999999999797, 45.1, -50.00000000000044, 44.5, -50.00000000000044, 46.699999999999996, 9.699999999999697, -50.00000000000044, 43.30000000000001, 43.50000000000001, -50.00000000000044, 35.30000000000004, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 47.1, 43.10000000000001, 42.30000000000001, -50.00000000000044, 28.499999999999964, 39.300000000000026, -50.00000000000044, 45.5, 47.1, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 40.90000000000002, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 46.099999999999994, 45.9, 46.3, 44.7, 34.50000000000004, 43.900000000000006, 46.699999999999996, 35.70000000000003, 47.5, 46.5, 45.5, 46.9, -50.00000000000044, 9.499999999999694, -50.00000000000044, 46.099999999999994, -50.00000000000044, 30.499999999999993, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.499999999999964, 46.699999999999996], "episode_lengths": [500, 44, 32, 260, 154, 144, 500, 28, 32, 72, 500, 450, 500, 66, 500, 194, 88, 142, 500, 32, 500, 142, 424, 56, 500, 500, 500, 30, 500, 500, 70, 52, 500, 220, 500, 334, 50, 500, 56, 500, 34, 404, 500, 68, 66, 500, 148, 500, 500, 82, 500, 500, 30, 70, 78, 500, 216, 108, 500, 46, 30, 500, 42, 500, 500, 92, 46, 500, 500, 500, 500, 54, 500, 500, 40, 42, 38, 54, 156, 62, 34, 144, 26, 36, 46, 32, 500, 406, 500, 40, 500, 196, 36, 500, 500, 500, 500, 500, 216, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40198897464607547, "mean_inference_ms": 1.2757689002932984, "mean_action_processing_ms": 0.14749183291974455, "mean_env_wait_ms": 0.08862462635285465, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02599167823791504, "StateBufferConnector_ms": 0.0074350833892822266, "ViewRequirementAgentConnector_ms": 0.09698724746704102}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5488.552767386436, "num_env_steps_trained_throughput_per_sec": 5488.552767386436, "timesteps_total": 384000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 384000, "timers": {"training_iteration_time_ms": 2237.092, "sample_time_ms": 1963.738, "load_time_ms": 13.084, "load_throughput": 917136.906, "learn_time_ms": 248.525, "learn_throughput": 48284.825, "synch_weights_time_ms": 10.151}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "done": false, "episodes_total": 1418, "training_iteration": 32, "trial_id": "9f288_00019", "date": "2023-10-25_17-07-46", "timestamp": 1698250066, "time_this_iter_s": 2.1913647651672363, "time_total_s": 73.17494201660156, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 73.17494201660156, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 59.86666666666667, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.656612873077394e-11, "cur_lr": 0.0003, "total_loss": 6.415356636047363, "policy_loss": -0.0002942378322283427, "vf_loss": 6.415694872538249, "vf_explained_var": -3.6557515462239586e-07, "kl": 0.0003112514156327961, "entropy": 0.4404468854268392, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 488.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.04600000000021005, "episode_len_mean": 281.02, "episode_media": {}, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.5, -50.00000000000044, 46.699999999999996, 9.699999999999697, -50.00000000000044, 43.30000000000001, 43.50000000000001, -50.00000000000044, 35.30000000000004, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 47.1, 43.10000000000001, 42.30000000000001, -50.00000000000044, 28.499999999999964, 39.300000000000026, -50.00000000000044, 45.5, 47.1, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 40.90000000000002, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 46.099999999999994, 45.9, 46.3, 44.7, 34.50000000000004, 43.900000000000006, 46.699999999999996, 35.70000000000003, 47.5, 46.5, 45.5, 46.9, -50.00000000000044, 9.499999999999694, -50.00000000000044, 46.099999999999994, -50.00000000000044, 30.499999999999993, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.499999999999964, 46.699999999999996, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 2.699999999999598, 9.499999999999694, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.300000000000026, 45.5, 41.30000000000001, -50.00000000000044, 45.3, 25.699999999999925, 35.30000000000004, 46.5, 42.900000000000006, 44.5, -50.00000000000044, -50.00000000000044, 39.300000000000026, 40.90000000000002, -50.00000000000044, 40.30000000000002, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 4.299999999999621, 42.900000000000006], "episode_lengths": [56, 500, 34, 404, 500, 68, 66, 500, 148, 500, 500, 82, 500, 500, 30, 70, 78, 500, 216, 108, 500, 46, 30, 500, 42, 500, 500, 92, 46, 500, 500, 500, 500, 54, 500, 500, 40, 42, 38, 54, 156, 62, 34, 144, 26, 36, 46, 32, 500, 406, 500, 40, 500, 196, 36, 500, 500, 500, 500, 500, 216, 34, 500, 500, 50, 500, 474, 406, 500, 30, 500, 500, 500, 500, 500, 500, 128, 46, 88, 500, 48, 244, 148, 36, 72, 56, 500, 500, 108, 92, 500, 98, 500, 72, 500, 500, 500, 68, 458, 72]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4011626844758749, "mean_inference_ms": 1.2736864957728782, "mean_action_processing_ms": 0.14736676722849304, "mean_env_wait_ms": 0.08865077364686881, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018996715545654297, "StateBufferConnector_ms": 0.007998466491699219, "ViewRequirementAgentConnector_ms": 0.09200239181518555}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.04600000000021005, "episode_len_mean": 281.02, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.5, -50.00000000000044, 46.699999999999996, 9.699999999999697, -50.00000000000044, 43.30000000000001, 43.50000000000001, -50.00000000000044, 35.30000000000004, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 47.1, 43.10000000000001, 42.30000000000001, -50.00000000000044, 28.499999999999964, 39.300000000000026, -50.00000000000044, 45.5, 47.1, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 40.90000000000002, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 46.099999999999994, 45.9, 46.3, 44.7, 34.50000000000004, 43.900000000000006, 46.699999999999996, 35.70000000000003, 47.5, 46.5, 45.5, 46.9, -50.00000000000044, 9.499999999999694, -50.00000000000044, 46.099999999999994, -50.00000000000044, 30.499999999999993, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.499999999999964, 46.699999999999996, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 2.699999999999598, 9.499999999999694, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.300000000000026, 45.5, 41.30000000000001, -50.00000000000044, 45.3, 25.699999999999925, 35.30000000000004, 46.5, 42.900000000000006, 44.5, -50.00000000000044, -50.00000000000044, 39.300000000000026, 40.90000000000002, -50.00000000000044, 40.30000000000002, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 4.299999999999621, 42.900000000000006], "episode_lengths": [56, 500, 34, 404, 500, 68, 66, 500, 148, 500, 500, 82, 500, 500, 30, 70, 78, 500, 216, 108, 500, 46, 30, 500, 42, 500, 500, 92, 46, 500, 500, 500, 500, 54, 500, 500, 40, 42, 38, 54, 156, 62, 34, 144, 26, 36, 46, 32, 500, 406, 500, 40, 500, 196, 36, 500, 500, 500, 500, 500, 216, 34, 500, 500, 50, 500, 474, 406, 500, 30, 500, 500, 500, 500, 500, 500, 128, 46, 88, 500, 48, 244, 148, 36, 72, 56, 500, 500, 108, 92, 500, 98, 500, 72, 500, 500, 500, 68, 458, 72]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4011626844758749, "mean_inference_ms": 1.2736864957728782, "mean_action_processing_ms": 0.14736676722849304, "mean_env_wait_ms": 0.08865077364686881, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018996715545654297, "StateBufferConnector_ms": 0.007998466491699219, "ViewRequirementAgentConnector_ms": 0.09200239181518555}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5260.182713513263, "num_env_steps_trained_throughput_per_sec": 5260.182713513263, "timesteps_total": 396000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 396000, "timers": {"training_iteration_time_ms": 2214.7, "sample_time_ms": 1940.006, "load_time_ms": 12.884, "load_throughput": 931365.582, "learn_time_ms": 250.319, "learn_throughput": 47938.806, "synch_weights_time_ms": 9.789}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "done": false, "episodes_total": 1456, "training_iteration": 33, "trial_id": "9f288_00019", "date": "2023-10-25_17-07-49", "timestamp": 1698250069, "time_this_iter_s": 2.2862911224365234, "time_total_s": 75.46123313903809, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 75.46123313903809, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 60.13333333333333, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.328306436538697e-11, "cur_lr": 0.0003, "total_loss": 6.0966389338175455, "policy_loss": -0.00040520625188946726, "vf_loss": 6.097091102600098, "vf_explained_var": 7.430712381998698e-07, "kl": 0.00080347025533077, "entropy": 0.46872745354970297, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 503.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.0729999999997952, "episode_len_mean": 274.84, "episode_media": {}, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.099999999999994, -50.00000000000044, 30.499999999999993, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.499999999999964, 46.699999999999996, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 2.699999999999598, 9.499999999999694, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.300000000000026, 45.5, 41.30000000000001, -50.00000000000044, 45.3, 25.699999999999925, 35.30000000000004, 46.5, 42.900000000000006, 44.5, -50.00000000000044, -50.00000000000044, 39.300000000000026, 40.90000000000002, -50.00000000000044, 40.30000000000002, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 4.299999999999621, 42.900000000000006, 28.09999999999996, 47.5, -50.00000000000044, 38.300000000000026, 43.7, 47.9, 46.5, 46.3, 47.1, 46.099999999999994, 42.900000000000006, 36.70000000000003, 31.70000000000001, -50.00000000000044, 44.10000000000001, -50.00000000000044, 43.50000000000001, 46.099999999999994, 41.100000000000016, 46.5, -50.00000000000044, -50.00000000000044, 46.099999999999994, 47.3, 37.10000000000003, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.10000000000002, -50.00000000000044, 44.900000000000006, 17.499999999999808, 15.49999999999978, -50.00000000000044, 46.699999999999996, -50.00000000000044, 43.7, 46.699999999999996, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 47.3, -50.00000000000044, -50.00000000000044, 43.7], "episode_lengths": [500, 40, 500, 196, 36, 500, 500, 500, 500, 500, 216, 34, 500, 500, 50, 500, 474, 406, 500, 30, 500, 500, 500, 500, 500, 500, 128, 46, 88, 500, 48, 244, 148, 36, 72, 56, 500, 500, 108, 92, 500, 98, 500, 72, 500, 500, 500, 68, 458, 72, 220, 26, 500, 118, 64, 22, 36, 38, 30, 40, 72, 134, 184, 500, 60, 500, 66, 40, 90, 36, 500, 500, 40, 28, 130, 50, 500, 500, 500, 120, 500, 52, 326, 346, 500, 34, 500, 64, 34, 500, 46, 500, 500, 500, 500, 30, 28, 500, 500, 64]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4001388127277601, "mean_inference_ms": 1.271616978907569, "mean_action_processing_ms": 0.14733116194359866, "mean_env_wait_ms": 0.0881907973185622, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015991687774658203, "StateBufferConnector_ms": 0.005999088287353516, "ViewRequirementAgentConnector_ms": 0.09900760650634766}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.0729999999997952, "episode_len_mean": 274.84, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.099999999999994, -50.00000000000044, 30.499999999999993, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.499999999999964, 46.699999999999996, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 2.699999999999598, 9.499999999999694, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.300000000000026, 45.5, 41.30000000000001, -50.00000000000044, 45.3, 25.699999999999925, 35.30000000000004, 46.5, 42.900000000000006, 44.5, -50.00000000000044, -50.00000000000044, 39.300000000000026, 40.90000000000002, -50.00000000000044, 40.30000000000002, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 4.299999999999621, 42.900000000000006, 28.09999999999996, 47.5, -50.00000000000044, 38.300000000000026, 43.7, 47.9, 46.5, 46.3, 47.1, 46.099999999999994, 42.900000000000006, 36.70000000000003, 31.70000000000001, -50.00000000000044, 44.10000000000001, -50.00000000000044, 43.50000000000001, 46.099999999999994, 41.100000000000016, 46.5, -50.00000000000044, -50.00000000000044, 46.099999999999994, 47.3, 37.10000000000003, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.10000000000002, -50.00000000000044, 44.900000000000006, 17.499999999999808, 15.49999999999978, -50.00000000000044, 46.699999999999996, -50.00000000000044, 43.7, 46.699999999999996, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 47.3, -50.00000000000044, -50.00000000000044, 43.7], "episode_lengths": [500, 40, 500, 196, 36, 500, 500, 500, 500, 500, 216, 34, 500, 500, 50, 500, 474, 406, 500, 30, 500, 500, 500, 500, 500, 500, 128, 46, 88, 500, 48, 244, 148, 36, 72, 56, 500, 500, 108, 92, 500, 98, 500, 72, 500, 500, 500, 68, 458, 72, 220, 26, 500, 118, 64, 22, 36, 38, 30, 40, 72, 134, 184, 500, 60, 500, 66, 40, 90, 36, 500, 500, 40, 28, 130, 50, 500, 500, 500, 120, 500, 52, 326, 346, 500, 34, 500, 64, 34, 500, 46, 500, 500, 500, 500, 30, 28, 500, 500, 64]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4001388127277601, "mean_inference_ms": 1.271616978907569, "mean_action_processing_ms": 0.14733116194359866, "mean_env_wait_ms": 0.0881907973185622, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015991687774658203, "StateBufferConnector_ms": 0.005999088287353516, "ViewRequirementAgentConnector_ms": 0.09900760650634766}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5766.61212261893, "num_env_steps_trained_throughput_per_sec": 5766.61212261893, "timesteps_total": 408000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 408000, "timers": {"training_iteration_time_ms": 2179.619, "sample_time_ms": 1926.643, "load_time_ms": 11.784, "load_throughput": 1018296.528, "learn_time_ms": 229.685, "learn_throughput": 52245.522, "synch_weights_time_ms": 9.745}, "counters": {"num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000}, "done": false, "episodes_total": 1506, "training_iteration": 34, "trial_id": "9f288_00019", "date": "2023-10-25_17-07-51", "timestamp": 1698250071, "time_this_iter_s": 2.08594012260437, "time_total_s": 77.54717326164246, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 77.54717326164246, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 58.833333333333336, "ram_util_percent": 27.53333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1641532182693485e-11, "cur_lr": 0.0003, "total_loss": 6.974968846638998, "policy_loss": -0.0008142595489819844, "vf_loss": 6.975830618540446, "vf_explained_var": -2.980232238769531e-07, "kl": 0.0018116804696546752, "entropy": 0.47531181772549946, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 518.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.837999999999831, "episode_len_mean": 242.26, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 38.300000000000026, 43.7, 47.9, 46.5, 46.3, 47.1, 46.099999999999994, 42.900000000000006, 36.70000000000003, 31.70000000000001, -50.00000000000044, 44.10000000000001, -50.00000000000044, 43.50000000000001, 46.099999999999994, 41.100000000000016, 46.5, -50.00000000000044, -50.00000000000044, 46.099999999999994, 47.3, 37.10000000000003, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.10000000000002, -50.00000000000044, 44.900000000000006, 17.499999999999808, 15.49999999999978, -50.00000000000044, 46.699999999999996, -50.00000000000044, 43.7, 46.699999999999996, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 47.3, -50.00000000000044, -50.00000000000044, 43.7, 25.29999999999992, 44.7, 31.900000000000013, 43.10000000000001, 41.30000000000001, 46.5, 41.70000000000002, -50.00000000000044, 7.09999999999966, 30.499999999999993, -50.00000000000044, 45.7, 41.500000000000014, 44.5, -50.00000000000044, -50.00000000000044, 45.7, 47.3, 46.099999999999994, 43.900000000000006, 37.50000000000003, 45.5, 46.3, 32.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 46.9, 34.30000000000004, 18.899999999999828, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 37.70000000000003, -50.00000000000044, 40.500000000000014, 44.5, 15.699999999999783, 43.10000000000001, -50.00000000000044, 31.70000000000001, -50.00000000000044, 44.5, -50.00000000000044], "episode_lengths": [500, 118, 64, 22, 36, 38, 30, 40, 72, 134, 184, 500, 60, 500, 66, 40, 90, 36, 500, 500, 40, 28, 130, 50, 500, 500, 500, 120, 500, 52, 326, 346, 500, 34, 500, 64, 34, 500, 46, 500, 500, 500, 500, 30, 28, 500, 500, 64, 248, 54, 182, 70, 88, 36, 84, 500, 430, 196, 500, 44, 86, 56, 500, 500, 44, 28, 40, 62, 126, 46, 38, 174, 500, 500, 500, 60, 32, 158, 312, 500, 500, 76, 500, 500, 32, 500, 500, 72, 500, 124, 500, 96, 56, 344, 70, 500, 184, 500, 56, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3997509257994449, "mean_inference_ms": 1.269834335724946, "mean_action_processing_ms": 0.14727480069477508, "mean_env_wait_ms": 0.08765435983584263, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026998281478881836, "StateBufferConnector_ms": 0.005997419357299805, "ViewRequirementAgentConnector_ms": 0.12399911880493164}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.837999999999831, "episode_len_mean": 242.26, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 38.300000000000026, 43.7, 47.9, 46.5, 46.3, 47.1, 46.099999999999994, 42.900000000000006, 36.70000000000003, 31.70000000000001, -50.00000000000044, 44.10000000000001, -50.00000000000044, 43.50000000000001, 46.099999999999994, 41.100000000000016, 46.5, -50.00000000000044, -50.00000000000044, 46.099999999999994, 47.3, 37.10000000000003, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.10000000000002, -50.00000000000044, 44.900000000000006, 17.499999999999808, 15.49999999999978, -50.00000000000044, 46.699999999999996, -50.00000000000044, 43.7, 46.699999999999996, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 47.3, -50.00000000000044, -50.00000000000044, 43.7, 25.29999999999992, 44.7, 31.900000000000013, 43.10000000000001, 41.30000000000001, 46.5, 41.70000000000002, -50.00000000000044, 7.09999999999966, 30.499999999999993, -50.00000000000044, 45.7, 41.500000000000014, 44.5, -50.00000000000044, -50.00000000000044, 45.7, 47.3, 46.099999999999994, 43.900000000000006, 37.50000000000003, 45.5, 46.3, 32.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 46.9, 34.30000000000004, 18.899999999999828, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 37.70000000000003, -50.00000000000044, 40.500000000000014, 44.5, 15.699999999999783, 43.10000000000001, -50.00000000000044, 31.70000000000001, -50.00000000000044, 44.5, -50.00000000000044], "episode_lengths": [500, 118, 64, 22, 36, 38, 30, 40, 72, 134, 184, 500, 60, 500, 66, 40, 90, 36, 500, 500, 40, 28, 130, 50, 500, 500, 500, 120, 500, 52, 326, 346, 500, 34, 500, 64, 34, 500, 46, 500, 500, 500, 500, 30, 28, 500, 500, 64, 248, 54, 182, 70, 88, 36, 84, 500, 430, 196, 500, 44, 86, 56, 500, 500, 44, 28, 40, 62, 126, 46, 38, 174, 500, 500, 500, 60, 32, 158, 312, 500, 500, 76, 500, 500, 32, 500, 500, 72, 500, 124, 500, 96, 56, 344, 70, 500, 184, 500, 56, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3997509257994449, "mean_inference_ms": 1.269834335724946, "mean_action_processing_ms": 0.14727480069477508, "mean_env_wait_ms": 0.08765435983584263, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026998281478881836, "StateBufferConnector_ms": 0.005997419357299805, "ViewRequirementAgentConnector_ms": 0.12399911880493164}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5419.1660356356915, "num_env_steps_trained_throughput_per_sec": 5419.1660356356915, "timesteps_total": 420000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 420000, "timers": {"training_iteration_time_ms": 2185.855, "sample_time_ms": 1925.414, "load_time_ms": 12.285, "load_throughput": 976771.114, "learn_time_ms": 236.578, "learn_throughput": 50723.288, "synch_weights_time_ms": 9.716}, "counters": {"num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000}, "done": false, "episodes_total": 1558, "training_iteration": 35, "trial_id": "9f288_00019", "date": "2023-10-25_17-07-53", "timestamp": 1698250073, "time_this_iter_s": 2.2193620204925537, "time_total_s": 79.76653528213501, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 79.76653528213501, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 60.93333333333334, "ram_util_percent": 27.53333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.820766091346743e-12, "cur_lr": 0.0003, "total_loss": 6.546314112345377, "policy_loss": 0.00029130553205808005, "vf_loss": 6.54607458114624, "vf_explained_var": 3.5762786865234374e-08, "kl": 0.0006588934421415616, "entropy": 0.517757507165273, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 533.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.5019999999998275, "episode_len_mean": 255.62, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 47.1, 47.3, -50.00000000000044, -50.00000000000044, 43.7, 25.29999999999992, 44.7, 31.900000000000013, 43.10000000000001, 41.30000000000001, 46.5, 41.70000000000002, -50.00000000000044, 7.09999999999966, 30.499999999999993, -50.00000000000044, 45.7, 41.500000000000014, 44.5, -50.00000000000044, -50.00000000000044, 45.7, 47.3, 46.099999999999994, 43.900000000000006, 37.50000000000003, 45.5, 46.3, 32.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 46.9, 34.30000000000004, 18.899999999999828, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 37.70000000000003, -50.00000000000044, 40.500000000000014, 44.5, 15.699999999999783, 43.10000000000001, -50.00000000000044, 31.70000000000001, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 42.900000000000006, 46.699999999999996, 38.50000000000003, 46.5, -50.00000000000044, 42.500000000000014, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.099999999999987, 24.499999999999908, -50.00000000000044, 36.10000000000004, 35.900000000000034, -50.00000000000044, 45.5, 19.499999999999837, -50.00000000000044, -50.00000000000044, 43.7, 25.499999999999922, 9.699999999999697, 46.3, 33.10000000000003, -50.00000000000044, 44.900000000000006, 40.10000000000002, 41.500000000000014, 30.29999999999999, 40.70000000000002, 35.70000000000003, -50.00000000000044, 45.3, -50.00000000000044, 45.5, 8.099999999999675, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044], "episode_lengths": [500, 30, 28, 500, 500, 64, 248, 54, 182, 70, 88, 36, 84, 500, 430, 196, 500, 44, 86, 56, 500, 500, 44, 28, 40, 62, 126, 46, 38, 174, 500, 500, 500, 60, 32, 158, 312, 500, 500, 76, 500, 500, 32, 500, 500, 72, 500, 124, 500, 96, 56, 344, 70, 500, 184, 500, 56, 500, 500, 72, 34, 116, 36, 500, 76, 48, 500, 500, 500, 200, 256, 500, 140, 142, 500, 46, 306, 500, 500, 64, 246, 404, 38, 170, 500, 52, 100, 86, 198, 94, 144, 500, 48, 500, 46, 420, 500, 500, 54, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3990945217053674, "mean_inference_ms": 1.2680470462268405, "mean_action_processing_ms": 0.14672930823399732, "mean_env_wait_ms": 0.08776845645846881, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.032997846603393555, "StateBufferConnector_ms": 0.005997896194458008, "ViewRequirementAgentConnector_ms": 0.11998772621154785}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.5019999999998275, "episode_len_mean": 255.62, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 47.1, 47.3, -50.00000000000044, -50.00000000000044, 43.7, 25.29999999999992, 44.7, 31.900000000000013, 43.10000000000001, 41.30000000000001, 46.5, 41.70000000000002, -50.00000000000044, 7.09999999999966, 30.499999999999993, -50.00000000000044, 45.7, 41.500000000000014, 44.5, -50.00000000000044, -50.00000000000044, 45.7, 47.3, 46.099999999999994, 43.900000000000006, 37.50000000000003, 45.5, 46.3, 32.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 46.9, 34.30000000000004, 18.899999999999828, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 37.70000000000003, -50.00000000000044, 40.500000000000014, 44.5, 15.699999999999783, 43.10000000000001, -50.00000000000044, 31.70000000000001, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 42.900000000000006, 46.699999999999996, 38.50000000000003, 46.5, -50.00000000000044, 42.500000000000014, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.099999999999987, 24.499999999999908, -50.00000000000044, 36.10000000000004, 35.900000000000034, -50.00000000000044, 45.5, 19.499999999999837, -50.00000000000044, -50.00000000000044, 43.7, 25.499999999999922, 9.699999999999697, 46.3, 33.10000000000003, -50.00000000000044, 44.900000000000006, 40.10000000000002, 41.500000000000014, 30.29999999999999, 40.70000000000002, 35.70000000000003, -50.00000000000044, 45.3, -50.00000000000044, 45.5, 8.099999999999675, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044], "episode_lengths": [500, 30, 28, 500, 500, 64, 248, 54, 182, 70, 88, 36, 84, 500, 430, 196, 500, 44, 86, 56, 500, 500, 44, 28, 40, 62, 126, 46, 38, 174, 500, 500, 500, 60, 32, 158, 312, 500, 500, 76, 500, 500, 32, 500, 500, 72, 500, 124, 500, 96, 56, 344, 70, 500, 184, 500, 56, 500, 500, 72, 34, 116, 36, 500, 76, 48, 500, 500, 500, 200, 256, 500, 140, 142, 500, 46, 306, 500, 500, 64, 246, 404, 38, 170, 500, 52, 100, 86, 198, 94, 144, 500, 48, 500, 46, 420, 500, 500, 54, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3990945217053674, "mean_inference_ms": 1.2680470462268405, "mean_action_processing_ms": 0.14672930823399732, "mean_env_wait_ms": 0.08776845645846881, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.032997846603393555, "StateBufferConnector_ms": 0.005997896194458008, "ViewRequirementAgentConnector_ms": 0.11998772621154785}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5501.316971941688, "num_env_steps_trained_throughput_per_sec": 5501.316971941688, "timesteps_total": 432000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 432000, "timers": {"training_iteration_time_ms": 2165.685, "sample_time_ms": 1911.465, "load_time_ms": 11.585, "load_throughput": 1035790.461, "learn_time_ms": 231.456, "learn_throughput": 51845.655, "synch_weights_time_ms": 9.316}, "counters": {"num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "done": false, "episodes_total": 1600, "training_iteration": 36, "trial_id": "9f288_00019", "date": "2023-10-25_17-07-55", "timestamp": 1698250075, "time_this_iter_s": 2.1862952709198, "time_total_s": 81.95283055305481, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 81.95283055305481, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 59.53333333333334, "ram_util_percent": 27.53333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.9103830456733713e-12, "cur_lr": 0.0003, "total_loss": 6.276279322306315, "policy_loss": -5.445579687754313e-05, "vf_loss": 6.276382764180501, "vf_explained_var": -2.6623407999674478e-06, "kl": 0.00016946135096986836, "entropy": 0.49003095030784605, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 548.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_agent_steps_sampled": 444000, "num_agent_steps_trained": 444000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.950999999999834, "episode_len_mean": 246.16, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 31.70000000000001, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 42.900000000000006, 46.699999999999996, 38.50000000000003, 46.5, -50.00000000000044, 42.500000000000014, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.099999999999987, 24.499999999999908, -50.00000000000044, 36.10000000000004, 35.900000000000034, -50.00000000000044, 45.5, 19.499999999999837, -50.00000000000044, -50.00000000000044, 43.7, 25.499999999999922, 9.699999999999697, 46.3, 33.10000000000003, -50.00000000000044, 44.900000000000006, 40.10000000000002, 41.500000000000014, 30.29999999999999, 40.70000000000002, 35.70000000000003, -50.00000000000044, 45.3, -50.00000000000044, 45.5, 8.099999999999675, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 41.500000000000014, 11.499999999999723, 45.9, 47.7, 5.099999999999632, -50.00000000000044, 39.70000000000002, 34.10000000000004, 44.10000000000001, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, 42.70000000000001, 44.5, -50.00000000000044, 46.699999999999996, 45.5, -50.00000000000044, 4.299999999999621, 44.900000000000006, 35.10000000000004, 32.90000000000003, 45.1, 47.1, 44.300000000000004, 40.70000000000002, 45.9, -50.00000000000044, 42.10000000000001, 45.3, -50.00000000000044, -50.00000000000044, 23.29999999999989, -50.00000000000044, 46.3, -50.00000000000044, 46.9, 46.3, 42.900000000000006, -50.00000000000044, 42.30000000000001, 44.300000000000004, -50.00000000000044, 3.499999999999609, 44.5, 46.699999999999996, 39.50000000000002, -50.00000000000044, 45.7, 45.9], "episode_lengths": [500, 184, 500, 56, 500, 500, 72, 34, 116, 36, 500, 76, 48, 500, 500, 500, 200, 256, 500, 140, 142, 500, 46, 306, 500, 500, 64, 246, 404, 38, 170, 500, 52, 100, 86, 198, 94, 144, 500, 48, 500, 46, 420, 500, 500, 54, 500, 500, 86, 386, 42, 24, 450, 500, 104, 160, 60, 50, 500, 500, 500, 102, 74, 56, 500, 34, 46, 500, 458, 52, 150, 172, 50, 30, 58, 94, 42, 500, 80, 48, 500, 500, 268, 500, 38, 500, 32, 38, 72, 500, 78, 58, 500, 466, 56, 34, 106, 500, 44, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3979638539856042, "mean_inference_ms": 1.2662712816221802, "mean_action_processing_ms": 0.14673457563929082, "mean_env_wait_ms": 0.08803963012755378, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028999805450439453, "StateBufferConnector_ms": 0.006000518798828125, "ViewRequirementAgentConnector_ms": 0.10699200630187988}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.950999999999834, "episode_len_mean": 246.16, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 31.70000000000001, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 42.900000000000006, 46.699999999999996, 38.50000000000003, 46.5, -50.00000000000044, 42.500000000000014, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.099999999999987, 24.499999999999908, -50.00000000000044, 36.10000000000004, 35.900000000000034, -50.00000000000044, 45.5, 19.499999999999837, -50.00000000000044, -50.00000000000044, 43.7, 25.499999999999922, 9.699999999999697, 46.3, 33.10000000000003, -50.00000000000044, 44.900000000000006, 40.10000000000002, 41.500000000000014, 30.29999999999999, 40.70000000000002, 35.70000000000003, -50.00000000000044, 45.3, -50.00000000000044, 45.5, 8.099999999999675, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 41.500000000000014, 11.499999999999723, 45.9, 47.7, 5.099999999999632, -50.00000000000044, 39.70000000000002, 34.10000000000004, 44.10000000000001, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, 42.70000000000001, 44.5, -50.00000000000044, 46.699999999999996, 45.5, -50.00000000000044, 4.299999999999621, 44.900000000000006, 35.10000000000004, 32.90000000000003, 45.1, 47.1, 44.300000000000004, 40.70000000000002, 45.9, -50.00000000000044, 42.10000000000001, 45.3, -50.00000000000044, -50.00000000000044, 23.29999999999989, -50.00000000000044, 46.3, -50.00000000000044, 46.9, 46.3, 42.900000000000006, -50.00000000000044, 42.30000000000001, 44.300000000000004, -50.00000000000044, 3.499999999999609, 44.5, 46.699999999999996, 39.50000000000002, -50.00000000000044, 45.7, 45.9], "episode_lengths": [500, 184, 500, 56, 500, 500, 72, 34, 116, 36, 500, 76, 48, 500, 500, 500, 200, 256, 500, 140, 142, 500, 46, 306, 500, 500, 64, 246, 404, 38, 170, 500, 52, 100, 86, 198, 94, 144, 500, 48, 500, 46, 420, 500, 500, 54, 500, 500, 86, 386, 42, 24, 450, 500, 104, 160, 60, 50, 500, 500, 500, 102, 74, 56, 500, 34, 46, 500, 458, 52, 150, 172, 50, 30, 58, 94, 42, 500, 80, 48, 500, 500, 268, 500, 38, 500, 32, 38, 72, 500, 78, 58, 500, 466, 56, 34, 106, 500, 44, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3979638539856042, "mean_inference_ms": 1.2662712816221802, "mean_action_processing_ms": 0.14673457563929082, "mean_env_wait_ms": 0.08803963012755378, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028999805450439453, "StateBufferConnector_ms": 0.006000518798828125, "ViewRequirementAgentConnector_ms": 0.10699200630187988}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 444000, "num_agent_steps_trained": 444000, "num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5359.051394846301, "num_env_steps_trained_throughput_per_sec": 5359.051394846301, "timesteps_total": 444000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 444000, "timers": {"training_iteration_time_ms": 2176.556, "sample_time_ms": 1910.414, "load_time_ms": 12.285, "load_throughput": 976782.487, "learn_time_ms": 242.678, "learn_throughput": 49448.318, "synch_weights_time_ms": 9.218}, "counters": {"num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_agent_steps_sampled": 444000, "num_agent_steps_trained": 444000}, "done": false, "episodes_total": 1653, "training_iteration": 37, "trial_id": "9f288_00019", "date": "2023-10-25_17-07-58", "timestamp": 1698250078, "time_this_iter_s": 2.2441978454589844, "time_total_s": 84.1970283985138, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 84.1970283985138, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 59.666666666666664, "ram_util_percent": 27.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.4551915228366857e-12, "cur_lr": 0.0003, "total_loss": 5.837627029418945, "policy_loss": -0.0004600968211889267, "vf_loss": 5.838136482238769, "vf_explained_var": -3.0199686686197915e-07, "kl": 0.0006019720804317785, "entropy": 0.4942306220531464, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 563.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.19699999999983, "episode_len_mean": 243.68, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 41.500000000000014, 11.499999999999723, 45.9, 47.7, 5.099999999999632, -50.00000000000044, 39.70000000000002, 34.10000000000004, 44.10000000000001, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, 42.70000000000001, 44.5, -50.00000000000044, 46.699999999999996, 45.5, -50.00000000000044, 4.299999999999621, 44.900000000000006, 35.10000000000004, 32.90000000000003, 45.1, 47.1, 44.300000000000004, 40.70000000000002, 45.9, -50.00000000000044, 42.10000000000001, 45.3, -50.00000000000044, -50.00000000000044, 23.29999999999989, -50.00000000000044, 46.3, -50.00000000000044, 46.9, 46.3, 42.900000000000006, -50.00000000000044, 42.30000000000001, 44.300000000000004, -50.00000000000044, 3.499999999999609, 44.5, 46.699999999999996, 39.50000000000002, -50.00000000000044, 45.7, 45.9, -50.00000000000044, -50.00000000000044, 47.1, 32.30000000000002, 47.1, -50.00000000000044, -50.00000000000044, 32.30000000000002, -50.00000000000044, 38.90000000000002, 43.7, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 20.299999999999848, 45.9, -50.00000000000044, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, 26.09999999999993, 32.30000000000002, -50.00000000000044, -50.00000000000044, 46.9, 43.30000000000001, 43.30000000000001, 44.10000000000001, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 38.700000000000024, -50.00000000000044, 39.90000000000002, 44.7, 44.7, 45.7, 40.90000000000002, 46.5, 24.299999999999905], "episode_lengths": [500, 54, 500, 500, 86, 386, 42, 24, 450, 500, 104, 160, 60, 50, 500, 500, 500, 102, 74, 56, 500, 34, 46, 500, 458, 52, 150, 172, 50, 30, 58, 94, 42, 500, 80, 48, 500, 500, 268, 500, 38, 500, 32, 38, 72, 500, 78, 58, 500, 466, 56, 34, 106, 500, 44, 42, 500, 500, 30, 178, 30, 500, 500, 178, 500, 112, 64, 66, 500, 500, 500, 298, 42, 500, 500, 104, 500, 500, 240, 178, 500, 500, 32, 68, 68, 60, 38, 500, 500, 500, 34, 114, 500, 102, 54, 54, 44, 92, 36, 258]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3975148545183799, "mean_inference_ms": 1.2665512690163347, "mean_action_processing_ms": 0.14679209332848003, "mean_env_wait_ms": 0.08805615084971555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0330052375793457, "StateBufferConnector_ms": 0.009002208709716797, "ViewRequirementAgentConnector_ms": 0.11299753189086914}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.19699999999983, "episode_len_mean": 243.68, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 41.500000000000014, 11.499999999999723, 45.9, 47.7, 5.099999999999632, -50.00000000000044, 39.70000000000002, 34.10000000000004, 44.10000000000001, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, 42.70000000000001, 44.5, -50.00000000000044, 46.699999999999996, 45.5, -50.00000000000044, 4.299999999999621, 44.900000000000006, 35.10000000000004, 32.90000000000003, 45.1, 47.1, 44.300000000000004, 40.70000000000002, 45.9, -50.00000000000044, 42.10000000000001, 45.3, -50.00000000000044, -50.00000000000044, 23.29999999999989, -50.00000000000044, 46.3, -50.00000000000044, 46.9, 46.3, 42.900000000000006, -50.00000000000044, 42.30000000000001, 44.300000000000004, -50.00000000000044, 3.499999999999609, 44.5, 46.699999999999996, 39.50000000000002, -50.00000000000044, 45.7, 45.9, -50.00000000000044, -50.00000000000044, 47.1, 32.30000000000002, 47.1, -50.00000000000044, -50.00000000000044, 32.30000000000002, -50.00000000000044, 38.90000000000002, 43.7, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 20.299999999999848, 45.9, -50.00000000000044, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, 26.09999999999993, 32.30000000000002, -50.00000000000044, -50.00000000000044, 46.9, 43.30000000000001, 43.30000000000001, 44.10000000000001, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 38.700000000000024, -50.00000000000044, 39.90000000000002, 44.7, 44.7, 45.7, 40.90000000000002, 46.5, 24.299999999999905], "episode_lengths": [500, 54, 500, 500, 86, 386, 42, 24, 450, 500, 104, 160, 60, 50, 500, 500, 500, 102, 74, 56, 500, 34, 46, 500, 458, 52, 150, 172, 50, 30, 58, 94, 42, 500, 80, 48, 500, 500, 268, 500, 38, 500, 32, 38, 72, 500, 78, 58, 500, 466, 56, 34, 106, 500, 44, 42, 500, 500, 30, 178, 30, 500, 500, 178, 500, 112, 64, 66, 500, 500, 500, 298, 42, 500, 500, 104, 500, 500, 240, 178, 500, 500, 32, 68, 68, 60, 38, 500, 500, 500, 34, 114, 500, 102, 54, 54, 44, 92, 36, 258]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3975148545183799, "mean_inference_ms": 1.2665512690163347, "mean_action_processing_ms": 0.14679209332848003, "mean_env_wait_ms": 0.08805615084971555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0330052375793457, "StateBufferConnector_ms": 0.009002208709716797, "ViewRequirementAgentConnector_ms": 0.11299753189086914}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5469.874670832025, "num_env_steps_trained_throughput_per_sec": 5469.874670832025, "timesteps_total": 456000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 456000, "timers": {"training_iteration_time_ms": 2175.142, "sample_time_ms": 1917.819, "load_time_ms": 11.385, "load_throughput": 1054010.743, "learn_time_ms": 234.832, "learn_throughput": 51100.294, "synch_weights_time_ms": 9.244}, "counters": {"num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000}, "done": false, "episodes_total": 1697, "training_iteration": 38, "trial_id": "9f288_00019", "date": "2023-10-25_17-08-00", "timestamp": 1698250080, "time_this_iter_s": 2.198840856552124, "time_total_s": 86.39586925506592, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 86.39586925506592, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 58.4, "ram_util_percent": 27.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.275957614183428e-13, "cur_lr": 0.0003, "total_loss": 6.744233671824137, "policy_loss": -0.0005420764287312825, "vf_loss": 6.744822947184245, "vf_explained_var": -1.7484029134114583e-06, "kl": 0.001024247563964309, "entropy": 0.4733125150203705, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 578.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.7549999999998094, "episode_len_mean": 268.04, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 3.499999999999609, 44.5, 46.699999999999996, 39.50000000000002, -50.00000000000044, 45.7, 45.9, -50.00000000000044, -50.00000000000044, 47.1, 32.30000000000002, 47.1, -50.00000000000044, -50.00000000000044, 32.30000000000002, -50.00000000000044, 38.90000000000002, 43.7, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 20.299999999999848, 45.9, -50.00000000000044, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, 26.09999999999993, 32.30000000000002, -50.00000000000044, -50.00000000000044, 46.9, 43.30000000000001, 43.30000000000001, 44.10000000000001, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 38.700000000000024, -50.00000000000044, 39.90000000000002, 44.7, 44.7, 45.7, 40.90000000000002, 46.5, 24.299999999999905, 22.299999999999876, 46.099999999999994, 44.10000000000001, 33.70000000000004, 39.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.7, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, 38.700000000000024, -50.00000000000044, 34.70000000000004, 44.7, -50.00000000000044, 2.299999999999592, -50.00000000000044, 46.5, -50.00000000000044, 15.49999999999978, 44.10000000000001, 42.70000000000001, 46.5, 36.70000000000003, 30.9, -50.00000000000044, 43.50000000000001, -50.00000000000044, 46.9, -50.00000000000044, 45.5, 44.300000000000004, 46.9, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 37.70000000000003, -50.00000000000044], "episode_lengths": [500, 466, 56, 34, 106, 500, 44, 42, 500, 500, 30, 178, 30, 500, 500, 178, 500, 112, 64, 66, 500, 500, 500, 298, 42, 500, 500, 104, 500, 500, 240, 178, 500, 500, 32, 68, 68, 60, 38, 500, 500, 500, 34, 114, 500, 102, 54, 54, 44, 92, 36, 258, 278, 40, 60, 164, 108, 500, 500, 500, 500, 24, 30, 500, 500, 500, 500, 500, 142, 114, 500, 154, 54, 500, 478, 500, 36, 500, 346, 60, 74, 36, 134, 192, 500, 66, 500, 32, 500, 46, 58, 32, 500, 56, 500, 500, 500, 44, 124, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39744478197448785, "mean_inference_ms": 1.2667583360654073, "mean_action_processing_ms": 0.14678976497019422, "mean_env_wait_ms": 0.08808417694868317, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027985095977783203, "StateBufferConnector_ms": 0.00899815559387207, "ViewRequirementAgentConnector_ms": 0.13900256156921387}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.7549999999998094, "episode_len_mean": 268.04, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 3.499999999999609, 44.5, 46.699999999999996, 39.50000000000002, -50.00000000000044, 45.7, 45.9, -50.00000000000044, -50.00000000000044, 47.1, 32.30000000000002, 47.1, -50.00000000000044, -50.00000000000044, 32.30000000000002, -50.00000000000044, 38.90000000000002, 43.7, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 20.299999999999848, 45.9, -50.00000000000044, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, 26.09999999999993, 32.30000000000002, -50.00000000000044, -50.00000000000044, 46.9, 43.30000000000001, 43.30000000000001, 44.10000000000001, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 38.700000000000024, -50.00000000000044, 39.90000000000002, 44.7, 44.7, 45.7, 40.90000000000002, 46.5, 24.299999999999905, 22.299999999999876, 46.099999999999994, 44.10000000000001, 33.70000000000004, 39.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.7, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, 38.700000000000024, -50.00000000000044, 34.70000000000004, 44.7, -50.00000000000044, 2.299999999999592, -50.00000000000044, 46.5, -50.00000000000044, 15.49999999999978, 44.10000000000001, 42.70000000000001, 46.5, 36.70000000000003, 30.9, -50.00000000000044, 43.50000000000001, -50.00000000000044, 46.9, -50.00000000000044, 45.5, 44.300000000000004, 46.9, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 37.70000000000003, -50.00000000000044], "episode_lengths": [500, 466, 56, 34, 106, 500, 44, 42, 500, 500, 30, 178, 30, 500, 500, 178, 500, 112, 64, 66, 500, 500, 500, 298, 42, 500, 500, 104, 500, 500, 240, 178, 500, 500, 32, 68, 68, 60, 38, 500, 500, 500, 34, 114, 500, 102, 54, 54, 44, 92, 36, 258, 278, 40, 60, 164, 108, 500, 500, 500, 500, 24, 30, 500, 500, 500, 500, 500, 142, 114, 500, 154, 54, 500, 478, 500, 36, 500, 346, 60, 74, 36, 134, 192, 500, 66, 500, 32, 500, 46, 58, 32, 500, 56, 500, 500, 500, 44, 124, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39744478197448785, "mean_inference_ms": 1.2667583360654073, "mean_action_processing_ms": 0.14678976497019422, "mean_env_wait_ms": 0.08808417694868317, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027985095977783203, "StateBufferConnector_ms": 0.00899815559387207, "ViewRequirementAgentConnector_ms": 0.13900256156921387}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5165.708087829968, "num_env_steps_trained_throughput_per_sec": 5165.708087829968, "timesteps_total": 468000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 468000, "timers": {"training_iteration_time_ms": 2197.367, "sample_time_ms": 1934.229, "load_time_ms": 11.783, "load_throughput": 1018426.337, "learn_time_ms": 240.55, "learn_throughput": 49885.734, "synch_weights_time_ms": 8.945}, "counters": {"num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000}, "done": false, "episodes_total": 1745, "training_iteration": 39, "trial_id": "9f288_00019", "date": "2023-10-25_17-08-02", "timestamp": 1698250082, "time_this_iter_s": 2.3280086517333984, "time_total_s": 88.72387790679932, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 88.72387790679932, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 62.7, "ram_util_percent": 27.525}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.637978807091714e-13, "cur_lr": 0.0003, "total_loss": 5.863122304280599, "policy_loss": -0.0005673730125029882, "vf_loss": 5.8637361844380695, "vf_explained_var": -2.948443094889323e-06, "kl": 0.0006922662133395837, "entropy": 0.4654786845048269, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 593.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.8719999999998134, "episode_len_mean": 261.88, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 46.699999999999996, 38.700000000000024, -50.00000000000044, 39.90000000000002, 44.7, 44.7, 45.7, 40.90000000000002, 46.5, 24.299999999999905, 22.299999999999876, 46.099999999999994, 44.10000000000001, 33.70000000000004, 39.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.7, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, 38.700000000000024, -50.00000000000044, 34.70000000000004, 44.7, -50.00000000000044, 2.299999999999592, -50.00000000000044, 46.5, -50.00000000000044, 15.49999999999978, 44.10000000000001, 42.70000000000001, 46.5, 36.70000000000003, 30.9, -50.00000000000044, 43.50000000000001, -50.00000000000044, 46.9, -50.00000000000044, 45.5, 44.300000000000004, 46.9, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 37.70000000000003, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 45.1, 43.10000000000001, -50.00000000000044, 46.9, 44.900000000000006, 32.700000000000024, -50.00000000000044, 44.300000000000004, -50.00000000000044, 47.1, 45.7, 45.5, 45.9, 46.099999999999994, -50.00000000000044, 38.700000000000024, -50.00000000000044, 46.9, 45.1, -50.00000000000044, 39.10000000000002, 42.500000000000014, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044, 46.3, 38.10000000000002, 5.6999999999996405, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 21.89999999999987, -50.00000000000044, -50.00000000000044, 22.699999999999882], "episode_lengths": [500, 500, 34, 114, 500, 102, 54, 54, 44, 92, 36, 258, 278, 40, 60, 164, 108, 500, 500, 500, 500, 24, 30, 500, 500, 500, 500, 500, 142, 114, 500, 154, 54, 500, 478, 500, 36, 500, 346, 60, 74, 36, 134, 192, 500, 66, 500, 32, 500, 46, 58, 32, 500, 56, 500, 500, 500, 44, 124, 500, 66, 500, 500, 50, 70, 500, 32, 52, 174, 500, 58, 500, 30, 44, 46, 42, 40, 500, 114, 500, 32, 50, 500, 110, 76, 500, 92, 500, 500, 38, 120, 444, 500, 82, 500, 500, 282, 500, 500, 274]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3973271273002291, "mean_inference_ms": 1.2659320515955952, "mean_action_processing_ms": 0.14700370770582383, "mean_env_wait_ms": 0.08772036048007527, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024984359741210938, "StateBufferConnector_ms": 0.008995294570922852, "ViewRequirementAgentConnector_ms": 0.1259782314300537}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.8719999999998134, "episode_len_mean": 261.88, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 46.699999999999996, 38.700000000000024, -50.00000000000044, 39.90000000000002, 44.7, 44.7, 45.7, 40.90000000000002, 46.5, 24.299999999999905, 22.299999999999876, 46.099999999999994, 44.10000000000001, 33.70000000000004, 39.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.7, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, 38.700000000000024, -50.00000000000044, 34.70000000000004, 44.7, -50.00000000000044, 2.299999999999592, -50.00000000000044, 46.5, -50.00000000000044, 15.49999999999978, 44.10000000000001, 42.70000000000001, 46.5, 36.70000000000003, 30.9, -50.00000000000044, 43.50000000000001, -50.00000000000044, 46.9, -50.00000000000044, 45.5, 44.300000000000004, 46.9, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 37.70000000000003, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 45.1, 43.10000000000001, -50.00000000000044, 46.9, 44.900000000000006, 32.700000000000024, -50.00000000000044, 44.300000000000004, -50.00000000000044, 47.1, 45.7, 45.5, 45.9, 46.099999999999994, -50.00000000000044, 38.700000000000024, -50.00000000000044, 46.9, 45.1, -50.00000000000044, 39.10000000000002, 42.500000000000014, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044, 46.3, 38.10000000000002, 5.6999999999996405, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 21.89999999999987, -50.00000000000044, -50.00000000000044, 22.699999999999882], "episode_lengths": [500, 500, 34, 114, 500, 102, 54, 54, 44, 92, 36, 258, 278, 40, 60, 164, 108, 500, 500, 500, 500, 24, 30, 500, 500, 500, 500, 500, 142, 114, 500, 154, 54, 500, 478, 500, 36, 500, 346, 60, 74, 36, 134, 192, 500, 66, 500, 32, 500, 46, 58, 32, 500, 56, 500, 500, 500, 44, 124, 500, 66, 500, 500, 50, 70, 500, 32, 52, 174, 500, 58, 500, 30, 44, 46, 42, 40, 500, 114, 500, 32, 50, 500, 110, 76, 500, 92, 500, 500, 38, 120, 444, 500, 82, 500, 500, 282, 500, 500, 274]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3973271273002291, "mean_inference_ms": 1.2659320515955952, "mean_action_processing_ms": 0.14700370770582383, "mean_env_wait_ms": 0.08772036048007527, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024984359741210938, "StateBufferConnector_ms": 0.008995294570922852, "ViewRequirementAgentConnector_ms": 0.1259782314300537}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5689.97384370867, "num_env_steps_trained_throughput_per_sec": 5689.97384370867, "timesteps_total": 480000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 480000, "timers": {"training_iteration_time_ms": 2183.83, "sample_time_ms": 1926.309, "load_time_ms": 11.401, "load_throughput": 1052553.776, "learn_time_ms": 235.318, "learn_throughput": 50994.82, "synch_weights_time_ms": 8.942}, "counters": {"num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "done": false, "episodes_total": 1785, "training_iteration": 40, "trial_id": "9f288_00019", "date": "2023-10-25_17-08-04", "timestamp": 1698250084, "time_this_iter_s": 2.1139705181121826, "time_total_s": 90.8378484249115, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 90.8378484249115, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 58.199999999999996, "ram_util_percent": 27.46666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.818989403545857e-13, "cur_lr": 0.0003, "total_loss": 6.2409612019856775, "policy_loss": -0.00017028066019217174, "vf_loss": 6.241176573435466, "vf_explained_var": -1.152356465657552e-06, "kl": 0.0002978134211540843, "entropy": 0.4505919456481934, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 608.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_agent_steps_sampled": 492000, "num_agent_steps_trained": 492000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.7739999999997981, "episode_len_mean": 272.82, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.50000000000001, -50.00000000000044, 46.9, -50.00000000000044, 45.5, 44.300000000000004, 46.9, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 37.70000000000003, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 45.1, 43.10000000000001, -50.00000000000044, 46.9, 44.900000000000006, 32.700000000000024, -50.00000000000044, 44.300000000000004, -50.00000000000044, 47.1, 45.7, 45.5, 45.9, 46.099999999999994, -50.00000000000044, 38.700000000000024, -50.00000000000044, 46.9, 45.1, -50.00000000000044, 39.10000000000002, 42.500000000000014, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044, 46.3, 38.10000000000002, 5.6999999999996405, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 21.89999999999987, -50.00000000000044, -50.00000000000044, 22.699999999999882, -50.00000000000044, 44.5, 40.500000000000014, -50.00000000000044, 43.10000000000001, -50.00000000000044, 46.5, 27.099999999999945, -50.00000000000044, 45.3, -50.00000000000044, 22.699999999999882, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.29999999999999, 34.30000000000004, 44.10000000000001, 42.10000000000001, 44.7, 44.300000000000004, 46.099999999999994, -50.00000000000044, 43.50000000000001, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, 29.299999999999976, -50.00000000000044, -50.00000000000044, 36.900000000000034, 47.1, -50.00000000000044, 46.5, -50.00000000000044, 44.10000000000001, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 17.69999999999981, -50.00000000000044, -50.00000000000044, 47.7], "episode_lengths": [66, 500, 32, 500, 46, 58, 32, 500, 56, 500, 500, 500, 44, 124, 500, 66, 500, 500, 50, 70, 500, 32, 52, 174, 500, 58, 500, 30, 44, 46, 42, 40, 500, 114, 500, 32, 50, 500, 110, 76, 500, 92, 500, 500, 38, 120, 444, 500, 82, 500, 500, 282, 500, 500, 274, 500, 56, 96, 500, 70, 500, 36, 230, 500, 48, 500, 274, 500, 500, 500, 198, 158, 60, 80, 54, 58, 40, 500, 66, 500, 28, 500, 500, 208, 500, 500, 132, 30, 500, 36, 500, 60, 500, 40, 500, 500, 324, 500, 500, 24]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3970008228011563, "mean_inference_ms": 1.2643133786828005, "mean_action_processing_ms": 0.14678930568977214, "mean_env_wait_ms": 0.08760099096943788, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018995285034179688, "StateBufferConnector_ms": 0.006998300552368164, "ViewRequirementAgentConnector_ms": 0.1330099105834961}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.7739999999997981, "episode_len_mean": 272.82, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.50000000000001, -50.00000000000044, 46.9, -50.00000000000044, 45.5, 44.300000000000004, 46.9, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 37.70000000000003, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 45.1, 43.10000000000001, -50.00000000000044, 46.9, 44.900000000000006, 32.700000000000024, -50.00000000000044, 44.300000000000004, -50.00000000000044, 47.1, 45.7, 45.5, 45.9, 46.099999999999994, -50.00000000000044, 38.700000000000024, -50.00000000000044, 46.9, 45.1, -50.00000000000044, 39.10000000000002, 42.500000000000014, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044, 46.3, 38.10000000000002, 5.6999999999996405, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 21.89999999999987, -50.00000000000044, -50.00000000000044, 22.699999999999882, -50.00000000000044, 44.5, 40.500000000000014, -50.00000000000044, 43.10000000000001, -50.00000000000044, 46.5, 27.099999999999945, -50.00000000000044, 45.3, -50.00000000000044, 22.699999999999882, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.29999999999999, 34.30000000000004, 44.10000000000001, 42.10000000000001, 44.7, 44.300000000000004, 46.099999999999994, -50.00000000000044, 43.50000000000001, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, 29.299999999999976, -50.00000000000044, -50.00000000000044, 36.900000000000034, 47.1, -50.00000000000044, 46.5, -50.00000000000044, 44.10000000000001, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 17.69999999999981, -50.00000000000044, -50.00000000000044, 47.7], "episode_lengths": [66, 500, 32, 500, 46, 58, 32, 500, 56, 500, 500, 500, 44, 124, 500, 66, 500, 500, 50, 70, 500, 32, 52, 174, 500, 58, 500, 30, 44, 46, 42, 40, 500, 114, 500, 32, 50, 500, 110, 76, 500, 92, 500, 500, 38, 120, 444, 500, 82, 500, 500, 282, 500, 500, 274, 500, 56, 96, 500, 70, 500, 36, 230, 500, 48, 500, 274, 500, 500, 500, 198, 158, 60, 80, 54, 58, 40, 500, 66, 500, 28, 500, 500, 208, 500, 500, 132, 30, 500, 36, 500, 60, 500, 40, 500, 500, 324, 500, 500, 24]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3970008228011563, "mean_inference_ms": 1.2643133786828005, "mean_action_processing_ms": 0.14678930568977214, "mean_env_wait_ms": 0.08760099096943788, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018995285034179688, "StateBufferConnector_ms": 0.006998300552368164, "ViewRequirementAgentConnector_ms": 0.1330099105834961}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 492000, "num_agent_steps_trained": 492000, "num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5374.002871094886, "num_env_steps_trained_throughput_per_sec": 5374.002871094886, "timesteps_total": 492000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 492000, "timers": {"training_iteration_time_ms": 2204.226, "sample_time_ms": 1923.598, "load_time_ms": 11.701, "load_throughput": 1025594.145, "learn_time_ms": 258.05, "learn_throughput": 46502.639, "synch_weights_time_ms": 9.017}, "counters": {"num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_agent_steps_sampled": 492000, "num_agent_steps_trained": 492000}, "done": false, "episodes_total": 1830, "training_iteration": 41, "trial_id": "9f288_00019", "date": "2023-10-25_17-08-07", "timestamp": 1698250087, "time_this_iter_s": 2.2379677295684814, "time_total_s": 93.07581615447998, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 93.07581615447998, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 58.53333333333333, "ram_util_percent": 27.46666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.094947017729285e-14, "cur_lr": 0.0003, "total_loss": 6.804295508066813, "policy_loss": -3.000373641649882e-05, "vf_loss": 6.80437126159668, "vf_explained_var": -9.854634602864584e-07, "kl": 0.000161043357612319, "entropy": 0.4583712100982666, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 623.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -3.6470000000002263, "episode_len_mean": 302.0, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.3, 38.10000000000002, 5.6999999999996405, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 21.89999999999987, -50.00000000000044, -50.00000000000044, 22.699999999999882, -50.00000000000044, 44.5, 40.500000000000014, -50.00000000000044, 43.10000000000001, -50.00000000000044, 46.5, 27.099999999999945, -50.00000000000044, 45.3, -50.00000000000044, 22.699999999999882, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.29999999999999, 34.30000000000004, 44.10000000000001, 42.10000000000001, 44.7, 44.300000000000004, 46.099999999999994, -50.00000000000044, 43.50000000000001, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, 29.299999999999976, -50.00000000000044, -50.00000000000044, 36.900000000000034, 47.1, -50.00000000000044, 46.5, -50.00000000000044, 44.10000000000001, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 17.69999999999981, -50.00000000000044, -50.00000000000044, 47.7, -50.00000000000044, -50.00000000000044, 47.1, 46.099999999999994, 9.699999999999697, 11.499999999999723, -50.00000000000044, 41.70000000000002, 42.10000000000001, 13.099999999999746, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 46.5, 46.9, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 38.50000000000003, -50.00000000000044, 42.70000000000001, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 43.7, 15.699999999999783, 19.69999999999984, -50.00000000000044, 43.7, -50.00000000000044, 31.70000000000001, -50.00000000000044, 46.699999999999996, 36.50000000000003, 47.3], "episode_lengths": [500, 38, 120, 444, 500, 82, 500, 500, 282, 500, 500, 274, 500, 56, 96, 500, 70, 500, 36, 230, 500, 48, 500, 274, 500, 500, 500, 198, 158, 60, 80, 54, 58, 40, 500, 66, 500, 28, 500, 500, 208, 500, 500, 132, 30, 500, 36, 500, 60, 500, 40, 500, 500, 324, 500, 500, 24, 500, 500, 30, 40, 404, 386, 500, 84, 80, 370, 500, 500, 500, 500, 66, 500, 36, 32, 500, 34, 500, 500, 500, 500, 66, 116, 500, 74, 500, 78, 500, 500, 64, 344, 304, 500, 64, 500, 184, 500, 34, 136, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39625962458385317, "mean_inference_ms": 1.262379051837857, "mean_action_processing_ms": 0.14642927215969245, "mean_env_wait_ms": 0.08781647203337442, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02798771858215332, "StateBufferConnector_ms": 0.009996891021728516, "ViewRequirementAgentConnector_ms": 0.13903164863586426}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -3.6470000000002263, "episode_len_mean": 302.0, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.3, 38.10000000000002, 5.6999999999996405, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 21.89999999999987, -50.00000000000044, -50.00000000000044, 22.699999999999882, -50.00000000000044, 44.5, 40.500000000000014, -50.00000000000044, 43.10000000000001, -50.00000000000044, 46.5, 27.099999999999945, -50.00000000000044, 45.3, -50.00000000000044, 22.699999999999882, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.29999999999999, 34.30000000000004, 44.10000000000001, 42.10000000000001, 44.7, 44.300000000000004, 46.099999999999994, -50.00000000000044, 43.50000000000001, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, 29.299999999999976, -50.00000000000044, -50.00000000000044, 36.900000000000034, 47.1, -50.00000000000044, 46.5, -50.00000000000044, 44.10000000000001, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 17.69999999999981, -50.00000000000044, -50.00000000000044, 47.7, -50.00000000000044, -50.00000000000044, 47.1, 46.099999999999994, 9.699999999999697, 11.499999999999723, -50.00000000000044, 41.70000000000002, 42.10000000000001, 13.099999999999746, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 46.5, 46.9, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 38.50000000000003, -50.00000000000044, 42.70000000000001, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 43.7, 15.699999999999783, 19.69999999999984, -50.00000000000044, 43.7, -50.00000000000044, 31.70000000000001, -50.00000000000044, 46.699999999999996, 36.50000000000003, 47.3], "episode_lengths": [500, 38, 120, 444, 500, 82, 500, 500, 282, 500, 500, 274, 500, 56, 96, 500, 70, 500, 36, 230, 500, 48, 500, 274, 500, 500, 500, 198, 158, 60, 80, 54, 58, 40, 500, 66, 500, 28, 500, 500, 208, 500, 500, 132, 30, 500, 36, 500, 60, 500, 40, 500, 500, 324, 500, 500, 24, 500, 500, 30, 40, 404, 386, 500, 84, 80, 370, 500, 500, 500, 500, 66, 500, 36, 32, 500, 34, 500, 500, 500, 500, 66, 116, 500, 74, 500, 78, 500, 500, 64, 344, 304, 500, 64, 500, 184, 500, 34, 136, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39625962458385317, "mean_inference_ms": 1.262379051837857, "mean_action_processing_ms": 0.14642927215969245, "mean_env_wait_ms": 0.08781647203337442, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02798771858215332, "StateBufferConnector_ms": 0.009996891021728516, "ViewRequirementAgentConnector_ms": 0.13903164863586426}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5312.076435670148, "num_env_steps_trained_throughput_per_sec": 5312.076435670148, "timesteps_total": 504000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 504000, "timers": {"training_iteration_time_ms": 2211.489, "sample_time_ms": 1933.752, "load_time_ms": 11.6, "load_throughput": 1034442.924, "learn_time_ms": 255.259, "learn_throughput": 47011.086, "synch_weights_time_ms": 9.017}, "counters": {"num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000}, "done": false, "episodes_total": 1873, "training_iteration": 42, "trial_id": "9f288_00019", "date": "2023-10-25_17-08-09", "timestamp": 1698250089, "time_this_iter_s": 2.264029026031494, "time_total_s": 95.33984518051147, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 95.33984518051147, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 66.66666666666667, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.547473508864643e-14, "cur_lr": 0.0003, "total_loss": 6.471655241648356, "policy_loss": -0.0003314326827724775, "vf_loss": 6.472027397155761, "vf_explained_var": -9.49700673421224e-07, "kl": 0.0004889756340920333, "entropy": 0.40763368805249534, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 638.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_agent_steps_sampled": 516000, "num_agent_steps_trained": 516000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.439999999999807, "episode_len_mean": 266.2, "episode_media": {}, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.099999999999994, -50.00000000000044, -50.00000000000044, 17.69999999999981, -50.00000000000044, -50.00000000000044, 47.7, -50.00000000000044, -50.00000000000044, 47.1, 46.099999999999994, 9.699999999999697, 11.499999999999723, -50.00000000000044, 41.70000000000002, 42.10000000000001, 13.099999999999746, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 46.5, 46.9, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 38.50000000000003, -50.00000000000044, 42.70000000000001, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 43.7, 15.699999999999783, 19.69999999999984, -50.00000000000044, 43.7, -50.00000000000044, 31.70000000000001, -50.00000000000044, 46.699999999999996, 36.50000000000003, 47.3, -50.00000000000044, 42.70000000000001, 7.499999999999666, 38.50000000000003, -50.00000000000044, 41.500000000000014, -50.00000000000044, 45.7, -50.00000000000044, 41.30000000000001, 45.7, -50.00000000000044, 44.7, 12.499999999999737, -50.00000000000044, 36.70000000000003, 36.900000000000034, -50.00000000000044, -50.00000000000044, 46.099999999999994, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.099999999999888, 40.90000000000002, 43.10000000000001, 36.900000000000034, -50.00000000000044, 41.500000000000014, 43.900000000000006, 44.900000000000006, 45.5, 43.50000000000001, -50.00000000000044, 45.5, 46.3, 45.5, 42.900000000000006, 45.9, -50.00000000000044, 47.5, -50.00000000000044, 37.10000000000003, 46.5, 42.900000000000006, -50.00000000000044, 47.9, 44.5, 46.699999999999996], "episode_lengths": [40, 500, 500, 324, 500, 500, 24, 500, 500, 30, 40, 404, 386, 500, 84, 80, 370, 500, 500, 500, 500, 66, 500, 36, 32, 500, 34, 500, 500, 500, 500, 66, 116, 500, 74, 500, 78, 500, 500, 64, 344, 304, 500, 64, 500, 184, 500, 34, 136, 28, 500, 74, 426, 116, 500, 86, 500, 44, 500, 88, 44, 500, 54, 376, 500, 134, 132, 500, 500, 40, 68, 500, 500, 500, 270, 92, 70, 132, 500, 86, 62, 52, 46, 66, 500, 46, 38, 46, 72, 42, 500, 26, 500, 130, 36, 72, 500, 22, 56, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39615031444948834, "mean_inference_ms": 1.262000692533841, "mean_action_processing_ms": 0.14632418161300795, "mean_env_wait_ms": 0.08773532479887375, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023993492126464844, "StateBufferConnector_ms": 0.006999015808105469, "ViewRequirementAgentConnector_ms": 0.1329936981201172}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.439999999999807, "episode_len_mean": 266.2, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.099999999999994, -50.00000000000044, -50.00000000000044, 17.69999999999981, -50.00000000000044, -50.00000000000044, 47.7, -50.00000000000044, -50.00000000000044, 47.1, 46.099999999999994, 9.699999999999697, 11.499999999999723, -50.00000000000044, 41.70000000000002, 42.10000000000001, 13.099999999999746, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 46.5, 46.9, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 38.50000000000003, -50.00000000000044, 42.70000000000001, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 43.7, 15.699999999999783, 19.69999999999984, -50.00000000000044, 43.7, -50.00000000000044, 31.70000000000001, -50.00000000000044, 46.699999999999996, 36.50000000000003, 47.3, -50.00000000000044, 42.70000000000001, 7.499999999999666, 38.50000000000003, -50.00000000000044, 41.500000000000014, -50.00000000000044, 45.7, -50.00000000000044, 41.30000000000001, 45.7, -50.00000000000044, 44.7, 12.499999999999737, -50.00000000000044, 36.70000000000003, 36.900000000000034, -50.00000000000044, -50.00000000000044, 46.099999999999994, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.099999999999888, 40.90000000000002, 43.10000000000001, 36.900000000000034, -50.00000000000044, 41.500000000000014, 43.900000000000006, 44.900000000000006, 45.5, 43.50000000000001, -50.00000000000044, 45.5, 46.3, 45.5, 42.900000000000006, 45.9, -50.00000000000044, 47.5, -50.00000000000044, 37.10000000000003, 46.5, 42.900000000000006, -50.00000000000044, 47.9, 44.5, 46.699999999999996], "episode_lengths": [40, 500, 500, 324, 500, 500, 24, 500, 500, 30, 40, 404, 386, 500, 84, 80, 370, 500, 500, 500, 500, 66, 500, 36, 32, 500, 34, 500, 500, 500, 500, 66, 116, 500, 74, 500, 78, 500, 500, 64, 344, 304, 500, 64, 500, 184, 500, 34, 136, 28, 500, 74, 426, 116, 500, 86, 500, 44, 500, 88, 44, 500, 54, 376, 500, 134, 132, 500, 500, 40, 68, 500, 500, 500, 270, 92, 70, 132, 500, 86, 62, 52, 46, 66, 500, 46, 38, 46, 72, 42, 500, 26, 500, 130, 36, 72, 500, 22, 56, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39615031444948834, "mean_inference_ms": 1.262000692533841, "mean_action_processing_ms": 0.14632418161300795, "mean_env_wait_ms": 0.08773532479887375, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023993492126464844, "StateBufferConnector_ms": 0.006999015808105469, "ViewRequirementAgentConnector_ms": 0.1329936981201172}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 516000, "num_agent_steps_trained": 516000, "num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5760.917284726961, "num_env_steps_trained_throughput_per_sec": 5760.917284726961, "timesteps_total": 516000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 516000, "timers": {"training_iteration_time_ms": 2191.66, "sample_time_ms": 1925.915, "load_time_ms": 11.4, "load_throughput": 1052593.398, "learn_time_ms": 243.332, "learn_throughput": 49315.294, "synch_weights_time_ms": 9.151}, "counters": {"num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_agent_steps_sampled": 516000, "num_agent_steps_trained": 516000}, "done": false, "episodes_total": 1923, "training_iteration": 43, "trial_id": "9f288_00019", "date": "2023-10-25_17-08-11", "timestamp": 1698250091, "time_this_iter_s": 2.0890004634857178, "time_total_s": 97.42884564399719, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 97.42884564399719, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 56.199999999999996, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.2737367544323214e-14, "cur_lr": 0.0003, "total_loss": 6.346218744913737, "policy_loss": -8.439893523852031e-05, "vf_loss": 6.346345488230387, "vf_explained_var": -2.5510787963867186e-06, "kl": 0.00037448641759283416, "entropy": 0.4231229603290558, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 653.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.9769999999998116, "episode_len_mean": 265.84, "episode_media": {}, "episodes_this_iter": 36, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.30000000000001, -50.00000000000044, -50.00000000000044, 43.7, 15.699999999999783, 19.69999999999984, -50.00000000000044, 43.7, -50.00000000000044, 31.70000000000001, -50.00000000000044, 46.699999999999996, 36.50000000000003, 47.3, -50.00000000000044, 42.70000000000001, 7.499999999999666, 38.50000000000003, -50.00000000000044, 41.500000000000014, -50.00000000000044, 45.7, -50.00000000000044, 41.30000000000001, 45.7, -50.00000000000044, 44.7, 12.499999999999737, -50.00000000000044, 36.70000000000003, 36.900000000000034, -50.00000000000044, -50.00000000000044, 46.099999999999994, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.099999999999888, 40.90000000000002, 43.10000000000001, 36.900000000000034, -50.00000000000044, 41.500000000000014, 43.900000000000006, 44.900000000000006, 45.5, 43.50000000000001, -50.00000000000044, 45.5, 46.3, 45.5, 42.900000000000006, 45.9, -50.00000000000044, 47.5, -50.00000000000044, 37.10000000000003, 46.5, 42.900000000000006, -50.00000000000044, 47.9, 44.5, 46.699999999999996, -50.00000000000044, 42.70000000000001, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 39.300000000000026, 24.899999999999913, 14.699999999999768, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 8.49999999999968, 47.7, -50.00000000000044, -50.00000000000044, 34.70000000000004, -50.00000000000044, 44.7, 21.09999999999986, 47.7, 22.899999999999885, 45.9, 23.499999999999893, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 38.90000000000002, -50.00000000000044, 43.7], "episode_lengths": [78, 500, 500, 64, 344, 304, 500, 64, 500, 184, 500, 34, 136, 28, 500, 74, 426, 116, 500, 86, 500, 44, 500, 88, 44, 500, 54, 376, 500, 134, 132, 500, 500, 40, 68, 500, 500, 500, 270, 92, 70, 132, 500, 86, 62, 52, 46, 66, 500, 46, 38, 46, 72, 42, 500, 26, 500, 130, 36, 72, 500, 22, 56, 34, 500, 74, 38, 500, 500, 500, 500, 500, 500, 74, 108, 252, 354, 500, 500, 500, 500, 416, 24, 500, 500, 154, 500, 54, 290, 24, 272, 42, 266, 500, 500, 52, 500, 112, 500, 64]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39580672400380706, "mean_inference_ms": 1.2604840345777402, "mean_action_processing_ms": 0.14584144024597578, "mean_env_wait_ms": 0.08756299022639537, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024003982543945312, "StateBufferConnector_ms": 0.0070040225982666016, "ViewRequirementAgentConnector_ms": 0.10999512672424316}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.9769999999998116, "episode_len_mean": 265.84, "episodes_this_iter": 36, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.30000000000001, -50.00000000000044, -50.00000000000044, 43.7, 15.699999999999783, 19.69999999999984, -50.00000000000044, 43.7, -50.00000000000044, 31.70000000000001, -50.00000000000044, 46.699999999999996, 36.50000000000003, 47.3, -50.00000000000044, 42.70000000000001, 7.499999999999666, 38.50000000000003, -50.00000000000044, 41.500000000000014, -50.00000000000044, 45.7, -50.00000000000044, 41.30000000000001, 45.7, -50.00000000000044, 44.7, 12.499999999999737, -50.00000000000044, 36.70000000000003, 36.900000000000034, -50.00000000000044, -50.00000000000044, 46.099999999999994, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.099999999999888, 40.90000000000002, 43.10000000000001, 36.900000000000034, -50.00000000000044, 41.500000000000014, 43.900000000000006, 44.900000000000006, 45.5, 43.50000000000001, -50.00000000000044, 45.5, 46.3, 45.5, 42.900000000000006, 45.9, -50.00000000000044, 47.5, -50.00000000000044, 37.10000000000003, 46.5, 42.900000000000006, -50.00000000000044, 47.9, 44.5, 46.699999999999996, -50.00000000000044, 42.70000000000001, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 39.300000000000026, 24.899999999999913, 14.699999999999768, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 8.49999999999968, 47.7, -50.00000000000044, -50.00000000000044, 34.70000000000004, -50.00000000000044, 44.7, 21.09999999999986, 47.7, 22.899999999999885, 45.9, 23.499999999999893, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 38.90000000000002, -50.00000000000044, 43.7], "episode_lengths": [78, 500, 500, 64, 344, 304, 500, 64, 500, 184, 500, 34, 136, 28, 500, 74, 426, 116, 500, 86, 500, 44, 500, 88, 44, 500, 54, 376, 500, 134, 132, 500, 500, 40, 68, 500, 500, 500, 270, 92, 70, 132, 500, 86, 62, 52, 46, 66, 500, 46, 38, 46, 72, 42, 500, 26, 500, 130, 36, 72, 500, 22, 56, 34, 500, 74, 38, 500, 500, 500, 500, 500, 500, 74, 108, 252, 354, 500, 500, 500, 500, 416, 24, 500, 500, 154, 500, 54, 290, 24, 272, 42, 266, 500, 500, 52, 500, 112, 500, 64]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39580672400380706, "mean_inference_ms": 1.2604840345777402, "mean_action_processing_ms": 0.14584144024597578, "mean_env_wait_ms": 0.08756299022639537, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024003982543945312, "StateBufferConnector_ms": 0.0070040225982666016, "ViewRequirementAgentConnector_ms": 0.10999512672424316}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 6113.148450149593, "num_env_steps_trained_throughput_per_sec": 6113.148450149593, "timesteps_total": 528000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 528000, "timers": {"training_iteration_time_ms": 2179.864, "sample_time_ms": 1914.016, "load_time_ms": 11.5, "load_throughput": 1043467.358, "learn_time_ms": 243.353, "learn_throughput": 49311.047, "synch_weights_time_ms": 9.194}, "counters": {"num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "done": false, "episodes_total": 1959, "training_iteration": 44, "trial_id": "9f288_00019", "date": "2023-10-25_17-08-13", "timestamp": 1698250093, "time_this_iter_s": 1.9679760932922363, "time_total_s": 99.39682173728943, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 99.39682173728943, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 56.23333333333333, "ram_util_percent": 27.166666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1368683772161607e-14, "cur_lr": 0.0003, "total_loss": 6.036674563090006, "policy_loss": -0.0001755143205324809, "vf_loss": 6.036892255147298, "vf_explained_var": -4.569689432779948e-07, "kl": 0.00015090181697511676, "entropy": 0.42063159942626954, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 668.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.6399999999998056, "episode_len_mean": 264.18, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.50000000000001, -50.00000000000044, 45.5, 46.3, 45.5, 42.900000000000006, 45.9, -50.00000000000044, 47.5, -50.00000000000044, 37.10000000000003, 46.5, 42.900000000000006, -50.00000000000044, 47.9, 44.5, 46.699999999999996, -50.00000000000044, 42.70000000000001, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 39.300000000000026, 24.899999999999913, 14.699999999999768, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 8.49999999999968, 47.7, -50.00000000000044, -50.00000000000044, 34.70000000000004, -50.00000000000044, 44.7, 21.09999999999986, 47.7, 22.899999999999885, 45.9, 23.499999999999893, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 38.90000000000002, -50.00000000000044, 43.7, 44.10000000000001, -50.00000000000044, 46.5, 47.3, -50.00000000000044, 46.699999999999996, 42.900000000000006, 46.099999999999994, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 31.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 44.7, 44.10000000000001, 46.9, 47.1, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 39.300000000000026, 46.699999999999996, 37.70000000000003, -50.00000000000044, 46.099999999999994, -50.00000000000044, 43.900000000000006, 33.30000000000003, -50.00000000000044, 47.7, -50.00000000000044, 23.8999999999999, -50.00000000000044, 32.100000000000016, 40.30000000000002, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 46.099999999999994, 42.30000000000001], "episode_lengths": [66, 500, 46, 38, 46, 72, 42, 500, 26, 500, 130, 36, 72, 500, 22, 56, 34, 500, 74, 38, 500, 500, 500, 500, 500, 500, 74, 108, 252, 354, 500, 500, 500, 500, 416, 24, 500, 500, 154, 500, 54, 290, 24, 272, 42, 266, 500, 500, 52, 500, 112, 500, 64, 60, 500, 36, 28, 500, 34, 72, 40, 500, 54, 500, 500, 184, 500, 500, 500, 60, 54, 60, 32, 30, 500, 56, 500, 500, 108, 34, 124, 500, 40, 500, 62, 168, 500, 24, 500, 262, 500, 180, 98, 500, 500, 44, 500, 500, 40, 78]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3949039262733362, "mean_inference_ms": 1.2570976793572886, "mean_action_processing_ms": 0.14558412463835246, "mean_env_wait_ms": 0.08744285207214947, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.033997297286987305, "StateBufferConnector_ms": 0.0070073604583740234, "ViewRequirementAgentConnector_ms": 0.11799454689025879}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.6399999999998056, "episode_len_mean": 264.18, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.50000000000001, -50.00000000000044, 45.5, 46.3, 45.5, 42.900000000000006, 45.9, -50.00000000000044, 47.5, -50.00000000000044, 37.10000000000003, 46.5, 42.900000000000006, -50.00000000000044, 47.9, 44.5, 46.699999999999996, -50.00000000000044, 42.70000000000001, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 39.300000000000026, 24.899999999999913, 14.699999999999768, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 8.49999999999968, 47.7, -50.00000000000044, -50.00000000000044, 34.70000000000004, -50.00000000000044, 44.7, 21.09999999999986, 47.7, 22.899999999999885, 45.9, 23.499999999999893, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 38.90000000000002, -50.00000000000044, 43.7, 44.10000000000001, -50.00000000000044, 46.5, 47.3, -50.00000000000044, 46.699999999999996, 42.900000000000006, 46.099999999999994, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 31.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 44.7, 44.10000000000001, 46.9, 47.1, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 39.300000000000026, 46.699999999999996, 37.70000000000003, -50.00000000000044, 46.099999999999994, -50.00000000000044, 43.900000000000006, 33.30000000000003, -50.00000000000044, 47.7, -50.00000000000044, 23.8999999999999, -50.00000000000044, 32.100000000000016, 40.30000000000002, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 46.099999999999994, 42.30000000000001], "episode_lengths": [66, 500, 46, 38, 46, 72, 42, 500, 26, 500, 130, 36, 72, 500, 22, 56, 34, 500, 74, 38, 500, 500, 500, 500, 500, 500, 74, 108, 252, 354, 500, 500, 500, 500, 416, 24, 500, 500, 154, 500, 54, 290, 24, 272, 42, 266, 500, 500, 52, 500, 112, 500, 64, 60, 500, 36, 28, 500, 34, 72, 40, 500, 54, 500, 500, 184, 500, 500, 500, 60, 54, 60, 32, 30, 500, 56, 500, 500, 108, 34, 124, 500, 40, 500, 62, 168, 500, 24, 500, 262, 500, 180, 98, 500, 500, 44, 500, 500, 40, 78]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3949039262733362, "mean_inference_ms": 1.2570976793572886, "mean_action_processing_ms": 0.14558412463835246, "mean_env_wait_ms": 0.08744285207214947, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.033997297286987305, "StateBufferConnector_ms": 0.0070073604583740234, "ViewRequirementAgentConnector_ms": 0.11799454689025879}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5484.420147528577, "num_env_steps_trained_throughput_per_sec": 5484.420147528577, "timesteps_total": 540000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 540000, "timers": {"training_iteration_time_ms": 2177.229, "sample_time_ms": 1907.744, "load_time_ms": 11.099, "load_throughput": 1081166.41, "learn_time_ms": 247.36, "learn_throughput": 48512.221, "synch_weights_time_ms": 9.324}, "counters": {"num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000}, "done": false, "episodes_total": 2006, "training_iteration": 45, "trial_id": "9f288_00019", "date": "2023-10-25_17-08-15", "timestamp": 1698250095, "time_this_iter_s": 2.192999839782715, "time_total_s": 101.58982157707214, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 101.58982157707214, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 58.26666666666667, "ram_util_percent": 27.133333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.684341886080803e-15, "cur_lr": 0.0003, "total_loss": 6.366667779286702, "policy_loss": 4.8120816548665365e-06, "vf_loss": 6.366707897186279, "vf_explained_var": -1.3907750447591147e-07, "kl": 0.0004155538066849355, "entropy": 0.44964155157407126, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 683.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.6029999999998026, "episode_len_mean": 269.52, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.9, 23.499999999999893, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 38.90000000000002, -50.00000000000044, 43.7, 44.10000000000001, -50.00000000000044, 46.5, 47.3, -50.00000000000044, 46.699999999999996, 42.900000000000006, 46.099999999999994, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 31.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 44.7, 44.10000000000001, 46.9, 47.1, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 39.300000000000026, 46.699999999999996, 37.70000000000003, -50.00000000000044, 46.099999999999994, -50.00000000000044, 43.900000000000006, 33.30000000000003, -50.00000000000044, 47.7, -50.00000000000044, 23.8999999999999, -50.00000000000044, 32.100000000000016, 40.30000000000002, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 46.099999999999994, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 43.50000000000001, 38.90000000000002, -50.00000000000044, 43.30000000000001, 47.1, -50.00000000000044, 36.10000000000004, -50.00000000000044, 43.50000000000001, 44.10000000000001, 37.70000000000003, -50.00000000000044, -50.00000000000044, 35.70000000000003, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.30000000000004, 44.900000000000006, 47.7, -50.00000000000044, -50.00000000000044, 45.7, 46.099999999999994, 45.1, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 41.90000000000001, 19.899999999999842, -50.00000000000044, -50.00000000000044, 43.7, 45.3, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044], "episode_lengths": [42, 266, 500, 500, 52, 500, 112, 500, 64, 60, 500, 36, 28, 500, 34, 72, 40, 500, 54, 500, 500, 184, 500, 500, 500, 60, 54, 60, 32, 30, 500, 56, 500, 500, 108, 34, 124, 500, 40, 500, 62, 168, 500, 24, 500, 262, 500, 180, 98, 500, 500, 44, 500, 500, 40, 78, 500, 500, 500, 32, 66, 112, 500, 68, 30, 500, 140, 500, 66, 60, 124, 500, 500, 144, 52, 500, 500, 500, 158, 52, 24, 500, 500, 44, 40, 50, 500, 60, 500, 500, 82, 302, 500, 500, 64, 48, 500, 36, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3941441830938173, "mean_inference_ms": 1.25375208979852, "mean_action_processing_ms": 0.14532823274027543, "mean_env_wait_ms": 0.08713010808661042, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03099513053894043, "StateBufferConnector_ms": 0.003000974655151367, "ViewRequirementAgentConnector_ms": 0.1159970760345459}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.6029999999998026, "episode_len_mean": 269.52, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.9, 23.499999999999893, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 38.90000000000002, -50.00000000000044, 43.7, 44.10000000000001, -50.00000000000044, 46.5, 47.3, -50.00000000000044, 46.699999999999996, 42.900000000000006, 46.099999999999994, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 31.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 44.7, 44.10000000000001, 46.9, 47.1, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 39.300000000000026, 46.699999999999996, 37.70000000000003, -50.00000000000044, 46.099999999999994, -50.00000000000044, 43.900000000000006, 33.30000000000003, -50.00000000000044, 47.7, -50.00000000000044, 23.8999999999999, -50.00000000000044, 32.100000000000016, 40.30000000000002, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 46.099999999999994, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 43.50000000000001, 38.90000000000002, -50.00000000000044, 43.30000000000001, 47.1, -50.00000000000044, 36.10000000000004, -50.00000000000044, 43.50000000000001, 44.10000000000001, 37.70000000000003, -50.00000000000044, -50.00000000000044, 35.70000000000003, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.30000000000004, 44.900000000000006, 47.7, -50.00000000000044, -50.00000000000044, 45.7, 46.099999999999994, 45.1, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 41.90000000000001, 19.899999999999842, -50.00000000000044, -50.00000000000044, 43.7, 45.3, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044], "episode_lengths": [42, 266, 500, 500, 52, 500, 112, 500, 64, 60, 500, 36, 28, 500, 34, 72, 40, 500, 54, 500, 500, 184, 500, 500, 500, 60, 54, 60, 32, 30, 500, 56, 500, 500, 108, 34, 124, 500, 40, 500, 62, 168, 500, 24, 500, 262, 500, 180, 98, 500, 500, 44, 500, 500, 40, 78, 500, 500, 500, 32, 66, 112, 500, 68, 30, 500, 140, 500, 66, 60, 124, 500, 500, 144, 52, 500, 500, 500, 158, 52, 24, 500, 500, 44, 40, 50, 500, 60, 500, 500, 82, 302, 500, 500, 64, 48, 500, 36, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3941441830938173, "mean_inference_ms": 1.25375208979852, "mean_action_processing_ms": 0.14532823274027543, "mean_env_wait_ms": 0.08713010808661042, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03099513053894043, "StateBufferConnector_ms": 0.003000974655151367, "ViewRequirementAgentConnector_ms": 0.1159970760345459}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000, "num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5905.5164728947075, "num_env_steps_trained_throughput_per_sec": 5905.5164728947075, "timesteps_total": 552000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 552000, "timers": {"training_iteration_time_ms": 2162.3, "sample_time_ms": 1901.993, "load_time_ms": 10.999, "load_throughput": 1090973.976, "learn_time_ms": 238.385, "learn_throughput": 50338.816, "synch_weights_time_ms": 9.321}, "counters": {"num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000}, "done": false, "episodes_total": 2050, "training_iteration": 46, "trial_id": "9f288_00019", "date": "2023-10-25_17-08-17", "timestamp": 1698250097, "time_this_iter_s": 2.0369975566864014, "time_total_s": 103.62681913375854, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 103.62681913375854, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 60.5, "ram_util_percent": 27.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.8421709430404017e-15, "cur_lr": 0.0003, "total_loss": 6.1620762825012205, "policy_loss": -0.000506965567668279, "vf_loss": 6.1626335144042965, "vf_explained_var": -8.900960286458333e-07, "kl": 0.0004991404997800448, "entropy": 0.5024061381816864, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 698.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_agent_steps_sampled": 564000, "num_agent_steps_trained": 564000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.5690000000002073, "episode_len_mean": 281.22, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 23.8999999999999, -50.00000000000044, 32.100000000000016, 40.30000000000002, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 46.099999999999994, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 43.50000000000001, 38.90000000000002, -50.00000000000044, 43.30000000000001, 47.1, -50.00000000000044, 36.10000000000004, -50.00000000000044, 43.50000000000001, 44.10000000000001, 37.70000000000003, -50.00000000000044, -50.00000000000044, 35.70000000000003, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.30000000000004, 44.900000000000006, 47.7, -50.00000000000044, -50.00000000000044, 45.7, 46.099999999999994, 45.1, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 41.90000000000001, 19.899999999999842, -50.00000000000044, -50.00000000000044, 43.7, 45.3, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 41.500000000000014, 42.30000000000001, 44.7, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 30.699999999999996, 45.7, -50.00000000000044, 32.90000000000003, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 27.49999999999995, -50.00000000000044, 46.9, -50.00000000000044, 46.5, 47.1, 44.10000000000001, -50.00000000000044, 46.3, -50.00000000000044, 27.49999999999995, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 44.7, 46.3, 40.500000000000014, 35.30000000000004, 41.90000000000001], "episode_lengths": [500, 262, 500, 180, 98, 500, 500, 44, 500, 500, 40, 78, 500, 500, 500, 32, 66, 112, 500, 68, 30, 500, 140, 500, 66, 60, 124, 500, 500, 144, 52, 500, 500, 500, 158, 52, 24, 500, 500, 44, 40, 50, 500, 60, 500, 500, 82, 302, 500, 500, 64, 48, 500, 36, 500, 500, 500, 70, 86, 78, 54, 500, 500, 68, 500, 500, 36, 500, 194, 44, 500, 172, 500, 500, 32, 500, 226, 500, 32, 500, 36, 30, 60, 500, 38, 500, 226, 500, 500, 500, 130, 500, 500, 500, 36, 54, 38, 96, 148, 82]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39433220998470886, "mean_inference_ms": 1.253311318214913, "mean_action_processing_ms": 0.1450082048917832, "mean_env_wait_ms": 0.08695503988708164, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024996519088745117, "StateBufferConnector_ms": 0.0010001659393310547, "ViewRequirementAgentConnector_ms": 0.12099981307983398}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.5690000000002073, "episode_len_mean": 281.22, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 23.8999999999999, -50.00000000000044, 32.100000000000016, 40.30000000000002, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 46.099999999999994, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 43.50000000000001, 38.90000000000002, -50.00000000000044, 43.30000000000001, 47.1, -50.00000000000044, 36.10000000000004, -50.00000000000044, 43.50000000000001, 44.10000000000001, 37.70000000000003, -50.00000000000044, -50.00000000000044, 35.70000000000003, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.30000000000004, 44.900000000000006, 47.7, -50.00000000000044, -50.00000000000044, 45.7, 46.099999999999994, 45.1, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 41.90000000000001, 19.899999999999842, -50.00000000000044, -50.00000000000044, 43.7, 45.3, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 41.500000000000014, 42.30000000000001, 44.7, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 30.699999999999996, 45.7, -50.00000000000044, 32.90000000000003, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 27.49999999999995, -50.00000000000044, 46.9, -50.00000000000044, 46.5, 47.1, 44.10000000000001, -50.00000000000044, 46.3, -50.00000000000044, 27.49999999999995, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 44.7, 46.3, 40.500000000000014, 35.30000000000004, 41.90000000000001], "episode_lengths": [500, 262, 500, 180, 98, 500, 500, 44, 500, 500, 40, 78, 500, 500, 500, 32, 66, 112, 500, 68, 30, 500, 140, 500, 66, 60, 124, 500, 500, 144, 52, 500, 500, 500, 158, 52, 24, 500, 500, 44, 40, 50, 500, 60, 500, 500, 82, 302, 500, 500, 64, 48, 500, 36, 500, 500, 500, 70, 86, 78, 54, 500, 500, 68, 500, 500, 36, 500, 194, 44, 500, 172, 500, 500, 32, 500, 226, 500, 32, 500, 36, 30, 60, 500, 38, 500, 226, 500, 500, 500, 130, 500, 500, 500, 36, 54, 38, 96, 148, 82]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39433220998470886, "mean_inference_ms": 1.253311318214913, "mean_action_processing_ms": 0.1450082048917832, "mean_env_wait_ms": 0.08695503988708164, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024996519088745117, "StateBufferConnector_ms": 0.0010001659393310547, "ViewRequirementAgentConnector_ms": 0.12099981307983398}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 564000, "num_agent_steps_trained": 564000, "num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5636.354494372396, "num_env_steps_trained_throughput_per_sec": 5636.354494372396, "timesteps_total": 564000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 564000, "timers": {"training_iteration_time_ms": 2151.283, "sample_time_ms": 1898.396, "load_time_ms": 10.499, "load_throughput": 1142927.005, "learn_time_ms": 231.463, "learn_throughput": 51844.128, "synch_weights_time_ms": 9.319}, "counters": {"num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_agent_steps_sampled": 564000, "num_agent_steps_trained": 564000}, "done": false, "episodes_total": 2094, "training_iteration": 47, "trial_id": "9f288_00019", "date": "2023-10-25_17-08-19", "timestamp": 1698250099, "time_this_iter_s": 2.134000062942505, "time_total_s": 105.76081919670105, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 105.76081919670105, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 58.800000000000004, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.4210854715202008e-15, "cur_lr": 0.0003, "total_loss": 5.996176052093506, "policy_loss": -0.00032698834935824075, "vf_loss": 5.996549034118653, "vf_explained_var": 2.106030782063802e-07, "kl": 0.0005178962125190386, "entropy": 0.4616517504056295, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 713.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -3.211000000000218, "episode_len_mean": 287.62, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.099999999999994, 45.1, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 41.90000000000001, 19.899999999999842, -50.00000000000044, -50.00000000000044, 43.7, 45.3, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 41.500000000000014, 42.30000000000001, 44.7, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 30.699999999999996, 45.7, -50.00000000000044, 32.90000000000003, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 27.49999999999995, -50.00000000000044, 46.9, -50.00000000000044, 46.5, 47.1, 44.10000000000001, -50.00000000000044, 46.3, -50.00000000000044, 27.49999999999995, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 44.7, 46.3, 40.500000000000014, 35.30000000000004, 41.90000000000001, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 42.500000000000014, 45.1, 43.7, -50.00000000000044, 47.1, 40.70000000000002, 45.7, -50.00000000000044, 26.89999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 43.7, -50.00000000000044, 45.3, 41.90000000000001, 20.899999999999856, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 44.300000000000004, -50.00000000000044, 44.10000000000001, 45.9], "episode_lengths": [40, 50, 500, 60, 500, 500, 82, 302, 500, 500, 64, 48, 500, 36, 500, 500, 500, 70, 86, 78, 54, 500, 500, 68, 500, 500, 36, 500, 194, 44, 500, 172, 500, 500, 32, 500, 226, 500, 32, 500, 36, 30, 60, 500, 38, 500, 226, 500, 500, 500, 130, 500, 500, 500, 36, 54, 38, 96, 148, 82, 500, 500, 48, 500, 48, 500, 500, 76, 50, 64, 500, 30, 94, 44, 500, 232, 500, 500, 500, 36, 64, 500, 48, 82, 292, 500, 500, 500, 96, 500, 500, 500, 500, 500, 500, 50, 58, 500, 60, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3938044604714747, "mean_inference_ms": 1.2521573344373431, "mean_action_processing_ms": 0.1449126470264568, "mean_env_wait_ms": 0.0869399231784047, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02699875831604004, "StateBufferConnector_ms": 0.002996683120727539, "ViewRequirementAgentConnector_ms": 0.1209859848022461}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -3.211000000000218, "episode_len_mean": 287.62, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.099999999999994, 45.1, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 41.90000000000001, 19.899999999999842, -50.00000000000044, -50.00000000000044, 43.7, 45.3, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 41.500000000000014, 42.30000000000001, 44.7, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 30.699999999999996, 45.7, -50.00000000000044, 32.90000000000003, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 27.49999999999995, -50.00000000000044, 46.9, -50.00000000000044, 46.5, 47.1, 44.10000000000001, -50.00000000000044, 46.3, -50.00000000000044, 27.49999999999995, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 44.7, 46.3, 40.500000000000014, 35.30000000000004, 41.90000000000001, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 42.500000000000014, 45.1, 43.7, -50.00000000000044, 47.1, 40.70000000000002, 45.7, -50.00000000000044, 26.89999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 43.7, -50.00000000000044, 45.3, 41.90000000000001, 20.899999999999856, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 44.300000000000004, -50.00000000000044, 44.10000000000001, 45.9], "episode_lengths": [40, 50, 500, 60, 500, 500, 82, 302, 500, 500, 64, 48, 500, 36, 500, 500, 500, 70, 86, 78, 54, 500, 500, 68, 500, 500, 36, 500, 194, 44, 500, 172, 500, 500, 32, 500, 226, 500, 32, 500, 36, 30, 60, 500, 38, 500, 226, 500, 500, 500, 130, 500, 500, 500, 36, 54, 38, 96, 148, 82, 500, 500, 48, 500, 48, 500, 500, 76, 50, 64, 500, 30, 94, 44, 500, 232, 500, 500, 500, 36, 64, 500, 48, 82, 292, 500, 500, 500, 96, 500, 500, 500, 500, 500, 500, 50, 58, 500, 60, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3938044604714747, "mean_inference_ms": 1.2521573344373431, "mean_action_processing_ms": 0.1449126470264568, "mean_env_wait_ms": 0.0869399231784047, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02699875831604004, "StateBufferConnector_ms": 0.002996683120727539, "ViewRequirementAgentConnector_ms": 0.1209859848022461}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5586.643641524374, "num_env_steps_trained_throughput_per_sec": 5586.643641524374, "timesteps_total": 576000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 576000, "timers": {"training_iteration_time_ms": 2146.697, "sample_time_ms": 1886.391, "load_time_ms": 11.299, "load_throughput": 1062008.191, "learn_time_ms": 238.009, "learn_throughput": 50418.317, "synch_weights_time_ms": 9.393}, "counters": {"num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "done": false, "episodes_total": 2134, "training_iteration": 48, "trial_id": "9f288_00019", "date": "2023-10-25_17-08-22", "timestamp": 1698250102, "time_this_iter_s": 2.1539700031280518, "time_total_s": 107.9147891998291, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 107.9147891998291, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 56.6, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.105427357601004e-16, "cur_lr": 0.0003, "total_loss": 6.844681104024251, "policy_loss": -5.8818360169728594e-05, "vf_loss": 6.844786898295085, "vf_explained_var": -5.205472310384114e-07, "kl": 0.00013405841248944247, "entropy": 0.46977938413619996, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 728.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 588000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.6800000000002182, "episode_len_mean": 287.34, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 27.49999999999995, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 44.7, 46.3, 40.500000000000014, 35.30000000000004, 41.90000000000001, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 42.500000000000014, 45.1, 43.7, -50.00000000000044, 47.1, 40.70000000000002, 45.7, -50.00000000000044, 26.89999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 43.7, -50.00000000000044, 45.3, 41.90000000000001, 20.899999999999856, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 44.300000000000004, -50.00000000000044, 44.10000000000001, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 4.499999999999623, 43.7, 43.7, -50.00000000000044, 26.89999999999994, 43.30000000000001, -50.00000000000044, 7.899999999999672, 46.699999999999996, 46.099999999999994, 8.299999999999677, 44.7, 45.3, 45.5, -50.00000000000044, 45.7, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 47.3, 39.300000000000026, 41.70000000000002, -50.00000000000044, 45.7, 16.8999999999998, -50.00000000000044, -50.00000000000044, 37.90000000000003, 42.900000000000006, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 11.899999999999729, -50.00000000000044, 44.7, 44.10000000000001, -50.00000000000044], "episode_lengths": [500, 226, 500, 500, 500, 130, 500, 500, 500, 36, 54, 38, 96, 148, 82, 500, 500, 48, 500, 48, 500, 500, 76, 50, 64, 500, 30, 94, 44, 500, 232, 500, 500, 500, 36, 64, 500, 48, 82, 292, 500, 500, 500, 96, 500, 500, 500, 500, 500, 500, 50, 58, 500, 60, 42, 500, 500, 500, 26, 456, 64, 64, 500, 232, 68, 500, 422, 34, 40, 418, 54, 48, 46, 500, 44, 34, 500, 500, 500, 34, 500, 28, 108, 84, 500, 44, 332, 500, 500, 122, 72, 40, 500, 500, 500, 382, 500, 54, 60, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3932848261190019, "mean_inference_ms": 1.2533167926854378, "mean_action_processing_ms": 0.1452360133801887, "mean_env_wait_ms": 0.08722415891366139, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028997182846069336, "StateBufferConnector_ms": 0.004997968673706055, "ViewRequirementAgentConnector_ms": 0.14099574089050293}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.6800000000002182, "episode_len_mean": 287.34, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 27.49999999999995, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 44.7, 46.3, 40.500000000000014, 35.30000000000004, 41.90000000000001, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 42.500000000000014, 45.1, 43.7, -50.00000000000044, 47.1, 40.70000000000002, 45.7, -50.00000000000044, 26.89999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 43.7, -50.00000000000044, 45.3, 41.90000000000001, 20.899999999999856, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 44.300000000000004, -50.00000000000044, 44.10000000000001, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 4.499999999999623, 43.7, 43.7, -50.00000000000044, 26.89999999999994, 43.30000000000001, -50.00000000000044, 7.899999999999672, 46.699999999999996, 46.099999999999994, 8.299999999999677, 44.7, 45.3, 45.5, -50.00000000000044, 45.7, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 47.3, 39.300000000000026, 41.70000000000002, -50.00000000000044, 45.7, 16.8999999999998, -50.00000000000044, -50.00000000000044, 37.90000000000003, 42.900000000000006, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 11.899999999999729, -50.00000000000044, 44.7, 44.10000000000001, -50.00000000000044], "episode_lengths": [500, 226, 500, 500, 500, 130, 500, 500, 500, 36, 54, 38, 96, 148, 82, 500, 500, 48, 500, 48, 500, 500, 76, 50, 64, 500, 30, 94, 44, 500, 232, 500, 500, 500, 36, 64, 500, 48, 82, 292, 500, 500, 500, 96, 500, 500, 500, 500, 500, 500, 50, 58, 500, 60, 42, 500, 500, 500, 26, 456, 64, 64, 500, 232, 68, 500, 422, 34, 40, 418, 54, 48, 46, 500, 44, 34, 500, 500, 500, 34, 500, 28, 108, 84, 500, 44, 332, 500, 500, 122, 72, 40, 500, 500, 500, 382, 500, 54, 60, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3932848261190019, "mean_inference_ms": 1.2533167926854378, "mean_action_processing_ms": 0.1452360133801887, "mean_env_wait_ms": 0.08722415891366139, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028997182846069336, "StateBufferConnector_ms": 0.004997968673706055, "ViewRequirementAgentConnector_ms": 0.14099574089050293}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 588000, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4789.969885941922, "num_env_steps_trained_throughput_per_sec": 4789.969885941922, "timesteps_total": 588000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 588000, "timers": {"training_iteration_time_ms": 2164.92, "sample_time_ms": 1908.39, "load_time_ms": 10.899, "load_throughput": 1100994.822, "learn_time_ms": 234.433, "learn_throughput": 51187.42, "synch_weights_time_ms": 9.493}, "counters": {"num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 588000}, "done": false, "episodes_total": 2179, "training_iteration": 49, "trial_id": "9f288_00019", "date": "2023-10-25_17-08-24", "timestamp": 1698250104, "time_this_iter_s": 2.5102338790893555, "time_total_s": 110.42502307891846, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 110.42502307891846, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 75.03333333333335, "ram_util_percent": 27.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.552713678800502e-16, "cur_lr": 0.0003, "total_loss": 6.426784547170003, "policy_loss": -0.0005539429374039173, "vf_loss": 6.427385743459066, "vf_explained_var": -1.33514404296875e-06, "kl": 0.0006702326308527518, "entropy": 0.47425700227419537, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 743.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.853999999999815, "episode_len_mean": 252.08, "episode_media": {}, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.1, 44.300000000000004, -50.00000000000044, 44.10000000000001, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 4.499999999999623, 43.7, 43.7, -50.00000000000044, 26.89999999999994, 43.30000000000001, -50.00000000000044, 7.899999999999672, 46.699999999999996, 46.099999999999994, 8.299999999999677, 44.7, 45.3, 45.5, -50.00000000000044, 45.7, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 47.3, 39.300000000000026, 41.70000000000002, -50.00000000000044, 45.7, 16.8999999999998, -50.00000000000044, -50.00000000000044, 37.90000000000003, 42.900000000000006, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 11.899999999999729, -50.00000000000044, 44.7, 44.10000000000001, -50.00000000000044, -50.00000000000044, 38.90000000000002, 46.9, -50.00000000000044, 46.699999999999996, 46.099999999999994, 15.699999999999783, -50.00000000000044, 45.5, 44.300000000000004, -50.00000000000044, 32.100000000000016, 41.30000000000001, 45.5, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 45.3, 39.70000000000002, 45.5, 44.900000000000006, 44.5, 36.900000000000034, 29.49999999999998, -50.00000000000044, 47.7, 41.100000000000016, 39.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 46.099999999999994, 42.70000000000001, -50.00000000000044, 45.1, 47.5, 27.49999999999995, -50.00000000000044, -50.00000000000044, 44.10000000000001, 45.3], "episode_lengths": [500, 50, 58, 500, 60, 42, 500, 500, 500, 26, 456, 64, 64, 500, 232, 68, 500, 422, 34, 40, 418, 54, 48, 46, 500, 44, 34, 500, 500, 500, 34, 500, 28, 108, 84, 500, 44, 332, 500, 500, 122, 72, 40, 500, 500, 500, 382, 500, 54, 60, 500, 500, 112, 32, 500, 34, 40, 344, 500, 46, 58, 500, 180, 88, 46, 500, 60, 500, 500, 72, 500, 500, 500, 500, 62, 48, 104, 46, 52, 56, 132, 206, 500, 24, 90, 106, 500, 500, 500, 26, 40, 74, 500, 50, 26, 226, 500, 500, 60, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3945550475983792, "mean_inference_ms": 1.256958965431648, "mean_action_processing_ms": 0.1455687104043093, "mean_env_wait_ms": 0.08745797704055797, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.037000417709350586, "StateBufferConnector_ms": 0.009002923965454102, "ViewRequirementAgentConnector_ms": 0.14901423454284668}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.853999999999815, "episode_len_mean": 252.08, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.1, 44.300000000000004, -50.00000000000044, 44.10000000000001, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 4.499999999999623, 43.7, 43.7, -50.00000000000044, 26.89999999999994, 43.30000000000001, -50.00000000000044, 7.899999999999672, 46.699999999999996, 46.099999999999994, 8.299999999999677, 44.7, 45.3, 45.5, -50.00000000000044, 45.7, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 47.3, 39.300000000000026, 41.70000000000002, -50.00000000000044, 45.7, 16.8999999999998, -50.00000000000044, -50.00000000000044, 37.90000000000003, 42.900000000000006, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 11.899999999999729, -50.00000000000044, 44.7, 44.10000000000001, -50.00000000000044, -50.00000000000044, 38.90000000000002, 46.9, -50.00000000000044, 46.699999999999996, 46.099999999999994, 15.699999999999783, -50.00000000000044, 45.5, 44.300000000000004, -50.00000000000044, 32.100000000000016, 41.30000000000001, 45.5, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 45.3, 39.70000000000002, 45.5, 44.900000000000006, 44.5, 36.900000000000034, 29.49999999999998, -50.00000000000044, 47.7, 41.100000000000016, 39.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 46.099999999999994, 42.70000000000001, -50.00000000000044, 45.1, 47.5, 27.49999999999995, -50.00000000000044, -50.00000000000044, 44.10000000000001, 45.3], "episode_lengths": [500, 50, 58, 500, 60, 42, 500, 500, 500, 26, 456, 64, 64, 500, 232, 68, 500, 422, 34, 40, 418, 54, 48, 46, 500, 44, 34, 500, 500, 500, 34, 500, 28, 108, 84, 500, 44, 332, 500, 500, 122, 72, 40, 500, 500, 500, 382, 500, 54, 60, 500, 500, 112, 32, 500, 34, 40, 344, 500, 46, 58, 500, 180, 88, 46, 500, 60, 500, 500, 72, 500, 500, 500, 500, 62, 48, 104, 46, 52, 56, 132, 206, 500, 24, 90, 106, 500, 500, 500, 26, 40, 74, 500, 50, 26, 226, 500, 500, 60, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3945550475983792, "mean_inference_ms": 1.256958965431648, "mean_action_processing_ms": 0.1455687104043093, "mean_env_wait_ms": 0.08745797704055797, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.037000417709350586, "StateBufferConnector_ms": 0.009002923965454102, "ViewRequirementAgentConnector_ms": 0.14901423454284668}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4519.429092587077, "num_env_steps_trained_throughput_per_sec": 4519.429092587077, "timesteps_total": 600000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 600000, "timers": {"training_iteration_time_ms": 2219.543, "sample_time_ms": 1955.191, "load_time_ms": 12.68, "load_throughput": 946353.996, "learn_time_ms": 240.37, "learn_throughput": 49922.998, "synch_weights_time_ms": 9.596}, "counters": {"num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000}, "done": false, "episodes_total": 2228, "training_iteration": 50, "trial_id": "9f288_00019", "date": "2023-10-25_17-08-27", "timestamp": 1698250107, "time_this_iter_s": 2.660353660583496, "time_total_s": 113.08537673950195, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 113.08537673950195, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 74.35, "ram_util_percent": 27.35}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.776356839400251e-16, "cur_lr": 0.0003, "total_loss": 6.88453680674235, "policy_loss": -0.00042748960355917613, "vf_loss": 6.885013930002848, "vf_explained_var": -2.7418136596679685e-07, "kl": 0.00048665809454178087, "entropy": 0.4953603267669678, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 758.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.663999999999865, "episode_len_mean": 214.06, "episode_media": {}, "episodes_this_iter": 62, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.100000000000016, 41.30000000000001, 45.5, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 45.3, 39.70000000000002, 45.5, 44.900000000000006, 44.5, 36.900000000000034, 29.49999999999998, -50.00000000000044, 47.7, 41.100000000000016, 39.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 46.099999999999994, 42.70000000000001, -50.00000000000044, 45.1, 47.5, 27.49999999999995, -50.00000000000044, -50.00000000000044, 44.10000000000001, 45.3, -50.00000000000044, 41.500000000000014, 45.1, 46.699999999999996, 29.899999999999984, 40.90000000000002, 43.30000000000001, 37.300000000000026, -50.00000000000044, 44.300000000000004, 41.30000000000001, 23.499999999999893, 36.30000000000003, 44.5, 39.90000000000002, -50.00000000000044, 45.1, 44.10000000000001, 39.10000000000002, 44.7, 9.699999999999697, 45.5, -50.00000000000044, 39.90000000000002, -50.00000000000044, 45.9, 36.900000000000034, 43.30000000000001, 46.099999999999994, 44.7, 45.1, -50.00000000000044, 47.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 39.90000000000002, 34.30000000000004, 1.6999999999995836, 41.500000000000014, -50.00000000000044, 46.699999999999996, 44.7, 46.5, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 28.09999999999996, -50.00000000000044, 32.50000000000002, 44.300000000000004, 44.900000000000006, 41.90000000000001, 45.7, -50.00000000000044, 46.3, 45.5, 46.5, 43.7], "episode_lengths": [180, 88, 46, 500, 60, 500, 500, 72, 500, 500, 500, 500, 62, 48, 104, 46, 52, 56, 132, 206, 500, 24, 90, 106, 500, 500, 500, 26, 40, 74, 500, 50, 26, 226, 500, 500, 60, 48, 500, 86, 50, 34, 202, 92, 68, 128, 500, 58, 88, 266, 138, 56, 102, 500, 50, 60, 110, 54, 404, 46, 500, 102, 500, 42, 132, 68, 40, 54, 50, 500, 24, 500, 500, 500, 72, 500, 102, 158, 484, 86, 500, 34, 54, 36, 500, 500, 38, 500, 220, 500, 176, 58, 52, 82, 44, 500, 38, 46, 36, 64]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3959879576030628, "mean_inference_ms": 1.2614291782341212, "mean_action_processing_ms": 0.14586611164103075, "mean_env_wait_ms": 0.0878084712438794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03198528289794922, "StateBufferConnector_ms": 0.009000539779663086, "ViewRequirementAgentConnector_ms": 0.13698744773864746}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.663999999999865, "episode_len_mean": 214.06, "episodes_this_iter": 62, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [32.100000000000016, 41.30000000000001, 45.5, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 45.3, 39.70000000000002, 45.5, 44.900000000000006, 44.5, 36.900000000000034, 29.49999999999998, -50.00000000000044, 47.7, 41.100000000000016, 39.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 46.099999999999994, 42.70000000000001, -50.00000000000044, 45.1, 47.5, 27.49999999999995, -50.00000000000044, -50.00000000000044, 44.10000000000001, 45.3, -50.00000000000044, 41.500000000000014, 45.1, 46.699999999999996, 29.899999999999984, 40.90000000000002, 43.30000000000001, 37.300000000000026, -50.00000000000044, 44.300000000000004, 41.30000000000001, 23.499999999999893, 36.30000000000003, 44.5, 39.90000000000002, -50.00000000000044, 45.1, 44.10000000000001, 39.10000000000002, 44.7, 9.699999999999697, 45.5, -50.00000000000044, 39.90000000000002, -50.00000000000044, 45.9, 36.900000000000034, 43.30000000000001, 46.099999999999994, 44.7, 45.1, -50.00000000000044, 47.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 39.90000000000002, 34.30000000000004, 1.6999999999995836, 41.500000000000014, -50.00000000000044, 46.699999999999996, 44.7, 46.5, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 28.09999999999996, -50.00000000000044, 32.50000000000002, 44.300000000000004, 44.900000000000006, 41.90000000000001, 45.7, -50.00000000000044, 46.3, 45.5, 46.5, 43.7], "episode_lengths": [180, 88, 46, 500, 60, 500, 500, 72, 500, 500, 500, 500, 62, 48, 104, 46, 52, 56, 132, 206, 500, 24, 90, 106, 500, 500, 500, 26, 40, 74, 500, 50, 26, 226, 500, 500, 60, 48, 500, 86, 50, 34, 202, 92, 68, 128, 500, 58, 88, 266, 138, 56, 102, 500, 50, 60, 110, 54, 404, 46, 500, 102, 500, 42, 132, 68, 40, 54, 50, 500, 24, 500, 500, 500, 72, 500, 102, 158, 484, 86, 500, 34, 54, 36, 500, 500, 38, 500, 220, 500, 176, 58, 52, 82, 44, 500, 38, 46, 36, 64]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3959879576030628, "mean_inference_ms": 1.2614291782341212, "mean_action_processing_ms": 0.14586611164103075, "mean_env_wait_ms": 0.0878084712438794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03198528289794922, "StateBufferConnector_ms": 0.009000539779663086, "ViewRequirementAgentConnector_ms": 0.13698744773864746}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000, "num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4998.827355015662, "num_env_steps_trained_throughput_per_sec": 4998.827355015662, "timesteps_total": 612000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 612000, "timers": {"training_iteration_time_ms": 2236.302, "sample_time_ms": 1986.037, "load_time_ms": 12.08, "load_throughput": 993373.412, "learn_time_ms": 227.005, "learn_throughput": 52862.376, "synch_weights_time_ms": 9.576}, "counters": {"num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000}, "done": false, "episodes_total": 2290, "training_iteration": 51, "trial_id": "9f288_00019", "date": "2023-10-25_17-08-29", "timestamp": 1698250109, "time_this_iter_s": 2.407562255859375, "time_total_s": 115.49293899536133, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 115.49293899536133, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 65.26666666666667, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.881784197001255e-17, "cur_lr": 0.0003, "total_loss": 6.48654088973999, "policy_loss": -0.00011944031963745753, "vf_loss": 6.486708609263102, "vf_explained_var": -1.2079874674479166e-06, "kl": 0.00018091395190822368, "entropy": 0.4820662558078766, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 773.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 14.030999999999862, "episode_len_mean": 215.4, "episode_media": {}, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [36.30000000000003, 44.5, 39.90000000000002, -50.00000000000044, 45.1, 44.10000000000001, 39.10000000000002, 44.7, 9.699999999999697, 45.5, -50.00000000000044, 39.90000000000002, -50.00000000000044, 45.9, 36.900000000000034, 43.30000000000001, 46.099999999999994, 44.7, 45.1, -50.00000000000044, 47.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 39.90000000000002, 34.30000000000004, 1.6999999999995836, 41.500000000000014, -50.00000000000044, 46.699999999999996, 44.7, 46.5, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 28.09999999999996, -50.00000000000044, 32.50000000000002, 44.300000000000004, 44.900000000000006, 41.90000000000001, 45.7, -50.00000000000044, 46.3, 45.5, 46.5, 43.7, -50.00000000000044, 45.5, 41.70000000000002, 46.3, -50.00000000000044, -50.00000000000044, 42.70000000000001, 40.30000000000002, 28.29999999999996, -50.00000000000044, 39.70000000000002, -50.00000000000044, 46.9, 47.3, 41.70000000000002, 43.10000000000001, 24.099999999999902, 45.7, 32.30000000000002, 46.9, 36.30000000000003, 40.70000000000002, 37.50000000000003, 46.3, 45.9, -50.00000000000044, -50.00000000000044, 43.10000000000001, 40.90000000000002, 46.3, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 46.9, 44.5, -50.00000000000044, -50.00000000000044, 33.90000000000004, 24.099999999999902, -50.00000000000044, 36.900000000000034, 46.3, 23.8999999999999, 47.5, 17.099999999999802, -50.00000000000044, 40.70000000000002, 37.50000000000003, -50.00000000000044], "episode_lengths": [138, 56, 102, 500, 50, 60, 110, 54, 404, 46, 500, 102, 500, 42, 132, 68, 40, 54, 50, 500, 24, 500, 500, 500, 72, 500, 102, 158, 484, 86, 500, 34, 54, 36, 500, 500, 38, 500, 220, 500, 176, 58, 52, 82, 44, 500, 38, 46, 36, 64, 500, 46, 84, 38, 500, 500, 74, 98, 218, 500, 104, 500, 32, 28, 84, 70, 260, 44, 178, 32, 138, 94, 126, 38, 42, 500, 500, 70, 92, 38, 500, 82, 500, 500, 32, 56, 500, 500, 162, 260, 500, 132, 38, 262, 26, 330, 500, 94, 126, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3958215302887378, "mean_inference_ms": 1.2638738376364183, "mean_action_processing_ms": 0.14646949508087087, "mean_env_wait_ms": 0.0877445368111426, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03198385238647461, "StateBufferConnector_ms": 0.007001638412475586, "ViewRequirementAgentConnector_ms": 0.1149892807006836}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 14.030999999999862, "episode_len_mean": 215.4, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [36.30000000000003, 44.5, 39.90000000000002, -50.00000000000044, 45.1, 44.10000000000001, 39.10000000000002, 44.7, 9.699999999999697, 45.5, -50.00000000000044, 39.90000000000002, -50.00000000000044, 45.9, 36.900000000000034, 43.30000000000001, 46.099999999999994, 44.7, 45.1, -50.00000000000044, 47.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 39.90000000000002, 34.30000000000004, 1.6999999999995836, 41.500000000000014, -50.00000000000044, 46.699999999999996, 44.7, 46.5, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 28.09999999999996, -50.00000000000044, 32.50000000000002, 44.300000000000004, 44.900000000000006, 41.90000000000001, 45.7, -50.00000000000044, 46.3, 45.5, 46.5, 43.7, -50.00000000000044, 45.5, 41.70000000000002, 46.3, -50.00000000000044, -50.00000000000044, 42.70000000000001, 40.30000000000002, 28.29999999999996, -50.00000000000044, 39.70000000000002, -50.00000000000044, 46.9, 47.3, 41.70000000000002, 43.10000000000001, 24.099999999999902, 45.7, 32.30000000000002, 46.9, 36.30000000000003, 40.70000000000002, 37.50000000000003, 46.3, 45.9, -50.00000000000044, -50.00000000000044, 43.10000000000001, 40.90000000000002, 46.3, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 46.9, 44.5, -50.00000000000044, -50.00000000000044, 33.90000000000004, 24.099999999999902, -50.00000000000044, 36.900000000000034, 46.3, 23.8999999999999, 47.5, 17.099999999999802, -50.00000000000044, 40.70000000000002, 37.50000000000003, -50.00000000000044], "episode_lengths": [138, 56, 102, 500, 50, 60, 110, 54, 404, 46, 500, 102, 500, 42, 132, 68, 40, 54, 50, 500, 24, 500, 500, 500, 72, 500, 102, 158, 484, 86, 500, 34, 54, 36, 500, 500, 38, 500, 220, 500, 176, 58, 52, 82, 44, 500, 38, 46, 36, 64, 500, 46, 84, 38, 500, 500, 74, 98, 218, 500, 104, 500, 32, 28, 84, 70, 260, 44, 178, 32, 138, 94, 126, 38, 42, 500, 500, 70, 92, 38, 500, 82, 500, 500, 32, 56, 500, 500, 162, 260, 500, 132, 38, 262, 26, 330, 500, 94, 126, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3958215302887378, "mean_inference_ms": 1.2638738376364183, "mean_action_processing_ms": 0.14646949508087087, "mean_env_wait_ms": 0.0877445368111426, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03198385238647461, "StateBufferConnector_ms": 0.007001638412475586, "ViewRequirementAgentConnector_ms": 0.1149892807006836}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000, "num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5048.585198630698, "num_env_steps_trained_throughput_per_sec": 5048.585198630698, "timesteps_total": 624000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 624000, "timers": {"training_iteration_time_ms": 2248.092, "sample_time_ms": 1996.633, "load_time_ms": 12.281, "load_throughput": 977152.276, "learn_time_ms": 227.898, "learn_throughput": 52655.047, "synch_weights_time_ms": 9.576}, "counters": {"num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "done": false, "episodes_total": 2340, "training_iteration": 52, "trial_id": "9f288_00019", "date": "2023-10-25_17-08-32", "timestamp": 1698250112, "time_this_iter_s": 2.3819100856781006, "time_total_s": 117.87484908103943, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 117.87484908103943, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 64.05, "ram_util_percent": 27.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.4408920985006276e-17, "cur_lr": 0.0003, "total_loss": 6.318167114257813, "policy_loss": -1.0286271572113036e-05, "vf_loss": 6.318220488230387, "vf_explained_var": 1.1523564656575521e-07, "kl": 8.620754664434571e-05, "entropy": 0.42998401323954266, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 788.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_agent_steps_sampled": 636000, "num_agent_steps_trained": 636000}, "sampler_results": {"episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.117999999999839, "episode_len_mean": 239.48, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.300000000000004, 44.900000000000006, 41.90000000000001, 45.7, -50.00000000000044, 46.3, 45.5, 46.5, 43.7, -50.00000000000044, 45.5, 41.70000000000002, 46.3, -50.00000000000044, -50.00000000000044, 42.70000000000001, 40.30000000000002, 28.29999999999996, -50.00000000000044, 39.70000000000002, -50.00000000000044, 46.9, 47.3, 41.70000000000002, 43.10000000000001, 24.099999999999902, 45.7, 32.30000000000002, 46.9, 36.30000000000003, 40.70000000000002, 37.50000000000003, 46.3, 45.9, -50.00000000000044, -50.00000000000044, 43.10000000000001, 40.90000000000002, 46.3, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 46.9, 44.5, -50.00000000000044, -50.00000000000044, 33.90000000000004, 24.099999999999902, -50.00000000000044, 36.900000000000034, 46.3, 23.8999999999999, 47.5, 17.099999999999802, -50.00000000000044, 40.70000000000002, 37.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 48.1, 25.099999999999916, 44.5, -50.00000000000044, 46.099999999999994, 29.49999999999998, 47.5, 28.09999999999996, 43.7, 16.699999999999797, -50.00000000000044, 39.300000000000026, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.499999999999964, 45.1, -50.00000000000044, 44.7, 47.1, -50.00000000000044, -50.00000000000044, 42.30000000000001, 38.700000000000024, 46.9, 3.699999999999612, -50.00000000000044, 11.099999999999717], "episode_lengths": [58, 52, 82, 44, 500, 38, 46, 36, 64, 500, 46, 84, 38, 500, 500, 74, 98, 218, 500, 104, 500, 32, 28, 84, 70, 260, 44, 178, 32, 138, 94, 126, 38, 42, 500, 500, 70, 92, 38, 500, 82, 500, 500, 32, 56, 500, 500, 162, 260, 500, 132, 38, 262, 26, 330, 500, 94, 126, 500, 500, 500, 38, 500, 500, 20, 250, 56, 500, 40, 206, 26, 220, 64, 334, 500, 108, 500, 36, 500, 500, 500, 38, 500, 36, 500, 500, 500, 216, 50, 500, 54, 30, 500, 500, 78, 114, 32, 464, 500, 390]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39679352516533967, "mean_inference_ms": 1.2654658972870083, "mean_action_processing_ms": 0.14655803180532112, "mean_env_wait_ms": 0.08776784124593552, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02952289581298828, "StateBufferConnector_ms": 0.010004520416259766, "ViewRequirementAgentConnector_ms": 0.1323409080505371}}, "episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.117999999999839, "episode_len_mean": 239.48, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.300000000000004, 44.900000000000006, 41.90000000000001, 45.7, -50.00000000000044, 46.3, 45.5, 46.5, 43.7, -50.00000000000044, 45.5, 41.70000000000002, 46.3, -50.00000000000044, -50.00000000000044, 42.70000000000001, 40.30000000000002, 28.29999999999996, -50.00000000000044, 39.70000000000002, -50.00000000000044, 46.9, 47.3, 41.70000000000002, 43.10000000000001, 24.099999999999902, 45.7, 32.30000000000002, 46.9, 36.30000000000003, 40.70000000000002, 37.50000000000003, 46.3, 45.9, -50.00000000000044, -50.00000000000044, 43.10000000000001, 40.90000000000002, 46.3, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 46.9, 44.5, -50.00000000000044, -50.00000000000044, 33.90000000000004, 24.099999999999902, -50.00000000000044, 36.900000000000034, 46.3, 23.8999999999999, 47.5, 17.099999999999802, -50.00000000000044, 40.70000000000002, 37.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 48.1, 25.099999999999916, 44.5, -50.00000000000044, 46.099999999999994, 29.49999999999998, 47.5, 28.09999999999996, 43.7, 16.699999999999797, -50.00000000000044, 39.300000000000026, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.499999999999964, 45.1, -50.00000000000044, 44.7, 47.1, -50.00000000000044, -50.00000000000044, 42.30000000000001, 38.700000000000024, 46.9, 3.699999999999612, -50.00000000000044, 11.099999999999717], "episode_lengths": [58, 52, 82, 44, 500, 38, 46, 36, 64, 500, 46, 84, 38, 500, 500, 74, 98, 218, 500, 104, 500, 32, 28, 84, 70, 260, 44, 178, 32, 138, 94, 126, 38, 42, 500, 500, 70, 92, 38, 500, 82, 500, 500, 32, 56, 500, 500, 162, 260, 500, 132, 38, 262, 26, 330, 500, 94, 126, 500, 500, 500, 38, 500, 500, 20, 250, 56, 500, 40, 206, 26, 220, 64, 334, 500, 108, 500, 36, 500, 500, 500, 38, 500, 36, 500, 500, 500, 216, 50, 500, 54, 30, 500, 500, 78, 114, 32, 464, 500, 390]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39679352516533967, "mean_inference_ms": 1.2654658972870083, "mean_action_processing_ms": 0.14655803180532112, "mean_env_wait_ms": 0.08776784124593552, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02952289581298828, "StateBufferConnector_ms": 0.010004520416259766, "ViewRequirementAgentConnector_ms": 0.1323409080505371}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 636000, "num_agent_steps_trained": 636000, "num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4943.783663260089, "num_env_steps_trained_throughput_per_sec": 4943.783663260089, "timesteps_total": 636000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 636000, "timers": {"training_iteration_time_ms": 2282.521, "sample_time_ms": 2029.703, "load_time_ms": 12.081, "load_throughput": 993310.677, "learn_time_ms": 229.174, "learn_throughput": 52361.913, "synch_weights_time_ms": 9.779}, "counters": {"num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_agent_steps_sampled": 636000, "num_agent_steps_trained": 636000}, "done": false, "episodes_total": 2381, "training_iteration": 53, "trial_id": "9f288_00019", "date": "2023-10-25_17-08-34", "timestamp": 1698250114, "time_this_iter_s": 2.4322876930236816, "time_total_s": 120.30713677406311, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 120.30713677406311, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 68.76666666666667, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.2204460492503138e-17, "cur_lr": 0.0003, "total_loss": 6.232230885823568, "policy_loss": -0.00040904022753238676, "vf_loss": 6.232685629526774, "vf_explained_var": -1.160303751627604e-06, "kl": 0.0006358495794411093, "entropy": 0.4559066911538442, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 803.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000}, "sampler_results": {"episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.141999999999815, "episode_len_mean": 259.2, "episode_media": {}, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.3, 23.8999999999999, 47.5, 17.099999999999802, -50.00000000000044, 40.70000000000002, 37.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 48.1, 25.099999999999916, 44.5, -50.00000000000044, 46.099999999999994, 29.49999999999998, 47.5, 28.09999999999996, 43.7, 16.699999999999797, -50.00000000000044, 39.300000000000026, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.499999999999964, 45.1, -50.00000000000044, 44.7, 47.1, -50.00000000000044, -50.00000000000044, 42.30000000000001, 38.700000000000024, 46.9, 3.699999999999612, -50.00000000000044, 11.099999999999717, 39.50000000000002, -50.00000000000044, 28.699999999999967, 46.3, 42.10000000000001, 40.90000000000002, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 18.899999999999828, 43.50000000000001, 46.9, -50.00000000000044, 42.70000000000001, 45.5, -50.00000000000044, 31.300000000000004, -50.00000000000044, 43.30000000000001, 46.9, 43.7, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.499999999999908, 45.1, 20.699999999999854, -50.00000000000044, 45.7, 45.7, -50.00000000000044, -50.00000000000044, 47.3, 37.300000000000026, 45.1, 46.3, 46.699999999999996, -50.00000000000044, 21.09999999999986, -50.00000000000044, 44.300000000000004, 37.50000000000003, 47.1, 44.5, -50.00000000000044, 45.9], "episode_lengths": [38, 262, 26, 330, 500, 94, 126, 500, 500, 500, 38, 500, 500, 20, 250, 56, 500, 40, 206, 26, 220, 64, 334, 500, 108, 500, 36, 500, 500, 500, 38, 500, 36, 500, 500, 500, 216, 50, 500, 54, 30, 500, 500, 78, 114, 32, 464, 500, 390, 106, 500, 214, 38, 80, 92, 500, 500, 56, 500, 500, 32, 500, 312, 66, 32, 500, 74, 46, 500, 188, 500, 68, 32, 64, 76, 500, 500, 500, 256, 50, 294, 500, 44, 44, 500, 500, 28, 128, 50, 38, 34, 500, 290, 500, 58, 126, 30, 56, 500, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39763507176115437, "mean_inference_ms": 1.2667752519670865, "mean_action_processing_ms": 0.14663511256568595, "mean_env_wait_ms": 0.08792214164654943, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026514530181884766, "StateBufferConnector_ms": 0.011002540588378906, "ViewRequirementAgentConnector_ms": 0.14218425750732422}}, "episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.141999999999815, "episode_len_mean": 259.2, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.3, 23.8999999999999, 47.5, 17.099999999999802, -50.00000000000044, 40.70000000000002, 37.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 48.1, 25.099999999999916, 44.5, -50.00000000000044, 46.099999999999994, 29.49999999999998, 47.5, 28.09999999999996, 43.7, 16.699999999999797, -50.00000000000044, 39.300000000000026, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.499999999999964, 45.1, -50.00000000000044, 44.7, 47.1, -50.00000000000044, -50.00000000000044, 42.30000000000001, 38.700000000000024, 46.9, 3.699999999999612, -50.00000000000044, 11.099999999999717, 39.50000000000002, -50.00000000000044, 28.699999999999967, 46.3, 42.10000000000001, 40.90000000000002, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 18.899999999999828, 43.50000000000001, 46.9, -50.00000000000044, 42.70000000000001, 45.5, -50.00000000000044, 31.300000000000004, -50.00000000000044, 43.30000000000001, 46.9, 43.7, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.499999999999908, 45.1, 20.699999999999854, -50.00000000000044, 45.7, 45.7, -50.00000000000044, -50.00000000000044, 47.3, 37.300000000000026, 45.1, 46.3, 46.699999999999996, -50.00000000000044, 21.09999999999986, -50.00000000000044, 44.300000000000004, 37.50000000000003, 47.1, 44.5, -50.00000000000044, 45.9], "episode_lengths": [38, 262, 26, 330, 500, 94, 126, 500, 500, 500, 38, 500, 500, 20, 250, 56, 500, 40, 206, 26, 220, 64, 334, 500, 108, 500, 36, 500, 500, 500, 38, 500, 36, 500, 500, 500, 216, 50, 500, 54, 30, 500, 500, 78, 114, 32, 464, 500, 390, 106, 500, 214, 38, 80, 92, 500, 500, 56, 500, 500, 32, 500, 312, 66, 32, 500, 74, 46, 500, 188, 500, 68, 32, 64, 76, 500, 500, 500, 256, 50, 294, 500, 44, 44, 500, 500, 28, 128, 50, 38, 34, 500, 290, 500, 58, 126, 30, 56, 500, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39763507176115437, "mean_inference_ms": 1.2667752519670865, "mean_action_processing_ms": 0.14663511256568595, "mean_env_wait_ms": 0.08792214164654943, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026514530181884766, "StateBufferConnector_ms": 0.011002540588378906, "ViewRequirementAgentConnector_ms": 0.14218425750732422}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4987.598103724374, "num_env_steps_trained_throughput_per_sec": 4987.598103724374, "timesteps_total": 648000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 648000, "timers": {"training_iteration_time_ms": 2326.819, "sample_time_ms": 2060.095, "load_time_ms": 12.355, "load_throughput": 971302.792, "learn_time_ms": 242.518, "learn_throughput": 49480.835, "synch_weights_time_ms": 10.067}, "counters": {"num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000}, "done": false, "episodes_total": 2432, "training_iteration": 54, "trial_id": "9f288_00019", "date": "2023-10-25_17-08-37", "timestamp": 1698250117, "time_this_iter_s": 2.4109599590301514, "time_total_s": 122.71809673309326, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 122.71809673309326, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 60.37500000000001, "ram_util_percent": 27.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1102230246251569e-17, "cur_lr": 0.0003, "total_loss": 6.320365142822266, "policy_loss": -6.5067162116368616e-06, "vf_loss": 6.320417404174805, "vf_explained_var": -8.424123128255208e-07, "kl": 0.00032352368319455614, "entropy": 0.45810558994611106, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 818.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_agent_steps_sampled": 660000, "num_agent_steps_trained": 660000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.279999999999829, "episode_len_mean": 247.86, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 11.099999999999717, 39.50000000000002, -50.00000000000044, 28.699999999999967, 46.3, 42.10000000000001, 40.90000000000002, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 18.899999999999828, 43.50000000000001, 46.9, -50.00000000000044, 42.70000000000001, 45.5, -50.00000000000044, 31.300000000000004, -50.00000000000044, 43.30000000000001, 46.9, 43.7, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.499999999999908, 45.1, 20.699999999999854, -50.00000000000044, 45.7, 45.7, -50.00000000000044, -50.00000000000044, 47.3, 37.300000000000026, 45.1, 46.3, 46.699999999999996, -50.00000000000044, 21.09999999999986, -50.00000000000044, 44.300000000000004, 37.50000000000003, 47.1, 44.5, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 9.499999999999694, 41.100000000000016, 42.10000000000001, 45.3, 46.3, 38.10000000000002, 41.90000000000001, -50.00000000000044, 32.50000000000002, -50.00000000000044, 35.70000000000003, 45.9, 24.099999999999902, 44.300000000000004, 38.300000000000026, 46.3, 46.3, 42.500000000000014, 42.10000000000001, 27.49999999999995, 41.90000000000001, 46.699999999999996, -50.00000000000044, -50.00000000000044, 34.900000000000034, -50.00000000000044, -50.00000000000044, 0.49999999999956657, 46.3, 43.900000000000006, 46.699999999999996, 43.30000000000001, 22.49999999999988, 36.30000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.099999999999987, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 3.899999999999615, 46.3, -50.00000000000044], "episode_lengths": [500, 390, 106, 500, 214, 38, 80, 92, 500, 500, 56, 500, 500, 32, 500, 312, 66, 32, 500, 74, 46, 500, 188, 500, 68, 32, 64, 76, 500, 500, 500, 256, 50, 294, 500, 44, 44, 500, 500, 28, 128, 50, 38, 34, 500, 290, 500, 58, 126, 30, 56, 500, 42, 500, 500, 406, 90, 80, 48, 38, 120, 82, 500, 176, 500, 144, 42, 260, 58, 118, 38, 38, 76, 80, 226, 82, 34, 500, 500, 152, 500, 500, 496, 38, 62, 34, 68, 276, 138, 500, 500, 500, 200, 500, 500, 500, 52, 462, 38, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39757968369693186, "mean_inference_ms": 1.268274125339069, "mean_action_processing_ms": 0.14731270041427139, "mean_env_wait_ms": 0.08783248656452941, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02482891082763672, "StateBufferConnector_ms": 0.008001565933227539, "ViewRequirementAgentConnector_ms": 0.13371682167053223}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.279999999999829, "episode_len_mean": 247.86, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 11.099999999999717, 39.50000000000002, -50.00000000000044, 28.699999999999967, 46.3, 42.10000000000001, 40.90000000000002, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 18.899999999999828, 43.50000000000001, 46.9, -50.00000000000044, 42.70000000000001, 45.5, -50.00000000000044, 31.300000000000004, -50.00000000000044, 43.30000000000001, 46.9, 43.7, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.499999999999908, 45.1, 20.699999999999854, -50.00000000000044, 45.7, 45.7, -50.00000000000044, -50.00000000000044, 47.3, 37.300000000000026, 45.1, 46.3, 46.699999999999996, -50.00000000000044, 21.09999999999986, -50.00000000000044, 44.300000000000004, 37.50000000000003, 47.1, 44.5, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 9.499999999999694, 41.100000000000016, 42.10000000000001, 45.3, 46.3, 38.10000000000002, 41.90000000000001, -50.00000000000044, 32.50000000000002, -50.00000000000044, 35.70000000000003, 45.9, 24.099999999999902, 44.300000000000004, 38.300000000000026, 46.3, 46.3, 42.500000000000014, 42.10000000000001, 27.49999999999995, 41.90000000000001, 46.699999999999996, -50.00000000000044, -50.00000000000044, 34.900000000000034, -50.00000000000044, -50.00000000000044, 0.49999999999956657, 46.3, 43.900000000000006, 46.699999999999996, 43.30000000000001, 22.49999999999988, 36.30000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.099999999999987, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 3.899999999999615, 46.3, -50.00000000000044], "episode_lengths": [500, 390, 106, 500, 214, 38, 80, 92, 500, 500, 56, 500, 500, 32, 500, 312, 66, 32, 500, 74, 46, 500, 188, 500, 68, 32, 64, 76, 500, 500, 500, 256, 50, 294, 500, 44, 44, 500, 500, 28, 128, 50, 38, 34, 500, 290, 500, 58, 126, 30, 56, 500, 42, 500, 500, 406, 90, 80, 48, 38, 120, 82, 500, 176, 500, 144, 42, 260, 58, 118, 38, 38, 76, 80, 226, 82, 34, 500, 500, 152, 500, 500, 496, 38, 62, 34, 68, 276, 138, 500, 500, 500, 200, 500, 500, 500, 52, 462, 38, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39757968369693186, "mean_inference_ms": 1.268274125339069, "mean_action_processing_ms": 0.14731270041427139, "mean_env_wait_ms": 0.08783248656452941, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02482891082763672, "StateBufferConnector_ms": 0.008001565933227539, "ViewRequirementAgentConnector_ms": 0.13371682167053223}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 660000, "num_agent_steps_trained": 660000, "num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5023.02933141507, "num_env_steps_trained_throughput_per_sec": 5023.02933141507, "timesteps_total": 660000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 660000, "timers": {"training_iteration_time_ms": 2346.917, "sample_time_ms": 2087.35, "load_time_ms": 12.256, "load_throughput": 979133.03, "learn_time_ms": 235.086, "learn_throughput": 51045.116, "synch_weights_time_ms": 10.143}, "counters": {"num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_agent_steps_sampled": 660000, "num_agent_steps_trained": 660000}, "done": false, "episodes_total": 2479, "training_iteration": 55, "trial_id": "9f288_00019", "date": "2023-10-25_17-08-39", "timestamp": 1698250119, "time_this_iter_s": 2.3939919471740723, "time_total_s": 125.11208868026733, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 125.11208868026733, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 70.60000000000001, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.5511151231257846e-18, "cur_lr": 0.0003, "total_loss": 6.892040697733561, "policy_loss": -0.000472522775332133, "vf_loss": 6.892558256785075, "vf_explained_var": -1.0649363199869792e-06, "kl": 0.000603932478702518, "entropy": 0.4508632640043894, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 833.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.66899999999982, "episode_len_mean": 258.94, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.300000000000004, 37.50000000000003, 47.1, 44.5, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 9.499999999999694, 41.100000000000016, 42.10000000000001, 45.3, 46.3, 38.10000000000002, 41.90000000000001, -50.00000000000044, 32.50000000000002, -50.00000000000044, 35.70000000000003, 45.9, 24.099999999999902, 44.300000000000004, 38.300000000000026, 46.3, 46.3, 42.500000000000014, 42.10000000000001, 27.49999999999995, 41.90000000000001, 46.699999999999996, -50.00000000000044, -50.00000000000044, 34.900000000000034, -50.00000000000044, -50.00000000000044, 0.49999999999956657, 46.3, 43.900000000000006, 46.699999999999996, 43.30000000000001, 22.49999999999988, 36.30000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.099999999999987, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 3.899999999999615, 46.3, -50.00000000000044, -50.00000000000044, 44.7, 23.699999999999896, 15.099999999999774, -50.00000000000044, -50.00000000000044, 47.3, 20.49999999999985, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 38.700000000000024, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.30000000000004, 46.5, -50.00000000000044, 44.900000000000006, 46.699999999999996, -50.00000000000044, -50.00000000000044, 45.7, 45.5, -50.00000000000044, 46.5, 29.49999999999998, 30.9, 40.30000000000002, 46.9, 47.1, -50.00000000000044, -50.00000000000044, 45.3, 41.100000000000016, 22.299999999999876, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 43.30000000000001, 38.90000000000002], "episode_lengths": [58, 126, 30, 56, 500, 42, 500, 500, 406, 90, 80, 48, 38, 120, 82, 500, 176, 500, 144, 42, 260, 58, 118, 38, 38, 76, 80, 226, 82, 34, 500, 500, 152, 500, 500, 496, 38, 62, 34, 68, 276, 138, 500, 500, 500, 200, 500, 500, 500, 52, 462, 38, 500, 500, 54, 264, 350, 500, 500, 28, 296, 500, 500, 500, 500, 500, 62, 114, 64, 500, 500, 500, 500, 148, 36, 500, 52, 34, 500, 500, 44, 46, 500, 36, 206, 192, 98, 32, 30, 500, 500, 48, 90, 278, 500, 48, 500, 500, 68, 112]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39815455685715356, "mean_inference_ms": 1.2696558725522464, "mean_action_processing_ms": 0.1470030424289925, "mean_env_wait_ms": 0.08809985242755589, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02278900146484375, "StateBufferConnector_ms": 0.007001399993896484, "ViewRequirementAgentConnector_ms": 0.13384294509887695}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.66899999999982, "episode_len_mean": 258.94, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.300000000000004, 37.50000000000003, 47.1, 44.5, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 9.499999999999694, 41.100000000000016, 42.10000000000001, 45.3, 46.3, 38.10000000000002, 41.90000000000001, -50.00000000000044, 32.50000000000002, -50.00000000000044, 35.70000000000003, 45.9, 24.099999999999902, 44.300000000000004, 38.300000000000026, 46.3, 46.3, 42.500000000000014, 42.10000000000001, 27.49999999999995, 41.90000000000001, 46.699999999999996, -50.00000000000044, -50.00000000000044, 34.900000000000034, -50.00000000000044, -50.00000000000044, 0.49999999999956657, 46.3, 43.900000000000006, 46.699999999999996, 43.30000000000001, 22.49999999999988, 36.30000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.099999999999987, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 3.899999999999615, 46.3, -50.00000000000044, -50.00000000000044, 44.7, 23.699999999999896, 15.099999999999774, -50.00000000000044, -50.00000000000044, 47.3, 20.49999999999985, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 38.700000000000024, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.30000000000004, 46.5, -50.00000000000044, 44.900000000000006, 46.699999999999996, -50.00000000000044, -50.00000000000044, 45.7, 45.5, -50.00000000000044, 46.5, 29.49999999999998, 30.9, 40.30000000000002, 46.9, 47.1, -50.00000000000044, -50.00000000000044, 45.3, 41.100000000000016, 22.299999999999876, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 43.30000000000001, 38.90000000000002], "episode_lengths": [58, 126, 30, 56, 500, 42, 500, 500, 406, 90, 80, 48, 38, 120, 82, 500, 176, 500, 144, 42, 260, 58, 118, 38, 38, 76, 80, 226, 82, 34, 500, 500, 152, 500, 500, 496, 38, 62, 34, 68, 276, 138, 500, 500, 500, 200, 500, 500, 500, 52, 462, 38, 500, 500, 54, 264, 350, 500, 500, 28, 296, 500, 500, 500, 500, 500, 62, 114, 64, 500, 500, 500, 500, 148, 36, 500, 52, 34, 500, 500, 44, 46, 500, 36, 206, 192, 98, 32, 30, 500, 500, 48, 90, 278, 500, 48, 500, 500, 68, 112]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39815455685715356, "mean_inference_ms": 1.2696558725522464, "mean_action_processing_ms": 0.1470030424289925, "mean_env_wait_ms": 0.08809985242755589, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02278900146484375, "StateBufferConnector_ms": 0.007001399993896484, "ViewRequirementAgentConnector_ms": 0.13384294509887695}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000, "num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5131.486126783625, "num_env_steps_trained_throughput_per_sec": 5131.486126783625, "timesteps_total": 672000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 672000, "timers": {"training_iteration_time_ms": 2377.568, "sample_time_ms": 2107.842, "load_time_ms": 12.255, "load_throughput": 979159.697, "learn_time_ms": 245.062, "learn_throughput": 48967.273, "synch_weights_time_ms": 10.426}, "counters": {"num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "done": false, "episodes_total": 2526, "training_iteration": 56, "trial_id": "9f288_00019", "date": "2023-10-25_17-08-41", "timestamp": 1698250121, "time_this_iter_s": 2.344529628753662, "time_total_s": 127.456618309021, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 127.456618309021, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 63.76666666666667, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.7755575615628923e-18, "cur_lr": 0.0003, "total_loss": 6.2457356452941895, "policy_loss": -1.0567655165990193e-05, "vf_loss": 6.245789623260498, "vf_explained_var": -1.6768773396809896e-06, "kl": 0.0006529974674776895, "entropy": 0.4343805432319641, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 848.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -2.5650000000002193, "episode_len_mean": 291.18, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [36.30000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.099999999999987, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 3.899999999999615, 46.3, -50.00000000000044, -50.00000000000044, 44.7, 23.699999999999896, 15.099999999999774, -50.00000000000044, -50.00000000000044, 47.3, 20.49999999999985, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 38.700000000000024, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.30000000000004, 46.5, -50.00000000000044, 44.900000000000006, 46.699999999999996, -50.00000000000044, -50.00000000000044, 45.7, 45.5, -50.00000000000044, 46.5, 29.49999999999998, 30.9, 40.30000000000002, 46.9, 47.1, -50.00000000000044, -50.00000000000044, 45.3, 41.100000000000016, 22.299999999999876, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 43.30000000000001, 38.90000000000002, -50.00000000000044, -50.00000000000044, 42.30000000000001, 40.30000000000002, 45.9, 45.3, 30.099999999999987, -50.00000000000044, 47.3, 37.90000000000003, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 45.1, 45.5, 45.3, 41.100000000000016, 40.10000000000002, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 42.30000000000001, -50.00000000000044, -50.00000000000044, 0.6999999999995694, 46.5, 45.9, 46.5, 41.70000000000002], "episode_lengths": [138, 500, 500, 500, 200, 500, 500, 500, 52, 462, 38, 500, 500, 54, 264, 350, 500, 500, 28, 296, 500, 500, 500, 500, 500, 62, 114, 64, 500, 500, 500, 500, 148, 36, 500, 52, 34, 500, 500, 44, 46, 500, 36, 206, 192, 98, 32, 30, 500, 500, 48, 90, 278, 500, 48, 500, 500, 68, 112, 500, 500, 78, 98, 42, 48, 200, 500, 28, 122, 500, 38, 500, 500, 500, 50, 500, 500, 50, 46, 48, 90, 100, 500, 500, 56, 500, 500, 500, 500, 500, 500, 34, 78, 500, 500, 494, 36, 42, 36, 84]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39911514293112377, "mean_inference_ms": 1.2710945620720258, "mean_action_processing_ms": 0.14721795587342207, "mean_env_wait_ms": 0.08836116605751158, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021817922592163086, "StateBufferConnector_ms": 0.00500035285949707, "ViewRequirementAgentConnector_ms": 0.13686680793762207}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -2.5650000000002193, "episode_len_mean": 291.18, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [36.30000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.099999999999987, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 3.899999999999615, 46.3, -50.00000000000044, -50.00000000000044, 44.7, 23.699999999999896, 15.099999999999774, -50.00000000000044, -50.00000000000044, 47.3, 20.49999999999985, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 38.700000000000024, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.30000000000004, 46.5, -50.00000000000044, 44.900000000000006, 46.699999999999996, -50.00000000000044, -50.00000000000044, 45.7, 45.5, -50.00000000000044, 46.5, 29.49999999999998, 30.9, 40.30000000000002, 46.9, 47.1, -50.00000000000044, -50.00000000000044, 45.3, 41.100000000000016, 22.299999999999876, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 43.30000000000001, 38.90000000000002, -50.00000000000044, -50.00000000000044, 42.30000000000001, 40.30000000000002, 45.9, 45.3, 30.099999999999987, -50.00000000000044, 47.3, 37.90000000000003, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 45.1, 45.5, 45.3, 41.100000000000016, 40.10000000000002, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 42.30000000000001, -50.00000000000044, -50.00000000000044, 0.6999999999995694, 46.5, 45.9, 46.5, 41.70000000000002], "episode_lengths": [138, 500, 500, 500, 200, 500, 500, 500, 52, 462, 38, 500, 500, 54, 264, 350, 500, 500, 28, 296, 500, 500, 500, 500, 500, 62, 114, 64, 500, 500, 500, 500, 148, 36, 500, 52, 34, 500, 500, 44, 46, 500, 36, 206, 192, 98, 32, 30, 500, 500, 48, 90, 278, 500, 48, 500, 500, 68, 112, 500, 500, 78, 98, 42, 48, 200, 500, 28, 122, 500, 38, 500, 500, 500, 50, 500, 500, 50, 46, 48, 90, 100, 500, 500, 56, 500, 500, 500, 500, 500, 500, 34, 78, 500, 500, 494, 36, 42, 36, 84]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39911514293112377, "mean_inference_ms": 1.2710945620720258, "mean_action_processing_ms": 0.14721795587342207, "mean_env_wait_ms": 0.08836116605751158, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021817922592163086, "StateBufferConnector_ms": 0.00500035285949707, "ViewRequirementAgentConnector_ms": 0.13686680793762207}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000, "num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4983.992234217982, "num_env_steps_trained_throughput_per_sec": 4983.992234217982, "timesteps_total": 684000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 684000, "timers": {"training_iteration_time_ms": 2405.435, "sample_time_ms": 2135.949, "load_time_ms": 12.763, "load_throughput": 940224.877, "learn_time_ms": 244.117, "learn_throughput": 49156.69, "synch_weights_time_ms": 10.606}, "counters": {"num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000}, "done": false, "episodes_total": 2567, "training_iteration": 57, "trial_id": "9f288_00019", "date": "2023-10-25_17-08-44", "timestamp": 1698250124, "time_this_iter_s": 2.412781238555908, "time_total_s": 129.8693995475769, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 129.8693995475769, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 63.4, "ram_util_percent": 27.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.3877787807814461e-18, "cur_lr": 0.0003, "total_loss": 6.004942607879639, "policy_loss": -6.247820953528086e-05, "vf_loss": 6.005048433939616, "vf_explained_var": -1.0649363199869792e-06, "kl": 0.00010787098143888822, "entropy": 0.4336326003074646, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 863.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.4840000000002066, "episode_len_mean": 275.38, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.5, 29.49999999999998, 30.9, 40.30000000000002, 46.9, 47.1, -50.00000000000044, -50.00000000000044, 45.3, 41.100000000000016, 22.299999999999876, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 43.30000000000001, 38.90000000000002, -50.00000000000044, -50.00000000000044, 42.30000000000001, 40.30000000000002, 45.9, 45.3, 30.099999999999987, -50.00000000000044, 47.3, 37.90000000000003, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 45.1, 45.5, 45.3, 41.100000000000016, 40.10000000000002, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 42.30000000000001, -50.00000000000044, -50.00000000000044, 0.6999999999995694, 46.5, 45.9, 46.5, 41.70000000000002, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 41.100000000000016, 46.3, -50.00000000000044, 38.300000000000026, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.299999999999947, 44.7, 46.5, -50.00000000000044, 46.699999999999996, 36.30000000000003, -50.00000000000044, 45.5, 47.3, 47.7, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.1, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 46.699999999999996, -50.00000000000044, 43.900000000000006, -50.00000000000044], "episode_lengths": [500, 36, 206, 192, 98, 32, 30, 500, 500, 48, 90, 278, 500, 48, 500, 500, 68, 112, 500, 500, 78, 98, 42, 48, 200, 500, 28, 122, 500, 38, 500, 500, 500, 50, 500, 500, 50, 46, 48, 90, 100, 500, 500, 56, 500, 500, 500, 500, 500, 500, 34, 78, 500, 500, 494, 36, 42, 36, 84, 500, 42, 500, 500, 500, 70, 90, 38, 500, 118, 40, 500, 500, 500, 500, 228, 54, 36, 500, 34, 138, 500, 46, 28, 24, 32, 500, 500, 500, 190, 500, 500, 50, 500, 500, 48, 500, 34, 500, 62, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3995985323769346, "mean_inference_ms": 1.27293027600191, "mean_action_processing_ms": 0.14730276857835803, "mean_env_wait_ms": 0.08837890708335827, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02197861671447754, "StateBufferConnector_ms": 0.004971504211425781, "ViewRequirementAgentConnector_ms": 0.15410542488098145}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.4840000000002066, "episode_len_mean": 275.38, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.5, 29.49999999999998, 30.9, 40.30000000000002, 46.9, 47.1, -50.00000000000044, -50.00000000000044, 45.3, 41.100000000000016, 22.299999999999876, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 43.30000000000001, 38.90000000000002, -50.00000000000044, -50.00000000000044, 42.30000000000001, 40.30000000000002, 45.9, 45.3, 30.099999999999987, -50.00000000000044, 47.3, 37.90000000000003, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 45.1, 45.5, 45.3, 41.100000000000016, 40.10000000000002, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 42.30000000000001, -50.00000000000044, -50.00000000000044, 0.6999999999995694, 46.5, 45.9, 46.5, 41.70000000000002, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 41.100000000000016, 46.3, -50.00000000000044, 38.300000000000026, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.299999999999947, 44.7, 46.5, -50.00000000000044, 46.699999999999996, 36.30000000000003, -50.00000000000044, 45.5, 47.3, 47.7, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.1, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 46.699999999999996, -50.00000000000044, 43.900000000000006, -50.00000000000044], "episode_lengths": [500, 36, 206, 192, 98, 32, 30, 500, 500, 48, 90, 278, 500, 48, 500, 500, 68, 112, 500, 500, 78, 98, 42, 48, 200, 500, 28, 122, 500, 38, 500, 500, 500, 50, 500, 500, 50, 46, 48, 90, 100, 500, 500, 56, 500, 500, 500, 500, 500, 500, 34, 78, 500, 500, 494, 36, 42, 36, 84, 500, 42, 500, 500, 500, 70, 90, 38, 500, 118, 40, 500, 500, 500, 500, 228, 54, 36, 500, 34, 138, 500, 46, 28, 24, 32, 500, 500, 500, 190, 500, 500, 50, 500, 500, 48, 500, 34, 500, 62, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3995985323769346, "mean_inference_ms": 1.27293027600191, "mean_action_processing_ms": 0.14730276857835803, "mean_env_wait_ms": 0.08837890708335827, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02197861671447754, "StateBufferConnector_ms": 0.004971504211425781, "ViewRequirementAgentConnector_ms": 0.15410542488098145}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000, "num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5064.333238918926, "num_env_steps_trained_throughput_per_sec": 5064.333238918926, "timesteps_total": 696000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 696000, "timers": {"training_iteration_time_ms": 2427.588, "sample_time_ms": 2159.294, "load_time_ms": 12.564, "load_throughput": 955115.918, "learn_time_ms": 243.025, "learn_throughput": 49377.725, "synch_weights_time_ms": 10.706}, "counters": {"num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000}, "done": false, "episodes_total": 2608, "training_iteration": 58, "trial_id": "9f288_00019", "date": "2023-10-25_17-08-46", "timestamp": 1698250126, "time_this_iter_s": 2.375272512435913, "time_total_s": 132.24467206001282, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 132.24467206001282, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 69.60000000000001, "ram_util_percent": 27.366666666666664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.938893903907231e-19, "cur_lr": 0.0003, "total_loss": 5.816091314951579, "policy_loss": -0.00024083654085795084, "vf_loss": 5.816373952229818, "vf_explained_var": 1.351038614908854e-07, "kl": 0.0002914291191444818, "entropy": 0.41911717454592384, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 878.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_agent_steps_sampled": 708000, "num_agent_steps_trained": 708000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -3.243000000000224, "episode_len_mean": 287.94, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 42.30000000000001, -50.00000000000044, -50.00000000000044, 0.6999999999995694, 46.5, 45.9, 46.5, 41.70000000000002, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 41.100000000000016, 46.3, -50.00000000000044, 38.300000000000026, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.299999999999947, 44.7, 46.5, -50.00000000000044, 46.699999999999996, 36.30000000000003, -50.00000000000044, 45.5, 47.3, 47.7, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.1, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 46.699999999999996, -50.00000000000044, 43.900000000000006, -50.00000000000044, 12.499999999999737, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 47.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.500000000000036, -50.00000000000044, 45.9, 40.30000000000002, 45.9, 46.099999999999994, 47.3, 46.699999999999996, -50.00000000000044, 46.699999999999996, -50.00000000000044, 46.099999999999994, 47.1, 47.5, -50.00000000000044, 42.500000000000014, -50.00000000000044, 24.899999999999913, 46.099999999999994, -50.00000000000044, 33.90000000000004, 25.899999999999928, -50.00000000000044, 46.099999999999994, -50.00000000000044, 42.900000000000006, -50.00000000000044, 39.300000000000026, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 56, 500, 500, 500, 500, 500, 500, 34, 78, 500, 500, 494, 36, 42, 36, 84, 500, 42, 500, 500, 500, 70, 90, 38, 500, 118, 40, 500, 500, 500, 500, 228, 54, 36, 500, 34, 138, 500, 46, 28, 24, 32, 500, 500, 500, 190, 500, 500, 50, 500, 500, 48, 500, 34, 500, 62, 500, 376, 500, 48, 500, 500, 22, 500, 500, 500, 146, 500, 42, 98, 42, 40, 28, 34, 500, 34, 500, 40, 30, 26, 500, 76, 500, 252, 40, 500, 162, 242, 500, 40, 500, 72, 500, 108, 500, 34, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39936745319441086, "mean_inference_ms": 1.273719438608822, "mean_action_processing_ms": 0.1476894215737565, "mean_env_wait_ms": 0.08853130069433345, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019042015075683594, "StateBufferConnector_ms": 0.007402658462524414, "ViewRequirementAgentConnector_ms": 0.16417193412780762}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -3.243000000000224, "episode_len_mean": 287.94, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 42.30000000000001, -50.00000000000044, -50.00000000000044, 0.6999999999995694, 46.5, 45.9, 46.5, 41.70000000000002, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 41.100000000000016, 46.3, -50.00000000000044, 38.300000000000026, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.299999999999947, 44.7, 46.5, -50.00000000000044, 46.699999999999996, 36.30000000000003, -50.00000000000044, 45.5, 47.3, 47.7, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.1, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 46.699999999999996, -50.00000000000044, 43.900000000000006, -50.00000000000044, 12.499999999999737, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 47.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.500000000000036, -50.00000000000044, 45.9, 40.30000000000002, 45.9, 46.099999999999994, 47.3, 46.699999999999996, -50.00000000000044, 46.699999999999996, -50.00000000000044, 46.099999999999994, 47.1, 47.5, -50.00000000000044, 42.500000000000014, -50.00000000000044, 24.899999999999913, 46.099999999999994, -50.00000000000044, 33.90000000000004, 25.899999999999928, -50.00000000000044, 46.099999999999994, -50.00000000000044, 42.900000000000006, -50.00000000000044, 39.300000000000026, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 56, 500, 500, 500, 500, 500, 500, 34, 78, 500, 500, 494, 36, 42, 36, 84, 500, 42, 500, 500, 500, 70, 90, 38, 500, 118, 40, 500, 500, 500, 500, 228, 54, 36, 500, 34, 138, 500, 46, 28, 24, 32, 500, 500, 500, 190, 500, 500, 50, 500, 500, 48, 500, 34, 500, 62, 500, 376, 500, 48, 500, 500, 22, 500, 500, 500, 146, 500, 42, 98, 42, 40, 28, 34, 500, 34, 500, 40, 30, 26, 500, 76, 500, 252, 40, 500, 162, 242, 500, 40, 500, 72, 500, 108, 500, 34, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39936745319441086, "mean_inference_ms": 1.273719438608822, "mean_action_processing_ms": 0.1476894215737565, "mean_env_wait_ms": 0.08853130069433345, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019042015075683594, "StateBufferConnector_ms": 0.007402658462524414, "ViewRequirementAgentConnector_ms": 0.16417193412780762}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 708000, "num_agent_steps_trained": 708000, "num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4992.426103750783, "num_env_steps_trained_throughput_per_sec": 4992.426103750783, "timesteps_total": 708000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 708000, "timers": {"training_iteration_time_ms": 2417.429, "sample_time_ms": 2147.817, "load_time_ms": 13.046, "load_throughput": 919796.785, "learn_time_ms": 243.96, "learn_throughput": 49188.397, "synch_weights_time_ms": 10.706}, "counters": {"num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_agent_steps_sampled": 708000, "num_agent_steps_trained": 708000}, "done": false, "episodes_total": 2649, "training_iteration": 59, "trial_id": "9f288_00019", "date": "2023-10-25_17-08-49", "timestamp": 1698250129, "time_this_iter_s": 2.409640312194824, "time_total_s": 134.65431237220764, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 134.65431237220764, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 65.56666666666666, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.4694469519536153e-19, "cur_lr": 0.0003, "total_loss": 6.297226937611898, "policy_loss": 6.038223703702291e-05, "vf_loss": 6.297210343678793, "vf_explained_var": -8.821487426757813e-07, "kl": 0.00010739831232153089, "entropy": 0.438546884059906, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 893.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -5.991000000000238, "episode_len_mean": 305.4, "episode_media": {}, "episodes_this_iter": 36, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.699999999999996, 36.30000000000003, -50.00000000000044, 45.5, 47.3, 47.7, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.1, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 46.699999999999996, -50.00000000000044, 43.900000000000006, -50.00000000000044, 12.499999999999737, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 47.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.500000000000036, -50.00000000000044, 45.9, 40.30000000000002, 45.9, 46.099999999999994, 47.3, 46.699999999999996, -50.00000000000044, 46.699999999999996, -50.00000000000044, 46.099999999999994, 47.1, 47.5, -50.00000000000044, 42.500000000000014, -50.00000000000044, 24.899999999999913, 46.099999999999994, -50.00000000000044, 33.90000000000004, 25.899999999999928, -50.00000000000044, 46.099999999999994, -50.00000000000044, 42.900000000000006, -50.00000000000044, 39.300000000000026, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 40.500000000000014, 20.699999999999854, 46.9, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.499999999999837, 45.3, -50.00000000000044, -50.00000000000044, 7.899999999999672, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, 22.899999999999885, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.499999999999808, 32.50000000000002, 45.5, -50.00000000000044, 43.10000000000001, -50.00000000000044], "episode_lengths": [500, 34, 138, 500, 46, 28, 24, 32, 500, 500, 500, 190, 500, 500, 50, 500, 500, 48, 500, 34, 500, 62, 500, 376, 500, 48, 500, 500, 22, 500, 500, 500, 146, 500, 42, 98, 42, 40, 28, 34, 500, 34, 500, 40, 30, 26, 500, 76, 500, 252, 40, 500, 162, 242, 500, 40, 500, 72, 500, 108, 500, 34, 500, 500, 500, 500, 500, 40, 500, 96, 294, 32, 500, 30, 500, 500, 500, 500, 500, 306, 48, 500, 500, 422, 500, 500, 86, 500, 272, 78, 500, 500, 500, 500, 326, 176, 46, 500, 70, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39978437331184097, "mean_inference_ms": 1.2749973551993543, "mean_action_processing_ms": 0.1478518576963145, "mean_env_wait_ms": 0.08854566476810335, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014023065567016602, "StateBufferConnector_ms": 0.010413169860839844, "ViewRequirementAgentConnector_ms": 0.15502285957336426}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -5.991000000000238, "episode_len_mean": 305.4, "episodes_this_iter": 36, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.699999999999996, 36.30000000000003, -50.00000000000044, 45.5, 47.3, 47.7, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.1, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 46.699999999999996, -50.00000000000044, 43.900000000000006, -50.00000000000044, 12.499999999999737, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 47.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.500000000000036, -50.00000000000044, 45.9, 40.30000000000002, 45.9, 46.099999999999994, 47.3, 46.699999999999996, -50.00000000000044, 46.699999999999996, -50.00000000000044, 46.099999999999994, 47.1, 47.5, -50.00000000000044, 42.500000000000014, -50.00000000000044, 24.899999999999913, 46.099999999999994, -50.00000000000044, 33.90000000000004, 25.899999999999928, -50.00000000000044, 46.099999999999994, -50.00000000000044, 42.900000000000006, -50.00000000000044, 39.300000000000026, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 40.500000000000014, 20.699999999999854, 46.9, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.499999999999837, 45.3, -50.00000000000044, -50.00000000000044, 7.899999999999672, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, 22.899999999999885, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.499999999999808, 32.50000000000002, 45.5, -50.00000000000044, 43.10000000000001, -50.00000000000044], "episode_lengths": [500, 34, 138, 500, 46, 28, 24, 32, 500, 500, 500, 190, 500, 500, 50, 500, 500, 48, 500, 34, 500, 62, 500, 376, 500, 48, 500, 500, 22, 500, 500, 500, 146, 500, 42, 98, 42, 40, 28, 34, 500, 34, 500, 40, 30, 26, 500, 76, 500, 252, 40, 500, 162, 242, 500, 40, 500, 72, 500, 108, 500, 34, 500, 500, 500, 500, 500, 40, 500, 96, 294, 32, 500, 30, 500, 500, 500, 500, 500, 306, 48, 500, 500, 422, 500, 500, 86, 500, 272, 78, 500, 500, 500, 500, 326, 176, 46, 500, 70, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39978437331184097, "mean_inference_ms": 1.2749973551993543, "mean_action_processing_ms": 0.1478518576963145, "mean_env_wait_ms": 0.08854566476810335, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014023065567016602, "StateBufferConnector_ms": 0.010413169860839844, "ViewRequirementAgentConnector_ms": 0.15502285957336426}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4879.271124938115, "num_env_steps_trained_throughput_per_sec": 4879.271124938115, "timesteps_total": 720000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 720000, "timers": {"training_iteration_time_ms": 2397.847, "sample_time_ms": 2131.631, "load_time_ms": 11.262, "load_throughput": 1065508.709, "learn_time_ms": 242.305, "learn_throughput": 49524.454, "synch_weights_time_ms": 10.766}, "counters": {"num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "done": false, "episodes_total": 2685, "training_iteration": 60, "trial_id": "9f288_00019", "date": "2023-10-25_17-08-51", "timestamp": 1698250131, "time_this_iter_s": 2.4643805027008057, "time_total_s": 137.11869287490845, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 137.11869287490845, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 65.925, "ram_util_percent": 27.325000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.7347234759768077e-19, "cur_lr": 0.0003, "total_loss": 6.540439097086589, "policy_loss": -0.0005759692440430324, "vf_loss": 6.541062800089518, "vf_explained_var": -1.1046727498372397e-06, "kl": 0.000659151582171565, "entropy": 0.47573919892311095, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 908.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_agent_steps_sampled": 732000, "num_agent_steps_trained": 732000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -2.81300000000022, "episode_len_mean": 293.66, "episode_media": {}, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.099999999999994, -50.00000000000044, 33.90000000000004, 25.899999999999928, -50.00000000000044, 46.099999999999994, -50.00000000000044, 42.900000000000006, -50.00000000000044, 39.300000000000026, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 40.500000000000014, 20.699999999999854, 46.9, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.499999999999837, 45.3, -50.00000000000044, -50.00000000000044, 7.899999999999672, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, 22.899999999999885, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.499999999999808, 32.50000000000002, 45.5, -50.00000000000044, 43.10000000000001, -50.00000000000044, 10.499999999999709, -50.00000000000044, 37.50000000000003, 46.5, 45.1, -50.00000000000044, 45.3, -50.00000000000044, 45.1, -50.00000000000044, 46.699999999999996, -50.00000000000044, 46.5, 3.2999999999996064, 35.500000000000036, -50.00000000000044, 45.5, -50.00000000000044, 34.900000000000034, 45.9, -50.00000000000044, 43.10000000000001, 35.10000000000004, 46.099999999999994, -50.00000000000044, 46.699999999999996, 36.10000000000004, 42.900000000000006, -50.00000000000044, -50.00000000000044, 44.900000000000006, 39.10000000000002, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 46.099999999999994, -50.00000000000044, 46.5, 44.300000000000004, 43.10000000000001, -50.00000000000044, -50.00000000000044, 46.3, 45.5, 45.9, 43.50000000000001], "episode_lengths": [40, 500, 162, 242, 500, 40, 500, 72, 500, 108, 500, 34, 500, 500, 500, 500, 500, 40, 500, 96, 294, 32, 500, 30, 500, 500, 500, 500, 500, 306, 48, 500, 500, 422, 500, 500, 86, 500, 272, 78, 500, 500, 500, 500, 326, 176, 46, 500, 70, 500, 396, 500, 126, 36, 50, 500, 48, 500, 50, 500, 34, 500, 36, 468, 146, 500, 46, 500, 152, 42, 500, 70, 150, 40, 500, 34, 140, 72, 500, 500, 52, 110, 500, 74, 500, 500, 500, 500, 78, 40, 500, 36, 58, 70, 500, 500, 38, 46, 42, 66]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40051235012300235, "mean_inference_ms": 1.2770411832503277, "mean_action_processing_ms": 0.14760392224370011, "mean_env_wait_ms": 0.08873208816702621, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02445507049560547, "StateBufferConnector_ms": 0.0070569515228271484, "ViewRequirementAgentConnector_ms": 0.11801576614379883}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -2.81300000000022, "episode_len_mean": 293.66, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.099999999999994, -50.00000000000044, 33.90000000000004, 25.899999999999928, -50.00000000000044, 46.099999999999994, -50.00000000000044, 42.900000000000006, -50.00000000000044, 39.300000000000026, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 40.500000000000014, 20.699999999999854, 46.9, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.499999999999837, 45.3, -50.00000000000044, -50.00000000000044, 7.899999999999672, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, 22.899999999999885, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.499999999999808, 32.50000000000002, 45.5, -50.00000000000044, 43.10000000000001, -50.00000000000044, 10.499999999999709, -50.00000000000044, 37.50000000000003, 46.5, 45.1, -50.00000000000044, 45.3, -50.00000000000044, 45.1, -50.00000000000044, 46.699999999999996, -50.00000000000044, 46.5, 3.2999999999996064, 35.500000000000036, -50.00000000000044, 45.5, -50.00000000000044, 34.900000000000034, 45.9, -50.00000000000044, 43.10000000000001, 35.10000000000004, 46.099999999999994, -50.00000000000044, 46.699999999999996, 36.10000000000004, 42.900000000000006, -50.00000000000044, -50.00000000000044, 44.900000000000006, 39.10000000000002, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 46.099999999999994, -50.00000000000044, 46.5, 44.300000000000004, 43.10000000000001, -50.00000000000044, -50.00000000000044, 46.3, 45.5, 45.9, 43.50000000000001], "episode_lengths": [40, 500, 162, 242, 500, 40, 500, 72, 500, 108, 500, 34, 500, 500, 500, 500, 500, 40, 500, 96, 294, 32, 500, 30, 500, 500, 500, 500, 500, 306, 48, 500, 500, 422, 500, 500, 86, 500, 272, 78, 500, 500, 500, 500, 326, 176, 46, 500, 70, 500, 396, 500, 126, 36, 50, 500, 48, 500, 50, 500, 34, 500, 36, 468, 146, 500, 46, 500, 152, 42, 500, 70, 150, 40, 500, 34, 140, 72, 500, 500, 52, 110, 500, 74, 500, 500, 500, 500, 78, 40, 500, 36, 58, 70, 500, 500, 38, 46, 42, 66]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40051235012300235, "mean_inference_ms": 1.2770411832503277, "mean_action_processing_ms": 0.14760392224370011, "mean_env_wait_ms": 0.08873208816702621, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02445507049560547, "StateBufferConnector_ms": 0.0070569515228271484, "ViewRequirementAgentConnector_ms": 0.11801576614379883}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 732000, "num_agent_steps_trained": 732000, "num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5016.588986670245, "num_env_steps_trained_throughput_per_sec": 5016.588986670245, "timesteps_total": 732000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 732000, "timers": {"training_iteration_time_ms": 2396.897, "sample_time_ms": 2127.21, "load_time_ms": 11.562, "load_throughput": 1037864.375, "learn_time_ms": 245.359, "learn_throughput": 48907.852, "synch_weights_time_ms": 10.881}, "counters": {"num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_agent_steps_sampled": 732000, "num_agent_steps_trained": 732000}, "done": false, "episodes_total": 2735, "training_iteration": 61, "trial_id": "9f288_00019", "date": "2023-10-25_17-08-53", "timestamp": 1698250133, "time_this_iter_s": 2.3970584869384766, "time_total_s": 139.51575136184692, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 139.51575136184692, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 65.2, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.673617379884038e-20, "cur_lr": 0.0003, "total_loss": 6.48101183573405, "policy_loss": -0.00026940703392028806, "vf_loss": 6.481329854329427, "vf_explained_var": -1.7881393432617188e-06, "kl": 0.0006344955759611063, "entropy": 0.48483017086982727, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 923.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 744000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.1669999999998195, "episode_len_mean": 253.94, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 43.10000000000001, -50.00000000000044, 10.499999999999709, -50.00000000000044, 37.50000000000003, 46.5, 45.1, -50.00000000000044, 45.3, -50.00000000000044, 45.1, -50.00000000000044, 46.699999999999996, -50.00000000000044, 46.5, 3.2999999999996064, 35.500000000000036, -50.00000000000044, 45.5, -50.00000000000044, 34.900000000000034, 45.9, -50.00000000000044, 43.10000000000001, 35.10000000000004, 46.099999999999994, -50.00000000000044, 46.699999999999996, 36.10000000000004, 42.900000000000006, -50.00000000000044, -50.00000000000044, 44.900000000000006, 39.10000000000002, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 46.099999999999994, -50.00000000000044, 46.5, 44.300000000000004, 43.10000000000001, -50.00000000000044, -50.00000000000044, 46.3, 45.5, 45.9, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 46.699999999999996, 28.89999999999997, -50.00000000000044, -50.00000000000044, 44.900000000000006, 46.9, -50.00000000000044, 31.70000000000001, 35.30000000000004, 31.300000000000004, 5.099999999999632, 44.5, 37.90000000000003, 43.900000000000006, 46.9, 45.1, -50.00000000000044, 46.099999999999994, 45.9, -50.00000000000044, 23.29999999999989, 42.500000000000014, 44.7, 39.300000000000026, 44.10000000000001, 45.1, -50.00000000000044, 43.10000000000001, 45.5, -50.00000000000044, 42.70000000000001, -50.00000000000044, 42.70000000000001, -50.00000000000044, 45.9, 28.09999999999996, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 70, 500, 396, 500, 126, 36, 50, 500, 48, 500, 50, 500, 34, 500, 36, 468, 146, 500, 46, 500, 152, 42, 500, 70, 150, 40, 500, 34, 140, 72, 500, 500, 52, 110, 500, 74, 500, 500, 500, 500, 78, 40, 500, 36, 58, 70, 500, 500, 38, 46, 42, 66, 500, 500, 500, 78, 500, 34, 212, 500, 500, 52, 32, 500, 184, 148, 188, 450, 56, 122, 62, 32, 50, 500, 40, 42, 500, 268, 76, 54, 108, 60, 50, 500, 70, 46, 500, 74, 500, 74, 500, 42, 220, 500, 500, 54, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40061497261097373, "mean_inference_ms": 1.2780466647164814, "mean_action_processing_ms": 0.14835370675564058, "mean_env_wait_ms": 0.08887398732067686, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030378103256225586, "StateBufferConnector_ms": 0.003038167953491211, "ViewRequirementAgentConnector_ms": 0.12314605712890625}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.1669999999998195, "episode_len_mean": 253.94, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 43.10000000000001, -50.00000000000044, 10.499999999999709, -50.00000000000044, 37.50000000000003, 46.5, 45.1, -50.00000000000044, 45.3, -50.00000000000044, 45.1, -50.00000000000044, 46.699999999999996, -50.00000000000044, 46.5, 3.2999999999996064, 35.500000000000036, -50.00000000000044, 45.5, -50.00000000000044, 34.900000000000034, 45.9, -50.00000000000044, 43.10000000000001, 35.10000000000004, 46.099999999999994, -50.00000000000044, 46.699999999999996, 36.10000000000004, 42.900000000000006, -50.00000000000044, -50.00000000000044, 44.900000000000006, 39.10000000000002, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 46.099999999999994, -50.00000000000044, 46.5, 44.300000000000004, 43.10000000000001, -50.00000000000044, -50.00000000000044, 46.3, 45.5, 45.9, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 46.699999999999996, 28.89999999999997, -50.00000000000044, -50.00000000000044, 44.900000000000006, 46.9, -50.00000000000044, 31.70000000000001, 35.30000000000004, 31.300000000000004, 5.099999999999632, 44.5, 37.90000000000003, 43.900000000000006, 46.9, 45.1, -50.00000000000044, 46.099999999999994, 45.9, -50.00000000000044, 23.29999999999989, 42.500000000000014, 44.7, 39.300000000000026, 44.10000000000001, 45.1, -50.00000000000044, 43.10000000000001, 45.5, -50.00000000000044, 42.70000000000001, -50.00000000000044, 42.70000000000001, -50.00000000000044, 45.9, 28.09999999999996, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 70, 500, 396, 500, 126, 36, 50, 500, 48, 500, 50, 500, 34, 500, 36, 468, 146, 500, 46, 500, 152, 42, 500, 70, 150, 40, 500, 34, 140, 72, 500, 500, 52, 110, 500, 74, 500, 500, 500, 500, 78, 40, 500, 36, 58, 70, 500, 500, 38, 46, 42, 66, 500, 500, 500, 78, 500, 34, 212, 500, 500, 52, 32, 500, 184, 148, 188, 450, 56, 122, 62, 32, 50, 500, 40, 42, 500, 268, 76, 54, 108, 60, 50, 500, 70, 46, 500, 74, 500, 74, 500, 42, 220, 500, 500, 54, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40061497261097373, "mean_inference_ms": 1.2780466647164814, "mean_action_processing_ms": 0.14835370675564058, "mean_env_wait_ms": 0.08887398732067686, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030378103256225586, "StateBufferConnector_ms": 0.003038167953491211, "ViewRequirementAgentConnector_ms": 0.12314605712890625}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 744000, "num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5139.231864685688, "num_env_steps_trained_throughput_per_sec": 5139.231864685688, "timesteps_total": 744000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 744000, "timers": {"training_iteration_time_ms": 2392.705, "sample_time_ms": 2128.107, "load_time_ms": 11.067, "load_throughput": 1084315.49, "learn_time_ms": 240.666, "learn_throughput": 49861.682, "synch_weights_time_ms": 11.08}, "counters": {"num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 744000}, "done": false, "episodes_total": 2782, "training_iteration": 62, "trial_id": "9f288_00019", "date": "2023-10-25_17-08-56", "timestamp": 1698250136, "time_this_iter_s": 2.3399832248687744, "time_total_s": 141.8557345867157, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 141.8557345867157, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 61.475, "ram_util_percent": 27.375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.336808689942019e-20, "cur_lr": 0.0003, "total_loss": 6.64958864847819, "policy_loss": -0.00036645177751779554, "vf_loss": 6.6500036239624025, "vf_explained_var": 5.364418029785156e-07, "kl": 0.0005035052522714522, "entropy": 0.48587666551272074, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 938.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.1649999999998077, "episode_len_mean": 263.94, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.300000000000004, 43.10000000000001, -50.00000000000044, -50.00000000000044, 46.3, 45.5, 45.9, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 46.699999999999996, 28.89999999999997, -50.00000000000044, -50.00000000000044, 44.900000000000006, 46.9, -50.00000000000044, 31.70000000000001, 35.30000000000004, 31.300000000000004, 5.099999999999632, 44.5, 37.90000000000003, 43.900000000000006, 46.9, 45.1, -50.00000000000044, 46.099999999999994, 45.9, -50.00000000000044, 23.29999999999989, 42.500000000000014, 44.7, 39.300000000000026, 44.10000000000001, 45.1, -50.00000000000044, 43.10000000000001, 45.5, -50.00000000000044, 42.70000000000001, -50.00000000000044, 42.70000000000001, -50.00000000000044, 45.9, 28.09999999999996, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 8.099999999999675, 46.3, 43.50000000000001, 36.30000000000003, -50.00000000000044, 37.50000000000003, -50.00000000000044, 40.30000000000002, 46.099999999999994, 45.9, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 14.299999999999763, -50.00000000000044, 24.69999999999991, 44.300000000000004, 44.10000000000001, 47.7, 41.500000000000014, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 45.9, -50.00000000000044, 43.900000000000006, 46.3, 44.7, 22.49999999999988, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044], "episode_lengths": [58, 70, 500, 500, 38, 46, 42, 66, 500, 500, 500, 78, 500, 34, 212, 500, 500, 52, 32, 500, 184, 148, 188, 450, 56, 122, 62, 32, 50, 500, 40, 42, 500, 268, 76, 54, 108, 60, 50, 500, 70, 46, 500, 74, 500, 74, 500, 42, 220, 500, 500, 54, 500, 500, 500, 500, 500, 500, 90, 420, 38, 66, 138, 500, 126, 500, 98, 40, 42, 500, 500, 42, 500, 500, 358, 500, 254, 58, 60, 24, 86, 76, 500, 500, 500, 500, 500, 500, 68, 42, 500, 62, 38, 54, 276, 500, 500, 500, 40, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40076290399947284, "mean_inference_ms": 1.2798076974495478, "mean_action_processing_ms": 0.1487675026488059, "mean_env_wait_ms": 0.08883820032211957, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028992652893066406, "StateBufferConnector_ms": 0.0059967041015625, "ViewRequirementAgentConnector_ms": 0.136735200881958}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.1649999999998077, "episode_len_mean": 263.94, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.300000000000004, 43.10000000000001, -50.00000000000044, -50.00000000000044, 46.3, 45.5, 45.9, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 46.699999999999996, 28.89999999999997, -50.00000000000044, -50.00000000000044, 44.900000000000006, 46.9, -50.00000000000044, 31.70000000000001, 35.30000000000004, 31.300000000000004, 5.099999999999632, 44.5, 37.90000000000003, 43.900000000000006, 46.9, 45.1, -50.00000000000044, 46.099999999999994, 45.9, -50.00000000000044, 23.29999999999989, 42.500000000000014, 44.7, 39.300000000000026, 44.10000000000001, 45.1, -50.00000000000044, 43.10000000000001, 45.5, -50.00000000000044, 42.70000000000001, -50.00000000000044, 42.70000000000001, -50.00000000000044, 45.9, 28.09999999999996, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 8.099999999999675, 46.3, 43.50000000000001, 36.30000000000003, -50.00000000000044, 37.50000000000003, -50.00000000000044, 40.30000000000002, 46.099999999999994, 45.9, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 14.299999999999763, -50.00000000000044, 24.69999999999991, 44.300000000000004, 44.10000000000001, 47.7, 41.500000000000014, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 45.9, -50.00000000000044, 43.900000000000006, 46.3, 44.7, 22.49999999999988, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044], "episode_lengths": [58, 70, 500, 500, 38, 46, 42, 66, 500, 500, 500, 78, 500, 34, 212, 500, 500, 52, 32, 500, 184, 148, 188, 450, 56, 122, 62, 32, 50, 500, 40, 42, 500, 268, 76, 54, 108, 60, 50, 500, 70, 46, 500, 74, 500, 74, 500, 42, 220, 500, 500, 54, 500, 500, 500, 500, 500, 500, 90, 420, 38, 66, 138, 500, 126, 500, 98, 40, 42, 500, 500, 42, 500, 500, 358, 500, 254, 58, 60, 24, 86, 76, 500, 500, 500, 500, 500, 500, 68, 42, 500, 62, 38, 54, 276, 500, 500, 500, 40, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40076290399947284, "mean_inference_ms": 1.2798076974495478, "mean_action_processing_ms": 0.1487675026488059, "mean_env_wait_ms": 0.08883820032211957, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028992652893066406, "StateBufferConnector_ms": 0.0059967041015625, "ViewRequirementAgentConnector_ms": 0.136735200881958}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000, "num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4968.860294498744, "num_env_steps_trained_throughput_per_sec": 4968.860294498744, "timesteps_total": 756000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 756000, "timers": {"training_iteration_time_ms": 2391.48, "sample_time_ms": 2127.529, "load_time_ms": 11.069, "load_throughput": 1084091.282, "learn_time_ms": 240.298, "learn_throughput": 49937.972, "synch_weights_time_ms": 10.977}, "counters": {"num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000}, "done": false, "episodes_total": 2827, "training_iteration": 63, "trial_id": "9f288_00019", "date": "2023-10-25_17-08-58", "timestamp": 1698250138, "time_this_iter_s": 2.42103910446167, "time_total_s": 144.27677369117737, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 144.27677369117737, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 71.13333333333334, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.1684043449710096e-20, "cur_lr": 0.0003, "total_loss": 5.888086764017741, "policy_loss": -0.00038826788465181987, "vf_loss": 5.888520590464274, "vf_explained_var": -7.112820943196615e-07, "kl": 0.0007378260016442558, "entropy": 0.4527726709842682, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 953.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.3419999999997939, "episode_len_mean": 277.14, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.5, -50.00000000000044, 42.70000000000001, -50.00000000000044, 42.70000000000001, -50.00000000000044, 45.9, 28.09999999999996, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 8.099999999999675, 46.3, 43.50000000000001, 36.30000000000003, -50.00000000000044, 37.50000000000003, -50.00000000000044, 40.30000000000002, 46.099999999999994, 45.9, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 14.299999999999763, -50.00000000000044, 24.69999999999991, 44.300000000000004, 44.10000000000001, 47.7, 41.500000000000014, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 45.9, -50.00000000000044, 43.900000000000006, 46.3, 44.7, 22.49999999999988, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.899999999999956, 43.900000000000006, 46.5, -50.00000000000044, -50.00000000000044, 44.300000000000004, 46.9, -50.00000000000044, -50.00000000000044, 47.5, 30.099999999999987, 47.9, 45.7, 46.099999999999994, 45.5, 47.1, -50.00000000000044, 26.499999999999936, 46.699999999999996, 46.699999999999996, -50.00000000000044, 45.7, -50.00000000000044, 27.299999999999947, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 42.500000000000014, 9.499999999999694, 45.5, 43.30000000000001, 46.5, 28.09999999999996, -50.00000000000044, 26.09999999999993, -50.00000000000044, -50.00000000000044, 46.699999999999996], "episode_lengths": [46, 500, 74, 500, 74, 500, 42, 220, 500, 500, 54, 500, 500, 500, 500, 500, 500, 90, 420, 38, 66, 138, 500, 126, 500, 98, 40, 42, 500, 500, 42, 500, 500, 358, 500, 254, 58, 60, 24, 86, 76, 500, 500, 500, 500, 500, 500, 68, 42, 500, 62, 38, 54, 276, 500, 500, 500, 40, 500, 500, 500, 222, 62, 36, 500, 500, 58, 32, 500, 500, 26, 200, 22, 44, 40, 46, 30, 500, 236, 34, 34, 500, 44, 500, 228, 500, 500, 500, 88, 76, 406, 46, 68, 36, 220, 500, 240, 500, 500, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4015595995499616, "mean_inference_ms": 1.282443424431462, "mean_action_processing_ms": 0.14829497284492466, "mean_env_wait_ms": 0.0886947852932623, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.035109758377075195, "StateBufferConnector_ms": 0.008007049560546875, "ViewRequirementAgentConnector_ms": 0.15116024017333984}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.3419999999997939, "episode_len_mean": 277.14, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.5, -50.00000000000044, 42.70000000000001, -50.00000000000044, 42.70000000000001, -50.00000000000044, 45.9, 28.09999999999996, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 8.099999999999675, 46.3, 43.50000000000001, 36.30000000000003, -50.00000000000044, 37.50000000000003, -50.00000000000044, 40.30000000000002, 46.099999999999994, 45.9, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 14.299999999999763, -50.00000000000044, 24.69999999999991, 44.300000000000004, 44.10000000000001, 47.7, 41.500000000000014, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 45.9, -50.00000000000044, 43.900000000000006, 46.3, 44.7, 22.49999999999988, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.899999999999956, 43.900000000000006, 46.5, -50.00000000000044, -50.00000000000044, 44.300000000000004, 46.9, -50.00000000000044, -50.00000000000044, 47.5, 30.099999999999987, 47.9, 45.7, 46.099999999999994, 45.5, 47.1, -50.00000000000044, 26.499999999999936, 46.699999999999996, 46.699999999999996, -50.00000000000044, 45.7, -50.00000000000044, 27.299999999999947, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 42.500000000000014, 9.499999999999694, 45.5, 43.30000000000001, 46.5, 28.09999999999996, -50.00000000000044, 26.09999999999993, -50.00000000000044, -50.00000000000044, 46.699999999999996], "episode_lengths": [46, 500, 74, 500, 74, 500, 42, 220, 500, 500, 54, 500, 500, 500, 500, 500, 500, 90, 420, 38, 66, 138, 500, 126, 500, 98, 40, 42, 500, 500, 42, 500, 500, 358, 500, 254, 58, 60, 24, 86, 76, 500, 500, 500, 500, 500, 500, 68, 42, 500, 62, 38, 54, 276, 500, 500, 500, 40, 500, 500, 500, 222, 62, 36, 500, 500, 58, 32, 500, 500, 26, 200, 22, 44, 40, 46, 30, 500, 236, 34, 34, 500, 44, 500, 228, 500, 500, 500, 88, 76, 406, 46, 68, 36, 220, 500, 240, 500, 500, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4015595995499616, "mean_inference_ms": 1.282443424431462, "mean_action_processing_ms": 0.14829497284492466, "mean_env_wait_ms": 0.0886947852932623, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.035109758377075195, "StateBufferConnector_ms": 0.008007049560546875, "ViewRequirementAgentConnector_ms": 0.15116024017333984}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000, "num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5072.598163604226, "num_env_steps_trained_throughput_per_sec": 5072.598163604226, "timesteps_total": 768000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 768000, "timers": {"training_iteration_time_ms": 2387.448, "sample_time_ms": 2128.254, "load_time_ms": 10.795, "load_throughput": 1111596.579, "learn_time_ms": 235.948, "learn_throughput": 50858.707, "synch_weights_time_ms": 10.846}, "counters": {"num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "done": false, "episodes_total": 2868, "training_iteration": 64, "trial_id": "9f288_00019", "date": "2023-10-25_17-09-01", "timestamp": 1698250141, "time_this_iter_s": 2.369647741317749, "time_total_s": 146.64642143249512, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 146.64642143249512, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 63.76666666666667, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.0842021724855048e-20, "cur_lr": 0.0003, "total_loss": 6.181976477305095, "policy_loss": -0.0005462542176246643, "vf_loss": 6.182566165924072, "vf_explained_var": -7.073084513346354e-07, "kl": 0.0006334573651808266, "entropy": 0.43364347020785016, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 968.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_agent_steps_sampled": 780000, "num_agent_steps_trained": 780000}, "sampler_results": {"episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.647999999999828, "episode_len_mean": 244.16, "episode_media": {}, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.900000000000006, 46.3, 44.7, 22.49999999999988, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.899999999999956, 43.900000000000006, 46.5, -50.00000000000044, -50.00000000000044, 44.300000000000004, 46.9, -50.00000000000044, -50.00000000000044, 47.5, 30.099999999999987, 47.9, 45.7, 46.099999999999994, 45.5, 47.1, -50.00000000000044, 26.499999999999936, 46.699999999999996, 46.699999999999996, -50.00000000000044, 45.7, -50.00000000000044, 27.299999999999947, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 42.500000000000014, 9.499999999999694, 45.5, 43.30000000000001, 46.5, 28.09999999999996, -50.00000000000044, 26.09999999999993, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 46.099999999999994, 36.30000000000003, 0.2999999999995637, 42.70000000000001, -50.00000000000044, 45.5, 43.10000000000001, -50.00000000000044, 41.90000000000001, 47.1, 48.1, 31.300000000000004, 47.9, 38.50000000000003, 35.900000000000034, 44.7, 33.30000000000003, 42.900000000000006, 47.3, -50.00000000000044, 40.10000000000002, 25.499999999999922, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 45.1, -50.00000000000044, 47.3, 47.1, 37.90000000000003, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 42.70000000000001, -50.00000000000044, 11.699999999999726, -50.00000000000044, 46.699999999999996, 24.69999999999991, -50.00000000000044, -50.00000000000044, 46.9, 47.1, -50.00000000000044], "episode_lengths": [62, 38, 54, 276, 500, 500, 500, 40, 500, 500, 500, 222, 62, 36, 500, 500, 58, 32, 500, 500, 26, 200, 22, 44, 40, 46, 30, 500, 236, 34, 34, 500, 44, 500, 228, 500, 500, 500, 88, 76, 406, 46, 68, 36, 220, 500, 240, 500, 500, 34, 500, 40, 138, 498, 74, 500, 46, 70, 500, 82, 30, 20, 188, 22, 116, 142, 54, 168, 72, 28, 500, 100, 246, 38, 500, 500, 500, 500, 52, 50, 500, 28, 30, 122, 44, 500, 500, 500, 32, 74, 500, 384, 500, 34, 254, 500, 500, 32, 30, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4019205757347808, "mean_inference_ms": 1.282865126035377, "mean_action_processing_ms": 0.14799018251222562, "mean_env_wait_ms": 0.08912710087972772, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.042003631591796875, "StateBufferConnector_ms": 0.005955696105957031, "ViewRequirementAgentConnector_ms": 0.14593839645385742}}, "episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.647999999999828, "episode_len_mean": 244.16, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.900000000000006, 46.3, 44.7, 22.49999999999988, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.899999999999956, 43.900000000000006, 46.5, -50.00000000000044, -50.00000000000044, 44.300000000000004, 46.9, -50.00000000000044, -50.00000000000044, 47.5, 30.099999999999987, 47.9, 45.7, 46.099999999999994, 45.5, 47.1, -50.00000000000044, 26.499999999999936, 46.699999999999996, 46.699999999999996, -50.00000000000044, 45.7, -50.00000000000044, 27.299999999999947, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 42.500000000000014, 9.499999999999694, 45.5, 43.30000000000001, 46.5, 28.09999999999996, -50.00000000000044, 26.09999999999993, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 46.099999999999994, 36.30000000000003, 0.2999999999995637, 42.70000000000001, -50.00000000000044, 45.5, 43.10000000000001, -50.00000000000044, 41.90000000000001, 47.1, 48.1, 31.300000000000004, 47.9, 38.50000000000003, 35.900000000000034, 44.7, 33.30000000000003, 42.900000000000006, 47.3, -50.00000000000044, 40.10000000000002, 25.499999999999922, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 45.1, -50.00000000000044, 47.3, 47.1, 37.90000000000003, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 42.70000000000001, -50.00000000000044, 11.699999999999726, -50.00000000000044, 46.699999999999996, 24.69999999999991, -50.00000000000044, -50.00000000000044, 46.9, 47.1, -50.00000000000044], "episode_lengths": [62, 38, 54, 276, 500, 500, 500, 40, 500, 500, 500, 222, 62, 36, 500, 500, 58, 32, 500, 500, 26, 200, 22, 44, 40, 46, 30, 500, 236, 34, 34, 500, 44, 500, 228, 500, 500, 500, 88, 76, 406, 46, 68, 36, 220, 500, 240, 500, 500, 34, 500, 40, 138, 498, 74, 500, 46, 70, 500, 82, 30, 20, 188, 22, 116, 142, 54, 168, 72, 28, 500, 100, 246, 38, 500, 500, 500, 500, 52, 50, 500, 28, 30, 122, 44, 500, 500, 500, 32, 74, 500, 384, 500, 34, 254, 500, 500, 32, 30, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4019205757347808, "mean_inference_ms": 1.282865126035377, "mean_action_processing_ms": 0.14799018251222562, "mean_env_wait_ms": 0.08912710087972772, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.042003631591796875, "StateBufferConnector_ms": 0.005955696105957031, "ViewRequirementAgentConnector_ms": 0.14593839645385742}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 780000, "num_agent_steps_trained": 780000, "num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4941.113340794992, "num_env_steps_trained_throughput_per_sec": 4941.113340794992, "timesteps_total": 780000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 780000, "timers": {"training_iteration_time_ms": 2391.409, "sample_time_ms": 2129.123, "load_time_ms": 11.173, "load_throughput": 1073989.271, "learn_time_ms": 238.74, "learn_throughput": 50263.983, "synch_weights_time_ms": 11.067}, "counters": {"num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_agent_steps_sampled": 780000, "num_agent_steps_trained": 780000}, "done": false, "episodes_total": 2918, "training_iteration": 65, "trial_id": "9f288_00019", "date": "2023-10-25_17-09-03", "timestamp": 1698250143, "time_this_iter_s": 2.4345972537994385, "time_total_s": 149.08101868629456, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 149.08101868629456, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 65.3, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.421010862427524e-21, "cur_lr": 0.0003, "total_loss": 6.559396362304687, "policy_loss": -5.990862846374512e-05, "vf_loss": 6.559494717915853, "vf_explained_var": -6.159146626790365e-07, "kl": 0.00010297515793051085, "entropy": 0.38438669840494794, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 983.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000}, "sampler_results": {"episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.932999999999825, "episode_len_mean": 246.3, "episode_media": {}, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.699999999999996, -50.00000000000044, 46.099999999999994, 36.30000000000003, 0.2999999999995637, 42.70000000000001, -50.00000000000044, 45.5, 43.10000000000001, -50.00000000000044, 41.90000000000001, 47.1, 48.1, 31.300000000000004, 47.9, 38.50000000000003, 35.900000000000034, 44.7, 33.30000000000003, 42.900000000000006, 47.3, -50.00000000000044, 40.10000000000002, 25.499999999999922, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 45.1, -50.00000000000044, 47.3, 47.1, 37.90000000000003, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 42.70000000000001, -50.00000000000044, 11.699999999999726, -50.00000000000044, 46.699999999999996, 24.69999999999991, -50.00000000000044, -50.00000000000044, 46.9, 47.1, -50.00000000000044, -50.00000000000044, 44.900000000000006, 46.9, 41.70000000000002, 32.90000000000003, 45.5, 47.1, 39.50000000000002, 43.50000000000001, 35.10000000000004, 45.5, -50.00000000000044, -50.00000000000044, 47.1, 43.7, 33.10000000000003, 47.5, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, 46.5, 45.7, 44.7, 46.099999999999994, -50.00000000000044, 22.699999999999882, 7.499999999999666, 43.50000000000001, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 47.7, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 14.499999999999766, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001], "episode_lengths": [34, 500, 40, 138, 498, 74, 500, 46, 70, 500, 82, 30, 20, 188, 22, 116, 142, 54, 168, 72, 28, 500, 100, 246, 38, 500, 500, 500, 500, 52, 50, 500, 28, 30, 122, 44, 500, 500, 500, 32, 74, 500, 384, 500, 34, 254, 500, 500, 32, 30, 500, 500, 52, 32, 84, 172, 46, 30, 106, 66, 150, 46, 500, 500, 30, 64, 170, 26, 28, 500, 500, 500, 98, 36, 44, 54, 40, 500, 274, 426, 66, 500, 44, 500, 500, 44, 500, 500, 24, 500, 500, 84, 500, 500, 500, 356, 500, 500, 500, 66]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4024651027407089, "mean_inference_ms": 1.2829350806738247, "mean_action_processing_ms": 0.14810501198629603, "mean_env_wait_ms": 0.08931666876932988, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0294492244720459, "StateBufferConnector_ms": 0.0069468021392822266, "ViewRequirementAgentConnector_ms": 0.15539789199829102}}, "episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.932999999999825, "episode_len_mean": 246.3, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.699999999999996, -50.00000000000044, 46.099999999999994, 36.30000000000003, 0.2999999999995637, 42.70000000000001, -50.00000000000044, 45.5, 43.10000000000001, -50.00000000000044, 41.90000000000001, 47.1, 48.1, 31.300000000000004, 47.9, 38.50000000000003, 35.900000000000034, 44.7, 33.30000000000003, 42.900000000000006, 47.3, -50.00000000000044, 40.10000000000002, 25.499999999999922, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 45.1, -50.00000000000044, 47.3, 47.1, 37.90000000000003, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 42.70000000000001, -50.00000000000044, 11.699999999999726, -50.00000000000044, 46.699999999999996, 24.69999999999991, -50.00000000000044, -50.00000000000044, 46.9, 47.1, -50.00000000000044, -50.00000000000044, 44.900000000000006, 46.9, 41.70000000000002, 32.90000000000003, 45.5, 47.1, 39.50000000000002, 43.50000000000001, 35.10000000000004, 45.5, -50.00000000000044, -50.00000000000044, 47.1, 43.7, 33.10000000000003, 47.5, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, 46.5, 45.7, 44.7, 46.099999999999994, -50.00000000000044, 22.699999999999882, 7.499999999999666, 43.50000000000001, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 47.7, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 14.499999999999766, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001], "episode_lengths": [34, 500, 40, 138, 498, 74, 500, 46, 70, 500, 82, 30, 20, 188, 22, 116, 142, 54, 168, 72, 28, 500, 100, 246, 38, 500, 500, 500, 500, 52, 50, 500, 28, 30, 122, 44, 500, 500, 500, 32, 74, 500, 384, 500, 34, 254, 500, 500, 32, 30, 500, 500, 52, 32, 84, 172, 46, 30, 106, 66, 150, 46, 500, 500, 30, 64, 170, 26, 28, 500, 500, 500, 98, 36, 44, 54, 40, 500, 274, 426, 66, 500, 44, 500, 500, 44, 500, 500, 24, 500, 500, 84, 500, 500, 500, 356, 500, 500, 500, 66]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4024651027407089, "mean_inference_ms": 1.2829350806738247, "mean_action_processing_ms": 0.14810501198629603, "mean_env_wait_ms": 0.08931666876932988, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0294492244720459, "StateBufferConnector_ms": 0.0069468021392822266, "ViewRequirementAgentConnector_ms": 0.15539789199829102}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000, "num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5142.012987729452, "num_env_steps_trained_throughput_per_sec": 5142.012987729452, "timesteps_total": 792000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 792000, "timers": {"training_iteration_time_ms": 2390.93, "sample_time_ms": 2128.792, "load_time_ms": 11.361, "load_throughput": 1056266.944, "learn_time_ms": 238.514, "learn_throughput": 50311.473, "synch_weights_time_ms": 10.856}, "counters": {"num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000}, "done": false, "episodes_total": 2967, "training_iteration": 66, "trial_id": "9f288_00019", "date": "2023-10-25_17-09-06", "timestamp": 1698250146, "time_this_iter_s": 2.338449478149414, "time_total_s": 151.41946816444397, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 151.41946816444397, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 67.10000000000001, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.710505431213762e-21, "cur_lr": 0.0003, "total_loss": 6.329463895161947, "policy_loss": -0.00044253704448541005, "vf_loss": 6.329949696858724, "vf_explained_var": -4.251797993977865e-07, "kl": 0.0006800103867666015, "entropy": 0.43411573171615603, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 998.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 804000, "num_env_steps_trained": 804000, "num_agent_steps_sampled": 804000, "num_agent_steps_trained": 804000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -4.295000000000232, "episode_len_mean": 298.46, "episode_media": {}, "episodes_this_iter": 35, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 42.70000000000001, -50.00000000000044, 11.699999999999726, -50.00000000000044, 46.699999999999996, 24.69999999999991, -50.00000000000044, -50.00000000000044, 46.9, 47.1, -50.00000000000044, -50.00000000000044, 44.900000000000006, 46.9, 41.70000000000002, 32.90000000000003, 45.5, 47.1, 39.50000000000002, 43.50000000000001, 35.10000000000004, 45.5, -50.00000000000044, -50.00000000000044, 47.1, 43.7, 33.10000000000003, 47.5, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, 46.5, 45.7, 44.7, 46.099999999999994, -50.00000000000044, 22.699999999999882, 7.499999999999666, 43.50000000000001, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 47.7, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 14.499999999999766, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, 46.699999999999996, 45.7, 2.8999999999996007, -50.00000000000044, 46.5, 46.5, -50.00000000000044, -50.00000000000044, 47.5, 37.50000000000003, 36.10000000000004, 7.899999999999672, 38.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [44, 500, 500, 500, 32, 74, 500, 384, 500, 34, 254, 500, 500, 32, 30, 500, 500, 52, 32, 84, 172, 46, 30, 106, 66, 150, 46, 500, 500, 30, 64, 170, 26, 28, 500, 500, 500, 98, 36, 44, 54, 40, 500, 274, 426, 66, 500, 44, 500, 500, 44, 500, 500, 24, 500, 500, 84, 500, 500, 500, 356, 500, 500, 500, 66, 500, 34, 500, 500, 500, 500, 500, 500, 500, 500, 500, 130, 500, 34, 44, 472, 500, 36, 36, 500, 500, 26, 126, 140, 422, 120, 500, 500, 500, 58, 500, 26, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4025113426395142, "mean_inference_ms": 1.2838168841369233, "mean_action_processing_ms": 0.1482752792198216, "mean_env_wait_ms": 0.08929388406133026, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.032157182693481445, "StateBufferConnector_ms": 0.005135297775268555, "ViewRequirementAgentConnector_ms": 0.13027572631835938}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -4.295000000000232, "episode_len_mean": 298.46, "episodes_this_iter": 35, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 42.70000000000001, -50.00000000000044, 11.699999999999726, -50.00000000000044, 46.699999999999996, 24.69999999999991, -50.00000000000044, -50.00000000000044, 46.9, 47.1, -50.00000000000044, -50.00000000000044, 44.900000000000006, 46.9, 41.70000000000002, 32.90000000000003, 45.5, 47.1, 39.50000000000002, 43.50000000000001, 35.10000000000004, 45.5, -50.00000000000044, -50.00000000000044, 47.1, 43.7, 33.10000000000003, 47.5, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, 46.5, 45.7, 44.7, 46.099999999999994, -50.00000000000044, 22.699999999999882, 7.499999999999666, 43.50000000000001, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 47.7, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 14.499999999999766, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, 46.699999999999996, 45.7, 2.8999999999996007, -50.00000000000044, 46.5, 46.5, -50.00000000000044, -50.00000000000044, 47.5, 37.50000000000003, 36.10000000000004, 7.899999999999672, 38.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [44, 500, 500, 500, 32, 74, 500, 384, 500, 34, 254, 500, 500, 32, 30, 500, 500, 52, 32, 84, 172, 46, 30, 106, 66, 150, 46, 500, 500, 30, 64, 170, 26, 28, 500, 500, 500, 98, 36, 44, 54, 40, 500, 274, 426, 66, 500, 44, 500, 500, 44, 500, 500, 24, 500, 500, 84, 500, 500, 500, 356, 500, 500, 500, 66, 500, 34, 500, 500, 500, 500, 500, 500, 500, 500, 500, 130, 500, 34, 44, 472, 500, 36, 36, 500, 500, 26, 126, 140, 422, 120, 500, 500, 500, 58, 500, 26, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4025113426395142, "mean_inference_ms": 1.2838168841369233, "mean_action_processing_ms": 0.1482752792198216, "mean_env_wait_ms": 0.08929388406133026, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.032157182693481445, "StateBufferConnector_ms": 0.005135297775268555, "ViewRequirementAgentConnector_ms": 0.13027572631835938}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 804000, "num_agent_steps_trained": 804000, "num_env_steps_sampled": 804000, "num_env_steps_trained": 804000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5392.117524386668, "num_env_steps_trained_throughput_per_sec": 5392.117524386668, "timesteps_total": 804000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 804000, "timers": {"training_iteration_time_ms": 2372.706, "sample_time_ms": 2109.041, "load_time_ms": 11.657, "load_throughput": 1029430.733, "learn_time_ms": 239.876, "learn_throughput": 50025.805, "synch_weights_time_ms": 10.746}, "counters": {"num_env_steps_sampled": 804000, "num_env_steps_trained": 804000, "num_agent_steps_sampled": 804000, "num_agent_steps_trained": 804000}, "done": false, "episodes_total": 3002, "training_iteration": 67, "trial_id": "9f288_00019", "date": "2023-10-25_17-09-08", "timestamp": 1698250148, "time_this_iter_s": 2.230469226837158, "time_total_s": 153.64993739128113, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 153.64993739128113, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 60.166666666666664, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.355252715606881e-21, "cur_lr": 0.0003, "total_loss": 6.169959767659505, "policy_loss": -0.0002842118342717489, "vf_loss": 6.170284048716227, "vf_explained_var": -1.152356465657552e-06, "kl": 0.00022905510915431174, "entropy": 0.40128015478452045, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1013.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 816000, "num_env_steps_trained": 816000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -6.906000000000239, "episode_len_mean": 309.54, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 47.7, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 14.499999999999766, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, 46.699999999999996, 45.7, 2.8999999999996007, -50.00000000000044, 46.5, 46.5, -50.00000000000044, -50.00000000000044, 47.5, 37.50000000000003, 36.10000000000004, 7.899999999999672, 38.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 36.50000000000003, -50.00000000000044, -50.00000000000044, 47.1, 33.30000000000003, 33.500000000000036, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 43.900000000000006, -50.00000000000044, 33.500000000000036, 45.3, -50.00000000000044, 41.90000000000001, 32.90000000000003, -50.00000000000044, 47.9, 47.1, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 42.500000000000014, 47.1, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 35.500000000000036, 31.900000000000013, 35.70000000000003, -50.00000000000044, -50.00000000000044, 31.500000000000007, 47.3, 37.10000000000003, 45.1, 46.3, 22.899999999999885], "episode_lengths": [500, 44, 500, 500, 44, 500, 500, 24, 500, 500, 84, 500, 500, 500, 356, 500, 500, 500, 66, 500, 34, 500, 500, 500, 500, 500, 500, 500, 500, 500, 130, 500, 34, 44, 472, 500, 36, 36, 500, 500, 26, 126, 140, 422, 120, 500, 500, 500, 58, 500, 26, 500, 500, 500, 52, 136, 500, 500, 30, 168, 166, 500, 500, 38, 500, 62, 500, 166, 48, 500, 82, 172, 500, 22, 30, 44, 500, 500, 500, 34, 500, 76, 30, 500, 36, 500, 500, 500, 64, 146, 182, 144, 500, 500, 186, 28, 130, 50, 38, 272]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40192013991493025, "mean_inference_ms": 1.2830309786716994, "mean_action_processing_ms": 0.14891960941632343, "mean_env_wait_ms": 0.08933224446034008, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027650833129882812, "StateBufferConnector_ms": 0.0030019283294677734, "ViewRequirementAgentConnector_ms": 0.1055607795715332}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -6.906000000000239, "episode_len_mean": 309.54, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 47.7, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 14.499999999999766, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, 46.699999999999996, 45.7, 2.8999999999996007, -50.00000000000044, 46.5, 46.5, -50.00000000000044, -50.00000000000044, 47.5, 37.50000000000003, 36.10000000000004, 7.899999999999672, 38.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 36.50000000000003, -50.00000000000044, -50.00000000000044, 47.1, 33.30000000000003, 33.500000000000036, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 43.900000000000006, -50.00000000000044, 33.500000000000036, 45.3, -50.00000000000044, 41.90000000000001, 32.90000000000003, -50.00000000000044, 47.9, 47.1, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 42.500000000000014, 47.1, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 35.500000000000036, 31.900000000000013, 35.70000000000003, -50.00000000000044, -50.00000000000044, 31.500000000000007, 47.3, 37.10000000000003, 45.1, 46.3, 22.899999999999885], "episode_lengths": [500, 44, 500, 500, 44, 500, 500, 24, 500, 500, 84, 500, 500, 500, 356, 500, 500, 500, 66, 500, 34, 500, 500, 500, 500, 500, 500, 500, 500, 500, 130, 500, 34, 44, 472, 500, 36, 36, 500, 500, 26, 126, 140, 422, 120, 500, 500, 500, 58, 500, 26, 500, 500, 500, 52, 136, 500, 500, 30, 168, 166, 500, 500, 38, 500, 62, 500, 166, 48, 500, 82, 172, 500, 22, 30, 44, 500, 500, 500, 34, 500, 76, 30, 500, 36, 500, 500, 500, 64, 146, 182, 144, 500, 500, 186, 28, 130, 50, 38, 272]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40192013991493025, "mean_inference_ms": 1.2830309786716994, "mean_action_processing_ms": 0.14891960941632343, "mean_env_wait_ms": 0.08933224446034008, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027650833129882812, "StateBufferConnector_ms": 0.0030019283294677734, "ViewRequirementAgentConnector_ms": 0.1055607795715332}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000, "num_env_steps_sampled": 816000, "num_env_steps_trained": 816000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5543.164174160009, "num_env_steps_trained_throughput_per_sec": 5543.164174160009, "timesteps_total": 816000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 816000, "timers": {"training_iteration_time_ms": 2352.238, "sample_time_ms": 2094.985, "load_time_ms": 11.156, "load_throughput": 1075634.941, "learn_time_ms": 234.085, "learn_throughput": 51263.407, "synch_weights_time_ms": 10.626}, "counters": {"num_env_steps_sampled": 816000, "num_env_steps_trained": 816000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "done": false, "episodes_total": 3048, "training_iteration": 68, "trial_id": "9f288_00019", "date": "2023-10-25_17-09-10", "timestamp": 1698250150, "time_this_iter_s": 2.1708104610443115, "time_total_s": 155.82074785232544, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 155.82074785232544, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 60.03333333333334, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.776263578034405e-22, "cur_lr": 0.0003, "total_loss": 6.265342585245768, "policy_loss": -0.00022924542427062988, "vf_loss": 6.265614318847656, "vf_explained_var": -1.231829325358073e-06, "kl": 0.0005447479476894539, "entropy": 0.4254460612932841, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1028.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 828000, "num_env_steps_trained": 828000, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.3519999999998094, "episode_len_mean": 267.06, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 36.50000000000003, -50.00000000000044, -50.00000000000044, 47.1, 33.30000000000003, 33.500000000000036, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 43.900000000000006, -50.00000000000044, 33.500000000000036, 45.3, -50.00000000000044, 41.90000000000001, 32.90000000000003, -50.00000000000044, 47.9, 47.1, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 42.500000000000014, 47.1, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 35.500000000000036, 31.900000000000013, 35.70000000000003, -50.00000000000044, -50.00000000000044, 31.500000000000007, 47.3, 37.10000000000003, 45.1, 46.3, 22.899999999999885, -50.00000000000044, -50.00000000000044, 46.9, 38.90000000000002, 46.9, -50.00000000000044, 39.70000000000002, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 46.699999999999996, 47.5, 47.5, 43.900000000000006, 10.299999999999706, 33.10000000000003, -50.00000000000044, -50.00000000000044, 17.299999999999805, 8.699999999999683, 43.900000000000006, -50.00000000000044, 45.1, -50.00000000000044, 45.9, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.30000000000003, 45.1, -50.00000000000044, 28.699999999999967, 47.7, 44.5, -50.00000000000044, 39.50000000000002, -50.00000000000044, -50.00000000000044, 39.90000000000002, 47.3, -50.00000000000044, 40.90000000000002, 34.900000000000034], "episode_lengths": [500, 500, 58, 500, 26, 500, 500, 500, 52, 136, 500, 500, 30, 168, 166, 500, 500, 38, 500, 62, 500, 166, 48, 500, 82, 172, 500, 22, 30, 44, 500, 500, 500, 34, 500, 76, 30, 500, 36, 500, 500, 500, 64, 146, 182, 144, 500, 500, 186, 28, 130, 50, 38, 272, 500, 500, 32, 112, 32, 500, 104, 48, 500, 500, 500, 30, 34, 26, 26, 62, 398, 170, 500, 500, 328, 414, 62, 500, 50, 500, 42, 28, 500, 500, 500, 168, 50, 500, 214, 24, 56, 500, 106, 500, 500, 102, 28, 500, 92, 152]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4018976493351425, "mean_inference_ms": 1.28257508169571, "mean_action_processing_ms": 0.14838751217251045, "mean_env_wait_ms": 0.08910035896033294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023006439208984375, "StateBufferConnector_ms": 0.004790544509887695, "ViewRequirementAgentConnector_ms": 0.1148221492767334}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.3519999999998094, "episode_len_mean": 267.06, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 36.50000000000003, -50.00000000000044, -50.00000000000044, 47.1, 33.30000000000003, 33.500000000000036, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 43.900000000000006, -50.00000000000044, 33.500000000000036, 45.3, -50.00000000000044, 41.90000000000001, 32.90000000000003, -50.00000000000044, 47.9, 47.1, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 42.500000000000014, 47.1, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 35.500000000000036, 31.900000000000013, 35.70000000000003, -50.00000000000044, -50.00000000000044, 31.500000000000007, 47.3, 37.10000000000003, 45.1, 46.3, 22.899999999999885, -50.00000000000044, -50.00000000000044, 46.9, 38.90000000000002, 46.9, -50.00000000000044, 39.70000000000002, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 46.699999999999996, 47.5, 47.5, 43.900000000000006, 10.299999999999706, 33.10000000000003, -50.00000000000044, -50.00000000000044, 17.299999999999805, 8.699999999999683, 43.900000000000006, -50.00000000000044, 45.1, -50.00000000000044, 45.9, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.30000000000003, 45.1, -50.00000000000044, 28.699999999999967, 47.7, 44.5, -50.00000000000044, 39.50000000000002, -50.00000000000044, -50.00000000000044, 39.90000000000002, 47.3, -50.00000000000044, 40.90000000000002, 34.900000000000034], "episode_lengths": [500, 500, 58, 500, 26, 500, 500, 500, 52, 136, 500, 500, 30, 168, 166, 500, 500, 38, 500, 62, 500, 166, 48, 500, 82, 172, 500, 22, 30, 44, 500, 500, 500, 34, 500, 76, 30, 500, 36, 500, 500, 500, 64, 146, 182, 144, 500, 500, 186, 28, 130, 50, 38, 272, 500, 500, 32, 112, 32, 500, 104, 48, 500, 500, 500, 30, 34, 26, 26, 62, 398, 170, 500, 500, 328, 414, 62, 500, 50, 500, 42, 28, 500, 500, 500, 168, 50, 500, 214, 24, 56, 500, 106, 500, 500, 102, 28, 500, 92, 152]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4018976493351425, "mean_inference_ms": 1.28257508169571, "mean_action_processing_ms": 0.14838751217251045, "mean_env_wait_ms": 0.08910035896033294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023006439208984375, "StateBufferConnector_ms": 0.004790544509887695, "ViewRequirementAgentConnector_ms": 0.1148221492767334}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000, "num_env_steps_sampled": 828000, "num_env_steps_trained": 828000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5501.899694678067, "num_env_steps_trained_throughput_per_sec": 5501.899694678067, "timesteps_total": 828000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 828000, "timers": {"training_iteration_time_ms": 2329.98, "sample_time_ms": 2072.285, "load_time_ms": 11.454, "load_throughput": 1047713.819, "learn_time_ms": 234.231, "learn_throughput": 51231.54, "synch_weights_time_ms": 10.624}, "counters": {"num_env_steps_sampled": 828000, "num_env_steps_trained": 828000, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000}, "done": false, "episodes_total": 3094, "training_iteration": 69, "trial_id": "9f288_00019", "date": "2023-10-25_17-09-12", "timestamp": 1698250152, "time_this_iter_s": 2.186823844909668, "time_total_s": 158.0075716972351, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 158.0075716972351, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 59.9, "ram_util_percent": 27.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.3881317890172025e-22, "cur_lr": 0.0003, "total_loss": 5.819692357381185, "policy_loss": -0.0002686617275079091, "vf_loss": 5.819999885559082, "vf_explained_var": -6.993611653645833e-07, "kl": 0.0005100844862795384, "entropy": 0.3900096654891968, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1043.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 840000, "num_env_steps_trained": 840000, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.4529999999998076, "episode_len_mean": 271.06, "episode_media": {}, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 35.500000000000036, 31.900000000000013, 35.70000000000003, -50.00000000000044, -50.00000000000044, 31.500000000000007, 47.3, 37.10000000000003, 45.1, 46.3, 22.899999999999885, -50.00000000000044, -50.00000000000044, 46.9, 38.90000000000002, 46.9, -50.00000000000044, 39.70000000000002, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 46.699999999999996, 47.5, 47.5, 43.900000000000006, 10.299999999999706, 33.10000000000003, -50.00000000000044, -50.00000000000044, 17.299999999999805, 8.699999999999683, 43.900000000000006, -50.00000000000044, 45.1, -50.00000000000044, 45.9, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.30000000000003, 45.1, -50.00000000000044, 28.699999999999967, 47.7, 44.5, -50.00000000000044, 39.50000000000002, -50.00000000000044, -50.00000000000044, 39.90000000000002, 47.3, -50.00000000000044, 40.90000000000002, 34.900000000000034, -50.00000000000044, -50.00000000000044, 44.300000000000004, 45.9, 46.699999999999996, -50.00000000000044, 21.699999999999868, 46.3, 38.300000000000026, 42.70000000000001, 38.700000000000024, 21.299999999999862, 44.10000000000001, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 44.900000000000006, 38.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, 44.7, 46.9, -50.00000000000044, 18.899999999999828, -50.00000000000044, 34.70000000000004, -50.00000000000044, -50.00000000000044, 16.499999999999794, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 36, 500, 500, 500, 64, 146, 182, 144, 500, 500, 186, 28, 130, 50, 38, 272, 500, 500, 32, 112, 32, 500, 104, 48, 500, 500, 500, 30, 34, 26, 26, 62, 398, 170, 500, 500, 328, 414, 62, 500, 50, 500, 42, 28, 500, 500, 500, 168, 50, 500, 214, 24, 56, 500, 106, 500, 500, 102, 28, 500, 92, 152, 500, 500, 58, 42, 34, 500, 284, 38, 118, 74, 114, 288, 60, 50, 500, 500, 500, 500, 32, 52, 120, 500, 500, 500, 88, 500, 54, 32, 500, 312, 500, 154, 500, 500, 336, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40191827765395666, "mean_inference_ms": 1.2822257950374956, "mean_action_processing_ms": 0.14812216530880393, "mean_env_wait_ms": 0.0890436636566517, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025888681411743164, "StateBufferConnector_ms": 0.006328105926513672, "ViewRequirementAgentConnector_ms": 0.1267101764678955}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.4529999999998076, "episode_len_mean": 271.06, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 35.500000000000036, 31.900000000000013, 35.70000000000003, -50.00000000000044, -50.00000000000044, 31.500000000000007, 47.3, 37.10000000000003, 45.1, 46.3, 22.899999999999885, -50.00000000000044, -50.00000000000044, 46.9, 38.90000000000002, 46.9, -50.00000000000044, 39.70000000000002, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 46.699999999999996, 47.5, 47.5, 43.900000000000006, 10.299999999999706, 33.10000000000003, -50.00000000000044, -50.00000000000044, 17.299999999999805, 8.699999999999683, 43.900000000000006, -50.00000000000044, 45.1, -50.00000000000044, 45.9, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.30000000000003, 45.1, -50.00000000000044, 28.699999999999967, 47.7, 44.5, -50.00000000000044, 39.50000000000002, -50.00000000000044, -50.00000000000044, 39.90000000000002, 47.3, -50.00000000000044, 40.90000000000002, 34.900000000000034, -50.00000000000044, -50.00000000000044, 44.300000000000004, 45.9, 46.699999999999996, -50.00000000000044, 21.699999999999868, 46.3, 38.300000000000026, 42.70000000000001, 38.700000000000024, 21.299999999999862, 44.10000000000001, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 44.900000000000006, 38.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, 44.7, 46.9, -50.00000000000044, 18.899999999999828, -50.00000000000044, 34.70000000000004, -50.00000000000044, -50.00000000000044, 16.499999999999794, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 36, 500, 500, 500, 64, 146, 182, 144, 500, 500, 186, 28, 130, 50, 38, 272, 500, 500, 32, 112, 32, 500, 104, 48, 500, 500, 500, 30, 34, 26, 26, 62, 398, 170, 500, 500, 328, 414, 62, 500, 50, 500, 42, 28, 500, 500, 500, 168, 50, 500, 214, 24, 56, 500, 106, 500, 500, 102, 28, 500, 92, 152, 500, 500, 58, 42, 34, 500, 284, 38, 118, 74, 114, 288, 60, 50, 500, 500, 500, 500, 32, 52, 120, 500, 500, 500, 88, 500, 54, 32, 500, 312, 500, 154, 500, 500, 336, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40191827765395666, "mean_inference_ms": 1.2822257950374956, "mean_action_processing_ms": 0.14812216530880393, "mean_env_wait_ms": 0.0890436636566517, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025888681411743164, "StateBufferConnector_ms": 0.006328105926513672, "ViewRequirementAgentConnector_ms": 0.1267101764678955}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000, "num_env_steps_sampled": 840000, "num_env_steps_trained": 840000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5778.985000965046, "num_env_steps_trained_throughput_per_sec": 5778.985000965046, "timesteps_total": 840000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 840000, "timers": {"training_iteration_time_ms": 2291.591, "sample_time_ms": 2046.356, "load_time_ms": 11.151, "load_throughput": 1076117.892, "learn_time_ms": 222.223, "learn_throughput": 53999.725, "synch_weights_time_ms": 10.461}, "counters": {"num_env_steps_sampled": 840000, "num_env_steps_trained": 840000, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000}, "done": false, "episodes_total": 3131, "training_iteration": 70, "trial_id": "9f288_00019", "date": "2023-10-25_17-09-14", "timestamp": 1698250154, "time_this_iter_s": 2.081486701965332, "time_total_s": 160.08905839920044, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 160.08905839920044, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 60.199999999999996, "ram_util_percent": 27.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.6940658945086012e-22, "cur_lr": 0.0003, "total_loss": 6.417104085286458, "policy_loss": -9.924620389938355e-05, "vf_loss": 6.417241477966309, "vf_explained_var": -1.7325083414713542e-06, "kl": 0.0001626662877280675, "entropy": 0.3822015345096588, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1058.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 852000, "num_env_steps_trained": 852000, "num_agent_steps_sampled": 852000, "num_agent_steps_trained": 852000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.8579999999998074, "episode_len_mean": 272.0, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [33.30000000000003, 45.1, -50.00000000000044, 28.699999999999967, 47.7, 44.5, -50.00000000000044, 39.50000000000002, -50.00000000000044, -50.00000000000044, 39.90000000000002, 47.3, -50.00000000000044, 40.90000000000002, 34.900000000000034, -50.00000000000044, -50.00000000000044, 44.300000000000004, 45.9, 46.699999999999996, -50.00000000000044, 21.699999999999868, 46.3, 38.300000000000026, 42.70000000000001, 38.700000000000024, 21.299999999999862, 44.10000000000001, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 44.900000000000006, 38.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, 44.7, 46.9, -50.00000000000044, 18.899999999999828, -50.00000000000044, 34.70000000000004, -50.00000000000044, -50.00000000000044, 16.499999999999794, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 41.500000000000014, 47.3, 47.5, 30.29999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 44.5, -50.00000000000044, 41.30000000000001, 29.899999999999984, -50.00000000000044, 44.300000000000004, 43.7, -50.00000000000044, -50.00000000000044, 28.29999999999996, 40.500000000000014, 29.69999999999998, -50.00000000000044, 44.10000000000001, 47.5, 47.9, 28.699999999999967, 43.50000000000001, -50.00000000000044, -50.00000000000044, 24.299999999999905, 42.10000000000001, -50.00000000000044, -50.00000000000044, 47.1, 38.50000000000003, 25.099999999999916, -50.00000000000044, -50.00000000000044, 28.29999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 47.5, 46.5], "episode_lengths": [168, 50, 500, 214, 24, 56, 500, 106, 500, 500, 102, 28, 500, 92, 152, 500, 500, 58, 42, 34, 500, 284, 38, 118, 74, 114, 288, 60, 50, 500, 500, 500, 500, 32, 52, 120, 500, 500, 500, 88, 500, 54, 32, 500, 312, 500, 154, 500, 500, 336, 500, 500, 500, 44, 86, 28, 26, 198, 500, 500, 500, 58, 500, 56, 500, 88, 202, 500, 58, 64, 500, 500, 218, 96, 204, 500, 60, 26, 22, 214, 66, 500, 500, 258, 80, 500, 500, 30, 116, 250, 500, 500, 218, 500, 500, 500, 40, 500, 26, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.401632436426633, "mean_inference_ms": 1.2810438518427631, "mean_action_processing_ms": 0.14810556232490493, "mean_env_wait_ms": 0.08909766733922153, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02392411231994629, "StateBufferConnector_ms": 0.008345842361450195, "ViewRequirementAgentConnector_ms": 0.13901472091674805}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.8579999999998074, "episode_len_mean": 272.0, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [33.30000000000003, 45.1, -50.00000000000044, 28.699999999999967, 47.7, 44.5, -50.00000000000044, 39.50000000000002, -50.00000000000044, -50.00000000000044, 39.90000000000002, 47.3, -50.00000000000044, 40.90000000000002, 34.900000000000034, -50.00000000000044, -50.00000000000044, 44.300000000000004, 45.9, 46.699999999999996, -50.00000000000044, 21.699999999999868, 46.3, 38.300000000000026, 42.70000000000001, 38.700000000000024, 21.299999999999862, 44.10000000000001, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 44.900000000000006, 38.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, 44.7, 46.9, -50.00000000000044, 18.899999999999828, -50.00000000000044, 34.70000000000004, -50.00000000000044, -50.00000000000044, 16.499999999999794, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 41.500000000000014, 47.3, 47.5, 30.29999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 44.5, -50.00000000000044, 41.30000000000001, 29.899999999999984, -50.00000000000044, 44.300000000000004, 43.7, -50.00000000000044, -50.00000000000044, 28.29999999999996, 40.500000000000014, 29.69999999999998, -50.00000000000044, 44.10000000000001, 47.5, 47.9, 28.699999999999967, 43.50000000000001, -50.00000000000044, -50.00000000000044, 24.299999999999905, 42.10000000000001, -50.00000000000044, -50.00000000000044, 47.1, 38.50000000000003, 25.099999999999916, -50.00000000000044, -50.00000000000044, 28.29999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 47.5, 46.5], "episode_lengths": [168, 50, 500, 214, 24, 56, 500, 106, 500, 500, 102, 28, 500, 92, 152, 500, 500, 58, 42, 34, 500, 284, 38, 118, 74, 114, 288, 60, 50, 500, 500, 500, 500, 32, 52, 120, 500, 500, 500, 88, 500, 54, 32, 500, 312, 500, 154, 500, 500, 336, 500, 500, 500, 44, 86, 28, 26, 198, 500, 500, 500, 58, 500, 56, 500, 88, 202, 500, 58, 64, 500, 500, 218, 96, 204, 500, 60, 26, 22, 214, 66, 500, 500, 258, 80, 500, 500, 30, 116, 250, 500, 500, 218, 500, 500, 500, 40, 500, 26, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.401632436426633, "mean_inference_ms": 1.2810438518427631, "mean_action_processing_ms": 0.14810556232490493, "mean_env_wait_ms": 0.08909766733922153, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02392411231994629, "StateBufferConnector_ms": 0.008345842361450195, "ViewRequirementAgentConnector_ms": 0.13901472091674805}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 852000, "num_agent_steps_trained": 852000, "num_env_steps_sampled": 852000, "num_env_steps_trained": 852000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5468.771004315114, "num_env_steps_trained_throughput_per_sec": 5468.771004315114, "timesteps_total": 852000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 852000, "timers": {"training_iteration_time_ms": 2271.912, "sample_time_ms": 2026.172, "load_time_ms": 10.936, "load_throughput": 1097272.018, "learn_time_ms": 223.073, "learn_throughput": 53793.939, "synch_weights_time_ms": 10.231}, "counters": {"num_env_steps_sampled": 852000, "num_env_steps_trained": 852000, "num_agent_steps_sampled": 852000, "num_agent_steps_trained": 852000}, "done": false, "episodes_total": 3179, "training_iteration": 71, "trial_id": "9f288_00019", "date": "2023-10-25_17-09-16", "timestamp": 1698250156, "time_this_iter_s": 2.1989707946777344, "time_total_s": 162.28802919387817, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 162.28802919387817, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 63.63333333333333, "ram_util_percent": 27.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.470329472543006e-23, "cur_lr": 0.0003, "total_loss": 6.285232702891032, "policy_loss": -0.00019052674372990925, "vf_loss": 6.285466416676839, "vf_explained_var": -8.54333241780599e-07, "kl": 0.00033799932565822626, "entropy": 0.43097522656122844, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1073.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 864000, "num_env_steps_trained": 864000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.0779999999998027, "episode_len_mean": 269.8, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 16.499999999999794, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 41.500000000000014, 47.3, 47.5, 30.29999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 44.5, -50.00000000000044, 41.30000000000001, 29.899999999999984, -50.00000000000044, 44.300000000000004, 43.7, -50.00000000000044, -50.00000000000044, 28.29999999999996, 40.500000000000014, 29.69999999999998, -50.00000000000044, 44.10000000000001, 47.5, 47.9, 28.699999999999967, 43.50000000000001, -50.00000000000044, -50.00000000000044, 24.299999999999905, 42.10000000000001, -50.00000000000044, -50.00000000000044, 47.1, 38.50000000000003, 25.099999999999916, -50.00000000000044, -50.00000000000044, 28.29999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 47.5, 46.5, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 47.7, -50.00000000000044, 45.9, 39.90000000000002, -50.00000000000044, -50.00000000000044, 9.699999999999697, 46.9, 31.1, 46.9, 22.099999999999874, 46.3, 30.29999999999999, 43.7, 36.10000000000004, 38.90000000000002, 44.10000000000001, 46.699999999999996, 45.7, 45.1, -50.00000000000044, 47.3, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 9.699999999999697, -50.00000000000044, 46.5, 47.3, 44.5, 43.30000000000001, 40.30000000000002, 46.3], "episode_lengths": [500, 500, 336, 500, 500, 500, 44, 86, 28, 26, 198, 500, 500, 500, 58, 500, 56, 500, 88, 202, 500, 58, 64, 500, 500, 218, 96, 204, 500, 60, 26, 22, 214, 66, 500, 500, 258, 80, 500, 500, 30, 116, 250, 500, 500, 218, 500, 500, 500, 40, 500, 26, 36, 500, 42, 500, 500, 500, 500, 500, 500, 44, 24, 500, 42, 102, 500, 500, 404, 32, 190, 32, 280, 38, 198, 64, 140, 112, 60, 34, 44, 50, 500, 28, 42, 500, 500, 500, 500, 500, 500, 46, 404, 500, 36, 28, 56, 68, 98, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40103854274390144, "mean_inference_ms": 1.2797426248308983, "mean_action_processing_ms": 0.14855486885084082, "mean_env_wait_ms": 0.08920485661245828, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018020153045654297, "StateBufferConnector_ms": 0.006779193878173828, "ViewRequirementAgentConnector_ms": 0.12100958824157715}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.0779999999998027, "episode_len_mean": 269.8, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 16.499999999999794, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 41.500000000000014, 47.3, 47.5, 30.29999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 44.5, -50.00000000000044, 41.30000000000001, 29.899999999999984, -50.00000000000044, 44.300000000000004, 43.7, -50.00000000000044, -50.00000000000044, 28.29999999999996, 40.500000000000014, 29.69999999999998, -50.00000000000044, 44.10000000000001, 47.5, 47.9, 28.699999999999967, 43.50000000000001, -50.00000000000044, -50.00000000000044, 24.299999999999905, 42.10000000000001, -50.00000000000044, -50.00000000000044, 47.1, 38.50000000000003, 25.099999999999916, -50.00000000000044, -50.00000000000044, 28.29999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 47.5, 46.5, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 47.7, -50.00000000000044, 45.9, 39.90000000000002, -50.00000000000044, -50.00000000000044, 9.699999999999697, 46.9, 31.1, 46.9, 22.099999999999874, 46.3, 30.29999999999999, 43.7, 36.10000000000004, 38.90000000000002, 44.10000000000001, 46.699999999999996, 45.7, 45.1, -50.00000000000044, 47.3, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 9.699999999999697, -50.00000000000044, 46.5, 47.3, 44.5, 43.30000000000001, 40.30000000000002, 46.3], "episode_lengths": [500, 500, 336, 500, 500, 500, 44, 86, 28, 26, 198, 500, 500, 500, 58, 500, 56, 500, 88, 202, 500, 58, 64, 500, 500, 218, 96, 204, 500, 60, 26, 22, 214, 66, 500, 500, 258, 80, 500, 500, 30, 116, 250, 500, 500, 218, 500, 500, 500, 40, 500, 26, 36, 500, 42, 500, 500, 500, 500, 500, 500, 44, 24, 500, 42, 102, 500, 500, 404, 32, 190, 32, 280, 38, 198, 64, 140, 112, 60, 34, 44, 50, 500, 28, 42, 500, 500, 500, 500, 500, 500, 46, 404, 500, 36, 28, 56, 68, 98, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40103854274390144, "mean_inference_ms": 1.2797426248308983, "mean_action_processing_ms": 0.14855486885084082, "mean_env_wait_ms": 0.08920485661245828, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018020153045654297, "StateBufferConnector_ms": 0.006779193878173828, "ViewRequirementAgentConnector_ms": 0.12100958824157715}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000, "num_env_steps_sampled": 864000, "num_env_steps_trained": 864000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5663.742052397295, "num_env_steps_trained_throughput_per_sec": 5663.742052397295, "timesteps_total": 864000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 864000, "timers": {"training_iteration_time_ms": 2250.288, "sample_time_ms": 2004.896, "load_time_ms": 11.113, "load_throughput": 1079839.606, "learn_time_ms": 222.801, "learn_throughput": 53859.66, "synch_weights_time_ms": 9.879}, "counters": {"num_env_steps_sampled": 864000, "num_env_steps_trained": 864000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "done": false, "episodes_total": 3226, "training_iteration": 72, "trial_id": "9f288_00019", "date": "2023-10-25_17-09-19", "timestamp": 1698250159, "time_this_iter_s": 2.1247355937957764, "time_total_s": 164.41276478767395, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 164.41276478767395, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 58.79999999999999, "ram_util_percent": 27.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.235164736271503e-23, "cur_lr": 0.0003, "total_loss": 6.469054921468099, "policy_loss": -0.0003930812080701192, "vf_loss": 6.469493007659912, "vf_explained_var": -1.1920928955078125e-06, "kl": 0.00040420801669824866, "entropy": 0.44911421140034996, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1088.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 876000, "num_env_steps_trained": 876000, "num_agent_steps_sampled": 876000, "num_agent_steps_trained": 876000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.072000000000214, "episode_len_mean": 281.26, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [25.099999999999916, -50.00000000000044, -50.00000000000044, 28.29999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 47.5, 46.5, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 47.7, -50.00000000000044, 45.9, 39.90000000000002, -50.00000000000044, -50.00000000000044, 9.699999999999697, 46.9, 31.1, 46.9, 22.099999999999874, 46.3, 30.29999999999999, 43.7, 36.10000000000004, 38.90000000000002, 44.10000000000001, 46.699999999999996, 45.7, 45.1, -50.00000000000044, 47.3, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 9.699999999999697, -50.00000000000044, 46.5, 47.3, 44.5, 43.30000000000001, 40.30000000000002, 46.3, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 46.099999999999994, 46.099999999999994, 46.5, 46.3, 47.3, 45.9, 34.30000000000004, -50.00000000000044, 17.499999999999808, 44.5, -50.00000000000044, 46.5, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 38.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.099999999999774, 46.9, 46.699999999999996, -50.00000000000044, -50.00000000000044, 30.29999999999999], "episode_lengths": [250, 500, 500, 218, 500, 500, 500, 40, 500, 26, 36, 500, 42, 500, 500, 500, 500, 500, 500, 44, 24, 500, 42, 102, 500, 500, 404, 32, 190, 32, 280, 38, 198, 64, 140, 112, 60, 34, 44, 50, 500, 28, 42, 500, 500, 500, 500, 500, 500, 46, 404, 500, 36, 28, 56, 68, 98, 38, 500, 76, 500, 500, 500, 46, 500, 500, 40, 40, 36, 38, 28, 42, 158, 500, 326, 56, 500, 36, 500, 48, 500, 500, 42, 500, 500, 500, 34, 500, 120, 500, 500, 500, 500, 500, 350, 32, 34, 500, 500, 198]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40039171788972827, "mean_inference_ms": 1.2790581093557458, "mean_action_processing_ms": 0.14836007429330345, "mean_env_wait_ms": 0.08913869879415369, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018974781036376953, "StateBufferConnector_ms": 0.006003141403198242, "ViewRequirementAgentConnector_ms": 0.13004136085510254}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.072000000000214, "episode_len_mean": 281.26, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [25.099999999999916, -50.00000000000044, -50.00000000000044, 28.29999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 47.5, 46.5, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 47.7, -50.00000000000044, 45.9, 39.90000000000002, -50.00000000000044, -50.00000000000044, 9.699999999999697, 46.9, 31.1, 46.9, 22.099999999999874, 46.3, 30.29999999999999, 43.7, 36.10000000000004, 38.90000000000002, 44.10000000000001, 46.699999999999996, 45.7, 45.1, -50.00000000000044, 47.3, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 9.699999999999697, -50.00000000000044, 46.5, 47.3, 44.5, 43.30000000000001, 40.30000000000002, 46.3, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 46.099999999999994, 46.099999999999994, 46.5, 46.3, 47.3, 45.9, 34.30000000000004, -50.00000000000044, 17.499999999999808, 44.5, -50.00000000000044, 46.5, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 38.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.099999999999774, 46.9, 46.699999999999996, -50.00000000000044, -50.00000000000044, 30.29999999999999], "episode_lengths": [250, 500, 500, 218, 500, 500, 500, 40, 500, 26, 36, 500, 42, 500, 500, 500, 500, 500, 500, 44, 24, 500, 42, 102, 500, 500, 404, 32, 190, 32, 280, 38, 198, 64, 140, 112, 60, 34, 44, 50, 500, 28, 42, 500, 500, 500, 500, 500, 500, 46, 404, 500, 36, 28, 56, 68, 98, 38, 500, 76, 500, 500, 500, 46, 500, 500, 40, 40, 36, 38, 28, 42, 158, 500, 326, 56, 500, 36, 500, 48, 500, 500, 42, 500, 500, 500, 34, 500, 120, 500, 500, 500, 500, 500, 350, 32, 34, 500, 500, 198]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40039171788972827, "mean_inference_ms": 1.2790581093557458, "mean_action_processing_ms": 0.14836007429330345, "mean_env_wait_ms": 0.08913869879415369, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018974781036376953, "StateBufferConnector_ms": 0.006003141403198242, "ViewRequirementAgentConnector_ms": 0.13004136085510254}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 876000, "num_agent_steps_trained": 876000, "num_env_steps_sampled": 876000, "num_env_steps_trained": 876000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5234.7470570462665, "num_env_steps_trained_throughput_per_sec": 5234.7470570462665, "timesteps_total": 876000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 876000, "timers": {"training_iteration_time_ms": 2238.022, "sample_time_ms": 1987.807, "load_time_ms": 11.424, "load_throughput": 1050420.802, "learn_time_ms": 227.205, "learn_throughput": 52815.658, "synch_weights_time_ms": 9.786}, "counters": {"num_env_steps_sampled": 876000, "num_env_steps_trained": 876000, "num_agent_steps_sampled": 876000, "num_agent_steps_trained": 876000}, "done": false, "episodes_total": 3268, "training_iteration": 73, "trial_id": "9f288_00019", "date": "2023-10-25_17-09-21", "timestamp": 1698250161, "time_this_iter_s": 2.2973697185516357, "time_total_s": 166.7101345062256, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 166.7101345062256, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 59.025000000000006, "ram_util_percent": 27.25}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.1175823681357516e-23, "cur_lr": 0.0003, "total_loss": 6.769481563568116, "policy_loss": 1.3452147444089254e-05, "vf_loss": 6.769509983062744, "vf_explained_var": -5.880991617838542e-07, "kl": 0.0002442425070569243, "entropy": 0.41852436860402426, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1103.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 888000, "num_env_steps_trained": 888000, "num_agent_steps_sampled": 888000, "num_agent_steps_trained": 888000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.0539999999998098, "episode_len_mean": 260.04, "episode_media": {}, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.5, 47.3, 44.5, 43.30000000000001, 40.30000000000002, 46.3, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 46.099999999999994, 46.099999999999994, 46.5, 46.3, 47.3, 45.9, 34.30000000000004, -50.00000000000044, 17.499999999999808, 44.5, -50.00000000000044, 46.5, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 38.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.099999999999774, 46.9, 46.699999999999996, -50.00000000000044, -50.00000000000044, 30.29999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.50000000000003, 46.699999999999996, 35.900000000000034, 33.10000000000003, 22.299999999999876, 46.3, -50.00000000000044, 47.1, 47.1, 45.7, 33.30000000000003, -50.00000000000044, 46.3, 42.500000000000014, 41.100000000000016, -50.00000000000044, -50.00000000000044, 43.50000000000001, 47.5, -50.00000000000044, 46.5, 15.699999999999783, 42.70000000000001, 35.500000000000036, 41.30000000000001, -50.00000000000044, 46.699999999999996, -50.00000000000044, 46.3, 47.7, 46.9, -50.00000000000044, 39.300000000000026, 36.900000000000034, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 43.30000000000001, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.49999999999998, 46.5], "episode_lengths": [500, 36, 28, 56, 68, 98, 38, 500, 76, 500, 500, 500, 46, 500, 500, 40, 40, 36, 38, 28, 42, 158, 500, 326, 56, 500, 36, 500, 48, 500, 500, 42, 500, 500, 500, 34, 500, 120, 500, 500, 500, 500, 500, 350, 32, 34, 500, 500, 198, 500, 500, 500, 500, 136, 34, 142, 170, 278, 38, 500, 30, 30, 44, 168, 500, 38, 76, 90, 500, 500, 66, 26, 500, 36, 344, 74, 146, 88, 500, 34, 500, 38, 24, 32, 500, 108, 132, 30, 500, 500, 500, 74, 500, 68, 64, 500, 500, 500, 206, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3996493710401922, "mean_inference_ms": 1.2777706291484725, "mean_action_processing_ms": 0.14822040475856396, "mean_env_wait_ms": 0.08916454602087195, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018992185592651367, "StateBufferConnector_ms": 0.005000591278076172, "ViewRequirementAgentConnector_ms": 0.12290811538696289}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.0539999999998098, "episode_len_mean": 260.04, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.5, 47.3, 44.5, 43.30000000000001, 40.30000000000002, 46.3, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 46.099999999999994, 46.099999999999994, 46.5, 46.3, 47.3, 45.9, 34.30000000000004, -50.00000000000044, 17.499999999999808, 44.5, -50.00000000000044, 46.5, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 38.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.099999999999774, 46.9, 46.699999999999996, -50.00000000000044, -50.00000000000044, 30.29999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.50000000000003, 46.699999999999996, 35.900000000000034, 33.10000000000003, 22.299999999999876, 46.3, -50.00000000000044, 47.1, 47.1, 45.7, 33.30000000000003, -50.00000000000044, 46.3, 42.500000000000014, 41.100000000000016, -50.00000000000044, -50.00000000000044, 43.50000000000001, 47.5, -50.00000000000044, 46.5, 15.699999999999783, 42.70000000000001, 35.500000000000036, 41.30000000000001, -50.00000000000044, 46.699999999999996, -50.00000000000044, 46.3, 47.7, 46.9, -50.00000000000044, 39.300000000000026, 36.900000000000034, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 43.30000000000001, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.49999999999998, 46.5], "episode_lengths": [500, 36, 28, 56, 68, 98, 38, 500, 76, 500, 500, 500, 46, 500, 500, 40, 40, 36, 38, 28, 42, 158, 500, 326, 56, 500, 36, 500, 48, 500, 500, 42, 500, 500, 500, 34, 500, 120, 500, 500, 500, 500, 500, 350, 32, 34, 500, 500, 198, 500, 500, 500, 500, 136, 34, 142, 170, 278, 38, 500, 30, 30, 44, 168, 500, 38, 76, 90, 500, 500, 66, 26, 500, 36, 344, 74, 146, 88, 500, 34, 500, 38, 24, 32, 500, 108, 132, 30, 500, 500, 500, 74, 500, 68, 64, 500, 500, 500, 206, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3996493710401922, "mean_inference_ms": 1.2777706291484725, "mean_action_processing_ms": 0.14822040475856396, "mean_env_wait_ms": 0.08916454602087195, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018992185592651367, "StateBufferConnector_ms": 0.005000591278076172, "ViewRequirementAgentConnector_ms": 0.12290811538696289}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 888000, "num_agent_steps_trained": 888000, "num_env_steps_sampled": 888000, "num_env_steps_trained": 888000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5623.251994552339, "num_env_steps_trained_throughput_per_sec": 5623.251994552339, "timesteps_total": 888000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 888000, "timers": {"training_iteration_time_ms": 2214.856, "sample_time_ms": 1964.493, "load_time_ms": 11.624, "load_throughput": 1032319.124, "learn_time_ms": 227.211, "learn_throughput": 52814.411, "synch_weights_time_ms": 9.828}, "counters": {"num_env_steps_sampled": 888000, "num_env_steps_trained": 888000, "num_agent_steps_sampled": 888000, "num_agent_steps_trained": 888000}, "done": false, "episodes_total": 3319, "training_iteration": 74, "trial_id": "9f288_00019", "date": "2023-10-25_17-09-23", "timestamp": 1698250163, "time_this_iter_s": 2.1404526233673096, "time_total_s": 168.8505871295929, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 168.8505871295929, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 61.6, "ram_util_percent": 27.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.0587911840678758e-23, "cur_lr": 0.0003, "total_loss": 6.374764696756999, "policy_loss": -0.0001085956891377767, "vf_loss": 6.3749186833699545, "vf_explained_var": -1.0728836059570312e-06, "kl": 0.00016882856027298961, "entropy": 0.4552889883518219, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1118.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 900000, "num_env_steps_trained": 900000, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.157999999999861, "episode_len_mean": 219.12, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 36.50000000000003, 46.699999999999996, 35.900000000000034, 33.10000000000003, 22.299999999999876, 46.3, -50.00000000000044, 47.1, 47.1, 45.7, 33.30000000000003, -50.00000000000044, 46.3, 42.500000000000014, 41.100000000000016, -50.00000000000044, -50.00000000000044, 43.50000000000001, 47.5, -50.00000000000044, 46.5, 15.699999999999783, 42.70000000000001, 35.500000000000036, 41.30000000000001, -50.00000000000044, 46.699999999999996, -50.00000000000044, 46.3, 47.7, 46.9, -50.00000000000044, 39.300000000000026, 36.900000000000034, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 43.30000000000001, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.49999999999998, 46.5, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, 46.3, 31.300000000000004, 43.10000000000001, 45.7, -50.00000000000044, 38.10000000000002, 16.09999999999979, -50.00000000000044, -50.00000000000044, 47.7, 41.100000000000016, 42.500000000000014, 46.5, 22.899999999999885, 14.499999999999766, 46.5, 35.30000000000004, 38.300000000000026, 46.3, 41.70000000000002, -50.00000000000044, -50.00000000000044, 40.70000000000002, 44.900000000000006, 46.5, 40.70000000000002, 45.9, 22.49999999999988, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 43.7, 28.89999999999997, 40.10000000000002, 43.900000000000006, -50.00000000000044, 46.699999999999996, 42.70000000000001, 39.300000000000026, 46.3, 44.5, -50.00000000000044, 19.499999999999837, 44.7, -50.00000000000044, 46.5, 44.7], "episode_lengths": [500, 136, 34, 142, 170, 278, 38, 500, 30, 30, 44, 168, 500, 38, 76, 90, 500, 500, 66, 26, 500, 36, 344, 74, 146, 88, 500, 34, 500, 38, 24, 32, 500, 108, 132, 30, 500, 500, 500, 74, 500, 68, 64, 500, 500, 500, 206, 36, 500, 94, 500, 500, 38, 188, 70, 44, 500, 120, 340, 500, 500, 24, 90, 76, 36, 272, 356, 36, 148, 118, 38, 84, 500, 500, 94, 52, 36, 94, 42, 276, 500, 48, 500, 500, 64, 212, 100, 62, 500, 34, 74, 108, 38, 56, 500, 306, 54, 500, 36, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3993770961254273, "mean_inference_ms": 1.2771054892048146, "mean_action_processing_ms": 0.14846201215911983, "mean_env_wait_ms": 0.08894371352144603, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025999784469604492, "StateBufferConnector_ms": 0.0069997310638427734, "ViewRequirementAgentConnector_ms": 0.11303377151489258}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.157999999999861, "episode_len_mean": 219.12, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 36.50000000000003, 46.699999999999996, 35.900000000000034, 33.10000000000003, 22.299999999999876, 46.3, -50.00000000000044, 47.1, 47.1, 45.7, 33.30000000000003, -50.00000000000044, 46.3, 42.500000000000014, 41.100000000000016, -50.00000000000044, -50.00000000000044, 43.50000000000001, 47.5, -50.00000000000044, 46.5, 15.699999999999783, 42.70000000000001, 35.500000000000036, 41.30000000000001, -50.00000000000044, 46.699999999999996, -50.00000000000044, 46.3, 47.7, 46.9, -50.00000000000044, 39.300000000000026, 36.900000000000034, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 43.30000000000001, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.49999999999998, 46.5, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, 46.3, 31.300000000000004, 43.10000000000001, 45.7, -50.00000000000044, 38.10000000000002, 16.09999999999979, -50.00000000000044, -50.00000000000044, 47.7, 41.100000000000016, 42.500000000000014, 46.5, 22.899999999999885, 14.499999999999766, 46.5, 35.30000000000004, 38.300000000000026, 46.3, 41.70000000000002, -50.00000000000044, -50.00000000000044, 40.70000000000002, 44.900000000000006, 46.5, 40.70000000000002, 45.9, 22.49999999999988, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 43.7, 28.89999999999997, 40.10000000000002, 43.900000000000006, -50.00000000000044, 46.699999999999996, 42.70000000000001, 39.300000000000026, 46.3, 44.5, -50.00000000000044, 19.499999999999837, 44.7, -50.00000000000044, 46.5, 44.7], "episode_lengths": [500, 136, 34, 142, 170, 278, 38, 500, 30, 30, 44, 168, 500, 38, 76, 90, 500, 500, 66, 26, 500, 36, 344, 74, 146, 88, 500, 34, 500, 38, 24, 32, 500, 108, 132, 30, 500, 500, 500, 74, 500, 68, 64, 500, 500, 500, 206, 36, 500, 94, 500, 500, 38, 188, 70, 44, 500, 120, 340, 500, 500, 24, 90, 76, 36, 272, 356, 36, 148, 118, 38, 84, 500, 500, 94, 52, 36, 94, 42, 276, 500, 48, 500, 500, 64, 212, 100, 62, 500, 34, 74, 108, 38, 56, 500, 306, 54, 500, 36, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3993770961254273, "mean_inference_ms": 1.2771054892048146, "mean_action_processing_ms": 0.14846201215911983, "mean_env_wait_ms": 0.08894371352144603, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025999784469604492, "StateBufferConnector_ms": 0.0069997310638427734, "ViewRequirementAgentConnector_ms": 0.11303377151489258}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000, "num_env_steps_sampled": 900000, "num_env_steps_trained": 900000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5217.977203794889, "num_env_steps_trained_throughput_per_sec": 5217.977203794889, "timesteps_total": 900000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 900000, "timers": {"training_iteration_time_ms": 2201.97, "sample_time_ms": 1945.658, "load_time_ms": 11.945, "load_throughput": 1004595.64, "learn_time_ms": 232.936, "learn_throughput": 51516.349, "synch_weights_time_ms": 9.632}, "counters": {"num_env_steps_sampled": 900000, "num_env_steps_trained": 900000, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000}, "done": false, "episodes_total": 3371, "training_iteration": 75, "trial_id": "9f288_00019", "date": "2023-10-25_17-09-25", "timestamp": 1698250165, "time_this_iter_s": 2.3057382106781006, "time_total_s": 171.156325340271, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 171.156325340271, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 61.06666666666666, "ram_util_percent": 27.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.293955920339379e-24, "cur_lr": 0.0003, "total_loss": 6.156422646840413, "policy_loss": -0.00021288047234217325, "vf_loss": 6.156681474049886, "vf_explained_var": -1.5576680501302083e-06, "kl": 0.0003555426216090988, "entropy": 0.45933220386505125, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1133.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 912000, "num_env_steps_trained": 912000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.022999999999843, "episode_len_mean": 235.46, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 29.49999999999998, 46.5, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, 46.3, 31.300000000000004, 43.10000000000001, 45.7, -50.00000000000044, 38.10000000000002, 16.09999999999979, -50.00000000000044, -50.00000000000044, 47.7, 41.100000000000016, 42.500000000000014, 46.5, 22.899999999999885, 14.499999999999766, 46.5, 35.30000000000004, 38.300000000000026, 46.3, 41.70000000000002, -50.00000000000044, -50.00000000000044, 40.70000000000002, 44.900000000000006, 46.5, 40.70000000000002, 45.9, 22.49999999999988, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 43.7, 28.89999999999997, 40.10000000000002, 43.900000000000006, -50.00000000000044, 46.699999999999996, 42.70000000000001, 39.300000000000026, 46.3, 44.5, -50.00000000000044, 19.499999999999837, 44.7, -50.00000000000044, 46.5, 44.7, -50.00000000000044, 35.500000000000036, 42.70000000000001, 43.30000000000001, 17.299999999999805, -50.00000000000044, -50.00000000000044, 46.3, 15.299999999999777, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 28.09999999999996, 44.7, -50.00000000000044, -50.00000000000044, 38.50000000000003, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 42.70000000000001, 45.7, 25.899999999999928, 4.699999999999626, -50.00000000000044, 46.3, 21.499999999999865, 46.699999999999996, -50.00000000000044, 12.899999999999743, 44.300000000000004, -50.00000000000044, 42.500000000000014, 47.1, 46.699999999999996, 46.9, -50.00000000000044, 45.9, -50.00000000000044, 17.899999999999814, 47.1, 45.1], "episode_lengths": [500, 206, 36, 500, 94, 500, 500, 38, 188, 70, 44, 500, 120, 340, 500, 500, 24, 90, 76, 36, 272, 356, 36, 148, 118, 38, 84, 500, 500, 94, 52, 36, 94, 42, 276, 500, 48, 500, 500, 64, 212, 100, 62, 500, 34, 74, 108, 38, 56, 500, 306, 54, 500, 36, 54, 500, 146, 74, 68, 328, 500, 500, 38, 348, 66, 500, 500, 500, 52, 220, 54, 500, 500, 116, 500, 64, 500, 500, 74, 44, 242, 454, 500, 38, 286, 34, 500, 372, 58, 500, 76, 30, 34, 32, 500, 42, 500, 322, 30, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3995300583166454, "mean_inference_ms": 1.2772098259640396, "mean_action_processing_ms": 0.1483032312542024, "mean_env_wait_ms": 0.08883230057958973, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029002904891967773, "StateBufferConnector_ms": 0.003998279571533203, "ViewRequirementAgentConnector_ms": 0.11800503730773926}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.022999999999843, "episode_len_mean": 235.46, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 29.49999999999998, 46.5, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, 46.3, 31.300000000000004, 43.10000000000001, 45.7, -50.00000000000044, 38.10000000000002, 16.09999999999979, -50.00000000000044, -50.00000000000044, 47.7, 41.100000000000016, 42.500000000000014, 46.5, 22.899999999999885, 14.499999999999766, 46.5, 35.30000000000004, 38.300000000000026, 46.3, 41.70000000000002, -50.00000000000044, -50.00000000000044, 40.70000000000002, 44.900000000000006, 46.5, 40.70000000000002, 45.9, 22.49999999999988, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 43.7, 28.89999999999997, 40.10000000000002, 43.900000000000006, -50.00000000000044, 46.699999999999996, 42.70000000000001, 39.300000000000026, 46.3, 44.5, -50.00000000000044, 19.499999999999837, 44.7, -50.00000000000044, 46.5, 44.7, -50.00000000000044, 35.500000000000036, 42.70000000000001, 43.30000000000001, 17.299999999999805, -50.00000000000044, -50.00000000000044, 46.3, 15.299999999999777, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 28.09999999999996, 44.7, -50.00000000000044, -50.00000000000044, 38.50000000000003, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 42.70000000000001, 45.7, 25.899999999999928, 4.699999999999626, -50.00000000000044, 46.3, 21.499999999999865, 46.699999999999996, -50.00000000000044, 12.899999999999743, 44.300000000000004, -50.00000000000044, 42.500000000000014, 47.1, 46.699999999999996, 46.9, -50.00000000000044, 45.9, -50.00000000000044, 17.899999999999814, 47.1, 45.1], "episode_lengths": [500, 206, 36, 500, 94, 500, 500, 38, 188, 70, 44, 500, 120, 340, 500, 500, 24, 90, 76, 36, 272, 356, 36, 148, 118, 38, 84, 500, 500, 94, 52, 36, 94, 42, 276, 500, 48, 500, 500, 64, 212, 100, 62, 500, 34, 74, 108, 38, 56, 500, 306, 54, 500, 36, 54, 500, 146, 74, 68, 328, 500, 500, 38, 348, 66, 500, 500, 500, 52, 220, 54, 500, 500, 116, 500, 64, 500, 500, 74, 44, 242, 454, 500, 38, 286, 34, 500, 372, 58, 500, 76, 30, 34, 32, 500, 42, 500, 322, 30, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3995300583166454, "mean_inference_ms": 1.2772098259640396, "mean_action_processing_ms": 0.1483032312542024, "mean_env_wait_ms": 0.08883230057958973, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029002904891967773, "StateBufferConnector_ms": 0.003998279571533203, "ViewRequirementAgentConnector_ms": 0.11800503730773926}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000, "num_env_steps_sampled": 912000, "num_env_steps_trained": 912000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5326.136952264751, "num_env_steps_trained_throughput_per_sec": 5326.136952264751, "timesteps_total": 912000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 912000, "timers": {"training_iteration_time_ms": 2193.902, "sample_time_ms": 1927.596, "load_time_ms": 12.858, "load_throughput": 933282.551, "learn_time_ms": 242.087, "learn_throughput": 49569.024, "synch_weights_time_ms": 9.563}, "counters": {"num_env_steps_sampled": 912000, "num_env_steps_trained": 912000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "done": false, "episodes_total": 3416, "training_iteration": 76, "trial_id": "9f288_00019", "date": "2023-10-25_17-09-28", "timestamp": 1698250168, "time_this_iter_s": 2.2580373287200928, "time_total_s": 173.4143626689911, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 173.4143626689911, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 58.63333333333333, "ram_util_percent": 27.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.6469779601696894e-24, "cur_lr": 0.0003, "total_loss": 6.217013168334961, "policy_loss": -0.00038695385058720906, "vf_loss": 6.2174477259318035, "vf_explained_var": -1.2715657552083333e-06, "kl": 0.00039982203492551586, "entropy": 0.4757459859053294, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1148.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 924000, "num_env_steps_trained": 924000, "num_agent_steps_sampled": 924000, "num_agent_steps_trained": 924000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.785999999999816, "episode_len_mean": 262.78, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.10000000000002, 43.900000000000006, -50.00000000000044, 46.699999999999996, 42.70000000000001, 39.300000000000026, 46.3, 44.5, -50.00000000000044, 19.499999999999837, 44.7, -50.00000000000044, 46.5, 44.7, -50.00000000000044, 35.500000000000036, 42.70000000000001, 43.30000000000001, 17.299999999999805, -50.00000000000044, -50.00000000000044, 46.3, 15.299999999999777, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 28.09999999999996, 44.7, -50.00000000000044, -50.00000000000044, 38.50000000000003, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 42.70000000000001, 45.7, 25.899999999999928, 4.699999999999626, -50.00000000000044, 46.3, 21.499999999999865, 46.699999999999996, -50.00000000000044, 12.899999999999743, 44.300000000000004, -50.00000000000044, 42.500000000000014, 47.1, 46.699999999999996, 46.9, -50.00000000000044, 45.9, -50.00000000000044, 17.899999999999814, 47.1, 45.1, -50.00000000000044, 45.1, 40.90000000000002, -50.00000000000044, 45.5, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 39.90000000000002, 34.10000000000004, -50.00000000000044, 32.50000000000002, 47.3, 19.09999999999983, 31.1, 17.499999999999808, 1.4999999999995808, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.099999999999987, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.29999999999999, -50.00000000000044, 1.6999999999995836, 46.5, 39.10000000000002, 33.90000000000004, 45.7, -50.00000000000044, 46.5, -50.00000000000044, 44.7, -50.00000000000044, 41.70000000000002, -50.00000000000044, 39.90000000000002], "episode_lengths": [100, 62, 500, 34, 74, 108, 38, 56, 500, 306, 54, 500, 36, 54, 500, 146, 74, 68, 328, 500, 500, 38, 348, 66, 500, 500, 500, 52, 220, 54, 500, 500, 116, 500, 64, 500, 500, 74, 44, 242, 454, 500, 38, 286, 34, 500, 372, 58, 500, 76, 30, 34, 32, 500, 42, 500, 322, 30, 50, 500, 50, 92, 500, 46, 54, 500, 500, 500, 34, 102, 160, 500, 176, 28, 310, 190, 326, 486, 500, 500, 500, 200, 500, 500, 500, 198, 500, 484, 36, 110, 162, 44, 500, 36, 500, 54, 500, 84, 500, 102]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3996347129248189, "mean_inference_ms": 1.2771046765088336, "mean_action_processing_ms": 0.14760185591526873, "mean_env_wait_ms": 0.08887086284197931, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02800583839416504, "StateBufferConnector_ms": 0.0029985904693603516, "ViewRequirementAgentConnector_ms": 0.1339876651763916}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.785999999999816, "episode_len_mean": 262.78, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [40.10000000000002, 43.900000000000006, -50.00000000000044, 46.699999999999996, 42.70000000000001, 39.300000000000026, 46.3, 44.5, -50.00000000000044, 19.499999999999837, 44.7, -50.00000000000044, 46.5, 44.7, -50.00000000000044, 35.500000000000036, 42.70000000000001, 43.30000000000001, 17.299999999999805, -50.00000000000044, -50.00000000000044, 46.3, 15.299999999999777, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 28.09999999999996, 44.7, -50.00000000000044, -50.00000000000044, 38.50000000000003, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 42.70000000000001, 45.7, 25.899999999999928, 4.699999999999626, -50.00000000000044, 46.3, 21.499999999999865, 46.699999999999996, -50.00000000000044, 12.899999999999743, 44.300000000000004, -50.00000000000044, 42.500000000000014, 47.1, 46.699999999999996, 46.9, -50.00000000000044, 45.9, -50.00000000000044, 17.899999999999814, 47.1, 45.1, -50.00000000000044, 45.1, 40.90000000000002, -50.00000000000044, 45.5, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 39.90000000000002, 34.10000000000004, -50.00000000000044, 32.50000000000002, 47.3, 19.09999999999983, 31.1, 17.499999999999808, 1.4999999999995808, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.099999999999987, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.29999999999999, -50.00000000000044, 1.6999999999995836, 46.5, 39.10000000000002, 33.90000000000004, 45.7, -50.00000000000044, 46.5, -50.00000000000044, 44.7, -50.00000000000044, 41.70000000000002, -50.00000000000044, 39.90000000000002], "episode_lengths": [100, 62, 500, 34, 74, 108, 38, 56, 500, 306, 54, 500, 36, 54, 500, 146, 74, 68, 328, 500, 500, 38, 348, 66, 500, 500, 500, 52, 220, 54, 500, 500, 116, 500, 64, 500, 500, 74, 44, 242, 454, 500, 38, 286, 34, 500, 372, 58, 500, 76, 30, 34, 32, 500, 42, 500, 322, 30, 50, 500, 50, 92, 500, 46, 54, 500, 500, 500, 34, 102, 160, 500, 176, 28, 310, 190, 326, 486, 500, 500, 500, 200, 500, 500, 500, 198, 500, 484, 36, 110, 162, 44, 500, 36, 500, 54, 500, 84, 500, 102]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3996347129248189, "mean_inference_ms": 1.2771046765088336, "mean_action_processing_ms": 0.14760185591526873, "mean_env_wait_ms": 0.08887086284197931, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02800583839416504, "StateBufferConnector_ms": 0.0029985904693603516, "ViewRequirementAgentConnector_ms": 0.1339876651763916}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 924000, "num_agent_steps_trained": 924000, "num_env_steps_sampled": 924000, "num_env_steps_trained": 924000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5826.066865731903, "num_env_steps_trained_throughput_per_sec": 5826.066865731903, "timesteps_total": 924000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 924000, "timers": {"training_iteration_time_ms": 2177.326, "sample_time_ms": 1924.341, "load_time_ms": 11.654, "load_throughput": 1029666.602, "learn_time_ms": 229.969, "learn_throughput": 52180.908, "synch_weights_time_ms": 9.563}, "counters": {"num_env_steps_sampled": 924000, "num_env_steps_trained": 924000, "num_agent_steps_sampled": 924000, "num_agent_steps_trained": 924000}, "done": false, "episodes_total": 3457, "training_iteration": 77, "trial_id": "9f288_00019", "date": "2023-10-25_17-09-30", "timestamp": 1698250170, "time_this_iter_s": 2.064706563949585, "time_total_s": 175.47906923294067, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 175.47906923294067, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 59.166666666666664, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.3234889800848447e-24, "cur_lr": 0.0003, "total_loss": 6.7099567413330075, "policy_loss": -0.00022132731974124908, "vf_loss": 6.710230795542399, "vf_explained_var": -7.073084513346354e-07, "kl": 0.00046946191429621346, "entropy": 0.5275920351346334, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1163.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 936000, "num_env_steps_trained": 936000, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.196999999999827, "episode_len_mean": 253.7, "episode_media": {}, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [47.1, 46.699999999999996, 46.9, -50.00000000000044, 45.9, -50.00000000000044, 17.899999999999814, 47.1, 45.1, -50.00000000000044, 45.1, 40.90000000000002, -50.00000000000044, 45.5, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 39.90000000000002, 34.10000000000004, -50.00000000000044, 32.50000000000002, 47.3, 19.09999999999983, 31.1, 17.499999999999808, 1.4999999999995808, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.099999999999987, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.29999999999999, -50.00000000000044, 1.6999999999995836, 46.5, 39.10000000000002, 33.90000000000004, 45.7, -50.00000000000044, 46.5, -50.00000000000044, 44.7, -50.00000000000044, 41.70000000000002, -50.00000000000044, 39.90000000000002, -50.00000000000044, 1.8999999999995865, 43.10000000000001, -50.00000000000044, 43.10000000000001, 44.5, 42.500000000000014, 18.699999999999825, -50.00000000000044, 43.900000000000006, 14.09999999999976, 46.099999999999994, -50.00000000000044, 45.5, 47.3, 46.5, 44.10000000000001, -50.00000000000044, 36.10000000000004, 45.7, -50.00000000000044, 41.90000000000001, 40.30000000000002, 30.29999999999999, -50.00000000000044, 42.70000000000001, -50.00000000000044, 23.499999999999893, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 31.900000000000013, 44.300000000000004, 46.3, -50.00000000000044, 46.5, 45.1, -50.00000000000044, -50.00000000000044, 45.5, 40.90000000000002, 47.1, 15.299999999999777, 44.300000000000004, 36.30000000000003, 13.299999999999748, 15.099999999999774, 40.500000000000014, 27.099999999999945], "episode_lengths": [30, 34, 32, 500, 42, 500, 322, 30, 50, 500, 50, 92, 500, 46, 54, 500, 500, 500, 34, 102, 160, 500, 176, 28, 310, 190, 326, 486, 500, 500, 500, 200, 500, 500, 500, 198, 500, 484, 36, 110, 162, 44, 500, 36, 500, 54, 500, 84, 500, 102, 500, 482, 70, 500, 70, 56, 76, 314, 500, 62, 360, 40, 500, 46, 28, 36, 60, 500, 140, 44, 500, 82, 98, 198, 500, 74, 500, 266, 500, 44, 500, 500, 182, 58, 38, 500, 36, 50, 500, 500, 46, 92, 30, 348, 58, 138, 368, 350, 96, 230]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.399001853045326, "mean_inference_ms": 1.275782867107624, "mean_action_processing_ms": 0.14755037607159824, "mean_env_wait_ms": 0.08876825450128083, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028000593185424805, "StateBufferConnector_ms": 0.0009992122650146484, "ViewRequirementAgentConnector_ms": 0.13796663284301758}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.196999999999827, "episode_len_mean": 253.7, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [47.1, 46.699999999999996, 46.9, -50.00000000000044, 45.9, -50.00000000000044, 17.899999999999814, 47.1, 45.1, -50.00000000000044, 45.1, 40.90000000000002, -50.00000000000044, 45.5, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 39.90000000000002, 34.10000000000004, -50.00000000000044, 32.50000000000002, 47.3, 19.09999999999983, 31.1, 17.499999999999808, 1.4999999999995808, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.099999999999987, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.29999999999999, -50.00000000000044, 1.6999999999995836, 46.5, 39.10000000000002, 33.90000000000004, 45.7, -50.00000000000044, 46.5, -50.00000000000044, 44.7, -50.00000000000044, 41.70000000000002, -50.00000000000044, 39.90000000000002, -50.00000000000044, 1.8999999999995865, 43.10000000000001, -50.00000000000044, 43.10000000000001, 44.5, 42.500000000000014, 18.699999999999825, -50.00000000000044, 43.900000000000006, 14.09999999999976, 46.099999999999994, -50.00000000000044, 45.5, 47.3, 46.5, 44.10000000000001, -50.00000000000044, 36.10000000000004, 45.7, -50.00000000000044, 41.90000000000001, 40.30000000000002, 30.29999999999999, -50.00000000000044, 42.70000000000001, -50.00000000000044, 23.499999999999893, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 31.900000000000013, 44.300000000000004, 46.3, -50.00000000000044, 46.5, 45.1, -50.00000000000044, -50.00000000000044, 45.5, 40.90000000000002, 47.1, 15.299999999999777, 44.300000000000004, 36.30000000000003, 13.299999999999748, 15.099999999999774, 40.500000000000014, 27.099999999999945], "episode_lengths": [30, 34, 32, 500, 42, 500, 322, 30, 50, 500, 50, 92, 500, 46, 54, 500, 500, 500, 34, 102, 160, 500, 176, 28, 310, 190, 326, 486, 500, 500, 500, 200, 500, 500, 500, 198, 500, 484, 36, 110, 162, 44, 500, 36, 500, 54, 500, 84, 500, 102, 500, 482, 70, 500, 70, 56, 76, 314, 500, 62, 360, 40, 500, 46, 28, 36, 60, 500, 140, 44, 500, 82, 98, 198, 500, 74, 500, 266, 500, 44, 500, 500, 182, 58, 38, 500, 36, 50, 500, 500, 46, 92, 30, 348, 58, 138, 368, 350, 96, 230]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.399001853045326, "mean_inference_ms": 1.275782867107624, "mean_action_processing_ms": 0.14755037607159824, "mean_env_wait_ms": 0.08876825450128083, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028000593185424805, "StateBufferConnector_ms": 0.0009992122650146484, "ViewRequirementAgentConnector_ms": 0.13796663284301758}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000, "num_env_steps_sampled": 936000, "num_env_steps_trained": 936000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5515.546197077065, "num_env_steps_trained_throughput_per_sec": 5515.546197077065, "timesteps_total": 936000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 936000, "timers": {"training_iteration_time_ms": 2178.41, "sample_time_ms": 1919.058, "load_time_ms": 11.954, "load_throughput": 1003846.283, "learn_time_ms": 235.916, "learn_throughput": 50865.635, "synch_weights_time_ms": 9.683}, "counters": {"num_env_steps_sampled": 936000, "num_env_steps_trained": 936000, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000}, "done": false, "episodes_total": 3507, "training_iteration": 78, "trial_id": "9f288_00019", "date": "2023-10-25_17-09-32", "timestamp": 1698250172, "time_this_iter_s": 2.180666923522949, "time_total_s": 177.65973615646362, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 177.65973615646362, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 62.866666666666674, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.617444900424224e-25, "cur_lr": 0.0003, "total_loss": 6.4495115598042805, "policy_loss": -0.00043173606197039285, "vf_loss": 6.449997266133626, "vf_explained_var": -7.947285970052084e-07, "kl": 0.000703887190441795, "entropy": 0.5395950158437093, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1178.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 948000, "num_env_steps_trained": 948000, "num_agent_steps_sampled": 948000, "num_agent_steps_trained": 948000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.8759999999998165, "episode_len_mean": 261.86, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.5, -50.00000000000044, 44.7, -50.00000000000044, 41.70000000000002, -50.00000000000044, 39.90000000000002, -50.00000000000044, 1.8999999999995865, 43.10000000000001, -50.00000000000044, 43.10000000000001, 44.5, 42.500000000000014, 18.699999999999825, -50.00000000000044, 43.900000000000006, 14.09999999999976, 46.099999999999994, -50.00000000000044, 45.5, 47.3, 46.5, 44.10000000000001, -50.00000000000044, 36.10000000000004, 45.7, -50.00000000000044, 41.90000000000001, 40.30000000000002, 30.29999999999999, -50.00000000000044, 42.70000000000001, -50.00000000000044, 23.499999999999893, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 31.900000000000013, 44.300000000000004, 46.3, -50.00000000000044, 46.5, 45.1, -50.00000000000044, -50.00000000000044, 45.5, 40.90000000000002, 47.1, 15.299999999999777, 44.300000000000004, 36.30000000000003, 13.299999999999748, 15.099999999999774, 40.500000000000014, 27.099999999999945, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 46.5, 44.900000000000006, -50.00000000000044, 37.70000000000003, -50.00000000000044, -50.00000000000044, 35.10000000000004, 46.3, 45.3, 39.70000000000002, 38.700000000000024, 17.299999999999805, -50.00000000000044, 45.1, 43.900000000000006, 42.70000000000001, 43.10000000000001, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.10000000000003, 41.70000000000002, -50.00000000000044, 43.10000000000001, 44.900000000000006, 23.499999999999893, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006], "episode_lengths": [36, 500, 54, 500, 84, 500, 102, 500, 482, 70, 500, 70, 56, 76, 314, 500, 62, 360, 40, 500, 46, 28, 36, 60, 500, 140, 44, 500, 82, 98, 198, 500, 74, 500, 266, 500, 44, 500, 500, 182, 58, 38, 500, 36, 50, 500, 500, 46, 92, 30, 348, 58, 138, 368, 350, 96, 230, 500, 80, 500, 500, 500, 60, 500, 36, 52, 500, 124, 500, 500, 150, 38, 48, 104, 114, 328, 500, 50, 62, 74, 70, 500, 500, 50, 500, 500, 500, 500, 170, 84, 500, 70, 52, 266, 500, 500, 500, 500, 500, 62]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3985650820330443, "mean_inference_ms": 1.2748649587460519, "mean_action_processing_ms": 0.1479318606838172, "mean_env_wait_ms": 0.08867000103321232, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017995595932006836, "StateBufferConnector_ms": 0.002998828887939453, "ViewRequirementAgentConnector_ms": 0.11995363235473633}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.8759999999998165, "episode_len_mean": 261.86, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.5, -50.00000000000044, 44.7, -50.00000000000044, 41.70000000000002, -50.00000000000044, 39.90000000000002, -50.00000000000044, 1.8999999999995865, 43.10000000000001, -50.00000000000044, 43.10000000000001, 44.5, 42.500000000000014, 18.699999999999825, -50.00000000000044, 43.900000000000006, 14.09999999999976, 46.099999999999994, -50.00000000000044, 45.5, 47.3, 46.5, 44.10000000000001, -50.00000000000044, 36.10000000000004, 45.7, -50.00000000000044, 41.90000000000001, 40.30000000000002, 30.29999999999999, -50.00000000000044, 42.70000000000001, -50.00000000000044, 23.499999999999893, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 31.900000000000013, 44.300000000000004, 46.3, -50.00000000000044, 46.5, 45.1, -50.00000000000044, -50.00000000000044, 45.5, 40.90000000000002, 47.1, 15.299999999999777, 44.300000000000004, 36.30000000000003, 13.299999999999748, 15.099999999999774, 40.500000000000014, 27.099999999999945, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 46.5, 44.900000000000006, -50.00000000000044, 37.70000000000003, -50.00000000000044, -50.00000000000044, 35.10000000000004, 46.3, 45.3, 39.70000000000002, 38.700000000000024, 17.299999999999805, -50.00000000000044, 45.1, 43.900000000000006, 42.70000000000001, 43.10000000000001, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.10000000000003, 41.70000000000002, -50.00000000000044, 43.10000000000001, 44.900000000000006, 23.499999999999893, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006], "episode_lengths": [36, 500, 54, 500, 84, 500, 102, 500, 482, 70, 500, 70, 56, 76, 314, 500, 62, 360, 40, 500, 46, 28, 36, 60, 500, 140, 44, 500, 82, 98, 198, 500, 74, 500, 266, 500, 44, 500, 500, 182, 58, 38, 500, 36, 50, 500, 500, 46, 92, 30, 348, 58, 138, 368, 350, 96, 230, 500, 80, 500, 500, 500, 60, 500, 36, 52, 500, 124, 500, 500, 150, 38, 48, 104, 114, 328, 500, 50, 62, 74, 70, 500, 500, 50, 500, 500, 500, 500, 170, 84, 500, 70, 52, 266, 500, 500, 500, 500, 500, 62]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3985650820330443, "mean_inference_ms": 1.2748649587460519, "mean_action_processing_ms": 0.1479318606838172, "mean_env_wait_ms": 0.08867000103321232, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017995595932006836, "StateBufferConnector_ms": 0.002998828887939453, "ViewRequirementAgentConnector_ms": 0.11995363235473633}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 948000, "num_agent_steps_trained": 948000, "num_env_steps_sampled": 948000, "num_env_steps_trained": 948000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5284.763401445015, "num_env_steps_trained_throughput_per_sec": 5284.763401445015, "timesteps_total": 948000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 948000, "timers": {"training_iteration_time_ms": 2187.372, "sample_time_ms": 1921.495, "load_time_ms": 12.181, "load_throughput": 985129.552, "learn_time_ms": 242.133, "learn_throughput": 49559.579, "synch_weights_time_ms": 9.585}, "counters": {"num_env_steps_sampled": 948000, "num_env_steps_trained": 948000, "num_agent_steps_sampled": 948000, "num_agent_steps_trained": 948000}, "done": false, "episodes_total": 3550, "training_iteration": 79, "trial_id": "9f288_00019", "date": "2023-10-25_17-09-34", "timestamp": 1698250174, "time_this_iter_s": 2.275677442550659, "time_total_s": 179.93541359901428, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 179.93541359901428, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 59.5, "ram_util_percent": 27.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.308722450212112e-25, "cur_lr": 0.0003, "total_loss": 6.995033168792725, "policy_loss": -0.00011857300996780396, "vf_loss": 6.99520320892334, "vf_explained_var": -1.2874603271484376e-06, "kl": 0.00026179553638030486, "entropy": 0.5139224310715993, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1193.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 960000, "num_env_steps_trained": 960000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.6319999999998023, "episode_len_mean": 284.28, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.3, -50.00000000000044, 46.5, 45.1, -50.00000000000044, -50.00000000000044, 45.5, 40.90000000000002, 47.1, 15.299999999999777, 44.300000000000004, 36.30000000000003, 13.299999999999748, 15.099999999999774, 40.500000000000014, 27.099999999999945, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 46.5, 44.900000000000006, -50.00000000000044, 37.70000000000003, -50.00000000000044, -50.00000000000044, 35.10000000000004, 46.3, 45.3, 39.70000000000002, 38.700000000000024, 17.299999999999805, -50.00000000000044, 45.1, 43.900000000000006, 42.70000000000001, 43.10000000000001, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.10000000000003, 41.70000000000002, -50.00000000000044, 43.10000000000001, 44.900000000000006, 23.499999999999893, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.8999999999999, 42.900000000000006, -50.00000000000044, 12.499999999999737, -50.00000000000044, 38.700000000000024, -50.00000000000044, 39.50000000000002, -50.00000000000044, -50.00000000000044, 43.10000000000001, 34.900000000000034, 43.10000000000001, 2.8999999999996007, -50.00000000000044, 38.700000000000024, 41.30000000000001, -50.00000000000044, 42.900000000000006, -50.00000000000044, 32.700000000000024, 42.900000000000006, 11.099999999999717, 40.90000000000002, 43.900000000000006, 36.70000000000003, -50.00000000000044, -50.00000000000044, 26.69999999999994, -50.00000000000044, 18.099999999999817, -50.00000000000044, 36.50000000000003, 44.900000000000006, 3.2999999999996064, -50.00000000000044, 44.5, 25.499999999999922], "episode_lengths": [38, 500, 36, 50, 500, 500, 46, 92, 30, 348, 58, 138, 368, 350, 96, 230, 500, 80, 500, 500, 500, 60, 500, 36, 52, 500, 124, 500, 500, 150, 38, 48, 104, 114, 328, 500, 50, 62, 74, 70, 500, 500, 50, 500, 500, 500, 500, 170, 84, 500, 70, 52, 266, 500, 500, 500, 500, 500, 62, 500, 500, 500, 262, 72, 500, 376, 500, 114, 500, 106, 500, 500, 70, 152, 70, 472, 500, 114, 88, 500, 72, 500, 174, 72, 390, 92, 62, 134, 500, 500, 234, 500, 320, 500, 136, 52, 468, 500, 56, 246]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39832907917097704, "mean_inference_ms": 1.2738980866040543, "mean_action_processing_ms": 0.1478252737086898, "mean_env_wait_ms": 0.08869161466020976, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021997928619384766, "StateBufferConnector_ms": 0.006997108459472656, "ViewRequirementAgentConnector_ms": 0.11999177932739258}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.6319999999998023, "episode_len_mean": 284.28, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.3, -50.00000000000044, 46.5, 45.1, -50.00000000000044, -50.00000000000044, 45.5, 40.90000000000002, 47.1, 15.299999999999777, 44.300000000000004, 36.30000000000003, 13.299999999999748, 15.099999999999774, 40.500000000000014, 27.099999999999945, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 46.5, 44.900000000000006, -50.00000000000044, 37.70000000000003, -50.00000000000044, -50.00000000000044, 35.10000000000004, 46.3, 45.3, 39.70000000000002, 38.700000000000024, 17.299999999999805, -50.00000000000044, 45.1, 43.900000000000006, 42.70000000000001, 43.10000000000001, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.10000000000003, 41.70000000000002, -50.00000000000044, 43.10000000000001, 44.900000000000006, 23.499999999999893, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.8999999999999, 42.900000000000006, -50.00000000000044, 12.499999999999737, -50.00000000000044, 38.700000000000024, -50.00000000000044, 39.50000000000002, -50.00000000000044, -50.00000000000044, 43.10000000000001, 34.900000000000034, 43.10000000000001, 2.8999999999996007, -50.00000000000044, 38.700000000000024, 41.30000000000001, -50.00000000000044, 42.900000000000006, -50.00000000000044, 32.700000000000024, 42.900000000000006, 11.099999999999717, 40.90000000000002, 43.900000000000006, 36.70000000000003, -50.00000000000044, -50.00000000000044, 26.69999999999994, -50.00000000000044, 18.099999999999817, -50.00000000000044, 36.50000000000003, 44.900000000000006, 3.2999999999996064, -50.00000000000044, 44.5, 25.499999999999922], "episode_lengths": [38, 500, 36, 50, 500, 500, 46, 92, 30, 348, 58, 138, 368, 350, 96, 230, 500, 80, 500, 500, 500, 60, 500, 36, 52, 500, 124, 500, 500, 150, 38, 48, 104, 114, 328, 500, 50, 62, 74, 70, 500, 500, 50, 500, 500, 500, 500, 170, 84, 500, 70, 52, 266, 500, 500, 500, 500, 500, 62, 500, 500, 500, 262, 72, 500, 376, 500, 114, 500, 106, 500, 500, 70, 152, 70, 472, 500, 114, 88, 500, 72, 500, 174, 72, 390, 92, 62, 134, 500, 500, 234, 500, 320, 500, 136, 52, 468, 500, 56, 246]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39832907917097704, "mean_inference_ms": 1.2738980866040543, "mean_action_processing_ms": 0.1478252737086898, "mean_env_wait_ms": 0.08869161466020976, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021997928619384766, "StateBufferConnector_ms": 0.006997108459472656, "ViewRequirementAgentConnector_ms": 0.11999177932739258}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000, "num_env_steps_sampled": 960000, "num_env_steps_trained": 960000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5895.164612367259, "num_env_steps_trained_throughput_per_sec": 5895.164612367259, "timesteps_total": 960000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 960000, "timers": {"training_iteration_time_ms": 2183.379, "sample_time_ms": 1917.368, "load_time_ms": 12.287, "load_throughput": 976659.286, "learn_time_ms": 242.155, "learn_throughput": 49555.031, "synch_weights_time_ms": 9.688}, "counters": {"num_env_steps_sampled": 960000, "num_env_steps_trained": 960000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "done": false, "episodes_total": 3591, "training_iteration": 80, "trial_id": "9f288_00019", "date": "2023-10-25_17-09-36", "timestamp": 1698250176, "time_this_iter_s": 2.0415635108947754, "time_total_s": 181.97697710990906, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 181.97697710990906, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 56.29999999999999, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.654361225106056e-25, "cur_lr": 0.0003, "total_loss": 6.902897675832112, "policy_loss": -0.00023275564114252727, "vf_loss": 6.903188641866048, "vf_explained_var": -8.185704549153645e-07, "kl": 0.0007102057090188888, "entropy": 0.5810028314590454, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1208.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 972000, "num_env_steps_trained": 972000, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.641999999999817, "episode_len_mean": 274.22, "episode_media": {}, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.900000000000006, 23.499999999999893, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.8999999999999, 42.900000000000006, -50.00000000000044, 12.499999999999737, -50.00000000000044, 38.700000000000024, -50.00000000000044, 39.50000000000002, -50.00000000000044, -50.00000000000044, 43.10000000000001, 34.900000000000034, 43.10000000000001, 2.8999999999996007, -50.00000000000044, 38.700000000000024, 41.30000000000001, -50.00000000000044, 42.900000000000006, -50.00000000000044, 32.700000000000024, 42.900000000000006, 11.099999999999717, 40.90000000000002, 43.900000000000006, 36.70000000000003, -50.00000000000044, -50.00000000000044, 26.69999999999994, -50.00000000000044, 18.099999999999817, -50.00000000000044, 36.50000000000003, 44.900000000000006, 3.2999999999996064, -50.00000000000044, 44.5, 25.499999999999922, -50.00000000000044, 30.29999999999999, -50.00000000000044, 43.900000000000006, 41.90000000000001, 45.5, 2.299999999999592, 43.30000000000001, 47.5, 44.900000000000006, 41.30000000000001, 41.30000000000001, 24.499999999999908, 36.70000000000003, -50.00000000000044, 41.100000000000016, 43.10000000000001, 37.10000000000003, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 42.70000000000001, 46.099999999999994, 31.300000000000004, 36.900000000000034, 46.099999999999994, 43.900000000000006, -50.00000000000044, 41.90000000000001, 36.10000000000004, 38.50000000000003, 40.30000000000002, 13.499999999999751, -50.00000000000044, 33.90000000000004, -50.00000000000044, -50.00000000000044, 27.899999999999956, 46.9, 5.6999999999996405, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 36.30000000000003, -50.00000000000044, 37.70000000000003, -50.00000000000044, 42.500000000000014, 41.100000000000016], "episode_lengths": [52, 266, 500, 500, 500, 500, 500, 62, 500, 500, 500, 262, 72, 500, 376, 500, 114, 500, 106, 500, 500, 70, 152, 70, 472, 500, 114, 88, 500, 72, 500, 174, 72, 390, 92, 62, 134, 500, 500, 234, 500, 320, 500, 136, 52, 468, 500, 56, 246, 500, 198, 500, 62, 82, 46, 478, 68, 26, 52, 88, 88, 256, 134, 500, 90, 70, 130, 500, 66, 500, 500, 74, 40, 188, 132, 40, 62, 500, 82, 140, 116, 98, 366, 500, 162, 500, 500, 222, 32, 444, 500, 78, 500, 500, 138, 500, 124, 500, 76, 90]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3978378383159145, "mean_inference_ms": 1.273187922488203, "mean_action_processing_ms": 0.14795927772020825, "mean_env_wait_ms": 0.08845704721110077, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02600240707397461, "StateBufferConnector_ms": 0.005997419357299805, "ViewRequirementAgentConnector_ms": 0.1320207118988037}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.641999999999817, "episode_len_mean": 274.22, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.900000000000006, 23.499999999999893, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.8999999999999, 42.900000000000006, -50.00000000000044, 12.499999999999737, -50.00000000000044, 38.700000000000024, -50.00000000000044, 39.50000000000002, -50.00000000000044, -50.00000000000044, 43.10000000000001, 34.900000000000034, 43.10000000000001, 2.8999999999996007, -50.00000000000044, 38.700000000000024, 41.30000000000001, -50.00000000000044, 42.900000000000006, -50.00000000000044, 32.700000000000024, 42.900000000000006, 11.099999999999717, 40.90000000000002, 43.900000000000006, 36.70000000000003, -50.00000000000044, -50.00000000000044, 26.69999999999994, -50.00000000000044, 18.099999999999817, -50.00000000000044, 36.50000000000003, 44.900000000000006, 3.2999999999996064, -50.00000000000044, 44.5, 25.499999999999922, -50.00000000000044, 30.29999999999999, -50.00000000000044, 43.900000000000006, 41.90000000000001, 45.5, 2.299999999999592, 43.30000000000001, 47.5, 44.900000000000006, 41.30000000000001, 41.30000000000001, 24.499999999999908, 36.70000000000003, -50.00000000000044, 41.100000000000016, 43.10000000000001, 37.10000000000003, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 42.70000000000001, 46.099999999999994, 31.300000000000004, 36.900000000000034, 46.099999999999994, 43.900000000000006, -50.00000000000044, 41.90000000000001, 36.10000000000004, 38.50000000000003, 40.30000000000002, 13.499999999999751, -50.00000000000044, 33.90000000000004, -50.00000000000044, -50.00000000000044, 27.899999999999956, 46.9, 5.6999999999996405, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 36.30000000000003, -50.00000000000044, 37.70000000000003, -50.00000000000044, 42.500000000000014, 41.100000000000016], "episode_lengths": [52, 266, 500, 500, 500, 500, 500, 62, 500, 500, 500, 262, 72, 500, 376, 500, 114, 500, 106, 500, 500, 70, 152, 70, 472, 500, 114, 88, 500, 72, 500, 174, 72, 390, 92, 62, 134, 500, 500, 234, 500, 320, 500, 136, 52, 468, 500, 56, 246, 500, 198, 500, 62, 82, 46, 478, 68, 26, 52, 88, 88, 256, 134, 500, 90, 70, 130, 500, 66, 500, 500, 74, 40, 188, 132, 40, 62, 500, 82, 140, 116, 98, 366, 500, 162, 500, 500, 222, 32, 444, 500, 78, 500, 500, 138, 500, 124, 500, 76, 90]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3978378383159145, "mean_inference_ms": 1.273187922488203, "mean_action_processing_ms": 0.14795927772020825, "mean_env_wait_ms": 0.08845704721110077, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02600240707397461, "StateBufferConnector_ms": 0.005997419357299805, "ViewRequirementAgentConnector_ms": 0.1320207118988037}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000, "num_env_steps_sampled": 972000, "num_env_steps_trained": 972000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5306.1038859586615, "num_env_steps_trained_throughput_per_sec": 5306.1038859586615, "timesteps_total": 972000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 972000, "timers": {"training_iteration_time_ms": 2190.106, "sample_time_ms": 1916.59, "load_time_ms": 13.502, "load_throughput": 888763.383, "learn_time_ms": 248.413, "learn_throughput": 48306.606, "synch_weights_time_ms": 9.82}, "counters": {"num_env_steps_sampled": 972000, "num_env_steps_trained": 972000, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000}, "done": false, "episodes_total": 3642, "training_iteration": 81, "trial_id": "9f288_00019", "date": "2023-10-25_17-09-39", "timestamp": 1698250179, "time_this_iter_s": 2.2665467262268066, "time_total_s": 184.24352383613586, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 184.24352383613586, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 63.46666666666667, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.27180612553028e-26, "cur_lr": 0.0003, "total_loss": 6.381249332427979, "policy_loss": -0.0005491527418295543, "vf_loss": 6.381854852040608, "vf_explained_var": -1.1761983235677084e-06, "kl": 0.0012296846150093188, "entropy": 0.5643387754758199, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1223.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 984000, "num_env_steps_trained": 984000, "num_agent_steps_sampled": 984000, "num_agent_steps_trained": 984000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.082999999999856, "episode_len_mean": 244.88, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.2999999999996064, -50.00000000000044, 44.5, 25.499999999999922, -50.00000000000044, 30.29999999999999, -50.00000000000044, 43.900000000000006, 41.90000000000001, 45.5, 2.299999999999592, 43.30000000000001, 47.5, 44.900000000000006, 41.30000000000001, 41.30000000000001, 24.499999999999908, 36.70000000000003, -50.00000000000044, 41.100000000000016, 43.10000000000001, 37.10000000000003, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 42.70000000000001, 46.099999999999994, 31.300000000000004, 36.900000000000034, 46.099999999999994, 43.900000000000006, -50.00000000000044, 41.90000000000001, 36.10000000000004, 38.50000000000003, 40.30000000000002, 13.499999999999751, -50.00000000000044, 33.90000000000004, -50.00000000000044, -50.00000000000044, 27.899999999999956, 46.9, 5.6999999999996405, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 36.30000000000003, -50.00000000000044, 37.70000000000003, -50.00000000000044, 42.500000000000014, 41.100000000000016, 8.49999999999968, -50.00000000000044, 34.900000000000034, 46.9, -50.00000000000044, 29.69999999999998, 24.299999999999905, 24.299999999999905, -50.00000000000044, -50.00000000000044, 44.900000000000006, 42.900000000000006, -50.00000000000044, 35.30000000000004, 41.90000000000001, 44.7, 38.90000000000002, 43.900000000000006, 23.099999999999888, -50.00000000000044, 32.100000000000016, 42.30000000000001, 42.70000000000001, -50.00000000000044, 35.900000000000034, 43.10000000000001, 42.900000000000006, 36.70000000000003, 38.90000000000002, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 36.30000000000003, -50.00000000000044, 37.300000000000026, 10.499999999999709, 38.50000000000003, -50.00000000000044, 38.10000000000002, 28.09999999999996, 39.10000000000002, 39.90000000000002, -50.00000000000044, 34.50000000000004], "episode_lengths": [468, 500, 56, 246, 500, 198, 500, 62, 82, 46, 478, 68, 26, 52, 88, 88, 256, 134, 500, 90, 70, 130, 500, 66, 500, 500, 74, 40, 188, 132, 40, 62, 500, 82, 140, 116, 98, 366, 500, 162, 500, 500, 222, 32, 444, 500, 78, 500, 500, 138, 500, 124, 500, 76, 90, 416, 500, 152, 32, 500, 204, 258, 258, 500, 500, 52, 72, 500, 148, 82, 54, 112, 62, 270, 500, 180, 78, 74, 500, 142, 70, 72, 134, 112, 500, 60, 500, 500, 138, 500, 128, 396, 116, 500, 120, 220, 110, 102, 500, 156]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39762854442619383, "mean_inference_ms": 1.2725353370070678, "mean_action_processing_ms": 0.14802782089165903, "mean_env_wait_ms": 0.08844235581918283, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027002573013305664, "StateBufferConnector_ms": 0.0030019283294677734, "ViewRequirementAgentConnector_ms": 0.10902166366577148}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.082999999999856, "episode_len_mean": 244.88, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [3.2999999999996064, -50.00000000000044, 44.5, 25.499999999999922, -50.00000000000044, 30.29999999999999, -50.00000000000044, 43.900000000000006, 41.90000000000001, 45.5, 2.299999999999592, 43.30000000000001, 47.5, 44.900000000000006, 41.30000000000001, 41.30000000000001, 24.499999999999908, 36.70000000000003, -50.00000000000044, 41.100000000000016, 43.10000000000001, 37.10000000000003, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 42.70000000000001, 46.099999999999994, 31.300000000000004, 36.900000000000034, 46.099999999999994, 43.900000000000006, -50.00000000000044, 41.90000000000001, 36.10000000000004, 38.50000000000003, 40.30000000000002, 13.499999999999751, -50.00000000000044, 33.90000000000004, -50.00000000000044, -50.00000000000044, 27.899999999999956, 46.9, 5.6999999999996405, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 36.30000000000003, -50.00000000000044, 37.70000000000003, -50.00000000000044, 42.500000000000014, 41.100000000000016, 8.49999999999968, -50.00000000000044, 34.900000000000034, 46.9, -50.00000000000044, 29.69999999999998, 24.299999999999905, 24.299999999999905, -50.00000000000044, -50.00000000000044, 44.900000000000006, 42.900000000000006, -50.00000000000044, 35.30000000000004, 41.90000000000001, 44.7, 38.90000000000002, 43.900000000000006, 23.099999999999888, -50.00000000000044, 32.100000000000016, 42.30000000000001, 42.70000000000001, -50.00000000000044, 35.900000000000034, 43.10000000000001, 42.900000000000006, 36.70000000000003, 38.90000000000002, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 36.30000000000003, -50.00000000000044, 37.300000000000026, 10.499999999999709, 38.50000000000003, -50.00000000000044, 38.10000000000002, 28.09999999999996, 39.10000000000002, 39.90000000000002, -50.00000000000044, 34.50000000000004], "episode_lengths": [468, 500, 56, 246, 500, 198, 500, 62, 82, 46, 478, 68, 26, 52, 88, 88, 256, 134, 500, 90, 70, 130, 500, 66, 500, 500, 74, 40, 188, 132, 40, 62, 500, 82, 140, 116, 98, 366, 500, 162, 500, 500, 222, 32, 444, 500, 78, 500, 500, 138, 500, 124, 500, 76, 90, 416, 500, 152, 32, 500, 204, 258, 258, 500, 500, 52, 72, 500, 148, 82, 54, 112, 62, 270, 500, 180, 78, 74, 500, 142, 70, 72, 134, 112, 500, 60, 500, 500, 138, 500, 128, 396, 116, 500, 120, 220, 110, 102, 500, 156]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39762854442619383, "mean_inference_ms": 1.2725353370070678, "mean_action_processing_ms": 0.14802782089165903, "mean_env_wait_ms": 0.08844235581918283, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027002573013305664, "StateBufferConnector_ms": 0.0030019283294677734, "ViewRequirementAgentConnector_ms": 0.10902166366577148}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 984000, "num_agent_steps_trained": 984000, "num_env_steps_sampled": 984000, "num_env_steps_trained": 984000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5674.9365663665085, "num_env_steps_trained_throughput_per_sec": 5674.9365663665085, "timesteps_total": 984000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 984000, "timers": {"training_iteration_time_ms": 2189.688, "sample_time_ms": 1917.526, "load_time_ms": 13.32, "load_throughput": 900877.185, "learn_time_ms": 247.181, "learn_throughput": 48547.498, "synch_weights_time_ms": 9.872}, "counters": {"num_env_steps_sampled": 984000, "num_env_steps_trained": 984000, "num_agent_steps_sampled": 984000, "num_agent_steps_trained": 984000}, "done": false, "episodes_total": 3687, "training_iteration": 82, "trial_id": "9f288_00019", "date": "2023-10-25_17-09-41", "timestamp": 1698250181, "time_this_iter_s": 2.119471311569214, "time_total_s": 186.36299514770508, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 186.36299514770508, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 56.53333333333333, "ram_util_percent": 27.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.13590306276514e-26, "cur_lr": 0.0003, "total_loss": 7.361010456085205, "policy_loss": -0.0004096239805221558, "vf_loss": 7.3614754994710285, "vf_explained_var": -1.231829325358073e-07, "kl": 0.0015155315015969487, "entropy": 0.5537115573883057, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1238.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 996000, "num_env_steps_trained": 996000, "num_agent_steps_sampled": 996000, "num_agent_steps_trained": 996000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.303999999999846, "episode_len_mean": 257.64, "episode_media": {}, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [36.30000000000003, -50.00000000000044, 37.70000000000003, -50.00000000000044, 42.500000000000014, 41.100000000000016, 8.49999999999968, -50.00000000000044, 34.900000000000034, 46.9, -50.00000000000044, 29.69999999999998, 24.299999999999905, 24.299999999999905, -50.00000000000044, -50.00000000000044, 44.900000000000006, 42.900000000000006, -50.00000000000044, 35.30000000000004, 41.90000000000001, 44.7, 38.90000000000002, 43.900000000000006, 23.099999999999888, -50.00000000000044, 32.100000000000016, 42.30000000000001, 42.70000000000001, -50.00000000000044, 35.900000000000034, 43.10000000000001, 42.900000000000006, 36.70000000000003, 38.90000000000002, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 36.30000000000003, -50.00000000000044, 37.300000000000026, 10.499999999999709, 38.50000000000003, -50.00000000000044, 38.10000000000002, 28.09999999999996, 39.10000000000002, 39.90000000000002, -50.00000000000044, 34.50000000000004, -50.00000000000044, 37.10000000000003, 18.899999999999828, -50.00000000000044, 43.30000000000001, 42.70000000000001, 41.90000000000001, 43.50000000000001, 39.10000000000002, 24.899999999999913, 3.2999999999996064, 42.900000000000006, 42.70000000000001, 45.1, -50.00000000000044, -50.00000000000044, 26.09999999999993, -50.00000000000044, 46.699999999999996, -50.00000000000044, 46.5, -50.00000000000044, 40.70000000000002, 30.499999999999993, 43.7, 42.30000000000001, -50.00000000000044, -50.00000000000044, 30.499999999999993, -50.00000000000044, -50.00000000000044, 9.299999999999692, -50.00000000000044, 23.099999999999888, 29.099999999999973, 38.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.29999999999996, -50.00000000000044, -50.00000000000044, 39.50000000000002, 44.300000000000004, 22.099999999999874, 38.700000000000024, 37.300000000000026, 46.699999999999996, 38.10000000000002], "episode_lengths": [138, 500, 124, 500, 76, 90, 416, 500, 152, 32, 500, 204, 258, 258, 500, 500, 52, 72, 500, 148, 82, 54, 112, 62, 270, 500, 180, 78, 74, 500, 142, 70, 72, 134, 112, 500, 60, 500, 500, 138, 500, 128, 396, 116, 500, 120, 220, 110, 102, 500, 156, 500, 130, 312, 500, 68, 74, 82, 66, 110, 252, 468, 72, 74, 50, 500, 500, 240, 500, 34, 500, 36, 500, 94, 196, 64, 78, 500, 500, 196, 500, 500, 408, 500, 270, 210, 114, 500, 500, 500, 218, 500, 500, 106, 58, 280, 114, 128, 34, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39738815928969734, "mean_inference_ms": 1.2720367971450899, "mean_action_processing_ms": 0.1479909704285274, "mean_env_wait_ms": 0.08852610868106979, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024000883102416992, "StateBufferConnector_ms": 0.0030028820037841797, "ViewRequirementAgentConnector_ms": 0.10800576210021973}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.303999999999846, "episode_len_mean": 257.64, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [36.30000000000003, -50.00000000000044, 37.70000000000003, -50.00000000000044, 42.500000000000014, 41.100000000000016, 8.49999999999968, -50.00000000000044, 34.900000000000034, 46.9, -50.00000000000044, 29.69999999999998, 24.299999999999905, 24.299999999999905, -50.00000000000044, -50.00000000000044, 44.900000000000006, 42.900000000000006, -50.00000000000044, 35.30000000000004, 41.90000000000001, 44.7, 38.90000000000002, 43.900000000000006, 23.099999999999888, -50.00000000000044, 32.100000000000016, 42.30000000000001, 42.70000000000001, -50.00000000000044, 35.900000000000034, 43.10000000000001, 42.900000000000006, 36.70000000000003, 38.90000000000002, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 36.30000000000003, -50.00000000000044, 37.300000000000026, 10.499999999999709, 38.50000000000003, -50.00000000000044, 38.10000000000002, 28.09999999999996, 39.10000000000002, 39.90000000000002, -50.00000000000044, 34.50000000000004, -50.00000000000044, 37.10000000000003, 18.899999999999828, -50.00000000000044, 43.30000000000001, 42.70000000000001, 41.90000000000001, 43.50000000000001, 39.10000000000002, 24.899999999999913, 3.2999999999996064, 42.900000000000006, 42.70000000000001, 45.1, -50.00000000000044, -50.00000000000044, 26.09999999999993, -50.00000000000044, 46.699999999999996, -50.00000000000044, 46.5, -50.00000000000044, 40.70000000000002, 30.499999999999993, 43.7, 42.30000000000001, -50.00000000000044, -50.00000000000044, 30.499999999999993, -50.00000000000044, -50.00000000000044, 9.299999999999692, -50.00000000000044, 23.099999999999888, 29.099999999999973, 38.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.29999999999996, -50.00000000000044, -50.00000000000044, 39.50000000000002, 44.300000000000004, 22.099999999999874, 38.700000000000024, 37.300000000000026, 46.699999999999996, 38.10000000000002], "episode_lengths": [138, 500, 124, 500, 76, 90, 416, 500, 152, 32, 500, 204, 258, 258, 500, 500, 52, 72, 500, 148, 82, 54, 112, 62, 270, 500, 180, 78, 74, 500, 142, 70, 72, 134, 112, 500, 60, 500, 500, 138, 500, 128, 396, 116, 500, 120, 220, 110, 102, 500, 156, 500, 130, 312, 500, 68, 74, 82, 66, 110, 252, 468, 72, 74, 50, 500, 500, 240, 500, 34, 500, 36, 500, 94, 196, 64, 78, 500, 500, 196, 500, 500, 408, 500, 270, 210, 114, 500, 500, 500, 218, 500, 500, 106, 58, 280, 114, 128, 34, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39738815928969734, "mean_inference_ms": 1.2720367971450899, "mean_action_processing_ms": 0.1479909704285274, "mean_env_wait_ms": 0.08852610868106979, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024000883102416992, "StateBufferConnector_ms": 0.0030028820037841797, "ViewRequirementAgentConnector_ms": 0.10800576210021973}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 996000, "num_agent_steps_trained": 996000, "num_env_steps_sampled": 996000, "num_env_steps_trained": 996000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5215.082523673295, "num_env_steps_trained_throughput_per_sec": 5215.082523673295, "timesteps_total": 996000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 996000, "timers": {"training_iteration_time_ms": 2190.453, "sample_time_ms": 1918.621, "load_time_ms": 14.607, "load_throughput": 821537.316, "learn_time_ms": 245.367, "learn_throughput": 48906.327, "synch_weights_time_ms": 10.168}, "counters": {"num_env_steps_sampled": 996000, "num_env_steps_trained": 996000, "num_agent_steps_sampled": 996000, "num_agent_steps_trained": 996000}, "done": false, "episodes_total": 3736, "training_iteration": 83, "trial_id": "9f288_00019", "date": "2023-10-25_17-09-43", "timestamp": 1698250183, "time_this_iter_s": 2.3060154914855957, "time_total_s": 188.66901063919067, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 188.66901063919067, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 59.724999999999994, "ram_util_percent": 27.325000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.06795153138257e-26, "cur_lr": 0.0003, "total_loss": 6.939804236094157, "policy_loss": 0.00013109693924585978, "vf_loss": 6.9397278467814125, "vf_explained_var": -1.5099843343098958e-06, "kl": 0.0005975418734882017, "entropy": 0.5478398919105529, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1253.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1008000, "num_env_steps_trained": 1008000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.787999999999835, "episode_len_mean": 262.8, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [38.10000000000002, 28.09999999999996, 39.10000000000002, 39.90000000000002, -50.00000000000044, 34.50000000000004, -50.00000000000044, 37.10000000000003, 18.899999999999828, -50.00000000000044, 43.30000000000001, 42.70000000000001, 41.90000000000001, 43.50000000000001, 39.10000000000002, 24.899999999999913, 3.2999999999996064, 42.900000000000006, 42.70000000000001, 45.1, -50.00000000000044, -50.00000000000044, 26.09999999999993, -50.00000000000044, 46.699999999999996, -50.00000000000044, 46.5, -50.00000000000044, 40.70000000000002, 30.499999999999993, 43.7, 42.30000000000001, -50.00000000000044, -50.00000000000044, 30.499999999999993, -50.00000000000044, -50.00000000000044, 9.299999999999692, -50.00000000000044, 23.099999999999888, 29.099999999999973, 38.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.29999999999996, -50.00000000000044, -50.00000000000044, 39.50000000000002, 44.300000000000004, 22.099999999999874, 38.700000000000024, 37.300000000000026, 46.699999999999996, 38.10000000000002, 8.899999999999686, 28.499999999999964, 36.10000000000004, 5.499999999999638, 47.1, 45.7, -50.00000000000044, 32.30000000000002, 38.90000000000002, 32.90000000000003, 16.8999999999998, 39.50000000000002, 37.70000000000003, -50.00000000000044, 32.90000000000003, 44.5, 12.499999999999737, -50.00000000000044, -50.00000000000044, 42.900000000000006, 45.1, 43.30000000000001, -50.00000000000044, 45.9, 11.099999999999717, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, 46.5, 24.499999999999908, -50.00000000000044, 44.10000000000001, -50.00000000000044, 35.900000000000034, 35.900000000000034, 46.5, -50.00000000000044, 20.299999999999848, -50.00000000000044, 38.10000000000002, 46.9, 44.5, -50.00000000000044, -50.00000000000044], "episode_lengths": [120, 220, 110, 102, 500, 156, 500, 130, 312, 500, 68, 74, 82, 66, 110, 252, 468, 72, 74, 50, 500, 500, 240, 500, 34, 500, 36, 500, 94, 196, 64, 78, 500, 500, 196, 500, 500, 408, 500, 270, 210, 114, 500, 500, 500, 218, 500, 500, 106, 58, 280, 114, 128, 34, 120, 412, 216, 140, 446, 30, 44, 500, 178, 112, 172, 332, 106, 124, 500, 172, 56, 376, 500, 500, 72, 50, 68, 500, 42, 390, 500, 500, 500, 100, 36, 256, 500, 60, 500, 142, 142, 36, 500, 298, 500, 120, 32, 56, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3975166999087552, "mean_inference_ms": 1.2716189009194645, "mean_action_processing_ms": 0.14766352052588444, "mean_env_wait_ms": 0.08851701974990345, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023998022079467773, "StateBufferConnector_ms": 0.00800323486328125, "ViewRequirementAgentConnector_ms": 0.13396000862121582}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.787999999999835, "episode_len_mean": 262.8, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [38.10000000000002, 28.09999999999996, 39.10000000000002, 39.90000000000002, -50.00000000000044, 34.50000000000004, -50.00000000000044, 37.10000000000003, 18.899999999999828, -50.00000000000044, 43.30000000000001, 42.70000000000001, 41.90000000000001, 43.50000000000001, 39.10000000000002, 24.899999999999913, 3.2999999999996064, 42.900000000000006, 42.70000000000001, 45.1, -50.00000000000044, -50.00000000000044, 26.09999999999993, -50.00000000000044, 46.699999999999996, -50.00000000000044, 46.5, -50.00000000000044, 40.70000000000002, 30.499999999999993, 43.7, 42.30000000000001, -50.00000000000044, -50.00000000000044, 30.499999999999993, -50.00000000000044, -50.00000000000044, 9.299999999999692, -50.00000000000044, 23.099999999999888, 29.099999999999973, 38.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.29999999999996, -50.00000000000044, -50.00000000000044, 39.50000000000002, 44.300000000000004, 22.099999999999874, 38.700000000000024, 37.300000000000026, 46.699999999999996, 38.10000000000002, 8.899999999999686, 28.499999999999964, 36.10000000000004, 5.499999999999638, 47.1, 45.7, -50.00000000000044, 32.30000000000002, 38.90000000000002, 32.90000000000003, 16.8999999999998, 39.50000000000002, 37.70000000000003, -50.00000000000044, 32.90000000000003, 44.5, 12.499999999999737, -50.00000000000044, -50.00000000000044, 42.900000000000006, 45.1, 43.30000000000001, -50.00000000000044, 45.9, 11.099999999999717, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, 46.5, 24.499999999999908, -50.00000000000044, 44.10000000000001, -50.00000000000044, 35.900000000000034, 35.900000000000034, 46.5, -50.00000000000044, 20.299999999999848, -50.00000000000044, 38.10000000000002, 46.9, 44.5, -50.00000000000044, -50.00000000000044], "episode_lengths": [120, 220, 110, 102, 500, 156, 500, 130, 312, 500, 68, 74, 82, 66, 110, 252, 468, 72, 74, 50, 500, 500, 240, 500, 34, 500, 36, 500, 94, 196, 64, 78, 500, 500, 196, 500, 500, 408, 500, 270, 210, 114, 500, 500, 500, 218, 500, 500, 106, 58, 280, 114, 128, 34, 120, 412, 216, 140, 446, 30, 44, 500, 178, 112, 172, 332, 106, 124, 500, 172, 56, 376, 500, 500, 72, 50, 68, 500, 42, 390, 500, 500, 500, 100, 36, 256, 500, 60, 500, 142, 142, 36, 500, 298, 500, 120, 32, 56, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3975166999087552, "mean_inference_ms": 1.2716189009194645, "mean_action_processing_ms": 0.14766352052588444, "mean_env_wait_ms": 0.08851701974990345, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023998022079467773, "StateBufferConnector_ms": 0.00800323486328125, "ViewRequirementAgentConnector_ms": 0.13396000862121582}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000, "num_env_steps_sampled": 1008000, "num_env_steps_trained": 1008000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5192.104463413109, "num_env_steps_trained_throughput_per_sec": 5192.104463413109, "timesteps_total": 1008000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1008000, "timers": {"training_iteration_time_ms": 2208.174, "sample_time_ms": 1936.174, "load_time_ms": 14.907, "load_throughput": 804999.824, "learn_time_ms": 245.273, "learn_throughput": 48925.057, "synch_weights_time_ms": 10.03}, "counters": {"num_env_steps_sampled": 1008000, "num_env_steps_trained": 1008000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "done": false, "episodes_total": 3781, "training_iteration": 84, "trial_id": "9f288_00019", "date": "2023-10-25_17-09-46", "timestamp": 1698250186, "time_this_iter_s": 2.316197156906128, "time_total_s": 190.9852077960968, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 190.9852077960968, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 70.16666666666667, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.033975765691285e-26, "cur_lr": 0.0003, "total_loss": 6.813418388366699, "policy_loss": -0.0003943198670943578, "vf_loss": 6.8138683319091795, "vf_explained_var": -6.079673767089843e-07, "kl": 0.0006518356217535862, "entropy": 0.5552982171376546, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1268.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1020000, "num_env_steps_trained": 1020000, "num_agent_steps_sampled": 1020000, "num_agent_steps_trained": 1020000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.226999999999842, "episode_len_mean": 253.42, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [28.29999999999996, -50.00000000000044, -50.00000000000044, 39.50000000000002, 44.300000000000004, 22.099999999999874, 38.700000000000024, 37.300000000000026, 46.699999999999996, 38.10000000000002, 8.899999999999686, 28.499999999999964, 36.10000000000004, 5.499999999999638, 47.1, 45.7, -50.00000000000044, 32.30000000000002, 38.90000000000002, 32.90000000000003, 16.8999999999998, 39.50000000000002, 37.70000000000003, -50.00000000000044, 32.90000000000003, 44.5, 12.499999999999737, -50.00000000000044, -50.00000000000044, 42.900000000000006, 45.1, 43.30000000000001, -50.00000000000044, 45.9, 11.099999999999717, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, 46.5, 24.499999999999908, -50.00000000000044, 44.10000000000001, -50.00000000000044, 35.900000000000034, 35.900000000000034, 46.5, -50.00000000000044, 20.299999999999848, -50.00000000000044, 38.10000000000002, 46.9, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.900000000000034, 44.5, -50.00000000000044, 40.500000000000014, 41.500000000000014, -50.00000000000044, 18.099999999999817, -50.00000000000044, 34.70000000000004, 42.70000000000001, 45.7, 45.3, 42.30000000000001, -50.00000000000044, 27.699999999999953, 38.90000000000002, 46.5, 42.30000000000001, 19.69999999999984, 40.70000000000002, -50.00000000000044, 38.700000000000024, -50.00000000000044, 37.10000000000003, 44.5, 46.3, 38.700000000000024, -50.00000000000044, -50.00000000000044, 13.699999999999754, 44.7, -50.00000000000044, -50.00000000000044, 38.50000000000003, 33.10000000000003, 39.300000000000026, 43.30000000000001, 17.499999999999808, -50.00000000000044, 19.899999999999842, 44.900000000000006], "episode_lengths": [218, 500, 500, 106, 58, 280, 114, 128, 34, 120, 412, 216, 140, 446, 30, 44, 500, 178, 112, 172, 332, 106, 124, 500, 172, 56, 376, 500, 500, 72, 50, 68, 500, 42, 390, 500, 500, 500, 100, 36, 256, 500, 60, 500, 142, 142, 36, 500, 298, 500, 120, 32, 56, 500, 500, 500, 500, 500, 500, 152, 56, 500, 96, 86, 500, 320, 500, 154, 74, 44, 48, 78, 500, 224, 112, 36, 78, 304, 94, 500, 114, 500, 130, 56, 38, 114, 500, 500, 364, 54, 500, 500, 116, 170, 108, 68, 326, 500, 302, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39777327744034563, "mean_inference_ms": 1.27229130253432, "mean_action_processing_ms": 0.1472319295837068, "mean_env_wait_ms": 0.0887688698243067, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02300119400024414, "StateBufferConnector_ms": 0.00800180435180664, "ViewRequirementAgentConnector_ms": 0.14593958854675293}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.226999999999842, "episode_len_mean": 253.42, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [28.29999999999996, -50.00000000000044, -50.00000000000044, 39.50000000000002, 44.300000000000004, 22.099999999999874, 38.700000000000024, 37.300000000000026, 46.699999999999996, 38.10000000000002, 8.899999999999686, 28.499999999999964, 36.10000000000004, 5.499999999999638, 47.1, 45.7, -50.00000000000044, 32.30000000000002, 38.90000000000002, 32.90000000000003, 16.8999999999998, 39.50000000000002, 37.70000000000003, -50.00000000000044, 32.90000000000003, 44.5, 12.499999999999737, -50.00000000000044, -50.00000000000044, 42.900000000000006, 45.1, 43.30000000000001, -50.00000000000044, 45.9, 11.099999999999717, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, 46.5, 24.499999999999908, -50.00000000000044, 44.10000000000001, -50.00000000000044, 35.900000000000034, 35.900000000000034, 46.5, -50.00000000000044, 20.299999999999848, -50.00000000000044, 38.10000000000002, 46.9, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.900000000000034, 44.5, -50.00000000000044, 40.500000000000014, 41.500000000000014, -50.00000000000044, 18.099999999999817, -50.00000000000044, 34.70000000000004, 42.70000000000001, 45.7, 45.3, 42.30000000000001, -50.00000000000044, 27.699999999999953, 38.90000000000002, 46.5, 42.30000000000001, 19.69999999999984, 40.70000000000002, -50.00000000000044, 38.700000000000024, -50.00000000000044, 37.10000000000003, 44.5, 46.3, 38.700000000000024, -50.00000000000044, -50.00000000000044, 13.699999999999754, 44.7, -50.00000000000044, -50.00000000000044, 38.50000000000003, 33.10000000000003, 39.300000000000026, 43.30000000000001, 17.499999999999808, -50.00000000000044, 19.899999999999842, 44.900000000000006], "episode_lengths": [218, 500, 500, 106, 58, 280, 114, 128, 34, 120, 412, 216, 140, 446, 30, 44, 500, 178, 112, 172, 332, 106, 124, 500, 172, 56, 376, 500, 500, 72, 50, 68, 500, 42, 390, 500, 500, 500, 100, 36, 256, 500, 60, 500, 142, 142, 36, 500, 298, 500, 120, 32, 56, 500, 500, 500, 500, 500, 500, 152, 56, 500, 96, 86, 500, 320, 500, 154, 74, 44, 48, 78, 500, 224, 112, 36, 78, 304, 94, 500, 114, 500, 130, 56, 38, 114, 500, 500, 364, 54, 500, 500, 116, 170, 108, 68, 326, 500, 302, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39777327744034563, "mean_inference_ms": 1.27229130253432, "mean_action_processing_ms": 0.1472319295837068, "mean_env_wait_ms": 0.0887688698243067, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02300119400024414, "StateBufferConnector_ms": 0.00800180435180664, "ViewRequirementAgentConnector_ms": 0.14593958854675293}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1020000, "num_agent_steps_trained": 1020000, "num_env_steps_sampled": 1020000, "num_env_steps_trained": 1020000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5058.92637075781, "num_env_steps_trained_throughput_per_sec": 5058.92637075781, "timesteps_total": 1020000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1020000, "timers": {"training_iteration_time_ms": 2215.304, "sample_time_ms": 1949.985, "load_time_ms": 14.607, "load_throughput": 821530.612, "learn_time_ms": 239.092, "learn_throughput": 50189.802, "synch_weights_time_ms": 9.83}, "counters": {"num_env_steps_sampled": 1020000, "num_env_steps_trained": 1020000, "num_agent_steps_sampled": 1020000, "num_agent_steps_trained": 1020000}, "done": false, "episodes_total": 3826, "training_iteration": 85, "trial_id": "9f288_00019", "date": "2023-10-25_17-09-48", "timestamp": 1698250188, "time_this_iter_s": 2.377042770385742, "time_total_s": 193.36225056648254, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 193.36225056648254, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 63.93333333333334, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.169878828456425e-27, "cur_lr": 0.0003, "total_loss": 6.7839397430419925, "policy_loss": -0.00015886674324671428, "vf_loss": 6.7841518719991045, "vf_explained_var": -1.0967254638671874e-06, "kl": 0.00032586047551982726, "entropy": 0.5316322406133016, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1283.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1032000, "num_env_steps_trained": 1032000, "num_agent_steps_sampled": 1032000, "num_agent_steps_trained": 1032000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.532999999999837, "episode_len_mean": 250.32, "episode_media": {}, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [38.10000000000002, 46.9, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.900000000000034, 44.5, -50.00000000000044, 40.500000000000014, 41.500000000000014, -50.00000000000044, 18.099999999999817, -50.00000000000044, 34.70000000000004, 42.70000000000001, 45.7, 45.3, 42.30000000000001, -50.00000000000044, 27.699999999999953, 38.90000000000002, 46.5, 42.30000000000001, 19.69999999999984, 40.70000000000002, -50.00000000000044, 38.700000000000024, -50.00000000000044, 37.10000000000003, 44.5, 46.3, 38.700000000000024, -50.00000000000044, -50.00000000000044, 13.699999999999754, 44.7, -50.00000000000044, -50.00000000000044, 38.50000000000003, 33.10000000000003, 39.300000000000026, 43.30000000000001, 17.499999999999808, -50.00000000000044, 19.899999999999842, 44.900000000000006, 40.90000000000002, -50.00000000000044, 22.699999999999882, -50.00000000000044, 43.900000000000006, 45.7, 44.5, 31.900000000000013, 43.30000000000001, 46.5, 45.9, 44.300000000000004, -50.00000000000044, 31.1, 41.500000000000014, 45.3, 41.70000000000002, -50.00000000000044, 29.49999999999998, -50.00000000000044, 46.9, -50.00000000000044, 44.7, 37.300000000000026, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, 45.9, -50.00000000000044, 39.90000000000002, -50.00000000000044, 3.499999999999609, -50.00000000000044, 19.899999999999842, 44.10000000000001, 46.9, 41.90000000000001, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 42.10000000000001, -50.00000000000044, 44.5, 36.30000000000003], "episode_lengths": [120, 32, 56, 500, 500, 500, 500, 500, 500, 152, 56, 500, 96, 86, 500, 320, 500, 154, 74, 44, 48, 78, 500, 224, 112, 36, 78, 304, 94, 500, 114, 500, 130, 56, 38, 114, 500, 500, 364, 54, 500, 500, 116, 170, 108, 68, 326, 500, 302, 52, 92, 500, 274, 500, 62, 44, 56, 182, 68, 36, 42, 58, 500, 190, 86, 48, 84, 500, 206, 500, 32, 500, 54, 128, 88, 500, 500, 500, 500, 84, 42, 500, 102, 500, 466, 500, 302, 60, 32, 82, 48, 500, 500, 500, 500, 34, 80, 500, 56, 138]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3981538942913164, "mean_inference_ms": 1.2734735654028548, "mean_action_processing_ms": 0.14731611143598666, "mean_env_wait_ms": 0.08866129427035555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031002283096313477, "StateBufferConnector_ms": 0.007997274398803711, "ViewRequirementAgentConnector_ms": 0.14597415924072266}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.532999999999837, "episode_len_mean": 250.32, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [38.10000000000002, 46.9, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.900000000000034, 44.5, -50.00000000000044, 40.500000000000014, 41.500000000000014, -50.00000000000044, 18.099999999999817, -50.00000000000044, 34.70000000000004, 42.70000000000001, 45.7, 45.3, 42.30000000000001, -50.00000000000044, 27.699999999999953, 38.90000000000002, 46.5, 42.30000000000001, 19.69999999999984, 40.70000000000002, -50.00000000000044, 38.700000000000024, -50.00000000000044, 37.10000000000003, 44.5, 46.3, 38.700000000000024, -50.00000000000044, -50.00000000000044, 13.699999999999754, 44.7, -50.00000000000044, -50.00000000000044, 38.50000000000003, 33.10000000000003, 39.300000000000026, 43.30000000000001, 17.499999999999808, -50.00000000000044, 19.899999999999842, 44.900000000000006, 40.90000000000002, -50.00000000000044, 22.699999999999882, -50.00000000000044, 43.900000000000006, 45.7, 44.5, 31.900000000000013, 43.30000000000001, 46.5, 45.9, 44.300000000000004, -50.00000000000044, 31.1, 41.500000000000014, 45.3, 41.70000000000002, -50.00000000000044, 29.49999999999998, -50.00000000000044, 46.9, -50.00000000000044, 44.7, 37.300000000000026, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, 45.9, -50.00000000000044, 39.90000000000002, -50.00000000000044, 3.499999999999609, -50.00000000000044, 19.899999999999842, 44.10000000000001, 46.9, 41.90000000000001, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 42.10000000000001, -50.00000000000044, 44.5, 36.30000000000003], "episode_lengths": [120, 32, 56, 500, 500, 500, 500, 500, 500, 152, 56, 500, 96, 86, 500, 320, 500, 154, 74, 44, 48, 78, 500, 224, 112, 36, 78, 304, 94, 500, 114, 500, 130, 56, 38, 114, 500, 500, 364, 54, 500, 500, 116, 170, 108, 68, 326, 500, 302, 52, 92, 500, 274, 500, 62, 44, 56, 182, 68, 36, 42, 58, 500, 190, 86, 48, 84, 500, 206, 500, 32, 500, 54, 128, 88, 500, 500, 500, 500, 84, 42, 500, 102, 500, 466, 500, 302, 60, 32, 82, 48, 500, 500, 500, 500, 34, 80, 500, 56, 138]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3981538942913164, "mean_inference_ms": 1.2734735654028548, "mean_action_processing_ms": 0.14731611143598666, "mean_env_wait_ms": 0.08866129427035555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031002283096313477, "StateBufferConnector_ms": 0.007997274398803711, "ViewRequirementAgentConnector_ms": 0.14597415924072266}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1032000, "num_agent_steps_trained": 1032000, "num_env_steps_sampled": 1032000, "num_env_steps_trained": 1032000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4977.165713128449, "num_env_steps_trained_throughput_per_sec": 4977.165713128449, "timesteps_total": 1032000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1032000, "timers": {"training_iteration_time_ms": 2231.101, "sample_time_ms": 1973.883, "load_time_ms": 14.199, "load_throughput": 845154.383, "learn_time_ms": 231.203, "learn_throughput": 51902.546, "synch_weights_time_ms": 10.027}, "counters": {"num_env_steps_sampled": 1032000, "num_env_steps_trained": 1032000, "num_agent_steps_sampled": 1032000, "num_agent_steps_trained": 1032000}, "done": false, "episodes_total": 3876, "training_iteration": 86, "trial_id": "9f288_00019", "date": "2023-10-25_17-09-50", "timestamp": 1698250190, "time_this_iter_s": 2.4160094261169434, "time_total_s": 195.7782599925995, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 195.7782599925995, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 63.099999999999994, "ram_util_percent": 27.325000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.5849394142282123e-27, "cur_lr": 0.0003, "total_loss": 6.573559347788493, "policy_loss": -0.0003160973389943441, "vf_loss": 6.573931789398193, "vf_explained_var": -8.026758829752604e-07, "kl": 0.0005168412687604966, "entropy": 0.5632447322209676, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1298.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1044000, "num_env_steps_trained": 1044000, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000}, "sampler_results": {"episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.283999999999857, "episode_len_mean": 227.88, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.699999999999882, -50.00000000000044, 43.900000000000006, 45.7, 44.5, 31.900000000000013, 43.30000000000001, 46.5, 45.9, 44.300000000000004, -50.00000000000044, 31.1, 41.500000000000014, 45.3, 41.70000000000002, -50.00000000000044, 29.49999999999998, -50.00000000000044, 46.9, -50.00000000000044, 44.7, 37.300000000000026, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, 45.9, -50.00000000000044, 39.90000000000002, -50.00000000000044, 3.499999999999609, -50.00000000000044, 19.899999999999842, 44.10000000000001, 46.9, 41.90000000000001, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 42.10000000000001, -50.00000000000044, 44.5, 36.30000000000003, 19.09999999999983, 31.300000000000004, 10.499999999999709, 42.500000000000014, 44.7, 43.50000000000001, -50.00000000000044, -50.00000000000044, 42.70000000000001, 25.099999999999916, -50.00000000000044, 40.10000000000002, -50.00000000000044, 38.700000000000024, 28.699999999999967, 43.900000000000006, 40.90000000000002, 45.7, 46.099999999999994, 39.10000000000002, 39.70000000000002, 35.500000000000036, 30.099999999999987, -50.00000000000044, -50.00000000000044, 14.299999999999763, 39.70000000000002, 40.10000000000002, 43.50000000000001, 25.699999999999925, 46.699999999999996, -50.00000000000044, 42.900000000000006, 44.10000000000001, 48.1, 46.3, 25.099999999999916, 43.30000000000001, 38.700000000000024, 0.09999999999956088, 30.499999999999993, 22.899999999999885, -50.00000000000044, 39.300000000000026, 46.3, 44.7, 43.30000000000001, -50.00000000000044, 42.70000000000001, -50.00000000000044, 45.5, -50.00000000000044], "episode_lengths": [274, 500, 62, 44, 56, 182, 68, 36, 42, 58, 500, 190, 86, 48, 84, 500, 206, 500, 32, 500, 54, 128, 88, 500, 500, 500, 500, 84, 42, 500, 102, 500, 466, 500, 302, 60, 32, 82, 48, 500, 500, 500, 500, 34, 80, 500, 56, 138, 310, 188, 396, 76, 54, 66, 500, 500, 74, 250, 500, 100, 500, 114, 214, 62, 92, 44, 40, 110, 104, 146, 200, 500, 500, 358, 104, 100, 66, 244, 34, 500, 72, 60, 20, 38, 250, 68, 114, 500, 196, 272, 500, 108, 38, 54, 68, 500, 74, 500, 46, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3980294312571726, "mean_inference_ms": 1.2734467901946243, "mean_action_processing_ms": 0.14759477758730624, "mean_env_wait_ms": 0.08856550467429138, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03300023078918457, "StateBufferConnector_ms": 0.008997917175292969, "ViewRequirementAgentConnector_ms": 0.14300084114074707}}, "episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.283999999999857, "episode_len_mean": 227.88, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [22.699999999999882, -50.00000000000044, 43.900000000000006, 45.7, 44.5, 31.900000000000013, 43.30000000000001, 46.5, 45.9, 44.300000000000004, -50.00000000000044, 31.1, 41.500000000000014, 45.3, 41.70000000000002, -50.00000000000044, 29.49999999999998, -50.00000000000044, 46.9, -50.00000000000044, 44.7, 37.300000000000026, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, 45.9, -50.00000000000044, 39.90000000000002, -50.00000000000044, 3.499999999999609, -50.00000000000044, 19.899999999999842, 44.10000000000001, 46.9, 41.90000000000001, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 42.10000000000001, -50.00000000000044, 44.5, 36.30000000000003, 19.09999999999983, 31.300000000000004, 10.499999999999709, 42.500000000000014, 44.7, 43.50000000000001, -50.00000000000044, -50.00000000000044, 42.70000000000001, 25.099999999999916, -50.00000000000044, 40.10000000000002, -50.00000000000044, 38.700000000000024, 28.699999999999967, 43.900000000000006, 40.90000000000002, 45.7, 46.099999999999994, 39.10000000000002, 39.70000000000002, 35.500000000000036, 30.099999999999987, -50.00000000000044, -50.00000000000044, 14.299999999999763, 39.70000000000002, 40.10000000000002, 43.50000000000001, 25.699999999999925, 46.699999999999996, -50.00000000000044, 42.900000000000006, 44.10000000000001, 48.1, 46.3, 25.099999999999916, 43.30000000000001, 38.700000000000024, 0.09999999999956088, 30.499999999999993, 22.899999999999885, -50.00000000000044, 39.300000000000026, 46.3, 44.7, 43.30000000000001, -50.00000000000044, 42.70000000000001, -50.00000000000044, 45.5, -50.00000000000044], "episode_lengths": [274, 500, 62, 44, 56, 182, 68, 36, 42, 58, 500, 190, 86, 48, 84, 500, 206, 500, 32, 500, 54, 128, 88, 500, 500, 500, 500, 84, 42, 500, 102, 500, 466, 500, 302, 60, 32, 82, 48, 500, 500, 500, 500, 34, 80, 500, 56, 138, 310, 188, 396, 76, 54, 66, 500, 500, 74, 250, 500, 100, 500, 114, 214, 62, 92, 44, 40, 110, 104, 146, 200, 500, 500, 358, 104, 100, 66, 244, 34, 500, 72, 60, 20, 38, 250, 68, 114, 500, 196, 272, 500, 108, 38, 54, 68, 500, 74, 500, 46, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3980294312571726, "mean_inference_ms": 1.2734467901946243, "mean_action_processing_ms": 0.14759477758730624, "mean_env_wait_ms": 0.08856550467429138, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03300023078918457, "StateBufferConnector_ms": 0.008997917175292969, "ViewRequirementAgentConnector_ms": 0.14300084114074707}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000, "num_env_steps_sampled": 1044000, "num_env_steps_trained": 1044000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4988.402863425907, "num_env_steps_trained_throughput_per_sec": 4988.402863425907, "timesteps_total": 1044000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1044000, "timers": {"training_iteration_time_ms": 2265.688, "sample_time_ms": 1995.79, "load_time_ms": 14.898, "load_throughput": 805450.705, "learn_time_ms": 242.953, "learn_throughput": 49392.184, "synch_weights_time_ms": 10.157}, "counters": {"num_env_steps_sampled": 1044000, "num_env_steps_trained": 1044000, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000}, "done": false, "episodes_total": 3928, "training_iteration": 87, "trial_id": "9f288_00019", "date": "2023-10-25_17-09-53", "timestamp": 1698250193, "time_this_iter_s": 2.4105758666992188, "time_total_s": 198.1888358592987, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 198.1888358592987, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 70.0, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.2924697071141062e-27, "cur_lr": 0.0003, "total_loss": 6.336615308125814, "policy_loss": -0.0005204856395721435, "vf_loss": 6.337193838755289, "vf_explained_var": -1.1046727498372397e-06, "kl": 0.0010930980216471652, "entropy": 0.581180210908254, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1313.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1056000, "num_env_steps_trained": 1056000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "sampler_results": {"episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.048999999999847, "episode_len_mean": 245.2, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.699999999999996, 42.10000000000001, -50.00000000000044, 44.5, 36.30000000000003, 19.09999999999983, 31.300000000000004, 10.499999999999709, 42.500000000000014, 44.7, 43.50000000000001, -50.00000000000044, -50.00000000000044, 42.70000000000001, 25.099999999999916, -50.00000000000044, 40.10000000000002, -50.00000000000044, 38.700000000000024, 28.699999999999967, 43.900000000000006, 40.90000000000002, 45.7, 46.099999999999994, 39.10000000000002, 39.70000000000002, 35.500000000000036, 30.099999999999987, -50.00000000000044, -50.00000000000044, 14.299999999999763, 39.70000000000002, 40.10000000000002, 43.50000000000001, 25.699999999999925, 46.699999999999996, -50.00000000000044, 42.900000000000006, 44.10000000000001, 48.1, 46.3, 25.099999999999916, 43.30000000000001, 38.700000000000024, 0.09999999999956088, 30.499999999999993, 22.899999999999885, -50.00000000000044, 39.300000000000026, 46.3, 44.7, 43.30000000000001, -50.00000000000044, 42.70000000000001, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 28.699999999999967, 41.30000000000001, 44.300000000000004, 44.10000000000001, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 29.69999999999998, 42.10000000000001, -50.00000000000044, 23.8999999999999, 41.70000000000002, -50.00000000000044, -50.00000000000044, 45.7, 43.7, -50.00000000000044, -50.00000000000044, 44.10000000000001, 19.299999999999834, -50.00000000000044, -50.00000000000044, 39.10000000000002, -50.00000000000044, 24.899999999999913, -50.00000000000044, -50.00000000000044, 8.299999999999677, 42.30000000000001, 40.90000000000002, 38.300000000000026, 25.499999999999922, 40.90000000000002, 43.50000000000001, -50.00000000000044, 41.70000000000002, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 34, 80, 500, 56, 138, 310, 188, 396, 76, 54, 66, 500, 500, 74, 250, 500, 100, 500, 114, 214, 62, 92, 44, 40, 110, 104, 146, 200, 500, 500, 358, 104, 100, 66, 244, 34, 500, 72, 60, 20, 38, 250, 68, 114, 500, 196, 272, 500, 108, 38, 54, 68, 500, 74, 500, 46, 500, 500, 214, 88, 58, 60, 500, 500, 64, 500, 204, 80, 500, 262, 84, 500, 500, 44, 64, 500, 500, 60, 308, 500, 500, 110, 500, 252, 500, 500, 418, 78, 92, 118, 246, 92, 66, 500, 84, 500, 42, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3984748045264487, "mean_inference_ms": 1.2744530224111097, "mean_action_processing_ms": 0.14749720943753616, "mean_env_wait_ms": 0.08869689491635988, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023998737335205078, "StateBufferConnector_ms": 0.010011911392211914, "ViewRequirementAgentConnector_ms": 0.1509859561920166}}, "episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.048999999999847, "episode_len_mean": 245.2, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.699999999999996, 42.10000000000001, -50.00000000000044, 44.5, 36.30000000000003, 19.09999999999983, 31.300000000000004, 10.499999999999709, 42.500000000000014, 44.7, 43.50000000000001, -50.00000000000044, -50.00000000000044, 42.70000000000001, 25.099999999999916, -50.00000000000044, 40.10000000000002, -50.00000000000044, 38.700000000000024, 28.699999999999967, 43.900000000000006, 40.90000000000002, 45.7, 46.099999999999994, 39.10000000000002, 39.70000000000002, 35.500000000000036, 30.099999999999987, -50.00000000000044, -50.00000000000044, 14.299999999999763, 39.70000000000002, 40.10000000000002, 43.50000000000001, 25.699999999999925, 46.699999999999996, -50.00000000000044, 42.900000000000006, 44.10000000000001, 48.1, 46.3, 25.099999999999916, 43.30000000000001, 38.700000000000024, 0.09999999999956088, 30.499999999999993, 22.899999999999885, -50.00000000000044, 39.300000000000026, 46.3, 44.7, 43.30000000000001, -50.00000000000044, 42.70000000000001, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 28.699999999999967, 41.30000000000001, 44.300000000000004, 44.10000000000001, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 29.69999999999998, 42.10000000000001, -50.00000000000044, 23.8999999999999, 41.70000000000002, -50.00000000000044, -50.00000000000044, 45.7, 43.7, -50.00000000000044, -50.00000000000044, 44.10000000000001, 19.299999999999834, -50.00000000000044, -50.00000000000044, 39.10000000000002, -50.00000000000044, 24.899999999999913, -50.00000000000044, -50.00000000000044, 8.299999999999677, 42.30000000000001, 40.90000000000002, 38.300000000000026, 25.499999999999922, 40.90000000000002, 43.50000000000001, -50.00000000000044, 41.70000000000002, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 34, 80, 500, 56, 138, 310, 188, 396, 76, 54, 66, 500, 500, 74, 250, 500, 100, 500, 114, 214, 62, 92, 44, 40, 110, 104, 146, 200, 500, 500, 358, 104, 100, 66, 244, 34, 500, 72, 60, 20, 38, 250, 68, 114, 500, 196, 272, 500, 108, 38, 54, 68, 500, 74, 500, 46, 500, 500, 214, 88, 58, 60, 500, 500, 64, 500, 204, 80, 500, 262, 84, 500, 500, 44, 64, 500, 500, 60, 308, 500, 500, 110, 500, 252, 500, 500, 418, 78, 92, 118, 246, 92, 66, 500, 84, 500, 42, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3984748045264487, "mean_inference_ms": 1.2744530224111097, "mean_action_processing_ms": 0.14749720943753616, "mean_env_wait_ms": 0.08869689491635988, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023998737335205078, "StateBufferConnector_ms": 0.010011911392211914, "ViewRequirementAgentConnector_ms": 0.1509859561920166}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000, "num_env_steps_sampled": 1056000, "num_env_steps_trained": 1056000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4981.694431305198, "num_env_steps_trained_throughput_per_sec": 4981.694431305198, "timesteps_total": 1056000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1056000, "timers": {"training_iteration_time_ms": 2289.003, "sample_time_ms": 2019.364, "load_time_ms": 14.799, "load_throughput": 810852.6, "learn_time_ms": 242.397, "learn_throughput": 49505.602, "synch_weights_time_ms": 10.553}, "counters": {"num_env_steps_sampled": 1056000, "num_env_steps_trained": 1056000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "done": false, "episodes_total": 3970, "training_iteration": 88, "trial_id": "9f288_00019", "date": "2023-10-25_17-09-55", "timestamp": 1698250195, "time_this_iter_s": 2.4148170948028564, "time_total_s": 200.60365295410156, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 200.60365295410156, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 60.2, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.462348535570531e-28, "cur_lr": 0.0003, "total_loss": 7.30160338083903, "policy_loss": -0.0006783376137415568, "vf_loss": 7.30234162012736, "vf_explained_var": -1.4781951904296875e-06, "kl": 0.0013213945000643435, "entropy": 0.5990115125974019, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1328.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1068000, "num_env_steps_trained": 1068000, "num_agent_steps_sampled": 1068000, "num_agent_steps_trained": 1068000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.089999999999847, "episode_len_mean": 239.78, "episode_media": {}, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.300000000000004, 44.10000000000001, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 29.69999999999998, 42.10000000000001, -50.00000000000044, 23.8999999999999, 41.70000000000002, -50.00000000000044, -50.00000000000044, 45.7, 43.7, -50.00000000000044, -50.00000000000044, 44.10000000000001, 19.299999999999834, -50.00000000000044, -50.00000000000044, 39.10000000000002, -50.00000000000044, 24.899999999999913, -50.00000000000044, -50.00000000000044, 8.299999999999677, 42.30000000000001, 40.90000000000002, 38.300000000000026, 25.499999999999922, 40.90000000000002, 43.50000000000001, -50.00000000000044, 41.70000000000002, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 16.09999999999979, 41.90000000000001, 42.30000000000001, 36.10000000000004, -50.00000000000044, 39.50000000000002, 27.49999999999995, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, 43.30000000000001, 45.1, 44.300000000000004, -50.00000000000044, -50.00000000000044, 46.099999999999994, 39.70000000000002, 27.699999999999953, 43.50000000000001, 46.9, 28.09999999999996, -50.00000000000044, 44.10000000000001, -50.00000000000044, 44.300000000000004, -50.00000000000044, 41.30000000000001, -50.00000000000044, 41.70000000000002, 19.899999999999842, 40.500000000000014, 47.1, 5.099999999999632, 37.300000000000026, -50.00000000000044, 35.30000000000004, 40.500000000000014, 41.500000000000014, 39.90000000000002, 43.900000000000006, 46.5, 43.10000000000001, 41.70000000000002, -50.00000000000044, 38.300000000000026, 43.7, 37.90000000000003, 45.7, 25.29999999999992, 30.699999999999996, -50.00000000000044, 45.9, 44.900000000000006, 46.3, -50.00000000000044, 43.30000000000001, 46.099999999999994, 33.500000000000036, 44.7], "episode_lengths": [58, 60, 500, 500, 64, 500, 204, 80, 500, 262, 84, 500, 500, 44, 64, 500, 500, 60, 308, 500, 500, 110, 500, 252, 500, 500, 418, 78, 92, 118, 246, 92, 66, 500, 84, 500, 42, 500, 500, 500, 340, 82, 78, 140, 500, 106, 226, 500, 500, 28, 500, 68, 50, 58, 500, 500, 40, 104, 224, 66, 32, 220, 500, 60, 500, 58, 500, 88, 500, 84, 302, 96, 30, 450, 128, 500, 148, 96, 86, 102, 62, 36, 70, 84, 500, 118, 64, 122, 44, 248, 194, 500, 42, 52, 38, 500, 68, 40, 166, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3990130537159675, "mean_inference_ms": 1.2765498054819955, "mean_action_processing_ms": 0.14756935474314672, "mean_env_wait_ms": 0.08871115726814222, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023000717163085938, "StateBufferConnector_ms": 0.010007381439208984, "ViewRequirementAgentConnector_ms": 0.15492010116577148}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.089999999999847, "episode_len_mean": 239.78, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.300000000000004, 44.10000000000001, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 29.69999999999998, 42.10000000000001, -50.00000000000044, 23.8999999999999, 41.70000000000002, -50.00000000000044, -50.00000000000044, 45.7, 43.7, -50.00000000000044, -50.00000000000044, 44.10000000000001, 19.299999999999834, -50.00000000000044, -50.00000000000044, 39.10000000000002, -50.00000000000044, 24.899999999999913, -50.00000000000044, -50.00000000000044, 8.299999999999677, 42.30000000000001, 40.90000000000002, 38.300000000000026, 25.499999999999922, 40.90000000000002, 43.50000000000001, -50.00000000000044, 41.70000000000002, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 16.09999999999979, 41.90000000000001, 42.30000000000001, 36.10000000000004, -50.00000000000044, 39.50000000000002, 27.49999999999995, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, 43.30000000000001, 45.1, 44.300000000000004, -50.00000000000044, -50.00000000000044, 46.099999999999994, 39.70000000000002, 27.699999999999953, 43.50000000000001, 46.9, 28.09999999999996, -50.00000000000044, 44.10000000000001, -50.00000000000044, 44.300000000000004, -50.00000000000044, 41.30000000000001, -50.00000000000044, 41.70000000000002, 19.899999999999842, 40.500000000000014, 47.1, 5.099999999999632, 37.300000000000026, -50.00000000000044, 35.30000000000004, 40.500000000000014, 41.500000000000014, 39.90000000000002, 43.900000000000006, 46.5, 43.10000000000001, 41.70000000000002, -50.00000000000044, 38.300000000000026, 43.7, 37.90000000000003, 45.7, 25.29999999999992, 30.699999999999996, -50.00000000000044, 45.9, 44.900000000000006, 46.3, -50.00000000000044, 43.30000000000001, 46.099999999999994, 33.500000000000036, 44.7], "episode_lengths": [58, 60, 500, 500, 64, 500, 204, 80, 500, 262, 84, 500, 500, 44, 64, 500, 500, 60, 308, 500, 500, 110, 500, 252, 500, 500, 418, 78, 92, 118, 246, 92, 66, 500, 84, 500, 42, 500, 500, 500, 340, 82, 78, 140, 500, 106, 226, 500, 500, 28, 500, 68, 50, 58, 500, 500, 40, 104, 224, 66, 32, 220, 500, 60, 500, 58, 500, 88, 500, 84, 302, 96, 30, 450, 128, 500, 148, 96, 86, 102, 62, 36, 70, 84, 500, 118, 64, 122, 44, 248, 194, 500, 42, 52, 38, 500, 68, 40, 166, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3990130537159675, "mean_inference_ms": 1.2765498054819955, "mean_action_processing_ms": 0.14756935474314672, "mean_env_wait_ms": 0.08871115726814222, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023000717163085938, "StateBufferConnector_ms": 0.010007381439208984, "ViewRequirementAgentConnector_ms": 0.15492010116577148}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1068000, "num_agent_steps_trained": 1068000, "num_env_steps_sampled": 1068000, "num_env_steps_trained": 1068000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4991.740838650459, "num_env_steps_trained_throughput_per_sec": 4991.740838650459, "timesteps_total": 1068000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1068000, "timers": {"training_iteration_time_ms": 2302.332, "sample_time_ms": 2038.204, "load_time_ms": 14.292, "load_throughput": 839602.449, "learn_time_ms": 237.272, "learn_throughput": 50574.923, "synch_weights_time_ms": 10.853}, "counters": {"num_env_steps_sampled": 1068000, "num_env_steps_trained": 1068000, "num_agent_steps_sampled": 1068000, "num_agent_steps_trained": 1068000}, "done": false, "episodes_total": 4031, "training_iteration": 89, "trial_id": "9f288_00019", "date": "2023-10-25_17-09-58", "timestamp": 1698250198, "time_this_iter_s": 2.409966468811035, "time_total_s": 203.0136194229126, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 203.0136194229126, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 70.66666666666667, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.2311742677852654e-28, "cur_lr": 0.0003, "total_loss": 6.556714057922363, "policy_loss": -0.0001859863599141439, "vf_loss": 6.556952857971192, "vf_explained_var": -9.377797444661458e-07, "kl": 0.0002549601696652341, "entropy": 0.5282979766527812, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1343.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1080000, "num_env_steps_trained": 1080000, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.985999999999844, "episode_len_mean": 240.82, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.09999999999979, 41.90000000000001, 42.30000000000001, 36.10000000000004, -50.00000000000044, 39.50000000000002, 27.49999999999995, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, 43.30000000000001, 45.1, 44.300000000000004, -50.00000000000044, -50.00000000000044, 46.099999999999994, 39.70000000000002, 27.699999999999953, 43.50000000000001, 46.9, 28.09999999999996, -50.00000000000044, 44.10000000000001, -50.00000000000044, 44.300000000000004, -50.00000000000044, 41.30000000000001, -50.00000000000044, 41.70000000000002, 19.899999999999842, 40.500000000000014, 47.1, 5.099999999999632, 37.300000000000026, -50.00000000000044, 35.30000000000004, 40.500000000000014, 41.500000000000014, 39.90000000000002, 43.900000000000006, 46.5, 43.10000000000001, 41.70000000000002, -50.00000000000044, 38.300000000000026, 43.7, 37.90000000000003, 45.7, 25.29999999999992, 30.699999999999996, -50.00000000000044, 45.9, 44.900000000000006, 46.3, -50.00000000000044, 43.30000000000001, 46.099999999999994, 33.500000000000036, 44.7, 5.6999999999996405, 43.50000000000001, 12.69999999999974, 44.10000000000001, 46.699999999999996, 44.10000000000001, 37.50000000000003, 44.7, 7.899999999999672, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, 42.30000000000001, 34.900000000000034, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 44.10000000000001, 28.29999999999996, -50.00000000000044, -50.00000000000044, 45.9, 32.50000000000002, -50.00000000000044, 33.30000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, 41.500000000000014, -50.00000000000044, -50.00000000000044, 43.7], "episode_lengths": [340, 82, 78, 140, 500, 106, 226, 500, 500, 28, 500, 68, 50, 58, 500, 500, 40, 104, 224, 66, 32, 220, 500, 60, 500, 58, 500, 88, 500, 84, 302, 96, 30, 450, 128, 500, 148, 96, 86, 102, 62, 36, 70, 84, 500, 118, 64, 122, 44, 248, 194, 500, 42, 52, 38, 500, 68, 40, 166, 54, 444, 66, 374, 60, 34, 60, 126, 54, 422, 500, 28, 500, 500, 500, 102, 78, 152, 500, 500, 64, 500, 500, 60, 218, 500, 500, 42, 176, 500, 168, 500, 500, 500, 500, 500, 112, 86, 500, 500, 64]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39951821685188627, "mean_inference_ms": 1.2769154411893997, "mean_action_processing_ms": 0.1477265325602354, "mean_env_wait_ms": 0.0888204562769257, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029002904891967773, "StateBufferConnector_ms": 0.007999658584594727, "ViewRequirementAgentConnector_ms": 0.13802814483642578}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.985999999999844, "episode_len_mean": 240.82, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [16.09999999999979, 41.90000000000001, 42.30000000000001, 36.10000000000004, -50.00000000000044, 39.50000000000002, 27.49999999999995, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, 43.30000000000001, 45.1, 44.300000000000004, -50.00000000000044, -50.00000000000044, 46.099999999999994, 39.70000000000002, 27.699999999999953, 43.50000000000001, 46.9, 28.09999999999996, -50.00000000000044, 44.10000000000001, -50.00000000000044, 44.300000000000004, -50.00000000000044, 41.30000000000001, -50.00000000000044, 41.70000000000002, 19.899999999999842, 40.500000000000014, 47.1, 5.099999999999632, 37.300000000000026, -50.00000000000044, 35.30000000000004, 40.500000000000014, 41.500000000000014, 39.90000000000002, 43.900000000000006, 46.5, 43.10000000000001, 41.70000000000002, -50.00000000000044, 38.300000000000026, 43.7, 37.90000000000003, 45.7, 25.29999999999992, 30.699999999999996, -50.00000000000044, 45.9, 44.900000000000006, 46.3, -50.00000000000044, 43.30000000000001, 46.099999999999994, 33.500000000000036, 44.7, 5.6999999999996405, 43.50000000000001, 12.69999999999974, 44.10000000000001, 46.699999999999996, 44.10000000000001, 37.50000000000003, 44.7, 7.899999999999672, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, 42.30000000000001, 34.900000000000034, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 44.10000000000001, 28.29999999999996, -50.00000000000044, -50.00000000000044, 45.9, 32.50000000000002, -50.00000000000044, 33.30000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, 41.500000000000014, -50.00000000000044, -50.00000000000044, 43.7], "episode_lengths": [340, 82, 78, 140, 500, 106, 226, 500, 500, 28, 500, 68, 50, 58, 500, 500, 40, 104, 224, 66, 32, 220, 500, 60, 500, 58, 500, 88, 500, 84, 302, 96, 30, 450, 128, 500, 148, 96, 86, 102, 62, 36, 70, 84, 500, 118, 64, 122, 44, 248, 194, 500, 42, 52, 38, 500, 68, 40, 166, 54, 444, 66, 374, 60, 34, 60, 126, 54, 422, 500, 28, 500, 500, 500, 102, 78, 152, 500, 500, 64, 500, 500, 60, 218, 500, 500, 42, 176, 500, 168, 500, 500, 500, 500, 500, 112, 86, 500, 500, 64]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39951821685188627, "mean_inference_ms": 1.2769154411893997, "mean_action_processing_ms": 0.1477265325602354, "mean_env_wait_ms": 0.0888204562769257, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029002904891967773, "StateBufferConnector_ms": 0.007999658584594727, "ViewRequirementAgentConnector_ms": 0.13802814483642578}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000, "num_env_steps_sampled": 1080000, "num_env_steps_trained": 1080000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5030.621820669651, "num_env_steps_trained_throughput_per_sec": 5030.621820669651, "timesteps_total": 1080000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1080000, "timers": {"training_iteration_time_ms": 2337.315, "sample_time_ms": 2060.3, "load_time_ms": 14.892, "load_throughput": 805779.522, "learn_time_ms": 249.471, "learn_throughput": 48101.839, "synch_weights_time_ms": 10.93}, "counters": {"num_env_steps_sampled": 1080000, "num_env_steps_trained": 1080000, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000}, "done": false, "episodes_total": 4071, "training_iteration": 90, "trial_id": "9f288_00019", "date": "2023-10-25_17-10-00", "timestamp": 1698250200, "time_this_iter_s": 2.390380382537842, "time_total_s": 205.40399980545044, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 205.40399980545044, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 63.96666666666666, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.6155871338926327e-28, "cur_lr": 0.0003, "total_loss": 6.754253514607748, "policy_loss": -7.904917001724243e-05, "vf_loss": 6.754383150736491, "vf_explained_var": -1.5417734781901042e-06, "kl": 0.0006178818079433767, "entropy": 0.5071898361047109, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1358.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1092000, "num_env_steps_trained": 1092000, "num_agent_steps_sampled": 1092000, "num_agent_steps_trained": 1092000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.775999999999828, "episode_len_mean": 252.9, "episode_media": {}, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [25.29999999999992, 30.699999999999996, -50.00000000000044, 45.9, 44.900000000000006, 46.3, -50.00000000000044, 43.30000000000001, 46.099999999999994, 33.500000000000036, 44.7, 5.6999999999996405, 43.50000000000001, 12.69999999999974, 44.10000000000001, 46.699999999999996, 44.10000000000001, 37.50000000000003, 44.7, 7.899999999999672, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, 42.30000000000001, 34.900000000000034, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 44.10000000000001, 28.29999999999996, -50.00000000000044, -50.00000000000044, 45.9, 32.50000000000002, -50.00000000000044, 33.30000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, 41.500000000000014, -50.00000000000044, -50.00000000000044, 43.7, 43.7, 45.9, -50.00000000000044, -50.00000000000044, 45.5, 45.9, 42.500000000000014, 43.7, 43.10000000000001, -50.00000000000044, 14.499999999999766, 46.099999999999994, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 44.300000000000004, -50.00000000000044, 38.90000000000002, 37.50000000000003, 45.3, 42.70000000000001, 36.70000000000003, -50.00000000000044, -50.00000000000044, 42.30000000000001, 44.900000000000006, -50.00000000000044, 3.2999999999996064, -50.00000000000044, 4.699999999999626, 45.5, 43.10000000000001, 42.500000000000014, 39.10000000000002, 39.10000000000002, 39.70000000000002, 42.70000000000001, 44.5, 11.899999999999729, 22.899999999999885, 39.300000000000026, 44.900000000000006, -50.00000000000044, 23.8999999999999, 35.500000000000036, -50.00000000000044, -50.00000000000044], "episode_lengths": [248, 194, 500, 42, 52, 38, 500, 68, 40, 166, 54, 444, 66, 374, 60, 34, 60, 126, 54, 422, 500, 28, 500, 500, 500, 102, 78, 152, 500, 500, 64, 500, 500, 60, 218, 500, 500, 42, 176, 500, 168, 500, 500, 500, 500, 500, 112, 86, 500, 500, 64, 64, 42, 500, 500, 46, 42, 76, 64, 70, 500, 356, 40, 78, 500, 500, 500, 48, 58, 500, 112, 126, 48, 74, 134, 500, 500, 78, 52, 500, 468, 500, 454, 46, 70, 76, 110, 110, 104, 74, 56, 382, 272, 108, 52, 500, 262, 146, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3998833148588551, "mean_inference_ms": 1.2781972589369799, "mean_action_processing_ms": 0.14802472719942553, "mean_env_wait_ms": 0.08877883550919158, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03499913215637207, "StateBufferConnector_ms": 0.004999399185180664, "ViewRequirementAgentConnector_ms": 0.13503026962280273}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.775999999999828, "episode_len_mean": 252.9, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [25.29999999999992, 30.699999999999996, -50.00000000000044, 45.9, 44.900000000000006, 46.3, -50.00000000000044, 43.30000000000001, 46.099999999999994, 33.500000000000036, 44.7, 5.6999999999996405, 43.50000000000001, 12.69999999999974, 44.10000000000001, 46.699999999999996, 44.10000000000001, 37.50000000000003, 44.7, 7.899999999999672, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, 42.30000000000001, 34.900000000000034, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 44.10000000000001, 28.29999999999996, -50.00000000000044, -50.00000000000044, 45.9, 32.50000000000002, -50.00000000000044, 33.30000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, 41.500000000000014, -50.00000000000044, -50.00000000000044, 43.7, 43.7, 45.9, -50.00000000000044, -50.00000000000044, 45.5, 45.9, 42.500000000000014, 43.7, 43.10000000000001, -50.00000000000044, 14.499999999999766, 46.099999999999994, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 44.300000000000004, -50.00000000000044, 38.90000000000002, 37.50000000000003, 45.3, 42.70000000000001, 36.70000000000003, -50.00000000000044, -50.00000000000044, 42.30000000000001, 44.900000000000006, -50.00000000000044, 3.2999999999996064, -50.00000000000044, 4.699999999999626, 45.5, 43.10000000000001, 42.500000000000014, 39.10000000000002, 39.10000000000002, 39.70000000000002, 42.70000000000001, 44.5, 11.899999999999729, 22.899999999999885, 39.300000000000026, 44.900000000000006, -50.00000000000044, 23.8999999999999, 35.500000000000036, -50.00000000000044, -50.00000000000044], "episode_lengths": [248, 194, 500, 42, 52, 38, 500, 68, 40, 166, 54, 444, 66, 374, 60, 34, 60, 126, 54, 422, 500, 28, 500, 500, 500, 102, 78, 152, 500, 500, 64, 500, 500, 60, 218, 500, 500, 42, 176, 500, 168, 500, 500, 500, 500, 500, 112, 86, 500, 500, 64, 64, 42, 500, 500, 46, 42, 76, 64, 70, 500, 356, 40, 78, 500, 500, 500, 48, 58, 500, 112, 126, 48, 74, 134, 500, 500, 78, 52, 500, 468, 500, 454, 46, 70, 76, 110, 110, 104, 74, 56, 382, 272, 108, 52, 500, 262, 146, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3998833148588551, "mean_inference_ms": 1.2781972589369799, "mean_action_processing_ms": 0.14802472719942553, "mean_env_wait_ms": 0.08877883550919158, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03499913215637207, "StateBufferConnector_ms": 0.004999399185180664, "ViewRequirementAgentConnector_ms": 0.13503026962280273}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1092000, "num_agent_steps_trained": 1092000, "num_env_steps_sampled": 1092000, "num_env_steps_trained": 1092000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5081.407684557186, "num_env_steps_trained_throughput_per_sec": 5081.407684557186, "timesteps_total": 1092000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1092000, "timers": {"training_iteration_time_ms": 2347.315, "sample_time_ms": 2082.521, "load_time_ms": 13.693, "load_throughput": 876346.522, "learn_time_ms": 238.475, "learn_throughput": 50319.818, "synch_weights_time_ms": 10.905}, "counters": {"num_env_steps_sampled": 1092000, "num_env_steps_trained": 1092000, "num_agent_steps_sampled": 1092000, "num_agent_steps_trained": 1092000}, "done": false, "episodes_total": 4120, "training_iteration": 91, "trial_id": "9f288_00019", "date": "2023-10-25_17-10-02", "timestamp": 1698250202, "time_this_iter_s": 2.369770050048828, "time_total_s": 207.77376985549927, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 207.77376985549927, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 62.5, "ram_util_percent": 27.325000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.077935669463164e-29, "cur_lr": 0.0003, "total_loss": 6.383096218109131, "policy_loss": 2.5226672490437826e-05, "vf_loss": 6.383125432332357, "vf_explained_var": -1.3748804728190104e-06, "kl": 0.00014106138626933292, "entropy": 0.543378762404124, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1373.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1104000, "num_env_steps_trained": 1104000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.789999999999837, "episode_len_mean": 242.76, "episode_media": {}, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 43.7, 43.7, 45.9, -50.00000000000044, -50.00000000000044, 45.5, 45.9, 42.500000000000014, 43.7, 43.10000000000001, -50.00000000000044, 14.499999999999766, 46.099999999999994, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 44.300000000000004, -50.00000000000044, 38.90000000000002, 37.50000000000003, 45.3, 42.70000000000001, 36.70000000000003, -50.00000000000044, -50.00000000000044, 42.30000000000001, 44.900000000000006, -50.00000000000044, 3.2999999999996064, -50.00000000000044, 4.699999999999626, 45.5, 43.10000000000001, 42.500000000000014, 39.10000000000002, 39.10000000000002, 39.70000000000002, 42.70000000000001, 44.5, 11.899999999999729, 22.899999999999885, 39.300000000000026, 44.900000000000006, -50.00000000000044, 23.8999999999999, 35.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 45.5, -50.00000000000044, 30.699999999999996, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, 38.10000000000002, 44.900000000000006, 42.30000000000001, -50.00000000000044, 45.5, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 46.699999999999996, 31.900000000000013, 33.90000000000004, 21.699999999999868, 24.69999999999991, 42.70000000000001, 46.3, 43.900000000000006, 41.500000000000014, 42.10000000000001, 46.3, 41.70000000000002, 44.900000000000006, 44.10000000000001, 28.09999999999996, -50.00000000000044, 43.30000000000001, 42.10000000000001, 43.900000000000006, 45.3, -50.00000000000044], "episode_lengths": [500, 64, 64, 42, 500, 500, 46, 42, 76, 64, 70, 500, 356, 40, 78, 500, 500, 500, 48, 58, 500, 112, 126, 48, 74, 134, 500, 500, 78, 52, 500, 468, 500, 454, 46, 70, 76, 110, 110, 104, 74, 56, 382, 272, 108, 52, 500, 262, 146, 500, 500, 500, 500, 500, 500, 50, 500, 46, 500, 194, 500, 500, 72, 500, 500, 90, 500, 120, 52, 78, 500, 46, 32, 500, 500, 500, 500, 66, 500, 34, 182, 162, 284, 254, 74, 38, 62, 86, 80, 38, 84, 52, 60, 220, 500, 68, 80, 62, 48, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.399791283935127, "mean_inference_ms": 1.279209508073536, "mean_action_processing_ms": 0.14844202554388, "mean_env_wait_ms": 0.08884975143078151, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026230812072753906, "StateBufferConnector_ms": 0.00099945068359375, "ViewRequirementAgentConnector_ms": 0.12599778175354004}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.789999999999837, "episode_len_mean": 242.76, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 43.7, 43.7, 45.9, -50.00000000000044, -50.00000000000044, 45.5, 45.9, 42.500000000000014, 43.7, 43.10000000000001, -50.00000000000044, 14.499999999999766, 46.099999999999994, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 44.300000000000004, -50.00000000000044, 38.90000000000002, 37.50000000000003, 45.3, 42.70000000000001, 36.70000000000003, -50.00000000000044, -50.00000000000044, 42.30000000000001, 44.900000000000006, -50.00000000000044, 3.2999999999996064, -50.00000000000044, 4.699999999999626, 45.5, 43.10000000000001, 42.500000000000014, 39.10000000000002, 39.10000000000002, 39.70000000000002, 42.70000000000001, 44.5, 11.899999999999729, 22.899999999999885, 39.300000000000026, 44.900000000000006, -50.00000000000044, 23.8999999999999, 35.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 45.5, -50.00000000000044, 30.699999999999996, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, 38.10000000000002, 44.900000000000006, 42.30000000000001, -50.00000000000044, 45.5, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 46.699999999999996, 31.900000000000013, 33.90000000000004, 21.699999999999868, 24.69999999999991, 42.70000000000001, 46.3, 43.900000000000006, 41.500000000000014, 42.10000000000001, 46.3, 41.70000000000002, 44.900000000000006, 44.10000000000001, 28.09999999999996, -50.00000000000044, 43.30000000000001, 42.10000000000001, 43.900000000000006, 45.3, -50.00000000000044], "episode_lengths": [500, 64, 64, 42, 500, 500, 46, 42, 76, 64, 70, 500, 356, 40, 78, 500, 500, 500, 48, 58, 500, 112, 126, 48, 74, 134, 500, 500, 78, 52, 500, 468, 500, 454, 46, 70, 76, 110, 110, 104, 74, 56, 382, 272, 108, 52, 500, 262, 146, 500, 500, 500, 500, 500, 500, 50, 500, 46, 500, 194, 500, 500, 72, 500, 500, 90, 500, 120, 52, 78, 500, 46, 32, 500, 500, 500, 500, 66, 500, 34, 182, 162, 284, 254, 74, 38, 62, 86, 80, 38, 84, 52, 60, 220, 500, 68, 80, 62, 48, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.399791283935127, "mean_inference_ms": 1.279209508073536, "mean_action_processing_ms": 0.14844202554388, "mean_env_wait_ms": 0.08884975143078151, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026230812072753906, "StateBufferConnector_ms": 0.00099945068359375, "ViewRequirementAgentConnector_ms": 0.12599778175354004}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000, "num_env_steps_sampled": 1104000, "num_env_steps_trained": 1104000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4870.828370809161, "num_env_steps_trained_throughput_per_sec": 4870.828370809161, "timesteps_total": 1104000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1104000, "timers": {"training_iteration_time_ms": 2382.224, "sample_time_ms": 2111.43, "load_time_ms": 14.293, "load_throughput": 839564.635, "learn_time_ms": 243.683, "learn_throughput": 49244.251, "synch_weights_time_ms": 11.005}, "counters": {"num_env_steps_sampled": 1104000, "num_env_steps_trained": 1104000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "done": false, "episodes_total": 4169, "training_iteration": 92, "trial_id": "9f288_00019", "date": "2023-10-25_17-10-05", "timestamp": 1698250205, "time_this_iter_s": 2.4696435928344727, "time_total_s": 210.24341344833374, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 210.24341344833374, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 71.13333333333334, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.038967834731582e-29, "cur_lr": 0.0003, "total_loss": 6.756732877095541, "policy_loss": -0.0006696442763010661, "vf_loss": 6.757458019256592, "vf_explained_var": -7.192293802897135e-07, "kl": 0.0011126061118469958, "entropy": 0.5550278544425964, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1388.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1116000, "num_env_steps_trained": 1116000, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.905999999999811, "episode_len_mean": 271.52, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 23.8999999999999, 35.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 45.5, -50.00000000000044, 30.699999999999996, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, 38.10000000000002, 44.900000000000006, 42.30000000000001, -50.00000000000044, 45.5, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 46.699999999999996, 31.900000000000013, 33.90000000000004, 21.699999999999868, 24.69999999999991, 42.70000000000001, 46.3, 43.900000000000006, 41.500000000000014, 42.10000000000001, 46.3, 41.70000000000002, 44.900000000000006, 44.10000000000001, 28.09999999999996, -50.00000000000044, 43.30000000000001, 42.10000000000001, 43.900000000000006, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.89999999999994, -50.00000000000044, 44.5, 43.30000000000001, 44.10000000000001, -50.00000000000044, -50.00000000000044, 45.5, 39.50000000000002, 45.5, 41.90000000000001, 14.09999999999976, -50.00000000000044, 41.90000000000001, 45.3, -50.00000000000044, 41.90000000000001, 34.50000000000004, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 45.5, 22.299999999999876, 32.50000000000002, -50.00000000000044, 42.70000000000001, 43.900000000000006, -50.00000000000044, 34.900000000000034, 33.90000000000004, 46.9, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.899999999999956, 45.1, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 262, 146, 500, 500, 500, 500, 500, 500, 50, 500, 46, 500, 194, 500, 500, 72, 500, 500, 90, 500, 120, 52, 78, 500, 46, 32, 500, 500, 500, 500, 66, 500, 34, 182, 162, 284, 254, 74, 38, 62, 86, 80, 38, 84, 52, 60, 220, 500, 68, 80, 62, 48, 500, 500, 500, 500, 500, 232, 500, 56, 68, 60, 500, 500, 46, 106, 46, 82, 360, 500, 82, 48, 500, 82, 156, 500, 500, 58, 500, 46, 278, 176, 500, 74, 62, 500, 152, 162, 32, 96, 500, 500, 500, 222, 50, 500, 98, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39980334185299254, "mean_inference_ms": 1.2794986968082915, "mean_action_processing_ms": 0.14841725201184391, "mean_env_wait_ms": 0.08905173988253356, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028246164321899414, "StateBufferConnector_ms": 0.003998517990112305, "ViewRequirementAgentConnector_ms": 0.1389932632446289}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.905999999999811, "episode_len_mean": 271.52, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 23.8999999999999, 35.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 45.5, -50.00000000000044, 30.699999999999996, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, 38.10000000000002, 44.900000000000006, 42.30000000000001, -50.00000000000044, 45.5, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 46.699999999999996, 31.900000000000013, 33.90000000000004, 21.699999999999868, 24.69999999999991, 42.70000000000001, 46.3, 43.900000000000006, 41.500000000000014, 42.10000000000001, 46.3, 41.70000000000002, 44.900000000000006, 44.10000000000001, 28.09999999999996, -50.00000000000044, 43.30000000000001, 42.10000000000001, 43.900000000000006, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.89999999999994, -50.00000000000044, 44.5, 43.30000000000001, 44.10000000000001, -50.00000000000044, -50.00000000000044, 45.5, 39.50000000000002, 45.5, 41.90000000000001, 14.09999999999976, -50.00000000000044, 41.90000000000001, 45.3, -50.00000000000044, 41.90000000000001, 34.50000000000004, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 45.5, 22.299999999999876, 32.50000000000002, -50.00000000000044, 42.70000000000001, 43.900000000000006, -50.00000000000044, 34.900000000000034, 33.90000000000004, 46.9, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.899999999999956, 45.1, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 262, 146, 500, 500, 500, 500, 500, 500, 50, 500, 46, 500, 194, 500, 500, 72, 500, 500, 90, 500, 120, 52, 78, 500, 46, 32, 500, 500, 500, 500, 66, 500, 34, 182, 162, 284, 254, 74, 38, 62, 86, 80, 38, 84, 52, 60, 220, 500, 68, 80, 62, 48, 500, 500, 500, 500, 500, 232, 500, 56, 68, 60, 500, 500, 46, 106, 46, 82, 360, 500, 82, 48, 500, 82, 156, 500, 500, 58, 500, 46, 278, 176, 500, 74, 62, 500, 152, 162, 32, 96, 500, 500, 500, 222, 50, 500, 98, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39980334185299254, "mean_inference_ms": 1.2794986968082915, "mean_action_processing_ms": 0.14841725201184391, "mean_env_wait_ms": 0.08905173988253356, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028246164321899414, "StateBufferConnector_ms": 0.003998517990112305, "ViewRequirementAgentConnector_ms": 0.1389932632446289}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000, "num_env_steps_sampled": 1116000, "num_env_steps_trained": 1116000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4694.662717297097, "num_env_steps_trained_throughput_per_sec": 4694.662717297097, "timesteps_total": 1116000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1116000, "timers": {"training_iteration_time_ms": 2407.831, "sample_time_ms": 2140.039, "load_time_ms": 12.293, "load_throughput": 976161.115, "learn_time_ms": 242.782, "learn_throughput": 49427.107, "synch_weights_time_ms": 10.805}, "counters": {"num_env_steps_sampled": 1116000, "num_env_steps_trained": 1116000, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000}, "done": false, "episodes_total": 4215, "training_iteration": 93, "trial_id": "9f288_00019", "date": "2023-10-25_17-10-08", "timestamp": 1698250208, "time_this_iter_s": 2.561094284057617, "time_total_s": 212.80450773239136, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 212.80450773239136, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 66.42500000000001, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.019483917365791e-29, "cur_lr": 0.0003, "total_loss": 6.68838259379069, "policy_loss": -0.00047122719697654245, "vf_loss": 6.688902187347412, "vf_explained_var": -9.61621602376302e-07, "kl": 0.0007843577275671236, "entropy": 0.4840395748615265, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1403.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1128000, "num_env_steps_trained": 1128000, "num_agent_steps_sampled": 1128000, "num_agent_steps_trained": 1128000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.65499999999981, "episode_len_mean": 269.06, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.3, 41.70000000000002, 44.900000000000006, 44.10000000000001, 28.09999999999996, -50.00000000000044, 43.30000000000001, 42.10000000000001, 43.900000000000006, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.89999999999994, -50.00000000000044, 44.5, 43.30000000000001, 44.10000000000001, -50.00000000000044, -50.00000000000044, 45.5, 39.50000000000002, 45.5, 41.90000000000001, 14.09999999999976, -50.00000000000044, 41.90000000000001, 45.3, -50.00000000000044, 41.90000000000001, 34.50000000000004, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 45.5, 22.299999999999876, 32.50000000000002, -50.00000000000044, 42.70000000000001, 43.900000000000006, -50.00000000000044, 34.900000000000034, 33.90000000000004, 46.9, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.899999999999956, 45.1, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.7, 42.500000000000014, 38.90000000000002, 45.5, 44.900000000000006, -50.00000000000044, -50.00000000000044, 47.9, -50.00000000000044, 43.900000000000006, 40.90000000000002, -50.00000000000044, 30.699999999999996, -50.00000000000044, 22.899999999999885, 38.700000000000024, 45.3, 44.10000000000001, 10.299999999999706, 12.299999999999734, -50.00000000000044, -50.00000000000044, 46.099999999999994, 13.299999999999748, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 43.10000000000001, -50.00000000000044, 47.5, 4.299999999999621, -50.00000000000044, -50.00000000000044, 46.699999999999996, 6.8999999999996575, 34.900000000000034, 37.300000000000026, -50.00000000000044, -50.00000000000044], "episode_lengths": [38, 84, 52, 60, 220, 500, 68, 80, 62, 48, 500, 500, 500, 500, 500, 232, 500, 56, 68, 60, 500, 500, 46, 106, 46, 82, 360, 500, 82, 48, 500, 82, 156, 500, 500, 58, 500, 46, 278, 176, 500, 74, 62, 500, 152, 162, 32, 96, 500, 500, 500, 222, 50, 500, 98, 500, 500, 500, 24, 76, 112, 46, 52, 500, 500, 22, 500, 62, 92, 500, 194, 500, 272, 114, 48, 60, 398, 378, 500, 500, 40, 368, 66, 500, 500, 500, 500, 40, 70, 500, 26, 458, 500, 500, 34, 432, 152, 128, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40017901385700355, "mean_inference_ms": 1.2804179383845835, "mean_action_processing_ms": 0.14823155932824444, "mean_env_wait_ms": 0.089282003126921, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.033019304275512695, "StateBufferConnector_ms": 0.005139589309692383, "ViewRequirementAgentConnector_ms": 0.13098931312561035}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.65499999999981, "episode_len_mean": 269.06, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.3, 41.70000000000002, 44.900000000000006, 44.10000000000001, 28.09999999999996, -50.00000000000044, 43.30000000000001, 42.10000000000001, 43.900000000000006, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.89999999999994, -50.00000000000044, 44.5, 43.30000000000001, 44.10000000000001, -50.00000000000044, -50.00000000000044, 45.5, 39.50000000000002, 45.5, 41.90000000000001, 14.09999999999976, -50.00000000000044, 41.90000000000001, 45.3, -50.00000000000044, 41.90000000000001, 34.50000000000004, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 45.5, 22.299999999999876, 32.50000000000002, -50.00000000000044, 42.70000000000001, 43.900000000000006, -50.00000000000044, 34.900000000000034, 33.90000000000004, 46.9, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.899999999999956, 45.1, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.7, 42.500000000000014, 38.90000000000002, 45.5, 44.900000000000006, -50.00000000000044, -50.00000000000044, 47.9, -50.00000000000044, 43.900000000000006, 40.90000000000002, -50.00000000000044, 30.699999999999996, -50.00000000000044, 22.899999999999885, 38.700000000000024, 45.3, 44.10000000000001, 10.299999999999706, 12.299999999999734, -50.00000000000044, -50.00000000000044, 46.099999999999994, 13.299999999999748, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 43.10000000000001, -50.00000000000044, 47.5, 4.299999999999621, -50.00000000000044, -50.00000000000044, 46.699999999999996, 6.8999999999996575, 34.900000000000034, 37.300000000000026, -50.00000000000044, -50.00000000000044], "episode_lengths": [38, 84, 52, 60, 220, 500, 68, 80, 62, 48, 500, 500, 500, 500, 500, 232, 500, 56, 68, 60, 500, 500, 46, 106, 46, 82, 360, 500, 82, 48, 500, 82, 156, 500, 500, 58, 500, 46, 278, 176, 500, 74, 62, 500, 152, 162, 32, 96, 500, 500, 500, 222, 50, 500, 98, 500, 500, 500, 24, 76, 112, 46, 52, 500, 500, 22, 500, 62, 92, 500, 194, 500, 272, 114, 48, 60, 398, 378, 500, 500, 40, 368, 66, 500, 500, 500, 500, 40, 70, 500, 26, 458, 500, 500, 34, 432, 152, 128, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40017901385700355, "mean_inference_ms": 1.2804179383845835, "mean_action_processing_ms": 0.14823155932824444, "mean_env_wait_ms": 0.089282003126921, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.033019304275512695, "StateBufferConnector_ms": 0.005139589309692383, "ViewRequirementAgentConnector_ms": 0.13098931312561035}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1128000, "num_agent_steps_trained": 1128000, "num_env_steps_sampled": 1128000, "num_env_steps_trained": 1128000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5016.480987531667, "num_env_steps_trained_throughput_per_sec": 5016.480987531667, "timesteps_total": 1128000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1128000, "timers": {"training_iteration_time_ms": 2415.922, "sample_time_ms": 2143.898, "load_time_ms": 12.893, "load_throughput": 930745.552, "learn_time_ms": 246.276, "learn_throughput": 48725.745, "synch_weights_time_ms": 10.943}, "counters": {"num_env_steps_sampled": 1128000, "num_env_steps_trained": 1128000, "num_agent_steps_sampled": 1128000, "num_agent_steps_trained": 1128000}, "done": false, "episodes_total": 4258, "training_iteration": 94, "trial_id": "9f288_00019", "date": "2023-10-25_17-10-10", "timestamp": 1698250210, "time_this_iter_s": 2.398113489151001, "time_total_s": 215.20262122154236, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 215.20262122154236, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 66.60000000000001, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.0097419586828954e-29, "cur_lr": 0.0003, "total_loss": 6.792916329701741, "policy_loss": -0.0009822071219484012, "vf_loss": 6.793949031829834, "vf_explained_var": -7.867813110351562e-07, "kl": 0.0014497311559656131, "entropy": 0.5060063421726226, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1418.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1140000, "num_env_steps_trained": 1140000, "num_agent_steps_sampled": 1140000, "num_agent_steps_trained": 1140000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.776999999999822, "episode_len_mean": 257.88, "episode_media": {}, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 27.899999999999956, 45.1, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.7, 42.500000000000014, 38.90000000000002, 45.5, 44.900000000000006, -50.00000000000044, -50.00000000000044, 47.9, -50.00000000000044, 43.900000000000006, 40.90000000000002, -50.00000000000044, 30.699999999999996, -50.00000000000044, 22.899999999999885, 38.700000000000024, 45.3, 44.10000000000001, 10.299999999999706, 12.299999999999734, -50.00000000000044, -50.00000000000044, 46.099999999999994, 13.299999999999748, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 43.10000000000001, -50.00000000000044, 47.5, 4.299999999999621, -50.00000000000044, -50.00000000000044, 46.699999999999996, 6.8999999999996575, 34.900000000000034, 37.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.50000000000003, 33.10000000000003, 47.5, 44.900000000000006, 44.300000000000004, 42.900000000000006, 38.90000000000002, 10.099999999999703, -50.00000000000044, -50.00000000000044, 1.299999999999578, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 42.30000000000001, 40.500000000000014, 41.70000000000002, 46.099999999999994, 42.30000000000001, 18.499999999999822, 35.500000000000036, 45.1, 18.899999999999828, 44.5, 43.30000000000001, -50.00000000000044, 47.3, 42.70000000000001, 44.300000000000004, 45.3, 45.5, -50.00000000000044, 42.70000000000001, 46.9, 43.30000000000001, -50.00000000000044, 36.10000000000004, 44.10000000000001, -50.00000000000044, -50.00000000000044, 47.1, 6.699999999999655, -50.00000000000044, 41.30000000000001, 45.1], "episode_lengths": [500, 222, 50, 500, 98, 500, 500, 500, 24, 76, 112, 46, 52, 500, 500, 22, 500, 62, 92, 500, 194, 500, 272, 114, 48, 60, 398, 378, 500, 500, 40, 368, 66, 500, 500, 500, 500, 40, 70, 500, 26, 458, 500, 500, 34, 432, 152, 128, 500, 500, 500, 500, 500, 116, 170, 26, 52, 58, 72, 112, 400, 500, 500, 488, 36, 500, 500, 500, 70, 78, 96, 84, 40, 78, 316, 146, 50, 312, 56, 68, 500, 28, 74, 58, 48, 46, 500, 74, 32, 68, 500, 140, 60, 500, 500, 30, 434, 500, 88, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4007888397401676, "mean_inference_ms": 1.2811698965618392, "mean_action_processing_ms": 0.14860254776956583, "mean_env_wait_ms": 0.0891701036836479, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03700971603393555, "StateBufferConnector_ms": 0.004140138626098633, "ViewRequirementAgentConnector_ms": 0.12799406051635742}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.776999999999822, "episode_len_mean": 257.88, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 27.899999999999956, 45.1, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.7, 42.500000000000014, 38.90000000000002, 45.5, 44.900000000000006, -50.00000000000044, -50.00000000000044, 47.9, -50.00000000000044, 43.900000000000006, 40.90000000000002, -50.00000000000044, 30.699999999999996, -50.00000000000044, 22.899999999999885, 38.700000000000024, 45.3, 44.10000000000001, 10.299999999999706, 12.299999999999734, -50.00000000000044, -50.00000000000044, 46.099999999999994, 13.299999999999748, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 43.10000000000001, -50.00000000000044, 47.5, 4.299999999999621, -50.00000000000044, -50.00000000000044, 46.699999999999996, 6.8999999999996575, 34.900000000000034, 37.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.50000000000003, 33.10000000000003, 47.5, 44.900000000000006, 44.300000000000004, 42.900000000000006, 38.90000000000002, 10.099999999999703, -50.00000000000044, -50.00000000000044, 1.299999999999578, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 42.30000000000001, 40.500000000000014, 41.70000000000002, 46.099999999999994, 42.30000000000001, 18.499999999999822, 35.500000000000036, 45.1, 18.899999999999828, 44.5, 43.30000000000001, -50.00000000000044, 47.3, 42.70000000000001, 44.300000000000004, 45.3, 45.5, -50.00000000000044, 42.70000000000001, 46.9, 43.30000000000001, -50.00000000000044, 36.10000000000004, 44.10000000000001, -50.00000000000044, -50.00000000000044, 47.1, 6.699999999999655, -50.00000000000044, 41.30000000000001, 45.1], "episode_lengths": [500, 222, 50, 500, 98, 500, 500, 500, 24, 76, 112, 46, 52, 500, 500, 22, 500, 62, 92, 500, 194, 500, 272, 114, 48, 60, 398, 378, 500, 500, 40, 368, 66, 500, 500, 500, 500, 40, 70, 500, 26, 458, 500, 500, 34, 432, 152, 128, 500, 500, 500, 500, 500, 116, 170, 26, 52, 58, 72, 112, 400, 500, 500, 488, 36, 500, 500, 500, 70, 78, 96, 84, 40, 78, 316, 146, 50, 312, 56, 68, 500, 28, 74, 58, 48, 46, 500, 74, 32, 68, 500, 140, 60, 500, 500, 30, 434, 500, 88, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4007888397401676, "mean_inference_ms": 1.2811698965618392, "mean_action_processing_ms": 0.14860254776956583, "mean_env_wait_ms": 0.0891701036836479, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03700971603393555, "StateBufferConnector_ms": 0.004140138626098633, "ViewRequirementAgentConnector_ms": 0.12799406051635742}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1140000, "num_agent_steps_trained": 1140000, "num_env_steps_sampled": 1140000, "num_env_steps_trained": 1140000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5192.440310298243, "num_env_steps_trained_throughput_per_sec": 5192.440310298243, "timesteps_total": 1140000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1140000, "timers": {"training_iteration_time_ms": 2409.923, "sample_time_ms": 2140.785, "load_time_ms": 12.493, "load_throughput": 960542.298, "learn_time_ms": 243.791, "learn_throughput": 49222.56, "synch_weights_time_ms": 10.943}, "counters": {"num_env_steps_sampled": 1140000, "num_env_steps_trained": 1140000, "num_agent_steps_sampled": 1140000, "num_agent_steps_trained": 1140000}, "done": false, "episodes_total": 4308, "training_iteration": 95, "trial_id": "9f288_00019", "date": "2023-10-25_17-10-12", "timestamp": 1698250212, "time_this_iter_s": 2.3170523643493652, "time_total_s": 217.51967358589172, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 217.51967358589172, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 61.86666666666667, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.048709793414477e-30, "cur_lr": 0.0003, "total_loss": 6.595360946655274, "policy_loss": -0.00055789053440094, "vf_loss": 6.595969518025716, "vf_explained_var": -5.404154459635417e-07, "kl": 0.0009371849452501616, "entropy": 0.507696928580602, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1433.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1152000, "num_env_steps_trained": 1152000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.077999999999836, "episode_len_mean": 239.9, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.50000000000003, 33.10000000000003, 47.5, 44.900000000000006, 44.300000000000004, 42.900000000000006, 38.90000000000002, 10.099999999999703, -50.00000000000044, -50.00000000000044, 1.299999999999578, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 42.30000000000001, 40.500000000000014, 41.70000000000002, 46.099999999999994, 42.30000000000001, 18.499999999999822, 35.500000000000036, 45.1, 18.899999999999828, 44.5, 43.30000000000001, -50.00000000000044, 47.3, 42.70000000000001, 44.300000000000004, 45.3, 45.5, -50.00000000000044, 42.70000000000001, 46.9, 43.30000000000001, -50.00000000000044, 36.10000000000004, 44.10000000000001, -50.00000000000044, -50.00000000000044, 47.1, 6.699999999999655, -50.00000000000044, 41.30000000000001, 45.1, 0.2999999999995637, 38.90000000000002, -50.00000000000044, 25.099999999999916, -50.00000000000044, 47.1, 45.9, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.89999999999997, -50.00000000000044, 45.9, 37.90000000000003, 46.3, 15.49999999999978, -50.00000000000044, 43.10000000000001, -50.00000000000044, 45.3, 40.70000000000002, 46.099999999999994, -50.00000000000044, 39.10000000000002, -50.00000000000044, 46.099999999999994, -50.00000000000044, 47.3, 44.7, 39.90000000000002, 21.89999999999987, 42.900000000000006, 44.5, 40.10000000000002, -50.00000000000044, 44.10000000000001, 40.10000000000002, 32.700000000000024, 43.900000000000006, 42.30000000000001, 16.8999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 34.900000000000034], "episode_lengths": [500, 500, 500, 500, 500, 116, 170, 26, 52, 58, 72, 112, 400, 500, 500, 488, 36, 500, 500, 500, 70, 78, 96, 84, 40, 78, 316, 146, 50, 312, 56, 68, 500, 28, 74, 58, 48, 46, 500, 74, 32, 68, 500, 140, 60, 500, 500, 30, 434, 500, 88, 50, 498, 112, 500, 250, 500, 30, 42, 500, 58, 500, 500, 500, 212, 500, 42, 122, 38, 346, 500, 70, 500, 48, 94, 40, 500, 110, 500, 40, 500, 28, 54, 102, 282, 72, 56, 100, 500, 60, 100, 174, 62, 78, 332, 500, 500, 500, 32, 152]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40070549290737495, "mean_inference_ms": 1.2823518121526711, "mean_action_processing_ms": 0.14886044213883465, "mean_env_wait_ms": 0.0891335986742153, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03499937057495117, "StateBufferConnector_ms": 0.007001161575317383, "ViewRequirementAgentConnector_ms": 0.13498759269714355}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.077999999999836, "episode_len_mean": 239.9, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.50000000000003, 33.10000000000003, 47.5, 44.900000000000006, 44.300000000000004, 42.900000000000006, 38.90000000000002, 10.099999999999703, -50.00000000000044, -50.00000000000044, 1.299999999999578, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 42.30000000000001, 40.500000000000014, 41.70000000000002, 46.099999999999994, 42.30000000000001, 18.499999999999822, 35.500000000000036, 45.1, 18.899999999999828, 44.5, 43.30000000000001, -50.00000000000044, 47.3, 42.70000000000001, 44.300000000000004, 45.3, 45.5, -50.00000000000044, 42.70000000000001, 46.9, 43.30000000000001, -50.00000000000044, 36.10000000000004, 44.10000000000001, -50.00000000000044, -50.00000000000044, 47.1, 6.699999999999655, -50.00000000000044, 41.30000000000001, 45.1, 0.2999999999995637, 38.90000000000002, -50.00000000000044, 25.099999999999916, -50.00000000000044, 47.1, 45.9, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.89999999999997, -50.00000000000044, 45.9, 37.90000000000003, 46.3, 15.49999999999978, -50.00000000000044, 43.10000000000001, -50.00000000000044, 45.3, 40.70000000000002, 46.099999999999994, -50.00000000000044, 39.10000000000002, -50.00000000000044, 46.099999999999994, -50.00000000000044, 47.3, 44.7, 39.90000000000002, 21.89999999999987, 42.900000000000006, 44.5, 40.10000000000002, -50.00000000000044, 44.10000000000001, 40.10000000000002, 32.700000000000024, 43.900000000000006, 42.30000000000001, 16.8999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 34.900000000000034], "episode_lengths": [500, 500, 500, 500, 500, 116, 170, 26, 52, 58, 72, 112, 400, 500, 500, 488, 36, 500, 500, 500, 70, 78, 96, 84, 40, 78, 316, 146, 50, 312, 56, 68, 500, 28, 74, 58, 48, 46, 500, 74, 32, 68, 500, 140, 60, 500, 500, 30, 434, 500, 88, 50, 498, 112, 500, 250, 500, 30, 42, 500, 58, 500, 500, 500, 212, 500, 42, 122, 38, 346, 500, 70, 500, 48, 94, 40, 500, 110, 500, 40, 500, 28, 54, 102, 282, 72, 56, 100, 500, 60, 100, 174, 62, 78, 332, 500, 500, 500, 32, 152]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40070549290737495, "mean_inference_ms": 1.2823518121526711, "mean_action_processing_ms": 0.14886044213883465, "mean_env_wait_ms": 0.0891335986742153, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03499937057495117, "StateBufferConnector_ms": 0.007001161575317383, "ViewRequirementAgentConnector_ms": 0.13498759269714355}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000, "num_env_steps_sampled": 1152000, "num_env_steps_trained": 1152000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5082.9867108436765, "num_env_steps_trained_throughput_per_sec": 5082.9867108436765, "timesteps_total": 1152000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1152000, "timers": {"training_iteration_time_ms": 2404.904, "sample_time_ms": 2134.987, "load_time_ms": 12.201, "load_throughput": 983508.703, "learn_time_ms": 245.008, "learn_throughput": 48978.085, "synch_weights_time_ms": 10.897}, "counters": {"num_env_steps_sampled": 1152000, "num_env_steps_trained": 1152000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "done": false, "episodes_total": 4356, "training_iteration": 96, "trial_id": "9f288_00019", "date": "2023-10-25_17-10-15", "timestamp": 1698250215, "time_this_iter_s": 2.3658130168914795, "time_total_s": 219.8854866027832, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 219.8854866027832, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 64.4, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.5243548967072386e-30, "cur_lr": 0.0003, "total_loss": 6.458723513285319, "policy_loss": -0.00010628352562586466, "vf_loss": 6.458875846862793, "vf_explained_var": -1.1920928955078125e-06, "kl": 0.00036220054741230946, "entropy": 0.4608242372671763, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1448.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1164000, "num_env_steps_trained": 1164000, "num_agent_steps_sampled": 1164000, "num_agent_steps_trained": 1164000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.427999999999826, "episode_len_mean": 256.38, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.10000000000001, -50.00000000000044, -50.00000000000044, 47.1, 6.699999999999655, -50.00000000000044, 41.30000000000001, 45.1, 0.2999999999995637, 38.90000000000002, -50.00000000000044, 25.099999999999916, -50.00000000000044, 47.1, 45.9, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.89999999999997, -50.00000000000044, 45.9, 37.90000000000003, 46.3, 15.49999999999978, -50.00000000000044, 43.10000000000001, -50.00000000000044, 45.3, 40.70000000000002, 46.099999999999994, -50.00000000000044, 39.10000000000002, -50.00000000000044, 46.099999999999994, -50.00000000000044, 47.3, 44.7, 39.90000000000002, 21.89999999999987, 42.900000000000006, 44.5, 40.10000000000002, -50.00000000000044, 44.10000000000001, 40.10000000000002, 32.700000000000024, 43.900000000000006, 42.30000000000001, 16.8999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 34.900000000000034, 30.099999999999987, 46.3, 29.899999999999984, 44.7, -50.00000000000044, 2.499999999999595, 30.9, 42.900000000000006, 41.70000000000002, 20.699999999999854, -50.00000000000044, 45.1, 42.900000000000006, 45.9, -50.00000000000044, 14.09999999999976, -50.00000000000044, 40.30000000000002, -50.00000000000044, 14.699999999999768, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 41.100000000000016, 46.5, 23.8999999999999, -50.00000000000044, 36.900000000000034, -50.00000000000044, 45.3, 20.299999999999848, -50.00000000000044, -50.00000000000044, 44.5, 44.900000000000006, 45.3, 37.50000000000003, 41.70000000000002, 28.89999999999997], "episode_lengths": [60, 500, 500, 30, 434, 500, 88, 50, 498, 112, 500, 250, 500, 30, 42, 500, 58, 500, 500, 500, 212, 500, 42, 122, 38, 346, 500, 70, 500, 48, 94, 40, 500, 110, 500, 40, 500, 28, 54, 102, 282, 72, 56, 100, 500, 60, 100, 174, 62, 78, 332, 500, 500, 500, 32, 152, 200, 38, 202, 54, 500, 476, 192, 72, 84, 294, 500, 50, 72, 42, 500, 360, 500, 98, 500, 354, 500, 68, 500, 500, 500, 500, 500, 40, 90, 36, 262, 500, 132, 500, 48, 298, 500, 500, 56, 52, 48, 126, 84, 212]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4009562084410836, "mean_inference_ms": 1.2835493593444423, "mean_action_processing_ms": 0.14844429772368709, "mean_env_wait_ms": 0.08934001886752195, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03299999237060547, "StateBufferConnector_ms": 0.007999897003173828, "ViewRequirementAgentConnector_ms": 0.13398265838623047}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.427999999999826, "episode_len_mean": 256.38, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.10000000000001, -50.00000000000044, -50.00000000000044, 47.1, 6.699999999999655, -50.00000000000044, 41.30000000000001, 45.1, 0.2999999999995637, 38.90000000000002, -50.00000000000044, 25.099999999999916, -50.00000000000044, 47.1, 45.9, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.89999999999997, -50.00000000000044, 45.9, 37.90000000000003, 46.3, 15.49999999999978, -50.00000000000044, 43.10000000000001, -50.00000000000044, 45.3, 40.70000000000002, 46.099999999999994, -50.00000000000044, 39.10000000000002, -50.00000000000044, 46.099999999999994, -50.00000000000044, 47.3, 44.7, 39.90000000000002, 21.89999999999987, 42.900000000000006, 44.5, 40.10000000000002, -50.00000000000044, 44.10000000000001, 40.10000000000002, 32.700000000000024, 43.900000000000006, 42.30000000000001, 16.8999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 34.900000000000034, 30.099999999999987, 46.3, 29.899999999999984, 44.7, -50.00000000000044, 2.499999999999595, 30.9, 42.900000000000006, 41.70000000000002, 20.699999999999854, -50.00000000000044, 45.1, 42.900000000000006, 45.9, -50.00000000000044, 14.09999999999976, -50.00000000000044, 40.30000000000002, -50.00000000000044, 14.699999999999768, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 41.100000000000016, 46.5, 23.8999999999999, -50.00000000000044, 36.900000000000034, -50.00000000000044, 45.3, 20.299999999999848, -50.00000000000044, -50.00000000000044, 44.5, 44.900000000000006, 45.3, 37.50000000000003, 41.70000000000002, 28.89999999999997], "episode_lengths": [60, 500, 500, 30, 434, 500, 88, 50, 498, 112, 500, 250, 500, 30, 42, 500, 58, 500, 500, 500, 212, 500, 42, 122, 38, 346, 500, 70, 500, 48, 94, 40, 500, 110, 500, 40, 500, 28, 54, 102, 282, 72, 56, 100, 500, 60, 100, 174, 62, 78, 332, 500, 500, 500, 32, 152, 200, 38, 202, 54, 500, 476, 192, 72, 84, 294, 500, 50, 72, 42, 500, 360, 500, 98, 500, 354, 500, 68, 500, 500, 500, 500, 500, 40, 90, 36, 262, 500, 132, 500, 48, 298, 500, 500, 56, 52, 48, 126, 84, 212]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4009562084410836, "mean_inference_ms": 1.2835493593444423, "mean_action_processing_ms": 0.14844429772368709, "mean_env_wait_ms": 0.08934001886752195, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03299999237060547, "StateBufferConnector_ms": 0.007999897003173828, "ViewRequirementAgentConnector_ms": 0.13398265838623047}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1164000, "num_agent_steps_trained": 1164000, "num_env_steps_sampled": 1164000, "num_env_steps_trained": 1164000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4947.182763569168, "num_env_steps_trained_throughput_per_sec": 4947.182763569168, "timesteps_total": 1164000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1164000, "timers": {"training_iteration_time_ms": 2406.808, "sample_time_ms": 2137.88, "load_time_ms": 12.303, "load_throughput": 975379.839, "learn_time_ms": 244.04, "learn_throughput": 49172.216, "synch_weights_time_ms": 10.873}, "counters": {"num_env_steps_sampled": 1164000, "num_env_steps_trained": 1164000, "num_agent_steps_sampled": 1164000, "num_agent_steps_trained": 1164000}, "done": false, "episodes_total": 4400, "training_iteration": 97, "trial_id": "9f288_00019", "date": "2023-10-25_17-10-17", "timestamp": 1698250217, "time_this_iter_s": 2.4306185245513916, "time_total_s": 222.3161051273346, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 222.3161051273346, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 67.86666666666667, "ram_util_percent": 27.266666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.2621774483536193e-30, "cur_lr": 0.0003, "total_loss": 6.7972028414408365, "policy_loss": 9.705871343612671e-06, "vf_loss": 6.7972420374552405, "vf_explained_var": -8.900960286458333e-07, "kl": 8.072648427817816e-05, "entropy": 0.4889165997505188, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1463.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1176000, "num_env_steps_trained": 1176000, "num_agent_steps_sampled": 1176000, "num_agent_steps_trained": 1176000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.128999999999823, "episode_len_mean": 264.34, "episode_media": {}, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.8999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 34.900000000000034, 30.099999999999987, 46.3, 29.899999999999984, 44.7, -50.00000000000044, 2.499999999999595, 30.9, 42.900000000000006, 41.70000000000002, 20.699999999999854, -50.00000000000044, 45.1, 42.900000000000006, 45.9, -50.00000000000044, 14.09999999999976, -50.00000000000044, 40.30000000000002, -50.00000000000044, 14.699999999999768, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 41.100000000000016, 46.5, 23.8999999999999, -50.00000000000044, 36.900000000000034, -50.00000000000044, 45.3, 20.299999999999848, -50.00000000000044, -50.00000000000044, 44.5, 44.900000000000006, 45.3, 37.50000000000003, 41.70000000000002, 28.89999999999997, 42.70000000000001, -50.00000000000044, -50.00000000000044, 39.300000000000026, 45.5, -50.00000000000044, 41.30000000000001, -50.00000000000044, 45.1, 38.10000000000002, -50.00000000000044, -50.00000000000044, 41.30000000000001, 43.900000000000006, 28.09999999999996, -50.00000000000044, 45.1, 44.10000000000001, 38.90000000000002, -50.00000000000044, -50.00000000000044, 26.69999999999994, 45.3, 44.10000000000001, -50.00000000000044, -50.00000000000044, 30.699999999999996, -50.00000000000044, 25.29999999999992, 41.70000000000002, 46.5, -50.00000000000044, 38.300000000000026, 44.300000000000004, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, 30.9, 37.70000000000003, 34.900000000000034, 44.900000000000006, -50.00000000000044, 44.900000000000006, 43.900000000000006, 24.69999999999991, 44.300000000000004], "episode_lengths": [332, 500, 500, 500, 32, 152, 200, 38, 202, 54, 500, 476, 192, 72, 84, 294, 500, 50, 72, 42, 500, 360, 500, 98, 500, 354, 500, 68, 500, 500, 500, 500, 500, 40, 90, 36, 262, 500, 132, 500, 48, 298, 500, 500, 56, 52, 48, 126, 84, 212, 74, 500, 500, 108, 46, 500, 88, 500, 50, 120, 500, 500, 88, 62, 220, 500, 50, 60, 112, 500, 500, 234, 48, 60, 500, 500, 194, 500, 248, 84, 36, 500, 118, 58, 500, 56, 500, 500, 500, 500, 118, 192, 124, 152, 52, 500, 52, 62, 254, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4007679950071856, "mean_inference_ms": 1.2836666334930158, "mean_action_processing_ms": 0.14879844076138848, "mean_env_wait_ms": 0.08945471005265748, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030527353286743164, "StateBufferConnector_ms": 0.008009672164916992, "ViewRequirementAgentConnector_ms": 0.130997896194458}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.128999999999823, "episode_len_mean": 264.34, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [16.8999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 34.900000000000034, 30.099999999999987, 46.3, 29.899999999999984, 44.7, -50.00000000000044, 2.499999999999595, 30.9, 42.900000000000006, 41.70000000000002, 20.699999999999854, -50.00000000000044, 45.1, 42.900000000000006, 45.9, -50.00000000000044, 14.09999999999976, -50.00000000000044, 40.30000000000002, -50.00000000000044, 14.699999999999768, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 41.100000000000016, 46.5, 23.8999999999999, -50.00000000000044, 36.900000000000034, -50.00000000000044, 45.3, 20.299999999999848, -50.00000000000044, -50.00000000000044, 44.5, 44.900000000000006, 45.3, 37.50000000000003, 41.70000000000002, 28.89999999999997, 42.70000000000001, -50.00000000000044, -50.00000000000044, 39.300000000000026, 45.5, -50.00000000000044, 41.30000000000001, -50.00000000000044, 45.1, 38.10000000000002, -50.00000000000044, -50.00000000000044, 41.30000000000001, 43.900000000000006, 28.09999999999996, -50.00000000000044, 45.1, 44.10000000000001, 38.90000000000002, -50.00000000000044, -50.00000000000044, 26.69999999999994, 45.3, 44.10000000000001, -50.00000000000044, -50.00000000000044, 30.699999999999996, -50.00000000000044, 25.29999999999992, 41.70000000000002, 46.5, -50.00000000000044, 38.300000000000026, 44.300000000000004, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, 30.9, 37.70000000000003, 34.900000000000034, 44.900000000000006, -50.00000000000044, 44.900000000000006, 43.900000000000006, 24.69999999999991, 44.300000000000004], "episode_lengths": [332, 500, 500, 500, 32, 152, 200, 38, 202, 54, 500, 476, 192, 72, 84, 294, 500, 50, 72, 42, 500, 360, 500, 98, 500, 354, 500, 68, 500, 500, 500, 500, 500, 40, 90, 36, 262, 500, 132, 500, 48, 298, 500, 500, 56, 52, 48, 126, 84, 212, 74, 500, 500, 108, 46, 500, 88, 500, 50, 120, 500, 500, 88, 62, 220, 500, 50, 60, 112, 500, 500, 234, 48, 60, 500, 500, 194, 500, 248, 84, 36, 500, 118, 58, 500, 56, 500, 500, 500, 500, 118, 192, 124, 152, 52, 500, 52, 62, 254, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4007679950071856, "mean_inference_ms": 1.2836666334930158, "mean_action_processing_ms": 0.14879844076138848, "mean_env_wait_ms": 0.08945471005265748, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030527353286743164, "StateBufferConnector_ms": 0.008009672164916992, "ViewRequirementAgentConnector_ms": 0.130997896194458}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1176000, "num_agent_steps_trained": 1176000, "num_env_steps_sampled": 1176000, "num_env_steps_trained": 1176000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5056.340536850655, "num_env_steps_trained_throughput_per_sec": 5056.340536850655, "timesteps_total": 1176000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1176000, "timers": {"training_iteration_time_ms": 2403.252, "sample_time_ms": 2134.959, "load_time_ms": 12.202, "load_throughput": 983445.287, "learn_time_ms": 243.944, "learn_throughput": 49191.55, "synch_weights_time_ms": 10.435}, "counters": {"num_env_steps_sampled": 1176000, "num_env_steps_trained": 1176000, "num_agent_steps_sampled": 1176000, "num_agent_steps_trained": 1176000}, "done": false, "episodes_total": 4450, "training_iteration": 98, "trial_id": "9f288_00019", "date": "2023-10-25_17-10-20", "timestamp": 1698250220, "time_this_iter_s": 2.3782541751861572, "time_total_s": 224.69435930252075, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 224.69435930252075, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 58.85, "ram_util_percent": 27.275}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.3108872417680965e-31, "cur_lr": 0.0003, "total_loss": 6.888702519734701, "policy_loss": -0.0004927431543668111, "vf_loss": 6.889249738057455, "vf_explained_var": -6.993611653645833e-07, "kl": 0.0007945927250811261, "entropy": 0.5459264198939006, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1478.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1188000, "num_env_steps_trained": 1188000, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 15.923999999999873, "episode_len_mean": 211.5, "episode_media": {}, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 41.30000000000001, 43.900000000000006, 28.09999999999996, -50.00000000000044, 45.1, 44.10000000000001, 38.90000000000002, -50.00000000000044, -50.00000000000044, 26.69999999999994, 45.3, 44.10000000000001, -50.00000000000044, -50.00000000000044, 30.699999999999996, -50.00000000000044, 25.29999999999992, 41.70000000000002, 46.5, -50.00000000000044, 38.300000000000026, 44.300000000000004, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, 30.9, 37.70000000000003, 34.900000000000034, 44.900000000000006, -50.00000000000044, 44.900000000000006, 43.900000000000006, 24.69999999999991, 44.300000000000004, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 7.299999999999663, 26.89999999999994, -50.00000000000044, 45.7, 46.699999999999996, -50.00000000000044, 33.500000000000036, 42.30000000000001, 40.500000000000014, 42.500000000000014, 46.9, 41.30000000000001, 36.50000000000003, 24.499999999999908, -50.00000000000044, 46.3, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 44.900000000000006, 43.30000000000001, -50.00000000000044, 46.9, 43.30000000000001, 4.099999999999618, 45.9, 44.10000000000001, 6.299999999999649, 43.10000000000001, 45.5, 43.7, 45.9, 43.30000000000001, 46.099999999999994, 42.30000000000001, -50.00000000000044, 44.900000000000006, 42.30000000000001, 40.30000000000002, 45.7, 14.299999999999763, 33.90000000000004, 46.3, 45.3, 40.500000000000014, 43.900000000000006, -50.00000000000044, 43.900000000000006, 35.70000000000003, 41.90000000000001, 43.30000000000001, 43.900000000000006, 47.1, 28.699999999999967, 45.9, 31.70000000000001], "episode_lengths": [500, 88, 62, 220, 500, 50, 60, 112, 500, 500, 234, 48, 60, 500, 500, 194, 500, 248, 84, 36, 500, 118, 58, 500, 56, 500, 500, 500, 500, 118, 192, 124, 152, 52, 500, 52, 62, 254, 58, 500, 500, 58, 500, 428, 232, 500, 44, 34, 500, 166, 78, 96, 76, 32, 88, 136, 256, 500, 38, 500, 44, 500, 500, 52, 68, 500, 32, 68, 460, 42, 60, 438, 70, 46, 64, 42, 68, 40, 78, 500, 52, 78, 98, 44, 358, 162, 38, 48, 96, 62, 500, 62, 144, 82, 68, 62, 30, 214, 42, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4009282113049118, "mean_inference_ms": 1.2855177887979639, "mean_action_processing_ms": 0.1489455906602022, "mean_env_wait_ms": 0.08940978777231497, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025968551635742188, "StateBufferConnector_ms": 0.0019996166229248047, "ViewRequirementAgentConnector_ms": 0.14101266860961914}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 15.923999999999873, "episode_len_mean": 211.5, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 41.30000000000001, 43.900000000000006, 28.09999999999996, -50.00000000000044, 45.1, 44.10000000000001, 38.90000000000002, -50.00000000000044, -50.00000000000044, 26.69999999999994, 45.3, 44.10000000000001, -50.00000000000044, -50.00000000000044, 30.699999999999996, -50.00000000000044, 25.29999999999992, 41.70000000000002, 46.5, -50.00000000000044, 38.300000000000026, 44.300000000000004, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, 30.9, 37.70000000000003, 34.900000000000034, 44.900000000000006, -50.00000000000044, 44.900000000000006, 43.900000000000006, 24.69999999999991, 44.300000000000004, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 7.299999999999663, 26.89999999999994, -50.00000000000044, 45.7, 46.699999999999996, -50.00000000000044, 33.500000000000036, 42.30000000000001, 40.500000000000014, 42.500000000000014, 46.9, 41.30000000000001, 36.50000000000003, 24.499999999999908, -50.00000000000044, 46.3, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 44.900000000000006, 43.30000000000001, -50.00000000000044, 46.9, 43.30000000000001, 4.099999999999618, 45.9, 44.10000000000001, 6.299999999999649, 43.10000000000001, 45.5, 43.7, 45.9, 43.30000000000001, 46.099999999999994, 42.30000000000001, -50.00000000000044, 44.900000000000006, 42.30000000000001, 40.30000000000002, 45.7, 14.299999999999763, 33.90000000000004, 46.3, 45.3, 40.500000000000014, 43.900000000000006, -50.00000000000044, 43.900000000000006, 35.70000000000003, 41.90000000000001, 43.30000000000001, 43.900000000000006, 47.1, 28.699999999999967, 45.9, 31.70000000000001], "episode_lengths": [500, 88, 62, 220, 500, 50, 60, 112, 500, 500, 234, 48, 60, 500, 500, 194, 500, 248, 84, 36, 500, 118, 58, 500, 56, 500, 500, 500, 500, 118, 192, 124, 152, 52, 500, 52, 62, 254, 58, 500, 500, 58, 500, 428, 232, 500, 44, 34, 500, 166, 78, 96, 76, 32, 88, 136, 256, 500, 38, 500, 44, 500, 500, 52, 68, 500, 32, 68, 460, 42, 60, 438, 70, 46, 64, 42, 68, 40, 78, 500, 52, 78, 98, 44, 358, 162, 38, 48, 96, 62, 500, 62, 144, 82, 68, 62, 30, 214, 42, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4009282113049118, "mean_inference_ms": 1.2855177887979639, "mean_action_processing_ms": 0.1489455906602022, "mean_env_wait_ms": 0.08940978777231497, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025968551635742188, "StateBufferConnector_ms": 0.0019996166229248047, "ViewRequirementAgentConnector_ms": 0.14101266860961914}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000, "num_env_steps_sampled": 1188000, "num_env_steps_trained": 1188000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4989.783621197311, "num_env_steps_trained_throughput_per_sec": 4989.783621197311, "timesteps_total": 1188000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1188000, "timers": {"training_iteration_time_ms": 2403.246, "sample_time_ms": 2135.159, "load_time_ms": 12.205, "load_throughput": 983207.068, "learn_time_ms": 243.698, "learn_throughput": 49241.341, "synch_weights_time_ms": 10.473}, "counters": {"num_env_steps_sampled": 1188000, "num_env_steps_trained": 1188000, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000}, "done": false, "episodes_total": 4511, "training_iteration": 99, "trial_id": "9f288_00019", "date": "2023-10-25_17-10-22", "timestamp": 1698250222, "time_this_iter_s": 2.4097330570220947, "time_total_s": 227.10409235954285, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 227.10409235954285, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 70.96666666666667, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.1554436208840483e-31, "cur_lr": 0.0003, "total_loss": 6.733791637420654, "policy_loss": -0.0006714741388956706, "vf_loss": 6.734513123830159, "vf_explained_var": -8.026758829752604e-07, "kl": 0.0011326004947629067, "entropy": 0.5014124592145284, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1493.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1200000, "num_env_steps_trained": 1200000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 16.912999999999872, "episode_len_mean": 206.62, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.699999999999996, -50.00000000000044, 33.500000000000036, 42.30000000000001, 40.500000000000014, 42.500000000000014, 46.9, 41.30000000000001, 36.50000000000003, 24.499999999999908, -50.00000000000044, 46.3, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 44.900000000000006, 43.30000000000001, -50.00000000000044, 46.9, 43.30000000000001, 4.099999999999618, 45.9, 44.10000000000001, 6.299999999999649, 43.10000000000001, 45.5, 43.7, 45.9, 43.30000000000001, 46.099999999999994, 42.30000000000001, -50.00000000000044, 44.900000000000006, 42.30000000000001, 40.30000000000002, 45.7, 14.299999999999763, 33.90000000000004, 46.3, 45.3, 40.500000000000014, 43.900000000000006, -50.00000000000044, 43.900000000000006, 35.70000000000003, 41.90000000000001, 43.30000000000001, 43.900000000000006, 47.1, 28.699999999999967, 45.9, 31.70000000000001, -50.00000000000044, 46.699999999999996, 44.300000000000004, 41.500000000000014, 22.299999999999876, -50.00000000000044, 20.699999999999854, -50.00000000000044, 45.3, 40.10000000000002, -50.00000000000044, 27.49999999999995, 42.30000000000001, -50.00000000000044, 35.70000000000003, 37.50000000000003, -50.00000000000044, -50.00000000000044, 40.30000000000002, 46.3, -50.00000000000044, -50.00000000000044, 10.499999999999709, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 29.49999999999998, 44.900000000000006, 41.100000000000016, 43.7, -50.00000000000044, 6.699999999999655, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 46.5, 37.50000000000003, 46.3, 44.900000000000006, 45.7, 46.099999999999994, 43.10000000000001, 35.10000000000004], "episode_lengths": [34, 500, 166, 78, 96, 76, 32, 88, 136, 256, 500, 38, 500, 44, 500, 500, 52, 68, 500, 32, 68, 460, 42, 60, 438, 70, 46, 64, 42, 68, 40, 78, 500, 52, 78, 98, 44, 358, 162, 38, 48, 96, 62, 500, 62, 144, 82, 68, 62, 30, 214, 42, 184, 500, 34, 58, 86, 278, 500, 294, 500, 48, 100, 500, 226, 78, 500, 144, 126, 500, 500, 98, 38, 500, 500, 396, 58, 500, 500, 500, 500, 54, 206, 52, 90, 64, 500, 434, 500, 500, 48, 500, 36, 126, 38, 52, 44, 40, 70, 150]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4013211239637366, "mean_inference_ms": 1.2865031609171047, "mean_action_processing_ms": 0.14884624291097354, "mean_env_wait_ms": 0.08951172805197158, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03197169303894043, "StateBufferConnector_ms": 0.0060002803802490234, "ViewRequirementAgentConnector_ms": 0.15105032920837402}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 16.912999999999872, "episode_len_mean": 206.62, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.699999999999996, -50.00000000000044, 33.500000000000036, 42.30000000000001, 40.500000000000014, 42.500000000000014, 46.9, 41.30000000000001, 36.50000000000003, 24.499999999999908, -50.00000000000044, 46.3, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 44.900000000000006, 43.30000000000001, -50.00000000000044, 46.9, 43.30000000000001, 4.099999999999618, 45.9, 44.10000000000001, 6.299999999999649, 43.10000000000001, 45.5, 43.7, 45.9, 43.30000000000001, 46.099999999999994, 42.30000000000001, -50.00000000000044, 44.900000000000006, 42.30000000000001, 40.30000000000002, 45.7, 14.299999999999763, 33.90000000000004, 46.3, 45.3, 40.500000000000014, 43.900000000000006, -50.00000000000044, 43.900000000000006, 35.70000000000003, 41.90000000000001, 43.30000000000001, 43.900000000000006, 47.1, 28.699999999999967, 45.9, 31.70000000000001, -50.00000000000044, 46.699999999999996, 44.300000000000004, 41.500000000000014, 22.299999999999876, -50.00000000000044, 20.699999999999854, -50.00000000000044, 45.3, 40.10000000000002, -50.00000000000044, 27.49999999999995, 42.30000000000001, -50.00000000000044, 35.70000000000003, 37.50000000000003, -50.00000000000044, -50.00000000000044, 40.30000000000002, 46.3, -50.00000000000044, -50.00000000000044, 10.499999999999709, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 29.49999999999998, 44.900000000000006, 41.100000000000016, 43.7, -50.00000000000044, 6.699999999999655, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 46.5, 37.50000000000003, 46.3, 44.900000000000006, 45.7, 46.099999999999994, 43.10000000000001, 35.10000000000004], "episode_lengths": [34, 500, 166, 78, 96, 76, 32, 88, 136, 256, 500, 38, 500, 44, 500, 500, 52, 68, 500, 32, 68, 460, 42, 60, 438, 70, 46, 64, 42, 68, 40, 78, 500, 52, 78, 98, 44, 358, 162, 38, 48, 96, 62, 500, 62, 144, 82, 68, 62, 30, 214, 42, 184, 500, 34, 58, 86, 278, 500, 294, 500, 48, 100, 500, 226, 78, 500, 144, 126, 500, 500, 98, 38, 500, 500, 396, 58, 500, 500, 500, 500, 54, 206, 52, 90, 64, 500, 434, 500, 500, 48, 500, 36, 126, 38, 52, 44, 40, 70, 150]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4013211239637366, "mean_inference_ms": 1.2865031609171047, "mean_action_processing_ms": 0.14884624291097354, "mean_env_wait_ms": 0.08951172805197158, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03197169303894043, "StateBufferConnector_ms": 0.0060002803802490234, "ViewRequirementAgentConnector_ms": 0.15105032920837402}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000, "num_env_steps_sampled": 1200000, "num_env_steps_trained": 1200000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4744.868935889804, "num_env_steps_trained_throughput_per_sec": 4744.868935889804, "timesteps_total": 1200000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1200000, "timers": {"training_iteration_time_ms": 2417.612, "sample_time_ms": 2149.077, "load_time_ms": 12.214, "load_throughput": 982479.68, "learn_time_ms": 243.842, "learn_throughput": 49212.285, "synch_weights_time_ms": 10.778}, "counters": {"num_env_steps_sampled": 1200000, "num_env_steps_trained": 1200000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "done": false, "episodes_total": 4558, "training_iteration": 100, "trial_id": "9f288_00019", "date": "2023-10-25_17-10-25", "timestamp": 1698250225, "time_this_iter_s": 2.535043239593506, "time_total_s": 229.63913559913635, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 229.63913559913635, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 58.175, "ram_util_percent": 27.325000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.5777218104420241e-31, "cur_lr": 0.0003, "total_loss": 7.057737064361572, "policy_loss": -0.0003970339894294739, "vf_loss": 7.058186149597168, "vf_explained_var": -9.934107462565105e-07, "kl": 0.0008371914588375754, "entropy": 0.5198220690091451, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1508.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1212000, "num_env_steps_trained": 1212000, "num_agent_steps_sampled": 1212000, "num_agent_steps_trained": 1212000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.945999999999833, "episode_len_mean": 251.22, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.90000000000001, 43.30000000000001, 43.900000000000006, 47.1, 28.699999999999967, 45.9, 31.70000000000001, -50.00000000000044, 46.699999999999996, 44.300000000000004, 41.500000000000014, 22.299999999999876, -50.00000000000044, 20.699999999999854, -50.00000000000044, 45.3, 40.10000000000002, -50.00000000000044, 27.49999999999995, 42.30000000000001, -50.00000000000044, 35.70000000000003, 37.50000000000003, -50.00000000000044, -50.00000000000044, 40.30000000000002, 46.3, -50.00000000000044, -50.00000000000044, 10.499999999999709, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 29.49999999999998, 44.900000000000006, 41.100000000000016, 43.7, -50.00000000000044, 6.699999999999655, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 46.5, 37.50000000000003, 46.3, 44.900000000000006, 45.7, 46.099999999999994, 43.10000000000001, 35.10000000000004, -50.00000000000044, 45.7, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.700000000000024, -50.00000000000044, -50.00000000000044, 42.70000000000001, 5.499999999999638, 47.3, 44.300000000000004, 46.099999999999994, 44.10000000000001, 45.1, 42.900000000000006, 29.49999999999998, 46.5, 35.10000000000004, 16.09999999999979, 43.30000000000001, -50.00000000000044, -50.00000000000044, 6.499999999999652, 45.7, 14.899999999999771, 44.7, 10.499999999999709, 43.10000000000001, -50.00000000000044, 42.30000000000001, -50.00000000000044, 17.899999999999814, 35.900000000000034, -50.00000000000044, 33.30000000000003, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 7.499999999999666, 45.3, 19.09999999999983, 38.90000000000002], "episode_lengths": [82, 68, 62, 30, 214, 42, 184, 500, 34, 58, 86, 278, 500, 294, 500, 48, 100, 500, 226, 78, 500, 144, 126, 500, 500, 98, 38, 500, 500, 396, 58, 500, 500, 500, 500, 54, 206, 52, 90, 64, 500, 434, 500, 500, 48, 500, 36, 126, 38, 52, 44, 40, 70, 150, 500, 44, 30, 500, 500, 500, 174, 500, 500, 74, 446, 28, 58, 40, 60, 50, 72, 206, 36, 150, 340, 68, 500, 500, 436, 44, 352, 54, 396, 70, 500, 78, 500, 322, 142, 500, 168, 500, 40, 500, 500, 500, 426, 48, 310, 112]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4013734390719918, "mean_inference_ms": 1.286107418116089, "mean_action_processing_ms": 0.14894106138230906, "mean_env_wait_ms": 0.08970322653754391, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03500533103942871, "StateBufferConnector_ms": 0.0069980621337890625, "ViewRequirementAgentConnector_ms": 0.15399670600891113}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.945999999999833, "episode_len_mean": 251.22, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [41.90000000000001, 43.30000000000001, 43.900000000000006, 47.1, 28.699999999999967, 45.9, 31.70000000000001, -50.00000000000044, 46.699999999999996, 44.300000000000004, 41.500000000000014, 22.299999999999876, -50.00000000000044, 20.699999999999854, -50.00000000000044, 45.3, 40.10000000000002, -50.00000000000044, 27.49999999999995, 42.30000000000001, -50.00000000000044, 35.70000000000003, 37.50000000000003, -50.00000000000044, -50.00000000000044, 40.30000000000002, 46.3, -50.00000000000044, -50.00000000000044, 10.499999999999709, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 29.49999999999998, 44.900000000000006, 41.100000000000016, 43.7, -50.00000000000044, 6.699999999999655, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 46.5, 37.50000000000003, 46.3, 44.900000000000006, 45.7, 46.099999999999994, 43.10000000000001, 35.10000000000004, -50.00000000000044, 45.7, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.700000000000024, -50.00000000000044, -50.00000000000044, 42.70000000000001, 5.499999999999638, 47.3, 44.300000000000004, 46.099999999999994, 44.10000000000001, 45.1, 42.900000000000006, 29.49999999999998, 46.5, 35.10000000000004, 16.09999999999979, 43.30000000000001, -50.00000000000044, -50.00000000000044, 6.499999999999652, 45.7, 14.899999999999771, 44.7, 10.499999999999709, 43.10000000000001, -50.00000000000044, 42.30000000000001, -50.00000000000044, 17.899999999999814, 35.900000000000034, -50.00000000000044, 33.30000000000003, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 7.499999999999666, 45.3, 19.09999999999983, 38.90000000000002], "episode_lengths": [82, 68, 62, 30, 214, 42, 184, 500, 34, 58, 86, 278, 500, 294, 500, 48, 100, 500, 226, 78, 500, 144, 126, 500, 500, 98, 38, 500, 500, 396, 58, 500, 500, 500, 500, 54, 206, 52, 90, 64, 500, 434, 500, 500, 48, 500, 36, 126, 38, 52, 44, 40, 70, 150, 500, 44, 30, 500, 500, 500, 174, 500, 500, 74, 446, 28, 58, 40, 60, 50, 72, 206, 36, 150, 340, 68, 500, 500, 436, 44, 352, 54, 396, 70, 500, 78, 500, 322, 142, 500, 168, 500, 40, 500, 500, 500, 426, 48, 310, 112]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4013734390719918, "mean_inference_ms": 1.286107418116089, "mean_action_processing_ms": 0.14894106138230906, "mean_env_wait_ms": 0.08970322653754391, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03500533103942871, "StateBufferConnector_ms": 0.0069980621337890625, "ViewRequirementAgentConnector_ms": 0.15399670600891113}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1212000, "num_agent_steps_trained": 1212000, "num_env_steps_sampled": 1212000, "num_env_steps_trained": 1212000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4933.950457230775, "num_env_steps_trained_throughput_per_sec": 4933.950457230775, "timesteps_total": 1212000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1212000, "timers": {"training_iteration_time_ms": 2424.67, "sample_time_ms": 2151.075, "load_time_ms": 12.813, "load_throughput": 936535.175, "learn_time_ms": 248.187, "learn_throughput": 48350.556, "synch_weights_time_ms": 10.893}, "counters": {"num_env_steps_sampled": 1212000, "num_env_steps_trained": 1212000, "num_agent_steps_sampled": 1212000, "num_agent_steps_trained": 1212000}, "done": false, "episodes_total": 4604, "training_iteration": 101, "trial_id": "9f288_00019", "date": "2023-10-25_17-10-27", "timestamp": 1698250227, "time_this_iter_s": 2.4377658367156982, "time_total_s": 232.07690143585205, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 232.07690143585205, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 71.26666666666667, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.888609052210121e-32, "cur_lr": 0.0003, "total_loss": 6.795942592620849, "policy_loss": -0.0002986043691635132, "vf_loss": 6.796296660105387, "vf_explained_var": -9.61621602376302e-07, "kl": 0.0004784699734197299, "entropy": 0.5539847652117411, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1523.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1224000, "num_env_steps_trained": 1224000, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.054999999999838, "episode_len_mean": 245.14, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.3, 44.900000000000006, 45.7, 46.099999999999994, 43.10000000000001, 35.10000000000004, -50.00000000000044, 45.7, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.700000000000024, -50.00000000000044, -50.00000000000044, 42.70000000000001, 5.499999999999638, 47.3, 44.300000000000004, 46.099999999999994, 44.10000000000001, 45.1, 42.900000000000006, 29.49999999999998, 46.5, 35.10000000000004, 16.09999999999979, 43.30000000000001, -50.00000000000044, -50.00000000000044, 6.499999999999652, 45.7, 14.899999999999771, 44.7, 10.499999999999709, 43.10000000000001, -50.00000000000044, 42.30000000000001, -50.00000000000044, 17.899999999999814, 35.900000000000034, -50.00000000000044, 33.30000000000003, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 7.499999999999666, 45.3, 19.09999999999983, 38.90000000000002, -50.00000000000044, 32.700000000000024, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 34.50000000000004, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 46.5, 46.3, -50.00000000000044, 39.70000000000002, 17.299999999999805, 45.5, 45.3, 26.299999999999933, -50.00000000000044, 42.70000000000001, 8.299999999999677, 31.1, -50.00000000000044, 44.900000000000006, 28.89999999999997, -50.00000000000044, 33.30000000000003, 43.50000000000001, 42.10000000000001, 47.1, 42.10000000000001, 16.29999999999979, 45.9, 42.500000000000014, 26.69999999999994, 47.5, -50.00000000000044, -50.00000000000044, 38.10000000000002, 44.5, 45.9, -50.00000000000044, 45.1, 44.10000000000001], "episode_lengths": [38, 52, 44, 40, 70, 150, 500, 44, 30, 500, 500, 500, 174, 500, 500, 74, 446, 28, 58, 40, 60, 50, 72, 206, 36, 150, 340, 68, 500, 500, 436, 44, 352, 54, 396, 70, 500, 78, 500, 322, 142, 500, 168, 500, 40, 500, 500, 500, 426, 48, 310, 112, 500, 174, 32, 500, 500, 500, 58, 500, 500, 156, 500, 74, 500, 500, 36, 38, 500, 104, 328, 46, 48, 238, 500, 74, 418, 190, 500, 52, 212, 500, 168, 66, 80, 30, 80, 338, 42, 76, 234, 26, 500, 500, 120, 56, 42, 500, 50, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4015422804582886, "mean_inference_ms": 1.2865897747701547, "mean_action_processing_ms": 0.14937449511090042, "mean_env_wait_ms": 0.08956765022079903, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.036371469497680664, "StateBufferConnector_ms": 0.007993459701538086, "ViewRequirementAgentConnector_ms": 0.1419832706451416}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.054999999999838, "episode_len_mean": 245.14, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.3, 44.900000000000006, 45.7, 46.099999999999994, 43.10000000000001, 35.10000000000004, -50.00000000000044, 45.7, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.700000000000024, -50.00000000000044, -50.00000000000044, 42.70000000000001, 5.499999999999638, 47.3, 44.300000000000004, 46.099999999999994, 44.10000000000001, 45.1, 42.900000000000006, 29.49999999999998, 46.5, 35.10000000000004, 16.09999999999979, 43.30000000000001, -50.00000000000044, -50.00000000000044, 6.499999999999652, 45.7, 14.899999999999771, 44.7, 10.499999999999709, 43.10000000000001, -50.00000000000044, 42.30000000000001, -50.00000000000044, 17.899999999999814, 35.900000000000034, -50.00000000000044, 33.30000000000003, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 7.499999999999666, 45.3, 19.09999999999983, 38.90000000000002, -50.00000000000044, 32.700000000000024, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 34.50000000000004, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 46.5, 46.3, -50.00000000000044, 39.70000000000002, 17.299999999999805, 45.5, 45.3, 26.299999999999933, -50.00000000000044, 42.70000000000001, 8.299999999999677, 31.1, -50.00000000000044, 44.900000000000006, 28.89999999999997, -50.00000000000044, 33.30000000000003, 43.50000000000001, 42.10000000000001, 47.1, 42.10000000000001, 16.29999999999979, 45.9, 42.500000000000014, 26.69999999999994, 47.5, -50.00000000000044, -50.00000000000044, 38.10000000000002, 44.5, 45.9, -50.00000000000044, 45.1, 44.10000000000001], "episode_lengths": [38, 52, 44, 40, 70, 150, 500, 44, 30, 500, 500, 500, 174, 500, 500, 74, 446, 28, 58, 40, 60, 50, 72, 206, 36, 150, 340, 68, 500, 500, 436, 44, 352, 54, 396, 70, 500, 78, 500, 322, 142, 500, 168, 500, 40, 500, 500, 500, 426, 48, 310, 112, 500, 174, 32, 500, 500, 500, 58, 500, 500, 156, 500, 74, 500, 500, 36, 38, 500, 104, 328, 46, 48, 238, 500, 74, 418, 190, 500, 52, 212, 500, 168, 66, 80, 30, 80, 338, 42, 76, 234, 26, 500, 500, 120, 56, 42, 500, 50, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4015422804582886, "mean_inference_ms": 1.2865897747701547, "mean_action_processing_ms": 0.14937449511090042, "mean_env_wait_ms": 0.08956765022079903, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.036371469497680664, "StateBufferConnector_ms": 0.007993459701538086, "ViewRequirementAgentConnector_ms": 0.1419832706451416}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000, "num_env_steps_sampled": 1224000, "num_env_steps_trained": 1224000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5021.071549173815, "num_env_steps_trained_throughput_per_sec": 5021.071549173815, "timesteps_total": 1224000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1224000, "timers": {"training_iteration_time_ms": 2417.298, "sample_time_ms": 2142.699, "load_time_ms": 12.82, "load_throughput": 936045.75, "learn_time_ms": 249.185, "learn_throughput": 48156.98, "synch_weights_time_ms": 10.893}, "counters": {"num_env_steps_sampled": 1224000, "num_env_steps_trained": 1224000, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000}, "done": false, "episodes_total": 4652, "training_iteration": 102, "trial_id": "9f288_00019", "date": "2023-10-25_17-10-29", "timestamp": 1698250229, "time_this_iter_s": 2.394925117492676, "time_total_s": 234.47182655334473, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 234.47182655334473, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 63.866666666666674, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.9443045261050603e-32, "cur_lr": 0.0003, "total_loss": 6.343025906880697, "policy_loss": -0.0003620043396949768, "vf_loss": 6.343437512715657, "vf_explained_var": -8.265177408854167e-07, "kl": 0.000597671013482189, "entropy": 0.49389648040135703, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1538.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1236000, "num_env_steps_trained": 1236000, "num_agent_steps_sampled": 1236000, "num_agent_steps_trained": 1236000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.8479999999998102, "episode_len_mean": 272.12, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.900000000000034, -50.00000000000044, 33.30000000000003, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 7.499999999999666, 45.3, 19.09999999999983, 38.90000000000002, -50.00000000000044, 32.700000000000024, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 34.50000000000004, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 46.5, 46.3, -50.00000000000044, 39.70000000000002, 17.299999999999805, 45.5, 45.3, 26.299999999999933, -50.00000000000044, 42.70000000000001, 8.299999999999677, 31.1, -50.00000000000044, 44.900000000000006, 28.89999999999997, -50.00000000000044, 33.30000000000003, 43.50000000000001, 42.10000000000001, 47.1, 42.10000000000001, 16.29999999999979, 45.9, 42.500000000000014, 26.69999999999994, 47.5, -50.00000000000044, -50.00000000000044, 38.10000000000002, 44.5, 45.9, -50.00000000000044, 45.1, 44.10000000000001, -50.00000000000044, 43.900000000000006, 27.899999999999956, 44.10000000000001, -50.00000000000044, 44.7, -50.00000000000044, 45.5, 44.7, -50.00000000000044, -50.00000000000044, 34.30000000000004, 46.099999999999994, -50.00000000000044, -50.00000000000044, 46.099999999999994, 39.300000000000026, -50.00000000000044, -50.00000000000044, 28.29999999999996, 33.10000000000003, -50.00000000000044, 23.499999999999893, 45.5, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 38.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 45.5, 44.5, 21.499999999999865], "episode_lengths": [142, 500, 168, 500, 40, 500, 500, 500, 426, 48, 310, 112, 500, 174, 32, 500, 500, 500, 58, 500, 500, 156, 500, 74, 500, 500, 36, 38, 500, 104, 328, 46, 48, 238, 500, 74, 418, 190, 500, 52, 212, 500, 168, 66, 80, 30, 80, 338, 42, 76, 234, 26, 500, 500, 120, 56, 42, 500, 50, 60, 500, 62, 222, 60, 500, 54, 500, 46, 54, 500, 500, 158, 40, 500, 500, 40, 108, 500, 500, 218, 170, 500, 266, 46, 50, 500, 500, 500, 500, 78, 116, 500, 500, 500, 500, 500, 44, 46, 56, 286]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4019722488822351, "mean_inference_ms": 1.2872551403953596, "mean_action_processing_ms": 0.14936053687774473, "mean_env_wait_ms": 0.08959438088349392, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03436875343322754, "StateBufferConnector_ms": 0.009988784790039062, "ViewRequirementAgentConnector_ms": 0.14800381660461426}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.8479999999998102, "episode_len_mean": 272.12, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [35.900000000000034, -50.00000000000044, 33.30000000000003, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 7.499999999999666, 45.3, 19.09999999999983, 38.90000000000002, -50.00000000000044, 32.700000000000024, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 34.50000000000004, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 46.5, 46.3, -50.00000000000044, 39.70000000000002, 17.299999999999805, 45.5, 45.3, 26.299999999999933, -50.00000000000044, 42.70000000000001, 8.299999999999677, 31.1, -50.00000000000044, 44.900000000000006, 28.89999999999997, -50.00000000000044, 33.30000000000003, 43.50000000000001, 42.10000000000001, 47.1, 42.10000000000001, 16.29999999999979, 45.9, 42.500000000000014, 26.69999999999994, 47.5, -50.00000000000044, -50.00000000000044, 38.10000000000002, 44.5, 45.9, -50.00000000000044, 45.1, 44.10000000000001, -50.00000000000044, 43.900000000000006, 27.899999999999956, 44.10000000000001, -50.00000000000044, 44.7, -50.00000000000044, 45.5, 44.7, -50.00000000000044, -50.00000000000044, 34.30000000000004, 46.099999999999994, -50.00000000000044, -50.00000000000044, 46.099999999999994, 39.300000000000026, -50.00000000000044, -50.00000000000044, 28.29999999999996, 33.10000000000003, -50.00000000000044, 23.499999999999893, 45.5, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 38.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 45.5, 44.5, 21.499999999999865], "episode_lengths": [142, 500, 168, 500, 40, 500, 500, 500, 426, 48, 310, 112, 500, 174, 32, 500, 500, 500, 58, 500, 500, 156, 500, 74, 500, 500, 36, 38, 500, 104, 328, 46, 48, 238, 500, 74, 418, 190, 500, 52, 212, 500, 168, 66, 80, 30, 80, 338, 42, 76, 234, 26, 500, 500, 120, 56, 42, 500, 50, 60, 500, 62, 222, 60, 500, 54, 500, 46, 54, 500, 500, 158, 40, 500, 500, 40, 108, 500, 500, 218, 170, 500, 266, 46, 50, 500, 500, 500, 500, 78, 116, 500, 500, 500, 500, 500, 44, 46, 56, 286]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4019722488822351, "mean_inference_ms": 1.2872551403953596, "mean_action_processing_ms": 0.14936053687774473, "mean_env_wait_ms": 0.08959438088349392, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03436875343322754, "StateBufferConnector_ms": 0.009988784790039062, "ViewRequirementAgentConnector_ms": 0.14800381660461426}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1236000, "num_agent_steps_trained": 1236000, "num_env_steps_sampled": 1236000, "num_env_steps_trained": 1236000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4995.2434096556, "num_env_steps_trained_throughput_per_sec": 4995.2434096556, "timesteps_total": 1236000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1236000, "timers": {"training_iteration_time_ms": 2401.917, "sample_time_ms": 2127.458, "load_time_ms": 13.02, "load_throughput": 921684.945, "learn_time_ms": 248.906, "learn_throughput": 48211.06, "synch_weights_time_ms": 10.933}, "counters": {"num_env_steps_sampled": 1236000, "num_env_steps_trained": 1236000, "num_agent_steps_sampled": 1236000, "num_agent_steps_trained": 1236000}, "done": false, "episodes_total": 4692, "training_iteration": 103, "trial_id": "9f288_00019", "date": "2023-10-25_17-10-32", "timestamp": 1698250232, "time_this_iter_s": 2.4082794189453125, "time_total_s": 236.88010597229004, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 236.88010597229004, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 61.525, "ram_util_percent": 27.325000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.9721522630525302e-32, "cur_lr": 0.0003, "total_loss": 6.410551993052165, "policy_loss": -6.53366247812907e-05, "vf_loss": 6.410668595631917, "vf_explained_var": -6.914138793945312e-07, "kl": 9.717965126772772e-05, "entropy": 0.5118651668230693, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1553.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1248000, "num_env_steps_trained": 1248000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.0819999999998196, "episode_len_mean": 259.8, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.29999999999979, 45.9, 42.500000000000014, 26.69999999999994, 47.5, -50.00000000000044, -50.00000000000044, 38.10000000000002, 44.5, 45.9, -50.00000000000044, 45.1, 44.10000000000001, -50.00000000000044, 43.900000000000006, 27.899999999999956, 44.10000000000001, -50.00000000000044, 44.7, -50.00000000000044, 45.5, 44.7, -50.00000000000044, -50.00000000000044, 34.30000000000004, 46.099999999999994, -50.00000000000044, -50.00000000000044, 46.099999999999994, 39.300000000000026, -50.00000000000044, -50.00000000000044, 28.29999999999996, 33.10000000000003, -50.00000000000044, 23.499999999999893, 45.5, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 38.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 45.5, 44.5, 21.499999999999865, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.30000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.70000000000004, 44.900000000000006, 23.8999999999999, -50.00000000000044, 44.300000000000004, 18.499999999999822, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, 46.699999999999996, 45.7, 30.699999999999996, 39.70000000000002, 20.699999999999854, 44.7, 46.9, -50.00000000000044, 44.10000000000001, 46.5, 16.09999999999979, 44.300000000000004, 41.30000000000001, 44.900000000000006, 45.9, -50.00000000000044, 47.5, 22.49999999999988, 38.300000000000026, -50.00000000000044, 45.9, 43.30000000000001, -50.00000000000044, 3.499999999999609, 44.7, -50.00000000000044, -50.00000000000044, 46.3, 44.5], "episode_lengths": [338, 42, 76, 234, 26, 500, 500, 120, 56, 42, 500, 50, 60, 500, 62, 222, 60, 500, 54, 500, 46, 54, 500, 500, 158, 40, 500, 500, 40, 108, 500, 500, 218, 170, 500, 266, 46, 50, 500, 500, 500, 500, 78, 116, 500, 500, 500, 500, 500, 44, 46, 56, 286, 500, 500, 500, 138, 500, 500, 500, 164, 52, 262, 500, 58, 316, 56, 500, 500, 500, 94, 34, 44, 194, 104, 294, 54, 32, 500, 60, 36, 340, 58, 88, 52, 42, 500, 26, 276, 118, 500, 42, 68, 500, 466, 54, 500, 500, 38, 56]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40212217166296155, "mean_inference_ms": 1.2878894591482537, "mean_action_processing_ms": 0.14907705322284287, "mean_env_wait_ms": 0.08976744646791676, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03699803352355957, "StateBufferConnector_ms": 0.007015228271484375, "ViewRequirementAgentConnector_ms": 0.1460094451904297}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.0819999999998196, "episode_len_mean": 259.8, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [16.29999999999979, 45.9, 42.500000000000014, 26.69999999999994, 47.5, -50.00000000000044, -50.00000000000044, 38.10000000000002, 44.5, 45.9, -50.00000000000044, 45.1, 44.10000000000001, -50.00000000000044, 43.900000000000006, 27.899999999999956, 44.10000000000001, -50.00000000000044, 44.7, -50.00000000000044, 45.5, 44.7, -50.00000000000044, -50.00000000000044, 34.30000000000004, 46.099999999999994, -50.00000000000044, -50.00000000000044, 46.099999999999994, 39.300000000000026, -50.00000000000044, -50.00000000000044, 28.29999999999996, 33.10000000000003, -50.00000000000044, 23.499999999999893, 45.5, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 38.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 45.5, 44.5, 21.499999999999865, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.30000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.70000000000004, 44.900000000000006, 23.8999999999999, -50.00000000000044, 44.300000000000004, 18.499999999999822, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, 46.699999999999996, 45.7, 30.699999999999996, 39.70000000000002, 20.699999999999854, 44.7, 46.9, -50.00000000000044, 44.10000000000001, 46.5, 16.09999999999979, 44.300000000000004, 41.30000000000001, 44.900000000000006, 45.9, -50.00000000000044, 47.5, 22.49999999999988, 38.300000000000026, -50.00000000000044, 45.9, 43.30000000000001, -50.00000000000044, 3.499999999999609, 44.7, -50.00000000000044, -50.00000000000044, 46.3, 44.5], "episode_lengths": [338, 42, 76, 234, 26, 500, 500, 120, 56, 42, 500, 50, 60, 500, 62, 222, 60, 500, 54, 500, 46, 54, 500, 500, 158, 40, 500, 500, 40, 108, 500, 500, 218, 170, 500, 266, 46, 50, 500, 500, 500, 500, 78, 116, 500, 500, 500, 500, 500, 44, 46, 56, 286, 500, 500, 500, 138, 500, 500, 500, 164, 52, 262, 500, 58, 316, 56, 500, 500, 500, 94, 34, 44, 194, 104, 294, 54, 32, 500, 60, 36, 340, 58, 88, 52, 42, 500, 26, 276, 118, 500, 42, 68, 500, 466, 54, 500, 500, 38, 56]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40212217166296155, "mean_inference_ms": 1.2878894591482537, "mean_action_processing_ms": 0.14907705322284287, "mean_env_wait_ms": 0.08976744646791676, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03699803352355957, "StateBufferConnector_ms": 0.007015228271484375, "ViewRequirementAgentConnector_ms": 0.1460094451904297}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000, "num_env_steps_sampled": 1248000, "num_env_steps_trained": 1248000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5052.946073287707, "num_env_steps_trained_throughput_per_sec": 5052.946073287707, "timesteps_total": 1248000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1248000, "timers": {"training_iteration_time_ms": 2400.089, "sample_time_ms": 2130.131, "load_time_ms": 12.021, "load_throughput": 998261.539, "learn_time_ms": 245.501, "learn_throughput": 48879.677, "synch_weights_time_ms": 10.833}, "counters": {"num_env_steps_sampled": 1248000, "num_env_steps_trained": 1248000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "done": false, "episodes_total": 4739, "training_iteration": 104, "trial_id": "9f288_00019", "date": "2023-10-25_17-10-34", "timestamp": 1698250234, "time_this_iter_s": 2.3798489570617676, "time_total_s": 239.2599549293518, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 239.2599549293518, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 69.60000000000001, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.860761315262651e-33, "cur_lr": 0.0003, "total_loss": 6.97378609975179, "policy_loss": -9.763861695925395e-05, "vf_loss": 6.973928705851237, "vf_explained_var": -1.0410944620768228e-06, "kl": 0.00017861344697394087, "entropy": 0.4490361392498016, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1568.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1260000, "num_env_steps_trained": 1260000, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.6469999999998235, "episode_len_mean": 249.18, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 36.30000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.70000000000004, 44.900000000000006, 23.8999999999999, -50.00000000000044, 44.300000000000004, 18.499999999999822, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, 46.699999999999996, 45.7, 30.699999999999996, 39.70000000000002, 20.699999999999854, 44.7, 46.9, -50.00000000000044, 44.10000000000001, 46.5, 16.09999999999979, 44.300000000000004, 41.30000000000001, 44.900000000000006, 45.9, -50.00000000000044, 47.5, 22.49999999999988, 38.300000000000026, -50.00000000000044, 45.9, 43.30000000000001, -50.00000000000044, 3.499999999999609, 44.7, -50.00000000000044, -50.00000000000044, 46.3, 44.5, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 31.900000000000013, 40.90000000000002, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 19.09999999999983, -50.00000000000044, 45.7, 5.099999999999632, 45.7, 44.900000000000006, 46.699999999999996, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 46.9, -50.00000000000044, 45.3, 43.10000000000001, 47.1, -50.00000000000044, -50.00000000000044, 45.5, 44.900000000000006, 46.5, 45.5, 45.5, 13.299999999999748, -50.00000000000044, 45.1, -50.00000000000044, 44.10000000000001, -50.00000000000044, 44.300000000000004, 47.3, 12.099999999999731, -50.00000000000044, 46.5, -50.00000000000044, 34.10000000000004, 45.3, 43.30000000000001, -50.00000000000044, 22.699999999999882, 44.300000000000004, 15.699999999999783], "episode_lengths": [500, 500, 500, 138, 500, 500, 500, 164, 52, 262, 500, 58, 316, 56, 500, 500, 500, 94, 34, 44, 194, 104, 294, 54, 32, 500, 60, 36, 340, 58, 88, 52, 42, 500, 26, 276, 118, 500, 42, 68, 500, 466, 54, 500, 500, 38, 56, 500, 42, 500, 500, 182, 92, 48, 500, 500, 500, 28, 310, 500, 44, 450, 44, 52, 34, 500, 500, 38, 500, 32, 500, 48, 70, 30, 500, 500, 46, 52, 36, 46, 46, 368, 500, 50, 500, 60, 500, 58, 28, 380, 500, 36, 500, 160, 48, 68, 500, 274, 58, 344]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4023217416363952, "mean_inference_ms": 1.2880113049720785, "mean_action_processing_ms": 0.1494251916527771, "mean_env_wait_ms": 0.08963089293386943, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03999495506286621, "StateBufferConnector_ms": 0.0060176849365234375, "ViewRequirementAgentConnector_ms": 0.12697672843933105}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.6469999999998235, "episode_len_mean": 249.18, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 36.30000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.70000000000004, 44.900000000000006, 23.8999999999999, -50.00000000000044, 44.300000000000004, 18.499999999999822, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, 46.699999999999996, 45.7, 30.699999999999996, 39.70000000000002, 20.699999999999854, 44.7, 46.9, -50.00000000000044, 44.10000000000001, 46.5, 16.09999999999979, 44.300000000000004, 41.30000000000001, 44.900000000000006, 45.9, -50.00000000000044, 47.5, 22.49999999999988, 38.300000000000026, -50.00000000000044, 45.9, 43.30000000000001, -50.00000000000044, 3.499999999999609, 44.7, -50.00000000000044, -50.00000000000044, 46.3, 44.5, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 31.900000000000013, 40.90000000000002, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 19.09999999999983, -50.00000000000044, 45.7, 5.099999999999632, 45.7, 44.900000000000006, 46.699999999999996, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 46.9, -50.00000000000044, 45.3, 43.10000000000001, 47.1, -50.00000000000044, -50.00000000000044, 45.5, 44.900000000000006, 46.5, 45.5, 45.5, 13.299999999999748, -50.00000000000044, 45.1, -50.00000000000044, 44.10000000000001, -50.00000000000044, 44.300000000000004, 47.3, 12.099999999999731, -50.00000000000044, 46.5, -50.00000000000044, 34.10000000000004, 45.3, 43.30000000000001, -50.00000000000044, 22.699999999999882, 44.300000000000004, 15.699999999999783], "episode_lengths": [500, 500, 500, 138, 500, 500, 500, 164, 52, 262, 500, 58, 316, 56, 500, 500, 500, 94, 34, 44, 194, 104, 294, 54, 32, 500, 60, 36, 340, 58, 88, 52, 42, 500, 26, 276, 118, 500, 42, 68, 500, 466, 54, 500, 500, 38, 56, 500, 42, 500, 500, 182, 92, 48, 500, 500, 500, 28, 310, 500, 44, 450, 44, 52, 34, 500, 500, 38, 500, 32, 500, 48, 70, 30, 500, 500, 46, 52, 36, 46, 46, 368, 500, 50, 500, 60, 500, 58, 28, 380, 500, 36, 500, 160, 48, 68, 500, 274, 58, 344]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4023217416363952, "mean_inference_ms": 1.2880113049720785, "mean_action_processing_ms": 0.1494251916527771, "mean_env_wait_ms": 0.08963089293386943, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03999495506286621, "StateBufferConnector_ms": 0.0060176849365234375, "ViewRequirementAgentConnector_ms": 0.12697672843933105}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000, "num_env_steps_sampled": 1260000, "num_env_steps_trained": 1260000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5025.788450291507, "num_env_steps_trained_throughput_per_sec": 5025.788450291507, "timesteps_total": 1260000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1260000, "timers": {"training_iteration_time_ms": 2407.752, "sample_time_ms": 2135.002, "load_time_ms": 12.253, "load_throughput": 979373.089, "learn_time_ms": 247.873, "learn_throughput": 48411.889, "synch_weights_time_ms": 10.93}, "counters": {"num_env_steps_sampled": 1260000, "num_env_steps_trained": 1260000, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000}, "done": false, "episodes_total": 4792, "training_iteration": 105, "trial_id": "9f288_00019", "date": "2023-10-25_17-10-37", "timestamp": 1698250237, "time_this_iter_s": 2.3936712741851807, "time_total_s": 241.653626203537, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 241.653626203537, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 66.10000000000001, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.9303806576313254e-33, "cur_lr": 0.0003, "total_loss": 6.707804902394613, "policy_loss": -0.00017497216661771137, "vf_loss": 6.708026154836019, "vf_explained_var": -9.854634602864584e-07, "kl": 0.0004106026307075202, "entropy": 0.46307605107625327, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1583.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1272000, "num_env_steps_trained": 1272000, "num_agent_steps_sampled": 1272000, "num_agent_steps_trained": 1272000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.194999999999812, "episode_len_mean": 253.68, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 46.3, 44.5, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 31.900000000000013, 40.90000000000002, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 19.09999999999983, -50.00000000000044, 45.7, 5.099999999999632, 45.7, 44.900000000000006, 46.699999999999996, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 46.9, -50.00000000000044, 45.3, 43.10000000000001, 47.1, -50.00000000000044, -50.00000000000044, 45.5, 44.900000000000006, 46.5, 45.5, 45.5, 13.299999999999748, -50.00000000000044, 45.1, -50.00000000000044, 44.10000000000001, -50.00000000000044, 44.300000000000004, 47.3, 12.099999999999731, -50.00000000000044, 46.5, -50.00000000000044, 34.10000000000004, 45.3, 43.30000000000001, -50.00000000000044, 22.699999999999882, 44.300000000000004, 15.699999999999783, -50.00000000000044, 25.699999999999925, 45.5, 45.3, 46.099999999999994, 44.300000000000004, 19.899999999999842, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 47.1, 46.699999999999996, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.300000000000004, 6.099999999999646, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 43.7, 42.500000000000014, 39.10000000000002, -50.00000000000044, 40.500000000000014, -50.00000000000044, 43.30000000000001, 45.3, -50.00000000000044, 40.70000000000002, -50.00000000000044, 20.099999999999845, 26.299999999999933, -50.00000000000044, 46.5, 31.300000000000004, 46.3, 27.899999999999956, -50.00000000000044], "episode_lengths": [500, 500, 38, 56, 500, 42, 500, 500, 182, 92, 48, 500, 500, 500, 28, 310, 500, 44, 450, 44, 52, 34, 500, 500, 38, 500, 32, 500, 48, 70, 30, 500, 500, 46, 52, 36, 46, 46, 368, 500, 50, 500, 60, 500, 58, 28, 380, 500, 36, 500, 160, 48, 68, 500, 274, 58, 344, 500, 244, 46, 48, 40, 58, 302, 500, 42, 500, 500, 500, 56, 30, 34, 40, 500, 500, 58, 440, 500, 500, 56, 500, 64, 76, 110, 500, 96, 500, 68, 48, 500, 94, 500, 300, 238, 500, 36, 188, 38, 222, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4026572491766773, "mean_inference_ms": 1.2883521292675355, "mean_action_processing_ms": 0.1495384552951111, "mean_env_wait_ms": 0.08961606431729524, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03599286079406738, "StateBufferConnector_ms": 0.004995822906494141, "ViewRequirementAgentConnector_ms": 0.11598467826843262}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.194999999999812, "episode_len_mean": 253.68, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 46.3, 44.5, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 31.900000000000013, 40.90000000000002, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 19.09999999999983, -50.00000000000044, 45.7, 5.099999999999632, 45.7, 44.900000000000006, 46.699999999999996, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 46.9, -50.00000000000044, 45.3, 43.10000000000001, 47.1, -50.00000000000044, -50.00000000000044, 45.5, 44.900000000000006, 46.5, 45.5, 45.5, 13.299999999999748, -50.00000000000044, 45.1, -50.00000000000044, 44.10000000000001, -50.00000000000044, 44.300000000000004, 47.3, 12.099999999999731, -50.00000000000044, 46.5, -50.00000000000044, 34.10000000000004, 45.3, 43.30000000000001, -50.00000000000044, 22.699999999999882, 44.300000000000004, 15.699999999999783, -50.00000000000044, 25.699999999999925, 45.5, 45.3, 46.099999999999994, 44.300000000000004, 19.899999999999842, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 47.1, 46.699999999999996, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.300000000000004, 6.099999999999646, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 43.7, 42.500000000000014, 39.10000000000002, -50.00000000000044, 40.500000000000014, -50.00000000000044, 43.30000000000001, 45.3, -50.00000000000044, 40.70000000000002, -50.00000000000044, 20.099999999999845, 26.299999999999933, -50.00000000000044, 46.5, 31.300000000000004, 46.3, 27.899999999999956, -50.00000000000044], "episode_lengths": [500, 500, 38, 56, 500, 42, 500, 500, 182, 92, 48, 500, 500, 500, 28, 310, 500, 44, 450, 44, 52, 34, 500, 500, 38, 500, 32, 500, 48, 70, 30, 500, 500, 46, 52, 36, 46, 46, 368, 500, 50, 500, 60, 500, 58, 28, 380, 500, 36, 500, 160, 48, 68, 500, 274, 58, 344, 500, 244, 46, 48, 40, 58, 302, 500, 42, 500, 500, 500, 56, 30, 34, 40, 500, 500, 58, 440, 500, 500, 56, 500, 64, 76, 110, 500, 96, 500, 68, 48, 500, 94, 500, 300, 238, 500, 36, 188, 38, 222, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4026572491766773, "mean_inference_ms": 1.2883521292675355, "mean_action_processing_ms": 0.1495384552951111, "mean_env_wait_ms": 0.08961606431729524, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03599286079406738, "StateBufferConnector_ms": 0.004995822906494141, "ViewRequirementAgentConnector_ms": 0.11598467826843262}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1272000, "num_agent_steps_trained": 1272000, "num_env_steps_sampled": 1272000, "num_env_steps_trained": 1272000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5017.345110865442, "num_env_steps_trained_throughput_per_sec": 5017.345110865442, "timesteps_total": 1272000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1272000, "timers": {"training_iteration_time_ms": 2410.841, "sample_time_ms": 2137.888, "load_time_ms": 12.253, "load_throughput": 979367.372, "learn_time_ms": 247.861, "learn_throughput": 48414.264, "synch_weights_time_ms": 11.045}, "counters": {"num_env_steps_sampled": 1272000, "num_env_steps_trained": 1272000, "num_agent_steps_sampled": 1272000, "num_agent_steps_trained": 1272000}, "done": false, "episodes_total": 4835, "training_iteration": 106, "trial_id": "9f288_00019", "date": "2023-10-25_17-10-39", "timestamp": 1698250239, "time_this_iter_s": 2.3966989517211914, "time_total_s": 244.05032515525818, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 244.05032515525818, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 64.0, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.4651903288156627e-33, "cur_lr": 0.0003, "total_loss": 6.727692731221517, "policy_loss": -3.860977788766225e-05, "vf_loss": 6.727781709035238, "vf_explained_var": -1.0331471761067708e-06, "kl": 0.00010943030773281255, "entropy": 0.5046603182951609, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1598.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1284000, "num_env_steps_trained": 1284000, "num_agent_steps_sampled": 1284000, "num_agent_steps_trained": 1284000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.351999999999821, "episode_len_mean": 257.12, "episode_media": {}, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 34.10000000000004, 45.3, 43.30000000000001, -50.00000000000044, 22.699999999999882, 44.300000000000004, 15.699999999999783, -50.00000000000044, 25.699999999999925, 45.5, 45.3, 46.099999999999994, 44.300000000000004, 19.899999999999842, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 47.1, 46.699999999999996, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.300000000000004, 6.099999999999646, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 43.7, 42.500000000000014, 39.10000000000002, -50.00000000000044, 40.500000000000014, -50.00000000000044, 43.30000000000001, 45.3, -50.00000000000044, 40.70000000000002, -50.00000000000044, 20.099999999999845, 26.299999999999933, -50.00000000000044, 46.5, 31.300000000000004, 46.3, 27.899999999999956, -50.00000000000044, -50.00000000000044, 18.29999999999982, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 42.10000000000001, 45.5, 43.900000000000006, 18.899999999999828, -50.00000000000044, 2.299999999999592, 46.3, 34.50000000000004, -50.00000000000044, 37.300000000000026, 46.5, -50.00000000000044, -50.00000000000044, 47.1, 20.099999999999845, 43.900000000000006, -50.00000000000044, 46.3, 40.70000000000002, 44.7, 46.3, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 29.099999999999973, 44.5, 46.3, 14.699999999999768, 46.9, 33.70000000000004, 42.30000000000001, 45.5, -50.00000000000044, -50.00000000000044, 46.5, 45.7, -50.00000000000044, 30.099999999999987, -50.00000000000044], "episode_lengths": [500, 160, 48, 68, 500, 274, 58, 344, 500, 244, 46, 48, 40, 58, 302, 500, 42, 500, 500, 500, 56, 30, 34, 40, 500, 500, 58, 440, 500, 500, 56, 500, 64, 76, 110, 500, 96, 500, 68, 48, 500, 94, 500, 300, 238, 500, 36, 188, 38, 222, 500, 500, 318, 500, 500, 500, 48, 80, 46, 62, 312, 500, 478, 38, 156, 500, 128, 36, 500, 500, 30, 300, 62, 500, 38, 94, 54, 38, 54, 500, 500, 500, 500, 500, 58, 210, 56, 38, 354, 32, 164, 78, 46, 500, 500, 36, 44, 500, 200, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40296464313076824, "mean_inference_ms": 1.2890433955395297, "mean_action_processing_ms": 0.1492969773723884, "mean_env_wait_ms": 0.08974874557508426, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02700519561767578, "StateBufferConnector_ms": 0.0029976367950439453, "ViewRequirementAgentConnector_ms": 0.13699603080749512}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.351999999999821, "episode_len_mean": 257.12, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 34.10000000000004, 45.3, 43.30000000000001, -50.00000000000044, 22.699999999999882, 44.300000000000004, 15.699999999999783, -50.00000000000044, 25.699999999999925, 45.5, 45.3, 46.099999999999994, 44.300000000000004, 19.899999999999842, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 47.1, 46.699999999999996, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.300000000000004, 6.099999999999646, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 43.7, 42.500000000000014, 39.10000000000002, -50.00000000000044, 40.500000000000014, -50.00000000000044, 43.30000000000001, 45.3, -50.00000000000044, 40.70000000000002, -50.00000000000044, 20.099999999999845, 26.299999999999933, -50.00000000000044, 46.5, 31.300000000000004, 46.3, 27.899999999999956, -50.00000000000044, -50.00000000000044, 18.29999999999982, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 42.10000000000001, 45.5, 43.900000000000006, 18.899999999999828, -50.00000000000044, 2.299999999999592, 46.3, 34.50000000000004, -50.00000000000044, 37.300000000000026, 46.5, -50.00000000000044, -50.00000000000044, 47.1, 20.099999999999845, 43.900000000000006, -50.00000000000044, 46.3, 40.70000000000002, 44.7, 46.3, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 29.099999999999973, 44.5, 46.3, 14.699999999999768, 46.9, 33.70000000000004, 42.30000000000001, 45.5, -50.00000000000044, -50.00000000000044, 46.5, 45.7, -50.00000000000044, 30.099999999999987, -50.00000000000044], "episode_lengths": [500, 160, 48, 68, 500, 274, 58, 344, 500, 244, 46, 48, 40, 58, 302, 500, 42, 500, 500, 500, 56, 30, 34, 40, 500, 500, 58, 440, 500, 500, 56, 500, 64, 76, 110, 500, 96, 500, 68, 48, 500, 94, 500, 300, 238, 500, 36, 188, 38, 222, 500, 500, 318, 500, 500, 500, 48, 80, 46, 62, 312, 500, 478, 38, 156, 500, 128, 36, 500, 500, 30, 300, 62, 500, 38, 94, 54, 38, 54, 500, 500, 500, 500, 500, 58, 210, 56, 38, 354, 32, 164, 78, 46, 500, 500, 36, 44, 500, 200, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40296464313076824, "mean_inference_ms": 1.2890433955395297, "mean_action_processing_ms": 0.1492969773723884, "mean_env_wait_ms": 0.08974874557508426, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02700519561767578, "StateBufferConnector_ms": 0.0029976367950439453, "ViewRequirementAgentConnector_ms": 0.13699603080749512}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1284000, "num_agent_steps_trained": 1284000, "num_env_steps_sampled": 1284000, "num_env_steps_trained": 1284000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5131.577683659452, "num_env_steps_trained_throughput_per_sec": 5131.577683659452, "timesteps_total": 1284000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1284000, "timers": {"training_iteration_time_ms": 2402.224, "sample_time_ms": 2129.88, "load_time_ms": 12.051, "load_throughput": 995751.389, "learn_time_ms": 247.534, "learn_throughput": 48478.102, "synch_weights_time_ms": 10.965}, "counters": {"num_env_steps_sampled": 1284000, "num_env_steps_trained": 1284000, "num_agent_steps_sampled": 1284000, "num_agent_steps_trained": 1284000}, "done": false, "episodes_total": 4884, "training_iteration": 107, "trial_id": "9f288_00019", "date": "2023-10-25_17-10-41", "timestamp": 1698250241, "time_this_iter_s": 2.345381498336792, "time_total_s": 246.39570665359497, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 246.39570665359497, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 66.36666666666667, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.2325951644078314e-33, "cur_lr": 0.0003, "total_loss": 6.393698279062907, "policy_loss": -0.00030364890893300374, "vf_loss": 6.3940503120422365, "vf_explained_var": -1.2715657552083333e-06, "kl": 0.0005634098284190258, "entropy": 0.48544652462005616, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1613.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1296000, "num_env_steps_trained": 1296000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.023999999999811, "episode_len_mean": 270.38, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.3, -50.00000000000044, 40.70000000000002, -50.00000000000044, 20.099999999999845, 26.299999999999933, -50.00000000000044, 46.5, 31.300000000000004, 46.3, 27.899999999999956, -50.00000000000044, -50.00000000000044, 18.29999999999982, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 42.10000000000001, 45.5, 43.900000000000006, 18.899999999999828, -50.00000000000044, 2.299999999999592, 46.3, 34.50000000000004, -50.00000000000044, 37.300000000000026, 46.5, -50.00000000000044, -50.00000000000044, 47.1, 20.099999999999845, 43.900000000000006, -50.00000000000044, 46.3, 40.70000000000002, 44.7, 46.3, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 29.099999999999973, 44.5, 46.3, 14.699999999999768, 46.9, 33.70000000000004, 42.30000000000001, 45.5, -50.00000000000044, -50.00000000000044, 46.5, 45.7, -50.00000000000044, 30.099999999999987, -50.00000000000044, 45.3, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044, 11.29999999999972, -50.00000000000044, -50.00000000000044, 44.5, 18.699999999999825, -50.00000000000044, 35.500000000000036, 45.7, 45.7, 43.7, -50.00000000000044, 36.30000000000003, 8.299999999999677, 46.3, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 12.69999999999974, 39.70000000000002, -50.00000000000044, 45.5, 38.10000000000002, 38.700000000000024, 39.90000000000002, -50.00000000000044, 41.500000000000014, 34.70000000000004, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, 30.29999999999999, -50.00000000000044], "episode_lengths": [48, 500, 94, 500, 300, 238, 500, 36, 188, 38, 222, 500, 500, 318, 500, 500, 500, 48, 80, 46, 62, 312, 500, 478, 38, 156, 500, 128, 36, 500, 500, 30, 300, 62, 500, 38, 94, 54, 38, 54, 500, 500, 500, 500, 500, 58, 210, 56, 38, 354, 32, 164, 78, 46, 500, 500, 36, 44, 500, 200, 500, 48, 500, 92, 500, 500, 388, 500, 500, 56, 314, 500, 146, 44, 44, 64, 500, 138, 418, 38, 500, 500, 70, 500, 374, 104, 500, 46, 120, 114, 102, 500, 86, 154, 500, 500, 28, 500, 198, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40293900626358675, "mean_inference_ms": 1.2897508761637324, "mean_action_processing_ms": 0.1493861752399907, "mean_env_wait_ms": 0.08974207702944734, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024003982543945312, "StateBufferConnector_ms": 0.0029952526092529297, "ViewRequirementAgentConnector_ms": 0.1427919864654541}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.023999999999811, "episode_len_mean": 270.38, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.3, -50.00000000000044, 40.70000000000002, -50.00000000000044, 20.099999999999845, 26.299999999999933, -50.00000000000044, 46.5, 31.300000000000004, 46.3, 27.899999999999956, -50.00000000000044, -50.00000000000044, 18.29999999999982, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 42.10000000000001, 45.5, 43.900000000000006, 18.899999999999828, -50.00000000000044, 2.299999999999592, 46.3, 34.50000000000004, -50.00000000000044, 37.300000000000026, 46.5, -50.00000000000044, -50.00000000000044, 47.1, 20.099999999999845, 43.900000000000006, -50.00000000000044, 46.3, 40.70000000000002, 44.7, 46.3, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 29.099999999999973, 44.5, 46.3, 14.699999999999768, 46.9, 33.70000000000004, 42.30000000000001, 45.5, -50.00000000000044, -50.00000000000044, 46.5, 45.7, -50.00000000000044, 30.099999999999987, -50.00000000000044, 45.3, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044, 11.29999999999972, -50.00000000000044, -50.00000000000044, 44.5, 18.699999999999825, -50.00000000000044, 35.500000000000036, 45.7, 45.7, 43.7, -50.00000000000044, 36.30000000000003, 8.299999999999677, 46.3, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 12.69999999999974, 39.70000000000002, -50.00000000000044, 45.5, 38.10000000000002, 38.700000000000024, 39.90000000000002, -50.00000000000044, 41.500000000000014, 34.70000000000004, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, 30.29999999999999, -50.00000000000044], "episode_lengths": [48, 500, 94, 500, 300, 238, 500, 36, 188, 38, 222, 500, 500, 318, 500, 500, 500, 48, 80, 46, 62, 312, 500, 478, 38, 156, 500, 128, 36, 500, 500, 30, 300, 62, 500, 38, 94, 54, 38, 54, 500, 500, 500, 500, 500, 58, 210, 56, 38, 354, 32, 164, 78, 46, 500, 500, 36, 44, 500, 200, 500, 48, 500, 92, 500, 500, 388, 500, 500, 56, 314, 500, 146, 44, 44, 64, 500, 138, 418, 38, 500, 500, 70, 500, 374, 104, 500, 46, 120, 114, 102, 500, 86, 154, 500, 500, 28, 500, 198, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40293900626358675, "mean_inference_ms": 1.2897508761637324, "mean_action_processing_ms": 0.1493861752399907, "mean_env_wait_ms": 0.08974207702944734, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024003982543945312, "StateBufferConnector_ms": 0.0029952526092529297, "ViewRequirementAgentConnector_ms": 0.1427919864654541}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000, "num_env_steps_sampled": 1296000, "num_env_steps_trained": 1296000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5115.573621701437, "num_env_steps_trained_throughput_per_sec": 5115.573621701437, "timesteps_total": 1296000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1296000, "timers": {"training_iteration_time_ms": 2399.476, "sample_time_ms": 2130.923, "load_time_ms": 11.952, "load_throughput": 1003992.46, "learn_time_ms": 243.501, "learn_throughput": 49281.18, "synch_weights_time_ms": 11.005}, "counters": {"num_env_steps_sampled": 1296000, "num_env_steps_trained": 1296000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "done": false, "episodes_total": 4923, "training_iteration": 108, "trial_id": "9f288_00019", "date": "2023-10-25_17-10-44", "timestamp": 1698250244, "time_this_iter_s": 2.350684881210327, "time_total_s": 248.7463915348053, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 248.7463915348053, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 64.13333333333333, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.162975822039157e-34, "cur_lr": 0.0003, "total_loss": 6.8256634394327795, "policy_loss": -0.0012003488838672638, "vf_loss": 6.826919492085775, "vf_explained_var": -1.1285146077473958e-06, "kl": 0.0016489682111568982, "entropy": 0.5570267637570699, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1628.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1308000, "num_env_steps_trained": 1308000, "num_agent_steps_sampled": 1308000, "num_agent_steps_trained": 1308000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.067999999999828, "episode_len_mean": 259.96, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.30000000000001, 45.5, -50.00000000000044, -50.00000000000044, 46.5, 45.7, -50.00000000000044, 30.099999999999987, -50.00000000000044, 45.3, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044, 11.29999999999972, -50.00000000000044, -50.00000000000044, 44.5, 18.699999999999825, -50.00000000000044, 35.500000000000036, 45.7, 45.7, 43.7, -50.00000000000044, 36.30000000000003, 8.299999999999677, 46.3, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 12.69999999999974, 39.70000000000002, -50.00000000000044, 45.5, 38.10000000000002, 38.700000000000024, 39.90000000000002, -50.00000000000044, 41.500000000000014, 34.70000000000004, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, 30.29999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 31.900000000000013, 46.699999999999996, 35.500000000000036, -50.00000000000044, 11.699999999999726, 47.3, 40.90000000000002, 43.50000000000001, -50.00000000000044, 43.50000000000001, 47.3, -50.00000000000044, 46.9, 34.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 20.099999999999845, -50.00000000000044, 39.50000000000002, 38.50000000000003, 13.299999999999748, 45.9, -50.00000000000044, 41.70000000000002, 44.10000000000001, 41.30000000000001, 41.70000000000002, 45.3, -50.00000000000044, 39.70000000000002, 46.9, -50.00000000000044, 36.30000000000003, 39.90000000000002, 27.299999999999947, 36.70000000000003, -50.00000000000044, 22.099999999999874, -50.00000000000044, 41.70000000000002, 32.50000000000002, 43.900000000000006, 44.5, -50.00000000000044, 26.69999999999994, 35.70000000000003, 42.70000000000001, -50.00000000000044], "episode_lengths": [78, 46, 500, 500, 36, 44, 500, 200, 500, 48, 500, 92, 500, 500, 388, 500, 500, 56, 314, 500, 146, 44, 44, 64, 500, 138, 418, 38, 500, 500, 70, 500, 374, 104, 500, 46, 120, 114, 102, 500, 86, 154, 500, 500, 28, 500, 198, 500, 500, 500, 44, 182, 34, 146, 500, 384, 28, 92, 66, 500, 66, 28, 500, 32, 160, 500, 500, 500, 300, 500, 106, 116, 368, 42, 500, 84, 60, 88, 84, 48, 500, 104, 32, 500, 138, 102, 228, 134, 500, 280, 500, 84, 176, 62, 56, 500, 234, 144, 74, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4030298074610573, "mean_inference_ms": 1.2898326119119665, "mean_action_processing_ms": 0.14922049823689032, "mean_env_wait_ms": 0.08994521688626084, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023004770278930664, "StateBufferConnector_ms": 0.009999275207519531, "ViewRequirementAgentConnector_ms": 0.14278721809387207}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.067999999999828, "episode_len_mean": 259.96, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.30000000000001, 45.5, -50.00000000000044, -50.00000000000044, 46.5, 45.7, -50.00000000000044, 30.099999999999987, -50.00000000000044, 45.3, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044, 11.29999999999972, -50.00000000000044, -50.00000000000044, 44.5, 18.699999999999825, -50.00000000000044, 35.500000000000036, 45.7, 45.7, 43.7, -50.00000000000044, 36.30000000000003, 8.299999999999677, 46.3, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 12.69999999999974, 39.70000000000002, -50.00000000000044, 45.5, 38.10000000000002, 38.700000000000024, 39.90000000000002, -50.00000000000044, 41.500000000000014, 34.70000000000004, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, 30.29999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 31.900000000000013, 46.699999999999996, 35.500000000000036, -50.00000000000044, 11.699999999999726, 47.3, 40.90000000000002, 43.50000000000001, -50.00000000000044, 43.50000000000001, 47.3, -50.00000000000044, 46.9, 34.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 20.099999999999845, -50.00000000000044, 39.50000000000002, 38.50000000000003, 13.299999999999748, 45.9, -50.00000000000044, 41.70000000000002, 44.10000000000001, 41.30000000000001, 41.70000000000002, 45.3, -50.00000000000044, 39.70000000000002, 46.9, -50.00000000000044, 36.30000000000003, 39.90000000000002, 27.299999999999947, 36.70000000000003, -50.00000000000044, 22.099999999999874, -50.00000000000044, 41.70000000000002, 32.50000000000002, 43.900000000000006, 44.5, -50.00000000000044, 26.69999999999994, 35.70000000000003, 42.70000000000001, -50.00000000000044], "episode_lengths": [78, 46, 500, 500, 36, 44, 500, 200, 500, 48, 500, 92, 500, 500, 388, 500, 500, 56, 314, 500, 146, 44, 44, 64, 500, 138, 418, 38, 500, 500, 70, 500, 374, 104, 500, 46, 120, 114, 102, 500, 86, 154, 500, 500, 28, 500, 198, 500, 500, 500, 44, 182, 34, 146, 500, 384, 28, 92, 66, 500, 66, 28, 500, 32, 160, 500, 500, 500, 300, 500, 106, 116, 368, 42, 500, 84, 60, 88, 84, 48, 500, 104, 32, 500, 138, 102, 228, 134, 500, 280, 500, 84, 176, 62, 56, 500, 234, 144, 74, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4030298074610573, "mean_inference_ms": 1.2898326119119665, "mean_action_processing_ms": 0.14922049823689032, "mean_env_wait_ms": 0.08994521688626084, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023004770278930664, "StateBufferConnector_ms": 0.009999275207519531, "ViewRequirementAgentConnector_ms": 0.14278721809387207}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1308000, "num_agent_steps_trained": 1308000, "num_env_steps_sampled": 1308000, "num_env_steps_trained": 1308000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5027.893054132742, "num_env_steps_trained_throughput_per_sec": 5027.893054132742, "timesteps_total": 1308000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1308000, "timers": {"training_iteration_time_ms": 2397.653, "sample_time_ms": 2129.623, "load_time_ms": 11.949, "load_throughput": 1004238.855, "learn_time_ms": 242.94, "learn_throughput": 49394.898, "synch_weights_time_ms": 10.945}, "counters": {"num_env_steps_sampled": 1308000, "num_env_steps_trained": 1308000, "num_agent_steps_sampled": 1308000, "num_agent_steps_trained": 1308000}, "done": false, "episodes_total": 4975, "training_iteration": 109, "trial_id": "9f288_00019", "date": "2023-10-25_17-10-46", "timestamp": 1698250246, "time_this_iter_s": 2.3916804790496826, "time_total_s": 251.13807201385498, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 251.13807201385498, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 65.25, "ram_util_percent": 27.325000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.0814879110195784e-34, "cur_lr": 0.0003, "total_loss": 6.611270078023275, "policy_loss": -0.0003205208463138357, "vf_loss": 6.611642074584961, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0005454088844468667, "entropy": 0.5167787750562032, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1643.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1320000, "num_env_steps_trained": 1320000, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.1429999999998195, "episode_len_mean": 264.2, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 47.3, -50.00000000000044, 30.29999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 31.900000000000013, 46.699999999999996, 35.500000000000036, -50.00000000000044, 11.699999999999726, 47.3, 40.90000000000002, 43.50000000000001, -50.00000000000044, 43.50000000000001, 47.3, -50.00000000000044, 46.9, 34.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 20.099999999999845, -50.00000000000044, 39.50000000000002, 38.50000000000003, 13.299999999999748, 45.9, -50.00000000000044, 41.70000000000002, 44.10000000000001, 41.30000000000001, 41.70000000000002, 45.3, -50.00000000000044, 39.70000000000002, 46.9, -50.00000000000044, 36.30000000000003, 39.90000000000002, 27.299999999999947, 36.70000000000003, -50.00000000000044, 22.099999999999874, -50.00000000000044, 41.70000000000002, 32.50000000000002, 43.900000000000006, 44.5, -50.00000000000044, 26.69999999999994, 35.70000000000003, 42.70000000000001, -50.00000000000044, 40.30000000000002, -50.00000000000044, 27.899999999999956, -50.00000000000044, 40.70000000000002, 41.500000000000014, 45.7, 45.3, 16.8999999999998, -50.00000000000044, -50.00000000000044, 22.099999999999874, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 40.30000000000002, -50.00000000000044, 45.9, 43.10000000000001, 42.30000000000001, 44.7, 3.699999999999612, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 14.899999999999771, 37.50000000000003, -50.00000000000044, -50.00000000000044, 42.70000000000001, 45.3, -50.00000000000044, 44.300000000000004, 43.50000000000001, 42.500000000000014, 17.499999999999808, -50.00000000000044], "episode_lengths": [500, 28, 500, 198, 500, 500, 500, 44, 182, 34, 146, 500, 384, 28, 92, 66, 500, 66, 28, 500, 32, 160, 500, 500, 500, 300, 500, 106, 116, 368, 42, 500, 84, 60, 88, 84, 48, 500, 104, 32, 500, 138, 102, 228, 134, 500, 280, 500, 84, 176, 62, 56, 500, 234, 144, 74, 500, 98, 500, 222, 500, 94, 86, 44, 48, 332, 500, 500, 280, 500, 500, 500, 68, 98, 500, 42, 70, 78, 54, 464, 46, 500, 500, 500, 500, 500, 500, 38, 352, 126, 500, 500, 74, 48, 500, 58, 66, 76, 326, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4031112904450933, "mean_inference_ms": 1.2895987072114763, "mean_action_processing_ms": 0.14952096739341467, "mean_env_wait_ms": 0.08993371405892976, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024010896682739258, "StateBufferConnector_ms": 0.012007474899291992, "ViewRequirementAgentConnector_ms": 0.15999627113342285}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.1429999999998195, "episode_len_mean": 264.2, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 47.3, -50.00000000000044, 30.29999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 31.900000000000013, 46.699999999999996, 35.500000000000036, -50.00000000000044, 11.699999999999726, 47.3, 40.90000000000002, 43.50000000000001, -50.00000000000044, 43.50000000000001, 47.3, -50.00000000000044, 46.9, 34.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 20.099999999999845, -50.00000000000044, 39.50000000000002, 38.50000000000003, 13.299999999999748, 45.9, -50.00000000000044, 41.70000000000002, 44.10000000000001, 41.30000000000001, 41.70000000000002, 45.3, -50.00000000000044, 39.70000000000002, 46.9, -50.00000000000044, 36.30000000000003, 39.90000000000002, 27.299999999999947, 36.70000000000003, -50.00000000000044, 22.099999999999874, -50.00000000000044, 41.70000000000002, 32.50000000000002, 43.900000000000006, 44.5, -50.00000000000044, 26.69999999999994, 35.70000000000003, 42.70000000000001, -50.00000000000044, 40.30000000000002, -50.00000000000044, 27.899999999999956, -50.00000000000044, 40.70000000000002, 41.500000000000014, 45.7, 45.3, 16.8999999999998, -50.00000000000044, -50.00000000000044, 22.099999999999874, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 40.30000000000002, -50.00000000000044, 45.9, 43.10000000000001, 42.30000000000001, 44.7, 3.699999999999612, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 14.899999999999771, 37.50000000000003, -50.00000000000044, -50.00000000000044, 42.70000000000001, 45.3, -50.00000000000044, 44.300000000000004, 43.50000000000001, 42.500000000000014, 17.499999999999808, -50.00000000000044], "episode_lengths": [500, 28, 500, 198, 500, 500, 500, 44, 182, 34, 146, 500, 384, 28, 92, 66, 500, 66, 28, 500, 32, 160, 500, 500, 500, 300, 500, 106, 116, 368, 42, 500, 84, 60, 88, 84, 48, 500, 104, 32, 500, 138, 102, 228, 134, 500, 280, 500, 84, 176, 62, 56, 500, 234, 144, 74, 500, 98, 500, 222, 500, 94, 86, 44, 48, 332, 500, 500, 280, 500, 500, 500, 68, 98, 500, 42, 70, 78, 54, 464, 46, 500, 500, 500, 500, 500, 500, 38, 352, 126, 500, 500, 74, 48, 500, 58, 66, 76, 326, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4031112904450933, "mean_inference_ms": 1.2895987072114763, "mean_action_processing_ms": 0.14952096739341467, "mean_env_wait_ms": 0.08993371405892976, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024010896682739258, "StateBufferConnector_ms": 0.012007474899291992, "ViewRequirementAgentConnector_ms": 0.15999627113342285}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000, "num_env_steps_sampled": 1320000, "num_env_steps_trained": 1320000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5521.763571376852, "num_env_steps_trained_throughput_per_sec": 5521.763571376852, "timesteps_total": 1320000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1320000, "timers": {"training_iteration_time_ms": 2362.07, "sample_time_ms": 2107.638, "load_time_ms": 11.24, "load_throughput": 1067621.93, "learn_time_ms": 230.293, "learn_throughput": 52107.422, "synch_weights_time_ms": 10.602}, "counters": {"num_env_steps_sampled": 1320000, "num_env_steps_trained": 1320000, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000}, "done": false, "episodes_total": 5018, "training_iteration": 110, "trial_id": "9f288_00019", "date": "2023-10-25_17-10-48", "timestamp": 1698250248, "time_this_iter_s": 2.178215980529785, "time_total_s": 253.31628799438477, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 253.31628799438477, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 63.53333333333334, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.5407439555097892e-34, "cur_lr": 0.0003, "total_loss": 6.736516348520914, "policy_loss": -5.198592940966288e-05, "vf_loss": 6.736619027455648, "vf_explained_var": -1.223882039388021e-06, "kl": 0.00036548386962920176, "entropy": 0.5075831870237987, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1658.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1332000, "num_env_steps_trained": 1332000, "num_agent_steps_sampled": 1332000, "num_agent_steps_trained": 1332000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.17200000000021098, "episode_len_mean": 292.3, "episode_media": {}, "episodes_this_iter": 33, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.10000000000001, 41.30000000000001, 41.70000000000002, 45.3, -50.00000000000044, 39.70000000000002, 46.9, -50.00000000000044, 36.30000000000003, 39.90000000000002, 27.299999999999947, 36.70000000000003, -50.00000000000044, 22.099999999999874, -50.00000000000044, 41.70000000000002, 32.50000000000002, 43.900000000000006, 44.5, -50.00000000000044, 26.69999999999994, 35.70000000000003, 42.70000000000001, -50.00000000000044, 40.30000000000002, -50.00000000000044, 27.899999999999956, -50.00000000000044, 40.70000000000002, 41.500000000000014, 45.7, 45.3, 16.8999999999998, -50.00000000000044, -50.00000000000044, 22.099999999999874, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 40.30000000000002, -50.00000000000044, 45.9, 43.10000000000001, 42.30000000000001, 44.7, 3.699999999999612, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 14.899999999999771, 37.50000000000003, -50.00000000000044, -50.00000000000044, 42.70000000000001, 45.3, -50.00000000000044, 44.300000000000004, 43.50000000000001, 42.500000000000014, 17.499999999999808, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 41.100000000000016, 0.8999999999995723, -50.00000000000044, 46.9, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.300000000000004, 34.900000000000034, 21.299999999999862, 1.4999999999995808, 39.90000000000002, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 24.299999999999905, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 0.09999999999956088, 45.7, -50.00000000000044], "episode_lengths": [60, 88, 84, 48, 500, 104, 32, 500, 138, 102, 228, 134, 500, 280, 500, 84, 176, 62, 56, 500, 234, 144, 74, 500, 98, 500, 222, 500, 94, 86, 44, 48, 332, 500, 500, 280, 500, 500, 500, 68, 98, 500, 42, 70, 78, 54, 464, 46, 500, 500, 500, 500, 500, 500, 38, 352, 126, 500, 500, 74, 48, 500, 58, 66, 76, 326, 500, 500, 60, 500, 500, 44, 500, 500, 90, 492, 500, 32, 38, 500, 500, 500, 500, 188, 152, 288, 486, 102, 500, 500, 40, 500, 258, 500, 500, 500, 500, 500, 44, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4028352886408715, "mean_inference_ms": 1.2898971904910521, "mean_action_processing_ms": 0.149573987245069, "mean_env_wait_ms": 0.08988074586449953, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024006128311157227, "StateBufferConnector_ms": 0.00900578498840332, "ViewRequirementAgentConnector_ms": 0.1689925193786621}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.17200000000021098, "episode_len_mean": 292.3, "episodes_this_iter": 33, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.10000000000001, 41.30000000000001, 41.70000000000002, 45.3, -50.00000000000044, 39.70000000000002, 46.9, -50.00000000000044, 36.30000000000003, 39.90000000000002, 27.299999999999947, 36.70000000000003, -50.00000000000044, 22.099999999999874, -50.00000000000044, 41.70000000000002, 32.50000000000002, 43.900000000000006, 44.5, -50.00000000000044, 26.69999999999994, 35.70000000000003, 42.70000000000001, -50.00000000000044, 40.30000000000002, -50.00000000000044, 27.899999999999956, -50.00000000000044, 40.70000000000002, 41.500000000000014, 45.7, 45.3, 16.8999999999998, -50.00000000000044, -50.00000000000044, 22.099999999999874, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 40.30000000000002, -50.00000000000044, 45.9, 43.10000000000001, 42.30000000000001, 44.7, 3.699999999999612, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 14.899999999999771, 37.50000000000003, -50.00000000000044, -50.00000000000044, 42.70000000000001, 45.3, -50.00000000000044, 44.300000000000004, 43.50000000000001, 42.500000000000014, 17.499999999999808, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 41.100000000000016, 0.8999999999995723, -50.00000000000044, 46.9, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.300000000000004, 34.900000000000034, 21.299999999999862, 1.4999999999995808, 39.90000000000002, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 24.299999999999905, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 0.09999999999956088, 45.7, -50.00000000000044], "episode_lengths": [60, 88, 84, 48, 500, 104, 32, 500, 138, 102, 228, 134, 500, 280, 500, 84, 176, 62, 56, 500, 234, 144, 74, 500, 98, 500, 222, 500, 94, 86, 44, 48, 332, 500, 500, 280, 500, 500, 500, 68, 98, 500, 42, 70, 78, 54, 464, 46, 500, 500, 500, 500, 500, 500, 38, 352, 126, 500, 500, 74, 48, 500, 58, 66, 76, 326, 500, 500, 60, 500, 500, 44, 500, 500, 90, 492, 500, 32, 38, 500, 500, 500, 500, 188, 152, 288, 486, 102, 500, 500, 40, 500, 258, 500, 500, 500, 500, 500, 44, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4028352886408715, "mean_inference_ms": 1.2898971904910521, "mean_action_processing_ms": 0.149573987245069, "mean_env_wait_ms": 0.08988074586449953, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024006128311157227, "StateBufferConnector_ms": 0.00900578498840332, "ViewRequirementAgentConnector_ms": 0.1689925193786621}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1332000, "num_agent_steps_trained": 1332000, "num_env_steps_sampled": 1332000, "num_env_steps_trained": 1332000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4918.210963332923, "num_env_steps_trained_throughput_per_sec": 4918.210963332923, "timesteps_total": 1332000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1332000, "timers": {"training_iteration_time_ms": 2362.849, "sample_time_ms": 2110.493, "load_time_ms": 11.224, "load_throughput": 1069182.261, "learn_time_ms": 228.345, "learn_throughput": 52552.089, "synch_weights_time_ms": 10.491}, "counters": {"num_env_steps_sampled": 1332000, "num_env_steps_trained": 1332000, "num_agent_steps_sampled": 1332000, "num_agent_steps_trained": 1332000}, "done": false, "episodes_total": 5051, "training_iteration": 111, "trial_id": "9f288_00019", "date": "2023-10-25_17-10-51", "timestamp": 1698250251, "time_this_iter_s": 2.4446728229522705, "time_total_s": 255.76096081733704, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 255.76096081733704, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 60.43333333333334, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.703719777548946e-35, "cur_lr": 0.0003, "total_loss": 6.8523584047953285, "policy_loss": -0.0002594818671544393, "vf_loss": 6.852667331695557, "vf_explained_var": -9.139378865559896e-07, "kl": 0.00033149575837872664, "entropy": 0.4955457389354706, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1673.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1344000, "num_env_steps_trained": 1344000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.637999999999796, "episode_len_mean": 274.2, "episode_media": {}, "episodes_this_iter": 55, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.899999999999771, 37.50000000000003, -50.00000000000044, -50.00000000000044, 42.70000000000001, 45.3, -50.00000000000044, 44.300000000000004, 43.50000000000001, 42.500000000000014, 17.499999999999808, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 41.100000000000016, 0.8999999999995723, -50.00000000000044, 46.9, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.300000000000004, 34.900000000000034, 21.299999999999862, 1.4999999999995808, 39.90000000000002, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 24.299999999999905, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 0.09999999999956088, 45.7, -50.00000000000044, -50.00000000000044, 44.7, 18.099999999999817, -50.00000000000044, -50.00000000000044, 42.900000000000006, 40.500000000000014, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 44.10000000000001, 40.10000000000002, 44.900000000000006, 34.900000000000034, 45.7, 47.1, 45.3, -50.00000000000044, 44.5, -50.00000000000044, 43.7, 44.300000000000004, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, -50.00000000000044, 45.3, 44.5, 44.7, 47.1, 33.10000000000003, -50.00000000000044, 46.5, 45.9, -50.00000000000044, 44.900000000000006, -50.00000000000044, 43.50000000000001, 46.3, -50.00000000000044, -50.00000000000044, 44.300000000000004, 45.5, -50.00000000000044, 45.7, 43.900000000000006, 46.9, 43.900000000000006, 45.7, 42.900000000000006], "episode_lengths": [352, 126, 500, 500, 74, 48, 500, 58, 66, 76, 326, 500, 500, 60, 500, 500, 44, 500, 500, 90, 492, 500, 32, 38, 500, 500, 500, 500, 188, 152, 288, 486, 102, 500, 500, 40, 500, 258, 500, 500, 500, 500, 500, 44, 500, 500, 54, 320, 500, 500, 72, 96, 500, 70, 500, 500, 60, 100, 52, 152, 44, 30, 48, 500, 56, 500, 64, 58, 500, 50, 500, 500, 500, 500, 142, 500, 48, 56, 54, 30, 170, 500, 36, 42, 500, 52, 500, 66, 38, 500, 500, 58, 46, 500, 44, 62, 32, 62, 44, 72]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40265443852991367, "mean_inference_ms": 1.2902047875434814, "mean_action_processing_ms": 0.1492595988570181, "mean_env_wait_ms": 0.08986724196263154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021999359130859375, "StateBufferConnector_ms": 0.011002540588378906, "ViewRequirementAgentConnector_ms": 0.1299912929534912}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.637999999999796, "episode_len_mean": 274.2, "episodes_this_iter": 55, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.899999999999771, 37.50000000000003, -50.00000000000044, -50.00000000000044, 42.70000000000001, 45.3, -50.00000000000044, 44.300000000000004, 43.50000000000001, 42.500000000000014, 17.499999999999808, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 41.100000000000016, 0.8999999999995723, -50.00000000000044, 46.9, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.300000000000004, 34.900000000000034, 21.299999999999862, 1.4999999999995808, 39.90000000000002, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 24.299999999999905, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 0.09999999999956088, 45.7, -50.00000000000044, -50.00000000000044, 44.7, 18.099999999999817, -50.00000000000044, -50.00000000000044, 42.900000000000006, 40.500000000000014, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 44.10000000000001, 40.10000000000002, 44.900000000000006, 34.900000000000034, 45.7, 47.1, 45.3, -50.00000000000044, 44.5, -50.00000000000044, 43.7, 44.300000000000004, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, -50.00000000000044, 45.3, 44.5, 44.7, 47.1, 33.10000000000003, -50.00000000000044, 46.5, 45.9, -50.00000000000044, 44.900000000000006, -50.00000000000044, 43.50000000000001, 46.3, -50.00000000000044, -50.00000000000044, 44.300000000000004, 45.5, -50.00000000000044, 45.7, 43.900000000000006, 46.9, 43.900000000000006, 45.7, 42.900000000000006], "episode_lengths": [352, 126, 500, 500, 74, 48, 500, 58, 66, 76, 326, 500, 500, 60, 500, 500, 44, 500, 500, 90, 492, 500, 32, 38, 500, 500, 500, 500, 188, 152, 288, 486, 102, 500, 500, 40, 500, 258, 500, 500, 500, 500, 500, 44, 500, 500, 54, 320, 500, 500, 72, 96, 500, 70, 500, 500, 60, 100, 52, 152, 44, 30, 48, 500, 56, 500, 64, 58, 500, 50, 500, 500, 500, 500, 142, 500, 48, 56, 54, 30, 170, 500, 36, 42, 500, 52, 500, 66, 38, 500, 500, 58, 46, 500, 44, 62, 32, 62, 44, 72]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40265443852991367, "mean_inference_ms": 1.2902047875434814, "mean_action_processing_ms": 0.1492595988570181, "mean_env_wait_ms": 0.08986724196263154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021999359130859375, "StateBufferConnector_ms": 0.011002540588378906, "ViewRequirementAgentConnector_ms": 0.1299912929534912}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000, "num_env_steps_sampled": 1344000, "num_env_steps_trained": 1344000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5581.807341793714, "num_env_steps_trained_throughput_per_sec": 5581.807341793714, "timesteps_total": 1344000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1344000, "timers": {"training_iteration_time_ms": 2338.84, "sample_time_ms": 2090.882, "load_time_ms": 10.719, "load_throughput": 1119545.879, "learn_time_ms": 224.627, "learn_throughput": 53421.868, "synch_weights_time_ms": 10.416}, "counters": {"num_env_steps_sampled": 1344000, "num_env_steps_trained": 1344000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "done": false, "episodes_total": 5106, "training_iteration": 112, "trial_id": "9f288_00019", "date": "2023-10-25_17-10-53", "timestamp": 1698250253, "time_this_iter_s": 2.1548380851745605, "time_total_s": 257.9157989025116, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 257.9157989025116, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 53.56666666666666, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.851859888774473e-35, "cur_lr": 0.0003, "total_loss": 6.418111038208008, "policy_loss": -0.0006702125072479248, "vf_loss": 6.418826643625895, "vf_explained_var": -8.50359598795573e-07, "kl": 0.0009408297025477926, "entropy": 0.452394829193751, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1688.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1356000, "num_env_steps_trained": 1356000, "num_agent_steps_sampled": 1356000, "num_agent_steps_trained": 1356000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.693999999999836, "episode_len_mean": 233.7, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.7, 18.099999999999817, -50.00000000000044, -50.00000000000044, 42.900000000000006, 40.500000000000014, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 44.10000000000001, 40.10000000000002, 44.900000000000006, 34.900000000000034, 45.7, 47.1, 45.3, -50.00000000000044, 44.5, -50.00000000000044, 43.7, 44.300000000000004, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, -50.00000000000044, 45.3, 44.5, 44.7, 47.1, 33.10000000000003, -50.00000000000044, 46.5, 45.9, -50.00000000000044, 44.900000000000006, -50.00000000000044, 43.50000000000001, 46.3, -50.00000000000044, -50.00000000000044, 44.300000000000004, 45.5, -50.00000000000044, 45.7, 43.900000000000006, 46.9, 43.900000000000006, 45.7, 42.900000000000006, -50.00000000000044, 45.7, -50.00000000000044, 20.49999999999985, 47.3, 44.7, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, 41.70000000000002, 13.899999999999757, -50.00000000000044, 42.500000000000014, 42.500000000000014, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 43.10000000000001, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 46.099999999999994, 40.10000000000002, 41.30000000000001, 46.099999999999994, 43.30000000000001, -50.00000000000044, -50.00000000000044, 45.7, 44.900000000000006, -50.00000000000044, 30.9, 43.50000000000001, 37.70000000000003, 42.500000000000014, 31.1, 19.09999999999983, -50.00000000000044, 45.1], "episode_lengths": [54, 320, 500, 500, 72, 96, 500, 70, 500, 500, 60, 100, 52, 152, 44, 30, 48, 500, 56, 500, 64, 58, 500, 50, 500, 500, 500, 500, 142, 500, 48, 56, 54, 30, 170, 500, 36, 42, 500, 52, 500, 66, 38, 500, 500, 58, 46, 500, 44, 62, 32, 62, 44, 72, 500, 44, 500, 296, 28, 54, 68, 500, 500, 500, 500, 82, 84, 362, 500, 76, 76, 82, 500, 500, 500, 48, 70, 44, 500, 500, 500, 36, 40, 100, 88, 40, 68, 500, 500, 44, 52, 500, 192, 66, 124, 76, 190, 310, 500, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4023715799253559, "mean_inference_ms": 1.289449115267725, "mean_action_processing_ms": 0.14916659279268416, "mean_env_wait_ms": 0.08976670902438996, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02400064468383789, "StateBufferConnector_ms": 0.007018089294433594, "ViewRequirementAgentConnector_ms": 0.09719014167785645}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.693999999999836, "episode_len_mean": 233.7, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.7, 18.099999999999817, -50.00000000000044, -50.00000000000044, 42.900000000000006, 40.500000000000014, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 44.10000000000001, 40.10000000000002, 44.900000000000006, 34.900000000000034, 45.7, 47.1, 45.3, -50.00000000000044, 44.5, -50.00000000000044, 43.7, 44.300000000000004, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, -50.00000000000044, 45.3, 44.5, 44.7, 47.1, 33.10000000000003, -50.00000000000044, 46.5, 45.9, -50.00000000000044, 44.900000000000006, -50.00000000000044, 43.50000000000001, 46.3, -50.00000000000044, -50.00000000000044, 44.300000000000004, 45.5, -50.00000000000044, 45.7, 43.900000000000006, 46.9, 43.900000000000006, 45.7, 42.900000000000006, -50.00000000000044, 45.7, -50.00000000000044, 20.49999999999985, 47.3, 44.7, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, 41.70000000000002, 13.899999999999757, -50.00000000000044, 42.500000000000014, 42.500000000000014, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 43.10000000000001, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 46.099999999999994, 40.10000000000002, 41.30000000000001, 46.099999999999994, 43.30000000000001, -50.00000000000044, -50.00000000000044, 45.7, 44.900000000000006, -50.00000000000044, 30.9, 43.50000000000001, 37.70000000000003, 42.500000000000014, 31.1, 19.09999999999983, -50.00000000000044, 45.1], "episode_lengths": [54, 320, 500, 500, 72, 96, 500, 70, 500, 500, 60, 100, 52, 152, 44, 30, 48, 500, 56, 500, 64, 58, 500, 50, 500, 500, 500, 500, 142, 500, 48, 56, 54, 30, 170, 500, 36, 42, 500, 52, 500, 66, 38, 500, 500, 58, 46, 500, 44, 62, 32, 62, 44, 72, 500, 44, 500, 296, 28, 54, 68, 500, 500, 500, 500, 82, 84, 362, 500, 76, 76, 82, 500, 500, 500, 48, 70, 44, 500, 500, 500, 36, 40, 100, 88, 40, 68, 500, 500, 44, 52, 500, 192, 66, 124, 76, 190, 310, 500, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4023715799253559, "mean_inference_ms": 1.289449115267725, "mean_action_processing_ms": 0.14916659279268416, "mean_env_wait_ms": 0.08976670902438996, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02400064468383789, "StateBufferConnector_ms": 0.007018089294433594, "ViewRequirementAgentConnector_ms": 0.09719014167785645}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1356000, "num_agent_steps_trained": 1356000, "num_env_steps_sampled": 1356000, "num_env_steps_trained": 1356000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5465.253775250454, "num_env_steps_trained_throughput_per_sec": 5465.253775250454, "timesteps_total": 1356000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1356000, "timers": {"training_iteration_time_ms": 2318.18, "sample_time_ms": 2072.846, "load_time_ms": 11.702, "load_throughput": 1025422.808, "learn_time_ms": 221.182, "learn_throughput": 54254.042, "synch_weights_time_ms": 10.253}, "counters": {"num_env_steps_sampled": 1356000, "num_env_steps_trained": 1356000, "num_agent_steps_sampled": 1356000, "num_agent_steps_trained": 1356000}, "done": false, "episodes_total": 5152, "training_iteration": 113, "trial_id": "9f288_00019", "date": "2023-10-25_17-10-55", "timestamp": 1698250255, "time_this_iter_s": 2.200437068939209, "time_total_s": 260.1162359714508, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 260.1162359714508, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 57.0, "ram_util_percent": 27.275}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.9259299443872365e-35, "cur_lr": 0.0003, "total_loss": 6.380773544311523, "policy_loss": -0.00029121761520703633, "vf_loss": 6.381115309397379, "vf_explained_var": -1.0569890340169271e-06, "kl": 0.00034389197845333304, "entropy": 0.5040813982486725, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1703.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1368000, "num_env_steps_trained": 1368000, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.037999999999828, "episode_len_mean": 250.26, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 44.300000000000004, 45.5, -50.00000000000044, 45.7, 43.900000000000006, 46.9, 43.900000000000006, 45.7, 42.900000000000006, -50.00000000000044, 45.7, -50.00000000000044, 20.49999999999985, 47.3, 44.7, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, 41.70000000000002, 13.899999999999757, -50.00000000000044, 42.500000000000014, 42.500000000000014, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 43.10000000000001, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 46.099999999999994, 40.10000000000002, 41.30000000000001, 46.099999999999994, 43.30000000000001, -50.00000000000044, -50.00000000000044, 45.7, 44.900000000000006, -50.00000000000044, 30.9, 43.50000000000001, 37.70000000000003, 42.500000000000014, 31.1, 19.09999999999983, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 42.70000000000001, 42.30000000000001, 44.300000000000004, 8.299999999999677, 13.499999999999751, 46.699999999999996, 46.099999999999994, 47.3, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 29.299999999999976, -50.00000000000044, 38.50000000000003, -50.00000000000044, 44.7, 36.900000000000034, -50.00000000000044, -50.00000000000044, 38.10000000000002, -50.00000000000044, 17.69999999999981, 35.900000000000034, -50.00000000000044, -50.00000000000044, 46.9, 36.70000000000003, 35.70000000000003, 43.10000000000001, 42.70000000000001, 44.7, -50.00000000000044, 38.700000000000024, 44.10000000000001, 28.09999999999996, 0.6999999999995694, -50.00000000000044], "episode_lengths": [500, 500, 58, 46, 500, 44, 62, 32, 62, 44, 72, 500, 44, 500, 296, 28, 54, 68, 500, 500, 500, 500, 82, 84, 362, 500, 76, 76, 82, 500, 500, 500, 48, 70, 44, 500, 500, 500, 36, 40, 100, 88, 40, 68, 500, 500, 44, 52, 500, 192, 66, 124, 76, 190, 310, 500, 50, 500, 500, 74, 78, 58, 418, 366, 34, 40, 28, 500, 80, 500, 500, 500, 48, 500, 208, 500, 116, 500, 54, 132, 500, 500, 120, 500, 324, 142, 500, 500, 32, 134, 144, 70, 74, 54, 500, 114, 60, 220, 494, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4024651317175178, "mean_inference_ms": 1.2887188956846072, "mean_action_processing_ms": 0.14902475488823044, "mean_env_wait_ms": 0.08992627992516793, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027004003524780273, "StateBufferConnector_ms": 0.005018472671508789, "ViewRequirementAgentConnector_ms": 0.10921049118041992}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.037999999999828, "episode_len_mean": 250.26, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 44.300000000000004, 45.5, -50.00000000000044, 45.7, 43.900000000000006, 46.9, 43.900000000000006, 45.7, 42.900000000000006, -50.00000000000044, 45.7, -50.00000000000044, 20.49999999999985, 47.3, 44.7, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, 41.70000000000002, 13.899999999999757, -50.00000000000044, 42.500000000000014, 42.500000000000014, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 43.10000000000001, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 46.099999999999994, 40.10000000000002, 41.30000000000001, 46.099999999999994, 43.30000000000001, -50.00000000000044, -50.00000000000044, 45.7, 44.900000000000006, -50.00000000000044, 30.9, 43.50000000000001, 37.70000000000003, 42.500000000000014, 31.1, 19.09999999999983, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 42.70000000000001, 42.30000000000001, 44.300000000000004, 8.299999999999677, 13.499999999999751, 46.699999999999996, 46.099999999999994, 47.3, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 29.299999999999976, -50.00000000000044, 38.50000000000003, -50.00000000000044, 44.7, 36.900000000000034, -50.00000000000044, -50.00000000000044, 38.10000000000002, -50.00000000000044, 17.69999999999981, 35.900000000000034, -50.00000000000044, -50.00000000000044, 46.9, 36.70000000000003, 35.70000000000003, 43.10000000000001, 42.70000000000001, 44.7, -50.00000000000044, 38.700000000000024, 44.10000000000001, 28.09999999999996, 0.6999999999995694, -50.00000000000044], "episode_lengths": [500, 500, 58, 46, 500, 44, 62, 32, 62, 44, 72, 500, 44, 500, 296, 28, 54, 68, 500, 500, 500, 500, 82, 84, 362, 500, 76, 76, 82, 500, 500, 500, 48, 70, 44, 500, 500, 500, 36, 40, 100, 88, 40, 68, 500, 500, 44, 52, 500, 192, 66, 124, 76, 190, 310, 500, 50, 500, 500, 74, 78, 58, 418, 366, 34, 40, 28, 500, 80, 500, 500, 500, 48, 500, 208, 500, 116, 500, 54, 132, 500, 500, 120, 500, 324, 142, 500, 500, 32, 134, 144, 70, 74, 54, 500, 114, 60, 220, 494, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4024651317175178, "mean_inference_ms": 1.2887188956846072, "mean_action_processing_ms": 0.14902475488823044, "mean_env_wait_ms": 0.08992627992516793, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027004003524780273, "StateBufferConnector_ms": 0.005018472671508789, "ViewRequirementAgentConnector_ms": 0.10921049118041992}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000, "num_env_steps_sampled": 1368000, "num_env_steps_trained": 1368000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4918.27199879925, "num_env_steps_trained_throughput_per_sec": 4918.27199879925, "timesteps_total": 1368000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1368000, "timers": {"training_iteration_time_ms": 2324.785, "sample_time_ms": 2087.91, "load_time_ms": 11.654, "load_throughput": 1029658.176, "learn_time_ms": 212.674, "learn_throughput": 56424.261, "synch_weights_time_ms": 10.351}, "counters": {"num_env_steps_sampled": 1368000, "num_env_steps_trained": 1368000, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000}, "done": false, "episodes_total": 5195, "training_iteration": 114, "trial_id": "9f288_00019", "date": "2023-10-25_17-10-58", "timestamp": 1698250258, "time_this_iter_s": 2.445876121520996, "time_total_s": 262.5621120929718, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 262.5621120929718, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 65.53333333333335, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.629649721936182e-36, "cur_lr": 0.0003, "total_loss": 6.969970448811849, "policy_loss": -0.0001321112116177877, "vf_loss": 6.970151964823405, "vf_explained_var": -8.106231689453125e-07, "kl": 0.0004221513372916282, "entropy": 0.4944715857505798, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1718.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1380000, "num_env_steps_trained": 1380000, "num_agent_steps_sampled": 1380000, "num_agent_steps_trained": 1380000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.3229999999998245, "episode_len_mean": 262.4, "episode_media": {}, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [30.9, 43.50000000000001, 37.70000000000003, 42.500000000000014, 31.1, 19.09999999999983, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 42.70000000000001, 42.30000000000001, 44.300000000000004, 8.299999999999677, 13.499999999999751, 46.699999999999996, 46.099999999999994, 47.3, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 29.299999999999976, -50.00000000000044, 38.50000000000003, -50.00000000000044, 44.7, 36.900000000000034, -50.00000000000044, -50.00000000000044, 38.10000000000002, -50.00000000000044, 17.69999999999981, 35.900000000000034, -50.00000000000044, -50.00000000000044, 46.9, 36.70000000000003, 35.70000000000003, 43.10000000000001, 42.70000000000001, 44.7, -50.00000000000044, 38.700000000000024, 44.10000000000001, 28.09999999999996, 0.6999999999995694, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.50000000000004, 45.5, 45.9, 38.50000000000003, -50.00000000000044, 32.90000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 44.900000000000006, 40.90000000000002, -50.00000000000044, 44.300000000000004, 34.30000000000004, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.500000000000036, 39.70000000000002, -50.00000000000044, -50.00000000000044, 45.3, 31.300000000000004, -50.00000000000044, 34.50000000000004, 23.699999999999896, 45.1, 41.100000000000016, -50.00000000000044, -50.00000000000044, 47.1, 45.9, -50.00000000000044, -50.00000000000044, 35.500000000000036, 46.099999999999994, -50.00000000000044, 46.699999999999996, 16.699999999999797, 44.900000000000006, 44.300000000000004, 30.29999999999999, 45.3], "episode_lengths": [192, 66, 124, 76, 190, 310, 500, 50, 500, 500, 74, 78, 58, 418, 366, 34, 40, 28, 500, 80, 500, 500, 500, 48, 500, 208, 500, 116, 500, 54, 132, 500, 500, 120, 500, 324, 142, 500, 500, 32, 134, 144, 70, 74, 54, 500, 114, 60, 220, 494, 500, 500, 500, 500, 156, 46, 42, 116, 500, 172, 500, 500, 500, 32, 52, 92, 500, 58, 158, 500, 44, 500, 500, 500, 166, 104, 500, 500, 48, 188, 500, 156, 264, 50, 90, 500, 500, 30, 42, 500, 500, 146, 40, 500, 34, 334, 52, 58, 198, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40239707202806213, "mean_inference_ms": 1.288361524743017, "mean_action_processing_ms": 0.14905552441150832, "mean_env_wait_ms": 0.089846532359173, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02699565887451172, "StateBufferConnector_ms": 0.004000186920166016, "ViewRequirementAgentConnector_ms": 0.13805866241455078}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.3229999999998245, "episode_len_mean": 262.4, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [30.9, 43.50000000000001, 37.70000000000003, 42.500000000000014, 31.1, 19.09999999999983, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 42.70000000000001, 42.30000000000001, 44.300000000000004, 8.299999999999677, 13.499999999999751, 46.699999999999996, 46.099999999999994, 47.3, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 29.299999999999976, -50.00000000000044, 38.50000000000003, -50.00000000000044, 44.7, 36.900000000000034, -50.00000000000044, -50.00000000000044, 38.10000000000002, -50.00000000000044, 17.69999999999981, 35.900000000000034, -50.00000000000044, -50.00000000000044, 46.9, 36.70000000000003, 35.70000000000003, 43.10000000000001, 42.70000000000001, 44.7, -50.00000000000044, 38.700000000000024, 44.10000000000001, 28.09999999999996, 0.6999999999995694, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.50000000000004, 45.5, 45.9, 38.50000000000003, -50.00000000000044, 32.90000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 44.900000000000006, 40.90000000000002, -50.00000000000044, 44.300000000000004, 34.30000000000004, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.500000000000036, 39.70000000000002, -50.00000000000044, -50.00000000000044, 45.3, 31.300000000000004, -50.00000000000044, 34.50000000000004, 23.699999999999896, 45.1, 41.100000000000016, -50.00000000000044, -50.00000000000044, 47.1, 45.9, -50.00000000000044, -50.00000000000044, 35.500000000000036, 46.099999999999994, -50.00000000000044, 46.699999999999996, 16.699999999999797, 44.900000000000006, 44.300000000000004, 30.29999999999999, 45.3], "episode_lengths": [192, 66, 124, 76, 190, 310, 500, 50, 500, 500, 74, 78, 58, 418, 366, 34, 40, 28, 500, 80, 500, 500, 500, 48, 500, 208, 500, 116, 500, 54, 132, 500, 500, 120, 500, 324, 142, 500, 500, 32, 134, 144, 70, 74, 54, 500, 114, 60, 220, 494, 500, 500, 500, 500, 156, 46, 42, 116, 500, 172, 500, 500, 500, 32, 52, 92, 500, 58, 158, 500, 44, 500, 500, 500, 166, 104, 500, 500, 48, 188, 500, 156, 264, 50, 90, 500, 500, 30, 42, 500, 500, 146, 40, 500, 34, 334, 52, 58, 198, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40239707202806213, "mean_inference_ms": 1.288361524743017, "mean_action_processing_ms": 0.14905552441150832, "mean_env_wait_ms": 0.089846532359173, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02699565887451172, "StateBufferConnector_ms": 0.004000186920166016, "ViewRequirementAgentConnector_ms": 0.13805866241455078}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1380000, "num_agent_steps_trained": 1380000, "num_env_steps_sampled": 1380000, "num_env_steps_trained": 1380000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4914.130792636133, "num_env_steps_trained_throughput_per_sec": 4914.130792636133, "timesteps_total": 1380000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1380000, "timers": {"training_iteration_time_ms": 2330.211, "sample_time_ms": 2086.343, "load_time_ms": 12.823, "load_throughput": 935854.299, "learn_time_ms": 218.687, "learn_throughput": 54872.902, "synch_weights_time_ms": 10.254}, "counters": {"num_env_steps_sampled": 1380000, "num_env_steps_trained": 1380000, "num_agent_steps_sampled": 1380000, "num_agent_steps_trained": 1380000}, "done": false, "episodes_total": 5244, "training_iteration": 115, "trial_id": "9f288_00019", "date": "2023-10-25_17-11-00", "timestamp": 1698250260, "time_this_iter_s": 2.4479329586029053, "time_total_s": 265.0100450515747, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 265.0100450515747, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 62.833333333333336, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.814824860968091e-36, "cur_lr": 0.0003, "total_loss": 6.417435963948567, "policy_loss": -0.00028204098343849183, "vf_loss": 6.41776491800944, "vf_explained_var": -1.152356465657552e-06, "kl": 0.0009884274638200926, "entropy": 0.46856969396273296, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1733.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1392000, "num_env_steps_trained": 1392000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.807999999999838, "episode_len_mean": 242.58, "episode_media": {}, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.50000000000004, 45.5, 45.9, 38.50000000000003, -50.00000000000044, 32.90000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 44.900000000000006, 40.90000000000002, -50.00000000000044, 44.300000000000004, 34.30000000000004, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.500000000000036, 39.70000000000002, -50.00000000000044, -50.00000000000044, 45.3, 31.300000000000004, -50.00000000000044, 34.50000000000004, 23.699999999999896, 45.1, 41.100000000000016, -50.00000000000044, -50.00000000000044, 47.1, 45.9, -50.00000000000044, -50.00000000000044, 35.500000000000036, 46.099999999999994, -50.00000000000044, 46.699999999999996, 16.699999999999797, 44.900000000000006, 44.300000000000004, 30.29999999999999, 45.3, 22.099999999999874, 46.5, 10.499999999999709, 45.1, 44.900000000000006, 46.5, 46.699999999999996, 47.5, 45.1, -50.00000000000044, -50.00000000000044, 25.29999999999992, -50.00000000000044, 46.5, 44.900000000000006, 34.50000000000004, 46.3, 28.499999999999964, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.09999999999983, 15.299999999999777, -50.00000000000044, 37.90000000000003, 46.099999999999994, -50.00000000000044, 22.699999999999882, 47.5, 46.3, -50.00000000000044, 39.70000000000002, 18.499999999999822, 42.30000000000001, 45.7, 47.1, 27.899999999999956, 44.300000000000004, 45.1, 45.5, -50.00000000000044, 46.9, -50.00000000000044, 43.7, 39.10000000000002, 40.90000000000002, -50.00000000000044, 42.70000000000001, 44.300000000000004, -50.00000000000044], "episode_lengths": [500, 500, 500, 500, 156, 46, 42, 116, 500, 172, 500, 500, 500, 32, 52, 92, 500, 58, 158, 500, 44, 500, 500, 500, 166, 104, 500, 500, 48, 188, 500, 156, 264, 50, 90, 500, 500, 30, 42, 500, 500, 146, 40, 500, 34, 334, 52, 58, 198, 48, 280, 36, 396, 50, 52, 36, 34, 26, 50, 500, 500, 248, 500, 36, 52, 156, 38, 216, 500, 500, 500, 310, 348, 500, 122, 40, 500, 274, 26, 38, 500, 104, 316, 78, 44, 30, 222, 58, 50, 46, 500, 32, 500, 64, 110, 92, 500, 74, 58, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40262057686232283, "mean_inference_ms": 1.289004613373315, "mean_action_processing_ms": 0.14891057954932843, "mean_env_wait_ms": 0.08986710073942777, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0249941349029541, "StateBufferConnector_ms": 0.004003286361694336, "ViewRequirementAgentConnector_ms": 0.15857815742492676}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.807999999999838, "episode_len_mean": 242.58, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.50000000000004, 45.5, 45.9, 38.50000000000003, -50.00000000000044, 32.90000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 44.900000000000006, 40.90000000000002, -50.00000000000044, 44.300000000000004, 34.30000000000004, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.500000000000036, 39.70000000000002, -50.00000000000044, -50.00000000000044, 45.3, 31.300000000000004, -50.00000000000044, 34.50000000000004, 23.699999999999896, 45.1, 41.100000000000016, -50.00000000000044, -50.00000000000044, 47.1, 45.9, -50.00000000000044, -50.00000000000044, 35.500000000000036, 46.099999999999994, -50.00000000000044, 46.699999999999996, 16.699999999999797, 44.900000000000006, 44.300000000000004, 30.29999999999999, 45.3, 22.099999999999874, 46.5, 10.499999999999709, 45.1, 44.900000000000006, 46.5, 46.699999999999996, 47.5, 45.1, -50.00000000000044, -50.00000000000044, 25.29999999999992, -50.00000000000044, 46.5, 44.900000000000006, 34.50000000000004, 46.3, 28.499999999999964, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.09999999999983, 15.299999999999777, -50.00000000000044, 37.90000000000003, 46.099999999999994, -50.00000000000044, 22.699999999999882, 47.5, 46.3, -50.00000000000044, 39.70000000000002, 18.499999999999822, 42.30000000000001, 45.7, 47.1, 27.899999999999956, 44.300000000000004, 45.1, 45.5, -50.00000000000044, 46.9, -50.00000000000044, 43.7, 39.10000000000002, 40.90000000000002, -50.00000000000044, 42.70000000000001, 44.300000000000004, -50.00000000000044], "episode_lengths": [500, 500, 500, 500, 156, 46, 42, 116, 500, 172, 500, 500, 500, 32, 52, 92, 500, 58, 158, 500, 44, 500, 500, 500, 166, 104, 500, 500, 48, 188, 500, 156, 264, 50, 90, 500, 500, 30, 42, 500, 500, 146, 40, 500, 34, 334, 52, 58, 198, 48, 280, 36, 396, 50, 52, 36, 34, 26, 50, 500, 500, 248, 500, 36, 52, 156, 38, 216, 500, 500, 500, 310, 348, 500, 122, 40, 500, 274, 26, 38, 500, 104, 316, 78, 44, 30, 222, 58, 50, 46, 500, 32, 500, 64, 110, 92, 500, 74, 58, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40262057686232283, "mean_inference_ms": 1.289004613373315, "mean_action_processing_ms": 0.14891057954932843, "mean_env_wait_ms": 0.08986710073942777, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0249941349029541, "StateBufferConnector_ms": 0.004003286361694336, "ViewRequirementAgentConnector_ms": 0.15857815742492676}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000, "num_env_steps_sampled": 1392000, "num_env_steps_trained": 1392000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5137.259549064836, "num_env_steps_trained_throughput_per_sec": 5137.259549064836, "timesteps_total": 1392000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1392000, "timers": {"training_iteration_time_ms": 2324.628, "sample_time_ms": 2083.613, "load_time_ms": 12.622, "load_throughput": 950695.914, "learn_time_ms": 216.1, "learn_throughput": 55529.731, "synch_weights_time_ms": 10.288}, "counters": {"num_env_steps_sampled": 1392000, "num_env_steps_trained": 1392000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "done": false, "episodes_total": 5294, "training_iteration": 116, "trial_id": "9f288_00019", "date": "2023-10-25_17-11-03", "timestamp": 1698250263, "time_this_iter_s": 2.340873956680298, "time_total_s": 267.350919008255, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 267.350919008255, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 62.074999999999996, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.4074124304840456e-36, "cur_lr": 0.0003, "total_loss": 6.059023507436117, "policy_loss": -9.507189194361369e-05, "vf_loss": 6.059161345163981, "vf_explained_var": -9.695688883463541e-07, "kl": 0.00013702011733585095, "entropy": 0.4267772595087687, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1748.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1404000, "num_env_steps_trained": 1404000, "num_agent_steps_sampled": 1404000, "num_agent_steps_trained": 1404000}, "sampler_results": {"episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.229999999999825, "episode_len_mean": 248.34, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 35.500000000000036, 46.099999999999994, -50.00000000000044, 46.699999999999996, 16.699999999999797, 44.900000000000006, 44.300000000000004, 30.29999999999999, 45.3, 22.099999999999874, 46.5, 10.499999999999709, 45.1, 44.900000000000006, 46.5, 46.699999999999996, 47.5, 45.1, -50.00000000000044, -50.00000000000044, 25.29999999999992, -50.00000000000044, 46.5, 44.900000000000006, 34.50000000000004, 46.3, 28.499999999999964, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.09999999999983, 15.299999999999777, -50.00000000000044, 37.90000000000003, 46.099999999999994, -50.00000000000044, 22.699999999999882, 47.5, 46.3, -50.00000000000044, 39.70000000000002, 18.499999999999822, 42.30000000000001, 45.7, 47.1, 27.899999999999956, 44.300000000000004, 45.1, 45.5, -50.00000000000044, 46.9, -50.00000000000044, 43.7, 39.10000000000002, 40.90000000000002, -50.00000000000044, 42.70000000000001, 44.300000000000004, -50.00000000000044, 40.30000000000002, 46.9, -50.00000000000044, 43.7, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 28.09999999999996, 46.099999999999994, -50.00000000000044, 47.5, 41.70000000000002, 33.90000000000004, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 45.7, -50.00000000000044, 7.699999999999669, -50.00000000000044, 42.70000000000001, 43.50000000000001, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 48.1, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 146, 40, 500, 34, 334, 52, 58, 198, 48, 280, 36, 396, 50, 52, 36, 34, 26, 50, 500, 500, 248, 500, 36, 52, 156, 38, 216, 500, 500, 500, 310, 348, 500, 122, 40, 500, 274, 26, 38, 500, 104, 316, 78, 44, 30, 222, 58, 50, 46, 500, 32, 500, 64, 110, 92, 500, 74, 58, 500, 98, 32, 500, 64, 36, 500, 500, 500, 68, 500, 220, 40, 500, 26, 84, 162, 500, 70, 500, 500, 28, 500, 500, 500, 42, 44, 500, 424, 500, 74, 66, 84, 500, 500, 500, 500, 20, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4029655674976552, "mean_inference_ms": 1.2898660525430115, "mean_action_processing_ms": 0.14890865986578067, "mean_env_wait_ms": 0.08998921440344862, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02299213409423828, "StateBufferConnector_ms": 0.00800013542175293, "ViewRequirementAgentConnector_ms": 0.12855148315429688}}, "episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.229999999999825, "episode_len_mean": 248.34, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 35.500000000000036, 46.099999999999994, -50.00000000000044, 46.699999999999996, 16.699999999999797, 44.900000000000006, 44.300000000000004, 30.29999999999999, 45.3, 22.099999999999874, 46.5, 10.499999999999709, 45.1, 44.900000000000006, 46.5, 46.699999999999996, 47.5, 45.1, -50.00000000000044, -50.00000000000044, 25.29999999999992, -50.00000000000044, 46.5, 44.900000000000006, 34.50000000000004, 46.3, 28.499999999999964, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.09999999999983, 15.299999999999777, -50.00000000000044, 37.90000000000003, 46.099999999999994, -50.00000000000044, 22.699999999999882, 47.5, 46.3, -50.00000000000044, 39.70000000000002, 18.499999999999822, 42.30000000000001, 45.7, 47.1, 27.899999999999956, 44.300000000000004, 45.1, 45.5, -50.00000000000044, 46.9, -50.00000000000044, 43.7, 39.10000000000002, 40.90000000000002, -50.00000000000044, 42.70000000000001, 44.300000000000004, -50.00000000000044, 40.30000000000002, 46.9, -50.00000000000044, 43.7, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 28.09999999999996, 46.099999999999994, -50.00000000000044, 47.5, 41.70000000000002, 33.90000000000004, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 45.7, -50.00000000000044, 7.699999999999669, -50.00000000000044, 42.70000000000001, 43.50000000000001, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 48.1, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 146, 40, 500, 34, 334, 52, 58, 198, 48, 280, 36, 396, 50, 52, 36, 34, 26, 50, 500, 500, 248, 500, 36, 52, 156, 38, 216, 500, 500, 500, 310, 348, 500, 122, 40, 500, 274, 26, 38, 500, 104, 316, 78, 44, 30, 222, 58, 50, 46, 500, 32, 500, 64, 110, 92, 500, 74, 58, 500, 98, 32, 500, 64, 36, 500, 500, 500, 68, 500, 220, 40, 500, 26, 84, 162, 500, 70, 500, 500, 28, 500, 500, 500, 42, 44, 500, 424, 500, 74, 66, 84, 500, 500, 500, 500, 20, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4029655674976552, "mean_inference_ms": 1.2898660525430115, "mean_action_processing_ms": 0.14890865986578067, "mean_env_wait_ms": 0.08998921440344862, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02299213409423828, "StateBufferConnector_ms": 0.00800013542175293, "ViewRequirementAgentConnector_ms": 0.12855148315429688}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1404000, "num_agent_steps_trained": 1404000, "num_env_steps_sampled": 1404000, "num_env_steps_trained": 1404000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4950.381062604386, "num_env_steps_trained_throughput_per_sec": 4950.381062604386, "timesteps_total": 1404000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1404000, "timers": {"training_iteration_time_ms": 2333.187, "sample_time_ms": 2092.221, "load_time_ms": 12.422, "load_throughput": 966014.003, "learn_time_ms": 216.149, "learn_throughput": 55517.382, "synch_weights_time_ms": 10.491}, "counters": {"num_env_steps_sampled": 1404000, "num_env_steps_trained": 1404000, "num_agent_steps_sampled": 1404000, "num_agent_steps_trained": 1404000}, "done": false, "episodes_total": 5334, "training_iteration": 117, "trial_id": "9f288_00019", "date": "2023-10-25_17-11-05", "timestamp": 1698250265, "time_this_iter_s": 2.42905330657959, "time_total_s": 269.7799723148346, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 269.7799723148346, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 69.76666666666667, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.2037062152420228e-36, "cur_lr": 0.0003, "total_loss": 6.355498091379801, "policy_loss": -0.00015714367230733236, "vf_loss": 6.355698331197103, "vf_explained_var": -8.821487426757813e-07, "kl": 0.00035728261932869526, "entropy": 0.4290937125682831, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1763.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1416000, "num_env_steps_trained": 1416000, "num_agent_steps_sampled": 1416000, "num_agent_steps_trained": 1416000}, "sampler_results": {"episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.368999999999796, "episode_len_mean": 271.86, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [27.899999999999956, 44.300000000000004, 45.1, 45.5, -50.00000000000044, 46.9, -50.00000000000044, 43.7, 39.10000000000002, 40.90000000000002, -50.00000000000044, 42.70000000000001, 44.300000000000004, -50.00000000000044, 40.30000000000002, 46.9, -50.00000000000044, 43.7, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 28.09999999999996, 46.099999999999994, -50.00000000000044, 47.5, 41.70000000000002, 33.90000000000004, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 45.7, -50.00000000000044, 7.699999999999669, -50.00000000000044, 42.70000000000001, 43.50000000000001, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 48.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 44.900000000000006, 33.10000000000003, -50.00000000000044, 32.90000000000003, 47.3, -50.00000000000044, 47.5, -50.00000000000044, 41.100000000000016, 45.3, 46.699999999999996, -50.00000000000044, 47.9, 46.699999999999996, 46.5, 28.89999999999997, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.699999999999783, 14.899999999999771, 43.7, -50.00000000000044, 45.1, 47.7, -50.00000000000044, 46.3, 47.1, 47.3, -50.00000000000044, 36.70000000000003, 46.5, -50.00000000000044, 43.50000000000001, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [222, 58, 50, 46, 500, 32, 500, 64, 110, 92, 500, 74, 58, 500, 98, 32, 500, 64, 36, 500, 500, 500, 68, 500, 220, 40, 500, 26, 84, 162, 500, 70, 500, 500, 28, 500, 500, 500, 42, 44, 500, 424, 500, 74, 66, 84, 500, 500, 500, 500, 20, 500, 500, 500, 500, 500, 28, 52, 170, 500, 172, 28, 500, 26, 500, 90, 48, 34, 500, 22, 34, 36, 212, 54, 500, 500, 500, 500, 500, 344, 352, 64, 500, 50, 24, 500, 38, 30, 28, 500, 134, 36, 500, 66, 500, 26, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4029384026134902, "mean_inference_ms": 1.2907228723197264, "mean_action_processing_ms": 0.1491538523749959, "mean_env_wait_ms": 0.0897095847760263, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014995574951171875, "StateBufferConnector_ms": 0.00899815559387207, "ViewRequirementAgentConnector_ms": 0.11702084541320801}}, "episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.368999999999796, "episode_len_mean": 271.86, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [27.899999999999956, 44.300000000000004, 45.1, 45.5, -50.00000000000044, 46.9, -50.00000000000044, 43.7, 39.10000000000002, 40.90000000000002, -50.00000000000044, 42.70000000000001, 44.300000000000004, -50.00000000000044, 40.30000000000002, 46.9, -50.00000000000044, 43.7, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 28.09999999999996, 46.099999999999994, -50.00000000000044, 47.5, 41.70000000000002, 33.90000000000004, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 45.7, -50.00000000000044, 7.699999999999669, -50.00000000000044, 42.70000000000001, 43.50000000000001, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 48.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 44.900000000000006, 33.10000000000003, -50.00000000000044, 32.90000000000003, 47.3, -50.00000000000044, 47.5, -50.00000000000044, 41.100000000000016, 45.3, 46.699999999999996, -50.00000000000044, 47.9, 46.699999999999996, 46.5, 28.89999999999997, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.699999999999783, 14.899999999999771, 43.7, -50.00000000000044, 45.1, 47.7, -50.00000000000044, 46.3, 47.1, 47.3, -50.00000000000044, 36.70000000000003, 46.5, -50.00000000000044, 43.50000000000001, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [222, 58, 50, 46, 500, 32, 500, 64, 110, 92, 500, 74, 58, 500, 98, 32, 500, 64, 36, 500, 500, 500, 68, 500, 220, 40, 500, 26, 84, 162, 500, 70, 500, 500, 28, 500, 500, 500, 42, 44, 500, 424, 500, 74, 66, 84, 500, 500, 500, 500, 20, 500, 500, 500, 500, 500, 28, 52, 170, 500, 172, 28, 500, 26, 500, 90, 48, 34, 500, 22, 34, 36, 212, 54, 500, 500, 500, 500, 500, 344, 352, 64, 500, 50, 24, 500, 38, 30, 28, 500, 134, 36, 500, 66, 500, 26, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4029384026134902, "mean_inference_ms": 1.2907228723197264, "mean_action_processing_ms": 0.1491538523749959, "mean_env_wait_ms": 0.0897095847760263, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014995574951171875, "StateBufferConnector_ms": 0.00899815559387207, "ViewRequirementAgentConnector_ms": 0.11702084541320801}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1416000, "num_agent_steps_trained": 1416000, "num_env_steps_sampled": 1416000, "num_env_steps_trained": 1416000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4998.614873853413, "num_env_steps_trained_throughput_per_sec": 4998.614873853413, "timesteps_total": 1416000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1416000, "timers": {"training_iteration_time_ms": 2338.676, "sample_time_ms": 2093.921, "load_time_ms": 12.521, "load_throughput": 958371.298, "learn_time_ms": 220.082, "learn_throughput": 54525.061, "synch_weights_time_ms": 10.55}, "counters": {"num_env_steps_sampled": 1416000, "num_env_steps_trained": 1416000, "num_agent_steps_sampled": 1416000, "num_agent_steps_trained": 1416000}, "done": false, "episodes_total": 5380, "training_iteration": 118, "trial_id": "9f288_00019", "date": "2023-10-25_17-11-08", "timestamp": 1698250268, "time_this_iter_s": 2.405951499938965, "time_total_s": 272.18592381477356, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 272.18592381477356, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 59.875, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.018531076210114e-37, "cur_lr": 0.0003, "total_loss": 6.637164115905762, "policy_loss": -0.00040803104639053345, "vf_loss": 6.637615108489991, "vf_explained_var": -8.265177408854167e-07, "kl": 0.0005839824673936771, "entropy": 0.43115389744440713, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1778.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1428000, "num_env_steps_trained": 1428000, "num_agent_steps_sampled": 1428000, "num_agent_steps_trained": 1428000}, "sampler_results": {"episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -3.945000000000227, "episode_len_mean": 294.96, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 42.70000000000001, 43.50000000000001, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 48.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 44.900000000000006, 33.10000000000003, -50.00000000000044, 32.90000000000003, 47.3, -50.00000000000044, 47.5, -50.00000000000044, 41.100000000000016, 45.3, 46.699999999999996, -50.00000000000044, 47.9, 46.699999999999996, 46.5, 28.89999999999997, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.699999999999783, 14.899999999999771, 43.7, -50.00000000000044, 45.1, 47.7, -50.00000000000044, 46.3, 47.1, 47.3, -50.00000000000044, 36.70000000000003, 46.5, -50.00000000000044, 43.50000000000001, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 1.4999999999995808, 45.1, -50.00000000000044, -50.00000000000044, 45.7, 47.3, -50.00000000000044, 45.5, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 37.90000000000003, 21.299999999999862, -50.00000000000044, -50.00000000000044, 29.69999999999998, 33.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 47.5, -50.00000000000044, -50.00000000000044, 31.500000000000007, -50.00000000000044, 44.5, 47.1, 42.70000000000001, 28.89999999999997, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 21.499999999999865, -50.00000000000044, 43.900000000000006, -50.00000000000044], "episode_lengths": [500, 74, 66, 84, 500, 500, 500, 500, 20, 500, 500, 500, 500, 500, 28, 52, 170, 500, 172, 28, 500, 26, 500, 90, 48, 34, 500, 22, 34, 36, 212, 54, 500, 500, 500, 500, 500, 344, 352, 64, 500, 50, 24, 500, 38, 30, 28, 500, 134, 36, 500, 66, 500, 26, 500, 500, 500, 500, 486, 50, 500, 500, 44, 28, 500, 46, 500, 36, 500, 500, 122, 288, 500, 500, 204, 164, 500, 500, 500, 50, 26, 500, 500, 186, 500, 56, 30, 74, 212, 44, 500, 500, 500, 60, 500, 500, 286, 500, 62, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4028959063245541, "mean_inference_ms": 1.291116387923855, "mean_action_processing_ms": 0.1492421619667785, "mean_env_wait_ms": 0.08982396134061309, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024991273880004883, "StateBufferConnector_ms": 0.00799703598022461, "ViewRequirementAgentConnector_ms": 0.12799763679504395}}, "episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -3.945000000000227, "episode_len_mean": 294.96, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 42.70000000000001, 43.50000000000001, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 48.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 44.900000000000006, 33.10000000000003, -50.00000000000044, 32.90000000000003, 47.3, -50.00000000000044, 47.5, -50.00000000000044, 41.100000000000016, 45.3, 46.699999999999996, -50.00000000000044, 47.9, 46.699999999999996, 46.5, 28.89999999999997, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.699999999999783, 14.899999999999771, 43.7, -50.00000000000044, 45.1, 47.7, -50.00000000000044, 46.3, 47.1, 47.3, -50.00000000000044, 36.70000000000003, 46.5, -50.00000000000044, 43.50000000000001, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 1.4999999999995808, 45.1, -50.00000000000044, -50.00000000000044, 45.7, 47.3, -50.00000000000044, 45.5, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 37.90000000000003, 21.299999999999862, -50.00000000000044, -50.00000000000044, 29.69999999999998, 33.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 47.5, -50.00000000000044, -50.00000000000044, 31.500000000000007, -50.00000000000044, 44.5, 47.1, 42.70000000000001, 28.89999999999997, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 21.499999999999865, -50.00000000000044, 43.900000000000006, -50.00000000000044], "episode_lengths": [500, 74, 66, 84, 500, 500, 500, 500, 20, 500, 500, 500, 500, 500, 28, 52, 170, 500, 172, 28, 500, 26, 500, 90, 48, 34, 500, 22, 34, 36, 212, 54, 500, 500, 500, 500, 500, 344, 352, 64, 500, 50, 24, 500, 38, 30, 28, 500, 134, 36, 500, 66, 500, 26, 500, 500, 500, 500, 486, 50, 500, 500, 44, 28, 500, 46, 500, 36, 500, 500, 122, 288, 500, 500, 204, 164, 500, 500, 500, 50, 26, 500, 500, 186, 500, 56, 30, 74, 212, 44, 500, 500, 500, 60, 500, 500, 286, 500, 62, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4028959063245541, "mean_inference_ms": 1.291116387923855, "mean_action_processing_ms": 0.1492421619667785, "mean_env_wait_ms": 0.08982396134061309, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024991273880004883, "StateBufferConnector_ms": 0.00799703598022461, "ViewRequirementAgentConnector_ms": 0.12799763679504395}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1428000, "num_agent_steps_trained": 1428000, "num_env_steps_sampled": 1428000, "num_env_steps_trained": 1428000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5025.018742117154, "num_env_steps_trained_throughput_per_sec": 5025.018742117154, "timesteps_total": 1428000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1428000, "timers": {"training_iteration_time_ms": 2338.913, "sample_time_ms": 2094.747, "load_time_ms": 12.524, "load_throughput": 958170.607, "learn_time_ms": 219.569, "learn_throughput": 54652.52, "synch_weights_time_ms": 10.371}, "counters": {"num_env_steps_sampled": 1428000, "num_env_steps_trained": 1428000, "num_agent_steps_sampled": 1428000, "num_agent_steps_trained": 1428000}, "done": false, "episodes_total": 5422, "training_iteration": 119, "trial_id": "9f288_00019", "date": "2023-10-25_17-11-10", "timestamp": 1698250270, "time_this_iter_s": 2.3930466175079346, "time_total_s": 274.5789704322815, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 274.5789704322815, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 71.26666666666667, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.009265538105057e-37, "cur_lr": 0.0003, "total_loss": 6.936253452301026, "policy_loss": -0.00013478249311447144, "vf_loss": 6.936432425181071, "vf_explained_var": -8.900960286458333e-07, "kl": 0.00046187937502016515, "entropy": 0.4397440433502197, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1793.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1440000, "num_env_steps_trained": 1440000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.9829999999997983, "episode_len_mean": 275.76, "episode_media": {}, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.5, -50.00000000000044, 43.50000000000001, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 1.4999999999995808, 45.1, -50.00000000000044, -50.00000000000044, 45.7, 47.3, -50.00000000000044, 45.5, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 37.90000000000003, 21.299999999999862, -50.00000000000044, -50.00000000000044, 29.69999999999998, 33.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 47.5, -50.00000000000044, -50.00000000000044, 31.500000000000007, -50.00000000000044, 44.5, 47.1, 42.70000000000001, 28.89999999999997, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 21.499999999999865, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 37.10000000000003, 40.70000000000002, 8.699999999999683, 41.70000000000002, -50.00000000000044, 44.10000000000001, 8.899999999999686, -50.00000000000044, 45.9, 0.8999999999995723, 44.7, 33.10000000000003, -50.00000000000044, 44.300000000000004, 44.10000000000001, -50.00000000000044, -50.00000000000044, 46.099999999999994, 46.9, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 41.100000000000016, 15.49999999999978, 44.7, 46.5, 35.10000000000004, 45.3, 46.099999999999994, -50.00000000000044, 44.7, 22.899999999999885, 43.30000000000001, 46.3, 35.10000000000004, -50.00000000000044, 44.5, 36.50000000000003, 47.3, -50.00000000000044, -50.00000000000044, 45.3, 41.90000000000001, 10.099999999999703, 45.3], "episode_lengths": [36, 500, 66, 500, 26, 500, 500, 500, 500, 486, 50, 500, 500, 44, 28, 500, 46, 500, 36, 500, 500, 122, 288, 500, 500, 204, 164, 500, 500, 500, 50, 26, 500, 500, 186, 500, 56, 30, 74, 212, 44, 500, 500, 500, 60, 500, 500, 286, 500, 62, 500, 500, 130, 94, 414, 84, 500, 60, 412, 500, 42, 492, 54, 170, 500, 58, 60, 500, 500, 40, 32, 58, 500, 500, 500, 500, 50, 90, 346, 54, 36, 150, 48, 40, 500, 54, 272, 68, 38, 150, 500, 56, 136, 28, 500, 500, 48, 82, 400, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40297680790652524, "mean_inference_ms": 1.2912578303534599, "mean_action_processing_ms": 0.14953335897135345, "mean_env_wait_ms": 0.09003407601232905, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028985023498535156, "StateBufferConnector_ms": 0.00699615478515625, "ViewRequirementAgentConnector_ms": 0.1534571647644043}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.9829999999997983, "episode_len_mean": 275.76, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.5, -50.00000000000044, 43.50000000000001, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 1.4999999999995808, 45.1, -50.00000000000044, -50.00000000000044, 45.7, 47.3, -50.00000000000044, 45.5, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 37.90000000000003, 21.299999999999862, -50.00000000000044, -50.00000000000044, 29.69999999999998, 33.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 47.5, -50.00000000000044, -50.00000000000044, 31.500000000000007, -50.00000000000044, 44.5, 47.1, 42.70000000000001, 28.89999999999997, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 21.499999999999865, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 37.10000000000003, 40.70000000000002, 8.699999999999683, 41.70000000000002, -50.00000000000044, 44.10000000000001, 8.899999999999686, -50.00000000000044, 45.9, 0.8999999999995723, 44.7, 33.10000000000003, -50.00000000000044, 44.300000000000004, 44.10000000000001, -50.00000000000044, -50.00000000000044, 46.099999999999994, 46.9, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 41.100000000000016, 15.49999999999978, 44.7, 46.5, 35.10000000000004, 45.3, 46.099999999999994, -50.00000000000044, 44.7, 22.899999999999885, 43.30000000000001, 46.3, 35.10000000000004, -50.00000000000044, 44.5, 36.50000000000003, 47.3, -50.00000000000044, -50.00000000000044, 45.3, 41.90000000000001, 10.099999999999703, 45.3], "episode_lengths": [36, 500, 66, 500, 26, 500, 500, 500, 500, 486, 50, 500, 500, 44, 28, 500, 46, 500, 36, 500, 500, 122, 288, 500, 500, 204, 164, 500, 500, 500, 50, 26, 500, 500, 186, 500, 56, 30, 74, 212, 44, 500, 500, 500, 60, 500, 500, 286, 500, 62, 500, 500, 130, 94, 414, 84, 500, 60, 412, 500, 42, 492, 54, 170, 500, 58, 60, 500, 500, 40, 32, 58, 500, 500, 500, 500, 50, 90, 346, 54, 36, 150, 48, 40, 500, 54, 272, 68, 38, 150, 500, 56, 136, 28, 500, 500, 48, 82, 400, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40297680790652524, "mean_inference_ms": 1.2912578303534599, "mean_action_processing_ms": 0.14953335897135345, "mean_env_wait_ms": 0.09003407601232905, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028985023498535156, "StateBufferConnector_ms": 0.00699615478515625, "ViewRequirementAgentConnector_ms": 0.1534571647644043}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000, "num_env_steps_sampled": 1440000, "num_env_steps_trained": 1440000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4986.621173948715, "num_env_steps_trained_throughput_per_sec": 4986.621173948715, "timesteps_total": 1440000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1440000, "timers": {"training_iteration_time_ms": 2362.235, "sample_time_ms": 2104.634, "load_time_ms": 13.351, "load_throughput": 898832.395, "learn_time_ms": 232.144, "learn_throughput": 51691.963, "synch_weights_time_ms": 10.535}, "counters": {"num_env_steps_sampled": 1440000, "num_env_steps_trained": 1440000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "done": false, "episodes_total": 5471, "training_iteration": 120, "trial_id": "9f288_00019", "date": "2023-10-25_17-11-12", "timestamp": 1698250272, "time_this_iter_s": 2.4114325046539307, "time_total_s": 276.9904029369354, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 276.9904029369354, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 64.63333333333334, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.5046327690525285e-37, "cur_lr": 0.0003, "total_loss": 6.244748306274414, "policy_loss": -0.0002653623620669047, "vf_loss": 6.245052242279053, "vf_explained_var": -1.1682510375976563e-06, "kl": 0.0002097760984914506, "entropy": 0.3866647005081177, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1808.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1452000, "num_env_steps_trained": 1452000, "num_agent_steps_sampled": 1452000, "num_agent_steps_trained": 1452000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.021999999999808, "episode_len_mean": 260.4, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.10000000000001, -50.00000000000044, -50.00000000000044, 21.499999999999865, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 37.10000000000003, 40.70000000000002, 8.699999999999683, 41.70000000000002, -50.00000000000044, 44.10000000000001, 8.899999999999686, -50.00000000000044, 45.9, 0.8999999999995723, 44.7, 33.10000000000003, -50.00000000000044, 44.300000000000004, 44.10000000000001, -50.00000000000044, -50.00000000000044, 46.099999999999994, 46.9, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 41.100000000000016, 15.49999999999978, 44.7, 46.5, 35.10000000000004, 45.3, 46.099999999999994, -50.00000000000044, 44.7, 22.899999999999885, 43.30000000000001, 46.3, 35.10000000000004, -50.00000000000044, 44.5, 36.50000000000003, 47.3, -50.00000000000044, -50.00000000000044, 45.3, 41.90000000000001, 10.099999999999703, 45.3, -50.00000000000044, -50.00000000000044, 17.299999999999805, 47.7, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 0.2999999999995637, -50.00000000000044, 47.1, -50.00000000000044, 44.900000000000006, 45.3, -50.00000000000044, 44.7, 44.7, 45.9, 46.9, 43.50000000000001, 47.1, 47.5, 46.099999999999994, 44.10000000000001, 41.70000000000002, 47.3, 20.49999999999985, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.29999999999992, -50.00000000000044, 46.099999999999994, -50.00000000000044, 47.1, 46.3, -50.00000000000044], "episode_lengths": [60, 500, 500, 286, 500, 62, 500, 500, 130, 94, 414, 84, 500, 60, 412, 500, 42, 492, 54, 170, 500, 58, 60, 500, 500, 40, 32, 58, 500, 500, 500, 500, 50, 90, 346, 54, 36, 150, 48, 40, 500, 54, 272, 68, 38, 150, 500, 56, 136, 28, 500, 500, 48, 82, 400, 48, 500, 500, 328, 24, 46, 500, 500, 500, 500, 498, 500, 30, 500, 52, 48, 500, 54, 54, 42, 32, 66, 30, 26, 40, 60, 84, 28, 296, 44, 500, 500, 500, 500, 500, 500, 500, 500, 248, 500, 40, 500, 30, 38, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40279519033356, "mean_inference_ms": 1.2910177745623053, "mean_action_processing_ms": 0.15051219653096332, "mean_env_wait_ms": 0.09002867980477629, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029986858367919922, "StateBufferConnector_ms": 0.009987592697143555, "ViewRequirementAgentConnector_ms": 0.15244650840759277}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.021999999999808, "episode_len_mean": 260.4, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.10000000000001, -50.00000000000044, -50.00000000000044, 21.499999999999865, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 37.10000000000003, 40.70000000000002, 8.699999999999683, 41.70000000000002, -50.00000000000044, 44.10000000000001, 8.899999999999686, -50.00000000000044, 45.9, 0.8999999999995723, 44.7, 33.10000000000003, -50.00000000000044, 44.300000000000004, 44.10000000000001, -50.00000000000044, -50.00000000000044, 46.099999999999994, 46.9, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 41.100000000000016, 15.49999999999978, 44.7, 46.5, 35.10000000000004, 45.3, 46.099999999999994, -50.00000000000044, 44.7, 22.899999999999885, 43.30000000000001, 46.3, 35.10000000000004, -50.00000000000044, 44.5, 36.50000000000003, 47.3, -50.00000000000044, -50.00000000000044, 45.3, 41.90000000000001, 10.099999999999703, 45.3, -50.00000000000044, -50.00000000000044, 17.299999999999805, 47.7, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 0.2999999999995637, -50.00000000000044, 47.1, -50.00000000000044, 44.900000000000006, 45.3, -50.00000000000044, 44.7, 44.7, 45.9, 46.9, 43.50000000000001, 47.1, 47.5, 46.099999999999994, 44.10000000000001, 41.70000000000002, 47.3, 20.49999999999985, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.29999999999992, -50.00000000000044, 46.099999999999994, -50.00000000000044, 47.1, 46.3, -50.00000000000044], "episode_lengths": [60, 500, 500, 286, 500, 62, 500, 500, 130, 94, 414, 84, 500, 60, 412, 500, 42, 492, 54, 170, 500, 58, 60, 500, 500, 40, 32, 58, 500, 500, 500, 500, 50, 90, 346, 54, 36, 150, 48, 40, 500, 54, 272, 68, 38, 150, 500, 56, 136, 28, 500, 500, 48, 82, 400, 48, 500, 500, 328, 24, 46, 500, 500, 500, 500, 498, 500, 30, 500, 52, 48, 500, 54, 54, 42, 32, 66, 30, 26, 40, 60, 84, 28, 296, 44, 500, 500, 500, 500, 500, 500, 500, 500, 248, 500, 40, 500, 30, 38, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40279519033356, "mean_inference_ms": 1.2910177745623053, "mean_action_processing_ms": 0.15051219653096332, "mean_env_wait_ms": 0.09002867980477629, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029986858367919922, "StateBufferConnector_ms": 0.009987592697143555, "ViewRequirementAgentConnector_ms": 0.15244650840759277}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1452000, "num_agent_steps_trained": 1452000, "num_env_steps_sampled": 1452000, "num_env_steps_trained": 1452000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5041.064147519162, "num_env_steps_trained_throughput_per_sec": 5041.064147519162, "timesteps_total": 1452000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1452000, "timers": {"training_iteration_time_ms": 2356.289, "sample_time_ms": 2097.32, "load_time_ms": 12.767, "load_throughput": 939900.056, "learn_time_ms": 233.669, "learn_throughput": 51354.774, "synch_weights_time_ms": 10.961}, "counters": {"num_env_steps_sampled": 1452000, "num_env_steps_trained": 1452000, "num_agent_steps_sampled": 1452000, "num_agent_steps_trained": 1452000}, "done": false, "episodes_total": 5515, "training_iteration": 121, "trial_id": "9f288_00019", "date": "2023-10-25_17-11-15", "timestamp": 1698250275, "time_this_iter_s": 2.3871705532073975, "time_total_s": 279.3775734901428, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 279.3775734901428, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 62.125, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.523163845262643e-38, "cur_lr": 0.0003, "total_loss": 6.315646998087565, "policy_loss": 1.0530153910319011e-06, "vf_loss": 6.315690040588379, "vf_explained_var": -8.58306884765625e-07, "kl": 0.00010211620821489001, "entropy": 0.44158385396003724, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1823.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1464000, "num_env_steps_trained": 1464000, "num_agent_steps_sampled": 1464000, "num_agent_steps_trained": 1464000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.7069999999997973, "episode_len_mean": 268.52, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.7, 22.899999999999885, 43.30000000000001, 46.3, 35.10000000000004, -50.00000000000044, 44.5, 36.50000000000003, 47.3, -50.00000000000044, -50.00000000000044, 45.3, 41.90000000000001, 10.099999999999703, 45.3, -50.00000000000044, -50.00000000000044, 17.299999999999805, 47.7, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 0.2999999999995637, -50.00000000000044, 47.1, -50.00000000000044, 44.900000000000006, 45.3, -50.00000000000044, 44.7, 44.7, 45.9, 46.9, 43.50000000000001, 47.1, 47.5, 46.099999999999994, 44.10000000000001, 41.70000000000002, 47.3, 20.49999999999985, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.29999999999992, -50.00000000000044, 46.099999999999994, -50.00000000000044, 47.1, 46.3, -50.00000000000044, 46.9, -50.00000000000044, 22.099999999999874, 47.1, -50.00000000000044, 10.299999999999706, 46.099999999999994, -50.00000000000044, 42.30000000000001, -50.00000000000044, 7.699999999999669, 31.300000000000004, -50.00000000000044, 45.5, -50.00000000000044, 40.70000000000002, 47.1, 44.900000000000006, -50.00000000000044, 44.7, 21.89999999999987, 42.30000000000001, -50.00000000000044, 43.7, 45.7, 45.1, 42.10000000000001, -50.00000000000044, -50.00000000000044, 23.499999999999893, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 47.3], "episode_lengths": [500, 54, 272, 68, 38, 150, 500, 56, 136, 28, 500, 500, 48, 82, 400, 48, 500, 500, 328, 24, 46, 500, 500, 500, 500, 498, 500, 30, 500, 52, 48, 500, 54, 54, 42, 32, 66, 30, 26, 40, 60, 84, 28, 296, 44, 500, 500, 500, 500, 500, 500, 500, 500, 248, 500, 40, 500, 30, 38, 500, 32, 500, 280, 30, 500, 398, 40, 500, 78, 500, 424, 188, 500, 46, 500, 94, 30, 52, 500, 54, 282, 78, 500, 64, 44, 50, 80, 500, 500, 266, 34, 500, 500, 500, 500, 500, 500, 500, 62, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.403049629806776, "mean_inference_ms": 1.292045770572325, "mean_action_processing_ms": 0.15076011930841118, "mean_env_wait_ms": 0.09012342008038114, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030986309051513672, "StateBufferConnector_ms": 0.013980865478515625, "ViewRequirementAgentConnector_ms": 0.15243864059448242}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.7069999999997973, "episode_len_mean": 268.52, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.7, 22.899999999999885, 43.30000000000001, 46.3, 35.10000000000004, -50.00000000000044, 44.5, 36.50000000000003, 47.3, -50.00000000000044, -50.00000000000044, 45.3, 41.90000000000001, 10.099999999999703, 45.3, -50.00000000000044, -50.00000000000044, 17.299999999999805, 47.7, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 0.2999999999995637, -50.00000000000044, 47.1, -50.00000000000044, 44.900000000000006, 45.3, -50.00000000000044, 44.7, 44.7, 45.9, 46.9, 43.50000000000001, 47.1, 47.5, 46.099999999999994, 44.10000000000001, 41.70000000000002, 47.3, 20.49999999999985, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.29999999999992, -50.00000000000044, 46.099999999999994, -50.00000000000044, 47.1, 46.3, -50.00000000000044, 46.9, -50.00000000000044, 22.099999999999874, 47.1, -50.00000000000044, 10.299999999999706, 46.099999999999994, -50.00000000000044, 42.30000000000001, -50.00000000000044, 7.699999999999669, 31.300000000000004, -50.00000000000044, 45.5, -50.00000000000044, 40.70000000000002, 47.1, 44.900000000000006, -50.00000000000044, 44.7, 21.89999999999987, 42.30000000000001, -50.00000000000044, 43.7, 45.7, 45.1, 42.10000000000001, -50.00000000000044, -50.00000000000044, 23.499999999999893, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 47.3], "episode_lengths": [500, 54, 272, 68, 38, 150, 500, 56, 136, 28, 500, 500, 48, 82, 400, 48, 500, 500, 328, 24, 46, 500, 500, 500, 500, 498, 500, 30, 500, 52, 48, 500, 54, 54, 42, 32, 66, 30, 26, 40, 60, 84, 28, 296, 44, 500, 500, 500, 500, 500, 500, 500, 500, 248, 500, 40, 500, 30, 38, 500, 32, 500, 280, 30, 500, 398, 40, 500, 78, 500, 424, 188, 500, 46, 500, 94, 30, 52, 500, 54, 282, 78, 500, 64, 44, 50, 80, 500, 500, 266, 34, 500, 500, 500, 500, 500, 500, 500, 62, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.403049629806776, "mean_inference_ms": 1.292045770572325, "mean_action_processing_ms": 0.15076011930841118, "mean_env_wait_ms": 0.09012342008038114, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030986309051513672, "StateBufferConnector_ms": 0.013980865478515625, "ViewRequirementAgentConnector_ms": 0.15243864059448242}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1464000, "num_agent_steps_trained": 1464000, "num_env_steps_sampled": 1464000, "num_env_steps_trained": 1464000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5079.721975825029, "num_env_steps_trained_throughput_per_sec": 5079.721975825029, "timesteps_total": 1464000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1464000, "timers": {"training_iteration_time_ms": 2377.538, "sample_time_ms": 2114.737, "load_time_ms": 12.966, "load_throughput": 925484.618, "learn_time_ms": 237.23, "learn_throughput": 50583.773, "synch_weights_time_ms": 11.034}, "counters": {"num_env_steps_sampled": 1464000, "num_env_steps_trained": 1464000, "num_agent_steps_sampled": 1464000, "num_agent_steps_trained": 1464000}, "done": false, "episodes_total": 5555, "training_iteration": 122, "trial_id": "9f288_00019", "date": "2023-10-25_17-11-17", "timestamp": 1698250277, "time_this_iter_s": 2.367333173751831, "time_total_s": 281.74490666389465, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 281.74490666389465, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 69.60000000000001, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.7615819226313213e-38, "cur_lr": 0.0003, "total_loss": 6.3979637145996096, "policy_loss": -0.00030861422419548035, "vf_loss": 6.398314793904622, "vf_explained_var": -8.742014567057291e-07, "kl": 0.00037773991049689927, "entropy": 0.42382307449976603, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1838.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1476000, "num_env_steps_trained": 1476000, "num_agent_steps_sampled": 1476000, "num_agent_steps_trained": 1476000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -3.092000000000228, "episode_len_mean": 291.44, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.29999999999992, -50.00000000000044, 46.099999999999994, -50.00000000000044, 47.1, 46.3, -50.00000000000044, 46.9, -50.00000000000044, 22.099999999999874, 47.1, -50.00000000000044, 10.299999999999706, 46.099999999999994, -50.00000000000044, 42.30000000000001, -50.00000000000044, 7.699999999999669, 31.300000000000004, -50.00000000000044, 45.5, -50.00000000000044, 40.70000000000002, 47.1, 44.900000000000006, -50.00000000000044, 44.7, 21.89999999999987, 42.30000000000001, -50.00000000000044, 43.7, 45.7, 45.1, 42.10000000000001, -50.00000000000044, -50.00000000000044, 23.499999999999893, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 47.3, -50.00000000000044, -50.00000000000044, 41.90000000000001, 43.7, -50.00000000000044, 45.7, -50.00000000000044, 47.1, -50.00000000000044, 10.499999999999709, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, 45.9, 46.699999999999996, 46.699999999999996, 13.299999999999748, -50.00000000000044, 46.3, 44.5, -50.00000000000044, 46.099999999999994, 45.5, 47.9, -50.00000000000044, 33.70000000000004, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 41.100000000000016, -50.00000000000044, 45.9, -50.00000000000044, 43.900000000000006, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 46.099999999999994, 44.900000000000006], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 248, 500, 40, 500, 30, 38, 500, 32, 500, 280, 30, 500, 398, 40, 500, 78, 500, 424, 188, 500, 46, 500, 94, 30, 52, 500, 54, 282, 78, 500, 64, 44, 50, 80, 500, 500, 266, 34, 500, 500, 500, 500, 500, 500, 500, 62, 28, 500, 500, 82, 64, 500, 44, 500, 30, 500, 396, 500, 500, 500, 102, 42, 34, 34, 368, 500, 38, 56, 500, 40, 46, 22, 500, 164, 500, 500, 88, 500, 500, 36, 500, 90, 500, 42, 500, 62, 50, 500, 500, 500, 32, 40, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.403232666167858, "mean_inference_ms": 1.2926076178843087, "mean_action_processing_ms": 0.15008563393482838, "mean_env_wait_ms": 0.09019645545105714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024996280670166016, "StateBufferConnector_ms": 0.011981964111328125, "ViewRequirementAgentConnector_ms": 0.14898252487182617}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -3.092000000000228, "episode_len_mean": 291.44, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.29999999999992, -50.00000000000044, 46.099999999999994, -50.00000000000044, 47.1, 46.3, -50.00000000000044, 46.9, -50.00000000000044, 22.099999999999874, 47.1, -50.00000000000044, 10.299999999999706, 46.099999999999994, -50.00000000000044, 42.30000000000001, -50.00000000000044, 7.699999999999669, 31.300000000000004, -50.00000000000044, 45.5, -50.00000000000044, 40.70000000000002, 47.1, 44.900000000000006, -50.00000000000044, 44.7, 21.89999999999987, 42.30000000000001, -50.00000000000044, 43.7, 45.7, 45.1, 42.10000000000001, -50.00000000000044, -50.00000000000044, 23.499999999999893, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 47.3, -50.00000000000044, -50.00000000000044, 41.90000000000001, 43.7, -50.00000000000044, 45.7, -50.00000000000044, 47.1, -50.00000000000044, 10.499999999999709, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, 45.9, 46.699999999999996, 46.699999999999996, 13.299999999999748, -50.00000000000044, 46.3, 44.5, -50.00000000000044, 46.099999999999994, 45.5, 47.9, -50.00000000000044, 33.70000000000004, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 41.100000000000016, -50.00000000000044, 45.9, -50.00000000000044, 43.900000000000006, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 46.099999999999994, 44.900000000000006], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 248, 500, 40, 500, 30, 38, 500, 32, 500, 280, 30, 500, 398, 40, 500, 78, 500, 424, 188, 500, 46, 500, 94, 30, 52, 500, 54, 282, 78, 500, 64, 44, 50, 80, 500, 500, 266, 34, 500, 500, 500, 500, 500, 500, 500, 62, 28, 500, 500, 82, 64, 500, 44, 500, 30, 500, 396, 500, 500, 500, 102, 42, 34, 34, 368, 500, 38, 56, 500, 40, 46, 22, 500, 164, 500, 500, 88, 500, 500, 36, 500, 90, 500, 42, 500, 62, 50, 500, 500, 500, 32, 40, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.403232666167858, "mean_inference_ms": 1.2926076178843087, "mean_action_processing_ms": 0.15008563393482838, "mean_env_wait_ms": 0.09019645545105714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024996280670166016, "StateBufferConnector_ms": 0.011981964111328125, "ViewRequirementAgentConnector_ms": 0.14898252487182617}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1476000, "num_agent_steps_trained": 1476000, "num_env_steps_sampled": 1476000, "num_env_steps_trained": 1476000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4923.453034309954, "num_env_steps_trained_throughput_per_sec": 4923.453034309954, "timesteps_total": 1476000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1476000, "timers": {"training_iteration_time_ms": 2401.7, "sample_time_ms": 2136.405, "load_time_ms": 12.086, "load_throughput": 992916.807, "learn_time_ms": 240.507, "learn_throughput": 49894.512, "synch_weights_time_ms": 11.231}, "counters": {"num_env_steps_sampled": 1476000, "num_env_steps_trained": 1476000, "num_agent_steps_sampled": 1476000, "num_agent_steps_trained": 1476000}, "done": false, "episodes_total": 5601, "training_iteration": 123, "trial_id": "9f288_00019", "date": "2023-10-25_17-11-20", "timestamp": 1698250280, "time_this_iter_s": 2.443328857421875, "time_total_s": 284.1882355213165, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 284.1882355213165, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 64.3, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.8807909613156606e-38, "cur_lr": 0.0003, "total_loss": 6.0079877535502115, "policy_loss": -1.6366442044576008e-06, "vf_loss": 6.0080284436543785, "vf_explained_var": -8.344650268554688e-07, "kl": 0.00014961550859879936, "entropy": 0.3910531719525655, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1853.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1488000, "num_env_steps_trained": 1488000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -3.9880000000002287, "episode_len_mean": 290.38, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.1, 42.10000000000001, -50.00000000000044, -50.00000000000044, 23.499999999999893, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 47.3, -50.00000000000044, -50.00000000000044, 41.90000000000001, 43.7, -50.00000000000044, 45.7, -50.00000000000044, 47.1, -50.00000000000044, 10.499999999999709, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, 45.9, 46.699999999999996, 46.699999999999996, 13.299999999999748, -50.00000000000044, 46.3, 44.5, -50.00000000000044, 46.099999999999994, 45.5, 47.9, -50.00000000000044, 33.70000000000004, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 41.100000000000016, -50.00000000000044, 45.9, -50.00000000000044, 43.900000000000006, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 46.099999999999994, 44.900000000000006, 40.90000000000002, -50.00000000000044, -50.00000000000044, 44.10000000000001, 46.9, 33.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 46.699999999999996, 42.70000000000001, -50.00000000000044, 45.9, 34.30000000000004, 46.099999999999994, 11.099999999999717, -50.00000000000044, 47.7, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 46.5, 46.5, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044], "episode_lengths": [50, 80, 500, 500, 266, 34, 500, 500, 500, 500, 500, 500, 500, 62, 28, 500, 500, 82, 64, 500, 44, 500, 30, 500, 396, 500, 500, 500, 102, 42, 34, 34, 368, 500, 38, 56, 500, 40, 46, 22, 500, 164, 500, 500, 88, 500, 500, 36, 500, 90, 500, 42, 500, 62, 50, 500, 500, 500, 32, 40, 52, 92, 500, 500, 60, 32, 170, 500, 500, 500, 500, 36, 34, 74, 500, 42, 158, 40, 390, 500, 24, 30, 500, 500, 500, 78, 500, 36, 36, 34, 500, 500, 500, 500, 44, 500, 500, 500, 54, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4032534076156166, "mean_inference_ms": 1.2929738190840234, "mean_action_processing_ms": 0.15013201411994545, "mean_env_wait_ms": 0.09011380018502559, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01898360252380371, "StateBufferConnector_ms": 0.008992433547973633, "ViewRequirementAgentConnector_ms": 0.14400458335876465}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -3.9880000000002287, "episode_len_mean": 290.38, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.1, 42.10000000000001, -50.00000000000044, -50.00000000000044, 23.499999999999893, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 47.3, -50.00000000000044, -50.00000000000044, 41.90000000000001, 43.7, -50.00000000000044, 45.7, -50.00000000000044, 47.1, -50.00000000000044, 10.499999999999709, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, 45.9, 46.699999999999996, 46.699999999999996, 13.299999999999748, -50.00000000000044, 46.3, 44.5, -50.00000000000044, 46.099999999999994, 45.5, 47.9, -50.00000000000044, 33.70000000000004, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 41.100000000000016, -50.00000000000044, 45.9, -50.00000000000044, 43.900000000000006, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 46.099999999999994, 44.900000000000006, 40.90000000000002, -50.00000000000044, -50.00000000000044, 44.10000000000001, 46.9, 33.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 46.699999999999996, 42.70000000000001, -50.00000000000044, 45.9, 34.30000000000004, 46.099999999999994, 11.099999999999717, -50.00000000000044, 47.7, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 46.5, 46.5, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044], "episode_lengths": [50, 80, 500, 500, 266, 34, 500, 500, 500, 500, 500, 500, 500, 62, 28, 500, 500, 82, 64, 500, 44, 500, 30, 500, 396, 500, 500, 500, 102, 42, 34, 34, 368, 500, 38, 56, 500, 40, 46, 22, 500, 164, 500, 500, 88, 500, 500, 36, 500, 90, 500, 42, 500, 62, 50, 500, 500, 500, 32, 40, 52, 92, 500, 500, 60, 32, 170, 500, 500, 500, 500, 36, 34, 74, 500, 42, 158, 40, 390, 500, 24, 30, 500, 500, 500, 78, 500, 36, 36, 34, 500, 500, 500, 500, 44, 500, 500, 500, 54, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4032534076156166, "mean_inference_ms": 1.2929738190840234, "mean_action_processing_ms": 0.15013201411994545, "mean_env_wait_ms": 0.09011380018502559, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01898360252380371, "StateBufferConnector_ms": 0.008992433547973633, "ViewRequirementAgentConnector_ms": 0.14400458335876465}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000, "num_env_steps_sampled": 1488000, "num_env_steps_trained": 1488000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4917.209621314962, "num_env_steps_trained_throughput_per_sec": 4917.209621314962, "timesteps_total": 1488000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1488000, "timers": {"training_iteration_time_ms": 2401.753, "sample_time_ms": 2126.542, "load_time_ms": 12.232, "load_throughput": 980997.532, "learn_time_ms": 250.274, "learn_throughput": 47947.378, "synch_weights_time_ms": 11.134}, "counters": {"num_env_steps_sampled": 1488000, "num_env_steps_trained": 1488000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "done": false, "episodes_total": 5640, "training_iteration": 124, "trial_id": "9f288_00019", "date": "2023-10-25_17-11-22", "timestamp": 1698250282, "time_this_iter_s": 2.446171998977661, "time_total_s": 286.6344075202942, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 286.6344075202942, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 69.175, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.403954806578303e-39, "cur_lr": 0.0003, "total_loss": 5.8236614545186365, "policy_loss": -0.0005493870625893275, "vf_loss": 5.82425282796224, "vf_explained_var": -9.775161743164062e-07, "kl": 0.0004582361075639104, "entropy": 0.41859718163808185, "entropy_coeff": 0.00010000000000000002}, "model": {}, "num_grad_updates_lifetime": 1868.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1500000, "num_env_steps_trained": 1500000, "num_agent_steps_sampled": 1500000, "num_agent_steps_trained": 1500000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -2.9570000000002237, "episode_len_mean": 285.08, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 41.100000000000016, -50.00000000000044, 45.9, -50.00000000000044, 43.900000000000006, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 46.099999999999994, 44.900000000000006, 40.90000000000002, -50.00000000000044, -50.00000000000044, 44.10000000000001, 46.9, 33.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 46.699999999999996, 42.70000000000001, -50.00000000000044, 45.9, 34.30000000000004, 46.099999999999994, 11.099999999999717, -50.00000000000044, 47.7, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 46.5, 46.5, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 45.3, 46.3, -50.00000000000044, 43.900000000000006, 19.69999999999984, -50.00000000000044, -50.00000000000044, 44.5, 8.899999999999686, -50.00000000000044, 46.699999999999996, -50.00000000000044, 46.3, -50.00000000000044, 41.90000000000001, 36.10000000000004, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 47.3, -50.00000000000044, 47.1, -50.00000000000044, 45.3, 45.3, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 43.50000000000001, 47.1, 20.299999999999848, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 46.9, 39.300000000000026], "episode_lengths": [500, 500, 88, 500, 500, 36, 500, 90, 500, 42, 500, 62, 50, 500, 500, 500, 32, 40, 52, 92, 500, 500, 60, 32, 170, 500, 500, 500, 500, 36, 34, 74, 500, 42, 158, 40, 390, 500, 24, 30, 500, 500, 500, 78, 500, 36, 36, 34, 500, 500, 500, 500, 44, 500, 500, 500, 54, 500, 500, 48, 38, 500, 62, 304, 500, 500, 56, 412, 500, 34, 500, 38, 500, 82, 140, 34, 500, 500, 500, 500, 40, 28, 500, 30, 500, 48, 48, 500, 40, 500, 500, 66, 30, 298, 500, 500, 500, 36, 32, 108]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.403503282558632, "mean_inference_ms": 1.2940649308476173, "mean_action_processing_ms": 0.1501226305221464, "mean_env_wait_ms": 0.0903162252370783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03196263313293457, "StateBufferConnector_ms": 0.0050008296966552734, "ViewRequirementAgentConnector_ms": 0.14798569679260254}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -2.9570000000002237, "episode_len_mean": 285.08, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 41.100000000000016, -50.00000000000044, 45.9, -50.00000000000044, 43.900000000000006, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 46.099999999999994, 44.900000000000006, 40.90000000000002, -50.00000000000044, -50.00000000000044, 44.10000000000001, 46.9, 33.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 46.699999999999996, 42.70000000000001, -50.00000000000044, 45.9, 34.30000000000004, 46.099999999999994, 11.099999999999717, -50.00000000000044, 47.7, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 46.5, 46.5, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 45.3, 46.3, -50.00000000000044, 43.900000000000006, 19.69999999999984, -50.00000000000044, -50.00000000000044, 44.5, 8.899999999999686, -50.00000000000044, 46.699999999999996, -50.00000000000044, 46.3, -50.00000000000044, 41.90000000000001, 36.10000000000004, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 47.3, -50.00000000000044, 47.1, -50.00000000000044, 45.3, 45.3, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 43.50000000000001, 47.1, 20.299999999999848, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 46.9, 39.300000000000026], "episode_lengths": [500, 500, 88, 500, 500, 36, 500, 90, 500, 42, 500, 62, 50, 500, 500, 500, 32, 40, 52, 92, 500, 500, 60, 32, 170, 500, 500, 500, 500, 36, 34, 74, 500, 42, 158, 40, 390, 500, 24, 30, 500, 500, 500, 78, 500, 36, 36, 34, 500, 500, 500, 500, 44, 500, 500, 500, 54, 500, 500, 48, 38, 500, 62, 304, 500, 500, 56, 412, 500, 34, 500, 38, 500, 82, 140, 34, 500, 500, 500, 500, 40, 28, 500, 30, 500, 48, 48, 500, 40, 500, 500, 66, 30, 298, 500, 500, 500, 36, 32, 108]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.403503282558632, "mean_inference_ms": 1.2940649308476173, "mean_action_processing_ms": 0.1501226305221464, "mean_env_wait_ms": 0.0903162252370783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03196263313293457, "StateBufferConnector_ms": 0.0050008296966552734, "ViewRequirementAgentConnector_ms": 0.14798569679260254}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1500000, "num_agent_steps_trained": 1500000, "num_env_steps_sampled": 1500000, "num_env_steps_trained": 1500000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4569.064785819278, "num_env_steps_trained_throughput_per_sec": 4569.064785819278, "timesteps_total": 1500000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1500000, "timers": {"training_iteration_time_ms": 2420.195, "sample_time_ms": 2148.435, "load_time_ms": 11.2, "load_throughput": 1071428.681, "learn_time_ms": 247.659, "learn_throughput": 48453.783, "synch_weights_time_ms": 11.331}, "counters": {"num_env_steps_sampled": 1500000, "num_env_steps_trained": 1500000, "num_agent_steps_sampled": 1500000, "num_agent_steps_trained": 1500000}, "done": true, "episodes_total": 5682, "training_iteration": 125, "trial_id": "9f288_00019", "date": "2023-10-25_17-11-25", "timestamp": 1698250285, "time_this_iter_s": 2.6323561668395996, "time_total_s": 289.2667636871338, "pid": 19876, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 289.2667636871338, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 67.075, "ram_util_percent": 27.299999999999997}}
