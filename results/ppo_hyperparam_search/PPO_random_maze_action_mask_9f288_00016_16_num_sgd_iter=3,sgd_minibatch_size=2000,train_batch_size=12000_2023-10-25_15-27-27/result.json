{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0003, "total_loss": 9.437530623541939, "policy_loss": -0.001615922949794266, "vf_loss": 9.438819885253906, "vf_explained_var": 0.00016970766915215386, "kl": 0.0019965908618940396, "entropy": 0.7291540304819742, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 9.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "sampler_results": {"episode_reward_max": 40.30000000000002, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -38.05833333333373, "episode_len_mean": 464.0833333333333, "episode_media": {}, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.099999999999987, -50.00000000000044, -50.00000000000044, -50.00000000000044, 12.299999999999734, 3.899999999999615, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 200, 500, 500, 500, 378, 462, 500, 500, 500, 98, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3719392951790031, "mean_inference_ms": 1.1908726973252577, "mean_action_processing_ms": 0.13784976391406445, "mean_env_wait_ms": 0.0827752706252691, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03346304098765055, "StateBufferConnector_ms": 0.012501080830891928, "ViewRequirementAgentConnector_ms": 0.1375873883565267}}, "episode_reward_max": 40.30000000000002, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -38.05833333333373, "episode_len_mean": 464.0833333333333, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.099999999999987, -50.00000000000044, -50.00000000000044, -50.00000000000044, 12.299999999999734, 3.899999999999615, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 200, 500, 500, 500, 378, 462, 500, 500, 500, 98, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3719392951790031, "mean_inference_ms": 1.1908726973252577, "mean_action_processing_ms": 0.13784976391406445, "mean_env_wait_ms": 0.0827752706252691, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03346304098765055, "StateBufferConnector_ms": 0.012501080830891928, "ViewRequirementAgentConnector_ms": 0.1375873883565267}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5400.3143517372555, "num_env_steps_trained_throughput_per_sec": 5400.3143517372555, "timesteps_total": 12000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 2222.093, "sample_time_ms": 1894.26, "load_time_ms": 6.999, "load_throughput": 1714526.775, "learn_time_ms": 119.124, "learn_throughput": 100735.423, "synch_weights_time_ms": 198.711}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "episodes_total": 24, "training_iteration": 1, "trial_id": "9f288_00016", "date": "2023-10-25_16-51-35", "timestamp": 1698249095, "time_this_iter_s": 2.2269082069396973, "time_total_s": 2.2269082069396973, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 2.2269082069396973, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 54.25, "ram_util_percent": 26.975}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0003, "total_loss": 9.005939960479736, "policy_loss": -0.0020602643489837646, "vf_loss": 9.007840951283773, "vf_explained_var": 0.00010702013969421387, "kl": 0.002271580869736075, "entropy": 0.6770514647165934, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 27.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "sampler_results": {"episode_reward_max": 41.100000000000016, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -21.907547169811654, "episode_len_mean": 417.58490566037733, "episode_media": {}, "episodes_this_iter": 29, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.099999999999987, -50.00000000000044, -50.00000000000044, -50.00000000000044, 12.299999999999734, 3.899999999999615, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 22.299999999999876, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 11.499999999999723, -50.00000000000044, 10.499999999999709, 10.899999999999714, -50.00000000000044, 38.300000000000026, 2.0999999999995893, 3.899999999999615, 11.899999999999729, 36.900000000000034, -50.00000000000044, 21.09999999999986, 24.299999999999905, 21.499999999999865, 27.299999999999947, 22.899999999999885, 7.699999999999669, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.10000000000002], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 200, 500, 500, 500, 378, 462, 500, 500, 500, 98, 500, 500, 500, 500, 278, 500, 500, 500, 500, 500, 386, 500, 396, 392, 500, 118, 480, 462, 382, 132, 500, 290, 258, 286, 228, 272, 424, 500, 90, 500, 500, 500, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3773716741102111, "mean_inference_ms": 1.2003925674990819, "mean_action_processing_ms": 0.13728100911462518, "mean_env_wait_ms": 0.08184394929324694, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028363713678323996, "StateBufferConnector_ms": 0.009438226807792232, "ViewRequirementAgentConnector_ms": 0.15639134173123342}}, "episode_reward_max": 41.100000000000016, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -21.907547169811654, "episode_len_mean": 417.58490566037733, "episodes_this_iter": 29, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.099999999999987, -50.00000000000044, -50.00000000000044, -50.00000000000044, 12.299999999999734, 3.899999999999615, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 22.299999999999876, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 11.499999999999723, -50.00000000000044, 10.499999999999709, 10.899999999999714, -50.00000000000044, 38.300000000000026, 2.0999999999995893, 3.899999999999615, 11.899999999999729, 36.900000000000034, -50.00000000000044, 21.09999999999986, 24.299999999999905, 21.499999999999865, 27.299999999999947, 22.899999999999885, 7.699999999999669, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.10000000000002], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 200, 500, 500, 500, 378, 462, 500, 500, 500, 98, 500, 500, 500, 500, 278, 500, 500, 500, 500, 500, 386, 500, 396, 392, 500, 118, 480, 462, 382, 132, 500, 290, 258, 286, 228, 272, 424, 500, 90, 500, 500, 500, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3773716741102111, "mean_inference_ms": 1.2003925674990819, "mean_action_processing_ms": 0.13728100911462518, "mean_env_wait_ms": 0.08184394929324694, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028363713678323996, "StateBufferConnector_ms": 0.009438226807792232, "ViewRequirementAgentConnector_ms": 0.15639134173123342}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5779.925379047567, "num_env_steps_trained_throughput_per_sec": 5779.925379047567, "timesteps_total": 24000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 2149.122, "sample_time_ms": 1914.241, "load_time_ms": 7.384, "load_throughput": 1625200.536, "learn_time_ms": 121.536, "learn_throughput": 98736.357, "synch_weights_time_ms": 104.056}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "episodes_total": 53, "training_iteration": 2, "trial_id": "9f288_00016", "date": "2023-10-25_16-51-37", "timestamp": 1698249097, "time_this_iter_s": 2.082139253616333, "time_total_s": 4.30904746055603, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 4.30904746055603, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 62.06666666666666, "ram_util_percent": 27.03333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.05000000000000001, "cur_lr": 0.0003, "total_loss": 9.040461010403103, "policy_loss": -0.0012581969300905864, "vf_loss": 9.041702482435438, "vf_explained_var": -1.0904338624742297e-05, "kl": 0.0017415473814581775, "entropy": 0.7029000752502017, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 45.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "sampler_results": {"episode_reward_max": 44.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -8.572631578947627, "episode_len_mean": 359.9578947368421, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.099999999999987, -50.00000000000044, -50.00000000000044, -50.00000000000044, 12.299999999999734, 3.899999999999615, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 22.299999999999876, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 11.499999999999723, -50.00000000000044, 10.499999999999709, 10.899999999999714, -50.00000000000044, 38.300000000000026, 2.0999999999995893, 3.899999999999615, 11.899999999999729, 36.900000000000034, -50.00000000000044, 21.09999999999986, 24.299999999999905, 21.499999999999865, 27.299999999999947, 22.899999999999885, 7.699999999999669, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.10000000000002, 8.299999999999677, -50.00000000000044, 23.8999999999999, 28.699999999999967, -50.00000000000044, 34.10000000000004, -50.00000000000044, 14.499999999999766, 21.499999999999865, 2.0999999999995893, 23.699999999999896, -50.00000000000044, 14.899999999999771, 8.299999999999677, 37.90000000000003, 39.70000000000002, -50.00000000000044, 35.70000000000003, 38.10000000000002, 43.900000000000006, 43.7, 25.099999999999916, 44.5, 20.899999999999856, 32.90000000000003, -50.00000000000044, 12.899999999999743, -50.00000000000044, 34.900000000000034, 43.900000000000006, -50.00000000000044, -50.00000000000044, 27.49999999999995, 28.09999999999996, 36.70000000000003, 29.299999999999976, 39.10000000000002, 22.699999999999882, -50.00000000000044, 38.50000000000003, 40.70000000000002, -50.00000000000044], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 200, 500, 500, 500, 378, 462, 500, 500, 500, 98, 500, 500, 500, 500, 278, 500, 500, 500, 500, 500, 386, 500, 396, 392, 500, 118, 480, 462, 382, 132, 500, 290, 258, 286, 228, 272, 424, 500, 90, 500, 500, 500, 120, 418, 500, 262, 214, 500, 160, 500, 356, 286, 480, 264, 500, 352, 418, 122, 104, 500, 144, 120, 62, 64, 250, 56, 292, 172, 500, 372, 500, 152, 62, 500, 500, 226, 220, 134, 208, 110, 274, 500, 116, 94, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3781619900474227, "mean_inference_ms": 1.2038142670735665, "mean_action_processing_ms": 0.13723496490414522, "mean_env_wait_ms": 0.08079755805706051, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0263482645938271, "StateBufferConnector_ms": 0.01052806251927426, "ViewRequirementAgentConnector_ms": 0.14091767762836657}}, "episode_reward_max": 44.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -8.572631578947627, "episode_len_mean": 359.9578947368421, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.099999999999987, -50.00000000000044, -50.00000000000044, -50.00000000000044, 12.299999999999734, 3.899999999999615, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 22.299999999999876, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 11.499999999999723, -50.00000000000044, 10.499999999999709, 10.899999999999714, -50.00000000000044, 38.300000000000026, 2.0999999999995893, 3.899999999999615, 11.899999999999729, 36.900000000000034, -50.00000000000044, 21.09999999999986, 24.299999999999905, 21.499999999999865, 27.299999999999947, 22.899999999999885, 7.699999999999669, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.10000000000002, 8.299999999999677, -50.00000000000044, 23.8999999999999, 28.699999999999967, -50.00000000000044, 34.10000000000004, -50.00000000000044, 14.499999999999766, 21.499999999999865, 2.0999999999995893, 23.699999999999896, -50.00000000000044, 14.899999999999771, 8.299999999999677, 37.90000000000003, 39.70000000000002, -50.00000000000044, 35.70000000000003, 38.10000000000002, 43.900000000000006, 43.7, 25.099999999999916, 44.5, 20.899999999999856, 32.90000000000003, -50.00000000000044, 12.899999999999743, -50.00000000000044, 34.900000000000034, 43.900000000000006, -50.00000000000044, -50.00000000000044, 27.49999999999995, 28.09999999999996, 36.70000000000003, 29.299999999999976, 39.10000000000002, 22.699999999999882, -50.00000000000044, 38.50000000000003, 40.70000000000002, -50.00000000000044], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 200, 500, 500, 500, 378, 462, 500, 500, 500, 98, 500, 500, 500, 500, 278, 500, 500, 500, 500, 500, 386, 500, 396, 392, 500, 118, 480, 462, 382, 132, 500, 290, 258, 286, 228, 272, 424, 500, 90, 500, 500, 500, 120, 418, 500, 262, 214, 500, 160, 500, 356, 286, 480, 264, 500, 352, 418, 122, 104, 500, 144, 120, 62, 64, 250, 56, 292, 172, 500, 372, 500, 152, 62, 500, 500, 226, 220, 134, 208, 110, 274, 500, 116, 94, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3781619900474227, "mean_inference_ms": 1.2038142670735665, "mean_action_processing_ms": 0.13723496490414522, "mean_env_wait_ms": 0.08079755805706051, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0263482645938271, "StateBufferConnector_ms": 0.01052806251927426, "ViewRequirementAgentConnector_ms": 0.14091767762836657}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5678.238853676362, "num_env_steps_trained_throughput_per_sec": 5678.238853676362, "timesteps_total": 36000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 2137.192, "sample_time_ms": 1905.748, "load_time_ms": 8.808, "load_throughput": 1362376.786, "learn_time_ms": 148.327, "learn_throughput": 80902.226, "synch_weights_time_ms": 72.372}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "episodes_total": 95, "training_iteration": 3, "trial_id": "9f288_00016", "date": "2023-10-25_16-51-39", "timestamp": 1698249099, "time_this_iter_s": 2.118330478668213, "time_total_s": 6.427377939224243, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 6.427377939224243, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 60.56666666666667, "ram_util_percent": 27.133333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.0003, "total_loss": 9.095923582712809, "policy_loss": -0.00043183047738340165, "vf_loss": 9.096399784088135, "vf_explained_var": -1.7844968371921117e-05, "kl": 0.000576780490544277, "entropy": 0.5904249449570974, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 63.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "sampler_results": {"episode_reward_max": 45.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.441999999999851, "episode_len_mean": 266.32, "episode_media": {}, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.899999999999885, 7.699999999999669, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.10000000000002, 8.299999999999677, -50.00000000000044, 23.8999999999999, 28.699999999999967, -50.00000000000044, 34.10000000000004, -50.00000000000044, 14.499999999999766, 21.499999999999865, 2.0999999999995893, 23.699999999999896, -50.00000000000044, 14.899999999999771, 8.299999999999677, 37.90000000000003, 39.70000000000002, -50.00000000000044, 35.70000000000003, 38.10000000000002, 43.900000000000006, 43.7, 25.099999999999916, 44.5, 20.899999999999856, 32.90000000000003, -50.00000000000044, 12.899999999999743, -50.00000000000044, 34.900000000000034, 43.900000000000006, -50.00000000000044, -50.00000000000044, 27.49999999999995, 28.09999999999996, 36.70000000000003, 29.299999999999976, 39.10000000000002, 22.699999999999882, -50.00000000000044, 38.50000000000003, 40.70000000000002, -50.00000000000044, -50.00000000000044, 40.10000000000002, 35.10000000000004, 26.89999999999994, 37.10000000000003, 32.50000000000002, -50.00000000000044, 41.500000000000014, 24.499999999999908, 41.100000000000016, 45.7, 37.90000000000003, 39.50000000000002, 29.49999999999998, 14.499999999999766, 38.10000000000002, 34.30000000000004, 41.30000000000001, 40.10000000000002, 27.49999999999995, 30.499999999999993, 44.5, -50.00000000000044, -50.00000000000044, 36.30000000000003, 16.499999999999794, 33.70000000000004, -50.00000000000044, 39.50000000000002, 33.500000000000036, 45.5, 29.299999999999976, -50.00000000000044, 30.099999999999987, 32.90000000000003, 3.899999999999615, 40.70000000000002, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 16.8999999999998, 45.1, -50.00000000000044, 40.90000000000002, 18.29999999999982, -50.00000000000044, 43.900000000000006, 44.10000000000001, 39.90000000000002], "episode_lengths": [272, 424, 500, 90, 500, 500, 500, 120, 418, 500, 262, 214, 500, 160, 500, 356, 286, 480, 264, 500, 352, 418, 122, 104, 500, 144, 120, 62, 64, 250, 56, 292, 172, 500, 372, 500, 152, 62, 500, 500, 226, 220, 134, 208, 110, 274, 500, 116, 94, 500, 500, 100, 150, 232, 130, 176, 500, 86, 256, 90, 44, 122, 106, 206, 356, 120, 158, 88, 100, 226, 196, 56, 500, 500, 138, 336, 164, 500, 106, 166, 46, 208, 500, 200, 172, 462, 94, 500, 56, 500, 500, 332, 50, 500, 92, 318, 500, 62, 60, 102]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37657989846747436, "mean_inference_ms": 1.2055886108376195, "mean_action_processing_ms": 0.13686235357660823, "mean_env_wait_ms": 0.0799006338529894, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028997421264648438, "StateBufferConnector_ms": 0.010000467300415039, "ViewRequirementAgentConnector_ms": 0.13684964179992676}}, "episode_reward_max": 45.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.441999999999851, "episode_len_mean": 266.32, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [22.899999999999885, 7.699999999999669, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.10000000000002, 8.299999999999677, -50.00000000000044, 23.8999999999999, 28.699999999999967, -50.00000000000044, 34.10000000000004, -50.00000000000044, 14.499999999999766, 21.499999999999865, 2.0999999999995893, 23.699999999999896, -50.00000000000044, 14.899999999999771, 8.299999999999677, 37.90000000000003, 39.70000000000002, -50.00000000000044, 35.70000000000003, 38.10000000000002, 43.900000000000006, 43.7, 25.099999999999916, 44.5, 20.899999999999856, 32.90000000000003, -50.00000000000044, 12.899999999999743, -50.00000000000044, 34.900000000000034, 43.900000000000006, -50.00000000000044, -50.00000000000044, 27.49999999999995, 28.09999999999996, 36.70000000000003, 29.299999999999976, 39.10000000000002, 22.699999999999882, -50.00000000000044, 38.50000000000003, 40.70000000000002, -50.00000000000044, -50.00000000000044, 40.10000000000002, 35.10000000000004, 26.89999999999994, 37.10000000000003, 32.50000000000002, -50.00000000000044, 41.500000000000014, 24.499999999999908, 41.100000000000016, 45.7, 37.90000000000003, 39.50000000000002, 29.49999999999998, 14.499999999999766, 38.10000000000002, 34.30000000000004, 41.30000000000001, 40.10000000000002, 27.49999999999995, 30.499999999999993, 44.5, -50.00000000000044, -50.00000000000044, 36.30000000000003, 16.499999999999794, 33.70000000000004, -50.00000000000044, 39.50000000000002, 33.500000000000036, 45.5, 29.299999999999976, -50.00000000000044, 30.099999999999987, 32.90000000000003, 3.899999999999615, 40.70000000000002, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 16.8999999999998, 45.1, -50.00000000000044, 40.90000000000002, 18.29999999999982, -50.00000000000044, 43.900000000000006, 44.10000000000001, 39.90000000000002], "episode_lengths": [272, 424, 500, 90, 500, 500, 500, 120, 418, 500, 262, 214, 500, 160, 500, 356, 286, 480, 264, 500, 352, 418, 122, 104, 500, 144, 120, 62, 64, 250, 56, 292, 172, 500, 372, 500, 152, 62, 500, 500, 226, 220, 134, 208, 110, 274, 500, 116, 94, 500, 500, 100, 150, 232, 130, 176, 500, 86, 256, 90, 44, 122, 106, 206, 356, 120, 158, 88, 100, 226, 196, 56, 500, 500, 138, 336, 164, 500, 106, 166, 46, 208, 500, 200, 172, 462, 94, 500, 56, 500, 500, 332, 50, 500, 92, 318, 500, 62, 60, 102]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37657989846747436, "mean_inference_ms": 1.2055886108376195, "mean_action_processing_ms": 0.13686235357660823, "mean_env_wait_ms": 0.0799006338529894, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028997421264648438, "StateBufferConnector_ms": 0.010000467300415039, "ViewRequirementAgentConnector_ms": 0.13684964179992676}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5625.055656387744, "num_env_steps_trained_throughput_per_sec": 5625.055656387744, "timesteps_total": 48000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 2136.222, "sample_time_ms": 1893.85, "load_time_ms": 10.609, "load_throughput": 1131111.815, "learn_time_ms": 173.281, "learn_throughput": 69251.601, "synch_weights_time_ms": 56.529}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "episodes_total": 145, "training_iteration": 4, "trial_id": "9f288_00016", "date": "2023-10-25_16-51-41", "timestamp": 1698249101, "time_this_iter_s": 2.1383111476898193, "time_total_s": 8.565689086914062, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 8.565689086914062, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 57.26666666666667, "ram_util_percent": 27.133333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0003, "total_loss": 8.767146004570854, "policy_loss": -0.0006772946152422163, "vf_loss": 8.767872174580893, "vf_explained_var": -2.3874971601698135e-06, "kl": 0.0008215708590708144, "entropy": 0.5889607568581899, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 81.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "sampler_results": {"episode_reward_max": 45.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.441999999999862, "episode_len_mean": 246.3, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.699999999999882, -50.00000000000044, 38.50000000000003, 40.70000000000002, -50.00000000000044, -50.00000000000044, 40.10000000000002, 35.10000000000004, 26.89999999999994, 37.10000000000003, 32.50000000000002, -50.00000000000044, 41.500000000000014, 24.499999999999908, 41.100000000000016, 45.7, 37.90000000000003, 39.50000000000002, 29.49999999999998, 14.499999999999766, 38.10000000000002, 34.30000000000004, 41.30000000000001, 40.10000000000002, 27.49999999999995, 30.499999999999993, 44.5, -50.00000000000044, -50.00000000000044, 36.30000000000003, 16.499999999999794, 33.70000000000004, -50.00000000000044, 39.50000000000002, 33.500000000000036, 45.5, 29.299999999999976, -50.00000000000044, 30.099999999999987, 32.90000000000003, 3.899999999999615, 40.70000000000002, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 16.8999999999998, 45.1, -50.00000000000044, 40.90000000000002, 18.29999999999982, -50.00000000000044, 43.900000000000006, 44.10000000000001, 39.90000000000002, 31.900000000000013, 32.30000000000002, -50.00000000000044, 42.30000000000001, 38.90000000000002, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, 34.50000000000004, 44.5, 32.100000000000016, 43.30000000000001, 22.099999999999874, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 31.300000000000004, 43.900000000000006, -50.00000000000044, 41.30000000000001, 16.09999999999979, -50.00000000000044, 42.10000000000001, 45.5, -50.00000000000044, 36.70000000000003, -50.00000000000044, 40.500000000000014, 34.10000000000004, 42.70000000000001, 40.70000000000002, 41.500000000000014, 22.49999999999988, 41.30000000000001, 44.7, 35.70000000000003, -50.00000000000044, 16.29999999999979], "episode_lengths": [274, 500, 116, 94, 500, 500, 100, 150, 232, 130, 176, 500, 86, 256, 90, 44, 122, 106, 206, 356, 120, 158, 88, 100, 226, 196, 56, 500, 500, 138, 336, 164, 500, 106, 166, 46, 208, 500, 200, 172, 462, 94, 500, 56, 500, 500, 332, 50, 500, 92, 318, 500, 62, 60, 102, 182, 178, 500, 78, 112, 500, 118, 500, 500, 156, 56, 180, 68, 280, 500, 500, 78, 500, 86, 500, 500, 64, 500, 188, 62, 500, 88, 340, 500, 80, 46, 500, 134, 500, 96, 160, 74, 94, 86, 276, 88, 54, 144, 500, 338]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3747332292528821, "mean_inference_ms": 1.2032160855363367, "mean_action_processing_ms": 0.1372893123796649, "mean_env_wait_ms": 0.08019658365937117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028186798095703125, "StateBufferConnector_ms": 0.01151275634765625, "ViewRequirementAgentConnector_ms": 0.13051819801330566}}, "episode_reward_max": 45.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.441999999999862, "episode_len_mean": 246.3, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [22.699999999999882, -50.00000000000044, 38.50000000000003, 40.70000000000002, -50.00000000000044, -50.00000000000044, 40.10000000000002, 35.10000000000004, 26.89999999999994, 37.10000000000003, 32.50000000000002, -50.00000000000044, 41.500000000000014, 24.499999999999908, 41.100000000000016, 45.7, 37.90000000000003, 39.50000000000002, 29.49999999999998, 14.499999999999766, 38.10000000000002, 34.30000000000004, 41.30000000000001, 40.10000000000002, 27.49999999999995, 30.499999999999993, 44.5, -50.00000000000044, -50.00000000000044, 36.30000000000003, 16.499999999999794, 33.70000000000004, -50.00000000000044, 39.50000000000002, 33.500000000000036, 45.5, 29.299999999999976, -50.00000000000044, 30.099999999999987, 32.90000000000003, 3.899999999999615, 40.70000000000002, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 16.8999999999998, 45.1, -50.00000000000044, 40.90000000000002, 18.29999999999982, -50.00000000000044, 43.900000000000006, 44.10000000000001, 39.90000000000002, 31.900000000000013, 32.30000000000002, -50.00000000000044, 42.30000000000001, 38.90000000000002, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, 34.50000000000004, 44.5, 32.100000000000016, 43.30000000000001, 22.099999999999874, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 31.300000000000004, 43.900000000000006, -50.00000000000044, 41.30000000000001, 16.09999999999979, -50.00000000000044, 42.10000000000001, 45.5, -50.00000000000044, 36.70000000000003, -50.00000000000044, 40.500000000000014, 34.10000000000004, 42.70000000000001, 40.70000000000002, 41.500000000000014, 22.49999999999988, 41.30000000000001, 44.7, 35.70000000000003, -50.00000000000044, 16.29999999999979], "episode_lengths": [274, 500, 116, 94, 500, 500, 100, 150, 232, 130, 176, 500, 86, 256, 90, 44, 122, 106, 206, 356, 120, 158, 88, 100, 226, 196, 56, 500, 500, 138, 336, 164, 500, 106, 166, 46, 208, 500, 200, 172, 462, 94, 500, 56, 500, 500, 332, 50, 500, 92, 318, 500, 62, 60, 102, 182, 178, 500, 78, 112, 500, 118, 500, 500, 156, 56, 180, 68, 280, 500, 500, 78, 500, 86, 500, 500, 64, 500, 188, 62, 500, 88, 340, 500, 80, 46, 500, 134, 500, 96, 160, 74, 94, 86, 276, 88, 54, 144, 500, 338]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3747332292528821, "mean_inference_ms": 1.2032160855363367, "mean_action_processing_ms": 0.1372893123796649, "mean_env_wait_ms": 0.08019658365937117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028186798095703125, "StateBufferConnector_ms": 0.01151275634765625, "ViewRequirementAgentConnector_ms": 0.13051819801330566}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5562.583089262223, "num_env_steps_trained_throughput_per_sec": 5562.583089262223, "timesteps_total": 60000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 2140.232, "sample_time_ms": 1904.672, "load_time_ms": 10.087, "load_throughput": 1189642.859, "learn_time_ms": 176.687, "learn_throughput": 67916.546, "synch_weights_time_ms": 47.024}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "episodes_total": 190, "training_iteration": 5, "trial_id": "9f288_00016", "date": "2023-10-25_16-51-43", "timestamp": 1698249103, "time_this_iter_s": 2.16327166557312, "time_total_s": 10.728960752487183, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 10.728960752487183, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 59.833333333333336, "ram_util_percent": 27.133333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.006250000000000001, "cur_lr": 0.0003, "total_loss": 8.601507875654432, "policy_loss": -0.000779111695010215, "vf_loss": 8.602334764268663, "vf_explained_var": -2.8477774726019965e-07, "kl": 0.0013460478958601623, "entropy": 0.5623330705695682, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 99.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.916999999999852, "episode_len_mean": 236.52, "episode_media": {}, "episodes_this_iter": 57, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 42.30000000000001, 38.90000000000002, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, 34.50000000000004, 44.5, 32.100000000000016, 43.30000000000001, 22.099999999999874, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 31.300000000000004, 43.900000000000006, -50.00000000000044, 41.30000000000001, 16.09999999999979, -50.00000000000044, 42.10000000000001, 45.5, -50.00000000000044, 36.70000000000003, -50.00000000000044, 40.500000000000014, 34.10000000000004, 42.70000000000001, 40.70000000000002, 41.500000000000014, 22.49999999999988, 41.30000000000001, 44.7, 35.70000000000003, -50.00000000000044, 16.29999999999979, 43.30000000000001, -50.00000000000044, 33.90000000000004, 2.699999999999598, 31.1, 46.9, 43.10000000000001, 44.300000000000004, 43.7, 46.099999999999994, 45.3, 32.700000000000024, 42.900000000000006, 37.300000000000026, 43.50000000000001, -50.00000000000044, 40.10000000000002, 44.900000000000006, 29.49999999999998, 38.10000000000002, 46.5, 43.50000000000001, 43.10000000000001, 20.299999999999848, 45.9, 45.3, -50.00000000000044, -50.00000000000044, 36.900000000000034, -50.00000000000044, 29.099999999999973, -50.00000000000044, 12.499999999999737, 45.5, 41.90000000000001, 37.90000000000003, 45.1, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 46.699999999999996, 45.5, 30.499999999999993, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 45.1, 40.500000000000014, -50.00000000000044, -50.00000000000044, 34.30000000000004, 40.10000000000002], "episode_lengths": [500, 78, 112, 500, 118, 500, 500, 156, 56, 180, 68, 280, 500, 500, 78, 500, 86, 500, 500, 64, 500, 188, 62, 500, 88, 340, 500, 80, 46, 500, 134, 500, 96, 160, 74, 94, 86, 276, 88, 54, 144, 500, 338, 68, 500, 162, 474, 190, 32, 70, 58, 64, 40, 48, 174, 72, 128, 66, 500, 100, 52, 206, 120, 36, 66, 70, 298, 42, 48, 500, 500, 132, 500, 210, 500, 376, 46, 82, 122, 50, 62, 500, 500, 500, 42, 34, 46, 196, 500, 500, 500, 500, 42, 500, 50, 96, 500, 500, 158, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37578995690599415, "mean_inference_ms": 1.1965979002710194, "mean_action_processing_ms": 0.13756451281795934, "mean_env_wait_ms": 0.07978927496125801, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02467942237854004, "StateBufferConnector_ms": 0.009510993957519531, "ViewRequirementAgentConnector_ms": 0.12352967262268066}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.916999999999852, "episode_len_mean": 236.52, "episodes_this_iter": 57, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 42.30000000000001, 38.90000000000002, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, 34.50000000000004, 44.5, 32.100000000000016, 43.30000000000001, 22.099999999999874, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 31.300000000000004, 43.900000000000006, -50.00000000000044, 41.30000000000001, 16.09999999999979, -50.00000000000044, 42.10000000000001, 45.5, -50.00000000000044, 36.70000000000003, -50.00000000000044, 40.500000000000014, 34.10000000000004, 42.70000000000001, 40.70000000000002, 41.500000000000014, 22.49999999999988, 41.30000000000001, 44.7, 35.70000000000003, -50.00000000000044, 16.29999999999979, 43.30000000000001, -50.00000000000044, 33.90000000000004, 2.699999999999598, 31.1, 46.9, 43.10000000000001, 44.300000000000004, 43.7, 46.099999999999994, 45.3, 32.700000000000024, 42.900000000000006, 37.300000000000026, 43.50000000000001, -50.00000000000044, 40.10000000000002, 44.900000000000006, 29.49999999999998, 38.10000000000002, 46.5, 43.50000000000001, 43.10000000000001, 20.299999999999848, 45.9, 45.3, -50.00000000000044, -50.00000000000044, 36.900000000000034, -50.00000000000044, 29.099999999999973, -50.00000000000044, 12.499999999999737, 45.5, 41.90000000000001, 37.90000000000003, 45.1, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 46.699999999999996, 45.5, 30.499999999999993, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 45.1, 40.500000000000014, -50.00000000000044, -50.00000000000044, 34.30000000000004, 40.10000000000002], "episode_lengths": [500, 78, 112, 500, 118, 500, 500, 156, 56, 180, 68, 280, 500, 500, 78, 500, 86, 500, 500, 64, 500, 188, 62, 500, 88, 340, 500, 80, 46, 500, 134, 500, 96, 160, 74, 94, 86, 276, 88, 54, 144, 500, 338, 68, 500, 162, 474, 190, 32, 70, 58, 64, 40, 48, 174, 72, 128, 66, 500, 100, 52, 206, 120, 36, 66, 70, 298, 42, 48, 500, 500, 132, 500, 210, 500, 376, 46, 82, 122, 50, 62, 500, 500, 500, 42, 34, 46, 196, 500, 500, 500, 500, 42, 500, 50, 96, 500, 500, 158, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37578995690599415, "mean_inference_ms": 1.1965979002710194, "mean_action_processing_ms": 0.13756451281795934, "mean_env_wait_ms": 0.07978927496125801, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02467942237854004, "StateBufferConnector_ms": 0.009510993957519531, "ViewRequirementAgentConnector_ms": 0.12352967262268066}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5300.703497117567, "num_env_steps_trained_throughput_per_sec": 5300.703497117567, "timesteps_total": 72000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 2160.835, "sample_time_ms": 1906.74, "load_time_ms": 11.073, "load_throughput": 1083764.478, "learn_time_ms": 200.4, "learn_throughput": 59880.336, "synch_weights_time_ms": 40.821}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "episodes_total": 247, "training_iteration": 6, "trial_id": "9f288_00016", "date": "2023-10-25_16-51-46", "timestamp": 1698249106, "time_this_iter_s": 2.2688498497009277, "time_total_s": 12.99781060218811, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 12.99781060218811, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 57.93333333333334, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0031250000000000006, "cur_lr": 0.0003, "total_loss": 8.547634654574924, "policy_loss": -0.0003593478144870864, "vf_loss": 8.54804277420044, "vf_explained_var": -8.629428015814887e-06, "kl": 0.0005666068047452831, "entropy": 0.5061168505085839, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 117.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.510999999999846, "episode_len_mean": 230.58, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.3, 32.700000000000024, 42.900000000000006, 37.300000000000026, 43.50000000000001, -50.00000000000044, 40.10000000000002, 44.900000000000006, 29.49999999999998, 38.10000000000002, 46.5, 43.50000000000001, 43.10000000000001, 20.299999999999848, 45.9, 45.3, -50.00000000000044, -50.00000000000044, 36.900000000000034, -50.00000000000044, 29.099999999999973, -50.00000000000044, 12.499999999999737, 45.5, 41.90000000000001, 37.90000000000003, 45.1, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 46.699999999999996, 45.5, 30.499999999999993, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 45.1, 40.500000000000014, -50.00000000000044, -50.00000000000044, 34.30000000000004, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 9.8999999999997, 46.699999999999996, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.10000000000001, 45.7, 23.099999999999888, 37.70000000000003, 44.10000000000001, -50.00000000000044, 35.10000000000004, 44.300000000000004, 46.5, 39.300000000000026, -50.00000000000044, 8.899999999999686, 43.50000000000001, 44.5, -50.00000000000044, 18.499999999999822, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 46.5, 14.09999999999976, 44.7, 46.5, 44.5, -50.00000000000044, -50.00000000000044, 35.10000000000004, -50.00000000000044, 44.5, 21.89999999999987, 46.5, 42.500000000000014, 45.7, 43.50000000000001, -50.00000000000044, 45.7, 43.30000000000001, 46.099999999999994, 41.30000000000001, 41.30000000000001, 46.099999999999994, -50.00000000000044, 46.5, 23.699999999999896], "episode_lengths": [48, 174, 72, 128, 66, 500, 100, 52, 206, 120, 36, 66, 70, 298, 42, 48, 500, 500, 132, 500, 210, 500, 376, 46, 82, 122, 50, 62, 500, 500, 500, 42, 34, 46, 196, 500, 500, 500, 500, 42, 500, 50, 96, 500, 500, 158, 100, 500, 500, 500, 402, 34, 40, 500, 500, 60, 44, 270, 124, 60, 500, 150, 58, 36, 108, 500, 412, 66, 56, 500, 316, 500, 500, 500, 32, 36, 360, 54, 36, 56, 500, 500, 150, 500, 56, 282, 36, 76, 44, 66, 500, 44, 68, 40, 88, 88, 40, 500, 36, 264]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3768174144099572, "mean_inference_ms": 1.192740462569472, "mean_action_processing_ms": 0.13828389499723523, "mean_env_wait_ms": 0.08054393497995901, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016002416610717773, "StateBufferConnector_ms": 0.005995988845825195, "ViewRequirementAgentConnector_ms": 0.11600685119628906}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.510999999999846, "episode_len_mean": 230.58, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.3, 32.700000000000024, 42.900000000000006, 37.300000000000026, 43.50000000000001, -50.00000000000044, 40.10000000000002, 44.900000000000006, 29.49999999999998, 38.10000000000002, 46.5, 43.50000000000001, 43.10000000000001, 20.299999999999848, 45.9, 45.3, -50.00000000000044, -50.00000000000044, 36.900000000000034, -50.00000000000044, 29.099999999999973, -50.00000000000044, 12.499999999999737, 45.5, 41.90000000000001, 37.90000000000003, 45.1, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 46.699999999999996, 45.5, 30.499999999999993, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 45.1, 40.500000000000014, -50.00000000000044, -50.00000000000044, 34.30000000000004, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 9.8999999999997, 46.699999999999996, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.10000000000001, 45.7, 23.099999999999888, 37.70000000000003, 44.10000000000001, -50.00000000000044, 35.10000000000004, 44.300000000000004, 46.5, 39.300000000000026, -50.00000000000044, 8.899999999999686, 43.50000000000001, 44.5, -50.00000000000044, 18.499999999999822, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 46.5, 14.09999999999976, 44.7, 46.5, 44.5, -50.00000000000044, -50.00000000000044, 35.10000000000004, -50.00000000000044, 44.5, 21.89999999999987, 46.5, 42.500000000000014, 45.7, 43.50000000000001, -50.00000000000044, 45.7, 43.30000000000001, 46.099999999999994, 41.30000000000001, 41.30000000000001, 46.099999999999994, -50.00000000000044, 46.5, 23.699999999999896], "episode_lengths": [48, 174, 72, 128, 66, 500, 100, 52, 206, 120, 36, 66, 70, 298, 42, 48, 500, 500, 132, 500, 210, 500, 376, 46, 82, 122, 50, 62, 500, 500, 500, 42, 34, 46, 196, 500, 500, 500, 500, 42, 500, 50, 96, 500, 500, 158, 100, 500, 500, 500, 402, 34, 40, 500, 500, 60, 44, 270, 124, 60, 500, 150, 58, 36, 108, 500, 412, 66, 56, 500, 316, 500, 500, 500, 32, 36, 360, 54, 36, 56, 500, 500, 150, 500, 56, 282, 36, 76, 44, 66, 500, 44, 68, 40, 88, 88, 40, 500, 36, 264]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3768174144099572, "mean_inference_ms": 1.192740462569472, "mean_action_processing_ms": 0.13828389499723523, "mean_env_wait_ms": 0.08054393497995901, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016002416610717773, "StateBufferConnector_ms": 0.005995988845825195, "ViewRequirementAgentConnector_ms": 0.11600685119628906}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5275.579802140266, "num_env_steps_trained_throughput_per_sec": 5275.579802140266, "timesteps_total": 84000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 2177.092, "sample_time_ms": 1908.983, "load_time_ms": 11.635, "load_throughput": 1031395.287, "learn_time_ms": 217.797, "learn_throughput": 55097.245, "synch_weights_time_ms": 36.847}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "episodes_total": 300, "training_iteration": 7, "trial_id": "9f288_00016", "date": "2023-10-25_16-51-48", "timestamp": 1698249108, "time_this_iter_s": 2.281629800796509, "time_total_s": 15.27944040298462, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 15.27944040298462, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 59.166666666666664, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0015625000000000003, "cur_lr": 0.0003, "total_loss": 8.22429625193278, "policy_loss": -0.0005398798320028516, "vf_loss": 8.224883291456434, "vf_explained_var": -2.466970019870334e-06, "kl": 0.00039747484690148366, "entropy": 0.4787301818529765, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 135.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.100999999999811, "episode_len_mean": 264.6, "episode_media": {}, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 45.1, 40.500000000000014, -50.00000000000044, -50.00000000000044, 34.30000000000004, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 9.8999999999997, 46.699999999999996, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.10000000000001, 45.7, 23.099999999999888, 37.70000000000003, 44.10000000000001, -50.00000000000044, 35.10000000000004, 44.300000000000004, 46.5, 39.300000000000026, -50.00000000000044, 8.899999999999686, 43.50000000000001, 44.5, -50.00000000000044, 18.499999999999822, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 46.5, 14.09999999999976, 44.7, 46.5, 44.5, -50.00000000000044, -50.00000000000044, 35.10000000000004, -50.00000000000044, 44.5, 21.89999999999987, 46.5, 42.500000000000014, 45.7, 43.50000000000001, -50.00000000000044, 45.7, 43.30000000000001, 46.099999999999994, 41.30000000000001, 41.30000000000001, 46.099999999999994, -50.00000000000044, 46.5, 23.699999999999896, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 45.5, 43.7, 42.900000000000006, 27.099999999999945, 43.50000000000001, 14.699999999999768, -50.00000000000044, -50.00000000000044, 45.7, 46.3, 34.900000000000034, 43.900000000000006, 35.500000000000036, -50.00000000000044, 26.09999999999993, 17.499999999999808, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 44.5, 26.69999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9], "episode_lengths": [500, 500, 42, 500, 50, 96, 500, 500, 158, 100, 500, 500, 500, 402, 34, 40, 500, 500, 60, 44, 270, 124, 60, 500, 150, 58, 36, 108, 500, 412, 66, 56, 500, 316, 500, 500, 500, 32, 36, 360, 54, 36, 56, 500, 500, 150, 500, 56, 282, 36, 76, 44, 66, 500, 44, 68, 40, 88, 88, 40, 500, 36, 264, 500, 500, 38, 500, 500, 46, 64, 72, 230, 66, 354, 500, 500, 44, 38, 152, 62, 146, 500, 240, 326, 500, 500, 500, 500, 500, 50, 500, 500, 66, 500, 56, 234, 500, 500, 500, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37632818308636024, "mean_inference_ms": 1.1944361337134715, "mean_action_processing_ms": 0.1380907367406371, "mean_env_wait_ms": 0.08055221870386403, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018999338150024414, "StateBufferConnector_ms": 0.007994651794433594, "ViewRequirementAgentConnector_ms": 0.10986089706420898}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.100999999999811, "episode_len_mean": 264.6, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 45.1, 40.500000000000014, -50.00000000000044, -50.00000000000044, 34.30000000000004, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 9.8999999999997, 46.699999999999996, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.10000000000001, 45.7, 23.099999999999888, 37.70000000000003, 44.10000000000001, -50.00000000000044, 35.10000000000004, 44.300000000000004, 46.5, 39.300000000000026, -50.00000000000044, 8.899999999999686, 43.50000000000001, 44.5, -50.00000000000044, 18.499999999999822, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 46.5, 14.09999999999976, 44.7, 46.5, 44.5, -50.00000000000044, -50.00000000000044, 35.10000000000004, -50.00000000000044, 44.5, 21.89999999999987, 46.5, 42.500000000000014, 45.7, 43.50000000000001, -50.00000000000044, 45.7, 43.30000000000001, 46.099999999999994, 41.30000000000001, 41.30000000000001, 46.099999999999994, -50.00000000000044, 46.5, 23.699999999999896, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 45.5, 43.7, 42.900000000000006, 27.099999999999945, 43.50000000000001, 14.699999999999768, -50.00000000000044, -50.00000000000044, 45.7, 46.3, 34.900000000000034, 43.900000000000006, 35.500000000000036, -50.00000000000044, 26.09999999999993, 17.499999999999808, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 44.5, 26.69999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9], "episode_lengths": [500, 500, 42, 500, 50, 96, 500, 500, 158, 100, 500, 500, 500, 402, 34, 40, 500, 500, 60, 44, 270, 124, 60, 500, 150, 58, 36, 108, 500, 412, 66, 56, 500, 316, 500, 500, 500, 32, 36, 360, 54, 36, 56, 500, 500, 150, 500, 56, 282, 36, 76, 44, 66, 500, 44, 68, 40, 88, 88, 40, 500, 36, 264, 500, 500, 38, 500, 500, 46, 64, 72, 230, 66, 354, 500, 500, 44, 38, 152, 62, 146, 500, 240, 326, 500, 500, 500, 500, 500, 50, 500, 500, 66, 500, 56, 234, 500, 500, 500, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37632818308636024, "mean_inference_ms": 1.1944361337134715, "mean_action_processing_ms": 0.1380907367406371, "mean_env_wait_ms": 0.08055221870386403, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018999338150024414, "StateBufferConnector_ms": 0.007994651794433594, "ViewRequirementAgentConnector_ms": 0.10986089706420898}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5760.39575472848, "num_env_steps_trained_throughput_per_sec": 5760.39575472848, "timesteps_total": 96000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 2165.354, "sample_time_ms": 1910.323, "load_time_ms": 11.056, "load_throughput": 1085365.363, "learn_time_ms": 208.757, "learn_throughput": 57482.992, "synch_weights_time_ms": 33.491}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "episodes_total": 337, "training_iteration": 8, "trial_id": "9f288_00016", "date": "2023-10-25_16-51-50", "timestamp": 1698249110, "time_this_iter_s": 2.0891852378845215, "time_total_s": 17.36862564086914, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 17.36862564086914, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 57.5, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0007812500000000002, "cur_lr": 0.0003, "total_loss": 7.880458407931858, "policy_loss": 8.254415459103055e-06, "vf_loss": 7.8805009788937035, "vf_explained_var": -1.0199016994900173e-06, "kl": 0.00017396692042679105, "entropy": 0.5083822574880388, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 153.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.9039999999998076, "episode_len_mean": 271.56, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 35.10000000000004, -50.00000000000044, 44.5, 21.89999999999987, 46.5, 42.500000000000014, 45.7, 43.50000000000001, -50.00000000000044, 45.7, 43.30000000000001, 46.099999999999994, 41.30000000000001, 41.30000000000001, 46.099999999999994, -50.00000000000044, 46.5, 23.699999999999896, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 45.5, 43.7, 42.900000000000006, 27.099999999999945, 43.50000000000001, 14.699999999999768, -50.00000000000044, -50.00000000000044, 45.7, 46.3, 34.900000000000034, 43.900000000000006, 35.500000000000036, -50.00000000000044, 26.09999999999993, 17.499999999999808, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 44.5, 26.69999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 41.30000000000001, 45.7, -50.00000000000044, 41.500000000000014, 43.900000000000006, 44.7, 39.50000000000002, -50.00000000000044, 33.10000000000003, -50.00000000000044, 45.1, -50.00000000000044, 15.899999999999785, 6.299999999999649, -50.00000000000044, 39.300000000000026, 39.50000000000002, 46.9, 38.700000000000024, -50.00000000000044, 11.499999999999723, -50.00000000000044, -50.00000000000044, 39.70000000000002, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.30000000000002, 30.9, 46.699999999999996, 46.9, 43.7, 47.1, 9.299999999999692, -50.00000000000044], "episode_lengths": [500, 150, 500, 56, 282, 36, 76, 44, 66, 500, 44, 68, 40, 88, 88, 40, 500, 36, 264, 500, 500, 38, 500, 500, 46, 64, 72, 230, 66, 354, 500, 500, 44, 38, 152, 62, 146, 500, 240, 326, 500, 500, 500, 500, 500, 50, 500, 500, 66, 500, 56, 234, 500, 500, 500, 42, 500, 88, 44, 500, 86, 62, 54, 106, 500, 170, 500, 50, 500, 342, 438, 500, 108, 106, 32, 114, 500, 386, 500, 500, 104, 94, 500, 500, 500, 500, 30, 100, 500, 500, 500, 500, 178, 192, 34, 32, 64, 30, 408, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3745844829082257, "mean_inference_ms": 1.1952066925232576, "mean_action_processing_ms": 0.13707662821172398, "mean_env_wait_ms": 0.08031750609583974, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01799774169921875, "StateBufferConnector_ms": 0.005995750427246094, "ViewRequirementAgentConnector_ms": 0.1348567008972168}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.9039999999998076, "episode_len_mean": 271.56, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 35.10000000000004, -50.00000000000044, 44.5, 21.89999999999987, 46.5, 42.500000000000014, 45.7, 43.50000000000001, -50.00000000000044, 45.7, 43.30000000000001, 46.099999999999994, 41.30000000000001, 41.30000000000001, 46.099999999999994, -50.00000000000044, 46.5, 23.699999999999896, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 45.5, 43.7, 42.900000000000006, 27.099999999999945, 43.50000000000001, 14.699999999999768, -50.00000000000044, -50.00000000000044, 45.7, 46.3, 34.900000000000034, 43.900000000000006, 35.500000000000036, -50.00000000000044, 26.09999999999993, 17.499999999999808, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 44.5, 26.69999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 41.30000000000001, 45.7, -50.00000000000044, 41.500000000000014, 43.900000000000006, 44.7, 39.50000000000002, -50.00000000000044, 33.10000000000003, -50.00000000000044, 45.1, -50.00000000000044, 15.899999999999785, 6.299999999999649, -50.00000000000044, 39.300000000000026, 39.50000000000002, 46.9, 38.700000000000024, -50.00000000000044, 11.499999999999723, -50.00000000000044, -50.00000000000044, 39.70000000000002, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.30000000000002, 30.9, 46.699999999999996, 46.9, 43.7, 47.1, 9.299999999999692, -50.00000000000044], "episode_lengths": [500, 150, 500, 56, 282, 36, 76, 44, 66, 500, 44, 68, 40, 88, 88, 40, 500, 36, 264, 500, 500, 38, 500, 500, 46, 64, 72, 230, 66, 354, 500, 500, 44, 38, 152, 62, 146, 500, 240, 326, 500, 500, 500, 500, 500, 50, 500, 500, 66, 500, 56, 234, 500, 500, 500, 42, 500, 88, 44, 500, 86, 62, 54, 106, 500, 170, 500, 50, 500, 342, 438, 500, 108, 106, 32, 114, 500, 386, 500, 500, 104, 94, 500, 500, 500, 500, 30, 100, 500, 500, 500, 500, 178, 192, 34, 32, 64, 30, 408, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3745844829082257, "mean_inference_ms": 1.1952066925232576, "mean_action_processing_ms": 0.13707662821172398, "mean_env_wait_ms": 0.08031750609583974, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01799774169921875, "StateBufferConnector_ms": 0.005995750427246094, "ViewRequirementAgentConnector_ms": 0.1348567008972168}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5323.226901542353, "num_env_steps_trained_throughput_per_sec": 5323.226901542353, "timesteps_total": 108000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 2175.234, "sample_time_ms": 1912.303, "load_time_ms": 11.613, "load_throughput": 1033350.82, "learn_time_ms": 218.794, "learn_throughput": 54846.217, "synch_weights_time_ms": 30.878}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "done": false, "episodes_total": 381, "training_iteration": 9, "trial_id": "9f288_00016", "date": "2023-10-25_16-51-52", "timestamp": 1698249112, "time_this_iter_s": 2.259275436401367, "time_total_s": 19.627901077270508, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 19.627901077270508, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 59.199999999999996, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0003906250000000001, "cur_lr": 0.0003, "total_loss": 6.903908676571316, "policy_loss": -0.0001305923279788759, "vf_loss": 6.904087993833754, "vf_explained_var": -3.907415601942274e-07, "kl": 0.00037044326698618433, "entropy": 0.4893189917008082, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 171.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.0799999999998016, "episode_len_mean": 279.8, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 44.5, 26.69999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 41.30000000000001, 45.7, -50.00000000000044, 41.500000000000014, 43.900000000000006, 44.7, 39.50000000000002, -50.00000000000044, 33.10000000000003, -50.00000000000044, 45.1, -50.00000000000044, 15.899999999999785, 6.299999999999649, -50.00000000000044, 39.300000000000026, 39.50000000000002, 46.9, 38.700000000000024, -50.00000000000044, 11.499999999999723, -50.00000000000044, -50.00000000000044, 39.70000000000002, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.30000000000002, 30.9, 46.699999999999996, 46.9, 43.7, 47.1, 9.299999999999692, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 33.70000000000004, 16.09999999999979, 39.90000000000002, 43.50000000000001, 46.5, 2.499999999999595, -50.00000000000044, 40.70000000000002, 15.49999999999978, 42.30000000000001, -50.00000000000044, 42.500000000000014, 45.9, 0.09999999999956088, 44.7, -50.00000000000044, 34.10000000000004, 39.10000000000002, 46.3, 36.70000000000003, -50.00000000000044, 45.1, 25.699999999999925, -50.00000000000044, 36.900000000000034, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 46.099999999999994, 32.50000000000002, 26.89999999999994, 45.5, 39.300000000000026, -50.00000000000044, -50.00000000000044, 42.500000000000014], "episode_lengths": [500, 500, 50, 500, 500, 66, 500, 56, 234, 500, 500, 500, 42, 500, 88, 44, 500, 86, 62, 54, 106, 500, 170, 500, 50, 500, 342, 438, 500, 108, 106, 32, 114, 500, 386, 500, 500, 104, 94, 500, 500, 500, 500, 30, 100, 500, 500, 500, 500, 178, 192, 34, 32, 64, 30, 408, 500, 500, 82, 500, 500, 164, 340, 102, 66, 36, 476, 500, 94, 346, 78, 500, 76, 42, 500, 54, 500, 160, 110, 38, 134, 500, 50, 244, 500, 132, 500, 38, 500, 500, 40, 500, 40, 176, 232, 46, 108, 500, 500, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37409254976526035, "mean_inference_ms": 1.1977276528476, "mean_action_processing_ms": 0.13692111234717505, "mean_env_wait_ms": 0.08056913765683625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01698780059814453, "StateBufferConnector_ms": 0.004999876022338867, "ViewRequirementAgentConnector_ms": 0.14200139045715332}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.0799999999998016, "episode_len_mean": 279.8, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 44.5, 26.69999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 41.30000000000001, 45.7, -50.00000000000044, 41.500000000000014, 43.900000000000006, 44.7, 39.50000000000002, -50.00000000000044, 33.10000000000003, -50.00000000000044, 45.1, -50.00000000000044, 15.899999999999785, 6.299999999999649, -50.00000000000044, 39.300000000000026, 39.50000000000002, 46.9, 38.700000000000024, -50.00000000000044, 11.499999999999723, -50.00000000000044, -50.00000000000044, 39.70000000000002, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.30000000000002, 30.9, 46.699999999999996, 46.9, 43.7, 47.1, 9.299999999999692, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 33.70000000000004, 16.09999999999979, 39.90000000000002, 43.50000000000001, 46.5, 2.499999999999595, -50.00000000000044, 40.70000000000002, 15.49999999999978, 42.30000000000001, -50.00000000000044, 42.500000000000014, 45.9, 0.09999999999956088, 44.7, -50.00000000000044, 34.10000000000004, 39.10000000000002, 46.3, 36.70000000000003, -50.00000000000044, 45.1, 25.699999999999925, -50.00000000000044, 36.900000000000034, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 46.099999999999994, 32.50000000000002, 26.89999999999994, 45.5, 39.300000000000026, -50.00000000000044, -50.00000000000044, 42.500000000000014], "episode_lengths": [500, 500, 50, 500, 500, 66, 500, 56, 234, 500, 500, 500, 42, 500, 88, 44, 500, 86, 62, 54, 106, 500, 170, 500, 50, 500, 342, 438, 500, 108, 106, 32, 114, 500, 386, 500, 500, 104, 94, 500, 500, 500, 500, 30, 100, 500, 500, 500, 500, 178, 192, 34, 32, 64, 30, 408, 500, 500, 82, 500, 500, 164, 340, 102, 66, 36, 476, 500, 94, 346, 78, 500, 76, 42, 500, 54, 500, 160, 110, 38, 134, 500, 50, 244, 500, 132, 500, 38, 500, 500, 40, 500, 40, 176, 232, 46, 108, 500, 500, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37409254976526035, "mean_inference_ms": 1.1977276528476, "mean_action_processing_ms": 0.13692111234717505, "mean_env_wait_ms": 0.08056913765683625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01698780059814453, "StateBufferConnector_ms": 0.004999876022338867, "ViewRequirementAgentConnector_ms": 0.14200139045715332}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5728.849338016881, "num_env_steps_trained_throughput_per_sec": 5728.849338016881, "timesteps_total": 120000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 2167.177, "sample_time_ms": 1910.915, "load_time_ms": 11.551, "load_throughput": 1038841.192, "learn_time_ms": 214.416, "learn_throughput": 55965.991, "synch_weights_time_ms": 28.712}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "episodes_total": 424, "training_iteration": 10, "trial_id": "9f288_00016", "date": "2023-10-25_16-51-54", "timestamp": 1698249114, "time_this_iter_s": 2.0996596813201904, "time_total_s": 21.7275607585907, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 21.7275607585907, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 55.800000000000004, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.00019531250000000004, "cur_lr": 0.0003, "total_loss": 7.041986174053616, "policy_loss": -5.356926057073805e-05, "vf_loss": 7.042084614435832, "vf_explained_var": -2.4967723422580293e-06, "kl": 3.312332010807495e-05, "entropy": 0.44916049970520866, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 189.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 14.226999999999856, "episode_len_mean": 223.46, "episode_media": {}, "episodes_this_iter": 62, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.09999999999979, 39.90000000000002, 43.50000000000001, 46.5, 2.499999999999595, -50.00000000000044, 40.70000000000002, 15.49999999999978, 42.30000000000001, -50.00000000000044, 42.500000000000014, 45.9, 0.09999999999956088, 44.7, -50.00000000000044, 34.10000000000004, 39.10000000000002, 46.3, 36.70000000000003, -50.00000000000044, 45.1, 25.699999999999925, -50.00000000000044, 36.900000000000034, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 46.099999999999994, 32.50000000000002, 26.89999999999994, 45.5, 39.300000000000026, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 46.9, 24.299999999999905, 46.9, -50.00000000000044, 43.7, 2.8999999999996007, -50.00000000000044, -50.00000000000044, 21.09999999999986, 44.300000000000004, 37.50000000000003, 33.70000000000004, -50.00000000000044, 41.90000000000001, 45.1, 42.500000000000014, 33.90000000000004, -50.00000000000044, 42.30000000000001, -50.00000000000044, 32.700000000000024, 41.70000000000002, 35.30000000000004, -50.00000000000044, 46.9, -50.00000000000044, 44.10000000000001, -50.00000000000044, 45.7, 45.5, 46.5, 47.3, -50.00000000000044, 29.099999999999973, 33.90000000000004, 44.10000000000001, 22.699999999999882, 12.69999999999974, 46.5, 47.3, 45.9, -50.00000000000044, 45.5, 46.099999999999994, 44.900000000000006, -50.00000000000044, -50.00000000000044, 43.10000000000001, 46.9, 42.30000000000001, -50.00000000000044, 42.500000000000014, 24.69999999999991, 45.5, 22.49999999999988, -50.00000000000044, 47.1, 47.1, 40.10000000000002, 44.10000000000001, 46.099999999999994], "episode_lengths": [340, 102, 66, 36, 476, 500, 94, 346, 78, 500, 76, 42, 500, 54, 500, 160, 110, 38, 134, 500, 50, 244, 500, 132, 500, 38, 500, 500, 40, 500, 40, 176, 232, 46, 108, 500, 500, 76, 500, 32, 258, 32, 500, 64, 472, 500, 500, 290, 58, 126, 164, 500, 82, 50, 76, 162, 500, 78, 500, 174, 84, 148, 500, 32, 500, 60, 500, 44, 46, 36, 28, 500, 210, 162, 60, 274, 374, 36, 28, 42, 500, 46, 40, 52, 500, 500, 70, 32, 78, 500, 76, 254, 46, 276, 500, 30, 30, 100, 60, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37469112851019554, "mean_inference_ms": 1.1978846257570295, "mean_action_processing_ms": 0.13693510007720577, "mean_env_wait_ms": 0.0804166547223875, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024981260299682617, "StateBufferConnector_ms": 0.002000570297241211, "ViewRequirementAgentConnector_ms": 0.12001538276672363}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 14.226999999999856, "episode_len_mean": 223.46, "episodes_this_iter": 62, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [16.09999999999979, 39.90000000000002, 43.50000000000001, 46.5, 2.499999999999595, -50.00000000000044, 40.70000000000002, 15.49999999999978, 42.30000000000001, -50.00000000000044, 42.500000000000014, 45.9, 0.09999999999956088, 44.7, -50.00000000000044, 34.10000000000004, 39.10000000000002, 46.3, 36.70000000000003, -50.00000000000044, 45.1, 25.699999999999925, -50.00000000000044, 36.900000000000034, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 46.099999999999994, 32.50000000000002, 26.89999999999994, 45.5, 39.300000000000026, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 46.9, 24.299999999999905, 46.9, -50.00000000000044, 43.7, 2.8999999999996007, -50.00000000000044, -50.00000000000044, 21.09999999999986, 44.300000000000004, 37.50000000000003, 33.70000000000004, -50.00000000000044, 41.90000000000001, 45.1, 42.500000000000014, 33.90000000000004, -50.00000000000044, 42.30000000000001, -50.00000000000044, 32.700000000000024, 41.70000000000002, 35.30000000000004, -50.00000000000044, 46.9, -50.00000000000044, 44.10000000000001, -50.00000000000044, 45.7, 45.5, 46.5, 47.3, -50.00000000000044, 29.099999999999973, 33.90000000000004, 44.10000000000001, 22.699999999999882, 12.69999999999974, 46.5, 47.3, 45.9, -50.00000000000044, 45.5, 46.099999999999994, 44.900000000000006, -50.00000000000044, -50.00000000000044, 43.10000000000001, 46.9, 42.30000000000001, -50.00000000000044, 42.500000000000014, 24.69999999999991, 45.5, 22.49999999999988, -50.00000000000044, 47.1, 47.1, 40.10000000000002, 44.10000000000001, 46.099999999999994], "episode_lengths": [340, 102, 66, 36, 476, 500, 94, 346, 78, 500, 76, 42, 500, 54, 500, 160, 110, 38, 134, 500, 50, 244, 500, 132, 500, 38, 500, 500, 40, 500, 40, 176, 232, 46, 108, 500, 500, 76, 500, 32, 258, 32, 500, 64, 472, 500, 500, 290, 58, 126, 164, 500, 82, 50, 76, 162, 500, 78, 500, 174, 84, 148, 500, 32, 500, 60, 500, 44, 46, 36, 28, 500, 210, 162, 60, 274, 374, 36, 28, 42, 500, 46, 40, 52, 500, 500, 70, 32, 78, 500, 76, 254, 46, 276, 500, 30, 30, 100, 60, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37469112851019554, "mean_inference_ms": 1.1978846257570295, "mean_action_processing_ms": 0.13693510007720577, "mean_env_wait_ms": 0.0804166547223875, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024981260299682617, "StateBufferConnector_ms": 0.002000570297241211, "ViewRequirementAgentConnector_ms": 0.12001538276672363}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5339.609812805754, "num_env_steps_trained_throughput_per_sec": 5339.609812805754, "timesteps_total": 132000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 132000, "timers": {"training_iteration_time_ms": 2169.703, "sample_time_ms": 1910.541, "load_time_ms": 12.351, "load_throughput": 971544.653, "learn_time_ms": 235.535, "learn_throughput": 50947.837, "synch_weights_time_ms": 9.693}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "done": false, "episodes_total": 486, "training_iteration": 11, "trial_id": "9f288_00016", "date": "2023-10-25_16-51-57", "timestamp": 1698249117, "time_this_iter_s": 2.2523539066314697, "time_total_s": 23.979914665222168, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 23.979914665222168, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 59.9, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.765625000000002e-05, "cur_lr": 0.0003, "total_loss": 6.535537189907497, "policy_loss": -0.0004655838840537601, "vf_loss": 6.536049339506361, "vf_explained_var": -3.2782554626464844e-07, "kl": 0.0004066467335593534, "entropy": 0.4646102355586158, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 207.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.63899999999985, "episode_len_mean": 229.32, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.8999999999996007, -50.00000000000044, -50.00000000000044, 21.09999999999986, 44.300000000000004, 37.50000000000003, 33.70000000000004, -50.00000000000044, 41.90000000000001, 45.1, 42.500000000000014, 33.90000000000004, -50.00000000000044, 42.30000000000001, -50.00000000000044, 32.700000000000024, 41.70000000000002, 35.30000000000004, -50.00000000000044, 46.9, -50.00000000000044, 44.10000000000001, -50.00000000000044, 45.7, 45.5, 46.5, 47.3, -50.00000000000044, 29.099999999999973, 33.90000000000004, 44.10000000000001, 22.699999999999882, 12.69999999999974, 46.5, 47.3, 45.9, -50.00000000000044, 45.5, 46.099999999999994, 44.900000000000006, -50.00000000000044, -50.00000000000044, 43.10000000000001, 46.9, 42.30000000000001, -50.00000000000044, 42.500000000000014, 24.69999999999991, 45.5, 22.49999999999988, -50.00000000000044, 47.1, 47.1, 40.10000000000002, 44.10000000000001, 46.099999999999994, -50.00000000000044, 43.30000000000001, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 41.500000000000014, -50.00000000000044, 20.49999999999985, 34.70000000000004, 36.50000000000003, 42.10000000000001, -50.00000000000044, -50.00000000000044, 28.499999999999964, 40.70000000000002, 34.50000000000004, 46.699999999999996, 43.900000000000006, 28.89999999999997, 16.29999999999979, 13.099999999999746, 42.70000000000001, -50.00000000000044, 39.10000000000002, -50.00000000000044, 46.9, 44.900000000000006, 19.899999999999842, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 4.499999999999623, 44.900000000000006, -50.00000000000044, 43.7, 47.5, 42.30000000000001, 39.50000000000002, 47.3], "episode_lengths": [472, 500, 500, 290, 58, 126, 164, 500, 82, 50, 76, 162, 500, 78, 500, 174, 84, 148, 500, 32, 500, 60, 500, 44, 46, 36, 28, 500, 210, 162, 60, 274, 374, 36, 28, 42, 500, 46, 40, 52, 500, 500, 70, 32, 78, 500, 76, 254, 46, 276, 500, 30, 30, 100, 60, 40, 500, 68, 500, 42, 500, 500, 500, 38, 86, 500, 296, 154, 136, 80, 500, 500, 216, 94, 156, 34, 62, 212, 338, 370, 74, 500, 110, 500, 32, 52, 302, 500, 500, 500, 500, 44, 456, 52, 500, 64, 26, 78, 106, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37452164358148754, "mean_inference_ms": 1.199498713238359, "mean_action_processing_ms": 0.13760660346251097, "mean_env_wait_ms": 0.08052155847009063, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03199195861816406, "StateBufferConnector_ms": 0.003999948501586914, "ViewRequirementAgentConnector_ms": 0.10071301460266113}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.63899999999985, "episode_len_mean": 229.32, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [2.8999999999996007, -50.00000000000044, -50.00000000000044, 21.09999999999986, 44.300000000000004, 37.50000000000003, 33.70000000000004, -50.00000000000044, 41.90000000000001, 45.1, 42.500000000000014, 33.90000000000004, -50.00000000000044, 42.30000000000001, -50.00000000000044, 32.700000000000024, 41.70000000000002, 35.30000000000004, -50.00000000000044, 46.9, -50.00000000000044, 44.10000000000001, -50.00000000000044, 45.7, 45.5, 46.5, 47.3, -50.00000000000044, 29.099999999999973, 33.90000000000004, 44.10000000000001, 22.699999999999882, 12.69999999999974, 46.5, 47.3, 45.9, -50.00000000000044, 45.5, 46.099999999999994, 44.900000000000006, -50.00000000000044, -50.00000000000044, 43.10000000000001, 46.9, 42.30000000000001, -50.00000000000044, 42.500000000000014, 24.69999999999991, 45.5, 22.49999999999988, -50.00000000000044, 47.1, 47.1, 40.10000000000002, 44.10000000000001, 46.099999999999994, -50.00000000000044, 43.30000000000001, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 41.500000000000014, -50.00000000000044, 20.49999999999985, 34.70000000000004, 36.50000000000003, 42.10000000000001, -50.00000000000044, -50.00000000000044, 28.499999999999964, 40.70000000000002, 34.50000000000004, 46.699999999999996, 43.900000000000006, 28.89999999999997, 16.29999999999979, 13.099999999999746, 42.70000000000001, -50.00000000000044, 39.10000000000002, -50.00000000000044, 46.9, 44.900000000000006, 19.899999999999842, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 4.499999999999623, 44.900000000000006, -50.00000000000044, 43.7, 47.5, 42.30000000000001, 39.50000000000002, 47.3], "episode_lengths": [472, 500, 500, 290, 58, 126, 164, 500, 82, 50, 76, 162, 500, 78, 500, 174, 84, 148, 500, 32, 500, 60, 500, 44, 46, 36, 28, 500, 210, 162, 60, 274, 374, 36, 28, 42, 500, 46, 40, 52, 500, 500, 70, 32, 78, 500, 76, 254, 46, 276, 500, 30, 30, 100, 60, 40, 500, 68, 500, 42, 500, 500, 500, 38, 86, 500, 296, 154, 136, 80, 500, 500, 216, 94, 156, 34, 62, 212, 338, 370, 74, 500, 110, 500, 32, 52, 302, 500, 500, 500, 500, 44, 456, 52, 500, 64, 26, 78, 106, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37452164358148754, "mean_inference_ms": 1.199498713238359, "mean_action_processing_ms": 0.13760660346251097, "mean_env_wait_ms": 0.08052155847009063, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03199195861816406, "StateBufferConnector_ms": 0.003999948501586914, "ViewRequirementAgentConnector_ms": 0.10071301460266113}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5690.635180948472, "num_env_steps_trained_throughput_per_sec": 5690.635180948472, "timesteps_total": 144000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 2172.961, "sample_time_ms": 1908.661, "load_time_ms": 12.374, "load_throughput": 969736.428, "learn_time_ms": 240.593, "learn_throughput": 49876.747, "synch_weights_time_ms": 9.653}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "episodes_total": 530, "training_iteration": 12, "trial_id": "9f288_00016", "date": "2023-10-25_16-51-59", "timestamp": 1698249119, "time_this_iter_s": 2.1147215366363525, "time_total_s": 26.09463620185852, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 26.09463620185852, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 54.36666666666667, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.882812500000001e-05, "cur_lr": 0.0003, "total_loss": 6.259036011166042, "policy_loss": -0.00010873791244294908, "vf_loss": 6.259195698632134, "vf_explained_var": -1.817941665649414e-06, "kl": 0.0003343017361585352, "entropy": 0.5096706731451882, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 225.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.06399999999983, "episode_len_mean": 250.02, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.30000000000001, -50.00000000000044, 42.500000000000014, 24.69999999999991, 45.5, 22.49999999999988, -50.00000000000044, 47.1, 47.1, 40.10000000000002, 44.10000000000001, 46.099999999999994, -50.00000000000044, 43.30000000000001, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 41.500000000000014, -50.00000000000044, 20.49999999999985, 34.70000000000004, 36.50000000000003, 42.10000000000001, -50.00000000000044, -50.00000000000044, 28.499999999999964, 40.70000000000002, 34.50000000000004, 46.699999999999996, 43.900000000000006, 28.89999999999997, 16.29999999999979, 13.099999999999746, 42.70000000000001, -50.00000000000044, 39.10000000000002, -50.00000000000044, 46.9, 44.900000000000006, 19.899999999999842, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 4.499999999999623, 44.900000000000006, -50.00000000000044, 43.7, 47.5, 42.30000000000001, 39.50000000000002, 47.3, -50.00000000000044, 40.500000000000014, 45.9, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 43.50000000000001, -50.00000000000044, 43.10000000000001, 43.7, 44.900000000000006, -50.00000000000044, 7.09999999999966, 5.899999999999643, 45.1, 45.9, 46.3, -50.00000000000044, 43.30000000000001, -50.00000000000044, 45.3, -50.00000000000044, 44.10000000000001, 44.10000000000001, 45.1, 33.90000000000004, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 27.49999999999995, 28.699999999999967, 5.6999999999996405, 40.70000000000002, 37.50000000000003, 47.5, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [78, 500, 76, 254, 46, 276, 500, 30, 30, 100, 60, 40, 500, 68, 500, 42, 500, 500, 500, 38, 86, 500, 296, 154, 136, 80, 500, 500, 216, 94, 156, 34, 62, 212, 338, 370, 74, 500, 110, 500, 32, 52, 302, 500, 500, 500, 500, 44, 456, 52, 500, 64, 26, 78, 106, 28, 500, 96, 42, 500, 500, 76, 500, 66, 500, 70, 64, 52, 500, 430, 442, 50, 42, 38, 500, 68, 500, 48, 500, 60, 60, 50, 162, 500, 52, 500, 500, 500, 66, 226, 214, 444, 94, 126, 26, 500, 42, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37537434767787603, "mean_inference_ms": 1.2004355068652919, "mean_action_processing_ms": 0.1374290561920231, "mean_env_wait_ms": 0.08067499894139107, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0240018367767334, "StateBufferConnector_ms": 0.006995677947998047, "ViewRequirementAgentConnector_ms": 0.11720895767211914}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.06399999999983, "episode_len_mean": 250.02, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.30000000000001, -50.00000000000044, 42.500000000000014, 24.69999999999991, 45.5, 22.49999999999988, -50.00000000000044, 47.1, 47.1, 40.10000000000002, 44.10000000000001, 46.099999999999994, -50.00000000000044, 43.30000000000001, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 41.500000000000014, -50.00000000000044, 20.49999999999985, 34.70000000000004, 36.50000000000003, 42.10000000000001, -50.00000000000044, -50.00000000000044, 28.499999999999964, 40.70000000000002, 34.50000000000004, 46.699999999999996, 43.900000000000006, 28.89999999999997, 16.29999999999979, 13.099999999999746, 42.70000000000001, -50.00000000000044, 39.10000000000002, -50.00000000000044, 46.9, 44.900000000000006, 19.899999999999842, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 4.499999999999623, 44.900000000000006, -50.00000000000044, 43.7, 47.5, 42.30000000000001, 39.50000000000002, 47.3, -50.00000000000044, 40.500000000000014, 45.9, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 43.50000000000001, -50.00000000000044, 43.10000000000001, 43.7, 44.900000000000006, -50.00000000000044, 7.09999999999966, 5.899999999999643, 45.1, 45.9, 46.3, -50.00000000000044, 43.30000000000001, -50.00000000000044, 45.3, -50.00000000000044, 44.10000000000001, 44.10000000000001, 45.1, 33.90000000000004, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 27.49999999999995, 28.699999999999967, 5.6999999999996405, 40.70000000000002, 37.50000000000003, 47.5, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [78, 500, 76, 254, 46, 276, 500, 30, 30, 100, 60, 40, 500, 68, 500, 42, 500, 500, 500, 38, 86, 500, 296, 154, 136, 80, 500, 500, 216, 94, 156, 34, 62, 212, 338, 370, 74, 500, 110, 500, 32, 52, 302, 500, 500, 500, 500, 44, 456, 52, 500, 64, 26, 78, 106, 28, 500, 96, 42, 500, 500, 76, 500, 66, 500, 70, 64, 52, 500, 430, 442, 50, 42, 38, 500, 68, 500, 48, 500, 60, 60, 50, 162, 500, 52, 500, 500, 500, 66, 226, 214, 444, 94, 126, 26, 500, 42, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37537434767787603, "mean_inference_ms": 1.2004355068652919, "mean_action_processing_ms": 0.1374290561920231, "mean_env_wait_ms": 0.08067499894139107, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0240018367767334, "StateBufferConnector_ms": 0.006995677947998047, "ViewRequirementAgentConnector_ms": 0.11720895767211914}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5321.666721471096, "num_env_steps_trained_throughput_per_sec": 5321.666721471096, "timesteps_total": 156000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 156000, "timers": {"training_iteration_time_ms": 2187.121, "sample_time_ms": 1914.401, "load_time_ms": 12.911, "load_throughput": 929463.337, "learn_time_ms": 248.527, "learn_throughput": 48284.561, "synch_weights_time_ms": 9.703}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "done": false, "episodes_total": 574, "training_iteration": 13, "trial_id": "9f288_00016", "date": "2023-10-25_16-52-01", "timestamp": 1698249121, "time_this_iter_s": 2.264996290206909, "time_total_s": 28.35963249206543, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 28.35963249206543, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 53.975, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.4414062500000005e-05, "cur_lr": 0.0003, "total_loss": 6.956821362177531, "policy_loss": 1.0833454628785452e-05, "vf_loss": 6.956862211227417, "vf_explained_var": 7.152557373046875e-07, "kl": 0.00025984400615230996, "entropy": 0.5162986500395669, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 243.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.629999999999822, "episode_len_mean": 254.34, "episode_media": {}, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.900000000000006, -50.00000000000044, 43.7, 47.5, 42.30000000000001, 39.50000000000002, 47.3, -50.00000000000044, 40.500000000000014, 45.9, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 43.50000000000001, -50.00000000000044, 43.10000000000001, 43.7, 44.900000000000006, -50.00000000000044, 7.09999999999966, 5.899999999999643, 45.1, 45.9, 46.3, -50.00000000000044, 43.30000000000001, -50.00000000000044, 45.3, -50.00000000000044, 44.10000000000001, 44.10000000000001, 45.1, 33.90000000000004, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 27.49999999999995, 28.699999999999967, 5.6999999999996405, 40.70000000000002, 37.50000000000003, 47.5, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.10000000000004, 43.7, 44.10000000000001, 45.1, 46.099999999999994, 43.900000000000006, -50.00000000000044, 43.7, 44.5, 40.500000000000014, 32.100000000000016, 44.900000000000006, -50.00000000000044, -50.00000000000044, 42.900000000000006, 16.8999999999998, -50.00000000000044, -50.00000000000044, 47.5, 13.099999999999746, -50.00000000000044, 44.7, 39.10000000000002, 15.299999999999777, -50.00000000000044, 42.10000000000001, 36.70000000000003, 45.3, 41.100000000000016, 47.3, -50.00000000000044, 30.9, 45.9, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 15.299999999999777, 41.30000000000001, -50.00000000000044, 42.500000000000014, 20.099999999999845, 30.29999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [52, 500, 64, 26, 78, 106, 28, 500, 96, 42, 500, 500, 76, 500, 66, 500, 70, 64, 52, 500, 430, 442, 50, 42, 38, 500, 68, 500, 48, 500, 60, 60, 50, 162, 500, 52, 500, 500, 500, 66, 226, 214, 444, 94, 126, 26, 500, 42, 500, 500, 500, 500, 150, 64, 60, 50, 40, 62, 500, 64, 56, 96, 180, 52, 500, 500, 72, 332, 500, 500, 26, 370, 500, 54, 110, 348, 500, 80, 134, 48, 90, 28, 500, 192, 42, 500, 64, 500, 500, 348, 88, 500, 76, 300, 198, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3750088312507485, "mean_inference_ms": 1.2004232832278638, "mean_action_processing_ms": 0.1370214494475982, "mean_env_wait_ms": 0.08036938142985119, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025006532669067383, "StateBufferConnector_ms": 0.0059969425201416016, "ViewRequirementAgentConnector_ms": 0.12436223030090332}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.629999999999822, "episode_len_mean": 254.34, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.900000000000006, -50.00000000000044, 43.7, 47.5, 42.30000000000001, 39.50000000000002, 47.3, -50.00000000000044, 40.500000000000014, 45.9, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 43.50000000000001, -50.00000000000044, 43.10000000000001, 43.7, 44.900000000000006, -50.00000000000044, 7.09999999999966, 5.899999999999643, 45.1, 45.9, 46.3, -50.00000000000044, 43.30000000000001, -50.00000000000044, 45.3, -50.00000000000044, 44.10000000000001, 44.10000000000001, 45.1, 33.90000000000004, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 27.49999999999995, 28.699999999999967, 5.6999999999996405, 40.70000000000002, 37.50000000000003, 47.5, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.10000000000004, 43.7, 44.10000000000001, 45.1, 46.099999999999994, 43.900000000000006, -50.00000000000044, 43.7, 44.5, 40.500000000000014, 32.100000000000016, 44.900000000000006, -50.00000000000044, -50.00000000000044, 42.900000000000006, 16.8999999999998, -50.00000000000044, -50.00000000000044, 47.5, 13.099999999999746, -50.00000000000044, 44.7, 39.10000000000002, 15.299999999999777, -50.00000000000044, 42.10000000000001, 36.70000000000003, 45.3, 41.100000000000016, 47.3, -50.00000000000044, 30.9, 45.9, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 15.299999999999777, 41.30000000000001, -50.00000000000044, 42.500000000000014, 20.099999999999845, 30.29999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [52, 500, 64, 26, 78, 106, 28, 500, 96, 42, 500, 500, 76, 500, 66, 500, 70, 64, 52, 500, 430, 442, 50, 42, 38, 500, 68, 500, 48, 500, 60, 60, 50, 162, 500, 52, 500, 500, 500, 66, 226, 214, 444, 94, 126, 26, 500, 42, 500, 500, 500, 500, 150, 64, 60, 50, 40, 62, 500, 64, 56, 96, 180, 52, 500, 500, 72, 332, 500, 500, 26, 370, 500, 54, 110, 348, 500, 80, 134, 48, 90, 28, 500, 192, 42, 500, 64, 500, 500, 348, 88, 500, 76, 300, 198, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3750088312507485, "mean_inference_ms": 1.2004232832278638, "mean_action_processing_ms": 0.1370214494475982, "mean_env_wait_ms": 0.08036938142985119, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025006532669067383, "StateBufferConnector_ms": 0.0059969425201416016, "ViewRequirementAgentConnector_ms": 0.12436223030090332}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5777.954055920912, "num_env_steps_trained_throughput_per_sec": 5777.954055920912, "timesteps_total": 168000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 168000, "timers": {"training_iteration_time_ms": 2181.475, "sample_time_ms": 1919.618, "load_time_ms": 11.911, "load_throughput": 1007495.376, "learn_time_ms": 238.667, "learn_throughput": 50279.237, "synch_weights_time_ms": 9.8}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "done": false, "episodes_total": 623, "training_iteration": 14, "trial_id": "9f288_00016", "date": "2023-10-25_16-52-03", "timestamp": 1698249123, "time_this_iter_s": 2.0818567276000977, "time_total_s": 30.441489219665527, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 30.441489219665527, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 67.25, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.2207031250000002e-05, "cur_lr": 0.0003, "total_loss": 5.918241765764025, "policy_loss": -5.359864897198147e-05, "vf_loss": 5.91834380891588, "vf_explained_var": -7.053216298421224e-07, "kl": 0.0001448401128938157, "entropy": 0.48442330790890586, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 261.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.231999999999806, "episode_len_mean": 278.28, "episode_media": {}, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 43.50000000000001, 27.49999999999995, 28.699999999999967, 5.6999999999996405, 40.70000000000002, 37.50000000000003, 47.5, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.10000000000004, 43.7, 44.10000000000001, 45.1, 46.099999999999994, 43.900000000000006, -50.00000000000044, 43.7, 44.5, 40.500000000000014, 32.100000000000016, 44.900000000000006, -50.00000000000044, -50.00000000000044, 42.900000000000006, 16.8999999999998, -50.00000000000044, -50.00000000000044, 47.5, 13.099999999999746, -50.00000000000044, 44.7, 39.10000000000002, 15.299999999999777, -50.00000000000044, 42.10000000000001, 36.70000000000003, 45.3, 41.100000000000016, 47.3, -50.00000000000044, 30.9, 45.9, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 15.299999999999777, 41.30000000000001, -50.00000000000044, 42.500000000000014, 20.099999999999845, 30.29999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, 21.299999999999862, 45.7, 44.7, 20.49999999999985, -50.00000000000044, 45.1, 45.7, -50.00000000000044, 19.499999999999837, 46.099999999999994, 44.7, -50.00000000000044, 23.8999999999999, 45.7, -50.00000000000044, -50.00000000000044, 30.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, 25.499999999999922, 38.50000000000003, -50.00000000000044, 45.3, 33.10000000000003, 41.90000000000001, -50.00000000000044, 45.1, 36.10000000000004], "episode_lengths": [500, 500, 66, 226, 214, 444, 94, 126, 26, 500, 42, 500, 500, 500, 500, 150, 64, 60, 50, 40, 62, 500, 64, 56, 96, 180, 52, 500, 500, 72, 332, 500, 500, 26, 370, 500, 54, 110, 348, 500, 80, 134, 48, 90, 28, 500, 192, 42, 500, 64, 500, 500, 348, 88, 500, 76, 300, 198, 500, 500, 500, 500, 500, 500, 500, 500, 84, 288, 44, 54, 296, 500, 50, 44, 500, 306, 40, 54, 500, 262, 44, 500, 500, 194, 500, 500, 500, 500, 500, 500, 104, 246, 116, 500, 48, 170, 82, 500, 50, 140]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37548928892769307, "mean_inference_ms": 1.198792848272402, "mean_action_processing_ms": 0.1367111893006099, "mean_env_wait_ms": 0.08009950721463867, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01998162269592285, "StateBufferConnector_ms": 0.005002260208129883, "ViewRequirementAgentConnector_ms": 0.12102866172790527}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.231999999999806, "episode_len_mean": 278.28, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 43.50000000000001, 27.49999999999995, 28.699999999999967, 5.6999999999996405, 40.70000000000002, 37.50000000000003, 47.5, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.10000000000004, 43.7, 44.10000000000001, 45.1, 46.099999999999994, 43.900000000000006, -50.00000000000044, 43.7, 44.5, 40.500000000000014, 32.100000000000016, 44.900000000000006, -50.00000000000044, -50.00000000000044, 42.900000000000006, 16.8999999999998, -50.00000000000044, -50.00000000000044, 47.5, 13.099999999999746, -50.00000000000044, 44.7, 39.10000000000002, 15.299999999999777, -50.00000000000044, 42.10000000000001, 36.70000000000003, 45.3, 41.100000000000016, 47.3, -50.00000000000044, 30.9, 45.9, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 15.299999999999777, 41.30000000000001, -50.00000000000044, 42.500000000000014, 20.099999999999845, 30.29999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, 21.299999999999862, 45.7, 44.7, 20.49999999999985, -50.00000000000044, 45.1, 45.7, -50.00000000000044, 19.499999999999837, 46.099999999999994, 44.7, -50.00000000000044, 23.8999999999999, 45.7, -50.00000000000044, -50.00000000000044, 30.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, 25.499999999999922, 38.50000000000003, -50.00000000000044, 45.3, 33.10000000000003, 41.90000000000001, -50.00000000000044, 45.1, 36.10000000000004], "episode_lengths": [500, 500, 66, 226, 214, 444, 94, 126, 26, 500, 42, 500, 500, 500, 500, 150, 64, 60, 50, 40, 62, 500, 64, 56, 96, 180, 52, 500, 500, 72, 332, 500, 500, 26, 370, 500, 54, 110, 348, 500, 80, 134, 48, 90, 28, 500, 192, 42, 500, 64, 500, 500, 348, 88, 500, 76, 300, 198, 500, 500, 500, 500, 500, 500, 500, 500, 84, 288, 44, 54, 296, 500, 50, 44, 500, 306, 40, 54, 500, 262, 44, 500, 500, 194, 500, 500, 500, 500, 500, 500, 104, 246, 116, 500, 48, 170, 82, 500, 50, 140]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37548928892769307, "mean_inference_ms": 1.198792848272402, "mean_action_processing_ms": 0.1367111893006099, "mean_env_wait_ms": 0.08009950721463867, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01998162269592285, "StateBufferConnector_ms": 0.005002260208129883, "ViewRequirementAgentConnector_ms": 0.12102866172790527}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5460.5180476526075, "num_env_steps_trained_throughput_per_sec": 5460.5180476526075, "timesteps_total": 180000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 180000, "timers": {"training_iteration_time_ms": 2185.607, "sample_time_ms": 1917.51, "load_time_ms": 12.31, "load_throughput": 974788.567, "learn_time_ms": 244.432, "learn_throughput": 49093.333, "synch_weights_time_ms": 9.799}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "done": false, "episodes_total": 660, "training_iteration": 15, "trial_id": "9f288_00016", "date": "2023-10-25_16-52-05", "timestamp": 1698249125, "time_this_iter_s": 2.2025911808013916, "time_total_s": 32.64408040046692, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 32.64408040046692, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 56.574999999999996, "ram_util_percent": 27.224999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.103515625000001e-06, "cur_lr": 0.0003, "total_loss": 6.46948962741428, "policy_loss": -5.290740066104465e-05, "vf_loss": 6.469594955444336, "vf_explained_var": -2.1126535203721787e-06, "kl": 0.00010670127389921113, "entropy": 0.5240089197953542, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 279.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.3149999999998045, "episode_len_mean": 282.44, "episode_media": {}, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.7, -50.00000000000044, -50.00000000000044, 15.299999999999777, 41.30000000000001, -50.00000000000044, 42.500000000000014, 20.099999999999845, 30.29999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, 21.299999999999862, 45.7, 44.7, 20.49999999999985, -50.00000000000044, 45.1, 45.7, -50.00000000000044, 19.499999999999837, 46.099999999999994, 44.7, -50.00000000000044, 23.8999999999999, 45.7, -50.00000000000044, -50.00000000000044, 30.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, 25.499999999999922, 38.50000000000003, -50.00000000000044, 45.3, 33.10000000000003, 41.90000000000001, -50.00000000000044, 45.1, 36.10000000000004, -50.00000000000044, 44.900000000000006, -50.00000000000044, 44.300000000000004, 31.70000000000001, 39.90000000000002, -50.00000000000044, 39.10000000000002, 45.5, 41.500000000000014, 14.299999999999763, 26.499999999999936, 46.099999999999994, -50.00000000000044, 32.50000000000002, 44.300000000000004, 46.9, 31.900000000000013, -50.00000000000044, 43.10000000000001, 36.900000000000034, 46.699999999999996, -50.00000000000044, 43.10000000000001, 47.5, -50.00000000000044, -50.00000000000044, 46.3, 43.900000000000006, 45.9, 17.69999999999981, 28.89999999999997, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 43.7, 38.300000000000026, 33.90000000000004, 8.099999999999675, -50.00000000000044, 32.30000000000002, -50.00000000000044, 39.10000000000002, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044], "episode_lengths": [64, 500, 500, 348, 88, 500, 76, 300, 198, 500, 500, 500, 500, 500, 500, 500, 500, 84, 288, 44, 54, 296, 500, 50, 44, 500, 306, 40, 54, 500, 262, 44, 500, 500, 194, 500, 500, 500, 500, 500, 500, 104, 246, 116, 500, 48, 170, 82, 500, 50, 140, 500, 52, 500, 58, 184, 102, 500, 110, 46, 86, 358, 236, 40, 500, 176, 58, 32, 182, 500, 70, 132, 34, 500, 70, 26, 500, 500, 38, 62, 42, 324, 212, 500, 500, 500, 500, 54, 64, 118, 162, 420, 500, 178, 500, 110, 500, 500, 118, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3760334200488049, "mean_inference_ms": 1.1991038779049321, "mean_action_processing_ms": 0.13707331000668616, "mean_env_wait_ms": 0.08016773255661201, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026983022689819336, "StateBufferConnector_ms": 0.004002094268798828, "ViewRequirementAgentConnector_ms": 0.1100778579711914}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.3149999999998045, "episode_len_mean": 282.44, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.7, -50.00000000000044, -50.00000000000044, 15.299999999999777, 41.30000000000001, -50.00000000000044, 42.500000000000014, 20.099999999999845, 30.29999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, 21.299999999999862, 45.7, 44.7, 20.49999999999985, -50.00000000000044, 45.1, 45.7, -50.00000000000044, 19.499999999999837, 46.099999999999994, 44.7, -50.00000000000044, 23.8999999999999, 45.7, -50.00000000000044, -50.00000000000044, 30.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, 25.499999999999922, 38.50000000000003, -50.00000000000044, 45.3, 33.10000000000003, 41.90000000000001, -50.00000000000044, 45.1, 36.10000000000004, -50.00000000000044, 44.900000000000006, -50.00000000000044, 44.300000000000004, 31.70000000000001, 39.90000000000002, -50.00000000000044, 39.10000000000002, 45.5, 41.500000000000014, 14.299999999999763, 26.499999999999936, 46.099999999999994, -50.00000000000044, 32.50000000000002, 44.300000000000004, 46.9, 31.900000000000013, -50.00000000000044, 43.10000000000001, 36.900000000000034, 46.699999999999996, -50.00000000000044, 43.10000000000001, 47.5, -50.00000000000044, -50.00000000000044, 46.3, 43.900000000000006, 45.9, 17.69999999999981, 28.89999999999997, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 43.7, 38.300000000000026, 33.90000000000004, 8.099999999999675, -50.00000000000044, 32.30000000000002, -50.00000000000044, 39.10000000000002, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044], "episode_lengths": [64, 500, 500, 348, 88, 500, 76, 300, 198, 500, 500, 500, 500, 500, 500, 500, 500, 84, 288, 44, 54, 296, 500, 50, 44, 500, 306, 40, 54, 500, 262, 44, 500, 500, 194, 500, 500, 500, 500, 500, 500, 104, 246, 116, 500, 48, 170, 82, 500, 50, 140, 500, 52, 500, 58, 184, 102, 500, 110, 46, 86, 358, 236, 40, 500, 176, 58, 32, 182, 500, 70, 132, 34, 500, 70, 26, 500, 500, 38, 62, 42, 324, 212, 500, 500, 500, 500, 54, 64, 118, 162, 420, 500, 178, 500, 110, 500, 500, 118, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3760334200488049, "mean_inference_ms": 1.1991038779049321, "mean_action_processing_ms": 0.13707331000668616, "mean_env_wait_ms": 0.08016773255661201, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026983022689819336, "StateBufferConnector_ms": 0.004002094268798828, "ViewRequirementAgentConnector_ms": 0.1100778579711914}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5760.750463975314, "num_env_steps_trained_throughput_per_sec": 5760.750463975314, "timesteps_total": 192000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 2167.529, "sample_time_ms": 1914.14, "load_time_ms": 11.51, "load_throughput": 1042544.446, "learn_time_ms": 230.242, "learn_throughput": 52119.066, "synch_weights_time_ms": 10.182}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "episodes_total": 709, "training_iteration": 16, "trial_id": "9f288_00016", "date": "2023-10-25_16-52-08", "timestamp": 1698249128, "time_this_iter_s": 2.088059902191162, "time_total_s": 34.73214030265808, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 34.73214030265808, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 59.93333333333334, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.0517578125000006e-06, "cur_lr": 0.0003, "total_loss": 6.966600100199382, "policy_loss": -8.802260789606307e-05, "vf_loss": 6.966741641362508, "vf_explained_var": -9.304947323269314e-07, "kl": 0.00019470492384480545, "entropy": 0.5353073328733444, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 297.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.150999999999822, "episode_len_mean": 264.12, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.3, 33.10000000000003, 41.90000000000001, -50.00000000000044, 45.1, 36.10000000000004, -50.00000000000044, 44.900000000000006, -50.00000000000044, 44.300000000000004, 31.70000000000001, 39.90000000000002, -50.00000000000044, 39.10000000000002, 45.5, 41.500000000000014, 14.299999999999763, 26.499999999999936, 46.099999999999994, -50.00000000000044, 32.50000000000002, 44.300000000000004, 46.9, 31.900000000000013, -50.00000000000044, 43.10000000000001, 36.900000000000034, 46.699999999999996, -50.00000000000044, 43.10000000000001, 47.5, -50.00000000000044, -50.00000000000044, 46.3, 43.900000000000006, 45.9, 17.69999999999981, 28.89999999999997, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 43.7, 38.300000000000026, 33.90000000000004, 8.099999999999675, -50.00000000000044, 32.30000000000002, -50.00000000000044, 39.10000000000002, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 43.50000000000001, 44.7, -50.00000000000044, 40.30000000000002, -50.00000000000044, 34.50000000000004, 45.7, -50.00000000000044, -50.00000000000044, 7.09999999999966, -50.00000000000044, 33.30000000000003, -50.00000000000044, 21.299999999999862, -50.00000000000044, 42.900000000000006, 40.70000000000002, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 15.099999999999774, 33.70000000000004, 46.5, 41.70000000000002, -50.00000000000044, 45.9, 43.900000000000006, 44.5, -50.00000000000044, 41.100000000000016, 43.900000000000006, 41.100000000000016, -50.00000000000044, 17.099999999999802, 9.099999999999689, 42.500000000000014], "episode_lengths": [48, 170, 82, 500, 50, 140, 500, 52, 500, 58, 184, 102, 500, 110, 46, 86, 358, 236, 40, 500, 176, 58, 32, 182, 500, 70, 132, 34, 500, 70, 26, 500, 500, 38, 62, 42, 324, 212, 500, 500, 500, 500, 54, 64, 118, 162, 420, 500, 178, 500, 110, 500, 500, 118, 500, 500, 72, 500, 500, 66, 54, 500, 98, 500, 156, 44, 500, 500, 430, 500, 168, 500, 288, 500, 72, 94, 500, 500, 42, 500, 500, 500, 500, 32, 350, 164, 36, 84, 500, 42, 62, 56, 500, 90, 62, 90, 500, 330, 410, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.376999936378991, "mean_inference_ms": 1.1982622976483108, "mean_action_processing_ms": 0.1372421775483892, "mean_env_wait_ms": 0.08025345872461725, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029994487762451172, "StateBufferConnector_ms": 0.0070018768310546875, "ViewRequirementAgentConnector_ms": 0.11368227005004883}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.150999999999822, "episode_len_mean": 264.12, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.3, 33.10000000000003, 41.90000000000001, -50.00000000000044, 45.1, 36.10000000000004, -50.00000000000044, 44.900000000000006, -50.00000000000044, 44.300000000000004, 31.70000000000001, 39.90000000000002, -50.00000000000044, 39.10000000000002, 45.5, 41.500000000000014, 14.299999999999763, 26.499999999999936, 46.099999999999994, -50.00000000000044, 32.50000000000002, 44.300000000000004, 46.9, 31.900000000000013, -50.00000000000044, 43.10000000000001, 36.900000000000034, 46.699999999999996, -50.00000000000044, 43.10000000000001, 47.5, -50.00000000000044, -50.00000000000044, 46.3, 43.900000000000006, 45.9, 17.69999999999981, 28.89999999999997, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 43.7, 38.300000000000026, 33.90000000000004, 8.099999999999675, -50.00000000000044, 32.30000000000002, -50.00000000000044, 39.10000000000002, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 43.50000000000001, 44.7, -50.00000000000044, 40.30000000000002, -50.00000000000044, 34.50000000000004, 45.7, -50.00000000000044, -50.00000000000044, 7.09999999999966, -50.00000000000044, 33.30000000000003, -50.00000000000044, 21.299999999999862, -50.00000000000044, 42.900000000000006, 40.70000000000002, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 15.099999999999774, 33.70000000000004, 46.5, 41.70000000000002, -50.00000000000044, 45.9, 43.900000000000006, 44.5, -50.00000000000044, 41.100000000000016, 43.900000000000006, 41.100000000000016, -50.00000000000044, 17.099999999999802, 9.099999999999689, 42.500000000000014], "episode_lengths": [48, 170, 82, 500, 50, 140, 500, 52, 500, 58, 184, 102, 500, 110, 46, 86, 358, 236, 40, 500, 176, 58, 32, 182, 500, 70, 132, 34, 500, 70, 26, 500, 500, 38, 62, 42, 324, 212, 500, 500, 500, 500, 54, 64, 118, 162, 420, 500, 178, 500, 110, 500, 500, 118, 500, 500, 72, 500, 500, 66, 54, 500, 98, 500, 156, 44, 500, 500, 430, 500, 168, 500, 288, 500, 72, 94, 500, 500, 42, 500, 500, 500, 500, 32, 350, 164, 36, 84, 500, 42, 62, 56, 500, 90, 62, 90, 500, 330, 410, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.376999936378991, "mean_inference_ms": 1.1982622976483108, "mean_action_processing_ms": 0.1372421775483892, "mean_env_wait_ms": 0.08025345872461725, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029994487762451172, "StateBufferConnector_ms": 0.0070018768310546875, "ViewRequirementAgentConnector_ms": 0.11368227005004883}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5296.1738527629805, "num_env_steps_trained_throughput_per_sec": 5296.1738527629805, "timesteps_total": 204000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 204000, "timers": {"training_iteration_time_ms": 2166.644, "sample_time_ms": 1911.99, "load_time_ms": 12.019, "load_throughput": 998406.094, "learn_time_ms": 231.399, "learn_throughput": 51858.588, "synch_weights_time_ms": 9.782}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "done": false, "episodes_total": 754, "training_iteration": 17, "trial_id": "9f288_00016", "date": "2023-10-25_16-52-10", "timestamp": 1698249130, "time_this_iter_s": 2.2707860469818115, "time_total_s": 37.00292634963989, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 37.00292634963989, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 60.300000000000004, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.5258789062500003e-06, "cur_lr": 0.0003, "total_loss": 6.8686257468329535, "policy_loss": -0.0003891752825842963, "vf_loss": 6.8690658410390215, "vf_explained_var": -3.178914388020833e-07, "kl": 0.0007705512232531772, "entropy": 0.5105844222837024, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 315.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.6590000000002152, "episode_len_mean": 302.16, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 43.7, 38.300000000000026, 33.90000000000004, 8.099999999999675, -50.00000000000044, 32.30000000000002, -50.00000000000044, 39.10000000000002, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 43.50000000000001, 44.7, -50.00000000000044, 40.30000000000002, -50.00000000000044, 34.50000000000004, 45.7, -50.00000000000044, -50.00000000000044, 7.09999999999966, -50.00000000000044, 33.30000000000003, -50.00000000000044, 21.299999999999862, -50.00000000000044, 42.900000000000006, 40.70000000000002, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 15.099999999999774, 33.70000000000004, 46.5, 41.70000000000002, -50.00000000000044, 45.9, 43.900000000000006, 44.5, -50.00000000000044, 41.100000000000016, 43.900000000000006, 41.100000000000016, -50.00000000000044, 17.099999999999802, 9.099999999999689, 42.500000000000014, -50.00000000000044, -50.00000000000044, 45.5, 41.30000000000001, 43.900000000000006, 31.1, 38.700000000000024, 37.70000000000003, -50.00000000000044, -50.00000000000044, 35.500000000000036, 32.90000000000003, -50.00000000000044, -50.00000000000044, 45.7, 44.900000000000006, 45.3, -50.00000000000044, 40.30000000000002, -50.00000000000044, 6.099999999999646, 40.500000000000014, -50.00000000000044, 40.30000000000002, 7.09999999999966, -50.00000000000044, -50.00000000000044, 12.899999999999743, -50.00000000000044, 6.8999999999996575, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, 14.899999999999771, 42.70000000000001, -50.00000000000044, 29.49999999999998, 26.09999999999993], "episode_lengths": [500, 500, 500, 54, 64, 118, 162, 420, 500, 178, 500, 110, 500, 500, 118, 500, 500, 72, 500, 500, 66, 54, 500, 98, 500, 156, 44, 500, 500, 430, 500, 168, 500, 288, 500, 72, 94, 500, 500, 42, 500, 500, 500, 500, 32, 350, 164, 36, 84, 500, 42, 62, 56, 500, 90, 62, 90, 500, 330, 410, 76, 500, 500, 46, 88, 62, 190, 114, 124, 500, 500, 146, 172, 500, 500, 44, 52, 48, 500, 98, 500, 440, 96, 500, 98, 430, 500, 500, 372, 500, 432, 500, 500, 100, 500, 352, 74, 500, 206, 240]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3770253017476433, "mean_inference_ms": 1.1986257788671646, "mean_action_processing_ms": 0.1370498347538119, "mean_env_wait_ms": 0.08047890083699956, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02599620819091797, "StateBufferConnector_ms": 0.00800180435180664, "ViewRequirementAgentConnector_ms": 0.11983823776245117}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.6590000000002152, "episode_len_mean": 302.16, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 43.7, 38.300000000000026, 33.90000000000004, 8.099999999999675, -50.00000000000044, 32.30000000000002, -50.00000000000044, 39.10000000000002, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 43.50000000000001, 44.7, -50.00000000000044, 40.30000000000002, -50.00000000000044, 34.50000000000004, 45.7, -50.00000000000044, -50.00000000000044, 7.09999999999966, -50.00000000000044, 33.30000000000003, -50.00000000000044, 21.299999999999862, -50.00000000000044, 42.900000000000006, 40.70000000000002, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 15.099999999999774, 33.70000000000004, 46.5, 41.70000000000002, -50.00000000000044, 45.9, 43.900000000000006, 44.5, -50.00000000000044, 41.100000000000016, 43.900000000000006, 41.100000000000016, -50.00000000000044, 17.099999999999802, 9.099999999999689, 42.500000000000014, -50.00000000000044, -50.00000000000044, 45.5, 41.30000000000001, 43.900000000000006, 31.1, 38.700000000000024, 37.70000000000003, -50.00000000000044, -50.00000000000044, 35.500000000000036, 32.90000000000003, -50.00000000000044, -50.00000000000044, 45.7, 44.900000000000006, 45.3, -50.00000000000044, 40.30000000000002, -50.00000000000044, 6.099999999999646, 40.500000000000014, -50.00000000000044, 40.30000000000002, 7.09999999999966, -50.00000000000044, -50.00000000000044, 12.899999999999743, -50.00000000000044, 6.8999999999996575, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, 14.899999999999771, 42.70000000000001, -50.00000000000044, 29.49999999999998, 26.09999999999993], "episode_lengths": [500, 500, 500, 54, 64, 118, 162, 420, 500, 178, 500, 110, 500, 500, 118, 500, 500, 72, 500, 500, 66, 54, 500, 98, 500, 156, 44, 500, 500, 430, 500, 168, 500, 288, 500, 72, 94, 500, 500, 42, 500, 500, 500, 500, 32, 350, 164, 36, 84, 500, 42, 62, 56, 500, 90, 62, 90, 500, 330, 410, 76, 500, 500, 46, 88, 62, 190, 114, 124, 500, 500, 146, 172, 500, 500, 44, 52, 48, 500, 98, 500, 440, 96, 500, 98, 430, 500, 500, 372, 500, 432, 500, 500, 100, 500, 352, 74, 500, 206, 240]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3770253017476433, "mean_inference_ms": 1.1986257788671646, "mean_action_processing_ms": 0.1370498347538119, "mean_env_wait_ms": 0.08047890083699956, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02599620819091797, "StateBufferConnector_ms": 0.00800180435180664, "ViewRequirementAgentConnector_ms": 0.11983823776245117}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5662.017956772533, "num_env_steps_trained_throughput_per_sec": 5662.017956772533, "timesteps_total": 216000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 216000, "timers": {"training_iteration_time_ms": 2170.264, "sample_time_ms": 1910.961, "load_time_ms": 12.118, "load_throughput": 990230.777, "learn_time_ms": 235.748, "learn_throughput": 50901.881, "synch_weights_time_ms": 9.982}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "done": false, "episodes_total": 793, "training_iteration": 18, "trial_id": "9f288_00016", "date": "2023-10-25_16-52-12", "timestamp": 1698249132, "time_this_iter_s": 2.1243815422058105, "time_total_s": 39.1273078918457, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 39.1273078918457, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 58.03333333333333, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.629394531250001e-07, "cur_lr": 0.0003, "total_loss": 5.606115765041775, "policy_loss": -0.00012145356999503242, "vf_loss": 5.606292618645562, "vf_explained_var": -1.4172659979926216e-06, "kl": 0.000169607962763823, "entropy": 0.5541208850012885, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 333.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.9179999999998, "episode_len_mean": 281.42, "episode_media": {}, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 15.099999999999774, 33.70000000000004, 46.5, 41.70000000000002, -50.00000000000044, 45.9, 43.900000000000006, 44.5, -50.00000000000044, 41.100000000000016, 43.900000000000006, 41.100000000000016, -50.00000000000044, 17.099999999999802, 9.099999999999689, 42.500000000000014, -50.00000000000044, -50.00000000000044, 45.5, 41.30000000000001, 43.900000000000006, 31.1, 38.700000000000024, 37.70000000000003, -50.00000000000044, -50.00000000000044, 35.500000000000036, 32.90000000000003, -50.00000000000044, -50.00000000000044, 45.7, 44.900000000000006, 45.3, -50.00000000000044, 40.30000000000002, -50.00000000000044, 6.099999999999646, 40.500000000000014, -50.00000000000044, 40.30000000000002, 7.09999999999966, -50.00000000000044, -50.00000000000044, 12.899999999999743, -50.00000000000044, 6.8999999999996575, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, 14.899999999999771, 42.70000000000001, -50.00000000000044, 29.49999999999998, 26.09999999999993, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 42.70000000000001, -50.00000000000044, -50.00000000000044, 45.1, 46.5, -50.00000000000044, -50.00000000000044, 42.900000000000006, 37.70000000000003, 36.10000000000004, 42.900000000000006, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, 45.1, 46.5, -50.00000000000044, 43.900000000000006, -50.00000000000044, 31.500000000000007, 19.69999999999984, -50.00000000000044, 16.499999999999794, 42.10000000000001, 46.099999999999994, 44.7, 40.30000000000002, 42.10000000000001, 42.70000000000001, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 42, 500, 500, 500, 500, 32, 350, 164, 36, 84, 500, 42, 62, 56, 500, 90, 62, 90, 500, 330, 410, 76, 500, 500, 46, 88, 62, 190, 114, 124, 500, 500, 146, 172, 500, 500, 44, 52, 48, 500, 98, 500, 440, 96, 500, 98, 430, 500, 500, 372, 500, 432, 500, 500, 100, 500, 352, 74, 500, 206, 240, 500, 500, 500, 76, 74, 500, 500, 50, 36, 500, 500, 72, 124, 140, 72, 500, 54, 500, 500, 94, 500, 50, 36, 500, 62, 500, 186, 304, 500, 336, 80, 40, 54, 98, 80, 74, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3772364237266225, "mean_inference_ms": 1.1984946213522287, "mean_action_processing_ms": 0.13736079437504997, "mean_env_wait_ms": 0.08081967195319997, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021007299423217773, "StateBufferConnector_ms": 0.010001659393310547, "ViewRequirementAgentConnector_ms": 0.11415243148803711}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.9179999999998, "episode_len_mean": 281.42, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 15.099999999999774, 33.70000000000004, 46.5, 41.70000000000002, -50.00000000000044, 45.9, 43.900000000000006, 44.5, -50.00000000000044, 41.100000000000016, 43.900000000000006, 41.100000000000016, -50.00000000000044, 17.099999999999802, 9.099999999999689, 42.500000000000014, -50.00000000000044, -50.00000000000044, 45.5, 41.30000000000001, 43.900000000000006, 31.1, 38.700000000000024, 37.70000000000003, -50.00000000000044, -50.00000000000044, 35.500000000000036, 32.90000000000003, -50.00000000000044, -50.00000000000044, 45.7, 44.900000000000006, 45.3, -50.00000000000044, 40.30000000000002, -50.00000000000044, 6.099999999999646, 40.500000000000014, -50.00000000000044, 40.30000000000002, 7.09999999999966, -50.00000000000044, -50.00000000000044, 12.899999999999743, -50.00000000000044, 6.8999999999996575, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, 14.899999999999771, 42.70000000000001, -50.00000000000044, 29.49999999999998, 26.09999999999993, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 42.70000000000001, -50.00000000000044, -50.00000000000044, 45.1, 46.5, -50.00000000000044, -50.00000000000044, 42.900000000000006, 37.70000000000003, 36.10000000000004, 42.900000000000006, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, 45.1, 46.5, -50.00000000000044, 43.900000000000006, -50.00000000000044, 31.500000000000007, 19.69999999999984, -50.00000000000044, 16.499999999999794, 42.10000000000001, 46.099999999999994, 44.7, 40.30000000000002, 42.10000000000001, 42.70000000000001, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 42, 500, 500, 500, 500, 32, 350, 164, 36, 84, 500, 42, 62, 56, 500, 90, 62, 90, 500, 330, 410, 76, 500, 500, 46, 88, 62, 190, 114, 124, 500, 500, 146, 172, 500, 500, 44, 52, 48, 500, 98, 500, 440, 96, 500, 98, 430, 500, 500, 372, 500, 432, 500, 500, 100, 500, 352, 74, 500, 206, 240, 500, 500, 500, 76, 74, 500, 500, 50, 36, 500, 500, 72, 124, 140, 72, 500, 54, 500, 500, 94, 500, 50, 36, 500, 62, 500, 186, 304, 500, 336, 80, 40, 54, 98, 80, 74, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3772364237266225, "mean_inference_ms": 1.1984946213522287, "mean_action_processing_ms": 0.13736079437504997, "mean_env_wait_ms": 0.08081967195319997, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021007299423217773, "StateBufferConnector_ms": 0.010001659393310547, "ViewRequirementAgentConnector_ms": 0.11415243148803711}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5354.460828342968, "num_env_steps_trained_throughput_per_sec": 5354.460828342968, "timesteps_total": 228000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 228000, "timers": {"training_iteration_time_ms": 2168.949, "sample_time_ms": 1907.366, "load_time_ms": 12.091, "load_throughput": 992466.493, "learn_time_ms": 238.073, "learn_throughput": 50404.659, "synch_weights_time_ms": 9.864}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "done": false, "episodes_total": 831, "training_iteration": 19, "trial_id": "9f288_00016", "date": "2023-10-25_16-52-14", "timestamp": 1698249134, "time_this_iter_s": 2.2461235523223877, "time_total_s": 41.37343144416809, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 41.37343144416809, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 60.4, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.814697265625001e-07, "cur_lr": 0.0003, "total_loss": 7.024234215418498, "policy_loss": -0.0006111997904049025, "vf_loss": 7.024902582168579, "vf_explained_var": 2.615981631808811e-07, "kl": 0.001040745957147414, "entropy": 0.570293010936843, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 351.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.917999999999806, "episode_len_mean": 281.42, "episode_media": {}, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 12.899999999999743, -50.00000000000044, 6.8999999999996575, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, 14.899999999999771, 42.70000000000001, -50.00000000000044, 29.49999999999998, 26.09999999999993, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 42.70000000000001, -50.00000000000044, -50.00000000000044, 45.1, 46.5, -50.00000000000044, -50.00000000000044, 42.900000000000006, 37.70000000000003, 36.10000000000004, 42.900000000000006, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, 45.1, 46.5, -50.00000000000044, 43.900000000000006, -50.00000000000044, 31.500000000000007, 19.69999999999984, -50.00000000000044, 16.499999999999794, 42.10000000000001, 46.099999999999994, 44.7, 40.30000000000002, 42.10000000000001, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 36.30000000000003, 46.5, 42.500000000000014, 23.699999999999896, -50.00000000000044, 36.900000000000034, 42.10000000000001, -50.00000000000044, 44.300000000000004, 46.099999999999994, -50.00000000000044, 7.299999999999663, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 45.1, 27.299999999999947, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.29999999999996, 40.70000000000002, -50.00000000000044, 46.099999999999994, 35.900000000000034, 36.30000000000003, 30.9, 40.90000000000002, -50.00000000000044, 40.70000000000002, 46.3, 36.10000000000004, -50.00000000000044, 34.900000000000034, 39.10000000000002, 10.299999999999706, 47.1, -50.00000000000044, 10.699999999999712, -50.00000000000044, -50.00000000000044, 46.699999999999996, 40.70000000000002, -50.00000000000044, 36.50000000000003], "episode_lengths": [500, 372, 500, 432, 500, 500, 100, 500, 352, 74, 500, 206, 240, 500, 500, 500, 76, 74, 500, 500, 50, 36, 500, 500, 72, 124, 140, 72, 500, 54, 500, 500, 94, 500, 50, 36, 500, 62, 500, 186, 304, 500, 336, 80, 40, 54, 98, 80, 74, 500, 500, 500, 60, 138, 36, 76, 264, 500, 132, 80, 500, 58, 40, 500, 428, 500, 500, 500, 500, 48, 50, 228, 500, 500, 500, 218, 94, 500, 40, 142, 138, 192, 92, 500, 94, 38, 140, 500, 152, 110, 398, 30, 500, 394, 500, 500, 34, 94, 500, 136]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3760504121524253, "mean_inference_ms": 1.1975399124958799, "mean_action_processing_ms": 0.1374509845057094, "mean_env_wait_ms": 0.08117224587290017, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018007516860961914, "StateBufferConnector_ms": 0.00800013542175293, "ViewRequirementAgentConnector_ms": 0.11714887619018555}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.917999999999806, "episode_len_mean": 281.42, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 12.899999999999743, -50.00000000000044, 6.8999999999996575, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, 14.899999999999771, 42.70000000000001, -50.00000000000044, 29.49999999999998, 26.09999999999993, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 42.70000000000001, -50.00000000000044, -50.00000000000044, 45.1, 46.5, -50.00000000000044, -50.00000000000044, 42.900000000000006, 37.70000000000003, 36.10000000000004, 42.900000000000006, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, 45.1, 46.5, -50.00000000000044, 43.900000000000006, -50.00000000000044, 31.500000000000007, 19.69999999999984, -50.00000000000044, 16.499999999999794, 42.10000000000001, 46.099999999999994, 44.7, 40.30000000000002, 42.10000000000001, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 36.30000000000003, 46.5, 42.500000000000014, 23.699999999999896, -50.00000000000044, 36.900000000000034, 42.10000000000001, -50.00000000000044, 44.300000000000004, 46.099999999999994, -50.00000000000044, 7.299999999999663, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 45.1, 27.299999999999947, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.29999999999996, 40.70000000000002, -50.00000000000044, 46.099999999999994, 35.900000000000034, 36.30000000000003, 30.9, 40.90000000000002, -50.00000000000044, 40.70000000000002, 46.3, 36.10000000000004, -50.00000000000044, 34.900000000000034, 39.10000000000002, 10.299999999999706, 47.1, -50.00000000000044, 10.699999999999712, -50.00000000000044, -50.00000000000044, 46.699999999999996, 40.70000000000002, -50.00000000000044, 36.50000000000003], "episode_lengths": [500, 372, 500, 432, 500, 500, 100, 500, 352, 74, 500, 206, 240, 500, 500, 500, 76, 74, 500, 500, 50, 36, 500, 500, 72, 124, 140, 72, 500, 54, 500, 500, 94, 500, 50, 36, 500, 62, 500, 186, 304, 500, 336, 80, 40, 54, 98, 80, 74, 500, 500, 500, 60, 138, 36, 76, 264, 500, 132, 80, 500, 58, 40, 500, 428, 500, 500, 500, 500, 48, 50, 228, 500, 500, 500, 218, 94, 500, 40, 142, 138, 192, 92, 500, 94, 38, 140, 500, 152, 110, 398, 30, 500, 394, 500, 500, 34, 94, 500, 136]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3760504121524253, "mean_inference_ms": 1.1975399124958799, "mean_action_processing_ms": 0.1374509845057094, "mean_env_wait_ms": 0.08117224587290017, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018007516860961914, "StateBufferConnector_ms": 0.00800013542175293, "ViewRequirementAgentConnector_ms": 0.11714887619018555}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5876.765015092505, "num_env_steps_trained_throughput_per_sec": 5876.765015092505, "timesteps_total": 240000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 2163.677, "sample_time_ms": 1905.095, "load_time_ms": 11.804, "load_throughput": 1016616.13, "learn_time_ms": 235.345, "learn_throughput": 50988.874, "synch_weights_time_ms": 9.878}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "episodes_total": 880, "training_iteration": 20, "trial_id": "9f288_00016", "date": "2023-10-25_16-52-16", "timestamp": 1698249136, "time_this_iter_s": 2.047945022583008, "time_total_s": 43.4213764667511, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 43.4213764667511, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 56.93333333333334, "ram_util_percent": 27.166666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.9073486328125004e-07, "cur_lr": 0.0003, "total_loss": 6.941563102934095, "policy_loss": 1.5692578421698676e-05, "vf_loss": 6.9416010114881725, "vf_explained_var": -1.6689300537109375e-06, "kl": 0.00011625039255452268, "entropy": 0.5355745156606039, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 369.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.856999999999826, "episode_len_mean": 267.08, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.7, 40.30000000000002, 42.10000000000001, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 36.30000000000003, 46.5, 42.500000000000014, 23.699999999999896, -50.00000000000044, 36.900000000000034, 42.10000000000001, -50.00000000000044, 44.300000000000004, 46.099999999999994, -50.00000000000044, 7.299999999999663, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 45.1, 27.299999999999947, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.29999999999996, 40.70000000000002, -50.00000000000044, 46.099999999999994, 35.900000000000034, 36.30000000000003, 30.9, 40.90000000000002, -50.00000000000044, 40.70000000000002, 46.3, 36.10000000000004, -50.00000000000044, 34.900000000000034, 39.10000000000002, 10.299999999999706, 47.1, -50.00000000000044, 10.699999999999712, -50.00000000000044, -50.00000000000044, 46.699999999999996, 40.70000000000002, -50.00000000000044, 36.50000000000003, -50.00000000000044, -50.00000000000044, 31.70000000000001, 45.3, 37.70000000000003, 35.30000000000004, 44.7, 47.1, 23.8999999999999, 17.499999999999808, -50.00000000000044, -50.00000000000044, 37.70000000000003, 38.300000000000026, 13.699999999999754, 43.50000000000001, 40.30000000000002, 44.7, -50.00000000000044, 44.10000000000001, 44.10000000000001, -50.00000000000044, 41.30000000000001, 14.499999999999766, 34.50000000000004, 44.900000000000006, 44.10000000000001, 5.6999999999996405, -50.00000000000044, -50.00000000000044, 44.5, 32.50000000000002, 23.099999999999888, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 24.69999999999991, -50.00000000000044, 22.699999999999882, -50.00000000000044, 25.899999999999928, -50.00000000000044], "episode_lengths": [54, 98, 80, 74, 500, 500, 500, 60, 138, 36, 76, 264, 500, 132, 80, 500, 58, 40, 500, 428, 500, 500, 500, 500, 48, 50, 228, 500, 500, 500, 218, 94, 500, 40, 142, 138, 192, 92, 500, 94, 38, 140, 500, 152, 110, 398, 30, 500, 394, 500, 500, 34, 94, 500, 136, 500, 500, 184, 48, 124, 148, 54, 30, 262, 326, 500, 500, 124, 118, 364, 66, 98, 54, 500, 60, 60, 500, 88, 356, 156, 52, 60, 444, 500, 500, 56, 176, 270, 102, 500, 500, 500, 500, 78, 254, 500, 274, 500, 242, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37552592412527275, "mean_inference_ms": 1.1964143729773737, "mean_action_processing_ms": 0.1378301451681267, "mean_env_wait_ms": 0.08127059733993557, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021999597549438477, "StateBufferConnector_ms": 0.004999637603759766, "ViewRequirementAgentConnector_ms": 0.11398482322692871}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.856999999999826, "episode_len_mean": 267.08, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.7, 40.30000000000002, 42.10000000000001, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 36.30000000000003, 46.5, 42.500000000000014, 23.699999999999896, -50.00000000000044, 36.900000000000034, 42.10000000000001, -50.00000000000044, 44.300000000000004, 46.099999999999994, -50.00000000000044, 7.299999999999663, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 45.1, 27.299999999999947, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.29999999999996, 40.70000000000002, -50.00000000000044, 46.099999999999994, 35.900000000000034, 36.30000000000003, 30.9, 40.90000000000002, -50.00000000000044, 40.70000000000002, 46.3, 36.10000000000004, -50.00000000000044, 34.900000000000034, 39.10000000000002, 10.299999999999706, 47.1, -50.00000000000044, 10.699999999999712, -50.00000000000044, -50.00000000000044, 46.699999999999996, 40.70000000000002, -50.00000000000044, 36.50000000000003, -50.00000000000044, -50.00000000000044, 31.70000000000001, 45.3, 37.70000000000003, 35.30000000000004, 44.7, 47.1, 23.8999999999999, 17.499999999999808, -50.00000000000044, -50.00000000000044, 37.70000000000003, 38.300000000000026, 13.699999999999754, 43.50000000000001, 40.30000000000002, 44.7, -50.00000000000044, 44.10000000000001, 44.10000000000001, -50.00000000000044, 41.30000000000001, 14.499999999999766, 34.50000000000004, 44.900000000000006, 44.10000000000001, 5.6999999999996405, -50.00000000000044, -50.00000000000044, 44.5, 32.50000000000002, 23.099999999999888, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 24.69999999999991, -50.00000000000044, 22.699999999999882, -50.00000000000044, 25.899999999999928, -50.00000000000044], "episode_lengths": [54, 98, 80, 74, 500, 500, 500, 60, 138, 36, 76, 264, 500, 132, 80, 500, 58, 40, 500, 428, 500, 500, 500, 500, 48, 50, 228, 500, 500, 500, 218, 94, 500, 40, 142, 138, 192, 92, 500, 94, 38, 140, 500, 152, 110, 398, 30, 500, 394, 500, 500, 34, 94, 500, 136, 500, 500, 184, 48, 124, 148, 54, 30, 262, 326, 500, 500, 124, 118, 364, 66, 98, 54, 500, 60, 60, 500, 88, 356, 156, 52, 60, 444, 500, 500, 56, 176, 270, 102, 500, 500, 500, 500, 78, 254, 500, 274, 500, 242, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37552592412527275, "mean_inference_ms": 1.1964143729773737, "mean_action_processing_ms": 0.1378301451681267, "mean_env_wait_ms": 0.08127059733993557, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021999597549438477, "StateBufferConnector_ms": 0.004999637603759766, "ViewRequirementAgentConnector_ms": 0.11398482322692871}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5582.181877346189, "num_env_steps_trained_throughput_per_sec": 5582.181877346189, "timesteps_total": 252000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 252000, "timers": {"training_iteration_time_ms": 2153.911, "sample_time_ms": 1901.794, "load_time_ms": 11.785, "load_throughput": 1018251.206, "learn_time_ms": 228.947, "learn_throughput": 52413.818, "synch_weights_time_ms": 10.03}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "done": false, "episodes_total": 925, "training_iteration": 21, "trial_id": "9f288_00016", "date": "2023-10-25_16-52-18", "timestamp": 1698249138, "time_this_iter_s": 2.154693841934204, "time_total_s": 45.5760703086853, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 45.5760703086853, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 58.133333333333326, "ram_util_percent": 27.133333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.536743164062502e-08, "cur_lr": 0.0003, "total_loss": 7.2665279441409645, "policy_loss": -0.00016515019039312998, "vf_loss": 7.266749991310967, "vf_explained_var": -3.741847144232856e-07, "kl": 0.00015739228731062284, "entropy": 0.569501131772995, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 387.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.603999999999838, "episode_len_mean": 254.64, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.70000000000002, -50.00000000000044, 36.50000000000003, -50.00000000000044, -50.00000000000044, 31.70000000000001, 45.3, 37.70000000000003, 35.30000000000004, 44.7, 47.1, 23.8999999999999, 17.499999999999808, -50.00000000000044, -50.00000000000044, 37.70000000000003, 38.300000000000026, 13.699999999999754, 43.50000000000001, 40.30000000000002, 44.7, -50.00000000000044, 44.10000000000001, 44.10000000000001, -50.00000000000044, 41.30000000000001, 14.499999999999766, 34.50000000000004, 44.900000000000006, 44.10000000000001, 5.6999999999996405, -50.00000000000044, -50.00000000000044, 44.5, 32.50000000000002, 23.099999999999888, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 24.69999999999991, -50.00000000000044, 22.699999999999882, -50.00000000000044, 25.899999999999928, -50.00000000000044, -50.00000000000044, 45.9, 44.5, 9.299999999999692, 43.900000000000006, 42.30000000000001, -50.00000000000044, -50.00000000000044, 34.50000000000004, 17.299999999999805, 42.500000000000014, 43.7, 35.70000000000003, 37.90000000000003, 43.7, 45.5, 25.099999999999916, 41.500000000000014, -50.00000000000044, -50.00000000000044, 45.9, 44.900000000000006, -50.00000000000044, -50.00000000000044, 41.500000000000014, 43.10000000000001, -50.00000000000044, 27.49999999999995, 42.30000000000001, 42.30000000000001, 4.299999999999621, -50.00000000000044, 19.09999999999983, -50.00000000000044, -50.00000000000044, 41.30000000000001, 44.10000000000001, 44.5, -50.00000000000044, -50.00000000000044, 44.900000000000006, 41.90000000000001, 40.70000000000002, -50.00000000000044, -50.00000000000044, 46.3, 45.9, 20.49999999999985, 35.70000000000003, 36.70000000000003, 46.3, -50.00000000000044], "episode_lengths": [94, 500, 136, 500, 500, 184, 48, 124, 148, 54, 30, 262, 326, 500, 500, 124, 118, 364, 66, 98, 54, 500, 60, 60, 500, 88, 356, 156, 52, 60, 444, 500, 500, 56, 176, 270, 102, 500, 500, 500, 500, 78, 254, 500, 274, 500, 242, 500, 500, 42, 56, 408, 62, 78, 500, 500, 156, 328, 76, 64, 144, 122, 64, 46, 250, 86, 500, 500, 42, 52, 500, 500, 86, 70, 500, 226, 78, 78, 458, 500, 310, 500, 500, 88, 60, 56, 500, 500, 52, 82, 94, 500, 500, 38, 42, 296, 144, 134, 38, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37598076935330144, "mean_inference_ms": 1.1950886506098668, "mean_action_processing_ms": 0.13739851242237466, "mean_env_wait_ms": 0.0807696146010778, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025995254516601562, "StateBufferConnector_ms": 0.0060024261474609375, "ViewRequirementAgentConnector_ms": 0.11972808837890625}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.603999999999838, "episode_len_mean": 254.64, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [40.70000000000002, -50.00000000000044, 36.50000000000003, -50.00000000000044, -50.00000000000044, 31.70000000000001, 45.3, 37.70000000000003, 35.30000000000004, 44.7, 47.1, 23.8999999999999, 17.499999999999808, -50.00000000000044, -50.00000000000044, 37.70000000000003, 38.300000000000026, 13.699999999999754, 43.50000000000001, 40.30000000000002, 44.7, -50.00000000000044, 44.10000000000001, 44.10000000000001, -50.00000000000044, 41.30000000000001, 14.499999999999766, 34.50000000000004, 44.900000000000006, 44.10000000000001, 5.6999999999996405, -50.00000000000044, -50.00000000000044, 44.5, 32.50000000000002, 23.099999999999888, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 24.69999999999991, -50.00000000000044, 22.699999999999882, -50.00000000000044, 25.899999999999928, -50.00000000000044, -50.00000000000044, 45.9, 44.5, 9.299999999999692, 43.900000000000006, 42.30000000000001, -50.00000000000044, -50.00000000000044, 34.50000000000004, 17.299999999999805, 42.500000000000014, 43.7, 35.70000000000003, 37.90000000000003, 43.7, 45.5, 25.099999999999916, 41.500000000000014, -50.00000000000044, -50.00000000000044, 45.9, 44.900000000000006, -50.00000000000044, -50.00000000000044, 41.500000000000014, 43.10000000000001, -50.00000000000044, 27.49999999999995, 42.30000000000001, 42.30000000000001, 4.299999999999621, -50.00000000000044, 19.09999999999983, -50.00000000000044, -50.00000000000044, 41.30000000000001, 44.10000000000001, 44.5, -50.00000000000044, -50.00000000000044, 44.900000000000006, 41.90000000000001, 40.70000000000002, -50.00000000000044, -50.00000000000044, 46.3, 45.9, 20.49999999999985, 35.70000000000003, 36.70000000000003, 46.3, -50.00000000000044], "episode_lengths": [94, 500, 136, 500, 500, 184, 48, 124, 148, 54, 30, 262, 326, 500, 500, 124, 118, 364, 66, 98, 54, 500, 60, 60, 500, 88, 356, 156, 52, 60, 444, 500, 500, 56, 176, 270, 102, 500, 500, 500, 500, 78, 254, 500, 274, 500, 242, 500, 500, 42, 56, 408, 62, 78, 500, 500, 156, 328, 76, 64, 144, 122, 64, 46, 250, 86, 500, 500, 42, 52, 500, 500, 86, 70, 500, 226, 78, 78, 458, 500, 310, 500, 500, 88, 60, 56, 500, 500, 52, 82, 94, 500, 500, 38, 42, 296, 144, 134, 38, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37598076935330144, "mean_inference_ms": 1.1950886506098668, "mean_action_processing_ms": 0.13739851242237466, "mean_env_wait_ms": 0.0807696146010778, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025995254516601562, "StateBufferConnector_ms": 0.0060024261474609375, "ViewRequirementAgentConnector_ms": 0.11972808837890625}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5866.519773417318, "num_env_steps_trained_throughput_per_sec": 5866.519773417318, "timesteps_total": 264000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 264000, "timers": {"training_iteration_time_ms": 2147.588, "sample_time_ms": 1897.974, "load_time_ms": 12.201, "load_throughput": 983506.782, "learn_time_ms": 226.106, "learn_throughput": 53072.425, "synch_weights_time_ms": 10.03}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "done": false, "episodes_total": 977, "training_iteration": 22, "trial_id": "9f288_00016", "date": "2023-10-25_16-52-21", "timestamp": 1698249141, "time_this_iter_s": 2.051330089569092, "time_total_s": 47.627400398254395, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 47.627400398254395, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 57.03333333333333, "ram_util_percent": 27.166666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.768371582031251e-08, "cur_lr": 0.0003, "total_loss": 6.426772170596653, "policy_loss": -0.00011176740129788716, "vf_loss": 6.426934983995226, "vf_explained_var": 1.8576780954996745e-06, "kl": 0.00030801366692559086, "entropy": 0.5080130994319916, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 405.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.288999999999831, "episode_len_mean": 252.78, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 22.699999999999882, -50.00000000000044, 25.899999999999928, -50.00000000000044, -50.00000000000044, 45.9, 44.5, 9.299999999999692, 43.900000000000006, 42.30000000000001, -50.00000000000044, -50.00000000000044, 34.50000000000004, 17.299999999999805, 42.500000000000014, 43.7, 35.70000000000003, 37.90000000000003, 43.7, 45.5, 25.099999999999916, 41.500000000000014, -50.00000000000044, -50.00000000000044, 45.9, 44.900000000000006, -50.00000000000044, -50.00000000000044, 41.500000000000014, 43.10000000000001, -50.00000000000044, 27.49999999999995, 42.30000000000001, 42.30000000000001, 4.299999999999621, -50.00000000000044, 19.09999999999983, -50.00000000000044, -50.00000000000044, 41.30000000000001, 44.10000000000001, 44.5, -50.00000000000044, -50.00000000000044, 44.900000000000006, 41.90000000000001, 40.70000000000002, -50.00000000000044, -50.00000000000044, 46.3, 45.9, 20.49999999999985, 35.70000000000003, 36.70000000000003, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 46.099999999999994, 42.10000000000001, -50.00000000000044, 34.10000000000004, -50.00000000000044, 29.099999999999973, -50.00000000000044, -50.00000000000044, 35.70000000000003, 45.9, 42.70000000000001, 45.5, 41.100000000000016, 13.099999999999746, 45.3, 38.50000000000003, -50.00000000000044, 44.5, -50.00000000000044, 43.10000000000001, 46.699999999999996, 39.70000000000002, 40.10000000000002, 46.3, 44.10000000000001, 33.70000000000004, 5.899999999999643, -50.00000000000044, 16.699999999999797, -50.00000000000044, -50.00000000000044, 39.70000000000002, -50.00000000000044, 35.70000000000003, 5.499999999999638, 43.900000000000006, 42.900000000000006, -50.00000000000044, 44.300000000000004], "episode_lengths": [500, 274, 500, 242, 500, 500, 42, 56, 408, 62, 78, 500, 500, 156, 328, 76, 64, 144, 122, 64, 46, 250, 86, 500, 500, 42, 52, 500, 500, 86, 70, 500, 226, 78, 78, 458, 500, 310, 500, 500, 88, 60, 56, 500, 500, 52, 82, 94, 500, 500, 38, 42, 296, 144, 134, 38, 500, 500, 500, 48, 500, 40, 80, 500, 160, 500, 210, 500, 500, 144, 42, 74, 46, 90, 370, 48, 116, 500, 56, 500, 70, 34, 104, 100, 38, 60, 164, 442, 500, 334, 500, 500, 104, 500, 144, 446, 62, 72, 500, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3764009780495385, "mean_inference_ms": 1.1949025117924081, "mean_action_processing_ms": 0.1371605591033614, "mean_env_wait_ms": 0.08051292866013006, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022999286651611328, "StateBufferConnector_ms": 0.01102590560913086, "ViewRequirementAgentConnector_ms": 0.13955354690551758}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.288999999999831, "episode_len_mean": 252.78, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 22.699999999999882, -50.00000000000044, 25.899999999999928, -50.00000000000044, -50.00000000000044, 45.9, 44.5, 9.299999999999692, 43.900000000000006, 42.30000000000001, -50.00000000000044, -50.00000000000044, 34.50000000000004, 17.299999999999805, 42.500000000000014, 43.7, 35.70000000000003, 37.90000000000003, 43.7, 45.5, 25.099999999999916, 41.500000000000014, -50.00000000000044, -50.00000000000044, 45.9, 44.900000000000006, -50.00000000000044, -50.00000000000044, 41.500000000000014, 43.10000000000001, -50.00000000000044, 27.49999999999995, 42.30000000000001, 42.30000000000001, 4.299999999999621, -50.00000000000044, 19.09999999999983, -50.00000000000044, -50.00000000000044, 41.30000000000001, 44.10000000000001, 44.5, -50.00000000000044, -50.00000000000044, 44.900000000000006, 41.90000000000001, 40.70000000000002, -50.00000000000044, -50.00000000000044, 46.3, 45.9, 20.49999999999985, 35.70000000000003, 36.70000000000003, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 46.099999999999994, 42.10000000000001, -50.00000000000044, 34.10000000000004, -50.00000000000044, 29.099999999999973, -50.00000000000044, -50.00000000000044, 35.70000000000003, 45.9, 42.70000000000001, 45.5, 41.100000000000016, 13.099999999999746, 45.3, 38.50000000000003, -50.00000000000044, 44.5, -50.00000000000044, 43.10000000000001, 46.699999999999996, 39.70000000000002, 40.10000000000002, 46.3, 44.10000000000001, 33.70000000000004, 5.899999999999643, -50.00000000000044, 16.699999999999797, -50.00000000000044, -50.00000000000044, 39.70000000000002, -50.00000000000044, 35.70000000000003, 5.499999999999638, 43.900000000000006, 42.900000000000006, -50.00000000000044, 44.300000000000004], "episode_lengths": [500, 274, 500, 242, 500, 500, 42, 56, 408, 62, 78, 500, 500, 156, 328, 76, 64, 144, 122, 64, 46, 250, 86, 500, 500, 42, 52, 500, 500, 86, 70, 500, 226, 78, 78, 458, 500, 310, 500, 500, 88, 60, 56, 500, 500, 52, 82, 94, 500, 500, 38, 42, 296, 144, 134, 38, 500, 500, 500, 48, 500, 40, 80, 500, 160, 500, 210, 500, 500, 144, 42, 74, 46, 90, 370, 48, 116, 500, 56, 500, 70, 34, 104, 100, 38, 60, 164, 442, 500, 334, 500, 500, 104, 500, 144, 446, 62, 72, 500, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3764009780495385, "mean_inference_ms": 1.1949025117924081, "mean_action_processing_ms": 0.1371605591033614, "mean_env_wait_ms": 0.08051292866013006, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022999286651611328, "StateBufferConnector_ms": 0.01102590560913086, "ViewRequirementAgentConnector_ms": 0.13955354690551758}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5466.271127076054, "num_env_steps_trained_throughput_per_sec": 5466.271127076054, "timesteps_total": 276000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 276000, "timers": {"training_iteration_time_ms": 2141.623, "sample_time_ms": 1893.382, "load_time_ms": 11.692, "load_throughput": 1026321.92, "learn_time_ms": 225.192, "learn_throughput": 53287.861, "synch_weights_time_ms": 9.98}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000}, "done": false, "episodes_total": 1020, "training_iteration": 23, "trial_id": "9f288_00016", "date": "2023-10-25_16-52-23", "timestamp": 1698249143, "time_this_iter_s": 2.2002787590026855, "time_total_s": 49.82767915725708, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 49.82767915725708, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 60.76666666666667, "ram_util_percent": 27.133333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.3841857910156255e-08, "cur_lr": 0.0003, "total_loss": 6.2962948481241865, "policy_loss": -0.0001453423820849922, "vf_loss": 6.296490881178114, "vf_explained_var": -3.973642985026042e-07, "kl": 6.98308968433518e-05, "entropy": 0.5064590921004614, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 423.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.941999999999837, "episode_len_mean": 251.26, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.900000000000006, 41.90000000000001, 40.70000000000002, -50.00000000000044, -50.00000000000044, 46.3, 45.9, 20.49999999999985, 35.70000000000003, 36.70000000000003, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 46.099999999999994, 42.10000000000001, -50.00000000000044, 34.10000000000004, -50.00000000000044, 29.099999999999973, -50.00000000000044, -50.00000000000044, 35.70000000000003, 45.9, 42.70000000000001, 45.5, 41.100000000000016, 13.099999999999746, 45.3, 38.50000000000003, -50.00000000000044, 44.5, -50.00000000000044, 43.10000000000001, 46.699999999999996, 39.70000000000002, 40.10000000000002, 46.3, 44.10000000000001, 33.70000000000004, 5.899999999999643, -50.00000000000044, 16.699999999999797, -50.00000000000044, -50.00000000000044, 39.70000000000002, -50.00000000000044, 35.70000000000003, 5.499999999999638, 43.900000000000006, 42.900000000000006, -50.00000000000044, 44.300000000000004, 29.099999999999973, -50.00000000000044, 26.89999999999994, -50.00000000000044, 14.299999999999763, -50.00000000000044, 43.7, 45.5, 8.099999999999675, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.50000000000002, 46.3, -50.00000000000044, 38.300000000000026, -50.00000000000044, 32.50000000000002, -50.00000000000044, 44.10000000000001, -50.00000000000044, 45.7, 44.5, 20.49999999999985, 36.900000000000034, 43.900000000000006, 45.1, -50.00000000000044, 36.30000000000003, 42.500000000000014, 42.500000000000014, -50.00000000000044, 44.7, 44.7, 18.499999999999822, 45.9, 36.50000000000003, 37.50000000000003, -50.00000000000044, 25.099999999999916, 13.899999999999757, 32.90000000000003, -50.00000000000044, 39.10000000000002, -50.00000000000044], "episode_lengths": [52, 82, 94, 500, 500, 38, 42, 296, 144, 134, 38, 500, 500, 500, 48, 500, 40, 80, 500, 160, 500, 210, 500, 500, 144, 42, 74, 46, 90, 370, 48, 116, 500, 56, 500, 70, 34, 104, 100, 38, 60, 164, 442, 500, 334, 500, 500, 104, 500, 144, 446, 62, 72, 500, 58, 210, 500, 232, 500, 358, 500, 64, 46, 420, 500, 500, 500, 176, 38, 500, 118, 500, 176, 500, 60, 500, 44, 56, 296, 132, 62, 50, 500, 138, 76, 76, 500, 54, 54, 316, 42, 136, 126, 500, 250, 362, 172, 500, 110, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37636197786285736, "mean_inference_ms": 1.1968565924740344, "mean_action_processing_ms": 0.1374637885929178, "mean_env_wait_ms": 0.08052983049421508, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020999908447265625, "StateBufferConnector_ms": 0.010024547576904297, "ViewRequirementAgentConnector_ms": 0.14480185508728027}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.941999999999837, "episode_len_mean": 251.26, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.900000000000006, 41.90000000000001, 40.70000000000002, -50.00000000000044, -50.00000000000044, 46.3, 45.9, 20.49999999999985, 35.70000000000003, 36.70000000000003, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 46.099999999999994, 42.10000000000001, -50.00000000000044, 34.10000000000004, -50.00000000000044, 29.099999999999973, -50.00000000000044, -50.00000000000044, 35.70000000000003, 45.9, 42.70000000000001, 45.5, 41.100000000000016, 13.099999999999746, 45.3, 38.50000000000003, -50.00000000000044, 44.5, -50.00000000000044, 43.10000000000001, 46.699999999999996, 39.70000000000002, 40.10000000000002, 46.3, 44.10000000000001, 33.70000000000004, 5.899999999999643, -50.00000000000044, 16.699999999999797, -50.00000000000044, -50.00000000000044, 39.70000000000002, -50.00000000000044, 35.70000000000003, 5.499999999999638, 43.900000000000006, 42.900000000000006, -50.00000000000044, 44.300000000000004, 29.099999999999973, -50.00000000000044, 26.89999999999994, -50.00000000000044, 14.299999999999763, -50.00000000000044, 43.7, 45.5, 8.099999999999675, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.50000000000002, 46.3, -50.00000000000044, 38.300000000000026, -50.00000000000044, 32.50000000000002, -50.00000000000044, 44.10000000000001, -50.00000000000044, 45.7, 44.5, 20.49999999999985, 36.900000000000034, 43.900000000000006, 45.1, -50.00000000000044, 36.30000000000003, 42.500000000000014, 42.500000000000014, -50.00000000000044, 44.7, 44.7, 18.499999999999822, 45.9, 36.50000000000003, 37.50000000000003, -50.00000000000044, 25.099999999999916, 13.899999999999757, 32.90000000000003, -50.00000000000044, 39.10000000000002, -50.00000000000044], "episode_lengths": [52, 82, 94, 500, 500, 38, 42, 296, 144, 134, 38, 500, 500, 500, 48, 500, 40, 80, 500, 160, 500, 210, 500, 500, 144, 42, 74, 46, 90, 370, 48, 116, 500, 56, 500, 70, 34, 104, 100, 38, 60, 164, 442, 500, 334, 500, 500, 104, 500, 144, 446, 62, 72, 500, 58, 210, 500, 232, 500, 358, 500, 64, 46, 420, 500, 500, 500, 176, 38, 500, 118, 500, 176, 500, 60, 500, 44, 56, 296, 132, 62, 50, 500, 138, 76, 76, 500, 54, 54, 316, 42, 136, 126, 500, 250, 362, 172, 500, 110, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37636197786285736, "mean_inference_ms": 1.1968565924740344, "mean_action_processing_ms": 0.1374637885929178, "mean_env_wait_ms": 0.08052983049421508, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020999908447265625, "StateBufferConnector_ms": 0.010024547576904297, "ViewRequirementAgentConnector_ms": 0.14480185508728027}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5644.08445193675, "num_env_steps_trained_throughput_per_sec": 5644.08445193675, "timesteps_total": 288000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 2146.549, "sample_time_ms": 1895.611, "load_time_ms": 12.161, "load_throughput": 986794.444, "learn_time_ms": 227.417, "learn_throughput": 52766.401, "synch_weights_time_ms": 9.983}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "episodes_total": 1065, "training_iteration": 24, "trial_id": "9f288_00016", "date": "2023-10-25_16-52-25", "timestamp": 1698249145, "time_this_iter_s": 2.1308867931365967, "time_total_s": 51.95856595039368, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 51.95856595039368, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 59.166666666666664, "ram_util_percent": 27.133333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1920928955078127e-08, "cur_lr": 0.0003, "total_loss": 6.591029696994358, "policy_loss": -8.753604359096951e-06, "vf_loss": 6.591090122858684, "vf_explained_var": -4.569689432779948e-07, "kl": 0.00041624655913273675, "entropy": 0.5172954450050989, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 441.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.483999999999822, "episode_len_mean": 265.8, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.70000000000002, -50.00000000000044, 35.70000000000003, 5.499999999999638, 43.900000000000006, 42.900000000000006, -50.00000000000044, 44.300000000000004, 29.099999999999973, -50.00000000000044, 26.89999999999994, -50.00000000000044, 14.299999999999763, -50.00000000000044, 43.7, 45.5, 8.099999999999675, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.50000000000002, 46.3, -50.00000000000044, 38.300000000000026, -50.00000000000044, 32.50000000000002, -50.00000000000044, 44.10000000000001, -50.00000000000044, 45.7, 44.5, 20.49999999999985, 36.900000000000034, 43.900000000000006, 45.1, -50.00000000000044, 36.30000000000003, 42.500000000000014, 42.500000000000014, -50.00000000000044, 44.7, 44.7, 18.499999999999822, 45.9, 36.50000000000003, 37.50000000000003, -50.00000000000044, 25.099999999999916, 13.899999999999757, 32.90000000000003, -50.00000000000044, 39.10000000000002, -50.00000000000044, -50.00000000000044, 24.899999999999913, 45.5, 34.50000000000004, -50.00000000000044, 45.5, 41.90000000000001, 37.90000000000003, 43.7, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 39.70000000000002, -50.00000000000044, 27.49999999999995, 37.50000000000003, -50.00000000000044, 43.900000000000006, -50.00000000000044, 45.3, 46.9, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 12.69999999999974, 33.70000000000004, 42.30000000000001, -50.00000000000044, 43.900000000000006, -50.00000000000044, 45.7, 42.500000000000014, -50.00000000000044, 32.30000000000002, 9.8999999999997, -50.00000000000044, 46.099999999999994, 31.300000000000004, -50.00000000000044, 43.900000000000006, -50.00000000000044, 46.5, 44.10000000000001, -50.00000000000044], "episode_lengths": [104, 500, 144, 446, 62, 72, 500, 58, 210, 500, 232, 500, 358, 500, 64, 46, 420, 500, 500, 500, 176, 38, 500, 118, 500, 176, 500, 60, 500, 44, 56, 296, 132, 62, 50, 500, 138, 76, 76, 500, 54, 54, 316, 42, 136, 126, 500, 250, 362, 172, 500, 110, 500, 500, 252, 46, 156, 500, 46, 82, 122, 64, 500, 500, 66, 500, 104, 500, 226, 126, 500, 62, 500, 48, 32, 500, 48, 500, 500, 500, 374, 164, 78, 500, 62, 500, 44, 76, 500, 178, 402, 500, 40, 188, 500, 62, 500, 36, 60, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3758304155809656, "mean_inference_ms": 1.1968270028581778, "mean_action_processing_ms": 0.13776215266343303, "mean_env_wait_ms": 0.08091220763662475, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026993751525878906, "StateBufferConnector_ms": 0.009021997451782227, "ViewRequirementAgentConnector_ms": 0.12081336975097656}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.483999999999822, "episode_len_mean": 265.8, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [39.70000000000002, -50.00000000000044, 35.70000000000003, 5.499999999999638, 43.900000000000006, 42.900000000000006, -50.00000000000044, 44.300000000000004, 29.099999999999973, -50.00000000000044, 26.89999999999994, -50.00000000000044, 14.299999999999763, -50.00000000000044, 43.7, 45.5, 8.099999999999675, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.50000000000002, 46.3, -50.00000000000044, 38.300000000000026, -50.00000000000044, 32.50000000000002, -50.00000000000044, 44.10000000000001, -50.00000000000044, 45.7, 44.5, 20.49999999999985, 36.900000000000034, 43.900000000000006, 45.1, -50.00000000000044, 36.30000000000003, 42.500000000000014, 42.500000000000014, -50.00000000000044, 44.7, 44.7, 18.499999999999822, 45.9, 36.50000000000003, 37.50000000000003, -50.00000000000044, 25.099999999999916, 13.899999999999757, 32.90000000000003, -50.00000000000044, 39.10000000000002, -50.00000000000044, -50.00000000000044, 24.899999999999913, 45.5, 34.50000000000004, -50.00000000000044, 45.5, 41.90000000000001, 37.90000000000003, 43.7, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 39.70000000000002, -50.00000000000044, 27.49999999999995, 37.50000000000003, -50.00000000000044, 43.900000000000006, -50.00000000000044, 45.3, 46.9, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 12.69999999999974, 33.70000000000004, 42.30000000000001, -50.00000000000044, 43.900000000000006, -50.00000000000044, 45.7, 42.500000000000014, -50.00000000000044, 32.30000000000002, 9.8999999999997, -50.00000000000044, 46.099999999999994, 31.300000000000004, -50.00000000000044, 43.900000000000006, -50.00000000000044, 46.5, 44.10000000000001, -50.00000000000044], "episode_lengths": [104, 500, 144, 446, 62, 72, 500, 58, 210, 500, 232, 500, 358, 500, 64, 46, 420, 500, 500, 500, 176, 38, 500, 118, 500, 176, 500, 60, 500, 44, 56, 296, 132, 62, 50, 500, 138, 76, 76, 500, 54, 54, 316, 42, 136, 126, 500, 250, 362, 172, 500, 110, 500, 500, 252, 46, 156, 500, 46, 82, 122, 64, 500, 500, 66, 500, 104, 500, 226, 126, 500, 62, 500, 48, 32, 500, 48, 500, 500, 500, 374, 164, 78, 500, 62, 500, 44, 76, 500, 178, 402, 500, 40, 188, 500, 62, 500, 36, 60, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3758304155809656, "mean_inference_ms": 1.1968270028581778, "mean_action_processing_ms": 0.13776215266343303, "mean_env_wait_ms": 0.08091220763662475, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026993751525878906, "StateBufferConnector_ms": 0.009021997451782227, "ViewRequirementAgentConnector_ms": 0.12081336975097656}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5229.16651082536, "num_env_steps_trained_throughput_per_sec": 5229.16651082536, "timesteps_total": 300000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 300000, "timers": {"training_iteration_time_ms": 2156.272, "sample_time_ms": 1898.71, "load_time_ms": 12.633, "load_throughput": 949910.032, "learn_time_ms": 233.687, "learn_throughput": 51350.745, "synch_weights_time_ms": 9.983}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "done": false, "episodes_total": 1112, "training_iteration": 25, "trial_id": "9f288_00016", "date": "2023-10-25_16-52-27", "timestamp": 1698249147, "time_this_iter_s": 2.3007395267486572, "time_total_s": 54.259305477142334, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 54.259305477142334, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 59.6, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.960464477539064e-09, "cur_lr": 0.0003, "total_loss": 6.177140527301365, "policy_loss": -0.0004425798025396135, "vf_loss": 6.177638292312622, "vf_explained_var": 6.953875223795573e-08, "kl": 0.0009185734341785848, "entropy": 0.5511734386285146, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 459.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.235999999999811, "episode_len_mean": 278.24, "episode_media": {}, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.500000000000014, -50.00000000000044, 44.7, 44.7, 18.499999999999822, 45.9, 36.50000000000003, 37.50000000000003, -50.00000000000044, 25.099999999999916, 13.899999999999757, 32.90000000000003, -50.00000000000044, 39.10000000000002, -50.00000000000044, -50.00000000000044, 24.899999999999913, 45.5, 34.50000000000004, -50.00000000000044, 45.5, 41.90000000000001, 37.90000000000003, 43.7, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 39.70000000000002, -50.00000000000044, 27.49999999999995, 37.50000000000003, -50.00000000000044, 43.900000000000006, -50.00000000000044, 45.3, 46.9, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 12.69999999999974, 33.70000000000004, 42.30000000000001, -50.00000000000044, 43.900000000000006, -50.00000000000044, 45.7, 42.500000000000014, -50.00000000000044, 32.30000000000002, 9.8999999999997, -50.00000000000044, 46.099999999999994, 31.300000000000004, -50.00000000000044, 43.900000000000006, -50.00000000000044, 46.5, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, 45.1, 28.499999999999964, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 33.30000000000003, -50.00000000000044, 35.500000000000036, -50.00000000000044, 46.099999999999994, 1.6999999999995836, -50.00000000000044, 42.900000000000006, -50.00000000000044, 37.300000000000026, 46.699999999999996, -50.00000000000044, 22.099999999999874, 41.90000000000001, -50.00000000000044, 32.700000000000024, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 38.700000000000024, 29.099999999999973, 31.900000000000013, 34.50000000000004], "episode_lengths": [76, 500, 54, 54, 316, 42, 136, 126, 500, 250, 362, 172, 500, 110, 500, 500, 252, 46, 156, 500, 46, 82, 122, 64, 500, 500, 66, 500, 104, 500, 226, 126, 500, 62, 500, 48, 32, 500, 48, 500, 500, 500, 374, 164, 78, 500, 62, 500, 44, 76, 500, 178, 402, 500, 40, 188, 500, 62, 500, 36, 60, 500, 500, 500, 92, 500, 50, 216, 28, 500, 500, 500, 72, 168, 500, 146, 500, 40, 484, 500, 72, 500, 128, 34, 500, 280, 82, 500, 174, 500, 84, 500, 500, 70, 500, 500, 114, 210, 182, 156]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3757285563022537, "mean_inference_ms": 1.1971136505299935, "mean_action_processing_ms": 0.13778026159011553, "mean_env_wait_ms": 0.08119430674611187, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.036997079849243164, "StateBufferConnector_ms": 0.009003162384033203, "ViewRequirementAgentConnector_ms": 0.12800335884094238}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.235999999999811, "episode_len_mean": 278.24, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.500000000000014, -50.00000000000044, 44.7, 44.7, 18.499999999999822, 45.9, 36.50000000000003, 37.50000000000003, -50.00000000000044, 25.099999999999916, 13.899999999999757, 32.90000000000003, -50.00000000000044, 39.10000000000002, -50.00000000000044, -50.00000000000044, 24.899999999999913, 45.5, 34.50000000000004, -50.00000000000044, 45.5, 41.90000000000001, 37.90000000000003, 43.7, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 39.70000000000002, -50.00000000000044, 27.49999999999995, 37.50000000000003, -50.00000000000044, 43.900000000000006, -50.00000000000044, 45.3, 46.9, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 12.69999999999974, 33.70000000000004, 42.30000000000001, -50.00000000000044, 43.900000000000006, -50.00000000000044, 45.7, 42.500000000000014, -50.00000000000044, 32.30000000000002, 9.8999999999997, -50.00000000000044, 46.099999999999994, 31.300000000000004, -50.00000000000044, 43.900000000000006, -50.00000000000044, 46.5, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, 45.1, 28.499999999999964, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 33.30000000000003, -50.00000000000044, 35.500000000000036, -50.00000000000044, 46.099999999999994, 1.6999999999995836, -50.00000000000044, 42.900000000000006, -50.00000000000044, 37.300000000000026, 46.699999999999996, -50.00000000000044, 22.099999999999874, 41.90000000000001, -50.00000000000044, 32.700000000000024, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 38.700000000000024, 29.099999999999973, 31.900000000000013, 34.50000000000004], "episode_lengths": [76, 500, 54, 54, 316, 42, 136, 126, 500, 250, 362, 172, 500, 110, 500, 500, 252, 46, 156, 500, 46, 82, 122, 64, 500, 500, 66, 500, 104, 500, 226, 126, 500, 62, 500, 48, 32, 500, 48, 500, 500, 500, 374, 164, 78, 500, 62, 500, 44, 76, 500, 178, 402, 500, 40, 188, 500, 62, 500, 36, 60, 500, 500, 500, 92, 500, 50, 216, 28, 500, 500, 500, 72, 168, 500, 146, 500, 40, 484, 500, 72, 500, 128, 34, 500, 280, 82, 500, 174, 500, 84, 500, 500, 70, 500, 500, 114, 210, 182, 156]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3757285563022537, "mean_inference_ms": 1.1971136505299935, "mean_action_processing_ms": 0.13778026159011553, "mean_env_wait_ms": 0.08119430674611187, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.036997079849243164, "StateBufferConnector_ms": 0.009003162384033203, "ViewRequirementAgentConnector_ms": 0.12800335884094238}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5726.702227264923, "num_env_steps_trained_throughput_per_sec": 5726.702227264923, "timesteps_total": 312000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 312000, "timers": {"training_iteration_time_ms": 2157.511, "sample_time_ms": 1900.175, "load_time_ms": 12.611, "load_throughput": 951515.475, "learn_time_ms": 233.789, "learn_throughput": 51328.425, "synch_weights_time_ms": 9.476}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "done": false, "episodes_total": 1150, "training_iteration": 26, "trial_id": "9f288_00016", "date": "2023-10-25_16-52-29", "timestamp": 1698249149, "time_this_iter_s": 2.100444793701172, "time_total_s": 56.359750270843506, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 56.359750270843506, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 56.666666666666664, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.980232238769532e-09, "cur_lr": 0.0003, "total_loss": 6.3080186314053, "policy_loss": -0.00022317044850852754, "vf_loss": 6.308294746610853, "vf_explained_var": -1.7848279741075303e-06, "kl": 0.0003158154959932189, "entropy": 0.5293556137217416, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 477.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.9439999999998043, "episode_len_mean": 281.16, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [33.70000000000004, 42.30000000000001, -50.00000000000044, 43.900000000000006, -50.00000000000044, 45.7, 42.500000000000014, -50.00000000000044, 32.30000000000002, 9.8999999999997, -50.00000000000044, 46.099999999999994, 31.300000000000004, -50.00000000000044, 43.900000000000006, -50.00000000000044, 46.5, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, 45.1, 28.499999999999964, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 33.30000000000003, -50.00000000000044, 35.500000000000036, -50.00000000000044, 46.099999999999994, 1.6999999999995836, -50.00000000000044, 42.900000000000006, -50.00000000000044, 37.300000000000026, 46.699999999999996, -50.00000000000044, 22.099999999999874, 41.90000000000001, -50.00000000000044, 32.700000000000024, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 38.700000000000024, 29.099999999999973, 31.900000000000013, 34.50000000000004, -50.00000000000044, 36.70000000000003, 44.900000000000006, 5.099999999999632, 37.70000000000003, 46.099999999999994, -50.00000000000044, 40.70000000000002, 41.70000000000002, 45.3, 22.299999999999876, 45.9, 44.10000000000001, 21.699999999999868, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 7.299999999999663, 44.5, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 44.900000000000006, 42.500000000000014, 43.900000000000006, 10.899999999999714, 19.09999999999983, -50.00000000000044, -50.00000000000044, 43.30000000000001, 40.70000000000002, 19.899999999999842, 45.5, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, 42.70000000000001, -50.00000000000044], "episode_lengths": [164, 78, 500, 62, 500, 44, 76, 500, 178, 402, 500, 40, 188, 500, 62, 500, 36, 60, 500, 500, 500, 92, 500, 50, 216, 28, 500, 500, 500, 72, 168, 500, 146, 500, 40, 484, 500, 72, 500, 128, 34, 500, 280, 82, 500, 174, 500, 84, 500, 500, 70, 500, 500, 114, 210, 182, 156, 500, 134, 52, 450, 124, 40, 500, 94, 84, 48, 278, 42, 60, 284, 500, 500, 500, 500, 428, 56, 500, 62, 500, 500, 52, 76, 62, 392, 310, 500, 500, 68, 94, 302, 46, 500, 50, 500, 500, 500, 82, 74, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3752246627126071, "mean_inference_ms": 1.1962463740334865, "mean_action_processing_ms": 0.13764393102384392, "mean_env_wait_ms": 0.08134818582604096, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03799867630004883, "StateBufferConnector_ms": 0.012003183364868164, "ViewRequirementAgentConnector_ms": 0.12399983406066895}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.9439999999998043, "episode_len_mean": 281.16, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [33.70000000000004, 42.30000000000001, -50.00000000000044, 43.900000000000006, -50.00000000000044, 45.7, 42.500000000000014, -50.00000000000044, 32.30000000000002, 9.8999999999997, -50.00000000000044, 46.099999999999994, 31.300000000000004, -50.00000000000044, 43.900000000000006, -50.00000000000044, 46.5, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, 45.1, 28.499999999999964, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 33.30000000000003, -50.00000000000044, 35.500000000000036, -50.00000000000044, 46.099999999999994, 1.6999999999995836, -50.00000000000044, 42.900000000000006, -50.00000000000044, 37.300000000000026, 46.699999999999996, -50.00000000000044, 22.099999999999874, 41.90000000000001, -50.00000000000044, 32.700000000000024, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 38.700000000000024, 29.099999999999973, 31.900000000000013, 34.50000000000004, -50.00000000000044, 36.70000000000003, 44.900000000000006, 5.099999999999632, 37.70000000000003, 46.099999999999994, -50.00000000000044, 40.70000000000002, 41.70000000000002, 45.3, 22.299999999999876, 45.9, 44.10000000000001, 21.699999999999868, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 7.299999999999663, 44.5, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 44.900000000000006, 42.500000000000014, 43.900000000000006, 10.899999999999714, 19.09999999999983, -50.00000000000044, -50.00000000000044, 43.30000000000001, 40.70000000000002, 19.899999999999842, 45.5, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, 42.70000000000001, -50.00000000000044], "episode_lengths": [164, 78, 500, 62, 500, 44, 76, 500, 178, 402, 500, 40, 188, 500, 62, 500, 36, 60, 500, 500, 500, 92, 500, 50, 216, 28, 500, 500, 500, 72, 168, 500, 146, 500, 40, 484, 500, 72, 500, 128, 34, 500, 280, 82, 500, 174, 500, 84, 500, 500, 70, 500, 500, 114, 210, 182, 156, 500, 134, 52, 450, 124, 40, 500, 94, 84, 48, 278, 42, 60, 284, 500, 500, 500, 500, 428, 56, 500, 62, 500, 500, 52, 76, 62, 392, 310, 500, 500, 68, 94, 302, 46, 500, 50, 500, 500, 500, 82, 74, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3752246627126071, "mean_inference_ms": 1.1962463740334865, "mean_action_processing_ms": 0.13764393102384392, "mean_env_wait_ms": 0.08134818582604096, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03799867630004883, "StateBufferConnector_ms": 0.012003183364868164, "ViewRequirementAgentConnector_ms": 0.12399983406066895}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5352.569196946296, "num_env_steps_trained_throughput_per_sec": 5352.569196946296, "timesteps_total": 324000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 324000, "timers": {"training_iteration_time_ms": 2155.123, "sample_time_ms": 1898.984, "load_time_ms": 12.002, "load_throughput": 999849.978, "learn_time_ms": 233.202, "learn_throughput": 51457.528, "synch_weights_time_ms": 9.476}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "done": false, "episodes_total": 1193, "training_iteration": 27, "trial_id": "9f288_00016", "date": "2023-10-25_16-52-32", "timestamp": 1698249152, "time_this_iter_s": 2.2469124794006348, "time_total_s": 58.60666275024414, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 58.60666275024414, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 59.53333333333334, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.490116119384766e-09, "cur_lr": 0.0003, "total_loss": 6.219827625486586, "policy_loss": -0.0005734569082657496, "vf_loss": 6.220455090204875, "vf_explained_var": 1.3808409372965495e-06, "kl": 0.001010161602825595, "entropy": 0.5401220752133263, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 495.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.9070000000002127, "episode_len_mean": 294.62, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [37.300000000000026, 46.699999999999996, -50.00000000000044, 22.099999999999874, 41.90000000000001, -50.00000000000044, 32.700000000000024, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 38.700000000000024, 29.099999999999973, 31.900000000000013, 34.50000000000004, -50.00000000000044, 36.70000000000003, 44.900000000000006, 5.099999999999632, 37.70000000000003, 46.099999999999994, -50.00000000000044, 40.70000000000002, 41.70000000000002, 45.3, 22.299999999999876, 45.9, 44.10000000000001, 21.699999999999868, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 7.299999999999663, 44.5, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 44.900000000000006, 42.500000000000014, 43.900000000000006, 10.899999999999714, 19.09999999999983, -50.00000000000044, -50.00000000000044, 43.30000000000001, 40.70000000000002, 19.899999999999842, 45.5, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.900000000000013, -50.00000000000044, 45.5, 31.900000000000013, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 35.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 43.900000000000006, -50.00000000000044, 44.300000000000004, -50.00000000000044, 41.90000000000001, -50.00000000000044, 28.699999999999967, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 29.69999999999998, 44.900000000000006], "episode_lengths": [128, 34, 500, 280, 82, 500, 174, 500, 84, 500, 500, 70, 500, 500, 114, 210, 182, 156, 500, 134, 52, 450, 124, 40, 500, 94, 84, 48, 278, 42, 60, 284, 500, 500, 500, 500, 428, 56, 500, 62, 500, 500, 52, 76, 62, 392, 310, 500, 500, 68, 94, 302, 46, 500, 50, 500, 500, 500, 82, 74, 500, 500, 500, 500, 500, 182, 500, 46, 182, 500, 48, 500, 500, 500, 74, 500, 54, 500, 500, 48, 500, 150, 500, 500, 500, 28, 62, 500, 58, 500, 82, 500, 214, 34, 500, 500, 500, 86, 204, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3754897859259919, "mean_inference_ms": 1.1959213921575977, "mean_action_processing_ms": 0.13760167595664577, "mean_env_wait_ms": 0.08128058822708571, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03200387954711914, "StateBufferConnector_ms": 0.010006427764892578, "ViewRequirementAgentConnector_ms": 0.1199960708618164}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.9070000000002127, "episode_len_mean": 294.62, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [37.300000000000026, 46.699999999999996, -50.00000000000044, 22.099999999999874, 41.90000000000001, -50.00000000000044, 32.700000000000024, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 38.700000000000024, 29.099999999999973, 31.900000000000013, 34.50000000000004, -50.00000000000044, 36.70000000000003, 44.900000000000006, 5.099999999999632, 37.70000000000003, 46.099999999999994, -50.00000000000044, 40.70000000000002, 41.70000000000002, 45.3, 22.299999999999876, 45.9, 44.10000000000001, 21.699999999999868, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 7.299999999999663, 44.5, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 44.900000000000006, 42.500000000000014, 43.900000000000006, 10.899999999999714, 19.09999999999983, -50.00000000000044, -50.00000000000044, 43.30000000000001, 40.70000000000002, 19.899999999999842, 45.5, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.900000000000013, -50.00000000000044, 45.5, 31.900000000000013, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 35.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 43.900000000000006, -50.00000000000044, 44.300000000000004, -50.00000000000044, 41.90000000000001, -50.00000000000044, 28.699999999999967, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 29.69999999999998, 44.900000000000006], "episode_lengths": [128, 34, 500, 280, 82, 500, 174, 500, 84, 500, 500, 70, 500, 500, 114, 210, 182, 156, 500, 134, 52, 450, 124, 40, 500, 94, 84, 48, 278, 42, 60, 284, 500, 500, 500, 500, 428, 56, 500, 62, 500, 500, 52, 76, 62, 392, 310, 500, 500, 68, 94, 302, 46, 500, 50, 500, 500, 500, 82, 74, 500, 500, 500, 500, 500, 182, 500, 46, 182, 500, 48, 500, 500, 500, 74, 500, 54, 500, 500, 48, 500, 150, 500, 500, 500, 28, 62, 500, 58, 500, 82, 500, 214, 34, 500, 500, 500, 86, 204, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3754897859259919, "mean_inference_ms": 1.1959213921575977, "mean_action_processing_ms": 0.13760167595664577, "mean_env_wait_ms": 0.08128058822708571, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03200387954711914, "StateBufferConnector_ms": 0.010006427764892578, "ViewRequirementAgentConnector_ms": 0.1199960708618164}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5700.507218669416, "num_env_steps_trained_throughput_per_sec": 5700.507218669416, "timesteps_total": 336000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 336000, "timers": {"training_iteration_time_ms": 2153.692, "sample_time_ms": 1901.599, "load_time_ms": 11.902, "load_throughput": 1008242.114, "learn_time_ms": 229.583, "learn_throughput": 52268.646, "synch_weights_time_ms": 9.149}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "done": false, "episodes_total": 1232, "training_iteration": 28, "trial_id": "9f288_00016", "date": "2023-10-25_16-52-34", "timestamp": 1698249154, "time_this_iter_s": 2.1108572483062744, "time_total_s": 60.717519998550415, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 60.717519998550415, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 55.5, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.45058059692383e-10, "cur_lr": 0.0003, "total_loss": 6.841423061158922, "policy_loss": -0.00012565890534056557, "vf_loss": 6.841604365242852, "vf_explained_var": 6.755193074544271e-07, "kl": 0.00014804950059341436, "entropy": 0.5563667664925257, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 513.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -2.1850000000002137, "episode_len_mean": 297.4, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.500000000000014, 43.900000000000006, 10.899999999999714, 19.09999999999983, -50.00000000000044, -50.00000000000044, 43.30000000000001, 40.70000000000002, 19.899999999999842, 45.5, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.900000000000013, -50.00000000000044, 45.5, 31.900000000000013, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 35.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 43.900000000000006, -50.00000000000044, 44.300000000000004, -50.00000000000044, 41.90000000000001, -50.00000000000044, 28.699999999999967, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 29.69999999999998, 44.900000000000006, -50.00000000000044, 38.300000000000026, 43.900000000000006, -50.00000000000044, -50.00000000000044, 36.10000000000004, 42.70000000000001, 35.30000000000004, 5.499999999999638, -50.00000000000044, 38.10000000000002, -50.00000000000044, 43.50000000000001, 35.10000000000004, 30.9, 46.9, -50.00000000000044, -50.00000000000044, 41.500000000000014, 37.50000000000003, -50.00000000000044, 35.30000000000004, -50.00000000000044, 45.9, -50.00000000000044, 36.10000000000004, 15.699999999999783, 14.09999999999976, -50.00000000000044, 41.70000000000002, -50.00000000000044, 29.299999999999976, -50.00000000000044, 45.9, -50.00000000000044, 22.099999999999874, 42.70000000000001, 12.299999999999734, 44.10000000000001, 44.5, -50.00000000000044, 39.70000000000002, -50.00000000000044], "episode_lengths": [76, 62, 392, 310, 500, 500, 68, 94, 302, 46, 500, 50, 500, 500, 500, 82, 74, 500, 500, 500, 500, 500, 182, 500, 46, 182, 500, 48, 500, 500, 500, 74, 500, 54, 500, 500, 48, 500, 150, 500, 500, 500, 28, 62, 500, 58, 500, 82, 500, 214, 34, 500, 500, 500, 86, 204, 52, 500, 118, 62, 500, 500, 140, 74, 148, 446, 500, 120, 500, 66, 150, 192, 32, 500, 500, 86, 126, 500, 148, 500, 42, 500, 140, 344, 360, 500, 84, 500, 208, 500, 42, 500, 280, 74, 378, 60, 56, 500, 104, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3757687788817322, "mean_inference_ms": 1.1963336719899533, "mean_action_processing_ms": 0.1375902987940434, "mean_env_wait_ms": 0.0811852003523771, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026000499725341797, "StateBufferConnector_ms": 0.005005598068237305, "ViewRequirementAgentConnector_ms": 0.11399197578430176}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -2.1850000000002137, "episode_len_mean": 297.4, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.500000000000014, 43.900000000000006, 10.899999999999714, 19.09999999999983, -50.00000000000044, -50.00000000000044, 43.30000000000001, 40.70000000000002, 19.899999999999842, 45.5, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.900000000000013, -50.00000000000044, 45.5, 31.900000000000013, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 35.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 43.900000000000006, -50.00000000000044, 44.300000000000004, -50.00000000000044, 41.90000000000001, -50.00000000000044, 28.699999999999967, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 29.69999999999998, 44.900000000000006, -50.00000000000044, 38.300000000000026, 43.900000000000006, -50.00000000000044, -50.00000000000044, 36.10000000000004, 42.70000000000001, 35.30000000000004, 5.499999999999638, -50.00000000000044, 38.10000000000002, -50.00000000000044, 43.50000000000001, 35.10000000000004, 30.9, 46.9, -50.00000000000044, -50.00000000000044, 41.500000000000014, 37.50000000000003, -50.00000000000044, 35.30000000000004, -50.00000000000044, 45.9, -50.00000000000044, 36.10000000000004, 15.699999999999783, 14.09999999999976, -50.00000000000044, 41.70000000000002, -50.00000000000044, 29.299999999999976, -50.00000000000044, 45.9, -50.00000000000044, 22.099999999999874, 42.70000000000001, 12.299999999999734, 44.10000000000001, 44.5, -50.00000000000044, 39.70000000000002, -50.00000000000044], "episode_lengths": [76, 62, 392, 310, 500, 500, 68, 94, 302, 46, 500, 50, 500, 500, 500, 82, 74, 500, 500, 500, 500, 500, 182, 500, 46, 182, 500, 48, 500, 500, 500, 74, 500, 54, 500, 500, 48, 500, 150, 500, 500, 500, 28, 62, 500, 58, 500, 82, 500, 214, 34, 500, 500, 500, 86, 204, 52, 500, 118, 62, 500, 500, 140, 74, 148, 446, 500, 120, 500, 66, 150, 192, 32, 500, 500, 86, 126, 500, 148, 500, 42, 500, 140, 344, 360, 500, 84, 500, 208, 500, 42, 500, 280, 74, 378, 60, 56, 500, 104, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3757687788817322, "mean_inference_ms": 1.1963336719899533, "mean_action_processing_ms": 0.1375902987940434, "mean_env_wait_ms": 0.0811852003523771, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026000499725341797, "StateBufferConnector_ms": 0.005005598068237305, "ViewRequirementAgentConnector_ms": 0.11399197578430176}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5340.7622640652535, "num_env_steps_trained_throughput_per_sec": 5340.7622640652535, "timesteps_total": 348000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 348000, "timers": {"training_iteration_time_ms": 2154.267, "sample_time_ms": 1905.632, "load_time_ms": 12.067, "load_throughput": 994411.641, "learn_time_ms": 226.041, "learn_throughput": 53087.729, "synch_weights_time_ms": 9.166}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000}, "done": false, "episodes_total": 1275, "training_iteration": 29, "trial_id": "9f288_00016", "date": "2023-10-25_16-52-36", "timestamp": 1698249156, "time_this_iter_s": 2.2518656253814697, "time_total_s": 62.969385623931885, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 62.969385623931885, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 61.1, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.725290298461915e-10, "cur_lr": 0.0003, "total_loss": 6.8192090723249645, "policy_loss": -0.00023392194675074684, "vf_loss": 6.819498247570461, "vf_explained_var": 2.9471185472276477e-07, "kl": 0.0003867713188275464, "entropy": 0.5513845516575707, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 531.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.937999999999844, "episode_len_mean": 251.32, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 41.500000000000014, 29.69999999999998, 44.900000000000006, -50.00000000000044, 38.300000000000026, 43.900000000000006, -50.00000000000044, -50.00000000000044, 36.10000000000004, 42.70000000000001, 35.30000000000004, 5.499999999999638, -50.00000000000044, 38.10000000000002, -50.00000000000044, 43.50000000000001, 35.10000000000004, 30.9, 46.9, -50.00000000000044, -50.00000000000044, 41.500000000000014, 37.50000000000003, -50.00000000000044, 35.30000000000004, -50.00000000000044, 45.9, -50.00000000000044, 36.10000000000004, 15.699999999999783, 14.09999999999976, -50.00000000000044, 41.70000000000002, -50.00000000000044, 29.299999999999976, -50.00000000000044, 45.9, -50.00000000000044, 22.099999999999874, 42.70000000000001, 12.299999999999734, 44.10000000000001, 44.5, -50.00000000000044, 39.70000000000002, -50.00000000000044, 22.699999999999882, 40.500000000000014, 47.3, 43.50000000000001, 43.10000000000001, 40.500000000000014, 36.30000000000003, 12.299999999999734, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 4.499999999999623, 39.90000000000002, -50.00000000000044, 37.70000000000003, 22.49999999999988, 20.49999999999985, -50.00000000000044, 10.699999999999712, 42.10000000000001, 47.1, 29.69999999999998, 29.299999999999976, 38.90000000000002, 41.500000000000014, 40.30000000000002, 47.3, -50.00000000000044, 39.70000000000002, 46.099999999999994, 43.30000000000001, 40.10000000000002, 30.29999999999999, -50.00000000000044, 43.50000000000001, 47.1, -50.00000000000044, 45.5, 25.899999999999928, 29.099999999999973, 44.300000000000004, -50.00000000000044, 20.49999999999985, 45.3, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 20.49999999999985, 44.10000000000001, 43.900000000000006], "episode_lengths": [500, 500, 86, 204, 52, 500, 118, 62, 500, 500, 140, 74, 148, 446, 500, 120, 500, 66, 150, 192, 32, 500, 500, 86, 126, 500, 148, 500, 42, 500, 140, 344, 360, 500, 84, 500, 208, 500, 42, 500, 280, 74, 378, 60, 56, 500, 104, 500, 274, 96, 28, 66, 70, 96, 138, 378, 500, 500, 500, 76, 456, 102, 500, 124, 276, 296, 500, 394, 80, 30, 204, 208, 112, 86, 98, 28, 500, 104, 40, 68, 100, 198, 500, 66, 30, 500, 46, 242, 210, 58, 500, 296, 48, 500, 500, 70, 500, 296, 60, 62]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37590841445250434, "mean_inference_ms": 1.202984824379584, "mean_action_processing_ms": 0.13754748309062992, "mean_env_wait_ms": 0.08206690523513847, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025546550750732422, "StateBufferConnector_ms": 0.004001617431640625, "ViewRequirementAgentConnector_ms": 0.10597681999206543}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.937999999999844, "episode_len_mean": 251.32, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 41.500000000000014, 29.69999999999998, 44.900000000000006, -50.00000000000044, 38.300000000000026, 43.900000000000006, -50.00000000000044, -50.00000000000044, 36.10000000000004, 42.70000000000001, 35.30000000000004, 5.499999999999638, -50.00000000000044, 38.10000000000002, -50.00000000000044, 43.50000000000001, 35.10000000000004, 30.9, 46.9, -50.00000000000044, -50.00000000000044, 41.500000000000014, 37.50000000000003, -50.00000000000044, 35.30000000000004, -50.00000000000044, 45.9, -50.00000000000044, 36.10000000000004, 15.699999999999783, 14.09999999999976, -50.00000000000044, 41.70000000000002, -50.00000000000044, 29.299999999999976, -50.00000000000044, 45.9, -50.00000000000044, 22.099999999999874, 42.70000000000001, 12.299999999999734, 44.10000000000001, 44.5, -50.00000000000044, 39.70000000000002, -50.00000000000044, 22.699999999999882, 40.500000000000014, 47.3, 43.50000000000001, 43.10000000000001, 40.500000000000014, 36.30000000000003, 12.299999999999734, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 4.499999999999623, 39.90000000000002, -50.00000000000044, 37.70000000000003, 22.49999999999988, 20.49999999999985, -50.00000000000044, 10.699999999999712, 42.10000000000001, 47.1, 29.69999999999998, 29.299999999999976, 38.90000000000002, 41.500000000000014, 40.30000000000002, 47.3, -50.00000000000044, 39.70000000000002, 46.099999999999994, 43.30000000000001, 40.10000000000002, 30.29999999999999, -50.00000000000044, 43.50000000000001, 47.1, -50.00000000000044, 45.5, 25.899999999999928, 29.099999999999973, 44.300000000000004, -50.00000000000044, 20.49999999999985, 45.3, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 20.49999999999985, 44.10000000000001, 43.900000000000006], "episode_lengths": [500, 500, 86, 204, 52, 500, 118, 62, 500, 500, 140, 74, 148, 446, 500, 120, 500, 66, 150, 192, 32, 500, 500, 86, 126, 500, 148, 500, 42, 500, 140, 344, 360, 500, 84, 500, 208, 500, 42, 500, 280, 74, 378, 60, 56, 500, 104, 500, 274, 96, 28, 66, 70, 96, 138, 378, 500, 500, 500, 76, 456, 102, 500, 124, 276, 296, 500, 394, 80, 30, 204, 208, 112, 86, 98, 28, 500, 104, 40, 68, 100, 198, 500, 66, 30, 500, 46, 242, 210, 58, 500, 296, 48, 500, 500, 70, 500, 296, 60, 62]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37590841445250434, "mean_inference_ms": 1.202984824379584, "mean_action_processing_ms": 0.13754748309062992, "mean_env_wait_ms": 0.08206690523513847, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025546550750732422, "StateBufferConnector_ms": 0.004001617431640625, "ViewRequirementAgentConnector_ms": 0.10597681999206543}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4785.2637337468705, "num_env_steps_trained_throughput_per_sec": 4785.2637337468705, "timesteps_total": 360000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 360000, "timers": {"training_iteration_time_ms": 2200.843, "sample_time_ms": 1948.575, "load_time_ms": 12.055, "load_throughput": 995457.949, "learn_time_ms": 229.627, "learn_throughput": 52258.774, "synch_weights_time_ms": 9.172}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "done": false, "episodes_total": 1327, "training_iteration": 30, "trial_id": "9f288_00016", "date": "2023-10-25_16-52-39", "timestamp": 1698249159, "time_this_iter_s": 2.5126945972442627, "time_total_s": 65.48208022117615, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 65.48208022117615, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 63.275, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.8626451492309574e-10, "cur_lr": 0.0003, "total_loss": 6.460535473293728, "policy_loss": -0.00031631108787324693, "vf_loss": 6.460906823476155, "vf_explained_var": -1.0927518208821614e-07, "kl": 0.0003931584264636159, "entropy": 0.5508562011851205, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 549.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.60899999999984, "episode_len_mean": 249.58, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.10000000000001, 44.5, -50.00000000000044, 39.70000000000002, -50.00000000000044, 22.699999999999882, 40.500000000000014, 47.3, 43.50000000000001, 43.10000000000001, 40.500000000000014, 36.30000000000003, 12.299999999999734, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 4.499999999999623, 39.90000000000002, -50.00000000000044, 37.70000000000003, 22.49999999999988, 20.49999999999985, -50.00000000000044, 10.699999999999712, 42.10000000000001, 47.1, 29.69999999999998, 29.299999999999976, 38.90000000000002, 41.500000000000014, 40.30000000000002, 47.3, -50.00000000000044, 39.70000000000002, 46.099999999999994, 43.30000000000001, 40.10000000000002, 30.29999999999999, -50.00000000000044, 43.50000000000001, 47.1, -50.00000000000044, 45.5, 25.899999999999928, 29.099999999999973, 44.300000000000004, -50.00000000000044, 20.49999999999985, 45.3, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 20.49999999999985, 44.10000000000001, 43.900000000000006, -50.00000000000044, -50.00000000000044, 38.50000000000003, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.099999999999973, -50.00000000000044, 42.30000000000001, -50.00000000000044, 43.30000000000001, 45.5, 36.50000000000003, 37.90000000000003, 32.30000000000002, -50.00000000000044, 43.7, -50.00000000000044, 45.3, 38.700000000000024, -50.00000000000044, 32.30000000000002, 18.699999999999825, -50.00000000000044, 43.900000000000006, -50.00000000000044, 43.7, 40.70000000000002, 44.7, -50.00000000000044, 40.30000000000002, 35.900000000000034, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 45.3, 41.30000000000001], "episode_lengths": [60, 56, 500, 104, 500, 274, 96, 28, 66, 70, 96, 138, 378, 500, 500, 500, 76, 456, 102, 500, 124, 276, 296, 500, 394, 80, 30, 204, 208, 112, 86, 98, 28, 500, 104, 40, 68, 100, 198, 500, 66, 30, 500, 46, 242, 210, 58, 500, 296, 48, 500, 500, 70, 500, 296, 60, 62, 500, 500, 116, 500, 500, 94, 500, 42, 500, 500, 500, 210, 500, 78, 500, 68, 46, 136, 122, 178, 500, 64, 500, 48, 114, 500, 178, 314, 500, 62, 500, 64, 94, 54, 500, 98, 142, 500, 70, 500, 500, 48, 88]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37566431925936866, "mean_inference_ms": 1.2087599853148563, "mean_action_processing_ms": 0.13743055879278476, "mean_env_wait_ms": 0.08228320533631649, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02754831314086914, "StateBufferConnector_ms": 0.007999420166015625, "ViewRequirementAgentConnector_ms": 0.11699748039245605}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.60899999999984, "episode_len_mean": 249.58, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.10000000000001, 44.5, -50.00000000000044, 39.70000000000002, -50.00000000000044, 22.699999999999882, 40.500000000000014, 47.3, 43.50000000000001, 43.10000000000001, 40.500000000000014, 36.30000000000003, 12.299999999999734, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 4.499999999999623, 39.90000000000002, -50.00000000000044, 37.70000000000003, 22.49999999999988, 20.49999999999985, -50.00000000000044, 10.699999999999712, 42.10000000000001, 47.1, 29.69999999999998, 29.299999999999976, 38.90000000000002, 41.500000000000014, 40.30000000000002, 47.3, -50.00000000000044, 39.70000000000002, 46.099999999999994, 43.30000000000001, 40.10000000000002, 30.29999999999999, -50.00000000000044, 43.50000000000001, 47.1, -50.00000000000044, 45.5, 25.899999999999928, 29.099999999999973, 44.300000000000004, -50.00000000000044, 20.49999999999985, 45.3, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 20.49999999999985, 44.10000000000001, 43.900000000000006, -50.00000000000044, -50.00000000000044, 38.50000000000003, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.099999999999973, -50.00000000000044, 42.30000000000001, -50.00000000000044, 43.30000000000001, 45.5, 36.50000000000003, 37.90000000000003, 32.30000000000002, -50.00000000000044, 43.7, -50.00000000000044, 45.3, 38.700000000000024, -50.00000000000044, 32.30000000000002, 18.699999999999825, -50.00000000000044, 43.900000000000006, -50.00000000000044, 43.7, 40.70000000000002, 44.7, -50.00000000000044, 40.30000000000002, 35.900000000000034, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 45.3, 41.30000000000001], "episode_lengths": [60, 56, 500, 104, 500, 274, 96, 28, 66, 70, 96, 138, 378, 500, 500, 500, 76, 456, 102, 500, 124, 276, 296, 500, 394, 80, 30, 204, 208, 112, 86, 98, 28, 500, 104, 40, 68, 100, 198, 500, 66, 30, 500, 46, 242, 210, 58, 500, 296, 48, 500, 500, 70, 500, 296, 60, 62, 500, 500, 116, 500, 500, 94, 500, 42, 500, 500, 500, 210, 500, 78, 500, 68, 46, 136, 122, 178, 500, 64, 500, 48, 114, 500, 178, 314, 500, 62, 500, 64, 94, 54, 500, 98, 142, 500, 70, 500, 500, 48, 88]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37566431925936866, "mean_inference_ms": 1.2087599853148563, "mean_action_processing_ms": 0.13743055879278476, "mean_env_wait_ms": 0.08228320533631649, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02754831314086914, "StateBufferConnector_ms": 0.007999420166015625, "ViewRequirementAgentConnector_ms": 0.11699748039245605}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5370.125114590215, "num_env_steps_trained_throughput_per_sec": 5370.125114590215, "timesteps_total": 372000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 372000, "timers": {"training_iteration_time_ms": 2209.332, "sample_time_ms": 1954.756, "load_time_ms": 12.277, "load_throughput": 977465.393, "learn_time_ms": 231.636, "learn_throughput": 51805.408, "synch_weights_time_ms": 9.048}, "counters": {"num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000}, "done": false, "episodes_total": 1370, "training_iteration": 31, "trial_id": "9f288_00016", "date": "2023-10-25_16-52-41", "timestamp": 1698249161, "time_this_iter_s": 2.238579034805298, "time_total_s": 67.72065925598145, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 67.72065925598145, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 60.06666666666666, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.313225746154787e-11, "cur_lr": 0.0003, "total_loss": 7.033305433061388, "policy_loss": -0.000349451063407792, "vf_loss": 7.033708837297228, "vf_explained_var": -3.311369154188368e-08, "kl": 0.000631406120242496, "entropy": 0.5397130482726626, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 567.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.448999999999836, "episode_len_mean": 251.14, "episode_media": {}, "episodes_this_iter": 55, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.10000000000001, 43.900000000000006, -50.00000000000044, -50.00000000000044, 38.50000000000003, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.099999999999973, -50.00000000000044, 42.30000000000001, -50.00000000000044, 43.30000000000001, 45.5, 36.50000000000003, 37.90000000000003, 32.30000000000002, -50.00000000000044, 43.7, -50.00000000000044, 45.3, 38.700000000000024, -50.00000000000044, 32.30000000000002, 18.699999999999825, -50.00000000000044, 43.900000000000006, -50.00000000000044, 43.7, 40.70000000000002, 44.7, -50.00000000000044, 40.30000000000002, 35.900000000000034, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 45.3, 41.30000000000001, -50.00000000000044, 45.3, 26.89999999999994, 47.1, 37.70000000000003, 38.10000000000002, 30.499999999999993, -50.00000000000044, 44.5, 38.10000000000002, 45.1, 47.3, 39.90000000000002, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.7, 38.90000000000002, 46.5, 41.70000000000002, -50.00000000000044, 41.70000000000002, -50.00000000000044, 45.9, 45.9, 42.70000000000001, -50.00000000000044, -50.00000000000044, 34.10000000000004, 42.70000000000001, -50.00000000000044, 42.500000000000014, 41.90000000000001, 27.099999999999945, 45.3, 46.099999999999994, -50.00000000000044, -50.00000000000044, 13.899999999999757, 38.90000000000002, 44.900000000000006, -50.00000000000044, 40.10000000000002, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.900000000000034, 28.29999999999996, 20.899999999999856, 35.30000000000004, 43.10000000000001], "episode_lengths": [60, 62, 500, 500, 116, 500, 500, 94, 500, 42, 500, 500, 500, 210, 500, 78, 500, 68, 46, 136, 122, 178, 500, 64, 500, 48, 114, 500, 178, 314, 500, 62, 500, 64, 94, 54, 500, 98, 142, 500, 70, 500, 500, 48, 88, 500, 48, 232, 30, 124, 120, 196, 500, 56, 120, 50, 28, 102, 40, 500, 500, 54, 112, 36, 84, 500, 84, 500, 42, 42, 74, 500, 500, 160, 74, 500, 76, 82, 230, 48, 40, 500, 500, 362, 112, 52, 500, 100, 500, 94, 500, 500, 500, 500, 500, 132, 218, 292, 148, 70]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3755891921345044, "mean_inference_ms": 1.2090976797206974, "mean_action_processing_ms": 0.13770089816635145, "mean_env_wait_ms": 0.0821359048780463, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026999235153198242, "StateBufferConnector_ms": 0.00901341438293457, "ViewRequirementAgentConnector_ms": 0.12678861618041992}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.448999999999836, "episode_len_mean": 251.14, "episodes_this_iter": 55, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.10000000000001, 43.900000000000006, -50.00000000000044, -50.00000000000044, 38.50000000000003, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.099999999999973, -50.00000000000044, 42.30000000000001, -50.00000000000044, 43.30000000000001, 45.5, 36.50000000000003, 37.90000000000003, 32.30000000000002, -50.00000000000044, 43.7, -50.00000000000044, 45.3, 38.700000000000024, -50.00000000000044, 32.30000000000002, 18.699999999999825, -50.00000000000044, 43.900000000000006, -50.00000000000044, 43.7, 40.70000000000002, 44.7, -50.00000000000044, 40.30000000000002, 35.900000000000034, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 45.3, 41.30000000000001, -50.00000000000044, 45.3, 26.89999999999994, 47.1, 37.70000000000003, 38.10000000000002, 30.499999999999993, -50.00000000000044, 44.5, 38.10000000000002, 45.1, 47.3, 39.90000000000002, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.7, 38.90000000000002, 46.5, 41.70000000000002, -50.00000000000044, 41.70000000000002, -50.00000000000044, 45.9, 45.9, 42.70000000000001, -50.00000000000044, -50.00000000000044, 34.10000000000004, 42.70000000000001, -50.00000000000044, 42.500000000000014, 41.90000000000001, 27.099999999999945, 45.3, 46.099999999999994, -50.00000000000044, -50.00000000000044, 13.899999999999757, 38.90000000000002, 44.900000000000006, -50.00000000000044, 40.10000000000002, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.900000000000034, 28.29999999999996, 20.899999999999856, 35.30000000000004, 43.10000000000001], "episode_lengths": [60, 62, 500, 500, 116, 500, 500, 94, 500, 42, 500, 500, 500, 210, 500, 78, 500, 68, 46, 136, 122, 178, 500, 64, 500, 48, 114, 500, 178, 314, 500, 62, 500, 64, 94, 54, 500, 98, 142, 500, 70, 500, 500, 48, 88, 500, 48, 232, 30, 124, 120, 196, 500, 56, 120, 50, 28, 102, 40, 500, 500, 54, 112, 36, 84, 500, 84, 500, 42, 42, 74, 500, 500, 160, 74, 500, 76, 82, 230, 48, 40, 500, 500, 362, 112, 52, 500, 100, 500, 94, 500, 500, 500, 500, 500, 132, 218, 292, 148, 70]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3755891921345044, "mean_inference_ms": 1.2090976797206974, "mean_action_processing_ms": 0.13770089816635145, "mean_env_wait_ms": 0.0821359048780463, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026999235153198242, "StateBufferConnector_ms": 0.00901341438293457, "ViewRequirementAgentConnector_ms": 0.12678861618041992}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5644.535123884686, "num_env_steps_trained_throughput_per_sec": 5644.535123884686, "timesteps_total": 384000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 384000, "timers": {"training_iteration_time_ms": 2217.376, "sample_time_ms": 1958.824, "load_time_ms": 12.16, "load_throughput": 986811.857, "learn_time_ms": 235.585, "learn_throughput": 50936.973, "synch_weights_time_ms": 9.192}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "done": false, "episodes_total": 1425, "training_iteration": 32, "trial_id": "9f288_00016", "date": "2023-10-25_16-52-43", "timestamp": 1698249163, "time_this_iter_s": 2.131972074508667, "time_total_s": 69.85263133049011, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 69.85263133049011, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 56.56666666666666, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.6566128730773935e-11, "cur_lr": 0.0003, "total_loss": 6.258715020285712, "policy_loss": 1.9915401935577393e-05, "vf_loss": 6.258744610680474, "vf_explained_var": -1.3344817691379123e-06, "kl": 3.940187137156196e-05, "entropy": 0.4956535730097029, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 585.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.640999999999825, "episode_len_mean": 259.2, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 45.3, 41.30000000000001, -50.00000000000044, 45.3, 26.89999999999994, 47.1, 37.70000000000003, 38.10000000000002, 30.499999999999993, -50.00000000000044, 44.5, 38.10000000000002, 45.1, 47.3, 39.90000000000002, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.7, 38.90000000000002, 46.5, 41.70000000000002, -50.00000000000044, 41.70000000000002, -50.00000000000044, 45.9, 45.9, 42.70000000000001, -50.00000000000044, -50.00000000000044, 34.10000000000004, 42.70000000000001, -50.00000000000044, 42.500000000000014, 41.90000000000001, 27.099999999999945, 45.3, 46.099999999999994, -50.00000000000044, -50.00000000000044, 13.899999999999757, 38.90000000000002, 44.900000000000006, -50.00000000000044, 40.10000000000002, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.900000000000034, 28.29999999999996, 20.899999999999856, 35.30000000000004, 43.10000000000001, 41.70000000000002, 45.1, 42.30000000000001, -50.00000000000044, 46.9, 22.699999999999882, -50.00000000000044, 43.50000000000001, 45.1, -50.00000000000044, -50.00000000000044, 34.50000000000004, 29.299999999999976, 43.50000000000001, 44.5, 43.900000000000006, -50.00000000000044, -50.00000000000044, 47.9, 30.29999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 10.499999999999709, 41.90000000000001, -50.00000000000044, -50.00000000000044, 34.900000000000034, 40.70000000000002, 41.90000000000001, 45.7, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1], "episode_lengths": [500, 500, 48, 88, 500, 48, 232, 30, 124, 120, 196, 500, 56, 120, 50, 28, 102, 40, 500, 500, 54, 112, 36, 84, 500, 84, 500, 42, 42, 74, 500, 500, 160, 74, 500, 76, 82, 230, 48, 40, 500, 500, 362, 112, 52, 500, 100, 500, 94, 500, 500, 500, 500, 500, 132, 218, 292, 148, 70, 84, 50, 78, 500, 32, 274, 500, 66, 50, 500, 500, 156, 208, 66, 56, 62, 500, 500, 22, 198, 500, 500, 500, 500, 500, 396, 82, 500, 500, 152, 94, 82, 44, 500, 500, 38, 500, 500, 500, 500, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37595553182220987, "mean_inference_ms": 1.2085971967054667, "mean_action_processing_ms": 0.13759429463530706, "mean_env_wait_ms": 0.08246056963031043, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023993253707885742, "StateBufferConnector_ms": 0.005012989044189453, "ViewRequirementAgentConnector_ms": 0.1192774772644043}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.640999999999825, "episode_len_mean": 259.2, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 45.3, 41.30000000000001, -50.00000000000044, 45.3, 26.89999999999994, 47.1, 37.70000000000003, 38.10000000000002, 30.499999999999993, -50.00000000000044, 44.5, 38.10000000000002, 45.1, 47.3, 39.90000000000002, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.7, 38.90000000000002, 46.5, 41.70000000000002, -50.00000000000044, 41.70000000000002, -50.00000000000044, 45.9, 45.9, 42.70000000000001, -50.00000000000044, -50.00000000000044, 34.10000000000004, 42.70000000000001, -50.00000000000044, 42.500000000000014, 41.90000000000001, 27.099999999999945, 45.3, 46.099999999999994, -50.00000000000044, -50.00000000000044, 13.899999999999757, 38.90000000000002, 44.900000000000006, -50.00000000000044, 40.10000000000002, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.900000000000034, 28.29999999999996, 20.899999999999856, 35.30000000000004, 43.10000000000001, 41.70000000000002, 45.1, 42.30000000000001, -50.00000000000044, 46.9, 22.699999999999882, -50.00000000000044, 43.50000000000001, 45.1, -50.00000000000044, -50.00000000000044, 34.50000000000004, 29.299999999999976, 43.50000000000001, 44.5, 43.900000000000006, -50.00000000000044, -50.00000000000044, 47.9, 30.29999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 10.499999999999709, 41.90000000000001, -50.00000000000044, -50.00000000000044, 34.900000000000034, 40.70000000000002, 41.90000000000001, 45.7, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1], "episode_lengths": [500, 500, 48, 88, 500, 48, 232, 30, 124, 120, 196, 500, 56, 120, 50, 28, 102, 40, 500, 500, 54, 112, 36, 84, 500, 84, 500, 42, 42, 74, 500, 500, 160, 74, 500, 76, 82, 230, 48, 40, 500, 500, 362, 112, 52, 500, 100, 500, 94, 500, 500, 500, 500, 500, 132, 218, 292, 148, 70, 84, 50, 78, 500, 32, 274, 500, 66, 50, 500, 500, 156, 208, 66, 56, 62, 500, 500, 22, 198, 500, 500, 500, 500, 500, 396, 82, 500, 500, 152, 94, 82, 44, 500, 500, 38, 500, 500, 500, 500, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37595553182220987, "mean_inference_ms": 1.2085971967054667, "mean_action_processing_ms": 0.13759429463530706, "mean_env_wait_ms": 0.08246056963031043, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023993253707885742, "StateBufferConnector_ms": 0.005012989044189453, "ViewRequirementAgentConnector_ms": 0.1192774772644043}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5439.355762745513, "num_env_steps_trained_throughput_per_sec": 5439.355762745513, "timesteps_total": 396000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 396000, "timers": {"training_iteration_time_ms": 2218.462, "sample_time_ms": 1959.338, "load_time_ms": 12.773, "load_throughput": 939484.262, "learn_time_ms": 235.548, "learn_throughput": 50944.949, "synch_weights_time_ms": 9.289}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "done": false, "episodes_total": 1466, "training_iteration": 33, "trial_id": "9f288_00016", "date": "2023-10-25_16-52-45", "timestamp": 1698249165, "time_this_iter_s": 2.211137056350708, "time_total_s": 72.06376838684082, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 72.06376838684082, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 59.96666666666667, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.3283064365386967e-11, "cur_lr": 0.0003, "total_loss": 6.444993098576863, "policy_loss": 1.3494398444890976e-05, "vf_loss": 6.445031113094753, "vf_explained_var": -1.1987156338161892e-06, "kl": 7.082854462107473e-05, "entropy": 0.5162625577714708, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 603.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.1300000000002102, "episode_len_mean": 291.86, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 13.899999999999757, 38.90000000000002, 44.900000000000006, -50.00000000000044, 40.10000000000002, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.900000000000034, 28.29999999999996, 20.899999999999856, 35.30000000000004, 43.10000000000001, 41.70000000000002, 45.1, 42.30000000000001, -50.00000000000044, 46.9, 22.699999999999882, -50.00000000000044, 43.50000000000001, 45.1, -50.00000000000044, -50.00000000000044, 34.50000000000004, 29.299999999999976, 43.50000000000001, 44.5, 43.900000000000006, -50.00000000000044, -50.00000000000044, 47.9, 30.29999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 10.499999999999709, 41.90000000000001, -50.00000000000044, -50.00000000000044, 34.900000000000034, 40.70000000000002, 41.90000000000001, 45.7, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 20.099999999999845, 44.900000000000006, -50.00000000000044, 47.3, 44.7, -50.00000000000044, 20.099999999999845, 21.699999999999868, -50.00000000000044, 44.900000000000006, 29.49999999999998, -50.00000000000044, 47.7, 41.70000000000002, 35.70000000000003, -50.00000000000044, 6.8999999999996575, 43.30000000000001, 42.10000000000001, 44.10000000000001, -50.00000000000044, -50.00000000000044, 42.70000000000001, 42.900000000000006, 41.90000000000001, -50.00000000000044, 3.699999999999612, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.10000000000002, -50.00000000000044, -50.00000000000044, 41.100000000000016, 40.500000000000014], "episode_lengths": [500, 500, 362, 112, 52, 500, 100, 500, 94, 500, 500, 500, 500, 500, 132, 218, 292, 148, 70, 84, 50, 78, 500, 32, 274, 500, 66, 50, 500, 500, 156, 208, 66, 56, 62, 500, 500, 22, 198, 500, 500, 500, 500, 500, 396, 82, 500, 500, 152, 94, 82, 44, 500, 500, 38, 500, 500, 500, 500, 30, 300, 52, 500, 28, 54, 500, 300, 284, 500, 52, 206, 500, 24, 84, 144, 500, 432, 68, 80, 60, 500, 500, 74, 72, 82, 500, 464, 500, 500, 74, 500, 46, 500, 500, 500, 120, 500, 500, 90, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3760724475131608, "mean_inference_ms": 1.2092047561617834, "mean_action_processing_ms": 0.13744665240189036, "mean_env_wait_ms": 0.0827956817008887, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027448177337646484, "StateBufferConnector_ms": 0.0040280818939208984, "ViewRequirementAgentConnector_ms": 0.1155400276184082}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.1300000000002102, "episode_len_mean": 291.86, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 13.899999999999757, 38.90000000000002, 44.900000000000006, -50.00000000000044, 40.10000000000002, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.900000000000034, 28.29999999999996, 20.899999999999856, 35.30000000000004, 43.10000000000001, 41.70000000000002, 45.1, 42.30000000000001, -50.00000000000044, 46.9, 22.699999999999882, -50.00000000000044, 43.50000000000001, 45.1, -50.00000000000044, -50.00000000000044, 34.50000000000004, 29.299999999999976, 43.50000000000001, 44.5, 43.900000000000006, -50.00000000000044, -50.00000000000044, 47.9, 30.29999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 10.499999999999709, 41.90000000000001, -50.00000000000044, -50.00000000000044, 34.900000000000034, 40.70000000000002, 41.90000000000001, 45.7, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 20.099999999999845, 44.900000000000006, -50.00000000000044, 47.3, 44.7, -50.00000000000044, 20.099999999999845, 21.699999999999868, -50.00000000000044, 44.900000000000006, 29.49999999999998, -50.00000000000044, 47.7, 41.70000000000002, 35.70000000000003, -50.00000000000044, 6.8999999999996575, 43.30000000000001, 42.10000000000001, 44.10000000000001, -50.00000000000044, -50.00000000000044, 42.70000000000001, 42.900000000000006, 41.90000000000001, -50.00000000000044, 3.699999999999612, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.10000000000002, -50.00000000000044, -50.00000000000044, 41.100000000000016, 40.500000000000014], "episode_lengths": [500, 500, 362, 112, 52, 500, 100, 500, 94, 500, 500, 500, 500, 500, 132, 218, 292, 148, 70, 84, 50, 78, 500, 32, 274, 500, 66, 50, 500, 500, 156, 208, 66, 56, 62, 500, 500, 22, 198, 500, 500, 500, 500, 500, 396, 82, 500, 500, 152, 94, 82, 44, 500, 500, 38, 500, 500, 500, 500, 30, 300, 52, 500, 28, 54, 500, 300, 284, 500, 52, 206, 500, 24, 84, 144, 500, 432, 68, 80, 60, 500, 500, 74, 72, 82, 500, 464, 500, 500, 74, 500, 46, 500, 500, 500, 120, 500, 500, 90, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3760724475131608, "mean_inference_ms": 1.2092047561617834, "mean_action_processing_ms": 0.13744665240189036, "mean_env_wait_ms": 0.0827956817008887, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027448177337646484, "StateBufferConnector_ms": 0.0040280818939208984, "ViewRequirementAgentConnector_ms": 0.1155400276184082}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5934.863439525745, "num_env_steps_trained_throughput_per_sec": 5934.863439525745, "timesteps_total": 408000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 408000, "timers": {"training_iteration_time_ms": 2208.046, "sample_time_ms": 1955.391, "load_time_ms": 12.303, "load_throughput": 975347.707, "learn_time_ms": 229.545, "learn_throughput": 52277.419, "synch_weights_time_ms": 9.192}, "counters": {"num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000}, "done": false, "episodes_total": 1506, "training_iteration": 34, "trial_id": "9f288_00016", "date": "2023-10-25_16-52-47", "timestamp": 1698249167, "time_this_iter_s": 2.0259487628936768, "time_total_s": 74.0897171497345, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 74.0897171497345, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 56.96666666666667, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1641532182693484e-11, "cur_lr": 0.0003, "total_loss": 6.258650832706028, "policy_loss": -0.00026238550587246817, "vf_loss": 6.2589601675669355, "vf_explained_var": -4.40412097507053e-07, "kl": 0.00041830994076027156, "entropy": 0.46843260526657104, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 621.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.3119999999998115, "episode_len_mean": 267.48, "episode_media": {}, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.70000000000002, 41.90000000000001, 45.7, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 20.099999999999845, 44.900000000000006, -50.00000000000044, 47.3, 44.7, -50.00000000000044, 20.099999999999845, 21.699999999999868, -50.00000000000044, 44.900000000000006, 29.49999999999998, -50.00000000000044, 47.7, 41.70000000000002, 35.70000000000003, -50.00000000000044, 6.8999999999996575, 43.30000000000001, 42.10000000000001, 44.10000000000001, -50.00000000000044, -50.00000000000044, 42.70000000000001, 42.900000000000006, 41.90000000000001, -50.00000000000044, 3.699999999999612, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.10000000000002, -50.00000000000044, -50.00000000000044, 41.100000000000016, 40.500000000000014, -50.00000000000044, 42.10000000000001, -50.00000000000044, 45.7, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.300000000000026, 43.30000000000001, 46.9, 40.90000000000002, 45.9, 47.5, -50.00000000000044, -50.00000000000044, 9.8999999999997, -50.00000000000044, 45.7, 45.9, 43.7, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 18.699999999999825, -50.00000000000044, -50.00000000000044, 43.30000000000001, 44.5, -50.00000000000044, 41.90000000000001, 35.30000000000004, 22.699999999999882, 40.90000000000002, 40.70000000000002, 44.5, 45.9, 35.10000000000004, -50.00000000000044, 35.70000000000003, 35.900000000000034, 46.9, -50.00000000000044, -50.00000000000044, 44.5, 37.70000000000003, 35.900000000000034, -50.00000000000044], "episode_lengths": [94, 82, 44, 500, 500, 38, 500, 500, 500, 500, 30, 300, 52, 500, 28, 54, 500, 300, 284, 500, 52, 206, 500, 24, 84, 144, 500, 432, 68, 80, 60, 500, 500, 74, 72, 82, 500, 464, 500, 500, 74, 500, 46, 500, 500, 500, 120, 500, 500, 90, 96, 500, 80, 500, 44, 52, 500, 500, 500, 108, 68, 32, 92, 42, 26, 500, 500, 402, 500, 44, 42, 64, 62, 500, 500, 500, 314, 500, 500, 68, 56, 500, 82, 148, 274, 92, 94, 56, 42, 150, 500, 144, 142, 32, 500, 500, 56, 124, 142, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3757761020402951, "mean_inference_ms": 1.2078716676233803, "mean_action_processing_ms": 0.13756596951067657, "mean_env_wait_ms": 0.08244704535465194, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024967670440673828, "StateBufferConnector_ms": 0.0010266304016113281, "ViewRequirementAgentConnector_ms": 0.12027716636657715}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.3119999999998115, "episode_len_mean": 267.48, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [40.70000000000002, 41.90000000000001, 45.7, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 20.099999999999845, 44.900000000000006, -50.00000000000044, 47.3, 44.7, -50.00000000000044, 20.099999999999845, 21.699999999999868, -50.00000000000044, 44.900000000000006, 29.49999999999998, -50.00000000000044, 47.7, 41.70000000000002, 35.70000000000003, -50.00000000000044, 6.8999999999996575, 43.30000000000001, 42.10000000000001, 44.10000000000001, -50.00000000000044, -50.00000000000044, 42.70000000000001, 42.900000000000006, 41.90000000000001, -50.00000000000044, 3.699999999999612, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.10000000000002, -50.00000000000044, -50.00000000000044, 41.100000000000016, 40.500000000000014, -50.00000000000044, 42.10000000000001, -50.00000000000044, 45.7, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.300000000000026, 43.30000000000001, 46.9, 40.90000000000002, 45.9, 47.5, -50.00000000000044, -50.00000000000044, 9.8999999999997, -50.00000000000044, 45.7, 45.9, 43.7, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 18.699999999999825, -50.00000000000044, -50.00000000000044, 43.30000000000001, 44.5, -50.00000000000044, 41.90000000000001, 35.30000000000004, 22.699999999999882, 40.90000000000002, 40.70000000000002, 44.5, 45.9, 35.10000000000004, -50.00000000000044, 35.70000000000003, 35.900000000000034, 46.9, -50.00000000000044, -50.00000000000044, 44.5, 37.70000000000003, 35.900000000000034, -50.00000000000044], "episode_lengths": [94, 82, 44, 500, 500, 38, 500, 500, 500, 500, 30, 300, 52, 500, 28, 54, 500, 300, 284, 500, 52, 206, 500, 24, 84, 144, 500, 432, 68, 80, 60, 500, 500, 74, 72, 82, 500, 464, 500, 500, 74, 500, 46, 500, 500, 500, 120, 500, 500, 90, 96, 500, 80, 500, 44, 52, 500, 500, 500, 108, 68, 32, 92, 42, 26, 500, 500, 402, 500, 44, 42, 64, 62, 500, 500, 500, 314, 500, 500, 68, 56, 500, 82, 148, 274, 92, 94, 56, 42, 150, 500, 144, 142, 32, 500, 500, 56, 124, 142, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3757761020402951, "mean_inference_ms": 1.2078716676233803, "mean_action_processing_ms": 0.13756596951067657, "mean_env_wait_ms": 0.08244704535465194, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024967670440673828, "StateBufferConnector_ms": 0.0010266304016113281, "ViewRequirementAgentConnector_ms": 0.12027716636657715}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5806.949536111109, "num_env_steps_trained_throughput_per_sec": 5806.949536111109, "timesteps_total": 420000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 420000, "timers": {"training_iteration_time_ms": 2185.212, "sample_time_ms": 1944.474, "load_time_ms": 11.633, "load_throughput": 1031540.538, "learn_time_ms": 218.058, "learn_throughput": 55031.112, "synch_weights_time_ms": 9.29}, "counters": {"num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000}, "done": false, "episodes_total": 1555, "training_iteration": 35, "trial_id": "9f288_00016", "date": "2023-10-25_16-52-49", "timestamp": 1698249169, "time_this_iter_s": 2.0724871158599854, "time_total_s": 76.16220426559448, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 76.16220426559448, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 61.5, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.820766091346742e-12, "cur_lr": 0.0003, "total_loss": 6.763173474205865, "policy_loss": -0.0003562577896647983, "vf_loss": 6.7635731432172985, "vf_explained_var": 4.039870368109809e-07, "kl": 0.00030978858113586385, "entropy": 0.4356758263376024, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 639.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.300999999999842, "episode_len_mean": 232.66, "episode_media": {}, "episodes_this_iter": 56, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 39.300000000000026, 43.30000000000001, 46.9, 40.90000000000002, 45.9, 47.5, -50.00000000000044, -50.00000000000044, 9.8999999999997, -50.00000000000044, 45.7, 45.9, 43.7, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 18.699999999999825, -50.00000000000044, -50.00000000000044, 43.30000000000001, 44.5, -50.00000000000044, 41.90000000000001, 35.30000000000004, 22.699999999999882, 40.90000000000002, 40.70000000000002, 44.5, 45.9, 35.10000000000004, -50.00000000000044, 35.70000000000003, 35.900000000000034, 46.9, -50.00000000000044, -50.00000000000044, 44.5, 37.70000000000003, 35.900000000000034, -50.00000000000044, -50.00000000000044, 46.3, 42.900000000000006, -50.00000000000044, 44.10000000000001, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 43.900000000000006, 39.70000000000002, 16.8999999999998, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 15.099999999999774, 42.70000000000001, 44.7, 46.5, -50.00000000000044, 45.5, 41.100000000000016, -50.00000000000044, 43.10000000000001, 45.3, 9.699999999999697, 46.3, 42.900000000000006, 40.90000000000002, 46.3, 45.5, -50.00000000000044, 45.1, -50.00000000000044, 29.899999999999984, -50.00000000000044, 31.500000000000007, 44.300000000000004, 44.10000000000001, 46.3, -50.00000000000044, 46.699999999999996, 45.9, -50.00000000000044, 17.299999999999805, 46.9, 45.7, -50.00000000000044, 37.10000000000003, 45.3, -50.00000000000044, 43.900000000000006, 40.90000000000002, 40.500000000000014, 45.7], "episode_lengths": [500, 500, 500, 108, 68, 32, 92, 42, 26, 500, 500, 402, 500, 44, 42, 64, 62, 500, 500, 500, 314, 500, 500, 68, 56, 500, 82, 148, 274, 92, 94, 56, 42, 150, 500, 144, 142, 32, 500, 500, 56, 124, 142, 500, 500, 38, 72, 500, 60, 500, 42, 500, 500, 62, 104, 332, 500, 54, 500, 500, 350, 74, 54, 36, 500, 46, 90, 500, 70, 48, 404, 38, 72, 92, 38, 46, 500, 50, 500, 202, 500, 186, 58, 60, 38, 500, 34, 42, 500, 328, 32, 44, 500, 130, 48, 500, 62, 92, 96, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3755033798334587, "mean_inference_ms": 1.2066396525249206, "mean_action_processing_ms": 0.13761456500393254, "mean_env_wait_ms": 0.08222680700452428, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027510404586791992, "StateBufferConnector_ms": 0.004012107849121094, "ViewRequirementAgentConnector_ms": 0.13262295722961426}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.300999999999842, "episode_len_mean": 232.66, "episodes_this_iter": 56, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 39.300000000000026, 43.30000000000001, 46.9, 40.90000000000002, 45.9, 47.5, -50.00000000000044, -50.00000000000044, 9.8999999999997, -50.00000000000044, 45.7, 45.9, 43.7, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 18.699999999999825, -50.00000000000044, -50.00000000000044, 43.30000000000001, 44.5, -50.00000000000044, 41.90000000000001, 35.30000000000004, 22.699999999999882, 40.90000000000002, 40.70000000000002, 44.5, 45.9, 35.10000000000004, -50.00000000000044, 35.70000000000003, 35.900000000000034, 46.9, -50.00000000000044, -50.00000000000044, 44.5, 37.70000000000003, 35.900000000000034, -50.00000000000044, -50.00000000000044, 46.3, 42.900000000000006, -50.00000000000044, 44.10000000000001, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 43.900000000000006, 39.70000000000002, 16.8999999999998, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 15.099999999999774, 42.70000000000001, 44.7, 46.5, -50.00000000000044, 45.5, 41.100000000000016, -50.00000000000044, 43.10000000000001, 45.3, 9.699999999999697, 46.3, 42.900000000000006, 40.90000000000002, 46.3, 45.5, -50.00000000000044, 45.1, -50.00000000000044, 29.899999999999984, -50.00000000000044, 31.500000000000007, 44.300000000000004, 44.10000000000001, 46.3, -50.00000000000044, 46.699999999999996, 45.9, -50.00000000000044, 17.299999999999805, 46.9, 45.7, -50.00000000000044, 37.10000000000003, 45.3, -50.00000000000044, 43.900000000000006, 40.90000000000002, 40.500000000000014, 45.7], "episode_lengths": [500, 500, 500, 108, 68, 32, 92, 42, 26, 500, 500, 402, 500, 44, 42, 64, 62, 500, 500, 500, 314, 500, 500, 68, 56, 500, 82, 148, 274, 92, 94, 56, 42, 150, 500, 144, 142, 32, 500, 500, 56, 124, 142, 500, 500, 38, 72, 500, 60, 500, 42, 500, 500, 62, 104, 332, 500, 54, 500, 500, 350, 74, 54, 36, 500, 46, 90, 500, 70, 48, 404, 38, 72, 92, 38, 46, 500, 50, 500, 202, 500, 186, 58, 60, 38, 500, 34, 42, 500, 328, 32, 44, 500, 130, 48, 500, 62, 92, 96, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3755033798334587, "mean_inference_ms": 1.2066396525249206, "mean_action_processing_ms": 0.13761456500393254, "mean_env_wait_ms": 0.08222680700452428, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027510404586791992, "StateBufferConnector_ms": 0.004012107849121094, "ViewRequirementAgentConnector_ms": 0.13262295722961426}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5353.876455128634, "num_env_steps_trained_throughput_per_sec": 5353.876455128634, "timesteps_total": 432000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 432000, "timers": {"training_iteration_time_ms": 2199.804, "sample_time_ms": 1940.399, "load_time_ms": 12.356, "load_throughput": 971203.458, "learn_time_ms": 235.983, "learn_throughput": 50851.205, "synch_weights_time_ms": 9.311}, "counters": {"num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "done": false, "episodes_total": 1611, "training_iteration": 36, "trial_id": "9f288_00016", "date": "2023-10-25_16-52-52", "timestamp": 1698249172, "time_this_iter_s": 2.2472379207611084, "time_total_s": 78.40944218635559, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 78.40944218635559, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 58.166666666666664, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.910383045673371e-12, "cur_lr": 0.0003, "total_loss": 6.268843412399292, "policy_loss": -1.1506386929088168e-05, "vf_loss": 6.268900023566352, "vf_explained_var": -4.40412097507053e-07, "kl": 0.00011157607316489602, "entropy": 0.45108723640441895, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 657.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_agent_steps_sampled": 444000, "num_agent_steps_trained": 444000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.440999999999834, "episode_len_mean": 241.24, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.5, 37.70000000000003, 35.900000000000034, -50.00000000000044, -50.00000000000044, 46.3, 42.900000000000006, -50.00000000000044, 44.10000000000001, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 43.900000000000006, 39.70000000000002, 16.8999999999998, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 15.099999999999774, 42.70000000000001, 44.7, 46.5, -50.00000000000044, 45.5, 41.100000000000016, -50.00000000000044, 43.10000000000001, 45.3, 9.699999999999697, 46.3, 42.900000000000006, 40.90000000000002, 46.3, 45.5, -50.00000000000044, 45.1, -50.00000000000044, 29.899999999999984, -50.00000000000044, 31.500000000000007, 44.300000000000004, 44.10000000000001, 46.3, -50.00000000000044, 46.699999999999996, 45.9, -50.00000000000044, 17.299999999999805, 46.9, 45.7, -50.00000000000044, 37.10000000000003, 45.3, -50.00000000000044, 43.900000000000006, 40.90000000000002, 40.500000000000014, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 6.8999999999996575, -50.00000000000044, 32.90000000000003, 44.900000000000006, -50.00000000000044, 47.1, 38.700000000000024, -50.00000000000044, 31.300000000000004, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 33.500000000000036, 44.5, -50.00000000000044, 44.900000000000006, -50.00000000000044, 46.5, 47.5, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, 44.7, 46.3, 45.5, -50.00000000000044, 42.900000000000006, -50.00000000000044, 44.5, 42.30000000000001, -50.00000000000044, 36.30000000000003, 26.09999999999993, 22.699999999999882], "episode_lengths": [56, 124, 142, 500, 500, 38, 72, 500, 60, 500, 42, 500, 500, 62, 104, 332, 500, 54, 500, 500, 350, 74, 54, 36, 500, 46, 90, 500, 70, 48, 404, 38, 72, 92, 38, 46, 500, 50, 500, 202, 500, 186, 58, 60, 38, 500, 34, 42, 500, 328, 32, 44, 500, 130, 48, 500, 62, 92, 96, 44, 500, 500, 500, 88, 432, 500, 172, 52, 500, 30, 114, 500, 188, 500, 36, 500, 500, 166, 56, 500, 52, 500, 36, 26, 500, 90, 500, 500, 54, 38, 46, 500, 72, 500, 56, 78, 500, 138, 240, 274]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3755423310779979, "mean_inference_ms": 1.206429040712887, "mean_action_processing_ms": 0.13741840358770516, "mean_env_wait_ms": 0.0824327780259888, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02699875831604004, "StateBufferConnector_ms": 0.0039997100830078125, "ViewRequirementAgentConnector_ms": 0.12546658515930176}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.440999999999834, "episode_len_mean": 241.24, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.5, 37.70000000000003, 35.900000000000034, -50.00000000000044, -50.00000000000044, 46.3, 42.900000000000006, -50.00000000000044, 44.10000000000001, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 43.900000000000006, 39.70000000000002, 16.8999999999998, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 15.099999999999774, 42.70000000000001, 44.7, 46.5, -50.00000000000044, 45.5, 41.100000000000016, -50.00000000000044, 43.10000000000001, 45.3, 9.699999999999697, 46.3, 42.900000000000006, 40.90000000000002, 46.3, 45.5, -50.00000000000044, 45.1, -50.00000000000044, 29.899999999999984, -50.00000000000044, 31.500000000000007, 44.300000000000004, 44.10000000000001, 46.3, -50.00000000000044, 46.699999999999996, 45.9, -50.00000000000044, 17.299999999999805, 46.9, 45.7, -50.00000000000044, 37.10000000000003, 45.3, -50.00000000000044, 43.900000000000006, 40.90000000000002, 40.500000000000014, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 6.8999999999996575, -50.00000000000044, 32.90000000000003, 44.900000000000006, -50.00000000000044, 47.1, 38.700000000000024, -50.00000000000044, 31.300000000000004, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 33.500000000000036, 44.5, -50.00000000000044, 44.900000000000006, -50.00000000000044, 46.5, 47.5, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, 44.7, 46.3, 45.5, -50.00000000000044, 42.900000000000006, -50.00000000000044, 44.5, 42.30000000000001, -50.00000000000044, 36.30000000000003, 26.09999999999993, 22.699999999999882], "episode_lengths": [56, 124, 142, 500, 500, 38, 72, 500, 60, 500, 42, 500, 500, 62, 104, 332, 500, 54, 500, 500, 350, 74, 54, 36, 500, 46, 90, 500, 70, 48, 404, 38, 72, 92, 38, 46, 500, 50, 500, 202, 500, 186, 58, 60, 38, 500, 34, 42, 500, 328, 32, 44, 500, 130, 48, 500, 62, 92, 96, 44, 500, 500, 500, 88, 432, 500, 172, 52, 500, 30, 114, 500, 188, 500, 36, 500, 500, 166, 56, 500, 52, 500, 36, 26, 500, 90, 500, 500, 54, 38, 46, 500, 72, 500, 56, 78, 500, 138, 240, 274]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3755423310779979, "mean_inference_ms": 1.206429040712887, "mean_action_processing_ms": 0.13741840358770516, "mean_env_wait_ms": 0.0824327780259888, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02699875831604004, "StateBufferConnector_ms": 0.0039997100830078125, "ViewRequirementAgentConnector_ms": 0.12546658515930176}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 444000, "num_agent_steps_trained": 444000, "num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5729.011707836116, "num_env_steps_trained_throughput_per_sec": 5729.011707836116, "timesteps_total": 444000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 444000, "timers": {"training_iteration_time_ms": 2185.073, "sample_time_ms": 1940.854, "load_time_ms": 11.756, "load_throughput": 1020785.125, "learn_time_ms": 221.368, "learn_throughput": 54208.289, "synch_weights_time_ms": 9.339}, "counters": {"num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_agent_steps_sampled": 444000, "num_agent_steps_trained": 444000}, "done": false, "episodes_total": 1651, "training_iteration": 37, "trial_id": "9f288_00016", "date": "2023-10-25_16-52-54", "timestamp": 1698249174, "time_this_iter_s": 2.099597930908203, "time_total_s": 80.5090401172638, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 80.5090401172638, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 53.76666666666667, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.4551915228366855e-12, "cur_lr": 0.0003, "total_loss": 6.474645906024509, "policy_loss": -0.000278055253956053, "vf_loss": 6.4749669498867455, "vf_explained_var": -9.073151482476128e-07, "kl": 0.00039906180280506004, "entropy": 0.4287140584654278, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 675.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.08999999999979465, "episode_len_mean": 279.66, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 31.500000000000007, 44.300000000000004, 44.10000000000001, 46.3, -50.00000000000044, 46.699999999999996, 45.9, -50.00000000000044, 17.299999999999805, 46.9, 45.7, -50.00000000000044, 37.10000000000003, 45.3, -50.00000000000044, 43.900000000000006, 40.90000000000002, 40.500000000000014, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 6.8999999999996575, -50.00000000000044, 32.90000000000003, 44.900000000000006, -50.00000000000044, 47.1, 38.700000000000024, -50.00000000000044, 31.300000000000004, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 33.500000000000036, 44.5, -50.00000000000044, 44.900000000000006, -50.00000000000044, 46.5, 47.5, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, 44.7, 46.3, 45.5, -50.00000000000044, 42.900000000000006, -50.00000000000044, 44.5, 42.30000000000001, -50.00000000000044, 36.30000000000003, 26.09999999999993, 22.699999999999882, -50.00000000000044, -50.00000000000044, 19.09999999999983, -50.00000000000044, -50.00000000000044, 43.7, 42.30000000000001, 44.900000000000006, -50.00000000000044, 43.10000000000001, -50.00000000000044, 16.499999999999794, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 5.099999999999632, 35.70000000000003, -50.00000000000044, -50.00000000000044, 41.100000000000016, 44.10000000000001, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 45.7, 43.50000000000001, 47.1, 45.7, -50.00000000000044, 47.1], "episode_lengths": [500, 186, 58, 60, 38, 500, 34, 42, 500, 328, 32, 44, 500, 130, 48, 500, 62, 92, 96, 44, 500, 500, 500, 88, 432, 500, 172, 52, 500, 30, 114, 500, 188, 500, 36, 500, 500, 166, 56, 500, 52, 500, 36, 26, 500, 90, 500, 500, 54, 38, 46, 500, 72, 500, 56, 78, 500, 138, 240, 274, 500, 500, 310, 500, 500, 64, 78, 52, 500, 70, 500, 336, 500, 500, 500, 142, 500, 500, 500, 500, 450, 144, 500, 500, 90, 60, 70, 500, 500, 500, 500, 500, 500, 58, 44, 66, 30, 44, 500, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3762624275082175, "mean_inference_ms": 1.2083282810483416, "mean_action_processing_ms": 0.1375166315272297, "mean_env_wait_ms": 0.08317255255627126, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030987977981567383, "StateBufferConnector_ms": 0.004997968673706055, "ViewRequirementAgentConnector_ms": 0.12038493156433105}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.08999999999979465, "episode_len_mean": 279.66, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 31.500000000000007, 44.300000000000004, 44.10000000000001, 46.3, -50.00000000000044, 46.699999999999996, 45.9, -50.00000000000044, 17.299999999999805, 46.9, 45.7, -50.00000000000044, 37.10000000000003, 45.3, -50.00000000000044, 43.900000000000006, 40.90000000000002, 40.500000000000014, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 6.8999999999996575, -50.00000000000044, 32.90000000000003, 44.900000000000006, -50.00000000000044, 47.1, 38.700000000000024, -50.00000000000044, 31.300000000000004, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 33.500000000000036, 44.5, -50.00000000000044, 44.900000000000006, -50.00000000000044, 46.5, 47.5, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, 44.7, 46.3, 45.5, -50.00000000000044, 42.900000000000006, -50.00000000000044, 44.5, 42.30000000000001, -50.00000000000044, 36.30000000000003, 26.09999999999993, 22.699999999999882, -50.00000000000044, -50.00000000000044, 19.09999999999983, -50.00000000000044, -50.00000000000044, 43.7, 42.30000000000001, 44.900000000000006, -50.00000000000044, 43.10000000000001, -50.00000000000044, 16.499999999999794, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 5.099999999999632, 35.70000000000003, -50.00000000000044, -50.00000000000044, 41.100000000000016, 44.10000000000001, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 45.7, 43.50000000000001, 47.1, 45.7, -50.00000000000044, 47.1], "episode_lengths": [500, 186, 58, 60, 38, 500, 34, 42, 500, 328, 32, 44, 500, 130, 48, 500, 62, 92, 96, 44, 500, 500, 500, 88, 432, 500, 172, 52, 500, 30, 114, 500, 188, 500, 36, 500, 500, 166, 56, 500, 52, 500, 36, 26, 500, 90, 500, 500, 54, 38, 46, 500, 72, 500, 56, 78, 500, 138, 240, 274, 500, 500, 310, 500, 500, 64, 78, 52, 500, 70, 500, 336, 500, 500, 500, 142, 500, 500, 500, 500, 450, 144, 500, 500, 90, 60, 70, 500, 500, 500, 500, 500, 500, 58, 44, 66, 30, 44, 500, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3762624275082175, "mean_inference_ms": 1.2083282810483416, "mean_action_processing_ms": 0.1375166315272297, "mean_env_wait_ms": 0.08317255255627126, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030987977981567383, "StateBufferConnector_ms": 0.004997968673706055, "ViewRequirementAgentConnector_ms": 0.12038493156433105}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4710.150233244468, "num_env_steps_trained_throughput_per_sec": 4710.150233244468, "timesteps_total": 456000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 456000, "timers": {"training_iteration_time_ms": 2229.335, "sample_time_ms": 1964.59, "load_time_ms": 13.131, "load_throughput": 913876.339, "learn_time_ms": 240.209, "learn_throughput": 49956.524, "synch_weights_time_ms": 9.549}, "counters": {"num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000}, "done": false, "episodes_total": 1691, "training_iteration": 38, "trial_id": "9f288_00016", "date": "2023-10-25_16-52-56", "timestamp": 1698249176, "time_this_iter_s": 2.5529356002807617, "time_total_s": 83.06197571754456, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 83.06197571754456, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 62.474999999999994, "ram_util_percent": 27.224999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.275957614183427e-13, "cur_lr": 0.0003, "total_loss": 6.794147782855564, "policy_loss": -0.0005070743047528797, "vf_loss": 6.794700569576687, "vf_explained_var": -9.569856855604385e-07, "kl": 0.0006658086974387819, "entropy": 0.45802564256721073, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 693.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -2.3480000000002157, "episode_len_mean": 294.02, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.100000000000016, -50.00000000000044, -50.00000000000044, 44.7, 46.3, 45.5, -50.00000000000044, 42.900000000000006, -50.00000000000044, 44.5, 42.30000000000001, -50.00000000000044, 36.30000000000003, 26.09999999999993, 22.699999999999882, -50.00000000000044, -50.00000000000044, 19.09999999999983, -50.00000000000044, -50.00000000000044, 43.7, 42.30000000000001, 44.900000000000006, -50.00000000000044, 43.10000000000001, -50.00000000000044, 16.499999999999794, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 5.099999999999632, 35.70000000000003, -50.00000000000044, -50.00000000000044, 41.100000000000016, 44.10000000000001, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 45.7, 43.50000000000001, 47.1, 45.7, -50.00000000000044, 47.1, 45.9, 43.50000000000001, 45.7, 20.099999999999845, 35.30000000000004, 46.5, 34.900000000000034, -50.00000000000044, -50.00000000000044, 31.1, -50.00000000000044, 18.699999999999825, -50.00000000000044, -50.00000000000044, 26.499999999999936, 44.5, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 26.69999999999994, -50.00000000000044, -50.00000000000044, 45.5, 24.499999999999908, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 47.1, 39.10000000000002, -50.00000000000044, 39.70000000000002, -50.00000000000044, 45.9, 19.299999999999834, 39.300000000000026, 43.900000000000006, -50.00000000000044, 43.50000000000001, -50.00000000000044], "episode_lengths": [90, 500, 500, 54, 38, 46, 500, 72, 500, 56, 78, 500, 138, 240, 274, 500, 500, 310, 500, 500, 64, 78, 52, 500, 70, 500, 336, 500, 500, 500, 142, 500, 500, 500, 500, 450, 144, 500, 500, 90, 60, 70, 500, 500, 500, 500, 500, 500, 58, 44, 66, 30, 44, 500, 30, 42, 66, 44, 300, 148, 36, 152, 500, 500, 190, 500, 314, 500, 500, 236, 56, 500, 72, 500, 500, 70, 500, 234, 500, 500, 46, 256, 46, 500, 500, 500, 500, 40, 30, 110, 500, 104, 500, 42, 308, 108, 62, 500, 66, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37694869957717153, "mean_inference_ms": 1.2099060150455119, "mean_action_processing_ms": 0.1376800777696771, "mean_env_wait_ms": 0.08298353825259266, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020989179611206055, "StateBufferConnector_ms": 0.010001182556152344, "ViewRequirementAgentConnector_ms": 0.1218574047088623}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -2.3480000000002157, "episode_len_mean": 294.02, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [41.100000000000016, -50.00000000000044, -50.00000000000044, 44.7, 46.3, 45.5, -50.00000000000044, 42.900000000000006, -50.00000000000044, 44.5, 42.30000000000001, -50.00000000000044, 36.30000000000003, 26.09999999999993, 22.699999999999882, -50.00000000000044, -50.00000000000044, 19.09999999999983, -50.00000000000044, -50.00000000000044, 43.7, 42.30000000000001, 44.900000000000006, -50.00000000000044, 43.10000000000001, -50.00000000000044, 16.499999999999794, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 5.099999999999632, 35.70000000000003, -50.00000000000044, -50.00000000000044, 41.100000000000016, 44.10000000000001, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 45.7, 43.50000000000001, 47.1, 45.7, -50.00000000000044, 47.1, 45.9, 43.50000000000001, 45.7, 20.099999999999845, 35.30000000000004, 46.5, 34.900000000000034, -50.00000000000044, -50.00000000000044, 31.1, -50.00000000000044, 18.699999999999825, -50.00000000000044, -50.00000000000044, 26.499999999999936, 44.5, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 26.69999999999994, -50.00000000000044, -50.00000000000044, 45.5, 24.499999999999908, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 47.1, 39.10000000000002, -50.00000000000044, 39.70000000000002, -50.00000000000044, 45.9, 19.299999999999834, 39.300000000000026, 43.900000000000006, -50.00000000000044, 43.50000000000001, -50.00000000000044], "episode_lengths": [90, 500, 500, 54, 38, 46, 500, 72, 500, 56, 78, 500, 138, 240, 274, 500, 500, 310, 500, 500, 64, 78, 52, 500, 70, 500, 336, 500, 500, 500, 142, 500, 500, 500, 500, 450, 144, 500, 500, 90, 60, 70, 500, 500, 500, 500, 500, 500, 58, 44, 66, 30, 44, 500, 30, 42, 66, 44, 300, 148, 36, 152, 500, 500, 190, 500, 314, 500, 500, 236, 56, 500, 72, 500, 500, 70, 500, 234, 500, 500, 46, 256, 46, 500, 500, 500, 500, 40, 30, 110, 500, 104, 500, 42, 308, 108, 62, 500, 66, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37694869957717153, "mean_inference_ms": 1.2099060150455119, "mean_action_processing_ms": 0.1376800777696771, "mean_env_wait_ms": 0.08298353825259266, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020989179611206055, "StateBufferConnector_ms": 0.010001182556152344, "ViewRequirementAgentConnector_ms": 0.1218574047088623}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5255.506354015522, "num_env_steps_trained_throughput_per_sec": 5255.506354015522, "timesteps_total": 468000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 468000, "timers": {"training_iteration_time_ms": 2232.979, "sample_time_ms": 1967.947, "load_time_ms": 12.987, "load_throughput": 924014.936, "learn_time_ms": 236.988, "learn_throughput": 50635.502, "synch_weights_time_ms": 13.103}, "counters": {"num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000}, "done": false, "episodes_total": 1736, "training_iteration": 39, "trial_id": "9f288_00016", "date": "2023-10-25_16-52-59", "timestamp": 1698249179, "time_this_iter_s": 2.2883172035217285, "time_total_s": 85.35029292106628, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 85.35029292106628, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 63.133333333333326, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.6379788070917137e-13, "cur_lr": 0.0003, "total_loss": 5.907476637098524, "policy_loss": -0.00048038314303590194, "vf_loss": 5.908006933000353, "vf_explained_var": -2.6226043701171875e-06, "kl": 0.0007211644196761174, "entropy": 0.4976151039203008, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 711.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.8989999999998086, "episode_len_mean": 266.6, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 45.7, 43.50000000000001, 47.1, 45.7, -50.00000000000044, 47.1, 45.9, 43.50000000000001, 45.7, 20.099999999999845, 35.30000000000004, 46.5, 34.900000000000034, -50.00000000000044, -50.00000000000044, 31.1, -50.00000000000044, 18.699999999999825, -50.00000000000044, -50.00000000000044, 26.499999999999936, 44.5, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 26.69999999999994, -50.00000000000044, -50.00000000000044, 45.5, 24.499999999999908, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 47.1, 39.10000000000002, -50.00000000000044, 39.70000000000002, -50.00000000000044, 45.9, 19.299999999999834, 39.300000000000026, 43.900000000000006, -50.00000000000044, 43.50000000000001, -50.00000000000044, 0.2999999999995637, 43.50000000000001, -50.00000000000044, 43.50000000000001, 44.7, -50.00000000000044, 44.10000000000001, 42.70000000000001, -50.00000000000044, -50.00000000000044, 45.9, 41.90000000000001, 28.29999999999996, 45.3, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 18.099999999999817, 44.900000000000006, 45.7, 45.1, 41.100000000000016, -50.00000000000044, 39.300000000000026, 37.70000000000003, 47.1, -50.00000000000044, 41.70000000000002, -50.00000000000044, 45.7, 27.299999999999947, 41.90000000000001, 46.099999999999994, 46.099999999999994, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 500, 500, 500, 500, 58, 44, 66, 30, 44, 500, 30, 42, 66, 44, 300, 148, 36, 152, 500, 500, 190, 500, 314, 500, 500, 236, 56, 500, 72, 500, 500, 70, 500, 234, 500, 500, 46, 256, 46, 500, 500, 500, 500, 40, 30, 110, 500, 104, 500, 42, 308, 108, 62, 500, 66, 500, 498, 66, 500, 66, 54, 500, 60, 74, 500, 500, 42, 82, 218, 48, 500, 500, 48, 500, 42, 500, 500, 320, 52, 44, 50, 90, 500, 108, 124, 30, 500, 84, 500, 44, 228, 82, 40, 40, 500, 76, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3775546242585401, "mean_inference_ms": 1.2108111206838874, "mean_action_processing_ms": 0.137833222911383, "mean_env_wait_ms": 0.08254278587563636, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01599407196044922, "StateBufferConnector_ms": 0.011007070541381836, "ViewRequirementAgentConnector_ms": 0.12284660339355469}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.8989999999998086, "episode_len_mean": 266.6, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 45.7, 43.50000000000001, 47.1, 45.7, -50.00000000000044, 47.1, 45.9, 43.50000000000001, 45.7, 20.099999999999845, 35.30000000000004, 46.5, 34.900000000000034, -50.00000000000044, -50.00000000000044, 31.1, -50.00000000000044, 18.699999999999825, -50.00000000000044, -50.00000000000044, 26.499999999999936, 44.5, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 26.69999999999994, -50.00000000000044, -50.00000000000044, 45.5, 24.499999999999908, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 47.1, 39.10000000000002, -50.00000000000044, 39.70000000000002, -50.00000000000044, 45.9, 19.299999999999834, 39.300000000000026, 43.900000000000006, -50.00000000000044, 43.50000000000001, -50.00000000000044, 0.2999999999995637, 43.50000000000001, -50.00000000000044, 43.50000000000001, 44.7, -50.00000000000044, 44.10000000000001, 42.70000000000001, -50.00000000000044, -50.00000000000044, 45.9, 41.90000000000001, 28.29999999999996, 45.3, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 18.099999999999817, 44.900000000000006, 45.7, 45.1, 41.100000000000016, -50.00000000000044, 39.300000000000026, 37.70000000000003, 47.1, -50.00000000000044, 41.70000000000002, -50.00000000000044, 45.7, 27.299999999999947, 41.90000000000001, 46.099999999999994, 46.099999999999994, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 500, 500, 500, 500, 58, 44, 66, 30, 44, 500, 30, 42, 66, 44, 300, 148, 36, 152, 500, 500, 190, 500, 314, 500, 500, 236, 56, 500, 72, 500, 500, 70, 500, 234, 500, 500, 46, 256, 46, 500, 500, 500, 500, 40, 30, 110, 500, 104, 500, 42, 308, 108, 62, 500, 66, 500, 498, 66, 500, 66, 54, 500, 60, 74, 500, 500, 42, 82, 218, 48, 500, 500, 48, 500, 42, 500, 500, 320, 52, 44, 50, 90, 500, 108, 124, 30, 500, 84, 500, 44, 228, 82, 40, 40, 500, 76, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3775546242585401, "mean_inference_ms": 1.2108111206838874, "mean_action_processing_ms": 0.137833222911383, "mean_env_wait_ms": 0.08254278587563636, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01599407196044922, "StateBufferConnector_ms": 0.011007070541381836, "ViewRequirementAgentConnector_ms": 0.12284660339355469}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5796.262460174313, "num_env_steps_trained_throughput_per_sec": 5796.262460174313, "timesteps_total": 480000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 480000, "timers": {"training_iteration_time_ms": 2189.24, "sample_time_ms": 1928.032, "load_time_ms": 12.787, "load_throughput": 938463.007, "learn_time_ms": 233.365, "learn_throughput": 51421.49, "synch_weights_time_ms": 13.054}, "counters": {"num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "done": false, "episodes_total": 1778, "training_iteration": 40, "trial_id": "9f288_00016", "date": "2023-10-25_16-53-01", "timestamp": 1698249181, "time_this_iter_s": 2.075401544570923, "time_total_s": 87.4256944656372, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 87.4256944656372, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 57.43333333333334, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.8189894035458568e-13, "cur_lr": 0.0003, "total_loss": 6.4848151206970215, "policy_loss": -0.00018915575411584642, "vf_loss": 6.4850538571675616, "vf_explained_var": 3.311369154188368e-09, "kl": 0.00028282267197867996, "entropy": 0.49572786688804626, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 729.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_agent_steps_sampled": 492000, "num_agent_steps_trained": 492000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.7289999999997934, "episode_len_mean": 278.3, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 47.1, 39.10000000000002, -50.00000000000044, 39.70000000000002, -50.00000000000044, 45.9, 19.299999999999834, 39.300000000000026, 43.900000000000006, -50.00000000000044, 43.50000000000001, -50.00000000000044, 0.2999999999995637, 43.50000000000001, -50.00000000000044, 43.50000000000001, 44.7, -50.00000000000044, 44.10000000000001, 42.70000000000001, -50.00000000000044, -50.00000000000044, 45.9, 41.90000000000001, 28.29999999999996, 45.3, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 18.099999999999817, 44.900000000000006, 45.7, 45.1, 41.100000000000016, -50.00000000000044, 39.300000000000026, 37.70000000000003, 47.1, -50.00000000000044, 41.70000000000002, -50.00000000000044, 45.7, 27.299999999999947, 41.90000000000001, 46.099999999999994, 46.099999999999994, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 4.299999999999621, 43.30000000000001, 44.900000000000006, 45.5, -50.00000000000044, -50.00000000000044, 42.10000000000001, 42.900000000000006, 18.899999999999828, -50.00000000000044, 45.5, 47.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.499999999999908, -50.00000000000044, 24.499999999999908, -50.00000000000044, 41.90000000000001, -50.00000000000044, 35.70000000000003, -50.00000000000044, 46.099999999999994, 43.7, -50.00000000000044, 8.099999999999675, 19.69999999999984, 46.5, -50.00000000000044, 43.7, 45.3, -50.00000000000044, 4.499999999999623, -50.00000000000044, -50.00000000000044, 46.5, 11.499999999999723, -50.00000000000044], "episode_lengths": [500, 500, 500, 500, 40, 30, 110, 500, 104, 500, 42, 308, 108, 62, 500, 66, 500, 498, 66, 500, 66, 54, 500, 60, 74, 500, 500, 42, 82, 218, 48, 500, 500, 48, 500, 42, 500, 500, 320, 52, 44, 50, 90, 500, 108, 124, 30, 500, 84, 500, 44, 228, 82, 40, 40, 500, 76, 500, 500, 500, 500, 458, 68, 52, 46, 500, 500, 80, 72, 312, 500, 46, 24, 500, 500, 500, 256, 500, 256, 500, 82, 500, 144, 500, 40, 64, 500, 420, 304, 36, 500, 64, 48, 500, 456, 500, 500, 36, 386, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37684067327101173, "mean_inference_ms": 1.2106198386628053, "mean_action_processing_ms": 0.13811935163700645, "mean_env_wait_ms": 0.08312088526436938, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01999378204345703, "StateBufferConnector_ms": 0.013007879257202148, "ViewRequirementAgentConnector_ms": 0.12195491790771484}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.7289999999997934, "episode_len_mean": 278.3, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 47.1, 39.10000000000002, -50.00000000000044, 39.70000000000002, -50.00000000000044, 45.9, 19.299999999999834, 39.300000000000026, 43.900000000000006, -50.00000000000044, 43.50000000000001, -50.00000000000044, 0.2999999999995637, 43.50000000000001, -50.00000000000044, 43.50000000000001, 44.7, -50.00000000000044, 44.10000000000001, 42.70000000000001, -50.00000000000044, -50.00000000000044, 45.9, 41.90000000000001, 28.29999999999996, 45.3, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 18.099999999999817, 44.900000000000006, 45.7, 45.1, 41.100000000000016, -50.00000000000044, 39.300000000000026, 37.70000000000003, 47.1, -50.00000000000044, 41.70000000000002, -50.00000000000044, 45.7, 27.299999999999947, 41.90000000000001, 46.099999999999994, 46.099999999999994, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 4.299999999999621, 43.30000000000001, 44.900000000000006, 45.5, -50.00000000000044, -50.00000000000044, 42.10000000000001, 42.900000000000006, 18.899999999999828, -50.00000000000044, 45.5, 47.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.499999999999908, -50.00000000000044, 24.499999999999908, -50.00000000000044, 41.90000000000001, -50.00000000000044, 35.70000000000003, -50.00000000000044, 46.099999999999994, 43.7, -50.00000000000044, 8.099999999999675, 19.69999999999984, 46.5, -50.00000000000044, 43.7, 45.3, -50.00000000000044, 4.499999999999623, -50.00000000000044, -50.00000000000044, 46.5, 11.499999999999723, -50.00000000000044], "episode_lengths": [500, 500, 500, 500, 40, 30, 110, 500, 104, 500, 42, 308, 108, 62, 500, 66, 500, 498, 66, 500, 66, 54, 500, 60, 74, 500, 500, 42, 82, 218, 48, 500, 500, 48, 500, 42, 500, 500, 320, 52, 44, 50, 90, 500, 108, 124, 30, 500, 84, 500, 44, 228, 82, 40, 40, 500, 76, 500, 500, 500, 500, 458, 68, 52, 46, 500, 500, 80, 72, 312, 500, 46, 24, 500, 500, 500, 256, 500, 256, 500, 82, 500, 144, 500, 40, 64, 500, 420, 304, 36, 500, 64, 48, 500, 456, 500, 500, 36, 386, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37684067327101173, "mean_inference_ms": 1.2106198386628053, "mean_action_processing_ms": 0.13811935163700645, "mean_env_wait_ms": 0.08312088526436938, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01999378204345703, "StateBufferConnector_ms": 0.013007879257202148, "ViewRequirementAgentConnector_ms": 0.12195491790771484}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 492000, "num_agent_steps_trained": 492000, "num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5370.393848352854, "num_env_steps_trained_throughput_per_sec": 5370.393848352854, "timesteps_total": 492000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 492000, "timers": {"training_iteration_time_ms": 2189.228, "sample_time_ms": 1925.0, "load_time_ms": 12.488, "load_throughput": 960901.725, "learn_time_ms": 236.808, "learn_throughput": 50673.945, "synch_weights_time_ms": 13.13}, "counters": {"num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_agent_steps_sampled": 492000, "num_agent_steps_trained": 492000}, "done": false, "episodes_total": 1819, "training_iteration": 41, "trial_id": "9f288_00016", "date": "2023-10-25_16-53-03", "timestamp": 1698249183, "time_this_iter_s": 2.2404706478118896, "time_total_s": 89.6661651134491, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 89.6661651134491, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 61.0, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.094947017729284e-14, "cur_lr": 0.0003, "total_loss": 6.589774317211575, "policy_loss": -5.672002832094828e-05, "vf_loss": 6.589876307381524, "vf_explained_var": -1.11593140496148e-06, "kl": 0.00011565893320566702, "entropy": 0.45230234497123295, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 747.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.3770000000002158, "episode_len_mean": 289.34, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.300000000000026, 37.70000000000003, 47.1, -50.00000000000044, 41.70000000000002, -50.00000000000044, 45.7, 27.299999999999947, 41.90000000000001, 46.099999999999994, 46.099999999999994, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 4.299999999999621, 43.30000000000001, 44.900000000000006, 45.5, -50.00000000000044, -50.00000000000044, 42.10000000000001, 42.900000000000006, 18.899999999999828, -50.00000000000044, 45.5, 47.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.499999999999908, -50.00000000000044, 24.499999999999908, -50.00000000000044, 41.90000000000001, -50.00000000000044, 35.70000000000003, -50.00000000000044, 46.099999999999994, 43.7, -50.00000000000044, 8.099999999999675, 19.69999999999984, 46.5, -50.00000000000044, 43.7, 45.3, -50.00000000000044, 4.499999999999623, -50.00000000000044, -50.00000000000044, 46.5, 11.499999999999723, -50.00000000000044, -50.00000000000044, 34.50000000000004, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 10.099999999999703, -50.00000000000044, 44.900000000000006, 43.7, 45.1, 46.3, -50.00000000000044, 46.9, 38.10000000000002, 32.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.099999999999973, 43.7, 43.10000000000001, 45.7, 12.899999999999743, -50.00000000000044, 9.099999999999689, 46.9, 47.5, 42.30000000000001, 40.10000000000002, 44.900000000000006, 46.5, -50.00000000000044], "episode_lengths": [108, 124, 30, 500, 84, 500, 44, 228, 82, 40, 40, 500, 76, 500, 500, 500, 500, 458, 68, 52, 46, 500, 500, 80, 72, 312, 500, 46, 24, 500, 500, 500, 256, 500, 256, 500, 82, 500, 144, 500, 40, 64, 500, 420, 304, 36, 500, 64, 48, 500, 456, 500, 500, 36, 386, 500, 500, 156, 500, 500, 100, 500, 500, 60, 500, 500, 500, 500, 84, 500, 500, 500, 400, 500, 52, 64, 50, 38, 500, 32, 120, 178, 500, 500, 500, 500, 210, 64, 70, 44, 372, 500, 410, 32, 26, 78, 100, 52, 36, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37667915354654113, "mean_inference_ms": 1.2107068461242225, "mean_action_processing_ms": 0.13806722211907563, "mean_env_wait_ms": 0.08320721520739474, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026999711990356445, "StateBufferConnector_ms": 0.007992744445800781, "ViewRequirementAgentConnector_ms": 0.13798213005065918}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.3770000000002158, "episode_len_mean": 289.34, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [39.300000000000026, 37.70000000000003, 47.1, -50.00000000000044, 41.70000000000002, -50.00000000000044, 45.7, 27.299999999999947, 41.90000000000001, 46.099999999999994, 46.099999999999994, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 4.299999999999621, 43.30000000000001, 44.900000000000006, 45.5, -50.00000000000044, -50.00000000000044, 42.10000000000001, 42.900000000000006, 18.899999999999828, -50.00000000000044, 45.5, 47.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.499999999999908, -50.00000000000044, 24.499999999999908, -50.00000000000044, 41.90000000000001, -50.00000000000044, 35.70000000000003, -50.00000000000044, 46.099999999999994, 43.7, -50.00000000000044, 8.099999999999675, 19.69999999999984, 46.5, -50.00000000000044, 43.7, 45.3, -50.00000000000044, 4.499999999999623, -50.00000000000044, -50.00000000000044, 46.5, 11.499999999999723, -50.00000000000044, -50.00000000000044, 34.50000000000004, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 10.099999999999703, -50.00000000000044, 44.900000000000006, 43.7, 45.1, 46.3, -50.00000000000044, 46.9, 38.10000000000002, 32.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.099999999999973, 43.7, 43.10000000000001, 45.7, 12.899999999999743, -50.00000000000044, 9.099999999999689, 46.9, 47.5, 42.30000000000001, 40.10000000000002, 44.900000000000006, 46.5, -50.00000000000044], "episode_lengths": [108, 124, 30, 500, 84, 500, 44, 228, 82, 40, 40, 500, 76, 500, 500, 500, 500, 458, 68, 52, 46, 500, 500, 80, 72, 312, 500, 46, 24, 500, 500, 500, 256, 500, 256, 500, 82, 500, 144, 500, 40, 64, 500, 420, 304, 36, 500, 64, 48, 500, 456, 500, 500, 36, 386, 500, 500, 156, 500, 500, 100, 500, 500, 60, 500, 500, 500, 500, 84, 500, 500, 500, 400, 500, 52, 64, 50, 38, 500, 32, 120, 178, 500, 500, 500, 500, 210, 64, 70, 44, 372, 500, 410, 32, 26, 78, 100, 52, 36, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37667915354654113, "mean_inference_ms": 1.2107068461242225, "mean_action_processing_ms": 0.13806722211907563, "mean_env_wait_ms": 0.08320721520739474, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026999711990356445, "StateBufferConnector_ms": 0.007992744445800781, "ViewRequirementAgentConnector_ms": 0.13798213005065918}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5695.393230658929, "num_env_steps_trained_throughput_per_sec": 5695.393230658929, "timesteps_total": 504000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 504000, "timers": {"training_iteration_time_ms": 2187.33, "sample_time_ms": 1924.128, "load_time_ms": 12.202, "load_throughput": 983429.915, "learn_time_ms": 236.126, "learn_throughput": 50820.229, "synch_weights_time_ms": 12.986}, "counters": {"num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000}, "done": false, "episodes_total": 1863, "training_iteration": 42, "trial_id": "9f288_00016", "date": "2023-10-25_16-53-05", "timestamp": 1698249185, "time_this_iter_s": 2.112959623336792, "time_total_s": 91.77912473678589, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 91.77912473678589, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 56.63333333333333, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.547473508864642e-14, "cur_lr": 0.0003, "total_loss": 6.777705219056871, "policy_loss": -0.0004662732697195477, "vf_loss": 6.778222746319241, "vf_explained_var": 2.914004855685764e-07, "kl": 0.0004676799769009045, "entropy": 0.5128741049104266, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 765.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_agent_steps_sampled": 516000, "num_agent_steps_trained": 516000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.1249999999997957, "episode_len_mean": 284.36, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.099999999999675, 19.69999999999984, 46.5, -50.00000000000044, 43.7, 45.3, -50.00000000000044, 4.499999999999623, -50.00000000000044, -50.00000000000044, 46.5, 11.499999999999723, -50.00000000000044, -50.00000000000044, 34.50000000000004, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 10.099999999999703, -50.00000000000044, 44.900000000000006, 43.7, 45.1, 46.3, -50.00000000000044, 46.9, 38.10000000000002, 32.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.099999999999973, 43.7, 43.10000000000001, 45.7, 12.899999999999743, -50.00000000000044, 9.099999999999689, 46.9, 47.5, 42.30000000000001, 40.10000000000002, 44.900000000000006, 46.5, -50.00000000000044, 45.9, 44.10000000000001, 15.099999999999774, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 37.300000000000026, -50.00000000000044, 27.899999999999956, 35.70000000000003, 44.900000000000006, 2.299999999999592, 39.70000000000002, 41.90000000000001, -50.00000000000044, 16.499999999999794, 44.300000000000004, 43.50000000000001, 38.300000000000026, -50.00000000000044, 45.9, -50.00000000000044, 38.10000000000002, 15.299999999999777, -50.00000000000044, 6.499999999999652, 20.099999999999845, -50.00000000000044, 30.099999999999987, 38.700000000000024, 43.30000000000001, 43.30000000000001, 44.900000000000006, 41.500000000000014, 44.10000000000001, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044], "episode_lengths": [420, 304, 36, 500, 64, 48, 500, 456, 500, 500, 36, 386, 500, 500, 156, 500, 500, 100, 500, 500, 60, 500, 500, 500, 500, 84, 500, 500, 500, 400, 500, 52, 64, 50, 38, 500, 32, 120, 178, 500, 500, 500, 500, 210, 64, 70, 44, 372, 500, 410, 32, 26, 78, 100, 52, 36, 500, 42, 60, 350, 500, 500, 66, 500, 500, 128, 500, 222, 144, 52, 478, 104, 82, 500, 336, 58, 66, 118, 500, 42, 500, 120, 348, 500, 436, 300, 500, 200, 114, 68, 68, 52, 86, 60, 500, 90, 500, 500, 68, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3763177529907057, "mean_inference_ms": 1.2104571295198097, "mean_action_processing_ms": 0.1377124163624262, "mean_env_wait_ms": 0.08296209667833601, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029002904891967773, "StateBufferConnector_ms": 0.007987737655639648, "ViewRequirementAgentConnector_ms": 0.12301087379455566}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.1249999999997957, "episode_len_mean": 284.36, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [8.099999999999675, 19.69999999999984, 46.5, -50.00000000000044, 43.7, 45.3, -50.00000000000044, 4.499999999999623, -50.00000000000044, -50.00000000000044, 46.5, 11.499999999999723, -50.00000000000044, -50.00000000000044, 34.50000000000004, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 10.099999999999703, -50.00000000000044, 44.900000000000006, 43.7, 45.1, 46.3, -50.00000000000044, 46.9, 38.10000000000002, 32.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.099999999999973, 43.7, 43.10000000000001, 45.7, 12.899999999999743, -50.00000000000044, 9.099999999999689, 46.9, 47.5, 42.30000000000001, 40.10000000000002, 44.900000000000006, 46.5, -50.00000000000044, 45.9, 44.10000000000001, 15.099999999999774, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 37.300000000000026, -50.00000000000044, 27.899999999999956, 35.70000000000003, 44.900000000000006, 2.299999999999592, 39.70000000000002, 41.90000000000001, -50.00000000000044, 16.499999999999794, 44.300000000000004, 43.50000000000001, 38.300000000000026, -50.00000000000044, 45.9, -50.00000000000044, 38.10000000000002, 15.299999999999777, -50.00000000000044, 6.499999999999652, 20.099999999999845, -50.00000000000044, 30.099999999999987, 38.700000000000024, 43.30000000000001, 43.30000000000001, 44.900000000000006, 41.500000000000014, 44.10000000000001, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044], "episode_lengths": [420, 304, 36, 500, 64, 48, 500, 456, 500, 500, 36, 386, 500, 500, 156, 500, 500, 100, 500, 500, 60, 500, 500, 500, 500, 84, 500, 500, 500, 400, 500, 52, 64, 50, 38, 500, 32, 120, 178, 500, 500, 500, 500, 210, 64, 70, 44, 372, 500, 410, 32, 26, 78, 100, 52, 36, 500, 42, 60, 350, 500, 500, 66, 500, 500, 128, 500, 222, 144, 52, 478, 104, 82, 500, 336, 58, 66, 118, 500, 42, 500, 120, 348, 500, 436, 300, 500, 200, 114, 68, 68, 52, 86, 60, 500, 90, 500, 500, 68, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3763177529907057, "mean_inference_ms": 1.2104571295198097, "mean_action_processing_ms": 0.1377124163624262, "mean_env_wait_ms": 0.08296209667833601, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029002904891967773, "StateBufferConnector_ms": 0.007987737655639648, "ViewRequirementAgentConnector_ms": 0.12301087379455566}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 516000, "num_agent_steps_trained": 516000, "num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5402.778609690419, "num_env_steps_trained_throughput_per_sec": 5402.778609690419, "timesteps_total": 516000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 516000, "timers": {"training_iteration_time_ms": 2188.824, "sample_time_ms": 1921.658, "load_time_ms": 12.0, "load_throughput": 1000028.77, "learn_time_ms": 240.29, "learn_throughput": 49939.632, "synch_weights_time_ms": 12.889}, "counters": {"num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_agent_steps_sampled": 516000, "num_agent_steps_trained": 516000}, "done": false, "episodes_total": 1906, "training_iteration": 43, "trial_id": "9f288_00016", "date": "2023-10-25_16-53-07", "timestamp": 1698249187, "time_this_iter_s": 2.227081298828125, "time_total_s": 94.00620603561401, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 94.00620603561401, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 60.6, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.273736754432321e-14, "cur_lr": 0.0003, "total_loss": 6.250041511323717, "policy_loss": 2.9556964161909287e-05, "vf_loss": 6.250065591600206, "vf_explained_var": -1.4106432596842449e-06, "kl": 0.00015045622779060372, "entropy": 0.5362508164511787, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 783.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.697999999999825, "episode_len_mean": 263.68, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 29.099999999999973, 43.7, 43.10000000000001, 45.7, 12.899999999999743, -50.00000000000044, 9.099999999999689, 46.9, 47.5, 42.30000000000001, 40.10000000000002, 44.900000000000006, 46.5, -50.00000000000044, 45.9, 44.10000000000001, 15.099999999999774, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 37.300000000000026, -50.00000000000044, 27.899999999999956, 35.70000000000003, 44.900000000000006, 2.299999999999592, 39.70000000000002, 41.90000000000001, -50.00000000000044, 16.499999999999794, 44.300000000000004, 43.50000000000001, 38.300000000000026, -50.00000000000044, 45.9, -50.00000000000044, 38.10000000000002, 15.299999999999777, -50.00000000000044, 6.499999999999652, 20.099999999999845, -50.00000000000044, 30.099999999999987, 38.700000000000024, 43.30000000000001, 43.30000000000001, 44.900000000000006, 41.500000000000014, 44.10000000000001, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 24.299999999999905, -50.00000000000044, 26.299999999999933, -50.00000000000044, 26.499999999999936, 37.10000000000003, 46.3, -50.00000000000044, 18.29999999999982, 40.70000000000002, -50.00000000000044, 36.70000000000003, 30.699999999999996, 36.50000000000003, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.90000000000003, 43.30000000000001, -50.00000000000044, 45.1, 37.90000000000003, -50.00000000000044, 43.10000000000001, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.30000000000004, -50.00000000000044, 47.5, 11.099999999999717, 46.9, 24.899999999999913, 35.70000000000003, -50.00000000000044, 42.10000000000001, -50.00000000000044, 45.5], "episode_lengths": [500, 500, 210, 64, 70, 44, 372, 500, 410, 32, 26, 78, 100, 52, 36, 500, 42, 60, 350, 500, 500, 66, 500, 500, 128, 500, 222, 144, 52, 478, 104, 82, 500, 336, 58, 66, 118, 500, 42, 500, 120, 348, 500, 436, 300, 500, 200, 114, 68, 68, 52, 86, 60, 500, 90, 500, 500, 68, 500, 258, 500, 238, 500, 236, 130, 38, 500, 318, 94, 500, 134, 194, 136, 58, 500, 500, 500, 172, 68, 500, 50, 122, 500, 70, 72, 500, 500, 500, 500, 158, 500, 26, 390, 32, 252, 144, 500, 80, 500, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3768551286380426, "mean_inference_ms": 1.2098901933841102, "mean_action_processing_ms": 0.13777352503735144, "mean_env_wait_ms": 0.08243350952817792, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.033995628356933594, "StateBufferConnector_ms": 0.007996082305908203, "ViewRequirementAgentConnector_ms": 0.1289994716644287}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.697999999999825, "episode_len_mean": 263.68, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 29.099999999999973, 43.7, 43.10000000000001, 45.7, 12.899999999999743, -50.00000000000044, 9.099999999999689, 46.9, 47.5, 42.30000000000001, 40.10000000000002, 44.900000000000006, 46.5, -50.00000000000044, 45.9, 44.10000000000001, 15.099999999999774, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 37.300000000000026, -50.00000000000044, 27.899999999999956, 35.70000000000003, 44.900000000000006, 2.299999999999592, 39.70000000000002, 41.90000000000001, -50.00000000000044, 16.499999999999794, 44.300000000000004, 43.50000000000001, 38.300000000000026, -50.00000000000044, 45.9, -50.00000000000044, 38.10000000000002, 15.299999999999777, -50.00000000000044, 6.499999999999652, 20.099999999999845, -50.00000000000044, 30.099999999999987, 38.700000000000024, 43.30000000000001, 43.30000000000001, 44.900000000000006, 41.500000000000014, 44.10000000000001, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 24.299999999999905, -50.00000000000044, 26.299999999999933, -50.00000000000044, 26.499999999999936, 37.10000000000003, 46.3, -50.00000000000044, 18.29999999999982, 40.70000000000002, -50.00000000000044, 36.70000000000003, 30.699999999999996, 36.50000000000003, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.90000000000003, 43.30000000000001, -50.00000000000044, 45.1, 37.90000000000003, -50.00000000000044, 43.10000000000001, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.30000000000004, -50.00000000000044, 47.5, 11.099999999999717, 46.9, 24.899999999999913, 35.70000000000003, -50.00000000000044, 42.10000000000001, -50.00000000000044, 45.5], "episode_lengths": [500, 500, 210, 64, 70, 44, 372, 500, 410, 32, 26, 78, 100, 52, 36, 500, 42, 60, 350, 500, 500, 66, 500, 500, 128, 500, 222, 144, 52, 478, 104, 82, 500, 336, 58, 66, 118, 500, 42, 500, 120, 348, 500, 436, 300, 500, 200, 114, 68, 68, 52, 86, 60, 500, 90, 500, 500, 68, 500, 258, 500, 238, 500, 236, 130, 38, 500, 318, 94, 500, 134, 194, 136, 58, 500, 500, 500, 172, 68, 500, 50, 122, 500, 70, 72, 500, 500, 500, 500, 158, 500, 26, 390, 32, 252, 144, 500, 80, 500, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3768551286380426, "mean_inference_ms": 1.2098901933841102, "mean_action_processing_ms": 0.13777352503735144, "mean_env_wait_ms": 0.08243350952817792, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.033995628356933594, "StateBufferConnector_ms": 0.007996082305908203, "ViewRequirementAgentConnector_ms": 0.1289994716644287}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5700.816493746806, "num_env_steps_trained_throughput_per_sec": 5700.816493746806, "timesteps_total": 528000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 528000, "timers": {"training_iteration_time_ms": 2197.125, "sample_time_ms": 1922.726, "load_time_ms": 12.4, "load_throughput": 967761.838, "learn_time_ms": 247.02, "learn_throughput": 48579.103, "synch_weights_time_ms": 13.071}, "counters": {"num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "done": false, "episodes_total": 1947, "training_iteration": 44, "trial_id": "9f288_00016", "date": "2023-10-25_16-53-10", "timestamp": 1698249190, "time_this_iter_s": 2.109959363937378, "time_total_s": 96.11616539955139, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 96.11616539955139, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 57.03333333333334, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1368683772161605e-14, "cur_lr": 0.0003, "total_loss": 7.276102119021946, "policy_loss": -0.00020200717780325148, "vf_loss": 7.276357650756836, "vf_explained_var": -5.165735880533854e-07, "kl": 0.00030987408683181964, "entropy": 0.5352892312738631, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 801.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.822999999999842, "episode_len_mean": 247.44, "episode_media": {}, "episodes_this_iter": 57, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.30000000000001, -50.00000000000044, 24.299999999999905, -50.00000000000044, 26.299999999999933, -50.00000000000044, 26.499999999999936, 37.10000000000003, 46.3, -50.00000000000044, 18.29999999999982, 40.70000000000002, -50.00000000000044, 36.70000000000003, 30.699999999999996, 36.50000000000003, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.90000000000003, 43.30000000000001, -50.00000000000044, 45.1, 37.90000000000003, -50.00000000000044, 43.10000000000001, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.30000000000004, -50.00000000000044, 47.5, 11.099999999999717, 46.9, 24.899999999999913, 35.70000000000003, -50.00000000000044, 42.10000000000001, -50.00000000000044, 45.5, -50.00000000000044, 12.299999999999734, 45.1, 41.70000000000002, 26.89999999999994, 42.900000000000006, 42.500000000000014, 46.099999999999994, 46.9, 28.09999999999996, 46.099999999999994, 46.099999999999994, 27.099999999999945, 44.5, -50.00000000000044, -50.00000000000044, 30.099999999999987, -50.00000000000044, 44.5, 43.30000000000001, 37.50000000000003, 43.30000000000001, -50.00000000000044, 40.90000000000002, -50.00000000000044, 46.5, -50.00000000000044, 34.30000000000004, 41.90000000000001, 5.299999999999635, -50.00000000000044, 42.70000000000001, 47.1, 42.70000000000001, 26.89999999999994, 39.50000000000002, 45.1, 43.50000000000001, 45.7, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 45.3, 38.10000000000002, 41.500000000000014, 16.699999999999797, 34.10000000000004, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 41.90000000000001, 41.500000000000014], "episode_lengths": [68, 500, 258, 500, 238, 500, 236, 130, 38, 500, 318, 94, 500, 134, 194, 136, 58, 500, 500, 500, 172, 68, 500, 50, 122, 500, 70, 72, 500, 500, 500, 500, 158, 500, 26, 390, 32, 252, 144, 500, 80, 500, 46, 500, 378, 50, 84, 232, 72, 76, 40, 32, 220, 40, 40, 230, 56, 500, 500, 200, 500, 56, 68, 126, 68, 500, 92, 500, 36, 500, 158, 82, 448, 500, 74, 30, 74, 232, 106, 50, 66, 44, 62, 500, 500, 500, 500, 500, 78, 48, 120, 86, 334, 160, 500, 500, 44, 500, 82, 86]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3762721020162567, "mean_inference_ms": 1.2090775259684956, "mean_action_processing_ms": 0.13828750775726223, "mean_env_wait_ms": 0.08253959953554785, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03099966049194336, "StateBufferConnector_ms": 0.00500035285949707, "ViewRequirementAgentConnector_ms": 0.1339888572692871}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.822999999999842, "episode_len_mean": 247.44, "episodes_this_iter": 57, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.30000000000001, -50.00000000000044, 24.299999999999905, -50.00000000000044, 26.299999999999933, -50.00000000000044, 26.499999999999936, 37.10000000000003, 46.3, -50.00000000000044, 18.29999999999982, 40.70000000000002, -50.00000000000044, 36.70000000000003, 30.699999999999996, 36.50000000000003, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.90000000000003, 43.30000000000001, -50.00000000000044, 45.1, 37.90000000000003, -50.00000000000044, 43.10000000000001, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.30000000000004, -50.00000000000044, 47.5, 11.099999999999717, 46.9, 24.899999999999913, 35.70000000000003, -50.00000000000044, 42.10000000000001, -50.00000000000044, 45.5, -50.00000000000044, 12.299999999999734, 45.1, 41.70000000000002, 26.89999999999994, 42.900000000000006, 42.500000000000014, 46.099999999999994, 46.9, 28.09999999999996, 46.099999999999994, 46.099999999999994, 27.099999999999945, 44.5, -50.00000000000044, -50.00000000000044, 30.099999999999987, -50.00000000000044, 44.5, 43.30000000000001, 37.50000000000003, 43.30000000000001, -50.00000000000044, 40.90000000000002, -50.00000000000044, 46.5, -50.00000000000044, 34.30000000000004, 41.90000000000001, 5.299999999999635, -50.00000000000044, 42.70000000000001, 47.1, 42.70000000000001, 26.89999999999994, 39.50000000000002, 45.1, 43.50000000000001, 45.7, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 45.3, 38.10000000000002, 41.500000000000014, 16.699999999999797, 34.10000000000004, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 41.90000000000001, 41.500000000000014], "episode_lengths": [68, 500, 258, 500, 238, 500, 236, 130, 38, 500, 318, 94, 500, 134, 194, 136, 58, 500, 500, 500, 172, 68, 500, 50, 122, 500, 70, 72, 500, 500, 500, 500, 158, 500, 26, 390, 32, 252, 144, 500, 80, 500, 46, 500, 378, 50, 84, 232, 72, 76, 40, 32, 220, 40, 40, 230, 56, 500, 500, 200, 500, 56, 68, 126, 68, 500, 92, 500, 36, 500, 158, 82, 448, 500, 74, 30, 74, 232, 106, 50, 66, 44, 62, 500, 500, 500, 500, 500, 78, 48, 120, 86, 334, 160, 500, 500, 44, 500, 82, 86]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3762721020162567, "mean_inference_ms": 1.2090775259684956, "mean_action_processing_ms": 0.13828750775726223, "mean_env_wait_ms": 0.08253959953554785, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03099966049194336, "StateBufferConnector_ms": 0.00500035285949707, "ViewRequirementAgentConnector_ms": 0.1339888572692871}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5416.039236967147, "num_env_steps_trained_throughput_per_sec": 5416.039236967147, "timesteps_total": 540000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 540000, "timers": {"training_iteration_time_ms": 2212.04, "sample_time_ms": 1928.561, "load_time_ms": 13.075, "load_throughput": 917780.768, "learn_time_ms": 255.543, "learn_throughput": 46958.865, "synch_weights_time_ms": 13.052}, "counters": {"num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000}, "done": false, "episodes_total": 2004, "training_iteration": 45, "trial_id": "9f288_00016", "date": "2023-10-25_16-53-12", "timestamp": 1698249192, "time_this_iter_s": 2.2215330600738525, "time_total_s": 98.33769845962524, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 98.33769845962524, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 59.53333333333333, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.6843418860808026e-15, "cur_lr": 0.0003, "total_loss": 6.482616583506267, "policy_loss": -0.00023470653427971734, "vf_loss": 6.482900619506836, "vf_explained_var": -1.1821587880452473e-06, "kl": 0.0002305450222732159, "entropy": 0.49156131512588924, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 819.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.51499999999984, "episode_len_mean": 240.52, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.5, -50.00000000000044, 12.299999999999734, 45.1, 41.70000000000002, 26.89999999999994, 42.900000000000006, 42.500000000000014, 46.099999999999994, 46.9, 28.09999999999996, 46.099999999999994, 46.099999999999994, 27.099999999999945, 44.5, -50.00000000000044, -50.00000000000044, 30.099999999999987, -50.00000000000044, 44.5, 43.30000000000001, 37.50000000000003, 43.30000000000001, -50.00000000000044, 40.90000000000002, -50.00000000000044, 46.5, -50.00000000000044, 34.30000000000004, 41.90000000000001, 5.299999999999635, -50.00000000000044, 42.70000000000001, 47.1, 42.70000000000001, 26.89999999999994, 39.50000000000002, 45.1, 43.50000000000001, 45.7, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 45.3, 38.10000000000002, 41.500000000000014, 16.699999999999797, 34.10000000000004, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 41.90000000000001, 41.500000000000014, -50.00000000000044, 14.899999999999771, 47.1, 43.30000000000001, 40.90000000000002, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.900000000000034, 44.300000000000004, -50.00000000000044, -50.00000000000044, 42.70000000000001, 40.500000000000014, 43.900000000000006, 43.30000000000001, -50.00000000000044, -50.00000000000044, 38.50000000000003, 27.899999999999956, -50.00000000000044, -50.00000000000044, 45.5, 47.5, -50.00000000000044, 44.900000000000006, 43.10000000000001, 42.10000000000001, -50.00000000000044, -50.00000000000044, 44.10000000000001, 45.3, 22.699999999999882, 11.499999999999723, -50.00000000000044, 44.300000000000004, -50.00000000000044, 25.29999999999992, 43.7], "episode_lengths": [46, 500, 378, 50, 84, 232, 72, 76, 40, 32, 220, 40, 40, 230, 56, 500, 500, 200, 500, 56, 68, 126, 68, 500, 92, 500, 36, 500, 158, 82, 448, 500, 74, 30, 74, 232, 106, 50, 66, 44, 62, 500, 500, 500, 500, 500, 78, 48, 120, 86, 334, 160, 500, 500, 44, 500, 82, 86, 500, 352, 30, 68, 92, 500, 64, 500, 500, 500, 500, 132, 58, 500, 500, 74, 96, 62, 68, 500, 500, 116, 222, 500, 500, 46, 26, 500, 52, 70, 80, 500, 500, 60, 48, 274, 386, 500, 58, 500, 248, 64]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37582854691248146, "mean_inference_ms": 1.209307537902939, "mean_action_processing_ms": 0.1381023318152852, "mean_env_wait_ms": 0.08264621299056625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03301811218261719, "StateBufferConnector_ms": 0.003000020980834961, "ViewRequirementAgentConnector_ms": 0.1360001564025879}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.51499999999984, "episode_len_mean": 240.52, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.5, -50.00000000000044, 12.299999999999734, 45.1, 41.70000000000002, 26.89999999999994, 42.900000000000006, 42.500000000000014, 46.099999999999994, 46.9, 28.09999999999996, 46.099999999999994, 46.099999999999994, 27.099999999999945, 44.5, -50.00000000000044, -50.00000000000044, 30.099999999999987, -50.00000000000044, 44.5, 43.30000000000001, 37.50000000000003, 43.30000000000001, -50.00000000000044, 40.90000000000002, -50.00000000000044, 46.5, -50.00000000000044, 34.30000000000004, 41.90000000000001, 5.299999999999635, -50.00000000000044, 42.70000000000001, 47.1, 42.70000000000001, 26.89999999999994, 39.50000000000002, 45.1, 43.50000000000001, 45.7, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 45.3, 38.10000000000002, 41.500000000000014, 16.699999999999797, 34.10000000000004, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 41.90000000000001, 41.500000000000014, -50.00000000000044, 14.899999999999771, 47.1, 43.30000000000001, 40.90000000000002, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.900000000000034, 44.300000000000004, -50.00000000000044, -50.00000000000044, 42.70000000000001, 40.500000000000014, 43.900000000000006, 43.30000000000001, -50.00000000000044, -50.00000000000044, 38.50000000000003, 27.899999999999956, -50.00000000000044, -50.00000000000044, 45.5, 47.5, -50.00000000000044, 44.900000000000006, 43.10000000000001, 42.10000000000001, -50.00000000000044, -50.00000000000044, 44.10000000000001, 45.3, 22.699999999999882, 11.499999999999723, -50.00000000000044, 44.300000000000004, -50.00000000000044, 25.29999999999992, 43.7], "episode_lengths": [46, 500, 378, 50, 84, 232, 72, 76, 40, 32, 220, 40, 40, 230, 56, 500, 500, 200, 500, 56, 68, 126, 68, 500, 92, 500, 36, 500, 158, 82, 448, 500, 74, 30, 74, 232, 106, 50, 66, 44, 62, 500, 500, 500, 500, 500, 78, 48, 120, 86, 334, 160, 500, 500, 44, 500, 82, 86, 500, 352, 30, 68, 92, 500, 64, 500, 500, 500, 500, 132, 58, 500, 500, 74, 96, 62, 68, 500, 500, 116, 222, 500, 500, 46, 26, 500, 52, 70, 80, 500, 500, 60, 48, 274, 386, 500, 58, 500, 248, 64]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37582854691248146, "mean_inference_ms": 1.209307537902939, "mean_action_processing_ms": 0.1381023318152852, "mean_env_wait_ms": 0.08264621299056625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03301811218261719, "StateBufferConnector_ms": 0.003000020980834961, "ViewRequirementAgentConnector_ms": 0.1360001564025879}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000, "num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5906.686330722999, "num_env_steps_trained_throughput_per_sec": 5906.686330722999, "timesteps_total": 552000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 552000, "timers": {"training_iteration_time_ms": 2191.063, "sample_time_ms": 1932.534, "load_time_ms": 12.274, "load_throughput": 977702.736, "learn_time_ms": 231.617, "learn_throughput": 51809.578, "synch_weights_time_ms": 13.029}, "counters": {"num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000}, "done": false, "episodes_total": 2046, "training_iteration": 46, "trial_id": "9f288_00016", "date": "2023-10-25_16-53-14", "timestamp": 1698249194, "time_this_iter_s": 2.0375943183898926, "time_total_s": 100.37529277801514, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 100.37529277801514, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 57.5, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.8421709430404013e-15, "cur_lr": 0.0003, "total_loss": 6.44187789493137, "policy_loss": -0.00031560990545484755, "vf_loss": 6.442244635687934, "vf_explained_var": -7.285012139214409e-07, "kl": 0.000695450632343232, "entropy": 0.5118690497345395, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 837.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_agent_steps_sampled": 564000, "num_agent_steps_trained": 564000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.8719999999998094, "episode_len_mean": 271.88, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 45.3, 38.10000000000002, 41.500000000000014, 16.699999999999797, 34.10000000000004, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 41.90000000000001, 41.500000000000014, -50.00000000000044, 14.899999999999771, 47.1, 43.30000000000001, 40.90000000000002, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.900000000000034, 44.300000000000004, -50.00000000000044, -50.00000000000044, 42.70000000000001, 40.500000000000014, 43.900000000000006, 43.30000000000001, -50.00000000000044, -50.00000000000044, 38.50000000000003, 27.899999999999956, -50.00000000000044, -50.00000000000044, 45.5, 47.5, -50.00000000000044, 44.900000000000006, 43.10000000000001, 42.10000000000001, -50.00000000000044, -50.00000000000044, 44.10000000000001, 45.3, 22.699999999999882, 11.499999999999723, -50.00000000000044, 44.300000000000004, -50.00000000000044, 25.29999999999992, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 38.10000000000002, -50.00000000000044, 29.69999999999998, 46.5, 43.900000000000006, -50.00000000000044, -50.00000000000044, 0.09999999999956088, 42.900000000000006, 32.700000000000024, 44.900000000000006, 29.899999999999984, -50.00000000000044, 39.70000000000002, 36.30000000000003, 44.10000000000001, -50.00000000000044, -50.00000000000044, 33.10000000000003, -50.00000000000044, 45.7, -50.00000000000044, 4.099999999999618, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 46.699999999999996, 42.500000000000014, 45.3, 43.900000000000006, -50.00000000000044, -50.00000000000044, 45.9, 44.5, 36.900000000000034, 22.899999999999885], "episode_lengths": [500, 500, 500, 78, 48, 120, 86, 334, 160, 500, 500, 44, 500, 82, 86, 500, 352, 30, 68, 92, 500, 64, 500, 500, 500, 500, 132, 58, 500, 500, 74, 96, 62, 68, 500, 500, 116, 222, 500, 500, 46, 26, 500, 52, 70, 80, 500, 500, 60, 48, 274, 386, 500, 58, 500, 248, 64, 500, 500, 500, 64, 120, 500, 204, 36, 62, 500, 500, 500, 72, 174, 52, 202, 500, 104, 138, 60, 500, 500, 170, 500, 44, 500, 460, 500, 68, 500, 500, 52, 500, 34, 76, 48, 62, 500, 500, 42, 56, 132, 272]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3767193630243224, "mean_inference_ms": 1.2097071389923437, "mean_action_processing_ms": 0.1378348456184714, "mean_env_wait_ms": 0.082851201658652, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03502058982849121, "StateBufferConnector_ms": 0.007003307342529297, "ViewRequirementAgentConnector_ms": 0.1339888572692871}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.8719999999998094, "episode_len_mean": 271.88, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 45.3, 38.10000000000002, 41.500000000000014, 16.699999999999797, 34.10000000000004, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 41.90000000000001, 41.500000000000014, -50.00000000000044, 14.899999999999771, 47.1, 43.30000000000001, 40.90000000000002, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.900000000000034, 44.300000000000004, -50.00000000000044, -50.00000000000044, 42.70000000000001, 40.500000000000014, 43.900000000000006, 43.30000000000001, -50.00000000000044, -50.00000000000044, 38.50000000000003, 27.899999999999956, -50.00000000000044, -50.00000000000044, 45.5, 47.5, -50.00000000000044, 44.900000000000006, 43.10000000000001, 42.10000000000001, -50.00000000000044, -50.00000000000044, 44.10000000000001, 45.3, 22.699999999999882, 11.499999999999723, -50.00000000000044, 44.300000000000004, -50.00000000000044, 25.29999999999992, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 38.10000000000002, -50.00000000000044, 29.69999999999998, 46.5, 43.900000000000006, -50.00000000000044, -50.00000000000044, 0.09999999999956088, 42.900000000000006, 32.700000000000024, 44.900000000000006, 29.899999999999984, -50.00000000000044, 39.70000000000002, 36.30000000000003, 44.10000000000001, -50.00000000000044, -50.00000000000044, 33.10000000000003, -50.00000000000044, 45.7, -50.00000000000044, 4.099999999999618, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 46.699999999999996, 42.500000000000014, 45.3, 43.900000000000006, -50.00000000000044, -50.00000000000044, 45.9, 44.5, 36.900000000000034, 22.899999999999885], "episode_lengths": [500, 500, 500, 78, 48, 120, 86, 334, 160, 500, 500, 44, 500, 82, 86, 500, 352, 30, 68, 92, 500, 64, 500, 500, 500, 500, 132, 58, 500, 500, 74, 96, 62, 68, 500, 500, 116, 222, 500, 500, 46, 26, 500, 52, 70, 80, 500, 500, 60, 48, 274, 386, 500, 58, 500, 248, 64, 500, 500, 500, 64, 120, 500, 204, 36, 62, 500, 500, 500, 72, 174, 52, 202, 500, 104, 138, 60, 500, 500, 170, 500, 44, 500, 460, 500, 68, 500, 500, 52, 500, 34, 76, 48, 62, 500, 500, 42, 56, 132, 272]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3767193630243224, "mean_inference_ms": 1.2097071389923437, "mean_action_processing_ms": 0.1378348456184714, "mean_env_wait_ms": 0.082851201658652, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03502058982849121, "StateBufferConnector_ms": 0.007003307342529297, "ViewRequirementAgentConnector_ms": 0.1339888572692871}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 564000, "num_agent_steps_trained": 564000, "num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5674.330689344907, "num_env_steps_trained_throughput_per_sec": 5674.330689344907, "timesteps_total": 564000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 564000, "timers": {"training_iteration_time_ms": 2193.081, "sample_time_ms": 1934.772, "load_time_ms": 12.278, "load_throughput": 977347.713, "learn_time_ms": 231.425, "learn_throughput": 51852.631, "synch_weights_time_ms": 12.998}, "counters": {"num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_agent_steps_sampled": 564000, "num_agent_steps_trained": 564000}, "done": false, "episodes_total": 2089, "training_iteration": 47, "trial_id": "9f288_00016", "date": "2023-10-25_16-53-16", "timestamp": 1698249196, "time_this_iter_s": 2.1197850704193115, "time_total_s": 102.49507784843445, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 102.49507784843445, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 64.2, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.4210854715202006e-15, "cur_lr": 0.0003, "total_loss": 6.8169271681043835, "policy_loss": -0.00011656992137432098, "vf_loss": 6.817093504799737, "vf_explained_var": -2.1523899502224393e-07, "kl": 0.0003004961741000203, "entropy": 0.49852273530430263, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 855.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.076999999999817, "episode_len_mean": 264.86, "episode_media": {}, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.699999999999882, 11.499999999999723, -50.00000000000044, 44.300000000000004, -50.00000000000044, 25.29999999999992, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 38.10000000000002, -50.00000000000044, 29.69999999999998, 46.5, 43.900000000000006, -50.00000000000044, -50.00000000000044, 0.09999999999956088, 42.900000000000006, 32.700000000000024, 44.900000000000006, 29.899999999999984, -50.00000000000044, 39.70000000000002, 36.30000000000003, 44.10000000000001, -50.00000000000044, -50.00000000000044, 33.10000000000003, -50.00000000000044, 45.7, -50.00000000000044, 4.099999999999618, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 46.699999999999996, 42.500000000000014, 45.3, 43.900000000000006, -50.00000000000044, -50.00000000000044, 45.9, 44.5, 36.900000000000034, 22.899999999999885, -50.00000000000044, 45.1, 14.899999999999771, -50.00000000000044, -50.00000000000044, 38.10000000000002, 29.099999999999973, 45.7, -50.00000000000044, 37.10000000000003, 45.1, -50.00000000000044, -50.00000000000044, 42.500000000000014, 45.9, -50.00000000000044, 18.29999999999982, -50.00000000000044, -50.00000000000044, 39.90000000000002, 39.50000000000002, 42.10000000000001, 35.500000000000036, 30.099999999999987, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 45.1, 47.5, 41.70000000000002, -50.00000000000044, 16.09999999999979, -50.00000000000044, 47.1, -50.00000000000044, 42.30000000000001, 45.3, 42.900000000000006, -50.00000000000044, 47.1, 47.1, 7.699999999999669, 42.500000000000014, 41.70000000000002, 43.7, 40.90000000000002, -50.00000000000044, 46.3], "episode_lengths": [274, 386, 500, 58, 500, 248, 64, 500, 500, 500, 64, 120, 500, 204, 36, 62, 500, 500, 500, 72, 174, 52, 202, 500, 104, 138, 60, 500, 500, 170, 500, 44, 500, 460, 500, 68, 500, 500, 52, 500, 34, 76, 48, 62, 500, 500, 42, 56, 132, 272, 500, 50, 352, 500, 500, 120, 210, 44, 500, 130, 50, 500, 500, 76, 42, 500, 318, 500, 500, 102, 106, 80, 146, 200, 500, 500, 60, 500, 500, 50, 26, 84, 500, 340, 500, 30, 500, 78, 48, 72, 500, 30, 30, 424, 76, 84, 64, 92, 500, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3772290872204277, "mean_inference_ms": 1.209498096550396, "mean_action_processing_ms": 0.13812016967529636, "mean_env_wait_ms": 0.0827595101579787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025000333786010742, "StateBufferConnector_ms": 0.011004447937011719, "ViewRequirementAgentConnector_ms": 0.13299894332885742}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.076999999999817, "episode_len_mean": 264.86, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [22.699999999999882, 11.499999999999723, -50.00000000000044, 44.300000000000004, -50.00000000000044, 25.29999999999992, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 38.10000000000002, -50.00000000000044, 29.69999999999998, 46.5, 43.900000000000006, -50.00000000000044, -50.00000000000044, 0.09999999999956088, 42.900000000000006, 32.700000000000024, 44.900000000000006, 29.899999999999984, -50.00000000000044, 39.70000000000002, 36.30000000000003, 44.10000000000001, -50.00000000000044, -50.00000000000044, 33.10000000000003, -50.00000000000044, 45.7, -50.00000000000044, 4.099999999999618, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 46.699999999999996, 42.500000000000014, 45.3, 43.900000000000006, -50.00000000000044, -50.00000000000044, 45.9, 44.5, 36.900000000000034, 22.899999999999885, -50.00000000000044, 45.1, 14.899999999999771, -50.00000000000044, -50.00000000000044, 38.10000000000002, 29.099999999999973, 45.7, -50.00000000000044, 37.10000000000003, 45.1, -50.00000000000044, -50.00000000000044, 42.500000000000014, 45.9, -50.00000000000044, 18.29999999999982, -50.00000000000044, -50.00000000000044, 39.90000000000002, 39.50000000000002, 42.10000000000001, 35.500000000000036, 30.099999999999987, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 45.1, 47.5, 41.70000000000002, -50.00000000000044, 16.09999999999979, -50.00000000000044, 47.1, -50.00000000000044, 42.30000000000001, 45.3, 42.900000000000006, -50.00000000000044, 47.1, 47.1, 7.699999999999669, 42.500000000000014, 41.70000000000002, 43.7, 40.90000000000002, -50.00000000000044, 46.3], "episode_lengths": [274, 386, 500, 58, 500, 248, 64, 500, 500, 500, 64, 120, 500, 204, 36, 62, 500, 500, 500, 72, 174, 52, 202, 500, 104, 138, 60, 500, 500, 170, 500, 44, 500, 460, 500, 68, 500, 500, 52, 500, 34, 76, 48, 62, 500, 500, 42, 56, 132, 272, 500, 50, 352, 500, 500, 120, 210, 44, 500, 130, 50, 500, 500, 76, 42, 500, 318, 500, 500, 102, 106, 80, 146, 200, 500, 500, 60, 500, 500, 50, 26, 84, 500, 340, 500, 30, 500, 78, 48, 72, 500, 30, 30, 424, 76, 84, 64, 92, 500, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3772290872204277, "mean_inference_ms": 1.209498096550396, "mean_action_processing_ms": 0.13812016967529636, "mean_env_wait_ms": 0.0827595101579787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025000333786010742, "StateBufferConnector_ms": 0.011004447937011719, "ViewRequirementAgentConnector_ms": 0.13299894332885742}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5383.846486350262, "num_env_steps_trained_throughput_per_sec": 5383.846486350262, "timesteps_total": 576000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 576000, "timers": {"training_iteration_time_ms": 2161.201, "sample_time_ms": 1910.396, "load_time_ms": 11.905, "load_throughput": 1007957.416, "learn_time_ms": 224.479, "learn_throughput": 53457.126, "synch_weights_time_ms": 12.912}, "counters": {"num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "done": false, "episodes_total": 2139, "training_iteration": 48, "trial_id": "9f288_00016", "date": "2023-10-25_16-53-18", "timestamp": 1698249198, "time_this_iter_s": 2.233882188796997, "time_total_s": 104.72896003723145, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 104.72896003723145, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 60.86666666666667, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.105427357601003e-16, "cur_lr": 0.0003, "total_loss": 6.899339305029975, "policy_loss": -0.00040365455465184315, "vf_loss": 6.899793651368883, "vf_explained_var": -7.616149054633246e-08, "kl": 0.0004004434514968125, "entropy": 0.5072287221749624, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 873.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 588000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.675999999999822, "episode_len_mean": 253.88, "episode_media": {}, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.899999999999885, -50.00000000000044, 45.1, 14.899999999999771, -50.00000000000044, -50.00000000000044, 38.10000000000002, 29.099999999999973, 45.7, -50.00000000000044, 37.10000000000003, 45.1, -50.00000000000044, -50.00000000000044, 42.500000000000014, 45.9, -50.00000000000044, 18.29999999999982, -50.00000000000044, -50.00000000000044, 39.90000000000002, 39.50000000000002, 42.10000000000001, 35.500000000000036, 30.099999999999987, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 45.1, 47.5, 41.70000000000002, -50.00000000000044, 16.09999999999979, -50.00000000000044, 47.1, -50.00000000000044, 42.30000000000001, 45.3, 42.900000000000006, -50.00000000000044, 47.1, 47.1, 7.699999999999669, 42.500000000000014, 41.70000000000002, 43.7, 40.90000000000002, -50.00000000000044, 46.3, -50.00000000000044, 45.1, 46.099999999999994, -50.00000000000044, 44.300000000000004, 43.7, 27.099999999999945, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.099999999999888, 45.7, -50.00000000000044, -50.00000000000044, 45.5, 41.30000000000001, 46.5, 44.300000000000004, 37.90000000000003, 13.299999999999748, -50.00000000000044, 42.30000000000001, 43.10000000000001, 41.90000000000001, 19.69999999999984, 43.7, 45.7, 44.900000000000006, 44.10000000000001, -50.00000000000044, 44.900000000000006, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 22.699999999999882, 44.900000000000006, 18.29999999999982, 26.69999999999994, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 43.10000000000001], "episode_lengths": [272, 500, 50, 352, 500, 500, 120, 210, 44, 500, 130, 50, 500, 500, 76, 42, 500, 318, 500, 500, 102, 106, 80, 146, 200, 500, 500, 60, 500, 500, 50, 26, 84, 500, 340, 500, 30, 500, 78, 48, 72, 500, 30, 30, 424, 76, 84, 64, 92, 500, 38, 500, 50, 40, 500, 58, 64, 230, 500, 82, 500, 500, 500, 500, 500, 270, 44, 500, 500, 46, 88, 36, 58, 122, 368, 500, 78, 70, 82, 304, 64, 44, 52, 60, 500, 52, 36, 500, 500, 500, 54, 274, 52, 318, 234, 500, 500, 64, 500, 70]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3765185775685061, "mean_inference_ms": 1.2096881191528077, "mean_action_processing_ms": 0.13822338274942345, "mean_env_wait_ms": 0.0829442443069553, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022339344024658203, "StateBufferConnector_ms": 0.009002447128295898, "ViewRequirementAgentConnector_ms": 0.1520371437072754}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.675999999999822, "episode_len_mean": 253.88, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [22.899999999999885, -50.00000000000044, 45.1, 14.899999999999771, -50.00000000000044, -50.00000000000044, 38.10000000000002, 29.099999999999973, 45.7, -50.00000000000044, 37.10000000000003, 45.1, -50.00000000000044, -50.00000000000044, 42.500000000000014, 45.9, -50.00000000000044, 18.29999999999982, -50.00000000000044, -50.00000000000044, 39.90000000000002, 39.50000000000002, 42.10000000000001, 35.500000000000036, 30.099999999999987, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 45.1, 47.5, 41.70000000000002, -50.00000000000044, 16.09999999999979, -50.00000000000044, 47.1, -50.00000000000044, 42.30000000000001, 45.3, 42.900000000000006, -50.00000000000044, 47.1, 47.1, 7.699999999999669, 42.500000000000014, 41.70000000000002, 43.7, 40.90000000000002, -50.00000000000044, 46.3, -50.00000000000044, 45.1, 46.099999999999994, -50.00000000000044, 44.300000000000004, 43.7, 27.099999999999945, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.099999999999888, 45.7, -50.00000000000044, -50.00000000000044, 45.5, 41.30000000000001, 46.5, 44.300000000000004, 37.90000000000003, 13.299999999999748, -50.00000000000044, 42.30000000000001, 43.10000000000001, 41.90000000000001, 19.69999999999984, 43.7, 45.7, 44.900000000000006, 44.10000000000001, -50.00000000000044, 44.900000000000006, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 22.699999999999882, 44.900000000000006, 18.29999999999982, 26.69999999999994, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 43.10000000000001], "episode_lengths": [272, 500, 50, 352, 500, 500, 120, 210, 44, 500, 130, 50, 500, 500, 76, 42, 500, 318, 500, 500, 102, 106, 80, 146, 200, 500, 500, 60, 500, 500, 50, 26, 84, 500, 340, 500, 30, 500, 78, 48, 72, 500, 30, 30, 424, 76, 84, 64, 92, 500, 38, 500, 50, 40, 500, 58, 64, 230, 500, 82, 500, 500, 500, 500, 500, 270, 44, 500, 500, 46, 88, 36, 58, 122, 368, 500, 78, 70, 82, 304, 64, 44, 52, 60, 500, 52, 36, 500, 500, 500, 54, 274, 52, 318, 234, 500, 500, 64, 500, 70]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3765185775685061, "mean_inference_ms": 1.2096881191528077, "mean_action_processing_ms": 0.13822338274942345, "mean_env_wait_ms": 0.0829442443069553, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022339344024658203, "StateBufferConnector_ms": 0.009002447128295898, "ViewRequirementAgentConnector_ms": 0.1520371437072754}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 588000, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5668.526080560487, "num_env_steps_trained_throughput_per_sec": 5668.526080560487, "timesteps_total": 588000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 588000, "timers": {"training_iteration_time_ms": 2144.565, "sample_time_ms": 1905.473, "load_time_ms": 11.105, "load_throughput": 1080639.474, "learn_time_ms": 217.117, "learn_throughput": 55269.812, "synch_weights_time_ms": 9.461}, "counters": {"num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 588000}, "done": false, "episodes_total": 2188, "training_iteration": 49, "trial_id": "9f288_00016", "date": "2023-10-25_16-53-20", "timestamp": 1698249200, "time_this_iter_s": 2.121950626373291, "time_total_s": 106.85091066360474, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 106.85091066360474, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 57.43333333333334, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.5527136788005016e-16, "cur_lr": 0.0003, "total_loss": 6.719840632544623, "policy_loss": -0.00011326207054985894, "vf_loss": 6.720006571875678, "vf_explained_var": -6.622738308376736e-08, "kl": 0.000580801506796686, "entropy": 0.5269341634379493, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 891.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.355999999999815, "episode_len_mean": 257.08, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [47.1, 7.699999999999669, 42.500000000000014, 41.70000000000002, 43.7, 40.90000000000002, -50.00000000000044, 46.3, -50.00000000000044, 45.1, 46.099999999999994, -50.00000000000044, 44.300000000000004, 43.7, 27.099999999999945, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.099999999999888, 45.7, -50.00000000000044, -50.00000000000044, 45.5, 41.30000000000001, 46.5, 44.300000000000004, 37.90000000000003, 13.299999999999748, -50.00000000000044, 42.30000000000001, 43.10000000000001, 41.90000000000001, 19.69999999999984, 43.7, 45.7, 44.900000000000006, 44.10000000000001, -50.00000000000044, 44.900000000000006, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 22.699999999999882, 44.900000000000006, 18.29999999999982, 26.69999999999994, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 43.10000000000001, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 47.1, 41.30000000000001, 42.900000000000006, 41.70000000000002, 41.30000000000001, 42.30000000000001, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 12.299999999999734, 43.7, 45.3, 46.5, -50.00000000000044, -50.00000000000044, 10.699999999999712, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 12.69999999999974, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 6.099999999999646, 43.900000000000006, 41.30000000000001, 40.500000000000014, 4.499999999999623, -50.00000000000044, 39.70000000000002, 45.9, -50.00000000000044, 42.500000000000014, 43.10000000000001, 47.3], "episode_lengths": [30, 424, 76, 84, 64, 92, 500, 38, 500, 50, 40, 500, 58, 64, 230, 500, 82, 500, 500, 500, 500, 500, 270, 44, 500, 500, 46, 88, 36, 58, 122, 368, 500, 78, 70, 82, 304, 64, 44, 52, 60, 500, 52, 36, 500, 500, 500, 54, 274, 52, 318, 234, 500, 500, 64, 500, 70, 500, 66, 500, 500, 30, 88, 72, 84, 88, 78, 500, 500, 62, 500, 500, 378, 64, 48, 36, 500, 500, 394, 66, 500, 500, 500, 374, 500, 500, 500, 46, 440, 62, 88, 96, 456, 500, 104, 42, 500, 76, 70, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37658122664013804, "mean_inference_ms": 1.2103286630813925, "mean_action_processing_ms": 0.1382687690845654, "mean_env_wait_ms": 0.08298495568062433, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02243971824645996, "StateBufferConnector_ms": 0.004001140594482422, "ViewRequirementAgentConnector_ms": 0.13203048706054688}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.355999999999815, "episode_len_mean": 257.08, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [47.1, 7.699999999999669, 42.500000000000014, 41.70000000000002, 43.7, 40.90000000000002, -50.00000000000044, 46.3, -50.00000000000044, 45.1, 46.099999999999994, -50.00000000000044, 44.300000000000004, 43.7, 27.099999999999945, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.099999999999888, 45.7, -50.00000000000044, -50.00000000000044, 45.5, 41.30000000000001, 46.5, 44.300000000000004, 37.90000000000003, 13.299999999999748, -50.00000000000044, 42.30000000000001, 43.10000000000001, 41.90000000000001, 19.69999999999984, 43.7, 45.7, 44.900000000000006, 44.10000000000001, -50.00000000000044, 44.900000000000006, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 22.699999999999882, 44.900000000000006, 18.29999999999982, 26.69999999999994, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 43.10000000000001, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 47.1, 41.30000000000001, 42.900000000000006, 41.70000000000002, 41.30000000000001, 42.30000000000001, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 12.299999999999734, 43.7, 45.3, 46.5, -50.00000000000044, -50.00000000000044, 10.699999999999712, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 12.69999999999974, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 6.099999999999646, 43.900000000000006, 41.30000000000001, 40.500000000000014, 4.499999999999623, -50.00000000000044, 39.70000000000002, 45.9, -50.00000000000044, 42.500000000000014, 43.10000000000001, 47.3], "episode_lengths": [30, 424, 76, 84, 64, 92, 500, 38, 500, 50, 40, 500, 58, 64, 230, 500, 82, 500, 500, 500, 500, 500, 270, 44, 500, 500, 46, 88, 36, 58, 122, 368, 500, 78, 70, 82, 304, 64, 44, 52, 60, 500, 52, 36, 500, 500, 500, 54, 274, 52, 318, 234, 500, 500, 64, 500, 70, 500, 66, 500, 500, 30, 88, 72, 84, 88, 78, 500, 500, 62, 500, 500, 378, 64, 48, 36, 500, 500, 394, 66, 500, 500, 500, 374, 500, 500, 500, 46, 440, 62, 88, 96, 456, 500, 104, 42, 500, 76, 70, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37658122664013804, "mean_inference_ms": 1.2103286630813925, "mean_action_processing_ms": 0.1382687690845654, "mean_env_wait_ms": 0.08298495568062433, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02243971824645996, "StateBufferConnector_ms": 0.004001140594482422, "ViewRequirementAgentConnector_ms": 0.13203048706054688}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5058.928404686547, "num_env_steps_trained_throughput_per_sec": 5058.928404686547, "timesteps_total": 600000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 600000, "timers": {"training_iteration_time_ms": 2174.739, "sample_time_ms": 1912.177, "load_time_ms": 12.507, "load_throughput": 959449.169, "learn_time_ms": 239.18, "learn_throughput": 50171.481, "synch_weights_time_ms": 9.465}, "counters": {"num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000}, "done": false, "episodes_total": 2231, "training_iteration": 50, "trial_id": "9f288_00016", "date": "2023-10-25_16-53-23", "timestamp": 1698249203, "time_this_iter_s": 2.377042770385742, "time_total_s": 109.22795343399048, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 109.22795343399048, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 55.1, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.7763568394002508e-16, "cur_lr": 0.0003, "total_loss": 6.622470855712891, "policy_loss": -0.00017312872740957473, "vf_loss": 6.622696532143487, "vf_explained_var": -1.7252233293321397e-06, "kl": 0.0002818951167758617, "entropy": 0.5238157510757446, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 909.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.4529999999997965, "episode_len_mean": 281.08, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.900000000000006, 44.10000000000001, -50.00000000000044, 44.900000000000006, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 22.699999999999882, 44.900000000000006, 18.29999999999982, 26.69999999999994, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 43.10000000000001, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 47.1, 41.30000000000001, 42.900000000000006, 41.70000000000002, 41.30000000000001, 42.30000000000001, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 12.299999999999734, 43.7, 45.3, 46.5, -50.00000000000044, -50.00000000000044, 10.699999999999712, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 12.69999999999974, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 6.099999999999646, 43.900000000000006, 41.30000000000001, 40.500000000000014, 4.499999999999623, -50.00000000000044, 39.70000000000002, 45.9, -50.00000000000044, 42.500000000000014, 43.10000000000001, 47.3, -50.00000000000044, 37.50000000000003, 44.5, 46.099999999999994, 28.89999999999997, -50.00000000000044, 45.7, 45.5, -50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 44.7, 4.099999999999618, 0.49999999999956657, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 5.499999999999638, 32.50000000000002, 37.90000000000003, 35.900000000000034, 15.899999999999785, 38.50000000000003, 34.70000000000004, -50.00000000000044, -50.00000000000044, 45.5, 43.30000000000001, 36.50000000000003, 18.499999999999822, 41.100000000000016, 41.100000000000016], "episode_lengths": [52, 60, 500, 52, 36, 500, 500, 500, 54, 274, 52, 318, 234, 500, 500, 64, 500, 70, 500, 66, 500, 500, 30, 88, 72, 84, 88, 78, 500, 500, 62, 500, 500, 378, 64, 48, 36, 500, 500, 394, 66, 500, 500, 500, 374, 500, 500, 500, 46, 440, 62, 88, 96, 456, 500, 104, 42, 500, 76, 70, 28, 500, 126, 56, 40, 212, 500, 44, 46, 500, 500, 102, 500, 500, 500, 500, 500, 26, 54, 460, 496, 500, 500, 500, 500, 446, 176, 122, 142, 342, 116, 154, 500, 500, 46, 68, 136, 316, 90, 90]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37658118145824104, "mean_inference_ms": 1.210701692035481, "mean_action_processing_ms": 0.137844458077825, "mean_env_wait_ms": 0.08324634983808508, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027101516723632812, "StateBufferConnector_ms": 0.0020012855529785156, "ViewRequirementAgentConnector_ms": 0.11101555824279785}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.4529999999997965, "episode_len_mean": 281.08, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.900000000000006, 44.10000000000001, -50.00000000000044, 44.900000000000006, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 22.699999999999882, 44.900000000000006, 18.29999999999982, 26.69999999999994, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 43.10000000000001, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 47.1, 41.30000000000001, 42.900000000000006, 41.70000000000002, 41.30000000000001, 42.30000000000001, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 12.299999999999734, 43.7, 45.3, 46.5, -50.00000000000044, -50.00000000000044, 10.699999999999712, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 12.69999999999974, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 6.099999999999646, 43.900000000000006, 41.30000000000001, 40.500000000000014, 4.499999999999623, -50.00000000000044, 39.70000000000002, 45.9, -50.00000000000044, 42.500000000000014, 43.10000000000001, 47.3, -50.00000000000044, 37.50000000000003, 44.5, 46.099999999999994, 28.89999999999997, -50.00000000000044, 45.7, 45.5, -50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 44.7, 4.099999999999618, 0.49999999999956657, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 5.499999999999638, 32.50000000000002, 37.90000000000003, 35.900000000000034, 15.899999999999785, 38.50000000000003, 34.70000000000004, -50.00000000000044, -50.00000000000044, 45.5, 43.30000000000001, 36.50000000000003, 18.499999999999822, 41.100000000000016, 41.100000000000016], "episode_lengths": [52, 60, 500, 52, 36, 500, 500, 500, 54, 274, 52, 318, 234, 500, 500, 64, 500, 70, 500, 66, 500, 500, 30, 88, 72, 84, 88, 78, 500, 500, 62, 500, 500, 378, 64, 48, 36, 500, 500, 394, 66, 500, 500, 500, 374, 500, 500, 500, 46, 440, 62, 88, 96, 456, 500, 104, 42, 500, 76, 70, 28, 500, 126, 56, 40, 212, 500, 44, 46, 500, 500, 102, 500, 500, 500, 500, 500, 26, 54, 460, 496, 500, 500, 500, 500, 446, 176, 122, 142, 342, 116, 154, 500, 500, 46, 68, 136, 316, 90, 90]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37658118145824104, "mean_inference_ms": 1.210701692035481, "mean_action_processing_ms": 0.137844458077825, "mean_env_wait_ms": 0.08324634983808508, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027101516723632812, "StateBufferConnector_ms": 0.0020012855529785156, "ViewRequirementAgentConnector_ms": 0.11101555824279785}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000, "num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5537.385258143392, "num_env_steps_trained_throughput_per_sec": 5537.385258143392, "timesteps_total": 612000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 612000, "timers": {"training_iteration_time_ms": 2168.0, "sample_time_ms": 1920.178, "load_time_ms": 12.003, "load_throughput": 999718.904, "learn_time_ms": 225.001, "learn_throughput": 53332.983, "synch_weights_time_ms": 9.41}, "counters": {"num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000}, "done": false, "episodes_total": 2270, "training_iteration": 51, "trial_id": "9f288_00016", "date": "2023-10-25_16-53-25", "timestamp": 1698249205, "time_this_iter_s": 2.173085927963257, "time_total_s": 111.40103936195374, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 111.40103936195374, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 61.06666666666666, "ram_util_percent": 27.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.881784197001254e-17, "cur_lr": 0.0003, "total_loss": 6.8158560329013405, "policy_loss": -0.0005973130464553833, "vf_loss": 6.816505193710327, "vf_explained_var": -4.801485273573134e-07, "kl": 0.0005840980573326407, "entropy": 0.5176663200060526, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 927.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.286999999999834, "episode_len_mean": 252.8, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.499999999999623, -50.00000000000044, 39.70000000000002, 45.9, -50.00000000000044, 42.500000000000014, 43.10000000000001, 47.3, -50.00000000000044, 37.50000000000003, 44.5, 46.099999999999994, 28.89999999999997, -50.00000000000044, 45.7, 45.5, -50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 44.7, 4.099999999999618, 0.49999999999956657, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 5.499999999999638, 32.50000000000002, 37.90000000000003, 35.900000000000034, 15.899999999999785, 38.50000000000003, 34.70000000000004, -50.00000000000044, -50.00000000000044, 45.5, 43.30000000000001, 36.50000000000003, 18.499999999999822, 41.100000000000016, 41.100000000000016, -50.00000000000044, -50.00000000000044, 45.1, 35.10000000000004, 21.89999999999987, 35.70000000000003, 42.500000000000014, 46.5, 41.500000000000014, 36.900000000000034, 42.900000000000006, -50.00000000000044, 43.50000000000001, 46.9, 43.10000000000001, 39.50000000000002, 39.300000000000026, 19.899999999999842, 40.10000000000002, 46.099999999999994, 45.3, 27.899999999999956, 42.30000000000001, 30.9, -50.00000000000044, 45.3, 38.10000000000002, 45.3, 45.9, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 44.10000000000001, 44.900000000000006, 43.30000000000001, 42.10000000000001, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.700000000000024, 44.900000000000006, 40.30000000000002, 5.6999999999996405, -50.00000000000044, 25.099999999999916, 44.7, -50.00000000000044, -50.00000000000044], "episode_lengths": [456, 500, 104, 42, 500, 76, 70, 28, 500, 126, 56, 40, 212, 500, 44, 46, 500, 500, 102, 500, 500, 500, 500, 500, 26, 54, 460, 496, 500, 500, 500, 500, 446, 176, 122, 142, 342, 116, 154, 500, 500, 46, 68, 136, 316, 90, 90, 500, 500, 50, 150, 282, 144, 76, 36, 86, 132, 72, 500, 66, 32, 70, 106, 108, 302, 100, 40, 48, 222, 78, 192, 500, 48, 120, 48, 42, 500, 46, 500, 500, 60, 52, 68, 80, 70, 500, 500, 500, 500, 500, 500, 174, 52, 98, 444, 500, 250, 54, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37654480088226505, "mean_inference_ms": 1.2099260431250611, "mean_action_processing_ms": 0.1381680658404007, "mean_env_wait_ms": 0.08284443854648778, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026990652084350586, "StateBufferConnector_ms": 0.005999088287353516, "ViewRequirementAgentConnector_ms": 0.10787343978881836}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.286999999999834, "episode_len_mean": 252.8, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [4.499999999999623, -50.00000000000044, 39.70000000000002, 45.9, -50.00000000000044, 42.500000000000014, 43.10000000000001, 47.3, -50.00000000000044, 37.50000000000003, 44.5, 46.099999999999994, 28.89999999999997, -50.00000000000044, 45.7, 45.5, -50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 44.7, 4.099999999999618, 0.49999999999956657, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 5.499999999999638, 32.50000000000002, 37.90000000000003, 35.900000000000034, 15.899999999999785, 38.50000000000003, 34.70000000000004, -50.00000000000044, -50.00000000000044, 45.5, 43.30000000000001, 36.50000000000003, 18.499999999999822, 41.100000000000016, 41.100000000000016, -50.00000000000044, -50.00000000000044, 45.1, 35.10000000000004, 21.89999999999987, 35.70000000000003, 42.500000000000014, 46.5, 41.500000000000014, 36.900000000000034, 42.900000000000006, -50.00000000000044, 43.50000000000001, 46.9, 43.10000000000001, 39.50000000000002, 39.300000000000026, 19.899999999999842, 40.10000000000002, 46.099999999999994, 45.3, 27.899999999999956, 42.30000000000001, 30.9, -50.00000000000044, 45.3, 38.10000000000002, 45.3, 45.9, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 44.10000000000001, 44.900000000000006, 43.30000000000001, 42.10000000000001, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.700000000000024, 44.900000000000006, 40.30000000000002, 5.6999999999996405, -50.00000000000044, 25.099999999999916, 44.7, -50.00000000000044, -50.00000000000044], "episode_lengths": [456, 500, 104, 42, 500, 76, 70, 28, 500, 126, 56, 40, 212, 500, 44, 46, 500, 500, 102, 500, 500, 500, 500, 500, 26, 54, 460, 496, 500, 500, 500, 500, 446, 176, 122, 142, 342, 116, 154, 500, 500, 46, 68, 136, 316, 90, 90, 500, 500, 50, 150, 282, 144, 76, 36, 86, 132, 72, 500, 66, 32, 70, 106, 108, 302, 100, 40, 48, 222, 78, 192, 500, 48, 120, 48, 42, 500, 46, 500, 500, 60, 52, 68, 80, 70, 500, 500, 500, 500, 500, 500, 174, 52, 98, 444, 500, 250, 54, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37654480088226505, "mean_inference_ms": 1.2099260431250611, "mean_action_processing_ms": 0.1381680658404007, "mean_env_wait_ms": 0.08284443854648778, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026990652084350586, "StateBufferConnector_ms": 0.005999088287353516, "ViewRequirementAgentConnector_ms": 0.10787343978881836}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000, "num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5457.40135145685, "num_env_steps_trained_throughput_per_sec": 5457.40135145685, "timesteps_total": 624000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 624000, "timers": {"training_iteration_time_ms": 2177.189, "sample_time_ms": 1921.268, "load_time_ms": 13.093, "load_throughput": 916512.305, "learn_time_ms": 231.896, "learn_throughput": 51747.4, "synch_weights_time_ms": 9.51}, "counters": {"num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "done": false, "episodes_total": 2323, "training_iteration": 52, "trial_id": "9f288_00016", "date": "2023-10-25_16-53-27", "timestamp": 1698249207, "time_this_iter_s": 2.203848361968994, "time_total_s": 113.60488772392273, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 113.60488772392273, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 60.86666666666667, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.440892098500627e-17, "cur_lr": 0.0003, "total_loss": 7.154622766706678, "policy_loss": -0.0005705977479616801, "vf_loss": 7.155250178443061, "vf_explained_var": -5.794896019829644e-07, "kl": 0.0008190974454641441, "entropy": 0.566366026798884, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 945.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_agent_steps_sampled": 636000, "num_agent_steps_trained": 636000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 14.59099999999986, "episode_len_mean": 219.82, "episode_media": {}, "episodes_this_iter": 58, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 43.50000000000001, 46.9, 43.10000000000001, 39.50000000000002, 39.300000000000026, 19.899999999999842, 40.10000000000002, 46.099999999999994, 45.3, 27.899999999999956, 42.30000000000001, 30.9, -50.00000000000044, 45.3, 38.10000000000002, 45.3, 45.9, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 44.10000000000001, 44.900000000000006, 43.30000000000001, 42.10000000000001, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.700000000000024, 44.900000000000006, 40.30000000000002, 5.6999999999996405, -50.00000000000044, 25.099999999999916, 44.7, -50.00000000000044, -50.00000000000044, 12.499999999999737, 44.7, 44.10000000000001, 44.900000000000006, 45.9, 46.9, 38.50000000000003, 36.900000000000034, 39.50000000000002, -50.00000000000044, 45.7, 44.300000000000004, 42.10000000000001, 39.50000000000002, -50.00000000000044, 5.499999999999638, 31.1, -50.00000000000044, 42.10000000000001, 7.09999999999966, 41.70000000000002, 46.5, 42.70000000000001, 45.9, 42.70000000000001, 46.3, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 38.700000000000024, 45.3, 37.50000000000003, 31.300000000000004, 46.3, 44.10000000000001, 36.900000000000034, 30.499999999999993, -50.00000000000044, 45.3, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 3.0999999999996035, 44.10000000000001, 43.7, 45.9, 46.099999999999994, 44.5, 44.7, -50.00000000000044, 6.099999999999646, 23.699999999999896, 45.1], "episode_lengths": [500, 66, 32, 70, 106, 108, 302, 100, 40, 48, 222, 78, 192, 500, 48, 120, 48, 42, 500, 46, 500, 500, 60, 52, 68, 80, 70, 500, 500, 500, 500, 500, 500, 174, 52, 98, 444, 500, 250, 54, 500, 500, 376, 54, 60, 52, 42, 32, 116, 132, 106, 500, 44, 58, 80, 106, 500, 446, 190, 500, 80, 430, 84, 36, 74, 42, 74, 38, 500, 48, 500, 500, 114, 48, 126, 188, 38, 60, 132, 196, 500, 48, 60, 500, 500, 500, 500, 62, 500, 470, 60, 64, 42, 40, 56, 54, 500, 440, 264, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37646632983067746, "mean_inference_ms": 1.2096843591995985, "mean_action_processing_ms": 0.1382885893630649, "mean_env_wait_ms": 0.08277671501416994, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025005817413330078, "StateBufferConnector_ms": 0.005998373031616211, "ViewRequirementAgentConnector_ms": 0.11902976036071777}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 14.59099999999986, "episode_len_mean": 219.82, "episodes_this_iter": 58, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 43.50000000000001, 46.9, 43.10000000000001, 39.50000000000002, 39.300000000000026, 19.899999999999842, 40.10000000000002, 46.099999999999994, 45.3, 27.899999999999956, 42.30000000000001, 30.9, -50.00000000000044, 45.3, 38.10000000000002, 45.3, 45.9, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 44.10000000000001, 44.900000000000006, 43.30000000000001, 42.10000000000001, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.700000000000024, 44.900000000000006, 40.30000000000002, 5.6999999999996405, -50.00000000000044, 25.099999999999916, 44.7, -50.00000000000044, -50.00000000000044, 12.499999999999737, 44.7, 44.10000000000001, 44.900000000000006, 45.9, 46.9, 38.50000000000003, 36.900000000000034, 39.50000000000002, -50.00000000000044, 45.7, 44.300000000000004, 42.10000000000001, 39.50000000000002, -50.00000000000044, 5.499999999999638, 31.1, -50.00000000000044, 42.10000000000001, 7.09999999999966, 41.70000000000002, 46.5, 42.70000000000001, 45.9, 42.70000000000001, 46.3, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 38.700000000000024, 45.3, 37.50000000000003, 31.300000000000004, 46.3, 44.10000000000001, 36.900000000000034, 30.499999999999993, -50.00000000000044, 45.3, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 3.0999999999996035, 44.10000000000001, 43.7, 45.9, 46.099999999999994, 44.5, 44.7, -50.00000000000044, 6.099999999999646, 23.699999999999896, 45.1], "episode_lengths": [500, 66, 32, 70, 106, 108, 302, 100, 40, 48, 222, 78, 192, 500, 48, 120, 48, 42, 500, 46, 500, 500, 60, 52, 68, 80, 70, 500, 500, 500, 500, 500, 500, 174, 52, 98, 444, 500, 250, 54, 500, 500, 376, 54, 60, 52, 42, 32, 116, 132, 106, 500, 44, 58, 80, 106, 500, 446, 190, 500, 80, 430, 84, 36, 74, 42, 74, 38, 500, 48, 500, 500, 114, 48, 126, 188, 38, 60, 132, 196, 500, 48, 60, 500, 500, 500, 500, 62, 500, 470, 60, 64, 42, 40, 56, 54, 500, 440, 264, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37646632983067746, "mean_inference_ms": 1.2096843591995985, "mean_action_processing_ms": 0.1382885893630649, "mean_env_wait_ms": 0.08277671501416994, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025005817413330078, "StateBufferConnector_ms": 0.005998373031616211, "ViewRequirementAgentConnector_ms": 0.11902976036071777}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 636000, "num_agent_steps_trained": 636000, "num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5635.982751971577, "num_env_steps_trained_throughput_per_sec": 5635.982751971577, "timesteps_total": 636000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 636000, "timers": {"training_iteration_time_ms": 2167.998, "sample_time_ms": 1927.101, "load_time_ms": 12.292, "load_throughput": 976284.19, "learn_time_ms": 217.673, "learn_throughput": 55128.518, "synch_weights_time_ms": 9.51}, "counters": {"num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_agent_steps_sampled": 636000, "num_agent_steps_trained": 636000}, "done": false, "episodes_total": 2381, "training_iteration": 53, "trial_id": "9f288_00016", "date": "2023-10-25_16-53-29", "timestamp": 1698249209, "time_this_iter_s": 2.1341702938079834, "time_total_s": 115.73905801773071, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 115.73905801773071, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 61.96666666666667, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.2204460492503135e-17, "cur_lr": 0.0003, "total_loss": 6.787976185480754, "policy_loss": -3.00904115041097e-05, "vf_loss": 6.78806119494968, "vf_explained_var": -8.27842288547092e-07, "kl": 0.00011333420039565883, "entropy": 0.5500801470544603, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 963.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.627999999999847, "episode_len_mean": 234.42, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [38.50000000000003, 36.900000000000034, 39.50000000000002, -50.00000000000044, 45.7, 44.300000000000004, 42.10000000000001, 39.50000000000002, -50.00000000000044, 5.499999999999638, 31.1, -50.00000000000044, 42.10000000000001, 7.09999999999966, 41.70000000000002, 46.5, 42.70000000000001, 45.9, 42.70000000000001, 46.3, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 38.700000000000024, 45.3, 37.50000000000003, 31.300000000000004, 46.3, 44.10000000000001, 36.900000000000034, 30.499999999999993, -50.00000000000044, 45.3, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 3.0999999999996035, 44.10000000000001, 43.7, 45.9, 46.099999999999994, 44.5, 44.7, -50.00000000000044, 6.099999999999646, 23.699999999999896, 45.1, 41.90000000000001, 21.499999999999865, 46.5, 40.500000000000014, 9.499999999999694, -50.00000000000044, 44.10000000000001, 44.5, 17.69999999999981, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 35.70000000000003, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 35.900000000000034, 43.50000000000001, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 36.10000000000004, 42.500000000000014, 27.699999999999953, 45.3, -50.00000000000044, 43.50000000000001, 44.300000000000004, -50.00000000000044, -50.00000000000044, 17.69999999999981, 30.099999999999987, 37.70000000000003, 43.50000000000001, 43.7, 42.30000000000001, 46.5, 42.30000000000001], "episode_lengths": [116, 132, 106, 500, 44, 58, 80, 106, 500, 446, 190, 500, 80, 430, 84, 36, 74, 42, 74, 38, 500, 48, 500, 500, 114, 48, 126, 188, 38, 60, 132, 196, 500, 48, 60, 500, 500, 500, 500, 62, 500, 470, 60, 64, 42, 40, 56, 54, 500, 440, 264, 50, 82, 286, 36, 96, 406, 500, 60, 56, 324, 48, 500, 500, 500, 44, 144, 500, 118, 500, 500, 68, 500, 500, 142, 66, 500, 30, 500, 500, 500, 58, 500, 140, 76, 224, 48, 500, 66, 58, 500, 500, 324, 200, 124, 66, 64, 78, 36, 78]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37662091759995364, "mean_inference_ms": 1.211083000958284, "mean_action_processing_ms": 0.1382808810096056, "mean_env_wait_ms": 0.08288556215962918, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031017303466796875, "StateBufferConnector_ms": 0.005998134613037109, "ViewRequirementAgentConnector_ms": 0.1340336799621582}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.627999999999847, "episode_len_mean": 234.42, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [38.50000000000003, 36.900000000000034, 39.50000000000002, -50.00000000000044, 45.7, 44.300000000000004, 42.10000000000001, 39.50000000000002, -50.00000000000044, 5.499999999999638, 31.1, -50.00000000000044, 42.10000000000001, 7.09999999999966, 41.70000000000002, 46.5, 42.70000000000001, 45.9, 42.70000000000001, 46.3, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 38.700000000000024, 45.3, 37.50000000000003, 31.300000000000004, 46.3, 44.10000000000001, 36.900000000000034, 30.499999999999993, -50.00000000000044, 45.3, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 3.0999999999996035, 44.10000000000001, 43.7, 45.9, 46.099999999999994, 44.5, 44.7, -50.00000000000044, 6.099999999999646, 23.699999999999896, 45.1, 41.90000000000001, 21.499999999999865, 46.5, 40.500000000000014, 9.499999999999694, -50.00000000000044, 44.10000000000001, 44.5, 17.69999999999981, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 35.70000000000003, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 35.900000000000034, 43.50000000000001, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 36.10000000000004, 42.500000000000014, 27.699999999999953, 45.3, -50.00000000000044, 43.50000000000001, 44.300000000000004, -50.00000000000044, -50.00000000000044, 17.69999999999981, 30.099999999999987, 37.70000000000003, 43.50000000000001, 43.7, 42.30000000000001, 46.5, 42.30000000000001], "episode_lengths": [116, 132, 106, 500, 44, 58, 80, 106, 500, 446, 190, 500, 80, 430, 84, 36, 74, 42, 74, 38, 500, 48, 500, 500, 114, 48, 126, 188, 38, 60, 132, 196, 500, 48, 60, 500, 500, 500, 500, 62, 500, 470, 60, 64, 42, 40, 56, 54, 500, 440, 264, 50, 82, 286, 36, 96, 406, 500, 60, 56, 324, 48, 500, 500, 500, 44, 144, 500, 118, 500, 500, 68, 500, 500, 142, 66, 500, 30, 500, 500, 500, 58, 500, 140, 76, 224, 48, 500, 66, 58, 500, 500, 324, 200, 124, 66, 64, 78, 36, 78]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37662091759995364, "mean_inference_ms": 1.211083000958284, "mean_action_processing_ms": 0.1382808810096056, "mean_env_wait_ms": 0.08288556215962918, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031017303466796875, "StateBufferConnector_ms": 0.005998134613037109, "ViewRequirementAgentConnector_ms": 0.1340336799621582}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5402.989721022492, "num_env_steps_trained_throughput_per_sec": 5402.989721022492, "timesteps_total": 648000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 648000, "timers": {"training_iteration_time_ms": 2179.602, "sample_time_ms": 1930.474, "load_time_ms": 13.052, "load_throughput": 919405.301, "learn_time_ms": 225.308, "learn_throughput": 53260.406, "synch_weights_time_ms": 9.366}, "counters": {"num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000}, "done": false, "episodes_total": 2429, "training_iteration": 54, "trial_id": "9f288_00016", "date": "2023-10-25_16-53-32", "timestamp": 1698249212, "time_this_iter_s": 2.2267158031463623, "time_total_s": 117.96577382087708, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 117.96577382087708, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 60.800000000000004, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1102230246251568e-17, "cur_lr": 0.0003, "total_loss": 6.721832752227783, "policy_loss": -0.00023874216195609834, "vf_loss": 6.722123013602363, "vf_explained_var": -4.0729840596516925e-07, "kl": 0.000330141646143842, "entropy": 0.5168626374668546, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 981.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_agent_steps_sampled": 660000, "num_agent_steps_trained": 660000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.0759999999998255, "episode_len_mean": 259.88, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.099999999999994, 44.5, 44.7, -50.00000000000044, 6.099999999999646, 23.699999999999896, 45.1, 41.90000000000001, 21.499999999999865, 46.5, 40.500000000000014, 9.499999999999694, -50.00000000000044, 44.10000000000001, 44.5, 17.69999999999981, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 35.70000000000003, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 35.900000000000034, 43.50000000000001, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 36.10000000000004, 42.500000000000014, 27.699999999999953, 45.3, -50.00000000000044, 43.50000000000001, 44.300000000000004, -50.00000000000044, -50.00000000000044, 17.69999999999981, 30.099999999999987, 37.70000000000003, 43.50000000000001, 43.7, 42.30000000000001, 46.5, 42.30000000000001, 30.699999999999996, 46.3, -50.00000000000044, 46.5, 45.5, 29.899999999999984, 46.3, -50.00000000000044, 42.900000000000006, -50.00000000000044, 3.2999999999996064, 45.9, -50.00000000000044, 38.10000000000002, 45.7, -50.00000000000044, 45.7, -50.00000000000044, 39.90000000000002, -50.00000000000044, 31.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 32.30000000000002, 40.90000000000002, -50.00000000000044, 36.10000000000004, -50.00000000000044, 17.899999999999814, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 33.10000000000003, 36.10000000000004, 40.70000000000002, 42.500000000000014, 16.499999999999794, -50.00000000000044, 41.70000000000002, -50.00000000000044, 42.10000000000001], "episode_lengths": [40, 56, 54, 500, 440, 264, 50, 82, 286, 36, 96, 406, 500, 60, 56, 324, 48, 500, 500, 500, 44, 144, 500, 118, 500, 500, 68, 500, 500, 142, 66, 500, 30, 500, 500, 500, 58, 500, 140, 76, 224, 48, 500, 66, 58, 500, 500, 324, 200, 124, 66, 64, 78, 36, 78, 194, 38, 500, 36, 46, 202, 38, 500, 72, 500, 468, 42, 500, 120, 44, 500, 44, 500, 102, 500, 188, 500, 500, 500, 42, 178, 92, 500, 140, 500, 322, 500, 500, 500, 500, 50, 170, 140, 94, 76, 336, 500, 84, 500, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3768184014875375, "mean_inference_ms": 1.2109304767160134, "mean_action_processing_ms": 0.13812367886642776, "mean_env_wait_ms": 0.0827462445390593, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026009798049926758, "StateBufferConnector_ms": 0.0049974918365478516, "ViewRequirementAgentConnector_ms": 0.11100316047668457}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.0759999999998255, "episode_len_mean": 259.88, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.099999999999994, 44.5, 44.7, -50.00000000000044, 6.099999999999646, 23.699999999999896, 45.1, 41.90000000000001, 21.499999999999865, 46.5, 40.500000000000014, 9.499999999999694, -50.00000000000044, 44.10000000000001, 44.5, 17.69999999999981, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 35.70000000000003, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 35.900000000000034, 43.50000000000001, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 36.10000000000004, 42.500000000000014, 27.699999999999953, 45.3, -50.00000000000044, 43.50000000000001, 44.300000000000004, -50.00000000000044, -50.00000000000044, 17.69999999999981, 30.099999999999987, 37.70000000000003, 43.50000000000001, 43.7, 42.30000000000001, 46.5, 42.30000000000001, 30.699999999999996, 46.3, -50.00000000000044, 46.5, 45.5, 29.899999999999984, 46.3, -50.00000000000044, 42.900000000000006, -50.00000000000044, 3.2999999999996064, 45.9, -50.00000000000044, 38.10000000000002, 45.7, -50.00000000000044, 45.7, -50.00000000000044, 39.90000000000002, -50.00000000000044, 31.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 32.30000000000002, 40.90000000000002, -50.00000000000044, 36.10000000000004, -50.00000000000044, 17.899999999999814, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 33.10000000000003, 36.10000000000004, 40.70000000000002, 42.500000000000014, 16.499999999999794, -50.00000000000044, 41.70000000000002, -50.00000000000044, 42.10000000000001], "episode_lengths": [40, 56, 54, 500, 440, 264, 50, 82, 286, 36, 96, 406, 500, 60, 56, 324, 48, 500, 500, 500, 44, 144, 500, 118, 500, 500, 68, 500, 500, 142, 66, 500, 30, 500, 500, 500, 58, 500, 140, 76, 224, 48, 500, 66, 58, 500, 500, 324, 200, 124, 66, 64, 78, 36, 78, 194, 38, 500, 36, 46, 202, 38, 500, 72, 500, 468, 42, 500, 120, 44, 500, 44, 500, 102, 500, 188, 500, 500, 500, 42, 178, 92, 500, 140, 500, 322, 500, 500, 500, 500, 50, 170, 140, 94, 76, 336, 500, 84, 500, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3768184014875375, "mean_inference_ms": 1.2109304767160134, "mean_action_processing_ms": 0.13812367886642776, "mean_env_wait_ms": 0.0827462445390593, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026009798049926758, "StateBufferConnector_ms": 0.0049974918365478516, "ViewRequirementAgentConnector_ms": 0.11100316047668457}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 660000, "num_agent_steps_trained": 660000, "num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5772.845894606402, "num_env_steps_trained_throughput_per_sec": 5772.845894606402, "timesteps_total": 660000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 660000, "timers": {"training_iteration_time_ms": 2165.907, "sample_time_ms": 1930.823, "load_time_ms": 12.176, "load_throughput": 985552.003, "learn_time_ms": 212.161, "learn_throughput": 56560.898, "synch_weights_time_ms": 9.246}, "counters": {"num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_agent_steps_sampled": 660000, "num_agent_steps_trained": 660000}, "done": false, "episodes_total": 2474, "training_iteration": 55, "trial_id": "9f288_00016", "date": "2023-10-25_16-53-34", "timestamp": 1698249214, "time_this_iter_s": 2.083693027496338, "time_total_s": 120.04946684837341, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 120.04946684837341, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 58.300000000000004, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.551115123125784e-18, "cur_lr": 0.0003, "total_loss": 6.451376994450887, "policy_loss": -7.53253698348999e-05, "vf_loss": 6.451507568359375, "vf_explained_var": -6.159146626790365e-07, "kl": 0.00043848146078239044, "entropy": 0.5519737203915914, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 999.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.264999999999846, "episode_len_mean": 243.02, "episode_media": {}, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [37.70000000000003, 43.50000000000001, 43.7, 42.30000000000001, 46.5, 42.30000000000001, 30.699999999999996, 46.3, -50.00000000000044, 46.5, 45.5, 29.899999999999984, 46.3, -50.00000000000044, 42.900000000000006, -50.00000000000044, 3.2999999999996064, 45.9, -50.00000000000044, 38.10000000000002, 45.7, -50.00000000000044, 45.7, -50.00000000000044, 39.90000000000002, -50.00000000000044, 31.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 32.30000000000002, 40.90000000000002, -50.00000000000044, 36.10000000000004, -50.00000000000044, 17.899999999999814, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 33.10000000000003, 36.10000000000004, 40.70000000000002, 42.500000000000014, 16.499999999999794, -50.00000000000044, 41.70000000000002, -50.00000000000044, 42.10000000000001, 36.70000000000003, -50.00000000000044, 39.70000000000002, 28.699999999999967, 46.3, -50.00000000000044, 40.500000000000014, 15.699999999999783, -50.00000000000044, 36.70000000000003, 38.300000000000026, 42.70000000000001, -50.00000000000044, -50.00000000000044, 42.30000000000001, 47.3, 46.699999999999996, -50.00000000000044, 18.499999999999822, 46.099999999999994, -50.00000000000044, 38.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, 36.50000000000003, -50.00000000000044, 42.900000000000006, 43.10000000000001, 41.30000000000001, 2.8999999999996007, 44.900000000000006, -50.00000000000044, 35.900000000000034, 46.5, 46.699999999999996, 43.7, 43.900000000000006, -50.00000000000044, 30.499999999999993, 46.9, -50.00000000000044, -50.00000000000044, 40.500000000000014, 46.5, 29.099999999999973, 41.90000000000001, 44.7], "episode_lengths": [124, 66, 64, 78, 36, 78, 194, 38, 500, 36, 46, 202, 38, 500, 72, 500, 468, 42, 500, 120, 44, 500, 44, 500, 102, 500, 188, 500, 500, 500, 42, 178, 92, 500, 140, 500, 322, 500, 500, 500, 500, 50, 170, 140, 94, 76, 336, 500, 84, 500, 80, 134, 500, 104, 214, 38, 500, 96, 344, 500, 134, 118, 74, 500, 500, 78, 28, 34, 500, 316, 40, 500, 120, 500, 500, 500, 112, 136, 500, 72, 70, 88, 472, 52, 500, 142, 36, 34, 64, 62, 500, 196, 32, 500, 500, 96, 36, 210, 82, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3767821320175996, "mean_inference_ms": 1.2110818887053412, "mean_action_processing_ms": 0.13831971559636003, "mean_env_wait_ms": 0.08291840156896507, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018065214157104492, "StateBufferConnector_ms": 0.006999015808105469, "ViewRequirementAgentConnector_ms": 0.11192893981933594}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.264999999999846, "episode_len_mean": 243.02, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [37.70000000000003, 43.50000000000001, 43.7, 42.30000000000001, 46.5, 42.30000000000001, 30.699999999999996, 46.3, -50.00000000000044, 46.5, 45.5, 29.899999999999984, 46.3, -50.00000000000044, 42.900000000000006, -50.00000000000044, 3.2999999999996064, 45.9, -50.00000000000044, 38.10000000000002, 45.7, -50.00000000000044, 45.7, -50.00000000000044, 39.90000000000002, -50.00000000000044, 31.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 32.30000000000002, 40.90000000000002, -50.00000000000044, 36.10000000000004, -50.00000000000044, 17.899999999999814, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 33.10000000000003, 36.10000000000004, 40.70000000000002, 42.500000000000014, 16.499999999999794, -50.00000000000044, 41.70000000000002, -50.00000000000044, 42.10000000000001, 36.70000000000003, -50.00000000000044, 39.70000000000002, 28.699999999999967, 46.3, -50.00000000000044, 40.500000000000014, 15.699999999999783, -50.00000000000044, 36.70000000000003, 38.300000000000026, 42.70000000000001, -50.00000000000044, -50.00000000000044, 42.30000000000001, 47.3, 46.699999999999996, -50.00000000000044, 18.499999999999822, 46.099999999999994, -50.00000000000044, 38.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, 36.50000000000003, -50.00000000000044, 42.900000000000006, 43.10000000000001, 41.30000000000001, 2.8999999999996007, 44.900000000000006, -50.00000000000044, 35.900000000000034, 46.5, 46.699999999999996, 43.7, 43.900000000000006, -50.00000000000044, 30.499999999999993, 46.9, -50.00000000000044, -50.00000000000044, 40.500000000000014, 46.5, 29.099999999999973, 41.90000000000001, 44.7], "episode_lengths": [124, 66, 64, 78, 36, 78, 194, 38, 500, 36, 46, 202, 38, 500, 72, 500, 468, 42, 500, 120, 44, 500, 44, 500, 102, 500, 188, 500, 500, 500, 42, 178, 92, 500, 140, 500, 322, 500, 500, 500, 500, 50, 170, 140, 94, 76, 336, 500, 84, 500, 80, 134, 500, 104, 214, 38, 500, 96, 344, 500, 134, 118, 74, 500, 500, 78, 28, 34, 500, 316, 40, 500, 120, 500, 500, 500, 112, 136, 500, 72, 70, 88, 472, 52, 500, 142, 36, 34, 64, 62, 500, 196, 32, 500, 500, 96, 36, 210, 82, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3767821320175996, "mean_inference_ms": 1.2110818887053412, "mean_action_processing_ms": 0.13831971559636003, "mean_env_wait_ms": 0.08291840156896507, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018065214157104492, "StateBufferConnector_ms": 0.006999015808105469, "ViewRequirementAgentConnector_ms": 0.11192893981933594}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000, "num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5328.096239226123, "num_env_steps_trained_throughput_per_sec": 5328.096239226123, "timesteps_total": 672000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 672000, "timers": {"training_iteration_time_ms": 2187.969, "sample_time_ms": 1931.617, "load_time_ms": 13.048, "load_throughput": 919652.25, "learn_time_ms": 232.509, "learn_throughput": 51610.965, "synch_weights_time_ms": 9.293}, "counters": {"num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "done": false, "episodes_total": 2523, "training_iteration": 56, "trial_id": "9f288_00016", "date": "2023-10-25_16-53-36", "timestamp": 1698249216, "time_this_iter_s": 2.2572100162506104, "time_total_s": 122.30667686462402, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 122.30667686462402, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 61.4, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.775557561562892e-18, "cur_lr": 0.0003, "total_loss": 7.240932120217217, "policy_loss": -0.0004538032743665907, "vf_loss": 7.241443289650811, "vf_explained_var": -1.5232298109266492e-07, "kl": 0.0007376205406678259, "entropy": 0.5728244334459305, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1017.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.646999999999853, "episode_len_mean": 239.22, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 39.70000000000002, 28.699999999999967, 46.3, -50.00000000000044, 40.500000000000014, 15.699999999999783, -50.00000000000044, 36.70000000000003, 38.300000000000026, 42.70000000000001, -50.00000000000044, -50.00000000000044, 42.30000000000001, 47.3, 46.699999999999996, -50.00000000000044, 18.499999999999822, 46.099999999999994, -50.00000000000044, 38.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, 36.50000000000003, -50.00000000000044, 42.900000000000006, 43.10000000000001, 41.30000000000001, 2.8999999999996007, 44.900000000000006, -50.00000000000044, 35.900000000000034, 46.5, 46.699999999999996, 43.7, 43.900000000000006, -50.00000000000044, 30.499999999999993, 46.9, -50.00000000000044, -50.00000000000044, 40.500000000000014, 46.5, 29.099999999999973, 41.90000000000001, 44.7, -50.00000000000044, -50.00000000000044, 38.10000000000002, 42.500000000000014, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 46.3, 44.300000000000004, 34.70000000000004, 43.50000000000001, 28.699999999999967, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.900000000000034, 34.30000000000004, -50.00000000000044, 41.90000000000001, 28.499999999999964, -50.00000000000044, 45.1, 17.899999999999814, 38.50000000000003, 31.300000000000004, 7.899999999999672, -50.00000000000044, 41.70000000000002, 44.10000000000001, -50.00000000000044, 44.7, 35.10000000000004, 34.30000000000004, 17.099999999999802, 40.90000000000002, -50.00000000000044, 39.70000000000002, -50.00000000000044, 33.70000000000004, 38.90000000000002, 42.70000000000001, 46.9, 28.29999999999996, 44.300000000000004, 42.70000000000001, 45.3, 29.49999999999998, 41.100000000000016, -50.00000000000044, 42.70000000000001], "episode_lengths": [500, 104, 214, 38, 500, 96, 344, 500, 134, 118, 74, 500, 500, 78, 28, 34, 500, 316, 40, 500, 120, 500, 500, 500, 112, 136, 500, 72, 70, 88, 472, 52, 500, 142, 36, 34, 64, 62, 500, 196, 32, 500, 500, 96, 36, 210, 82, 54, 500, 500, 120, 76, 500, 500, 44, 500, 38, 58, 154, 66, 214, 500, 500, 500, 500, 132, 158, 500, 82, 216, 500, 50, 322, 116, 188, 422, 500, 84, 60, 500, 54, 150, 158, 330, 92, 500, 104, 500, 164, 112, 74, 32, 218, 58, 74, 48, 206, 90, 500, 74]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.376538186428389, "mean_inference_ms": 1.2108257284529862, "mean_action_processing_ms": 0.13840477429741702, "mean_env_wait_ms": 0.083419931489684, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02806878089904785, "StateBufferConnector_ms": 0.005998134613037109, "ViewRequirementAgentConnector_ms": 0.1369936466217041}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.646999999999853, "episode_len_mean": 239.22, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 39.70000000000002, 28.699999999999967, 46.3, -50.00000000000044, 40.500000000000014, 15.699999999999783, -50.00000000000044, 36.70000000000003, 38.300000000000026, 42.70000000000001, -50.00000000000044, -50.00000000000044, 42.30000000000001, 47.3, 46.699999999999996, -50.00000000000044, 18.499999999999822, 46.099999999999994, -50.00000000000044, 38.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, 36.50000000000003, -50.00000000000044, 42.900000000000006, 43.10000000000001, 41.30000000000001, 2.8999999999996007, 44.900000000000006, -50.00000000000044, 35.900000000000034, 46.5, 46.699999999999996, 43.7, 43.900000000000006, -50.00000000000044, 30.499999999999993, 46.9, -50.00000000000044, -50.00000000000044, 40.500000000000014, 46.5, 29.099999999999973, 41.90000000000001, 44.7, -50.00000000000044, -50.00000000000044, 38.10000000000002, 42.500000000000014, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 46.3, 44.300000000000004, 34.70000000000004, 43.50000000000001, 28.699999999999967, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.900000000000034, 34.30000000000004, -50.00000000000044, 41.90000000000001, 28.499999999999964, -50.00000000000044, 45.1, 17.899999999999814, 38.50000000000003, 31.300000000000004, 7.899999999999672, -50.00000000000044, 41.70000000000002, 44.10000000000001, -50.00000000000044, 44.7, 35.10000000000004, 34.30000000000004, 17.099999999999802, 40.90000000000002, -50.00000000000044, 39.70000000000002, -50.00000000000044, 33.70000000000004, 38.90000000000002, 42.70000000000001, 46.9, 28.29999999999996, 44.300000000000004, 42.70000000000001, 45.3, 29.49999999999998, 41.100000000000016, -50.00000000000044, 42.70000000000001], "episode_lengths": [500, 104, 214, 38, 500, 96, 344, 500, 134, 118, 74, 500, 500, 78, 28, 34, 500, 316, 40, 500, 120, 500, 500, 500, 112, 136, 500, 72, 70, 88, 472, 52, 500, 142, 36, 34, 64, 62, 500, 196, 32, 500, 500, 96, 36, 210, 82, 54, 500, 500, 120, 76, 500, 500, 44, 500, 38, 58, 154, 66, 214, 500, 500, 500, 500, 132, 158, 500, 82, 216, 500, 50, 322, 116, 188, 422, 500, 84, 60, 500, 54, 150, 158, 330, 92, 500, 104, 500, 164, 112, 74, 32, 218, 58, 74, 48, 206, 90, 500, 74]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.376538186428389, "mean_inference_ms": 1.2108257284529862, "mean_action_processing_ms": 0.13840477429741702, "mean_env_wait_ms": 0.083419931489684, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02806878089904785, "StateBufferConnector_ms": 0.005998134613037109, "ViewRequirementAgentConnector_ms": 0.1369936466217041}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000, "num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5647.5828452405385, "num_env_steps_trained_throughput_per_sec": 5647.5828452405385, "timesteps_total": 684000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 684000, "timers": {"training_iteration_time_ms": 2188.97, "sample_time_ms": 1932.575, "load_time_ms": 13.173, "load_throughput": 910923.997, "learn_time_ms": 232.527, "learn_throughput": 51606.816, "synch_weights_time_ms": 9.293}, "counters": {"num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000}, "done": false, "episodes_total": 2575, "training_iteration": 57, "trial_id": "9f288_00016", "date": "2023-10-25_16-53-38", "timestamp": 1698249218, "time_this_iter_s": 2.130800485610962, "time_total_s": 124.43747735023499, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 124.43747735023499, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 55.833333333333336, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.387778780781446e-18, "cur_lr": 0.0003, "total_loss": 6.742764234542847, "policy_loss": -0.0002476970354715983, "vf_loss": 6.743069887161255, "vf_explained_var": -1.0596381293402778e-06, "kl": 0.00041441350920952874, "entropy": 0.5800263583660126, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1035.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.44099999999986, "episode_len_mean": 241.3, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.7, -50.00000000000044, -50.00000000000044, 38.10000000000002, 42.500000000000014, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 46.3, 44.300000000000004, 34.70000000000004, 43.50000000000001, 28.699999999999967, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.900000000000034, 34.30000000000004, -50.00000000000044, 41.90000000000001, 28.499999999999964, -50.00000000000044, 45.1, 17.899999999999814, 38.50000000000003, 31.300000000000004, 7.899999999999672, -50.00000000000044, 41.70000000000002, 44.10000000000001, -50.00000000000044, 44.7, 35.10000000000004, 34.30000000000004, 17.099999999999802, 40.90000000000002, -50.00000000000044, 39.70000000000002, -50.00000000000044, 33.70000000000004, 38.90000000000002, 42.70000000000001, 46.9, 28.29999999999996, 44.300000000000004, 42.70000000000001, 45.3, 29.49999999999998, 41.100000000000016, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 26.69999999999994, 42.30000000000001, 42.70000000000001, -50.00000000000044, 40.10000000000002, 17.499999999999808, -50.00000000000044, 33.10000000000003, 44.7, 43.7, 33.30000000000003, 44.7, 42.70000000000001, 45.5, 39.70000000000002, 15.899999999999785, -50.00000000000044, 42.500000000000014, 27.299999999999947, -50.00000000000044, 42.30000000000001, 34.70000000000004, 10.699999999999712, 26.299999999999933, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 22.299999999999876, -50.00000000000044, 46.699999999999996, 37.90000000000003, 34.50000000000004, -50.00000000000044, 41.90000000000001, 46.5, 36.70000000000003, 14.499999999999766, -50.00000000000044, 43.50000000000001, -50.00000000000044, 40.70000000000002, 31.500000000000007, 35.500000000000036, 41.30000000000001], "episode_lengths": [54, 500, 500, 120, 76, 500, 500, 44, 500, 38, 58, 154, 66, 214, 500, 500, 500, 500, 132, 158, 500, 82, 216, 500, 50, 322, 116, 188, 422, 500, 84, 60, 500, 54, 150, 158, 330, 92, 500, 104, 500, 164, 112, 74, 32, 218, 58, 74, 48, 206, 90, 500, 74, 500, 500, 234, 78, 74, 500, 100, 326, 500, 170, 54, 64, 168, 54, 74, 46, 104, 342, 500, 76, 228, 500, 78, 154, 394, 238, 104, 500, 500, 500, 278, 500, 34, 122, 156, 500, 82, 36, 134, 356, 500, 66, 500, 94, 186, 146, 88]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3767509036869198, "mean_inference_ms": 1.210920015837044, "mean_action_processing_ms": 0.13836557680279463, "mean_env_wait_ms": 0.08333981420699617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03702592849731445, "StateBufferConnector_ms": 0.007989645004272461, "ViewRequirementAgentConnector_ms": 0.11801648139953613}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.44099999999986, "episode_len_mean": 241.3, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.7, -50.00000000000044, -50.00000000000044, 38.10000000000002, 42.500000000000014, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 46.3, 44.300000000000004, 34.70000000000004, 43.50000000000001, 28.699999999999967, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.900000000000034, 34.30000000000004, -50.00000000000044, 41.90000000000001, 28.499999999999964, -50.00000000000044, 45.1, 17.899999999999814, 38.50000000000003, 31.300000000000004, 7.899999999999672, -50.00000000000044, 41.70000000000002, 44.10000000000001, -50.00000000000044, 44.7, 35.10000000000004, 34.30000000000004, 17.099999999999802, 40.90000000000002, -50.00000000000044, 39.70000000000002, -50.00000000000044, 33.70000000000004, 38.90000000000002, 42.70000000000001, 46.9, 28.29999999999996, 44.300000000000004, 42.70000000000001, 45.3, 29.49999999999998, 41.100000000000016, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 26.69999999999994, 42.30000000000001, 42.70000000000001, -50.00000000000044, 40.10000000000002, 17.499999999999808, -50.00000000000044, 33.10000000000003, 44.7, 43.7, 33.30000000000003, 44.7, 42.70000000000001, 45.5, 39.70000000000002, 15.899999999999785, -50.00000000000044, 42.500000000000014, 27.299999999999947, -50.00000000000044, 42.30000000000001, 34.70000000000004, 10.699999999999712, 26.299999999999933, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 22.299999999999876, -50.00000000000044, 46.699999999999996, 37.90000000000003, 34.50000000000004, -50.00000000000044, 41.90000000000001, 46.5, 36.70000000000003, 14.499999999999766, -50.00000000000044, 43.50000000000001, -50.00000000000044, 40.70000000000002, 31.500000000000007, 35.500000000000036, 41.30000000000001], "episode_lengths": [54, 500, 500, 120, 76, 500, 500, 44, 500, 38, 58, 154, 66, 214, 500, 500, 500, 500, 132, 158, 500, 82, 216, 500, 50, 322, 116, 188, 422, 500, 84, 60, 500, 54, 150, 158, 330, 92, 500, 104, 500, 164, 112, 74, 32, 218, 58, 74, 48, 206, 90, 500, 74, 500, 500, 234, 78, 74, 500, 100, 326, 500, 170, 54, 64, 168, 54, 74, 46, 104, 342, 500, 76, 228, 500, 78, 154, 394, 238, 104, 500, 500, 500, 278, 500, 34, 122, 156, 500, 82, 36, 134, 356, 500, 66, 500, 94, 186, 146, 88]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3767509036869198, "mean_inference_ms": 1.210920015837044, "mean_action_processing_ms": 0.13836557680279463, "mean_env_wait_ms": 0.08333981420699617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03702592849731445, "StateBufferConnector_ms": 0.007989645004272461, "ViewRequirementAgentConnector_ms": 0.11801648139953613}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000, "num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5393.822180732458, "num_env_steps_trained_throughput_per_sec": 5393.822180732458, "timesteps_total": 696000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 696000, "timers": {"training_iteration_time_ms": 2188.558, "sample_time_ms": 1932.131, "load_time_ms": 12.971, "load_throughput": 925140.991, "learn_time_ms": 232.758, "learn_throughput": 51555.709, "synch_weights_time_ms": 9.196}, "counters": {"num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000}, "done": false, "episodes_total": 2622, "training_iteration": 58, "trial_id": "9f288_00016", "date": "2023-10-25_16-53-40", "timestamp": 1698249220, "time_this_iter_s": 2.2307608127593994, "time_total_s": 126.66823816299438, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 126.66823816299438, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 61.46666666666667, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.93889390390723e-19, "cur_lr": 0.0003, "total_loss": 6.603613323635525, "policy_loss": -0.0013303603563043806, "vf_loss": 6.604998217688666, "vf_explained_var": -3.940529293484158e-07, "kl": 0.0015603390512018854, "entropy": 0.5462316854132546, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1053.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_agent_steps_sampled": 708000, "num_agent_steps_trained": 708000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.46299999999986, "episode_len_mean": 241.08, "episode_media": {}, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [29.49999999999998, 41.100000000000016, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 26.69999999999994, 42.30000000000001, 42.70000000000001, -50.00000000000044, 40.10000000000002, 17.499999999999808, -50.00000000000044, 33.10000000000003, 44.7, 43.7, 33.30000000000003, 44.7, 42.70000000000001, 45.5, 39.70000000000002, 15.899999999999785, -50.00000000000044, 42.500000000000014, 27.299999999999947, -50.00000000000044, 42.30000000000001, 34.70000000000004, 10.699999999999712, 26.299999999999933, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 22.299999999999876, -50.00000000000044, 46.699999999999996, 37.90000000000003, 34.50000000000004, -50.00000000000044, 41.90000000000001, 46.5, 36.70000000000003, 14.499999999999766, -50.00000000000044, 43.50000000000001, -50.00000000000044, 40.70000000000002, 31.500000000000007, 35.500000000000036, 41.30000000000001, 28.29999999999996, 36.900000000000034, 37.70000000000003, 36.50000000000003, -50.00000000000044, -50.00000000000044, 46.5, 14.09999999999976, -50.00000000000044, 23.29999999999989, -50.00000000000044, -50.00000000000044, 45.9, 35.30000000000004, 21.89999999999987, 30.29999999999999, 28.29999999999996, 36.30000000000003, 43.30000000000001, 24.69999999999991, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 39.70000000000002, 40.10000000000002, -50.00000000000044, 42.500000000000014, 26.299999999999933, 42.10000000000001, 42.70000000000001, 39.90000000000002, 39.50000000000002, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 39.70000000000002, 44.7, 37.300000000000026, -50.00000000000044, 45.1, 45.7, 39.70000000000002, -50.00000000000044, 43.30000000000001, 44.5], "episode_lengths": [206, 90, 500, 74, 500, 500, 234, 78, 74, 500, 100, 326, 500, 170, 54, 64, 168, 54, 74, 46, 104, 342, 500, 76, 228, 500, 78, 154, 394, 238, 104, 500, 500, 500, 278, 500, 34, 122, 156, 500, 82, 36, 134, 356, 500, 66, 500, 94, 186, 146, 88, 218, 132, 124, 136, 500, 500, 36, 360, 500, 268, 500, 500, 42, 148, 282, 198, 218, 138, 68, 254, 500, 500, 500, 76, 104, 100, 500, 76, 238, 80, 74, 102, 106, 50, 500, 500, 500, 64, 500, 104, 54, 128, 500, 50, 44, 104, 500, 68, 56]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37700677928911547, "mean_inference_ms": 1.2119917510732885, "mean_action_processing_ms": 0.1384545989118356, "mean_env_wait_ms": 0.08315108717476562, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04002666473388672, "StateBufferConnector_ms": 0.0059909820556640625, "ViewRequirementAgentConnector_ms": 0.09902381896972656}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.46299999999986, "episode_len_mean": 241.08, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [29.49999999999998, 41.100000000000016, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 26.69999999999994, 42.30000000000001, 42.70000000000001, -50.00000000000044, 40.10000000000002, 17.499999999999808, -50.00000000000044, 33.10000000000003, 44.7, 43.7, 33.30000000000003, 44.7, 42.70000000000001, 45.5, 39.70000000000002, 15.899999999999785, -50.00000000000044, 42.500000000000014, 27.299999999999947, -50.00000000000044, 42.30000000000001, 34.70000000000004, 10.699999999999712, 26.299999999999933, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 22.299999999999876, -50.00000000000044, 46.699999999999996, 37.90000000000003, 34.50000000000004, -50.00000000000044, 41.90000000000001, 46.5, 36.70000000000003, 14.499999999999766, -50.00000000000044, 43.50000000000001, -50.00000000000044, 40.70000000000002, 31.500000000000007, 35.500000000000036, 41.30000000000001, 28.29999999999996, 36.900000000000034, 37.70000000000003, 36.50000000000003, -50.00000000000044, -50.00000000000044, 46.5, 14.09999999999976, -50.00000000000044, 23.29999999999989, -50.00000000000044, -50.00000000000044, 45.9, 35.30000000000004, 21.89999999999987, 30.29999999999999, 28.29999999999996, 36.30000000000003, 43.30000000000001, 24.69999999999991, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 39.70000000000002, 40.10000000000002, -50.00000000000044, 42.500000000000014, 26.299999999999933, 42.10000000000001, 42.70000000000001, 39.90000000000002, 39.50000000000002, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 39.70000000000002, 44.7, 37.300000000000026, -50.00000000000044, 45.1, 45.7, 39.70000000000002, -50.00000000000044, 43.30000000000001, 44.5], "episode_lengths": [206, 90, 500, 74, 500, 500, 234, 78, 74, 500, 100, 326, 500, 170, 54, 64, 168, 54, 74, 46, 104, 342, 500, 76, 228, 500, 78, 154, 394, 238, 104, 500, 500, 500, 278, 500, 34, 122, 156, 500, 82, 36, 134, 356, 500, 66, 500, 94, 186, 146, 88, 218, 132, 124, 136, 500, 500, 36, 360, 500, 268, 500, 500, 42, 148, 282, 198, 218, 138, 68, 254, 500, 500, 500, 76, 104, 100, 500, 76, 238, 80, 74, 102, 106, 50, 500, 500, 500, 64, 500, 104, 54, 128, 500, 50, 44, 104, 500, 68, 56]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37700677928911547, "mean_inference_ms": 1.2119917510732885, "mean_action_processing_ms": 0.1384545989118356, "mean_env_wait_ms": 0.08315108717476562, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04002666473388672, "StateBufferConnector_ms": 0.0059909820556640625, "ViewRequirementAgentConnector_ms": 0.09902381896972656}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 708000, "num_agent_steps_trained": 708000, "num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 6007.302339309924, "num_env_steps_trained_throughput_per_sec": 6007.302339309924, "timesteps_total": 708000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 708000, "timers": {"training_iteration_time_ms": 2176.62, "sample_time_ms": 1926.499, "load_time_ms": 12.771, "load_throughput": 939636.852, "learn_time_ms": 226.551, "learn_throughput": 52968.131, "synch_weights_time_ms": 9.296}, "counters": {"num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_agent_steps_sampled": 708000, "num_agent_steps_trained": 708000}, "done": false, "episodes_total": 2671, "training_iteration": 59, "trial_id": "9f288_00016", "date": "2023-10-25_16-53-42", "timestamp": 1698249222, "time_this_iter_s": 2.0025644302368164, "time_total_s": 128.6708025932312, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 128.6708025932312, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 56.86666666666667, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.469446951953615e-19, "cur_lr": 0.0003, "total_loss": 6.685527616077, "policy_loss": -0.000509293129046758, "vf_loss": 6.686091714435154, "vf_explained_var": -7.549921671549479e-07, "kl": 0.000742585191245679, "entropy": 0.5475567860735787, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1071.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "sampler_results": {"episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.786999999999832, "episode_len_mean": 257.78, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 43.50000000000001, -50.00000000000044, 40.70000000000002, 31.500000000000007, 35.500000000000036, 41.30000000000001, 28.29999999999996, 36.900000000000034, 37.70000000000003, 36.50000000000003, -50.00000000000044, -50.00000000000044, 46.5, 14.09999999999976, -50.00000000000044, 23.29999999999989, -50.00000000000044, -50.00000000000044, 45.9, 35.30000000000004, 21.89999999999987, 30.29999999999999, 28.29999999999996, 36.30000000000003, 43.30000000000001, 24.69999999999991, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 39.70000000000002, 40.10000000000002, -50.00000000000044, 42.500000000000014, 26.299999999999933, 42.10000000000001, 42.70000000000001, 39.90000000000002, 39.50000000000002, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 39.70000000000002, 44.7, 37.300000000000026, -50.00000000000044, 45.1, 45.7, 39.70000000000002, -50.00000000000044, 43.30000000000001, 44.5, -50.00000000000044, 24.499999999999908, 43.30000000000001, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 21.699999999999868, -50.00000000000044, 8.299999999999677, -50.00000000000044, 46.5, -50.00000000000044, 41.500000000000014, -50.00000000000044, 42.900000000000006, -50.00000000000044, 16.8999999999998, 42.30000000000001, 44.5, 7.299999999999663, 45.7, 40.30000000000002, -50.00000000000044, 41.70000000000002, 38.10000000000002, -50.00000000000044, 42.70000000000001, 42.70000000000001, 44.10000000000001, 44.900000000000006, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 20.899999999999856, -50.00000000000044, 41.30000000000001, 41.70000000000002, -50.00000000000044, -50.00000000000044, 46.099999999999994, 42.70000000000001], "episode_lengths": [500, 66, 500, 94, 186, 146, 88, 218, 132, 124, 136, 500, 500, 36, 360, 500, 268, 500, 500, 42, 148, 282, 198, 218, 138, 68, 254, 500, 500, 500, 76, 104, 100, 500, 76, 238, 80, 74, 102, 106, 50, 500, 500, 500, 64, 500, 104, 54, 128, 500, 50, 44, 104, 500, 68, 56, 500, 256, 68, 500, 54, 500, 500, 500, 284, 500, 418, 500, 36, 500, 86, 500, 72, 500, 332, 78, 56, 428, 44, 98, 500, 84, 120, 500, 74, 74, 60, 52, 500, 46, 500, 500, 292, 500, 88, 84, 500, 500, 40, 74]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3771359864941654, "mean_inference_ms": 1.2116507401262104, "mean_action_processing_ms": 0.1385973048691184, "mean_env_wait_ms": 0.08306628743347141, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03750920295715332, "StateBufferConnector_ms": 0.003031015396118164, "ViewRequirementAgentConnector_ms": 0.11300086975097656}}, "episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.786999999999832, "episode_len_mean": 257.78, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 43.50000000000001, -50.00000000000044, 40.70000000000002, 31.500000000000007, 35.500000000000036, 41.30000000000001, 28.29999999999996, 36.900000000000034, 37.70000000000003, 36.50000000000003, -50.00000000000044, -50.00000000000044, 46.5, 14.09999999999976, -50.00000000000044, 23.29999999999989, -50.00000000000044, -50.00000000000044, 45.9, 35.30000000000004, 21.89999999999987, 30.29999999999999, 28.29999999999996, 36.30000000000003, 43.30000000000001, 24.69999999999991, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 39.70000000000002, 40.10000000000002, -50.00000000000044, 42.500000000000014, 26.299999999999933, 42.10000000000001, 42.70000000000001, 39.90000000000002, 39.50000000000002, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 39.70000000000002, 44.7, 37.300000000000026, -50.00000000000044, 45.1, 45.7, 39.70000000000002, -50.00000000000044, 43.30000000000001, 44.5, -50.00000000000044, 24.499999999999908, 43.30000000000001, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 21.699999999999868, -50.00000000000044, 8.299999999999677, -50.00000000000044, 46.5, -50.00000000000044, 41.500000000000014, -50.00000000000044, 42.900000000000006, -50.00000000000044, 16.8999999999998, 42.30000000000001, 44.5, 7.299999999999663, 45.7, 40.30000000000002, -50.00000000000044, 41.70000000000002, 38.10000000000002, -50.00000000000044, 42.70000000000001, 42.70000000000001, 44.10000000000001, 44.900000000000006, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 20.899999999999856, -50.00000000000044, 41.30000000000001, 41.70000000000002, -50.00000000000044, -50.00000000000044, 46.099999999999994, 42.70000000000001], "episode_lengths": [500, 66, 500, 94, 186, 146, 88, 218, 132, 124, 136, 500, 500, 36, 360, 500, 268, 500, 500, 42, 148, 282, 198, 218, 138, 68, 254, 500, 500, 500, 76, 104, 100, 500, 76, 238, 80, 74, 102, 106, 50, 500, 500, 500, 64, 500, 104, 54, 128, 500, 50, 44, 104, 500, 68, 56, 500, 256, 68, 500, 54, 500, 500, 500, 284, 500, 418, 500, 36, 500, 86, 500, 72, 500, 332, 78, 56, 428, 44, 98, 500, 84, 120, 500, 74, 74, 60, 52, 500, 46, 500, 500, 292, 500, 88, 84, 500, 500, 40, 74]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3771359864941654, "mean_inference_ms": 1.2116507401262104, "mean_action_processing_ms": 0.1385973048691184, "mean_env_wait_ms": 0.08306628743347141, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03750920295715332, "StateBufferConnector_ms": 0.003031015396118164, "ViewRequirementAgentConnector_ms": 0.11300086975097656}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5596.8361619615525, "num_env_steps_trained_throughput_per_sec": 5596.8361619615525, "timesteps_total": 720000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 720000, "timers": {"training_iteration_time_ms": 2153.822, "sample_time_ms": 1924.522, "load_time_ms": 11.568, "load_throughput": 1037333.894, "learn_time_ms": 206.676, "learn_throughput": 58061.993, "synch_weights_time_ms": 9.354}, "counters": {"num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "done": false, "episodes_total": 2715, "training_iteration": 60, "trial_id": "9f288_00016", "date": "2023-10-25_16-53-45", "timestamp": 1698249225, "time_this_iter_s": 2.1490674018859863, "time_total_s": 130.8198699951172, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 130.8198699951172, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 64.53333333333333, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.7347234759768074e-19, "cur_lr": 0.0003, "total_loss": 7.467110289467706, "policy_loss": 3.7553513215647806e-05, "vf_loss": 7.467133389578925, "vf_explained_var": -1.7219119601779514e-07, "kl": 0.0001291445707352068, "entropy": 0.6054118507438235, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1089.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_agent_steps_sampled": 732000, "num_agent_steps_trained": 732000}, "sampler_results": {"episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.225999999999845, "episode_len_mean": 248.44, "episode_media": {}, "episodes_this_iter": 55, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.5, -50.00000000000044, 24.499999999999908, 43.30000000000001, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 21.699999999999868, -50.00000000000044, 8.299999999999677, -50.00000000000044, 46.5, -50.00000000000044, 41.500000000000014, -50.00000000000044, 42.900000000000006, -50.00000000000044, 16.8999999999998, 42.30000000000001, 44.5, 7.299999999999663, 45.7, 40.30000000000002, -50.00000000000044, 41.70000000000002, 38.10000000000002, -50.00000000000044, 42.70000000000001, 42.70000000000001, 44.10000000000001, 44.900000000000006, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 20.899999999999856, -50.00000000000044, 41.30000000000001, 41.70000000000002, -50.00000000000044, -50.00000000000044, 46.099999999999994, 42.70000000000001, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 36.10000000000004, 45.3, 30.099999999999987, 43.30000000000001, 32.100000000000016, -50.00000000000044, 42.30000000000001, 31.500000000000007, 6.099999999999646, -50.00000000000044, -50.00000000000044, 45.3, 35.900000000000034, -50.00000000000044, 40.30000000000002, 37.90000000000003, 41.100000000000016, 32.700000000000024, 42.500000000000014, 44.300000000000004, -50.00000000000044, 31.1, 45.1, 20.49999999999985, 44.5, 25.899999999999928, 39.70000000000002, 27.49999999999995, 45.7, 36.50000000000003, 15.899999999999785, 8.099999999999675, 43.7, 23.8999999999999, 44.10000000000001, 39.90000000000002, -50.00000000000044, 45.5, 6.499999999999652, 28.89999999999997, 43.50000000000001, 34.900000000000034, 44.5, -50.00000000000044, 36.70000000000003, 23.8999999999999, 41.100000000000016, 45.9, -50.00000000000044, 39.300000000000026, -50.00000000000044], "episode_lengths": [56, 500, 256, 68, 500, 54, 500, 500, 500, 284, 500, 418, 500, 36, 500, 86, 500, 72, 500, 332, 78, 56, 428, 44, 98, 500, 84, 120, 500, 74, 74, 60, 52, 500, 46, 500, 500, 292, 500, 88, 84, 500, 500, 40, 74, 500, 500, 44, 500, 140, 48, 200, 68, 180, 500, 78, 186, 440, 500, 500, 48, 142, 500, 98, 122, 90, 174, 76, 58, 500, 190, 50, 296, 56, 242, 104, 226, 44, 136, 342, 420, 64, 262, 60, 102, 500, 46, 436, 212, 66, 152, 56, 500, 134, 262, 90, 42, 500, 108, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3768078377793995, "mean_inference_ms": 1.211071790624285, "mean_action_processing_ms": 0.13861477447815948, "mean_env_wait_ms": 0.08300262050337935, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03333902359008789, "StateBufferConnector_ms": 0.007029533386230469, "ViewRequirementAgentConnector_ms": 0.12913107872009277}}, "episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.225999999999845, "episode_len_mean": 248.44, "episodes_this_iter": 55, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.5, -50.00000000000044, 24.499999999999908, 43.30000000000001, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 21.699999999999868, -50.00000000000044, 8.299999999999677, -50.00000000000044, 46.5, -50.00000000000044, 41.500000000000014, -50.00000000000044, 42.900000000000006, -50.00000000000044, 16.8999999999998, 42.30000000000001, 44.5, 7.299999999999663, 45.7, 40.30000000000002, -50.00000000000044, 41.70000000000002, 38.10000000000002, -50.00000000000044, 42.70000000000001, 42.70000000000001, 44.10000000000001, 44.900000000000006, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 20.899999999999856, -50.00000000000044, 41.30000000000001, 41.70000000000002, -50.00000000000044, -50.00000000000044, 46.099999999999994, 42.70000000000001, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 36.10000000000004, 45.3, 30.099999999999987, 43.30000000000001, 32.100000000000016, -50.00000000000044, 42.30000000000001, 31.500000000000007, 6.099999999999646, -50.00000000000044, -50.00000000000044, 45.3, 35.900000000000034, -50.00000000000044, 40.30000000000002, 37.90000000000003, 41.100000000000016, 32.700000000000024, 42.500000000000014, 44.300000000000004, -50.00000000000044, 31.1, 45.1, 20.49999999999985, 44.5, 25.899999999999928, 39.70000000000002, 27.49999999999995, 45.7, 36.50000000000003, 15.899999999999785, 8.099999999999675, 43.7, 23.8999999999999, 44.10000000000001, 39.90000000000002, -50.00000000000044, 45.5, 6.499999999999652, 28.89999999999997, 43.50000000000001, 34.900000000000034, 44.5, -50.00000000000044, 36.70000000000003, 23.8999999999999, 41.100000000000016, 45.9, -50.00000000000044, 39.300000000000026, -50.00000000000044], "episode_lengths": [56, 500, 256, 68, 500, 54, 500, 500, 500, 284, 500, 418, 500, 36, 500, 86, 500, 72, 500, 332, 78, 56, 428, 44, 98, 500, 84, 120, 500, 74, 74, 60, 52, 500, 46, 500, 500, 292, 500, 88, 84, 500, 500, 40, 74, 500, 500, 44, 500, 140, 48, 200, 68, 180, 500, 78, 186, 440, 500, 500, 48, 142, 500, 98, 122, 90, 174, 76, 58, 500, 190, 50, 296, 56, 242, 104, 226, 44, 136, 342, 420, 64, 262, 60, 102, 500, 46, 436, 212, 66, 152, 56, 500, 134, 262, 90, 42, 500, 108, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3768078377793995, "mean_inference_ms": 1.211071790624285, "mean_action_processing_ms": 0.13861477447815948, "mean_env_wait_ms": 0.08300262050337935, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03333902359008789, "StateBufferConnector_ms": 0.007029533386230469, "ViewRequirementAgentConnector_ms": 0.12913107872009277}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 732000, "num_agent_steps_trained": 732000, "num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5478.164899881189, "num_env_steps_trained_throughput_per_sec": 5478.164899881189, "timesteps_total": 732000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 732000, "timers": {"training_iteration_time_ms": 2156.165, "sample_time_ms": 1917.683, "load_time_ms": 12.267, "load_throughput": 978198.681, "learn_time_ms": 215.058, "learn_throughput": 55798.94, "synch_weights_time_ms": 9.455}, "counters": {"num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_agent_steps_sampled": 732000, "num_agent_steps_trained": 732000}, "done": false, "episodes_total": 2770, "training_iteration": 61, "trial_id": "9f288_00016", "date": "2023-10-25_16-53-47", "timestamp": 1698249227, "time_this_iter_s": 2.19650936126709, "time_total_s": 133.01637935638428, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 133.01637935638428, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 59.333333333333336, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.673617379884037e-20, "cur_lr": 0.0003, "total_loss": 6.036747402615017, "policy_loss": -0.00012708910637431673, "vf_loss": 6.036931991577148, "vf_explained_var": -5.099508497450087e-07, "kl": 0.0004220768409335878, "entropy": 0.574956562783983, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1107.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 744000}, "sampler_results": {"episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.3229999999998325, "episode_len_mean": 262.44, "episode_media": {}, "episodes_this_iter": 34, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.5, -50.00000000000044, -50.00000000000044, 20.899999999999856, -50.00000000000044, 41.30000000000001, 41.70000000000002, -50.00000000000044, -50.00000000000044, 46.099999999999994, 42.70000000000001, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 36.10000000000004, 45.3, 30.099999999999987, 43.30000000000001, 32.100000000000016, -50.00000000000044, 42.30000000000001, 31.500000000000007, 6.099999999999646, -50.00000000000044, -50.00000000000044, 45.3, 35.900000000000034, -50.00000000000044, 40.30000000000002, 37.90000000000003, 41.100000000000016, 32.700000000000024, 42.500000000000014, 44.300000000000004, -50.00000000000044, 31.1, 45.1, 20.49999999999985, 44.5, 25.899999999999928, 39.70000000000002, 27.49999999999995, 45.7, 36.50000000000003, 15.899999999999785, 8.099999999999675, 43.7, 23.8999999999999, 44.10000000000001, 39.90000000000002, -50.00000000000044, 45.5, 6.499999999999652, 28.89999999999997, 43.50000000000001, 34.900000000000034, 44.5, -50.00000000000044, 36.70000000000003, 23.8999999999999, 41.100000000000016, 45.9, -50.00000000000044, 39.300000000000026, -50.00000000000044, -50.00000000000044, 43.50000000000001, 39.10000000000002, 37.10000000000003, -50.00000000000044, -50.00000000000044, 1.6999999999995836, 28.29999999999996, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 44.10000000000001, 25.099999999999916, 38.700000000000024, 45.5, 43.50000000000001, -50.00000000000044, -50.00000000000044, 46.3, 27.899999999999956, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.49999999999978, 28.89999999999997, 45.7, -50.00000000000044, 37.10000000000003, -50.00000000000044, -50.00000000000044], "episode_lengths": [46, 500, 500, 292, 500, 88, 84, 500, 500, 40, 74, 500, 500, 44, 500, 140, 48, 200, 68, 180, 500, 78, 186, 440, 500, 500, 48, 142, 500, 98, 122, 90, 174, 76, 58, 500, 190, 50, 296, 56, 242, 104, 226, 44, 136, 342, 420, 64, 262, 60, 102, 500, 46, 436, 212, 66, 152, 56, 500, 134, 262, 90, 42, 500, 108, 500, 500, 66, 110, 130, 500, 500, 484, 218, 104, 500, 500, 500, 90, 60, 250, 114, 46, 66, 500, 500, 38, 222, 500, 500, 500, 500, 500, 346, 212, 44, 500, 130, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3769379657935204, "mean_inference_ms": 1.2111451517261533, "mean_action_processing_ms": 0.13836178138869445, "mean_env_wait_ms": 0.08320651133444176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031839609146118164, "StateBufferConnector_ms": 0.005000114440917969, "ViewRequirementAgentConnector_ms": 0.11812782287597656}}, "episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.3229999999998325, "episode_len_mean": 262.44, "episodes_this_iter": 34, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.5, -50.00000000000044, -50.00000000000044, 20.899999999999856, -50.00000000000044, 41.30000000000001, 41.70000000000002, -50.00000000000044, -50.00000000000044, 46.099999999999994, 42.70000000000001, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 36.10000000000004, 45.3, 30.099999999999987, 43.30000000000001, 32.100000000000016, -50.00000000000044, 42.30000000000001, 31.500000000000007, 6.099999999999646, -50.00000000000044, -50.00000000000044, 45.3, 35.900000000000034, -50.00000000000044, 40.30000000000002, 37.90000000000003, 41.100000000000016, 32.700000000000024, 42.500000000000014, 44.300000000000004, -50.00000000000044, 31.1, 45.1, 20.49999999999985, 44.5, 25.899999999999928, 39.70000000000002, 27.49999999999995, 45.7, 36.50000000000003, 15.899999999999785, 8.099999999999675, 43.7, 23.8999999999999, 44.10000000000001, 39.90000000000002, -50.00000000000044, 45.5, 6.499999999999652, 28.89999999999997, 43.50000000000001, 34.900000000000034, 44.5, -50.00000000000044, 36.70000000000003, 23.8999999999999, 41.100000000000016, 45.9, -50.00000000000044, 39.300000000000026, -50.00000000000044, -50.00000000000044, 43.50000000000001, 39.10000000000002, 37.10000000000003, -50.00000000000044, -50.00000000000044, 1.6999999999995836, 28.29999999999996, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 44.10000000000001, 25.099999999999916, 38.700000000000024, 45.5, 43.50000000000001, -50.00000000000044, -50.00000000000044, 46.3, 27.899999999999956, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.49999999999978, 28.89999999999997, 45.7, -50.00000000000044, 37.10000000000003, -50.00000000000044, -50.00000000000044], "episode_lengths": [46, 500, 500, 292, 500, 88, 84, 500, 500, 40, 74, 500, 500, 44, 500, 140, 48, 200, 68, 180, 500, 78, 186, 440, 500, 500, 48, 142, 500, 98, 122, 90, 174, 76, 58, 500, 190, 50, 296, 56, 242, 104, 226, 44, 136, 342, 420, 64, 262, 60, 102, 500, 46, 436, 212, 66, 152, 56, 500, 134, 262, 90, 42, 500, 108, 500, 500, 66, 110, 130, 500, 500, 484, 218, 104, 500, 500, 500, 90, 60, 250, 114, 46, 66, 500, 500, 38, 222, 500, 500, 500, 500, 500, 346, 212, 44, 500, 130, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3769379657935204, "mean_inference_ms": 1.2111451517261533, "mean_action_processing_ms": 0.13836178138869445, "mean_env_wait_ms": 0.08320651133444176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031839609146118164, "StateBufferConnector_ms": 0.005000114440917969, "ViewRequirementAgentConnector_ms": 0.11812782287597656}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 744000, "num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5099.05995175655, "num_env_steps_trained_throughput_per_sec": 5099.05995175655, "timesteps_total": 744000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 744000, "timers": {"training_iteration_time_ms": 2171.617, "sample_time_ms": 1931.102, "load_time_ms": 12.005, "load_throughput": 999593.82, "learn_time_ms": 217.48, "learn_throughput": 55177.55, "synch_weights_time_ms": 9.328}, "counters": {"num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 744000}, "done": false, "episodes_total": 2804, "training_iteration": 62, "trial_id": "9f288_00016", "date": "2023-10-25_16-53-49", "timestamp": 1698249229, "time_this_iter_s": 2.3583717346191406, "time_total_s": 135.37475109100342, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 135.37475109100342, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 52.025, "ram_util_percent": 27.224999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.3368086899420186e-20, "cur_lr": 0.0003, "total_loss": 6.674288749694824, "policy_loss": 6.651381651560466e-05, "vf_loss": 6.674284060796102, "vf_explained_var": -1.4901161193847656e-07, "kl": 0.00018307863283300522, "entropy": 0.6170251899295383, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1125.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000}, "sampler_results": {"episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.8550000000002115, "episode_len_mean": 304.14, "episode_media": {}, "episodes_this_iter": 35, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 31.1, 45.1, 20.49999999999985, 44.5, 25.899999999999928, 39.70000000000002, 27.49999999999995, 45.7, 36.50000000000003, 15.899999999999785, 8.099999999999675, 43.7, 23.8999999999999, 44.10000000000001, 39.90000000000002, -50.00000000000044, 45.5, 6.499999999999652, 28.89999999999997, 43.50000000000001, 34.900000000000034, 44.5, -50.00000000000044, 36.70000000000003, 23.8999999999999, 41.100000000000016, 45.9, -50.00000000000044, 39.300000000000026, -50.00000000000044, -50.00000000000044, 43.50000000000001, 39.10000000000002, 37.10000000000003, -50.00000000000044, -50.00000000000044, 1.6999999999995836, 28.29999999999996, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 44.10000000000001, 25.099999999999916, 38.700000000000024, 45.5, 43.50000000000001, -50.00000000000044, -50.00000000000044, 46.3, 27.899999999999956, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.49999999999978, 28.89999999999997, 45.7, -50.00000000000044, 37.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.50000000000003, 43.900000000000006, -50.00000000000044, -50.00000000000044, 33.10000000000003, 26.299999999999933, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 8.899999999999686, -50.00000000000044, 9.099999999999689, -50.00000000000044, 46.3, 16.699999999999797, -50.00000000000044, -50.00000000000044, -50.00000000000044, 5.899999999999643, -50.00000000000044, -50.00000000000044, 34.10000000000004, 31.1, -50.00000000000044, 42.500000000000014, -50.00000000000044, 28.499999999999964], "episode_lengths": [500, 190, 50, 296, 56, 242, 104, 226, 44, 136, 342, 420, 64, 262, 60, 102, 500, 46, 436, 212, 66, 152, 56, 500, 134, 262, 90, 42, 500, 108, 500, 500, 66, 110, 130, 500, 500, 484, 218, 104, 500, 500, 500, 90, 60, 250, 114, 46, 66, 500, 500, 38, 222, 500, 500, 500, 500, 500, 346, 212, 44, 500, 130, 500, 500, 500, 500, 500, 50, 500, 500, 500, 136, 62, 500, 500, 170, 238, 500, 500, 52, 500, 412, 500, 410, 500, 38, 334, 500, 500, 500, 442, 500, 500, 160, 190, 500, 76, 500, 216]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37696761675034723, "mean_inference_ms": 1.2110802852496907, "mean_action_processing_ms": 0.13841503063643565, "mean_env_wait_ms": 0.08329545646655934, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.034009695053100586, "StateBufferConnector_ms": 0.006012916564941406, "ViewRequirementAgentConnector_ms": 0.11455345153808594}}, "episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.8550000000002115, "episode_len_mean": 304.14, "episodes_this_iter": 35, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 31.1, 45.1, 20.49999999999985, 44.5, 25.899999999999928, 39.70000000000002, 27.49999999999995, 45.7, 36.50000000000003, 15.899999999999785, 8.099999999999675, 43.7, 23.8999999999999, 44.10000000000001, 39.90000000000002, -50.00000000000044, 45.5, 6.499999999999652, 28.89999999999997, 43.50000000000001, 34.900000000000034, 44.5, -50.00000000000044, 36.70000000000003, 23.8999999999999, 41.100000000000016, 45.9, -50.00000000000044, 39.300000000000026, -50.00000000000044, -50.00000000000044, 43.50000000000001, 39.10000000000002, 37.10000000000003, -50.00000000000044, -50.00000000000044, 1.6999999999995836, 28.29999999999996, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 44.10000000000001, 25.099999999999916, 38.700000000000024, 45.5, 43.50000000000001, -50.00000000000044, -50.00000000000044, 46.3, 27.899999999999956, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.49999999999978, 28.89999999999997, 45.7, -50.00000000000044, 37.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.50000000000003, 43.900000000000006, -50.00000000000044, -50.00000000000044, 33.10000000000003, 26.299999999999933, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 8.899999999999686, -50.00000000000044, 9.099999999999689, -50.00000000000044, 46.3, 16.699999999999797, -50.00000000000044, -50.00000000000044, -50.00000000000044, 5.899999999999643, -50.00000000000044, -50.00000000000044, 34.10000000000004, 31.1, -50.00000000000044, 42.500000000000014, -50.00000000000044, 28.499999999999964], "episode_lengths": [500, 190, 50, 296, 56, 242, 104, 226, 44, 136, 342, 420, 64, 262, 60, 102, 500, 46, 436, 212, 66, 152, 56, 500, 134, 262, 90, 42, 500, 108, 500, 500, 66, 110, 130, 500, 500, 484, 218, 104, 500, 500, 500, 90, 60, 250, 114, 46, 66, 500, 500, 38, 222, 500, 500, 500, 500, 500, 346, 212, 44, 500, 130, 500, 500, 500, 500, 500, 50, 500, 500, 500, 136, 62, 500, 500, 170, 238, 500, 500, 52, 500, 412, 500, 410, 500, 38, 334, 500, 500, 500, 442, 500, 500, 160, 190, 500, 76, 500, 216]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37696761675034723, "mean_inference_ms": 1.2110802852496907, "mean_action_processing_ms": 0.13841503063643565, "mean_env_wait_ms": 0.08329545646655934, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.034009695053100586, "StateBufferConnector_ms": 0.006012916564941406, "ViewRequirementAgentConnector_ms": 0.11455345153808594}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000, "num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5706.840807485298, "num_env_steps_trained_throughput_per_sec": 5706.840807485298, "timesteps_total": 756000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 756000, "timers": {"training_iteration_time_ms": 2168.974, "sample_time_ms": 1927.395, "load_time_ms": 12.005, "load_throughput": 999546.178, "learn_time_ms": 218.59, "learn_throughput": 54897.207, "synch_weights_time_ms": 9.381}, "counters": {"num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000}, "done": false, "episodes_total": 2839, "training_iteration": 63, "trial_id": "9f288_00016", "date": "2023-10-25_16-53-51", "timestamp": 1698249231, "time_this_iter_s": 2.1077375411987305, "time_total_s": 137.48248863220215, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 137.48248863220215, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 60.1, "ram_util_percent": 27.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.1684043449710093e-20, "cur_lr": 0.0003, "total_loss": 6.78919784228007, "policy_loss": -6.991689507332112e-05, "vf_loss": 6.789331648084852, "vf_explained_var": -3.3775965372721356e-07, "kl": 8.988901670963717e-05, "entropy": 0.6395889719327291, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1143.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "sampler_results": {"episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -3.957000000000223, "episode_len_mean": 315.12, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.100000000000016, 44.10000000000001, 25.099999999999916, 38.700000000000024, 45.5, 43.50000000000001, -50.00000000000044, -50.00000000000044, 46.3, 27.899999999999956, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.49999999999978, 28.89999999999997, 45.7, -50.00000000000044, 37.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.50000000000003, 43.900000000000006, -50.00000000000044, -50.00000000000044, 33.10000000000003, 26.299999999999933, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 8.899999999999686, -50.00000000000044, 9.099999999999689, -50.00000000000044, 46.3, 16.699999999999797, -50.00000000000044, -50.00000000000044, -50.00000000000044, 5.899999999999643, -50.00000000000044, -50.00000000000044, 34.10000000000004, 31.1, -50.00000000000044, 42.500000000000014, -50.00000000000044, 28.499999999999964, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.30000000000003, 8.699999999999683, -50.00000000000044, 40.30000000000002, 41.500000000000014, 41.30000000000001, 45.1, 40.500000000000014, -50.00000000000044, 44.300000000000004, 45.9, -50.00000000000044, 29.099999999999973, 30.499999999999993, 43.30000000000001, -50.00000000000044, 31.300000000000004, -50.00000000000044, 44.300000000000004, 21.89999999999987, 39.90000000000002, -50.00000000000044, 0.2999999999995637, -50.00000000000044, -50.00000000000044, 42.70000000000001, 13.899999999999757, -50.00000000000044, -50.00000000000044, 35.900000000000034, 27.099999999999945, 28.499999999999964, 33.30000000000003, 44.7, -50.00000000000044, -50.00000000000044, 38.10000000000002, 39.90000000000002, 38.700000000000024, 37.70000000000003], "episode_lengths": [90, 60, 250, 114, 46, 66, 500, 500, 38, 222, 500, 500, 500, 500, 500, 346, 212, 44, 500, 130, 500, 500, 500, 500, 500, 50, 500, 500, 500, 136, 62, 500, 500, 170, 238, 500, 500, 52, 500, 412, 500, 410, 500, 38, 334, 500, 500, 500, 442, 500, 500, 160, 190, 500, 76, 500, 216, 500, 500, 500, 168, 414, 500, 98, 86, 88, 50, 96, 500, 58, 42, 500, 210, 196, 68, 500, 188, 500, 58, 282, 102, 500, 498, 500, 500, 74, 362, 500, 500, 142, 230, 216, 168, 54, 500, 500, 120, 102, 114, 124]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.377379299068185, "mean_inference_ms": 1.2109836928997664, "mean_action_processing_ms": 0.13862713672790344, "mean_env_wait_ms": 0.08321491637926187, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03200840950012207, "StateBufferConnector_ms": 0.004011392593383789, "ViewRequirementAgentConnector_ms": 0.11452341079711914}}, "episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -3.957000000000223, "episode_len_mean": 315.12, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [41.100000000000016, 44.10000000000001, 25.099999999999916, 38.700000000000024, 45.5, 43.50000000000001, -50.00000000000044, -50.00000000000044, 46.3, 27.899999999999956, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.49999999999978, 28.89999999999997, 45.7, -50.00000000000044, 37.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.50000000000003, 43.900000000000006, -50.00000000000044, -50.00000000000044, 33.10000000000003, 26.299999999999933, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 8.899999999999686, -50.00000000000044, 9.099999999999689, -50.00000000000044, 46.3, 16.699999999999797, -50.00000000000044, -50.00000000000044, -50.00000000000044, 5.899999999999643, -50.00000000000044, -50.00000000000044, 34.10000000000004, 31.1, -50.00000000000044, 42.500000000000014, -50.00000000000044, 28.499999999999964, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.30000000000003, 8.699999999999683, -50.00000000000044, 40.30000000000002, 41.500000000000014, 41.30000000000001, 45.1, 40.500000000000014, -50.00000000000044, 44.300000000000004, 45.9, -50.00000000000044, 29.099999999999973, 30.499999999999993, 43.30000000000001, -50.00000000000044, 31.300000000000004, -50.00000000000044, 44.300000000000004, 21.89999999999987, 39.90000000000002, -50.00000000000044, 0.2999999999995637, -50.00000000000044, -50.00000000000044, 42.70000000000001, 13.899999999999757, -50.00000000000044, -50.00000000000044, 35.900000000000034, 27.099999999999945, 28.499999999999964, 33.30000000000003, 44.7, -50.00000000000044, -50.00000000000044, 38.10000000000002, 39.90000000000002, 38.700000000000024, 37.70000000000003], "episode_lengths": [90, 60, 250, 114, 46, 66, 500, 500, 38, 222, 500, 500, 500, 500, 500, 346, 212, 44, 500, 130, 500, 500, 500, 500, 500, 50, 500, 500, 500, 136, 62, 500, 500, 170, 238, 500, 500, 52, 500, 412, 500, 410, 500, 38, 334, 500, 500, 500, 442, 500, 500, 160, 190, 500, 76, 500, 216, 500, 500, 500, 168, 414, 500, 98, 86, 88, 50, 96, 500, 58, 42, 500, 210, 196, 68, 500, 188, 500, 58, 282, 102, 500, 498, 500, 500, 74, 362, 500, 500, 142, 230, 216, 168, 54, 500, 500, 120, 102, 114, 124]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.377379299068185, "mean_inference_ms": 1.2109836928997664, "mean_action_processing_ms": 0.13862713672790344, "mean_env_wait_ms": 0.08321491637926187, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03200840950012207, "StateBufferConnector_ms": 0.004011392593383789, "ViewRequirementAgentConnector_ms": 0.11452341079711914}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000, "num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5388.833178622247, "num_env_steps_trained_throughput_per_sec": 5388.833178622247, "timesteps_total": 768000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 768000, "timers": {"training_iteration_time_ms": 2169.457, "sample_time_ms": 1929.172, "load_time_ms": 12.037, "load_throughput": 996966.374, "learn_time_ms": 217.16, "learn_throughput": 55258.732, "synch_weights_time_ms": 9.487}, "counters": {"num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "done": false, "episodes_total": 2882, "training_iteration": 64, "trial_id": "9f288_00016", "date": "2023-10-25_16-53-54", "timestamp": 1698249234, "time_this_iter_s": 2.2318267822265625, "time_total_s": 139.7143154144287, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 139.7143154144287, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 61.300000000000004, "ram_util_percent": 27.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.0842021724855046e-20, "cur_lr": 0.0003, "total_loss": 7.237790240181817, "policy_loss": -0.0005804188549518585, "vf_loss": 7.2384369108412, "vf_explained_var": -4.702144198947483e-07, "kl": 0.0011083878751429034, "entropy": 0.6651696662108103, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1161.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_agent_steps_sampled": 780000, "num_agent_steps_trained": 780000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.184999999999858, "episode_len_mean": 253.88, "episode_media": {}, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [34.10000000000004, 31.1, -50.00000000000044, 42.500000000000014, -50.00000000000044, 28.499999999999964, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.30000000000003, 8.699999999999683, -50.00000000000044, 40.30000000000002, 41.500000000000014, 41.30000000000001, 45.1, 40.500000000000014, -50.00000000000044, 44.300000000000004, 45.9, -50.00000000000044, 29.099999999999973, 30.499999999999993, 43.30000000000001, -50.00000000000044, 31.300000000000004, -50.00000000000044, 44.300000000000004, 21.89999999999987, 39.90000000000002, -50.00000000000044, 0.2999999999995637, -50.00000000000044, -50.00000000000044, 42.70000000000001, 13.899999999999757, -50.00000000000044, -50.00000000000044, 35.900000000000034, 27.099999999999945, 28.499999999999964, 33.30000000000003, 44.7, -50.00000000000044, -50.00000000000044, 38.10000000000002, 39.90000000000002, 38.700000000000024, 37.70000000000003, -50.00000000000044, 33.10000000000003, 37.70000000000003, 28.499999999999964, 39.70000000000002, 14.09999999999976, -50.00000000000044, 44.7, 36.30000000000003, 27.099999999999945, 35.30000000000004, 39.90000000000002, -50.00000000000044, 46.9, -50.00000000000044, 23.499999999999893, 24.69999999999991, 42.30000000000001, -50.00000000000044, 32.90000000000003, 41.90000000000001, 39.50000000000002, -50.00000000000044, -50.00000000000044, 32.700000000000024, 23.8999999999999, 40.30000000000002, 26.09999999999993, 17.499999999999808, 31.70000000000001, -50.00000000000044, -50.00000000000044, 38.90000000000002, 30.699999999999996, 43.10000000000001, 17.099999999999802, 36.900000000000034, 39.10000000000002, 24.299999999999905, 4.899999999999629, 43.900000000000006, 39.300000000000026, 20.49999999999985, 39.70000000000002, 42.30000000000001, 42.900000000000006, 40.10000000000002, 40.70000000000002, 41.70000000000002, 23.8999999999999, -50.00000000000044], "episode_lengths": [160, 190, 500, 76, 500, 216, 500, 500, 500, 168, 414, 500, 98, 86, 88, 50, 96, 500, 58, 42, 500, 210, 196, 68, 500, 188, 500, 58, 282, 102, 500, 498, 500, 500, 74, 362, 500, 500, 142, 230, 216, 168, 54, 500, 500, 120, 102, 114, 124, 500, 170, 124, 216, 104, 360, 500, 54, 138, 230, 148, 102, 500, 32, 500, 266, 254, 78, 500, 172, 82, 106, 500, 500, 174, 262, 98, 240, 326, 184, 500, 500, 112, 194, 70, 330, 132, 110, 258, 452, 62, 108, 296, 104, 78, 72, 100, 94, 84, 262, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37759318811364095, "mean_inference_ms": 1.2109120727603562, "mean_action_processing_ms": 0.1385515079419851, "mean_env_wait_ms": 0.08318356742978855, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0270082950592041, "StateBufferConnector_ms": 0.001997709274291992, "ViewRequirementAgentConnector_ms": 0.13000869750976562}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.184999999999858, "episode_len_mean": 253.88, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [34.10000000000004, 31.1, -50.00000000000044, 42.500000000000014, -50.00000000000044, 28.499999999999964, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.30000000000003, 8.699999999999683, -50.00000000000044, 40.30000000000002, 41.500000000000014, 41.30000000000001, 45.1, 40.500000000000014, -50.00000000000044, 44.300000000000004, 45.9, -50.00000000000044, 29.099999999999973, 30.499999999999993, 43.30000000000001, -50.00000000000044, 31.300000000000004, -50.00000000000044, 44.300000000000004, 21.89999999999987, 39.90000000000002, -50.00000000000044, 0.2999999999995637, -50.00000000000044, -50.00000000000044, 42.70000000000001, 13.899999999999757, -50.00000000000044, -50.00000000000044, 35.900000000000034, 27.099999999999945, 28.499999999999964, 33.30000000000003, 44.7, -50.00000000000044, -50.00000000000044, 38.10000000000002, 39.90000000000002, 38.700000000000024, 37.70000000000003, -50.00000000000044, 33.10000000000003, 37.70000000000003, 28.499999999999964, 39.70000000000002, 14.09999999999976, -50.00000000000044, 44.7, 36.30000000000003, 27.099999999999945, 35.30000000000004, 39.90000000000002, -50.00000000000044, 46.9, -50.00000000000044, 23.499999999999893, 24.69999999999991, 42.30000000000001, -50.00000000000044, 32.90000000000003, 41.90000000000001, 39.50000000000002, -50.00000000000044, -50.00000000000044, 32.700000000000024, 23.8999999999999, 40.30000000000002, 26.09999999999993, 17.499999999999808, 31.70000000000001, -50.00000000000044, -50.00000000000044, 38.90000000000002, 30.699999999999996, 43.10000000000001, 17.099999999999802, 36.900000000000034, 39.10000000000002, 24.299999999999905, 4.899999999999629, 43.900000000000006, 39.300000000000026, 20.49999999999985, 39.70000000000002, 42.30000000000001, 42.900000000000006, 40.10000000000002, 40.70000000000002, 41.70000000000002, 23.8999999999999, -50.00000000000044], "episode_lengths": [160, 190, 500, 76, 500, 216, 500, 500, 500, 168, 414, 500, 98, 86, 88, 50, 96, 500, 58, 42, 500, 210, 196, 68, 500, 188, 500, 58, 282, 102, 500, 498, 500, 500, 74, 362, 500, 500, 142, 230, 216, 168, 54, 500, 500, 120, 102, 114, 124, 500, 170, 124, 216, 104, 360, 500, 54, 138, 230, 148, 102, 500, 32, 500, 266, 254, 78, 500, 172, 82, 106, 500, 500, 174, 262, 98, 240, 326, 184, 500, 500, 112, 194, 70, 330, 132, 110, 258, 452, 62, 108, 296, 104, 78, 72, 100, 94, 84, 262, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37759318811364095, "mean_inference_ms": 1.2109120727603562, "mean_action_processing_ms": 0.1385515079419851, "mean_env_wait_ms": 0.08318356742978855, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0270082950592041, "StateBufferConnector_ms": 0.001997709274291992, "ViewRequirementAgentConnector_ms": 0.13000869750976562}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 780000, "num_agent_steps_trained": 780000, "num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5578.530288831612, "num_env_steps_trained_throughput_per_sec": 5578.530288831612, "timesteps_total": 780000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 780000, "timers": {"training_iteration_time_ms": 2176.698, "sample_time_ms": 1933.045, "load_time_ms": 12.105, "load_throughput": 991287.824, "learn_time_ms": 220.448, "learn_throughput": 54434.584, "synch_weights_time_ms": 9.497}, "counters": {"num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_agent_steps_sampled": 780000, "num_agent_steps_trained": 780000}, "done": false, "episodes_total": 2933, "training_iteration": 65, "trial_id": "9f288_00016", "date": "2023-10-25_16-53-56", "timestamp": 1698249236, "time_this_iter_s": 2.1560943126678467, "time_total_s": 141.87040972709656, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 141.87040972709656, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 59.96666666666666, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.421010862427523e-21, "cur_lr": 0.0003, "total_loss": 6.777190102471246, "policy_loss": -0.00036598509177565575, "vf_loss": 6.7776198916965065, "vf_explained_var": -1.4371342129177517e-06, "kl": 0.0007058247873348793, "entropy": 0.6386245687802633, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1179.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 16.01299999999988, "episode_len_mean": 235.66, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.90000000000002, 38.700000000000024, 37.70000000000003, -50.00000000000044, 33.10000000000003, 37.70000000000003, 28.499999999999964, 39.70000000000002, 14.09999999999976, -50.00000000000044, 44.7, 36.30000000000003, 27.099999999999945, 35.30000000000004, 39.90000000000002, -50.00000000000044, 46.9, -50.00000000000044, 23.499999999999893, 24.69999999999991, 42.30000000000001, -50.00000000000044, 32.90000000000003, 41.90000000000001, 39.50000000000002, -50.00000000000044, -50.00000000000044, 32.700000000000024, 23.8999999999999, 40.30000000000002, 26.09999999999993, 17.499999999999808, 31.70000000000001, -50.00000000000044, -50.00000000000044, 38.90000000000002, 30.699999999999996, 43.10000000000001, 17.099999999999802, 36.900000000000034, 39.10000000000002, 24.299999999999905, 4.899999999999629, 43.900000000000006, 39.300000000000026, 20.49999999999985, 39.70000000000002, 42.30000000000001, 42.900000000000006, 40.10000000000002, 40.70000000000002, 41.70000000000002, 23.8999999999999, -50.00000000000044, 19.09999999999983, 31.70000000000001, 43.900000000000006, -50.00000000000044, 35.900000000000034, 27.299999999999947, -50.00000000000044, 15.699999999999783, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 33.10000000000003, -50.00000000000044, 44.10000000000001, 13.099999999999746, 34.900000000000034, 34.30000000000004, 42.10000000000001, 26.69999999999994, 44.7, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.10000000000004, 17.299999999999805, 45.7, 22.099999999999874, -50.00000000000044, 26.69999999999994, 29.69999999999998, 45.1, 36.900000000000034, 20.699999999999854, 24.899999999999913, 41.90000000000001, 35.10000000000004, 45.1, 27.49999999999995, -50.00000000000044, 40.500000000000014, 41.100000000000016, 14.699999999999768, 43.50000000000001, 35.500000000000036], "episode_lengths": [102, 114, 124, 500, 170, 124, 216, 104, 360, 500, 54, 138, 230, 148, 102, 500, 32, 500, 266, 254, 78, 500, 172, 82, 106, 500, 500, 174, 262, 98, 240, 326, 184, 500, 500, 112, 194, 70, 330, 132, 110, 258, 452, 62, 108, 296, 104, 78, 72, 100, 94, 84, 262, 500, 310, 184, 62, 500, 142, 228, 500, 344, 500, 500, 500, 70, 170, 500, 60, 370, 152, 158, 80, 234, 54, 42, 500, 500, 500, 150, 328, 44, 280, 500, 234, 204, 50, 132, 294, 252, 82, 150, 50, 226, 500, 96, 90, 354, 66, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37750796320658836, "mean_inference_ms": 1.2114170373660615, "mean_action_processing_ms": 0.13857491560053006, "mean_env_wait_ms": 0.08303090820411771, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022001266479492188, "StateBufferConnector_ms": 0.0009999275207519531, "ViewRequirementAgentConnector_ms": 0.13405394554138184}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 16.01299999999988, "episode_len_mean": 235.66, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [39.90000000000002, 38.700000000000024, 37.70000000000003, -50.00000000000044, 33.10000000000003, 37.70000000000003, 28.499999999999964, 39.70000000000002, 14.09999999999976, -50.00000000000044, 44.7, 36.30000000000003, 27.099999999999945, 35.30000000000004, 39.90000000000002, -50.00000000000044, 46.9, -50.00000000000044, 23.499999999999893, 24.69999999999991, 42.30000000000001, -50.00000000000044, 32.90000000000003, 41.90000000000001, 39.50000000000002, -50.00000000000044, -50.00000000000044, 32.700000000000024, 23.8999999999999, 40.30000000000002, 26.09999999999993, 17.499999999999808, 31.70000000000001, -50.00000000000044, -50.00000000000044, 38.90000000000002, 30.699999999999996, 43.10000000000001, 17.099999999999802, 36.900000000000034, 39.10000000000002, 24.299999999999905, 4.899999999999629, 43.900000000000006, 39.300000000000026, 20.49999999999985, 39.70000000000002, 42.30000000000001, 42.900000000000006, 40.10000000000002, 40.70000000000002, 41.70000000000002, 23.8999999999999, -50.00000000000044, 19.09999999999983, 31.70000000000001, 43.900000000000006, -50.00000000000044, 35.900000000000034, 27.299999999999947, -50.00000000000044, 15.699999999999783, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 33.10000000000003, -50.00000000000044, 44.10000000000001, 13.099999999999746, 34.900000000000034, 34.30000000000004, 42.10000000000001, 26.69999999999994, 44.7, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.10000000000004, 17.299999999999805, 45.7, 22.099999999999874, -50.00000000000044, 26.69999999999994, 29.69999999999998, 45.1, 36.900000000000034, 20.699999999999854, 24.899999999999913, 41.90000000000001, 35.10000000000004, 45.1, 27.49999999999995, -50.00000000000044, 40.500000000000014, 41.100000000000016, 14.699999999999768, 43.50000000000001, 35.500000000000036], "episode_lengths": [102, 114, 124, 500, 170, 124, 216, 104, 360, 500, 54, 138, 230, 148, 102, 500, 32, 500, 266, 254, 78, 500, 172, 82, 106, 500, 500, 174, 262, 98, 240, 326, 184, 500, 500, 112, 194, 70, 330, 132, 110, 258, 452, 62, 108, 296, 104, 78, 72, 100, 94, 84, 262, 500, 310, 184, 62, 500, 142, 228, 500, 344, 500, 500, 500, 70, 170, 500, 60, 370, 152, 158, 80, 234, 54, 42, 500, 500, 500, 150, 328, 44, 280, 500, 234, 204, 50, 132, 294, 252, 82, 150, 50, 226, 500, 96, 90, 354, 66, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37750796320658836, "mean_inference_ms": 1.2114170373660615, "mean_action_processing_ms": 0.13857491560053006, "mean_env_wait_ms": 0.08303090820411771, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022001266479492188, "StateBufferConnector_ms": 0.0009999275207519531, "ViewRequirementAgentConnector_ms": 0.13405394554138184}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000, "num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5503.308601511069, "num_env_steps_trained_throughput_per_sec": 5503.308601511069, "timesteps_total": 792000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 792000, "timers": {"training_iteration_time_ms": 2169.527, "sample_time_ms": 1932.233, "load_time_ms": 12.167, "load_throughput": 986243.365, "learn_time_ms": 213.954, "learn_throughput": 56086.924, "synch_weights_time_ms": 9.471}, "counters": {"num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000}, "done": false, "episodes_total": 2979, "training_iteration": 66, "trial_id": "9f288_00016", "date": "2023-10-25_16-53-58", "timestamp": 1698249238, "time_this_iter_s": 2.185504198074341, "time_total_s": 144.0559139251709, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 144.0559139251709, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 60.199999999999996, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.7105054312137616e-21, "cur_lr": 0.0003, "total_loss": 7.327190981970893, "policy_loss": -0.0005002867482188675, "vf_loss": 7.327752139833239, "vf_explained_var": -7.152557373046875e-07, "kl": 0.001334632862021105, "entropy": 0.6078137159347534, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1197.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 804000, "num_env_steps_trained": 804000, "num_agent_steps_sampled": 804000, "num_agent_steps_trained": 804000}, "sampler_results": {"episode_reward_max": 45.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.840999999999848, "episode_len_mean": 257.3, "episode_media": {}, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.70000000000002, 23.8999999999999, -50.00000000000044, 19.09999999999983, 31.70000000000001, 43.900000000000006, -50.00000000000044, 35.900000000000034, 27.299999999999947, -50.00000000000044, 15.699999999999783, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 33.10000000000003, -50.00000000000044, 44.10000000000001, 13.099999999999746, 34.900000000000034, 34.30000000000004, 42.10000000000001, 26.69999999999994, 44.7, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.10000000000004, 17.299999999999805, 45.7, 22.099999999999874, -50.00000000000044, 26.69999999999994, 29.69999999999998, 45.1, 36.900000000000034, 20.699999999999854, 24.899999999999913, 41.90000000000001, 35.10000000000004, 45.1, 27.49999999999995, -50.00000000000044, 40.500000000000014, 41.100000000000016, 14.699999999999768, 43.50000000000001, 35.500000000000036, 39.50000000000002, 30.29999999999999, 44.5, 10.699999999999712, 36.900000000000034, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 42.500000000000014, 35.900000000000034, -50.00000000000044, 35.30000000000004, 6.499999999999652, -50.00000000000044, 37.50000000000003, -50.00000000000044, 29.49999999999998, 43.10000000000001, 31.900000000000013, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 16.29999999999979, 42.70000000000001, 1.299999999999578, -50.00000000000044, 42.30000000000001, -50.00000000000044, 42.900000000000006, 40.90000000000002, 41.70000000000002, -50.00000000000044, 44.5, -50.00000000000044, 37.300000000000026, -50.00000000000044, 37.300000000000026, 37.70000000000003, -50.00000000000044, 36.30000000000003, 41.500000000000014, 29.099999999999973, 39.50000000000002, -50.00000000000044, 36.10000000000004, 38.700000000000024, 40.30000000000002], "episode_lengths": [84, 262, 500, 310, 184, 62, 500, 142, 228, 500, 344, 500, 500, 500, 70, 170, 500, 60, 370, 152, 158, 80, 234, 54, 42, 500, 500, 500, 150, 328, 44, 280, 500, 234, 204, 50, 132, 294, 252, 82, 150, 50, 226, 500, 96, 90, 354, 66, 146, 106, 198, 56, 394, 132, 500, 54, 500, 500, 58, 500, 76, 142, 500, 148, 436, 500, 126, 500, 206, 70, 182, 500, 58, 500, 500, 338, 74, 488, 500, 78, 500, 72, 92, 84, 500, 56, 500, 128, 500, 128, 124, 500, 138, 86, 210, 106, 500, 140, 114, 98]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3774729077096824, "mean_inference_ms": 1.2116306706876443, "mean_action_processing_ms": 0.13864646842106598, "mean_env_wait_ms": 0.08305067030377764, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02252960205078125, "StateBufferConnector_ms": 0.007002115249633789, "ViewRequirementAgentConnector_ms": 0.12002062797546387}}, "episode_reward_max": 45.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.840999999999848, "episode_len_mean": 257.3, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [41.70000000000002, 23.8999999999999, -50.00000000000044, 19.09999999999983, 31.70000000000001, 43.900000000000006, -50.00000000000044, 35.900000000000034, 27.299999999999947, -50.00000000000044, 15.699999999999783, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 33.10000000000003, -50.00000000000044, 44.10000000000001, 13.099999999999746, 34.900000000000034, 34.30000000000004, 42.10000000000001, 26.69999999999994, 44.7, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.10000000000004, 17.299999999999805, 45.7, 22.099999999999874, -50.00000000000044, 26.69999999999994, 29.69999999999998, 45.1, 36.900000000000034, 20.699999999999854, 24.899999999999913, 41.90000000000001, 35.10000000000004, 45.1, 27.49999999999995, -50.00000000000044, 40.500000000000014, 41.100000000000016, 14.699999999999768, 43.50000000000001, 35.500000000000036, 39.50000000000002, 30.29999999999999, 44.5, 10.699999999999712, 36.900000000000034, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 42.500000000000014, 35.900000000000034, -50.00000000000044, 35.30000000000004, 6.499999999999652, -50.00000000000044, 37.50000000000003, -50.00000000000044, 29.49999999999998, 43.10000000000001, 31.900000000000013, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 16.29999999999979, 42.70000000000001, 1.299999999999578, -50.00000000000044, 42.30000000000001, -50.00000000000044, 42.900000000000006, 40.90000000000002, 41.70000000000002, -50.00000000000044, 44.5, -50.00000000000044, 37.300000000000026, -50.00000000000044, 37.300000000000026, 37.70000000000003, -50.00000000000044, 36.30000000000003, 41.500000000000014, 29.099999999999973, 39.50000000000002, -50.00000000000044, 36.10000000000004, 38.700000000000024, 40.30000000000002], "episode_lengths": [84, 262, 500, 310, 184, 62, 500, 142, 228, 500, 344, 500, 500, 500, 70, 170, 500, 60, 370, 152, 158, 80, 234, 54, 42, 500, 500, 500, 150, 328, 44, 280, 500, 234, 204, 50, 132, 294, 252, 82, 150, 50, 226, 500, 96, 90, 354, 66, 146, 106, 198, 56, 394, 132, 500, 54, 500, 500, 58, 500, 76, 142, 500, 148, 436, 500, 126, 500, 206, 70, 182, 500, 58, 500, 500, 338, 74, 488, 500, 78, 500, 72, 92, 84, 500, 56, 500, 128, 500, 128, 124, 500, 138, 86, 210, 106, 500, 140, 114, 98]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3774729077096824, "mean_inference_ms": 1.2116306706876443, "mean_action_processing_ms": 0.13864646842106598, "mean_env_wait_ms": 0.08305067030377764, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02252960205078125, "StateBufferConnector_ms": 0.007002115249633789, "ViewRequirementAgentConnector_ms": 0.12002062797546387}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 804000, "num_agent_steps_trained": 804000, "num_env_steps_sampled": 804000, "num_env_steps_trained": 804000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5733.516736069224, "num_env_steps_trained_throughput_per_sec": 5733.516736069224, "timesteps_total": 804000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 804000, "timers": {"training_iteration_time_ms": 2166.342, "sample_time_ms": 1931.932, "load_time_ms": 12.138, "load_throughput": 988628.066, "learn_time_ms": 211.008, "learn_throughput": 56869.824, "synch_weights_time_ms": 9.454}, "counters": {"num_env_steps_sampled": 804000, "num_env_steps_trained": 804000, "num_agent_steps_sampled": 804000, "num_agent_steps_trained": 804000}, "done": false, "episodes_total": 3030, "training_iteration": 67, "trial_id": "9f288_00016", "date": "2023-10-25_16-54-00", "timestamp": 1698249240, "time_this_iter_s": 2.097952365875244, "time_total_s": 146.15386629104614, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 146.15386629104614, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 59.06666666666666, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.3552527156068808e-21, "cur_lr": 0.0003, "total_loss": 7.134512768851386, "policy_loss": -0.00013281322187847563, "vf_loss": 7.134701728820801, "vf_explained_var": -1.1589792039659287e-06, "kl": 0.0005012132078200517, "entropy": 0.5610288331906, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1215.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 816000, "num_env_steps_trained": 816000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "sampler_results": {"episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.68999999999985, "episode_len_mean": 253.8, "episode_media": {}, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.50000000000002, 30.29999999999999, 44.5, 10.699999999999712, 36.900000000000034, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 42.500000000000014, 35.900000000000034, -50.00000000000044, 35.30000000000004, 6.499999999999652, -50.00000000000044, 37.50000000000003, -50.00000000000044, 29.49999999999998, 43.10000000000001, 31.900000000000013, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 16.29999999999979, 42.70000000000001, 1.299999999999578, -50.00000000000044, 42.30000000000001, -50.00000000000044, 42.900000000000006, 40.90000000000002, 41.70000000000002, -50.00000000000044, 44.5, -50.00000000000044, 37.300000000000026, -50.00000000000044, 37.300000000000026, 37.70000000000003, -50.00000000000044, 36.30000000000003, 41.500000000000014, 29.099999999999973, 39.50000000000002, -50.00000000000044, 36.10000000000004, 38.700000000000024, 40.30000000000002, -50.00000000000044, 45.3, 34.70000000000004, 45.3, 41.30000000000001, 42.10000000000001, 34.10000000000004, 24.899999999999913, -50.00000000000044, 43.50000000000001, 32.50000000000002, -50.00000000000044, -50.00000000000044, 36.30000000000003, 42.10000000000001, -50.00000000000044, 37.70000000000003, 43.7, 42.70000000000001, 12.299999999999734, 37.300000000000026, -50.00000000000044, 44.300000000000004, -50.00000000000044, 39.70000000000002, 41.100000000000016, 39.10000000000002, 35.70000000000003, 28.699999999999967, 44.300000000000004, 46.5, -50.00000000000044, 29.099999999999973, -50.00000000000044, -50.00000000000044, 33.90000000000004, 45.3, 5.6999999999996405, 16.09999999999979, 20.49999999999985, 19.299999999999834, -50.00000000000044, 35.10000000000004, 43.10000000000001, -50.00000000000044, 22.699999999999882, 38.90000000000002, 40.30000000000002, -50.00000000000044], "episode_lengths": [106, 198, 56, 394, 132, 500, 54, 500, 500, 58, 500, 76, 142, 500, 148, 436, 500, 126, 500, 206, 70, 182, 500, 58, 500, 500, 338, 74, 488, 500, 78, 500, 72, 92, 84, 500, 56, 500, 128, 500, 128, 124, 500, 138, 86, 210, 106, 500, 140, 114, 98, 500, 48, 154, 48, 88, 80, 160, 252, 500, 66, 176, 500, 500, 138, 80, 500, 124, 64, 74, 378, 128, 500, 58, 500, 104, 90, 110, 144, 214, 58, 36, 500, 210, 500, 500, 162, 48, 444, 340, 296, 308, 500, 150, 70, 500, 274, 112, 98, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3770532675865348, "mean_inference_ms": 1.2110248458561095, "mean_action_processing_ms": 0.13859340007163784, "mean_env_wait_ms": 0.08313184910440909, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022530317306518555, "StateBufferConnector_ms": 0.008002281188964844, "ViewRequirementAgentConnector_ms": 0.1280057430267334}}, "episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.68999999999985, "episode_len_mean": 253.8, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [39.50000000000002, 30.29999999999999, 44.5, 10.699999999999712, 36.900000000000034, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 42.500000000000014, 35.900000000000034, -50.00000000000044, 35.30000000000004, 6.499999999999652, -50.00000000000044, 37.50000000000003, -50.00000000000044, 29.49999999999998, 43.10000000000001, 31.900000000000013, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 16.29999999999979, 42.70000000000001, 1.299999999999578, -50.00000000000044, 42.30000000000001, -50.00000000000044, 42.900000000000006, 40.90000000000002, 41.70000000000002, -50.00000000000044, 44.5, -50.00000000000044, 37.300000000000026, -50.00000000000044, 37.300000000000026, 37.70000000000003, -50.00000000000044, 36.30000000000003, 41.500000000000014, 29.099999999999973, 39.50000000000002, -50.00000000000044, 36.10000000000004, 38.700000000000024, 40.30000000000002, -50.00000000000044, 45.3, 34.70000000000004, 45.3, 41.30000000000001, 42.10000000000001, 34.10000000000004, 24.899999999999913, -50.00000000000044, 43.50000000000001, 32.50000000000002, -50.00000000000044, -50.00000000000044, 36.30000000000003, 42.10000000000001, -50.00000000000044, 37.70000000000003, 43.7, 42.70000000000001, 12.299999999999734, 37.300000000000026, -50.00000000000044, 44.300000000000004, -50.00000000000044, 39.70000000000002, 41.100000000000016, 39.10000000000002, 35.70000000000003, 28.699999999999967, 44.300000000000004, 46.5, -50.00000000000044, 29.099999999999973, -50.00000000000044, -50.00000000000044, 33.90000000000004, 45.3, 5.6999999999996405, 16.09999999999979, 20.49999999999985, 19.299999999999834, -50.00000000000044, 35.10000000000004, 43.10000000000001, -50.00000000000044, 22.699999999999882, 38.90000000000002, 40.30000000000002, -50.00000000000044], "episode_lengths": [106, 198, 56, 394, 132, 500, 54, 500, 500, 58, 500, 76, 142, 500, 148, 436, 500, 126, 500, 206, 70, 182, 500, 58, 500, 500, 338, 74, 488, 500, 78, 500, 72, 92, 84, 500, 56, 500, 128, 500, 128, 124, 500, 138, 86, 210, 106, 500, 140, 114, 98, 500, 48, 154, 48, 88, 80, 160, 252, 500, 66, 176, 500, 500, 138, 80, 500, 124, 64, 74, 378, 128, 500, 58, 500, 104, 90, 110, 144, 214, 58, 36, 500, 210, 500, 500, 162, 48, 444, 340, 296, 308, 500, 150, 70, 500, 274, 112, 98, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3770532675865348, "mean_inference_ms": 1.2110248458561095, "mean_action_processing_ms": 0.13859340007163784, "mean_env_wait_ms": 0.08313184910440909, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022530317306518555, "StateBufferConnector_ms": 0.008002281188964844, "ViewRequirementAgentConnector_ms": 0.1280057430267334}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000, "num_env_steps_sampled": 816000, "num_env_steps_trained": 816000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5255.292892326406, "num_env_steps_trained_throughput_per_sec": 5255.292892326406, "timesteps_total": 816000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 816000, "timers": {"training_iteration_time_ms": 2172.206, "sample_time_ms": 1933.024, "load_time_ms": 12.338, "load_throughput": 972601.629, "learn_time_ms": 215.481, "learn_throughput": 55689.428, "synch_weights_time_ms": 9.554}, "counters": {"num_env_steps_sampled": 816000, "num_env_steps_trained": 816000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "done": false, "episodes_total": 3079, "training_iteration": 68, "trial_id": "9f288_00016", "date": "2023-10-25_16-54-02", "timestamp": 1698249242, "time_this_iter_s": 2.2884111404418945, "time_total_s": 148.44227743148804, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 148.44227743148804, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 61.29999999999999, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.776263578034404e-22, "cur_lr": 0.0003, "total_loss": 7.082866695192125, "policy_loss": -0.0005071407390965356, "vf_loss": 7.083432197570801, "vf_explained_var": -1.1656019422743056e-06, "kl": 0.0005963594925712338, "entropy": 0.5836843517091539, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1233.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 828000, "num_env_steps_trained": 828000, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 14.394999999999868, "episode_len_mean": 231.8, "episode_media": {}, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.30000000000002, -50.00000000000044, 45.3, 34.70000000000004, 45.3, 41.30000000000001, 42.10000000000001, 34.10000000000004, 24.899999999999913, -50.00000000000044, 43.50000000000001, 32.50000000000002, -50.00000000000044, -50.00000000000044, 36.30000000000003, 42.10000000000001, -50.00000000000044, 37.70000000000003, 43.7, 42.70000000000001, 12.299999999999734, 37.300000000000026, -50.00000000000044, 44.300000000000004, -50.00000000000044, 39.70000000000002, 41.100000000000016, 39.10000000000002, 35.70000000000003, 28.699999999999967, 44.300000000000004, 46.5, -50.00000000000044, 29.099999999999973, -50.00000000000044, -50.00000000000044, 33.90000000000004, 45.3, 5.6999999999996405, 16.09999999999979, 20.49999999999985, 19.299999999999834, -50.00000000000044, 35.10000000000004, 43.10000000000001, -50.00000000000044, 22.699999999999882, 38.90000000000002, 40.30000000000002, -50.00000000000044, 12.099999999999731, 40.500000000000014, 37.300000000000026, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 34.70000000000004, -50.00000000000044, -50.00000000000044, 36.70000000000003, -50.00000000000044, 27.899999999999956, 35.70000000000003, 42.30000000000001, -50.00000000000044, 46.699999999999996, 44.10000000000001, 44.5, 39.70000000000002, 21.09999999999986, 38.10000000000002, 36.900000000000034, 18.499999999999822, -50.00000000000044, 45.9, 43.50000000000001, 41.70000000000002, 36.30000000000003, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 18.899999999999828, 43.7, 45.7, 41.90000000000001, 40.10000000000002, 8.699999999999683, 41.500000000000014, 39.300000000000026, 32.30000000000002, 45.3, -50.00000000000044, 4.499999999999623, 42.10000000000001, 45.1, 43.900000000000006, 32.90000000000003], "episode_lengths": [98, 500, 48, 154, 48, 88, 80, 160, 252, 500, 66, 176, 500, 500, 138, 80, 500, 124, 64, 74, 378, 128, 500, 58, 500, 104, 90, 110, 144, 214, 58, 36, 500, 210, 500, 500, 162, 48, 444, 340, 296, 308, 500, 150, 70, 500, 274, 112, 98, 500, 380, 96, 128, 50, 500, 500, 500, 34, 154, 500, 500, 134, 500, 222, 144, 78, 500, 34, 60, 56, 104, 290, 120, 132, 316, 500, 42, 66, 84, 138, 500, 80, 500, 500, 312, 64, 44, 82, 100, 414, 86, 108, 178, 48, 500, 456, 80, 50, 62, 172]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3774058185040051, "mean_inference_ms": 1.211460971025254, "mean_action_processing_ms": 0.13864811531036936, "mean_env_wait_ms": 0.08295697060140166, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02300572395324707, "StateBufferConnector_ms": 0.005000114440917969, "ViewRequirementAgentConnector_ms": 0.1290435791015625}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 14.394999999999868, "episode_len_mean": 231.8, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [40.30000000000002, -50.00000000000044, 45.3, 34.70000000000004, 45.3, 41.30000000000001, 42.10000000000001, 34.10000000000004, 24.899999999999913, -50.00000000000044, 43.50000000000001, 32.50000000000002, -50.00000000000044, -50.00000000000044, 36.30000000000003, 42.10000000000001, -50.00000000000044, 37.70000000000003, 43.7, 42.70000000000001, 12.299999999999734, 37.300000000000026, -50.00000000000044, 44.300000000000004, -50.00000000000044, 39.70000000000002, 41.100000000000016, 39.10000000000002, 35.70000000000003, 28.699999999999967, 44.300000000000004, 46.5, -50.00000000000044, 29.099999999999973, -50.00000000000044, -50.00000000000044, 33.90000000000004, 45.3, 5.6999999999996405, 16.09999999999979, 20.49999999999985, 19.299999999999834, -50.00000000000044, 35.10000000000004, 43.10000000000001, -50.00000000000044, 22.699999999999882, 38.90000000000002, 40.30000000000002, -50.00000000000044, 12.099999999999731, 40.500000000000014, 37.300000000000026, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 34.70000000000004, -50.00000000000044, -50.00000000000044, 36.70000000000003, -50.00000000000044, 27.899999999999956, 35.70000000000003, 42.30000000000001, -50.00000000000044, 46.699999999999996, 44.10000000000001, 44.5, 39.70000000000002, 21.09999999999986, 38.10000000000002, 36.900000000000034, 18.499999999999822, -50.00000000000044, 45.9, 43.50000000000001, 41.70000000000002, 36.30000000000003, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 18.899999999999828, 43.7, 45.7, 41.90000000000001, 40.10000000000002, 8.699999999999683, 41.500000000000014, 39.300000000000026, 32.30000000000002, 45.3, -50.00000000000044, 4.499999999999623, 42.10000000000001, 45.1, 43.900000000000006, 32.90000000000003], "episode_lengths": [98, 500, 48, 154, 48, 88, 80, 160, 252, 500, 66, 176, 500, 500, 138, 80, 500, 124, 64, 74, 378, 128, 500, 58, 500, 104, 90, 110, 144, 214, 58, 36, 500, 210, 500, 500, 162, 48, 444, 340, 296, 308, 500, 150, 70, 500, 274, 112, 98, 500, 380, 96, 128, 50, 500, 500, 500, 34, 154, 500, 500, 134, 500, 222, 144, 78, 500, 34, 60, 56, 104, 290, 120, 132, 316, 500, 42, 66, 84, 138, 500, 80, 500, 500, 312, 64, 44, 82, 100, 414, 86, 108, 178, 48, 500, 456, 80, 50, 62, 172]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3774058185040051, "mean_inference_ms": 1.211460971025254, "mean_action_processing_ms": 0.13864811531036936, "mean_env_wait_ms": 0.08295697060140166, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02300572395324707, "StateBufferConnector_ms": 0.005000114440917969, "ViewRequirementAgentConnector_ms": 0.1290435791015625}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000, "num_env_steps_sampled": 828000, "num_env_steps_trained": 828000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5896.801502914621, "num_env_steps_trained_throughput_per_sec": 5896.801502914621, "timesteps_total": 828000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 828000, "timers": {"training_iteration_time_ms": 2175.95, "sample_time_ms": 1937.069, "load_time_ms": 12.338, "load_throughput": 972584.714, "learn_time_ms": 215.279, "learn_throughput": 55741.63, "synch_weights_time_ms": 9.356}, "counters": {"num_env_steps_sampled": 828000, "num_env_steps_trained": 828000, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000}, "done": false, "episodes_total": 3129, "training_iteration": 69, "trial_id": "9f288_00016", "date": "2023-10-25_16-54-05", "timestamp": 1698249245, "time_this_iter_s": 2.039999485015869, "time_total_s": 150.4822769165039, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 150.4822769165039, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 57.23333333333333, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.388131789017202e-22, "cur_lr": 0.0003, "total_loss": 6.7548277378082275, "policy_loss": -0.0002223410022755464, "vf_loss": 6.755105468961927, "vf_explained_var": -1.493427488538954e-06, "kl": 0.0007440565160929206, "entropy": 0.5527028491099676, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1251.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 840000, "num_env_steps_trained": 840000, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.187999999999864, "episode_len_mean": 238.84, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.699999999999882, 38.90000000000002, 40.30000000000002, -50.00000000000044, 12.099999999999731, 40.500000000000014, 37.300000000000026, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 34.70000000000004, -50.00000000000044, -50.00000000000044, 36.70000000000003, -50.00000000000044, 27.899999999999956, 35.70000000000003, 42.30000000000001, -50.00000000000044, 46.699999999999996, 44.10000000000001, 44.5, 39.70000000000002, 21.09999999999986, 38.10000000000002, 36.900000000000034, 18.499999999999822, -50.00000000000044, 45.9, 43.50000000000001, 41.70000000000002, 36.30000000000003, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 18.899999999999828, 43.7, 45.7, 41.90000000000001, 40.10000000000002, 8.699999999999683, 41.500000000000014, 39.300000000000026, 32.30000000000002, 45.3, -50.00000000000044, 4.499999999999623, 42.10000000000001, 45.1, 43.900000000000006, 32.90000000000003, -50.00000000000044, -50.00000000000044, 26.69999999999994, -50.00000000000044, 33.10000000000003, 33.90000000000004, -50.00000000000044, 42.10000000000001, 27.899999999999956, -50.00000000000044, 46.699999999999996, 31.70000000000001, 23.499999999999893, 23.099999999999888, -50.00000000000044, 10.499999999999709, 45.7, 45.7, -50.00000000000044, 35.10000000000004, -50.00000000000044, 44.900000000000006, 28.499999999999964, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 40.90000000000002, 38.90000000000002, -50.00000000000044, 39.50000000000002, 42.30000000000001, 40.10000000000002, 34.70000000000004, -50.00000000000044, 36.10000000000004, 40.10000000000002, -50.00000000000044, 36.30000000000003, 40.70000000000002, 44.300000000000004, 40.90000000000002, 40.30000000000002, -50.00000000000044, 45.7, 29.69999999999998], "episode_lengths": [274, 112, 98, 500, 380, 96, 128, 50, 500, 500, 500, 34, 154, 500, 500, 134, 500, 222, 144, 78, 500, 34, 60, 56, 104, 290, 120, 132, 316, 500, 42, 66, 84, 138, 500, 80, 500, 500, 312, 64, 44, 82, 100, 414, 86, 108, 178, 48, 500, 456, 80, 50, 62, 172, 500, 500, 234, 500, 170, 162, 500, 80, 222, 500, 34, 184, 266, 270, 500, 396, 44, 44, 500, 150, 500, 52, 216, 500, 68, 500, 500, 92, 112, 500, 106, 78, 100, 154, 500, 140, 100, 500, 138, 94, 58, 92, 98, 500, 44, 204]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37766538125294263, "mean_inference_ms": 1.2116194254147599, "mean_action_processing_ms": 0.13886099374602817, "mean_env_wait_ms": 0.08311291006502479, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025006771087646484, "StateBufferConnector_ms": 0.004998207092285156, "ViewRequirementAgentConnector_ms": 0.12201857566833496}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.187999999999864, "episode_len_mean": 238.84, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [22.699999999999882, 38.90000000000002, 40.30000000000002, -50.00000000000044, 12.099999999999731, 40.500000000000014, 37.300000000000026, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 34.70000000000004, -50.00000000000044, -50.00000000000044, 36.70000000000003, -50.00000000000044, 27.899999999999956, 35.70000000000003, 42.30000000000001, -50.00000000000044, 46.699999999999996, 44.10000000000001, 44.5, 39.70000000000002, 21.09999999999986, 38.10000000000002, 36.900000000000034, 18.499999999999822, -50.00000000000044, 45.9, 43.50000000000001, 41.70000000000002, 36.30000000000003, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 18.899999999999828, 43.7, 45.7, 41.90000000000001, 40.10000000000002, 8.699999999999683, 41.500000000000014, 39.300000000000026, 32.30000000000002, 45.3, -50.00000000000044, 4.499999999999623, 42.10000000000001, 45.1, 43.900000000000006, 32.90000000000003, -50.00000000000044, -50.00000000000044, 26.69999999999994, -50.00000000000044, 33.10000000000003, 33.90000000000004, -50.00000000000044, 42.10000000000001, 27.899999999999956, -50.00000000000044, 46.699999999999996, 31.70000000000001, 23.499999999999893, 23.099999999999888, -50.00000000000044, 10.499999999999709, 45.7, 45.7, -50.00000000000044, 35.10000000000004, -50.00000000000044, 44.900000000000006, 28.499999999999964, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 40.90000000000002, 38.90000000000002, -50.00000000000044, 39.50000000000002, 42.30000000000001, 40.10000000000002, 34.70000000000004, -50.00000000000044, 36.10000000000004, 40.10000000000002, -50.00000000000044, 36.30000000000003, 40.70000000000002, 44.300000000000004, 40.90000000000002, 40.30000000000002, -50.00000000000044, 45.7, 29.69999999999998], "episode_lengths": [274, 112, 98, 500, 380, 96, 128, 50, 500, 500, 500, 34, 154, 500, 500, 134, 500, 222, 144, 78, 500, 34, 60, 56, 104, 290, 120, 132, 316, 500, 42, 66, 84, 138, 500, 80, 500, 500, 312, 64, 44, 82, 100, 414, 86, 108, 178, 48, 500, 456, 80, 50, 62, 172, 500, 500, 234, 500, 170, 162, 500, 80, 222, 500, 34, 184, 266, 270, 500, 396, 44, 44, 500, 150, 500, 52, 216, 500, 68, 500, 500, 92, 112, 500, 106, 78, 100, 154, 500, 140, 100, 500, 138, 94, 58, 92, 98, 500, 44, 204]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37766538125294263, "mean_inference_ms": 1.2116194254147599, "mean_action_processing_ms": 0.13886099374602817, "mean_env_wait_ms": 0.08311291006502479, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025006771087646484, "StateBufferConnector_ms": 0.004998207092285156, "ViewRequirementAgentConnector_ms": 0.12201857566833496}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000, "num_env_steps_sampled": 840000, "num_env_steps_trained": 840000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5623.226864581087, "num_env_steps_trained_throughput_per_sec": 5623.226864581087, "timesteps_total": 840000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 840000, "timers": {"training_iteration_time_ms": 2174.943, "sample_time_ms": 1936.042, "load_time_ms": 12.338, "load_throughput": 972579.076, "learn_time_ms": 215.654, "learn_throughput": 55644.563, "synch_weights_time_ms": 9.301}, "counters": {"num_env_steps_sampled": 840000, "num_env_steps_trained": 840000, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000}, "done": false, "episodes_total": 3175, "training_iteration": 70, "trial_id": "9f288_00016", "date": "2023-10-25_16-54-07", "timestamp": 1698249247, "time_this_iter_s": 2.1399998664855957, "time_total_s": 152.6222767829895, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 152.6222767829895, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 63.0, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.694065894508601e-22, "cur_lr": 0.0003, "total_loss": 6.815495623482598, "policy_loss": -9.313049829668469e-05, "vf_loss": 6.81564540333218, "vf_explained_var": -9.470515780978733e-07, "kl": 0.000276189659530246, "entropy": 0.5657318068875207, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1269.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 852000, "num_env_steps_trained": 852000, "num_agent_steps_sampled": 852000, "num_agent_steps_trained": 852000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.261999999999848, "episode_len_mean": 248.06, "episode_media": {}, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.499999999999623, 42.10000000000001, 45.1, 43.900000000000006, 32.90000000000003, -50.00000000000044, -50.00000000000044, 26.69999999999994, -50.00000000000044, 33.10000000000003, 33.90000000000004, -50.00000000000044, 42.10000000000001, 27.899999999999956, -50.00000000000044, 46.699999999999996, 31.70000000000001, 23.499999999999893, 23.099999999999888, -50.00000000000044, 10.499999999999709, 45.7, 45.7, -50.00000000000044, 35.10000000000004, -50.00000000000044, 44.900000000000006, 28.499999999999964, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 40.90000000000002, 38.90000000000002, -50.00000000000044, 39.50000000000002, 42.30000000000001, 40.10000000000002, 34.70000000000004, -50.00000000000044, 36.10000000000004, 40.10000000000002, -50.00000000000044, 36.30000000000003, 40.70000000000002, 44.300000000000004, 40.90000000000002, 40.30000000000002, -50.00000000000044, 45.7, 29.69999999999998, -50.00000000000044, 44.10000000000001, 31.1, 41.90000000000001, 44.900000000000006, 38.10000000000002, 39.300000000000026, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 37.70000000000003, 40.70000000000002, 3.899999999999615, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 42.10000000000001, 33.10000000000003, -50.00000000000044, 10.899999999999714, 42.10000000000001, 42.900000000000006, 46.699999999999996, -50.00000000000044, 45.5, 45.1, 42.900000000000006, -50.00000000000044, -50.00000000000044, 34.70000000000004, -50.00000000000044, 42.70000000000001, 44.10000000000001, -50.00000000000044, 37.70000000000003, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, 37.70000000000003, 42.70000000000001, 46.699999999999996, -50.00000000000044, 46.3, 6.099999999999646], "episode_lengths": [456, 80, 50, 62, 172, 500, 500, 234, 500, 170, 162, 500, 80, 222, 500, 34, 184, 266, 270, 500, 396, 44, 44, 500, 150, 500, 52, 216, 500, 68, 500, 500, 92, 112, 500, 106, 78, 100, 154, 500, 140, 100, 500, 138, 94, 58, 92, 98, 500, 44, 204, 500, 60, 190, 82, 52, 120, 108, 70, 500, 500, 500, 88, 124, 94, 462, 76, 500, 500, 500, 50, 80, 170, 500, 392, 80, 72, 34, 500, 46, 50, 72, 500, 500, 154, 500, 74, 60, 500, 124, 500, 500, 90, 500, 124, 74, 34, 500, 38, 440]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3776046915514255, "mean_inference_ms": 1.2118012857515226, "mean_action_processing_ms": 0.13889470863818706, "mean_env_wait_ms": 0.0833006805517552, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02521228790283203, "StateBufferConnector_ms": 0.004997968673706055, "ViewRequirementAgentConnector_ms": 0.13699030876159668}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.261999999999848, "episode_len_mean": 248.06, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [4.499999999999623, 42.10000000000001, 45.1, 43.900000000000006, 32.90000000000003, -50.00000000000044, -50.00000000000044, 26.69999999999994, -50.00000000000044, 33.10000000000003, 33.90000000000004, -50.00000000000044, 42.10000000000001, 27.899999999999956, -50.00000000000044, 46.699999999999996, 31.70000000000001, 23.499999999999893, 23.099999999999888, -50.00000000000044, 10.499999999999709, 45.7, 45.7, -50.00000000000044, 35.10000000000004, -50.00000000000044, 44.900000000000006, 28.499999999999964, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 40.90000000000002, 38.90000000000002, -50.00000000000044, 39.50000000000002, 42.30000000000001, 40.10000000000002, 34.70000000000004, -50.00000000000044, 36.10000000000004, 40.10000000000002, -50.00000000000044, 36.30000000000003, 40.70000000000002, 44.300000000000004, 40.90000000000002, 40.30000000000002, -50.00000000000044, 45.7, 29.69999999999998, -50.00000000000044, 44.10000000000001, 31.1, 41.90000000000001, 44.900000000000006, 38.10000000000002, 39.300000000000026, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 37.70000000000003, 40.70000000000002, 3.899999999999615, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 42.10000000000001, 33.10000000000003, -50.00000000000044, 10.899999999999714, 42.10000000000001, 42.900000000000006, 46.699999999999996, -50.00000000000044, 45.5, 45.1, 42.900000000000006, -50.00000000000044, -50.00000000000044, 34.70000000000004, -50.00000000000044, 42.70000000000001, 44.10000000000001, -50.00000000000044, 37.70000000000003, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, 37.70000000000003, 42.70000000000001, 46.699999999999996, -50.00000000000044, 46.3, 6.099999999999646], "episode_lengths": [456, 80, 50, 62, 172, 500, 500, 234, 500, 170, 162, 500, 80, 222, 500, 34, 184, 266, 270, 500, 396, 44, 44, 500, 150, 500, 52, 216, 500, 68, 500, 500, 92, 112, 500, 106, 78, 100, 154, 500, 140, 100, 500, 138, 94, 58, 92, 98, 500, 44, 204, 500, 60, 190, 82, 52, 120, 108, 70, 500, 500, 500, 88, 124, 94, 462, 76, 500, 500, 500, 50, 80, 170, 500, 392, 80, 72, 34, 500, 46, 50, 72, 500, 500, 154, 500, 74, 60, 500, 124, 500, 500, 90, 500, 124, 74, 34, 500, 38, 440]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3776046915514255, "mean_inference_ms": 1.2118012857515226, "mean_action_processing_ms": 0.13889470863818706, "mean_env_wait_ms": 0.0833006805517552, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02521228790283203, "StateBufferConnector_ms": 0.004997968673706055, "ViewRequirementAgentConnector_ms": 0.13699030876159668}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 852000, "num_agent_steps_trained": 852000, "num_env_steps_sampled": 852000, "num_env_steps_trained": 852000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5160.658348432182, "num_env_steps_trained_throughput_per_sec": 5160.658348432182, "timesteps_total": 852000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 852000, "timers": {"training_iteration_time_ms": 2188.42, "sample_time_ms": 1947.503, "load_time_ms": 12.638, "load_throughput": 949496.084, "learn_time_ms": 217.271, "learn_throughput": 55230.572, "synch_weights_time_ms": 9.201}, "counters": {"num_env_steps_sampled": 852000, "num_env_steps_trained": 852000, "num_agent_steps_sampled": 852000, "num_agent_steps_trained": 852000}, "done": false, "episodes_total": 3224, "training_iteration": 71, "trial_id": "9f288_00016", "date": "2023-10-25_16-54-09", "timestamp": 1698249249, "time_this_iter_s": 2.3312828540802, "time_total_s": 154.9535596370697, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 154.9535596370697, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 63.93333333333334, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.470329472543005e-23, "cur_lr": 0.0003, "total_loss": 6.4824628829956055, "policy_loss": -2.9819707075754803e-05, "vf_loss": 6.482547680536906, "vf_explained_var": -6.424056159125434e-07, "kl": 0.00010921140210011042, "entropy": 0.5489675352970759, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1287.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 864000, "num_env_steps_trained": 864000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.124999999999847, "episode_len_mean": 244.42, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.90000000000002, 40.30000000000002, -50.00000000000044, 45.7, 29.69999999999998, -50.00000000000044, 44.10000000000001, 31.1, 41.90000000000001, 44.900000000000006, 38.10000000000002, 39.300000000000026, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 37.70000000000003, 40.70000000000002, 3.899999999999615, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 42.10000000000001, 33.10000000000003, -50.00000000000044, 10.899999999999714, 42.10000000000001, 42.900000000000006, 46.699999999999996, -50.00000000000044, 45.5, 45.1, 42.900000000000006, -50.00000000000044, -50.00000000000044, 34.70000000000004, -50.00000000000044, 42.70000000000001, 44.10000000000001, -50.00000000000044, 37.70000000000003, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, 37.70000000000003, 42.70000000000001, 46.699999999999996, -50.00000000000044, 46.3, 6.099999999999646, 32.90000000000003, -50.00000000000044, 29.099999999999973, -50.00000000000044, 25.099999999999916, 30.9, -50.00000000000044, 41.30000000000001, 42.30000000000001, -50.00000000000044, 45.5, -50.00000000000044, 27.299999999999947, 44.10000000000001, 46.3, 42.10000000000001, -50.00000000000044, 41.500000000000014, 43.30000000000001, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 35.30000000000004, 42.70000000000001, 38.50000000000003, 10.899999999999714, -50.00000000000044, -50.00000000000044, 36.30000000000003, -50.00000000000044, 39.50000000000002, 45.3, 42.10000000000001, -50.00000000000044, 45.7, 32.700000000000024, 42.500000000000014, 32.700000000000024, -50.00000000000044, -50.00000000000044, 36.30000000000003, 32.700000000000024, 41.90000000000001, 44.7], "episode_lengths": [92, 98, 500, 44, 204, 500, 60, 190, 82, 52, 120, 108, 70, 500, 500, 500, 88, 124, 94, 462, 76, 500, 500, 500, 50, 80, 170, 500, 392, 80, 72, 34, 500, 46, 50, 72, 500, 500, 154, 500, 74, 60, 500, 124, 500, 500, 90, 500, 124, 74, 34, 500, 38, 440, 172, 500, 210, 500, 250, 192, 500, 88, 78, 500, 46, 500, 228, 60, 38, 80, 500, 86, 68, 54, 500, 500, 500, 52, 148, 74, 116, 392, 500, 500, 138, 500, 106, 48, 80, 500, 44, 174, 76, 174, 500, 500, 138, 174, 82, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3779118606065122, "mean_inference_ms": 1.2116979241234733, "mean_action_processing_ms": 0.13904680237200417, "mean_env_wait_ms": 0.08329603402407988, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027208328247070312, "StateBufferConnector_ms": 0.00899815559387207, "ViewRequirementAgentConnector_ms": 0.12992072105407715}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.124999999999847, "episode_len_mean": 244.42, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [40.90000000000002, 40.30000000000002, -50.00000000000044, 45.7, 29.69999999999998, -50.00000000000044, 44.10000000000001, 31.1, 41.90000000000001, 44.900000000000006, 38.10000000000002, 39.300000000000026, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 37.70000000000003, 40.70000000000002, 3.899999999999615, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 42.10000000000001, 33.10000000000003, -50.00000000000044, 10.899999999999714, 42.10000000000001, 42.900000000000006, 46.699999999999996, -50.00000000000044, 45.5, 45.1, 42.900000000000006, -50.00000000000044, -50.00000000000044, 34.70000000000004, -50.00000000000044, 42.70000000000001, 44.10000000000001, -50.00000000000044, 37.70000000000003, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, 37.70000000000003, 42.70000000000001, 46.699999999999996, -50.00000000000044, 46.3, 6.099999999999646, 32.90000000000003, -50.00000000000044, 29.099999999999973, -50.00000000000044, 25.099999999999916, 30.9, -50.00000000000044, 41.30000000000001, 42.30000000000001, -50.00000000000044, 45.5, -50.00000000000044, 27.299999999999947, 44.10000000000001, 46.3, 42.10000000000001, -50.00000000000044, 41.500000000000014, 43.30000000000001, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 35.30000000000004, 42.70000000000001, 38.50000000000003, 10.899999999999714, -50.00000000000044, -50.00000000000044, 36.30000000000003, -50.00000000000044, 39.50000000000002, 45.3, 42.10000000000001, -50.00000000000044, 45.7, 32.700000000000024, 42.500000000000014, 32.700000000000024, -50.00000000000044, -50.00000000000044, 36.30000000000003, 32.700000000000024, 41.90000000000001, 44.7], "episode_lengths": [92, 98, 500, 44, 204, 500, 60, 190, 82, 52, 120, 108, 70, 500, 500, 500, 88, 124, 94, 462, 76, 500, 500, 500, 50, 80, 170, 500, 392, 80, 72, 34, 500, 46, 50, 72, 500, 500, 154, 500, 74, 60, 500, 124, 500, 500, 90, 500, 124, 74, 34, 500, 38, 440, 172, 500, 210, 500, 250, 192, 500, 88, 78, 500, 46, 500, 228, 60, 38, 80, 500, 86, 68, 54, 500, 500, 500, 52, 148, 74, 116, 392, 500, 500, 138, 500, 106, 48, 80, 500, 44, 174, 76, 174, 500, 500, 138, 174, 82, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3779118606065122, "mean_inference_ms": 1.2116979241234733, "mean_action_processing_ms": 0.13904680237200417, "mean_env_wait_ms": 0.08329603402407988, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027208328247070312, "StateBufferConnector_ms": 0.00899815559387207, "ViewRequirementAgentConnector_ms": 0.12992072105407715}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000, "num_env_steps_sampled": 864000, "num_env_steps_trained": 864000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5686.93161499389, "num_env_steps_trained_throughput_per_sec": 5686.93161499389, "timesteps_total": 864000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 864000, "timers": {"training_iteration_time_ms": 2164.093, "sample_time_ms": 1932.975, "load_time_ms": 11.897, "load_throughput": 1008636.111, "learn_time_ms": 208.285, "learn_throughput": 57613.228, "synch_weights_time_ms": 9.127}, "counters": {"num_env_steps_sampled": 864000, "num_env_steps_trained": 864000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "done": false, "episodes_total": 3270, "training_iteration": 72, "trial_id": "9f288_00016", "date": "2023-10-25_16-54-11", "timestamp": 1698249251, "time_this_iter_s": 2.1150999069213867, "time_total_s": 157.0686595439911, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 157.0686595439911, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 56.366666666666674, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.2351647362715025e-23, "cur_lr": 0.0003, "total_loss": 7.062906768586901, "policy_loss": -8.119580646355947e-06, "vf_loss": 7.062971989313762, "vf_explained_var": -5.993578169080946e-07, "kl": 5.262041399905431e-05, "entropy": 0.5689212878545126, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1305.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 876000, "num_env_steps_trained": 876000, "num_agent_steps_sampled": 876000, "num_agent_steps_trained": 876000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.611999999999842, "episode_len_mean": 254.56, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [37.70000000000003, 42.70000000000001, 46.699999999999996, -50.00000000000044, 46.3, 6.099999999999646, 32.90000000000003, -50.00000000000044, 29.099999999999973, -50.00000000000044, 25.099999999999916, 30.9, -50.00000000000044, 41.30000000000001, 42.30000000000001, -50.00000000000044, 45.5, -50.00000000000044, 27.299999999999947, 44.10000000000001, 46.3, 42.10000000000001, -50.00000000000044, 41.500000000000014, 43.30000000000001, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 35.30000000000004, 42.70000000000001, 38.50000000000003, 10.899999999999714, -50.00000000000044, -50.00000000000044, 36.30000000000003, -50.00000000000044, 39.50000000000002, 45.3, 42.10000000000001, -50.00000000000044, 45.7, 32.700000000000024, 42.500000000000014, 32.700000000000024, -50.00000000000044, -50.00000000000044, 36.30000000000003, 32.700000000000024, 41.90000000000001, 44.7, -50.00000000000044, 45.1, 14.09999999999976, -50.00000000000044, -50.00000000000044, 36.50000000000003, 42.30000000000001, 34.50000000000004, 5.299999999999635, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 45.3, 42.900000000000006, -50.00000000000044, 33.70000000000004, -50.00000000000044, 38.700000000000024, 9.099999999999689, 25.899999999999928, 32.700000000000024, 39.50000000000002, 28.699999999999967, -50.00000000000044, 22.099999999999874, 39.300000000000026, 42.70000000000001, 36.10000000000004, -50.00000000000044, 43.900000000000006, -50.00000000000044, 41.100000000000016, -50.00000000000044, 42.30000000000001, 39.50000000000002, -50.00000000000044, 2.8999999999996007, 37.70000000000003, -50.00000000000044, 41.500000000000014, 45.5, 37.90000000000003, 27.699999999999953, 44.300000000000004, 37.50000000000003, -50.00000000000044], "episode_lengths": [124, 74, 34, 500, 38, 440, 172, 500, 210, 500, 250, 192, 500, 88, 78, 500, 46, 500, 228, 60, 38, 80, 500, 86, 68, 54, 500, 500, 500, 52, 148, 74, 116, 392, 500, 500, 138, 500, 106, 48, 80, 500, 44, 174, 76, 174, 500, 500, 138, 174, 82, 54, 500, 50, 360, 500, 500, 136, 78, 156, 448, 500, 500, 500, 500, 58, 48, 72, 500, 164, 500, 114, 410, 242, 174, 106, 214, 500, 280, 108, 74, 140, 500, 62, 500, 90, 500, 78, 106, 500, 472, 124, 500, 86, 46, 122, 224, 58, 126, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3780170985750745, "mean_inference_ms": 1.2118044558494863, "mean_action_processing_ms": 0.13923489102523232, "mean_env_wait_ms": 0.08339480726273962, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02699756622314453, "StateBufferConnector_ms": 0.009998559951782227, "ViewRequirementAgentConnector_ms": 0.1268601417541504}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.611999999999842, "episode_len_mean": 254.56, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [37.70000000000003, 42.70000000000001, 46.699999999999996, -50.00000000000044, 46.3, 6.099999999999646, 32.90000000000003, -50.00000000000044, 29.099999999999973, -50.00000000000044, 25.099999999999916, 30.9, -50.00000000000044, 41.30000000000001, 42.30000000000001, -50.00000000000044, 45.5, -50.00000000000044, 27.299999999999947, 44.10000000000001, 46.3, 42.10000000000001, -50.00000000000044, 41.500000000000014, 43.30000000000001, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 35.30000000000004, 42.70000000000001, 38.50000000000003, 10.899999999999714, -50.00000000000044, -50.00000000000044, 36.30000000000003, -50.00000000000044, 39.50000000000002, 45.3, 42.10000000000001, -50.00000000000044, 45.7, 32.700000000000024, 42.500000000000014, 32.700000000000024, -50.00000000000044, -50.00000000000044, 36.30000000000003, 32.700000000000024, 41.90000000000001, 44.7, -50.00000000000044, 45.1, 14.09999999999976, -50.00000000000044, -50.00000000000044, 36.50000000000003, 42.30000000000001, 34.50000000000004, 5.299999999999635, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 45.3, 42.900000000000006, -50.00000000000044, 33.70000000000004, -50.00000000000044, 38.700000000000024, 9.099999999999689, 25.899999999999928, 32.700000000000024, 39.50000000000002, 28.699999999999967, -50.00000000000044, 22.099999999999874, 39.300000000000026, 42.70000000000001, 36.10000000000004, -50.00000000000044, 43.900000000000006, -50.00000000000044, 41.100000000000016, -50.00000000000044, 42.30000000000001, 39.50000000000002, -50.00000000000044, 2.8999999999996007, 37.70000000000003, -50.00000000000044, 41.500000000000014, 45.5, 37.90000000000003, 27.699999999999953, 44.300000000000004, 37.50000000000003, -50.00000000000044], "episode_lengths": [124, 74, 34, 500, 38, 440, 172, 500, 210, 500, 250, 192, 500, 88, 78, 500, 46, 500, 228, 60, 38, 80, 500, 86, 68, 54, 500, 500, 500, 52, 148, 74, 116, 392, 500, 500, 138, 500, 106, 48, 80, 500, 44, 174, 76, 174, 500, 500, 138, 174, 82, 54, 500, 50, 360, 500, 500, 136, 78, 156, 448, 500, 500, 500, 500, 58, 48, 72, 500, 164, 500, 114, 410, 242, 174, 106, 214, 500, 280, 108, 74, 140, 500, 62, 500, 90, 500, 78, 106, 500, 472, 124, 500, 86, 46, 122, 224, 58, 126, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3780170985750745, "mean_inference_ms": 1.2118044558494863, "mean_action_processing_ms": 0.13923489102523232, "mean_env_wait_ms": 0.08339480726273962, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02699756622314453, "StateBufferConnector_ms": 0.009998559951782227, "ViewRequirementAgentConnector_ms": 0.1268601417541504}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 876000, "num_agent_steps_trained": 876000, "num_env_steps_sampled": 876000, "num_env_steps_trained": 876000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5443.568493272173, "num_env_steps_trained_throughput_per_sec": 5443.568493272173, "timesteps_total": 876000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 876000, "timers": {"training_iteration_time_ms": 2174.263, "sample_time_ms": 1932.882, "load_time_ms": 12.865, "load_throughput": 932732.559, "learn_time_ms": 217.634, "learn_throughput": 55138.519, "synch_weights_time_ms": 8.974}, "counters": {"num_env_steps_sampled": 876000, "num_env_steps_trained": 876000, "num_agent_steps_sampled": 876000, "num_agent_steps_trained": 876000}, "done": false, "episodes_total": 3318, "training_iteration": 73, "trial_id": "9f288_00016", "date": "2023-10-25_16-54-13", "timestamp": 1698249253, "time_this_iter_s": 2.2104365825653076, "time_total_s": 159.2790961265564, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 159.2790961265564, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 60.166666666666664, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.1175823681357513e-23, "cur_lr": 0.0003, "total_loss": 6.435141351487902, "policy_loss": -9.611269666088952e-05, "vf_loss": 6.435295290417141, "vf_explained_var": -7.649262746175131e-07, "kl": 0.0001845239897006776, "entropy": 0.579020145866606, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1323.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 888000, "num_env_steps_trained": 888000, "num_agent_steps_sampled": 888000, "num_agent_steps_trained": 888000}, "sampler_results": {"episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.834999999999835, "episode_len_mean": 257.3, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 36.30000000000003, 32.700000000000024, 41.90000000000001, 44.7, -50.00000000000044, 45.1, 14.09999999999976, -50.00000000000044, -50.00000000000044, 36.50000000000003, 42.30000000000001, 34.50000000000004, 5.299999999999635, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 45.3, 42.900000000000006, -50.00000000000044, 33.70000000000004, -50.00000000000044, 38.700000000000024, 9.099999999999689, 25.899999999999928, 32.700000000000024, 39.50000000000002, 28.699999999999967, -50.00000000000044, 22.099999999999874, 39.300000000000026, 42.70000000000001, 36.10000000000004, -50.00000000000044, 43.900000000000006, -50.00000000000044, 41.100000000000016, -50.00000000000044, 42.30000000000001, 39.50000000000002, -50.00000000000044, 2.8999999999996007, 37.70000000000003, -50.00000000000044, 41.500000000000014, 45.5, 37.90000000000003, 27.699999999999953, 44.300000000000004, 37.50000000000003, -50.00000000000044, -50.00000000000044, 27.899999999999956, 29.299999999999976, 37.90000000000003, 41.100000000000016, 45.3, -50.00000000000044, 39.10000000000002, 42.70000000000001, 42.900000000000006, 43.7, 45.3, -50.00000000000044, 40.90000000000002, -50.00000000000044, 44.300000000000004, 43.7, -50.00000000000044, 43.30000000000001, 46.3, 27.49999999999995, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 44.7, 31.300000000000004, -50.00000000000044, 39.300000000000026, 40.90000000000002, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 43.50000000000001, 45.1, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 42.70000000000001, 33.90000000000004, -50.00000000000044], "episode_lengths": [500, 138, 174, 82, 54, 500, 50, 360, 500, 500, 136, 78, 156, 448, 500, 500, 500, 500, 58, 48, 72, 500, 164, 500, 114, 410, 242, 174, 106, 214, 500, 280, 108, 74, 140, 500, 62, 500, 90, 500, 78, 106, 500, 472, 124, 500, 86, 46, 122, 224, 58, 126, 500, 500, 222, 208, 122, 90, 48, 500, 110, 74, 72, 64, 48, 500, 92, 500, 58, 64, 500, 68, 38, 226, 42, 500, 500, 500, 88, 54, 188, 500, 108, 92, 500, 500, 70, 500, 500, 500, 86, 66, 50, 500, 500, 72, 500, 74, 162, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37772203192008225, "mean_inference_ms": 1.212436513907699, "mean_action_processing_ms": 0.13906059754608616, "mean_env_wait_ms": 0.0832620271741879, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02399754524230957, "StateBufferConnector_ms": 0.006999015808105469, "ViewRequirementAgentConnector_ms": 0.11294317245483398}}, "episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.834999999999835, "episode_len_mean": 257.3, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 36.30000000000003, 32.700000000000024, 41.90000000000001, 44.7, -50.00000000000044, 45.1, 14.09999999999976, -50.00000000000044, -50.00000000000044, 36.50000000000003, 42.30000000000001, 34.50000000000004, 5.299999999999635, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 45.3, 42.900000000000006, -50.00000000000044, 33.70000000000004, -50.00000000000044, 38.700000000000024, 9.099999999999689, 25.899999999999928, 32.700000000000024, 39.50000000000002, 28.699999999999967, -50.00000000000044, 22.099999999999874, 39.300000000000026, 42.70000000000001, 36.10000000000004, -50.00000000000044, 43.900000000000006, -50.00000000000044, 41.100000000000016, -50.00000000000044, 42.30000000000001, 39.50000000000002, -50.00000000000044, 2.8999999999996007, 37.70000000000003, -50.00000000000044, 41.500000000000014, 45.5, 37.90000000000003, 27.699999999999953, 44.300000000000004, 37.50000000000003, -50.00000000000044, -50.00000000000044, 27.899999999999956, 29.299999999999976, 37.90000000000003, 41.100000000000016, 45.3, -50.00000000000044, 39.10000000000002, 42.70000000000001, 42.900000000000006, 43.7, 45.3, -50.00000000000044, 40.90000000000002, -50.00000000000044, 44.300000000000004, 43.7, -50.00000000000044, 43.30000000000001, 46.3, 27.49999999999995, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 44.7, 31.300000000000004, -50.00000000000044, 39.300000000000026, 40.90000000000002, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 43.50000000000001, 45.1, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 42.70000000000001, 33.90000000000004, -50.00000000000044], "episode_lengths": [500, 138, 174, 82, 54, 500, 50, 360, 500, 500, 136, 78, 156, 448, 500, 500, 500, 500, 58, 48, 72, 500, 164, 500, 114, 410, 242, 174, 106, 214, 500, 280, 108, 74, 140, 500, 62, 500, 90, 500, 78, 106, 500, 472, 124, 500, 86, 46, 122, 224, 58, 126, 500, 500, 222, 208, 122, 90, 48, 500, 110, 74, 72, 64, 48, 500, 92, 500, 58, 64, 500, 68, 38, 226, 42, 500, 500, 500, 88, 54, 188, 500, 108, 92, 500, 500, 70, 500, 500, 500, 86, 66, 50, 500, 500, 72, 500, 74, 162, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37772203192008225, "mean_inference_ms": 1.212436513907699, "mean_action_processing_ms": 0.13906059754608616, "mean_env_wait_ms": 0.0832620271741879, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02399754524230957, "StateBufferConnector_ms": 0.006999015808105469, "ViewRequirementAgentConnector_ms": 0.11294317245483398}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 888000, "num_agent_steps_trained": 888000, "num_env_steps_sampled": 888000, "num_env_steps_trained": 888000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5694.111657726424, "num_env_steps_trained_throughput_per_sec": 5694.111657726424, "timesteps_total": 888000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 888000, "timers": {"training_iteration_time_ms": 2162.424, "sample_time_ms": 1927.692, "load_time_ms": 12.174, "load_throughput": 985710.274, "learn_time_ms": 211.823, "learn_throughput": 56651.088, "synch_weights_time_ms": 8.727}, "counters": {"num_env_steps_sampled": 888000, "num_env_steps_trained": 888000, "num_agent_steps_sampled": 888000, "num_agent_steps_trained": 888000}, "done": false, "episodes_total": 3365, "training_iteration": 74, "trial_id": "9f288_00016", "date": "2023-10-25_16-54-16", "timestamp": 1698249256, "time_this_iter_s": 2.1124355792999268, "time_total_s": 161.39153170585632, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 161.39153170585632, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 57.96666666666667, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.0587911840678756e-23, "cur_lr": 0.0003, "total_loss": 7.1611214478810625, "policy_loss": -7.764539784855313e-05, "vf_loss": 7.161253849665324, "vf_explained_var": -1.1920928955078125e-06, "kl": 0.00021753049293869885, "entropy": 0.5460715840260187, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1341.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 900000, "num_env_steps_trained": 900000, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.89699999999984, "episode_len_mean": 246.7, "episode_media": {}, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [37.50000000000003, -50.00000000000044, -50.00000000000044, 27.899999999999956, 29.299999999999976, 37.90000000000003, 41.100000000000016, 45.3, -50.00000000000044, 39.10000000000002, 42.70000000000001, 42.900000000000006, 43.7, 45.3, -50.00000000000044, 40.90000000000002, -50.00000000000044, 44.300000000000004, 43.7, -50.00000000000044, 43.30000000000001, 46.3, 27.49999999999995, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 44.7, 31.300000000000004, -50.00000000000044, 39.300000000000026, 40.90000000000002, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 43.50000000000001, 45.1, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 42.70000000000001, 33.90000000000004, -50.00000000000044, 34.900000000000034, -50.00000000000044, -50.00000000000044, 44.10000000000001, 45.3, 40.30000000000002, 46.5, 45.5, 44.5, 43.10000000000001, 32.100000000000016, 40.500000000000014, -50.00000000000044, 43.10000000000001, 34.30000000000004, 43.10000000000001, 8.699999999999683, 31.500000000000007, 43.900000000000006, 43.30000000000001, 24.299999999999905, 47.5, -50.00000000000044, 8.699999999999683, 38.300000000000026, 40.500000000000014, -50.00000000000044, 43.7, -50.00000000000044, 22.899999999999885, -50.00000000000044, 45.9, 44.10000000000001, 35.70000000000003, 42.10000000000001, -50.00000000000044, -50.00000000000044, 13.299999999999748, 42.500000000000014, 44.10000000000001, 23.29999999999989, -50.00000000000044, 45.3, -50.00000000000044, 2.699999999999598, 43.10000000000001, -50.00000000000044, -50.00000000000044, 41.100000000000016, 11.099999999999717, -50.00000000000044], "episode_lengths": [126, 500, 500, 222, 208, 122, 90, 48, 500, 110, 74, 72, 64, 48, 500, 92, 500, 58, 64, 500, 68, 38, 226, 42, 500, 500, 500, 88, 54, 188, 500, 108, 92, 500, 500, 70, 500, 500, 500, 86, 66, 50, 500, 500, 72, 500, 74, 162, 500, 152, 500, 500, 60, 48, 98, 36, 46, 56, 70, 180, 96, 500, 70, 158, 70, 414, 186, 62, 68, 258, 26, 500, 414, 118, 96, 500, 64, 500, 272, 500, 42, 60, 144, 80, 500, 500, 368, 76, 60, 268, 500, 48, 500, 474, 70, 500, 500, 90, 390, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3774191736302637, "mean_inference_ms": 1.2107701078092077, "mean_action_processing_ms": 0.13933732177442865, "mean_env_wait_ms": 0.08308921213167114, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019980907440185547, "StateBufferConnector_ms": 0.005998373031616211, "ViewRequirementAgentConnector_ms": 0.11552023887634277}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.89699999999984, "episode_len_mean": 246.7, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [37.50000000000003, -50.00000000000044, -50.00000000000044, 27.899999999999956, 29.299999999999976, 37.90000000000003, 41.100000000000016, 45.3, -50.00000000000044, 39.10000000000002, 42.70000000000001, 42.900000000000006, 43.7, 45.3, -50.00000000000044, 40.90000000000002, -50.00000000000044, 44.300000000000004, 43.7, -50.00000000000044, 43.30000000000001, 46.3, 27.49999999999995, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 44.7, 31.300000000000004, -50.00000000000044, 39.300000000000026, 40.90000000000002, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 43.50000000000001, 45.1, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 42.70000000000001, 33.90000000000004, -50.00000000000044, 34.900000000000034, -50.00000000000044, -50.00000000000044, 44.10000000000001, 45.3, 40.30000000000002, 46.5, 45.5, 44.5, 43.10000000000001, 32.100000000000016, 40.500000000000014, -50.00000000000044, 43.10000000000001, 34.30000000000004, 43.10000000000001, 8.699999999999683, 31.500000000000007, 43.900000000000006, 43.30000000000001, 24.299999999999905, 47.5, -50.00000000000044, 8.699999999999683, 38.300000000000026, 40.500000000000014, -50.00000000000044, 43.7, -50.00000000000044, 22.899999999999885, -50.00000000000044, 45.9, 44.10000000000001, 35.70000000000003, 42.10000000000001, -50.00000000000044, -50.00000000000044, 13.299999999999748, 42.500000000000014, 44.10000000000001, 23.29999999999989, -50.00000000000044, 45.3, -50.00000000000044, 2.699999999999598, 43.10000000000001, -50.00000000000044, -50.00000000000044, 41.100000000000016, 11.099999999999717, -50.00000000000044], "episode_lengths": [126, 500, 500, 222, 208, 122, 90, 48, 500, 110, 74, 72, 64, 48, 500, 92, 500, 58, 64, 500, 68, 38, 226, 42, 500, 500, 500, 88, 54, 188, 500, 108, 92, 500, 500, 70, 500, 500, 500, 86, 66, 50, 500, 500, 72, 500, 74, 162, 500, 152, 500, 500, 60, 48, 98, 36, 46, 56, 70, 180, 96, 500, 70, 158, 70, 414, 186, 62, 68, 258, 26, 500, 414, 118, 96, 500, 64, 500, 272, 500, 42, 60, 144, 80, 500, 500, 368, 76, 60, 268, 500, 48, 500, 474, 70, 500, 500, 90, 390, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3774191736302637, "mean_inference_ms": 1.2107701078092077, "mean_action_processing_ms": 0.13933732177442865, "mean_env_wait_ms": 0.08308921213167114, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019980907440185547, "StateBufferConnector_ms": 0.005998373031616211, "ViewRequirementAgentConnector_ms": 0.11552023887634277}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000, "num_env_steps_sampled": 900000, "num_env_steps_trained": 900000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5434.6653784278815, "num_env_steps_trained_throughput_per_sec": 5434.6653784278815, "timesteps_total": 900000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 900000, "timers": {"training_iteration_time_ms": 2168.118, "sample_time_ms": 1918.617, "load_time_ms": 12.604, "load_throughput": 952064.435, "learn_time_ms": 225.736, "learn_throughput": 53159.556, "synch_weights_time_ms": 9.254}, "counters": {"num_env_steps_sampled": 900000, "num_env_steps_trained": 900000, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000}, "done": false, "episodes_total": 3416, "training_iteration": 75, "trial_id": "9f288_00016", "date": "2023-10-25_16-54-18", "timestamp": 1698249258, "time_this_iter_s": 2.214043617248535, "time_total_s": 163.60557532310486, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 163.60557532310486, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 54.4, "ram_util_percent": 27.224999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.293955920339378e-24, "cur_lr": 0.0003, "total_loss": 6.764466497633192, "policy_loss": -9.657773706648085e-05, "vf_loss": 6.764621045854357, "vf_explained_var": -7.814831203884548e-07, "kl": 0.00016226208536964905, "entropy": 0.5799879431724548, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1359.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 912000, "num_env_steps_trained": 912000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.892999999999848, "episode_len_mean": 246.76, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [33.90000000000004, -50.00000000000044, 34.900000000000034, -50.00000000000044, -50.00000000000044, 44.10000000000001, 45.3, 40.30000000000002, 46.5, 45.5, 44.5, 43.10000000000001, 32.100000000000016, 40.500000000000014, -50.00000000000044, 43.10000000000001, 34.30000000000004, 43.10000000000001, 8.699999999999683, 31.500000000000007, 43.900000000000006, 43.30000000000001, 24.299999999999905, 47.5, -50.00000000000044, 8.699999999999683, 38.300000000000026, 40.500000000000014, -50.00000000000044, 43.7, -50.00000000000044, 22.899999999999885, -50.00000000000044, 45.9, 44.10000000000001, 35.70000000000003, 42.10000000000001, -50.00000000000044, -50.00000000000044, 13.299999999999748, 42.500000000000014, 44.10000000000001, 23.29999999999989, -50.00000000000044, 45.3, -50.00000000000044, 2.699999999999598, 43.10000000000001, -50.00000000000044, -50.00000000000044, 41.100000000000016, 11.099999999999717, -50.00000000000044, -50.00000000000044, 42.70000000000001, 23.699999999999896, 30.9, 35.30000000000004, 45.3, 46.3, 44.5, 44.10000000000001, 36.900000000000034, -50.00000000000044, 42.30000000000001, 44.900000000000006, 46.5, -50.00000000000044, 41.500000000000014, 42.900000000000006, 44.7, -50.00000000000044, 37.50000000000003, 35.10000000000004, 44.7, 37.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 20.49999999999985, 34.70000000000004, 46.099999999999994, -50.00000000000044, 36.70000000000003, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.50000000000002, 41.500000000000014, 31.500000000000007, -50.00000000000044, 33.30000000000003, -50.00000000000044, 19.899999999999842, 33.70000000000004, 41.100000000000016, -50.00000000000044], "episode_lengths": [162, 500, 152, 500, 500, 60, 48, 98, 36, 46, 56, 70, 180, 96, 500, 70, 158, 70, 414, 186, 62, 68, 258, 26, 500, 414, 118, 96, 500, 64, 500, 272, 500, 42, 60, 144, 80, 500, 500, 368, 76, 60, 268, 500, 48, 500, 474, 70, 500, 500, 90, 390, 500, 500, 74, 264, 192, 148, 48, 38, 56, 60, 132, 500, 78, 52, 36, 500, 86, 72, 54, 500, 126, 150, 54, 128, 500, 500, 500, 296, 154, 40, 500, 134, 500, 500, 82, 500, 500, 500, 176, 86, 186, 500, 168, 500, 302, 164, 90, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3772609582495764, "mean_inference_ms": 1.2102574667472996, "mean_action_processing_ms": 0.13921220581595936, "mean_env_wait_ms": 0.08298879008168923, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020984411239624023, "StateBufferConnector_ms": 0.003998517990112305, "ViewRequirementAgentConnector_ms": 0.12450909614562988}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.892999999999848, "episode_len_mean": 246.76, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [33.90000000000004, -50.00000000000044, 34.900000000000034, -50.00000000000044, -50.00000000000044, 44.10000000000001, 45.3, 40.30000000000002, 46.5, 45.5, 44.5, 43.10000000000001, 32.100000000000016, 40.500000000000014, -50.00000000000044, 43.10000000000001, 34.30000000000004, 43.10000000000001, 8.699999999999683, 31.500000000000007, 43.900000000000006, 43.30000000000001, 24.299999999999905, 47.5, -50.00000000000044, 8.699999999999683, 38.300000000000026, 40.500000000000014, -50.00000000000044, 43.7, -50.00000000000044, 22.899999999999885, -50.00000000000044, 45.9, 44.10000000000001, 35.70000000000003, 42.10000000000001, -50.00000000000044, -50.00000000000044, 13.299999999999748, 42.500000000000014, 44.10000000000001, 23.29999999999989, -50.00000000000044, 45.3, -50.00000000000044, 2.699999999999598, 43.10000000000001, -50.00000000000044, -50.00000000000044, 41.100000000000016, 11.099999999999717, -50.00000000000044, -50.00000000000044, 42.70000000000001, 23.699999999999896, 30.9, 35.30000000000004, 45.3, 46.3, 44.5, 44.10000000000001, 36.900000000000034, -50.00000000000044, 42.30000000000001, 44.900000000000006, 46.5, -50.00000000000044, 41.500000000000014, 42.900000000000006, 44.7, -50.00000000000044, 37.50000000000003, 35.10000000000004, 44.7, 37.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 20.49999999999985, 34.70000000000004, 46.099999999999994, -50.00000000000044, 36.70000000000003, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.50000000000002, 41.500000000000014, 31.500000000000007, -50.00000000000044, 33.30000000000003, -50.00000000000044, 19.899999999999842, 33.70000000000004, 41.100000000000016, -50.00000000000044], "episode_lengths": [162, 500, 152, 500, 500, 60, 48, 98, 36, 46, 56, 70, 180, 96, 500, 70, 158, 70, 414, 186, 62, 68, 258, 26, 500, 414, 118, 96, 500, 64, 500, 272, 500, 42, 60, 144, 80, 500, 500, 368, 76, 60, 268, 500, 48, 500, 474, 70, 500, 500, 90, 390, 500, 500, 74, 264, 192, 148, 48, 38, 56, 60, 132, 500, 78, 52, 36, 500, 86, 72, 54, 500, 126, 150, 54, 128, 500, 500, 500, 296, 154, 40, 500, 134, 500, 500, 82, 500, 500, 500, 176, 86, 186, 500, 168, 500, 302, 164, 90, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3772609582495764, "mean_inference_ms": 1.2102574667472996, "mean_action_processing_ms": 0.13921220581595936, "mean_env_wait_ms": 0.08298879008168923, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020984411239624023, "StateBufferConnector_ms": 0.003998517990112305, "ViewRequirementAgentConnector_ms": 0.12450909614562988}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000, "num_env_steps_sampled": 912000, "num_env_steps_trained": 912000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5735.818644207639, "num_env_steps_trained_throughput_per_sec": 5735.818644207639, "timesteps_total": 912000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 912000, "timers": {"training_iteration_time_ms": 2159.279, "sample_time_ms": 1921.559, "load_time_ms": 11.67, "load_throughput": 1028299.225, "learn_time_ms": 214.963, "learn_throughput": 55823.49, "synch_weights_time_ms": 9.28}, "counters": {"num_env_steps_sampled": 912000, "num_env_steps_trained": 912000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "done": false, "episodes_total": 3463, "training_iteration": 76, "trial_id": "9f288_00016", "date": "2023-10-25_16-54-20", "timestamp": 1698249260, "time_this_iter_s": 2.0971157550811768, "time_total_s": 165.70269107818604, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 165.70269107818604, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 66.80000000000001, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.646977960169689e-24, "cur_lr": 0.0003, "total_loss": 6.180261108610365, "policy_loss": -0.0006973225519888931, "vf_loss": 6.18101520008511, "vf_explained_var": -9.669197930230034e-07, "kl": 0.000671937795497494, "entropy": 0.5677811586194568, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1377.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 924000, "num_env_steps_trained": 924000, "num_agent_steps_sampled": 924000, "num_agent_steps_trained": 924000}, "sampler_results": {"episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.860999999999823, "episode_len_mean": 267.02, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.10000000000001, 23.29999999999989, -50.00000000000044, 45.3, -50.00000000000044, 2.699999999999598, 43.10000000000001, -50.00000000000044, -50.00000000000044, 41.100000000000016, 11.099999999999717, -50.00000000000044, -50.00000000000044, 42.70000000000001, 23.699999999999896, 30.9, 35.30000000000004, 45.3, 46.3, 44.5, 44.10000000000001, 36.900000000000034, -50.00000000000044, 42.30000000000001, 44.900000000000006, 46.5, -50.00000000000044, 41.500000000000014, 42.900000000000006, 44.7, -50.00000000000044, 37.50000000000003, 35.10000000000004, 44.7, 37.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 20.49999999999985, 34.70000000000004, 46.099999999999994, -50.00000000000044, 36.70000000000003, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.50000000000002, 41.500000000000014, 31.500000000000007, -50.00000000000044, 33.30000000000003, -50.00000000000044, 19.899999999999842, 33.70000000000004, 41.100000000000016, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.10000000000004, -50.00000000000044, 36.70000000000003, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 42.900000000000006, 44.5, -50.00000000000044, -50.00000000000044, 43.10000000000001, 38.10000000000002, 42.500000000000014, 43.50000000000001, 42.900000000000006, -50.00000000000044, -50.00000000000044, 42.900000000000006, 43.50000000000001, -50.00000000000044, 31.300000000000004, 21.89999999999987, 44.900000000000006, 43.50000000000001, 9.699999999999697, 43.900000000000006, 45.5, -50.00000000000044, 24.099999999999902, -50.00000000000044, 44.5, 38.700000000000024, 9.099999999999689], "episode_lengths": [60, 268, 500, 48, 500, 474, 70, 500, 500, 90, 390, 500, 500, 74, 264, 192, 148, 48, 38, 56, 60, 132, 500, 78, 52, 36, 500, 86, 72, 54, 500, 126, 150, 54, 128, 500, 500, 500, 296, 154, 40, 500, 134, 500, 500, 82, 500, 500, 500, 176, 86, 186, 500, 168, 500, 302, 164, 90, 500, 500, 68, 500, 500, 500, 150, 500, 134, 500, 56, 500, 500, 58, 500, 72, 56, 500, 500, 70, 120, 76, 66, 72, 500, 500, 72, 66, 500, 188, 282, 52, 66, 404, 62, 46, 500, 260, 500, 56, 114, 410]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.377375618700907, "mean_inference_ms": 1.2115434605470006, "mean_action_processing_ms": 0.13861497119820954, "mean_env_wait_ms": 0.08324809042889379, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01400303840637207, "StateBufferConnector_ms": 0.0030014514923095703, "ViewRequirementAgentConnector_ms": 0.13199567794799805}}, "episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.860999999999823, "episode_len_mean": 267.02, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.10000000000001, 23.29999999999989, -50.00000000000044, 45.3, -50.00000000000044, 2.699999999999598, 43.10000000000001, -50.00000000000044, -50.00000000000044, 41.100000000000016, 11.099999999999717, -50.00000000000044, -50.00000000000044, 42.70000000000001, 23.699999999999896, 30.9, 35.30000000000004, 45.3, 46.3, 44.5, 44.10000000000001, 36.900000000000034, -50.00000000000044, 42.30000000000001, 44.900000000000006, 46.5, -50.00000000000044, 41.500000000000014, 42.900000000000006, 44.7, -50.00000000000044, 37.50000000000003, 35.10000000000004, 44.7, 37.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 20.49999999999985, 34.70000000000004, 46.099999999999994, -50.00000000000044, 36.70000000000003, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.50000000000002, 41.500000000000014, 31.500000000000007, -50.00000000000044, 33.30000000000003, -50.00000000000044, 19.899999999999842, 33.70000000000004, 41.100000000000016, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.10000000000004, -50.00000000000044, 36.70000000000003, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 42.900000000000006, 44.5, -50.00000000000044, -50.00000000000044, 43.10000000000001, 38.10000000000002, 42.500000000000014, 43.50000000000001, 42.900000000000006, -50.00000000000044, -50.00000000000044, 42.900000000000006, 43.50000000000001, -50.00000000000044, 31.300000000000004, 21.89999999999987, 44.900000000000006, 43.50000000000001, 9.699999999999697, 43.900000000000006, 45.5, -50.00000000000044, 24.099999999999902, -50.00000000000044, 44.5, 38.700000000000024, 9.099999999999689], "episode_lengths": [60, 268, 500, 48, 500, 474, 70, 500, 500, 90, 390, 500, 500, 74, 264, 192, 148, 48, 38, 56, 60, 132, 500, 78, 52, 36, 500, 86, 72, 54, 500, 126, 150, 54, 128, 500, 500, 500, 296, 154, 40, 500, 134, 500, 500, 82, 500, 500, 500, 176, 86, 186, 500, 168, 500, 302, 164, 90, 500, 500, 68, 500, 500, 500, 150, 500, 134, 500, 56, 500, 500, 58, 500, 72, 56, 500, 500, 70, 120, 76, 66, 72, 500, 500, 72, 66, 500, 188, 282, 52, 66, 404, 62, 46, 500, 260, 500, 56, 114, 410]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.377375618700907, "mean_inference_ms": 1.2115434605470006, "mean_action_processing_ms": 0.13861497119820954, "mean_env_wait_ms": 0.08324809042889379, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01400303840637207, "StateBufferConnector_ms": 0.0030014514923095703, "ViewRequirementAgentConnector_ms": 0.13199567794799805}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 924000, "num_agent_steps_trained": 924000, "num_env_steps_sampled": 924000, "num_env_steps_trained": 924000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5383.282743041963, "num_env_steps_trained_throughput_per_sec": 5383.282743041963, "timesteps_total": 924000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 924000, "timers": {"training_iteration_time_ms": 2172.897, "sample_time_ms": 1916.807, "load_time_ms": 12.37, "load_throughput": 970125.208, "learn_time_ms": 232.564, "learn_throughput": 51598.753, "synch_weights_time_ms": 9.358}, "counters": {"num_env_steps_sampled": 924000, "num_env_steps_trained": 924000, "num_agent_steps_sampled": 924000, "num_agent_steps_trained": 924000}, "done": false, "episodes_total": 3504, "training_iteration": 77, "trial_id": "9f288_00016", "date": "2023-10-25_16-54-22", "timestamp": 1698249262, "time_this_iter_s": 2.235121250152588, "time_total_s": 167.93781232833862, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 167.93781232833862, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 55.275, "ram_util_percent": 27.224999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.3234889800848445e-24, "cur_lr": 0.0003, "total_loss": 5.8312183486090765, "policy_loss": -0.0003348357147640652, "vf_loss": 5.831603262159559, "vf_explained_var": -4.172325134277344e-07, "kl": 0.0007444953978361153, "entropy": 0.49949290686183506, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1395.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 936000, "num_env_steps_trained": 936000, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.2629999999998054, "episode_len_mean": 282.96, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [36.70000000000003, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.50000000000002, 41.500000000000014, 31.500000000000007, -50.00000000000044, 33.30000000000003, -50.00000000000044, 19.899999999999842, 33.70000000000004, 41.100000000000016, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.10000000000004, -50.00000000000044, 36.70000000000003, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 42.900000000000006, 44.5, -50.00000000000044, -50.00000000000044, 43.10000000000001, 38.10000000000002, 42.500000000000014, 43.50000000000001, 42.900000000000006, -50.00000000000044, -50.00000000000044, 42.900000000000006, 43.50000000000001, -50.00000000000044, 31.300000000000004, 21.89999999999987, 44.900000000000006, 43.50000000000001, 9.699999999999697, 43.900000000000006, 45.5, -50.00000000000044, 24.099999999999902, -50.00000000000044, 44.5, 38.700000000000024, 9.099999999999689, -50.00000000000044, 45.5, 41.30000000000001, 44.5, -50.00000000000044, 0.2999999999995637, -50.00000000000044, 40.30000000000002, -50.00000000000044, 45.9, -50.00000000000044, 44.7, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 41.30000000000001, 46.3, 35.500000000000036, 29.899999999999984, 45.9, 28.09999999999996, 38.300000000000026, 18.899999999999828, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 42.70000000000001, 36.900000000000034, 41.500000000000014, -50.00000000000044, 46.9, 38.50000000000003, 34.70000000000004, 24.69999999999991, -50.00000000000044, 18.499999999999822, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [134, 500, 500, 82, 500, 500, 500, 176, 86, 186, 500, 168, 500, 302, 164, 90, 500, 500, 68, 500, 500, 500, 150, 500, 134, 500, 56, 500, 500, 58, 500, 72, 56, 500, 500, 70, 120, 76, 66, 72, 500, 500, 72, 66, 500, 188, 282, 52, 66, 404, 62, 46, 500, 260, 500, 56, 114, 410, 500, 46, 88, 56, 500, 498, 500, 98, 500, 42, 500, 54, 500, 40, 500, 500, 88, 38, 146, 202, 42, 220, 118, 312, 500, 500, 500, 80, 74, 132, 86, 500, 32, 116, 154, 254, 500, 316, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3772537773930148, "mean_inference_ms": 1.2115293547747705, "mean_action_processing_ms": 0.13865364273991582, "mean_env_wait_ms": 0.08347525783069959, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015999555587768555, "StateBufferConnector_ms": 0.003000497817993164, "ViewRequirementAgentConnector_ms": 0.1399695873260498}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.2629999999998054, "episode_len_mean": 282.96, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [36.70000000000003, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.50000000000002, 41.500000000000014, 31.500000000000007, -50.00000000000044, 33.30000000000003, -50.00000000000044, 19.899999999999842, 33.70000000000004, 41.100000000000016, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.10000000000004, -50.00000000000044, 36.70000000000003, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 42.900000000000006, 44.5, -50.00000000000044, -50.00000000000044, 43.10000000000001, 38.10000000000002, 42.500000000000014, 43.50000000000001, 42.900000000000006, -50.00000000000044, -50.00000000000044, 42.900000000000006, 43.50000000000001, -50.00000000000044, 31.300000000000004, 21.89999999999987, 44.900000000000006, 43.50000000000001, 9.699999999999697, 43.900000000000006, 45.5, -50.00000000000044, 24.099999999999902, -50.00000000000044, 44.5, 38.700000000000024, 9.099999999999689, -50.00000000000044, 45.5, 41.30000000000001, 44.5, -50.00000000000044, 0.2999999999995637, -50.00000000000044, 40.30000000000002, -50.00000000000044, 45.9, -50.00000000000044, 44.7, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 41.30000000000001, 46.3, 35.500000000000036, 29.899999999999984, 45.9, 28.09999999999996, 38.300000000000026, 18.899999999999828, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 42.70000000000001, 36.900000000000034, 41.500000000000014, -50.00000000000044, 46.9, 38.50000000000003, 34.70000000000004, 24.69999999999991, -50.00000000000044, 18.499999999999822, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [134, 500, 500, 82, 500, 500, 500, 176, 86, 186, 500, 168, 500, 302, 164, 90, 500, 500, 68, 500, 500, 500, 150, 500, 134, 500, 56, 500, 500, 58, 500, 72, 56, 500, 500, 70, 120, 76, 66, 72, 500, 500, 72, 66, 500, 188, 282, 52, 66, 404, 62, 46, 500, 260, 500, 56, 114, 410, 500, 46, 88, 56, 500, 498, 500, 98, 500, 42, 500, 54, 500, 40, 500, 500, 88, 38, 146, 202, 42, 220, 118, 312, 500, 500, 500, 80, 74, 132, 86, 500, 32, 116, 154, 254, 500, 316, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3772537773930148, "mean_inference_ms": 1.2115293547747705, "mean_action_processing_ms": 0.13865364273991582, "mean_env_wait_ms": 0.08347525783069959, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015999555587768555, "StateBufferConnector_ms": 0.003000497817993164, "ViewRequirementAgentConnector_ms": 0.1399695873260498}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000, "num_env_steps_sampled": 936000, "num_env_steps_trained": 936000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5798.358518060437, "num_env_steps_trained_throughput_per_sec": 5798.358518060437, "timesteps_total": 936000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 936000, "timers": {"training_iteration_time_ms": 2151.511, "sample_time_ms": 1909.642, "load_time_ms": 11.57, "load_throughput": 1037201.358, "learn_time_ms": 219.143, "learn_throughput": 54758.84, "synch_weights_time_ms": 9.358}, "counters": {"num_env_steps_sampled": 936000, "num_env_steps_trained": 936000, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000}, "done": false, "episodes_total": 3546, "training_iteration": 78, "trial_id": "9f288_00016", "date": "2023-10-25_16-54-24", "timestamp": 1698249264, "time_this_iter_s": 2.07454776763916, "time_total_s": 170.01236009597778, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 170.01236009597778, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 58.53333333333333, "ram_util_percent": 27.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.617444900424223e-25, "cur_lr": 0.0003, "total_loss": 6.980098300509983, "policy_loss": -7.409778320127063e-05, "vf_loss": 6.980221403969659, "vf_explained_var": -7.549921671549479e-07, "kl": 0.00015427982227972988, "entropy": 0.48977378176318276, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1413.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 948000, "num_env_steps_trained": 948000, "num_agent_steps_sampled": 948000, "num_agent_steps_trained": 948000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.8609999999997984, "episode_len_mean": 287.0, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 31.300000000000004, 21.89999999999987, 44.900000000000006, 43.50000000000001, 9.699999999999697, 43.900000000000006, 45.5, -50.00000000000044, 24.099999999999902, -50.00000000000044, 44.5, 38.700000000000024, 9.099999999999689, -50.00000000000044, 45.5, 41.30000000000001, 44.5, -50.00000000000044, 0.2999999999995637, -50.00000000000044, 40.30000000000002, -50.00000000000044, 45.9, -50.00000000000044, 44.7, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 41.30000000000001, 46.3, 35.500000000000036, 29.899999999999984, 45.9, 28.09999999999996, 38.300000000000026, 18.899999999999828, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 42.70000000000001, 36.900000000000034, 41.500000000000014, -50.00000000000044, 46.9, 38.50000000000003, 34.70000000000004, 24.69999999999991, -50.00000000000044, 18.499999999999822, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 8.099999999999675, 47.3, 14.299999999999763, 32.90000000000003, 39.70000000000002, -50.00000000000044, 16.499999999999794, -50.00000000000044, 44.10000000000001, 43.50000000000001, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 15.099999999999774, 44.300000000000004, 19.299999999999834, 45.9, 42.500000000000014, 46.099999999999994, -50.00000000000044, 29.899999999999984, 46.5, 9.699999999999697, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 14.499999999999766, -50.00000000000044, -50.00000000000044, 44.900000000000006, 41.30000000000001, 37.90000000000003], "episode_lengths": [500, 188, 282, 52, 66, 404, 62, 46, 500, 260, 500, 56, 114, 410, 500, 46, 88, 56, 500, 498, 500, 98, 500, 42, 500, 54, 500, 40, 500, 500, 88, 38, 146, 202, 42, 220, 118, 312, 500, 500, 500, 80, 74, 132, 86, 500, 32, 116, 154, 254, 500, 316, 500, 500, 500, 500, 500, 500, 420, 28, 358, 172, 104, 500, 336, 500, 60, 66, 500, 74, 500, 500, 60, 500, 350, 58, 308, 42, 76, 40, 500, 202, 36, 404, 500, 500, 28, 500, 500, 500, 500, 500, 500, 88, 356, 500, 500, 52, 88, 122]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3775188247973962, "mean_inference_ms": 1.2108760547364001, "mean_action_processing_ms": 0.13882352757540806, "mean_env_wait_ms": 0.08334073327866286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021996021270751953, "StateBufferConnector_ms": 0.003998994827270508, "ViewRequirementAgentConnector_ms": 0.12198472023010254}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.8609999999997984, "episode_len_mean": 287.0, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 31.300000000000004, 21.89999999999987, 44.900000000000006, 43.50000000000001, 9.699999999999697, 43.900000000000006, 45.5, -50.00000000000044, 24.099999999999902, -50.00000000000044, 44.5, 38.700000000000024, 9.099999999999689, -50.00000000000044, 45.5, 41.30000000000001, 44.5, -50.00000000000044, 0.2999999999995637, -50.00000000000044, 40.30000000000002, -50.00000000000044, 45.9, -50.00000000000044, 44.7, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 41.30000000000001, 46.3, 35.500000000000036, 29.899999999999984, 45.9, 28.09999999999996, 38.300000000000026, 18.899999999999828, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 42.70000000000001, 36.900000000000034, 41.500000000000014, -50.00000000000044, 46.9, 38.50000000000003, 34.70000000000004, 24.69999999999991, -50.00000000000044, 18.499999999999822, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 8.099999999999675, 47.3, 14.299999999999763, 32.90000000000003, 39.70000000000002, -50.00000000000044, 16.499999999999794, -50.00000000000044, 44.10000000000001, 43.50000000000001, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 15.099999999999774, 44.300000000000004, 19.299999999999834, 45.9, 42.500000000000014, 46.099999999999994, -50.00000000000044, 29.899999999999984, 46.5, 9.699999999999697, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 14.499999999999766, -50.00000000000044, -50.00000000000044, 44.900000000000006, 41.30000000000001, 37.90000000000003], "episode_lengths": [500, 188, 282, 52, 66, 404, 62, 46, 500, 260, 500, 56, 114, 410, 500, 46, 88, 56, 500, 498, 500, 98, 500, 42, 500, 54, 500, 40, 500, 500, 88, 38, 146, 202, 42, 220, 118, 312, 500, 500, 500, 80, 74, 132, 86, 500, 32, 116, 154, 254, 500, 316, 500, 500, 500, 500, 500, 500, 420, 28, 358, 172, 104, 500, 336, 500, 60, 66, 500, 74, 500, 500, 60, 500, 350, 58, 308, 42, 76, 40, 500, 202, 36, 404, 500, 500, 28, 500, 500, 500, 500, 500, 500, 88, 356, 500, 500, 52, 88, 122]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3775188247973962, "mean_inference_ms": 1.2108760547364001, "mean_action_processing_ms": 0.13882352757540806, "mean_env_wait_ms": 0.08334073327866286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021996021270751953, "StateBufferConnector_ms": 0.003998994827270508, "ViewRequirementAgentConnector_ms": 0.12198472023010254}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 948000, "num_agent_steps_trained": 948000, "num_env_steps_sampled": 948000, "num_env_steps_trained": 948000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5200.707678134163, "num_env_steps_trained_throughput_per_sec": 5200.707678134163, "timesteps_total": 948000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 948000, "timers": {"training_iteration_time_ms": 2178.748, "sample_time_ms": 1909.443, "load_time_ms": 12.27, "load_throughput": 978025.708, "learn_time_ms": 245.743, "learn_throughput": 48831.586, "synch_weights_time_ms": 9.592}, "counters": {"num_env_steps_sampled": 948000, "num_env_steps_trained": 948000, "num_agent_steps_sampled": 948000, "num_agent_steps_trained": 948000}, "done": false, "episodes_total": 3590, "training_iteration": 79, "trial_id": "9f288_00016", "date": "2023-10-25_16-54-27", "timestamp": 1698249267, "time_this_iter_s": 2.3129560947418213, "time_total_s": 172.3253161907196, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 172.3253161907196, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 59.199999999999996, "ram_util_percent": 27.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.3087224502121113e-25, "cur_lr": 0.0003, "total_loss": 6.318289200464885, "policy_loss": -1.3052382402949863e-05, "vf_loss": 6.318356858359443, "vf_explained_var": -7.351239522298177e-07, "kl": 0.00016544053135684558, "entropy": 0.5449836734268401, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1431.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 960000, "num_env_steps_trained": 960000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -2.31000000000022, "episode_len_mean": 303.66, "episode_media": {}, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 42.70000000000001, 36.900000000000034, 41.500000000000014, -50.00000000000044, 46.9, 38.50000000000003, 34.70000000000004, 24.69999999999991, -50.00000000000044, 18.499999999999822, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 8.099999999999675, 47.3, 14.299999999999763, 32.90000000000003, 39.70000000000002, -50.00000000000044, 16.499999999999794, -50.00000000000044, 44.10000000000001, 43.50000000000001, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 15.099999999999774, 44.300000000000004, 19.299999999999834, 45.9, 42.500000000000014, 46.099999999999994, -50.00000000000044, 29.899999999999984, 46.5, 9.699999999999697, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 14.499999999999766, -50.00000000000044, -50.00000000000044, 44.900000000000006, 41.30000000000001, 37.90000000000003, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 27.299999999999947, 7.499999999999666, 21.89999999999987, 45.3, 13.299999999999748, 47.1, 21.09999999999986, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 41.30000000000001, 36.50000000000003, 29.49999999999998, 32.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.900000000000034, 42.70000000000001, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 44.5, 33.90000000000004, 46.9, 42.30000000000001, 32.90000000000003, -50.00000000000044, 45.1], "episode_lengths": [500, 500, 500, 80, 74, 132, 86, 500, 32, 116, 154, 254, 500, 316, 500, 500, 500, 500, 500, 500, 420, 28, 358, 172, 104, 500, 336, 500, 60, 66, 500, 74, 500, 500, 60, 500, 350, 58, 308, 42, 76, 40, 500, 202, 36, 404, 500, 500, 28, 500, 500, 500, 500, 500, 500, 88, 356, 500, 500, 52, 88, 122, 500, 500, 48, 500, 228, 426, 282, 48, 368, 30, 290, 500, 500, 500, 48, 88, 136, 206, 174, 500, 500, 500, 500, 500, 500, 132, 74, 500, 500, 66, 500, 56, 162, 32, 78, 172, 500, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3775757875813372, "mean_inference_ms": 1.210167755512745, "mean_action_processing_ms": 0.1390275379954344, "mean_env_wait_ms": 0.08346093366383936, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027005434036254883, "StateBufferConnector_ms": 0.003999233245849609, "ViewRequirementAgentConnector_ms": 0.10699987411499023}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -2.31000000000022, "episode_len_mean": 303.66, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 42.70000000000001, 36.900000000000034, 41.500000000000014, -50.00000000000044, 46.9, 38.50000000000003, 34.70000000000004, 24.69999999999991, -50.00000000000044, 18.499999999999822, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 8.099999999999675, 47.3, 14.299999999999763, 32.90000000000003, 39.70000000000002, -50.00000000000044, 16.499999999999794, -50.00000000000044, 44.10000000000001, 43.50000000000001, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 15.099999999999774, 44.300000000000004, 19.299999999999834, 45.9, 42.500000000000014, 46.099999999999994, -50.00000000000044, 29.899999999999984, 46.5, 9.699999999999697, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 14.499999999999766, -50.00000000000044, -50.00000000000044, 44.900000000000006, 41.30000000000001, 37.90000000000003, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 27.299999999999947, 7.499999999999666, 21.89999999999987, 45.3, 13.299999999999748, 47.1, 21.09999999999986, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 41.30000000000001, 36.50000000000003, 29.49999999999998, 32.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.900000000000034, 42.70000000000001, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 44.5, 33.90000000000004, 46.9, 42.30000000000001, 32.90000000000003, -50.00000000000044, 45.1], "episode_lengths": [500, 500, 500, 80, 74, 132, 86, 500, 32, 116, 154, 254, 500, 316, 500, 500, 500, 500, 500, 500, 420, 28, 358, 172, 104, 500, 336, 500, 60, 66, 500, 74, 500, 500, 60, 500, 350, 58, 308, 42, 76, 40, 500, 202, 36, 404, 500, 500, 28, 500, 500, 500, 500, 500, 500, 88, 356, 500, 500, 52, 88, 122, 500, 500, 48, 500, 228, 426, 282, 48, 368, 30, 290, 500, 500, 500, 48, 88, 136, 206, 174, 500, 500, 500, 500, 500, 500, 132, 74, 500, 500, 66, 500, 56, 162, 32, 78, 172, 500, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3775757875813372, "mean_inference_ms": 1.210167755512745, "mean_action_processing_ms": 0.1390275379954344, "mean_env_wait_ms": 0.08346093366383936, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027005434036254883, "StateBufferConnector_ms": 0.003999233245849609, "ViewRequirementAgentConnector_ms": 0.10699987411499023}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000, "num_env_steps_sampled": 960000, "num_env_steps_trained": 960000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5707.34750723062, "num_env_steps_trained_throughput_per_sec": 5707.34750723062, "timesteps_total": 960000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 960000, "timers": {"training_iteration_time_ms": 2175.603, "sample_time_ms": 1905.398, "load_time_ms": 12.27, "load_throughput": 978025.708, "learn_time_ms": 246.543, "learn_throughput": 48673.121, "synch_weights_time_ms": 9.692}, "counters": {"num_env_steps_sampled": 960000, "num_env_steps_trained": 960000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "done": false, "episodes_total": 3628, "training_iteration": 80, "trial_id": "9f288_00016", "date": "2023-10-25_16-54-29", "timestamp": 1698249269, "time_this_iter_s": 2.107548475265503, "time_total_s": 174.4328646659851, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 174.4328646659851, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 58.800000000000004, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.6543612251060557e-25, "cur_lr": 0.0003, "total_loss": 7.09043632613288, "policy_loss": -2.9749443961514367e-05, "vf_loss": 7.090521335601807, "vf_explained_var": -1.026524437798394e-06, "kl": 0.0001021277812090678, "entropy": 0.5543950067626106, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1449.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 972000, "num_env_steps_trained": 972000, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.2919999999998133, "episode_len_mean": 267.68, "episode_media": {}, "episodes_this_iter": 54, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 41.30000000000001, 14.499999999999766, -50.00000000000044, -50.00000000000044, 44.900000000000006, 41.30000000000001, 37.90000000000003, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 27.299999999999947, 7.499999999999666, 21.89999999999987, 45.3, 13.299999999999748, 47.1, 21.09999999999986, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 41.30000000000001, 36.50000000000003, 29.49999999999998, 32.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.900000000000034, 42.70000000000001, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 44.5, 33.90000000000004, 46.9, 42.30000000000001, 32.90000000000003, -50.00000000000044, 45.1, -50.00000000000044, 33.10000000000003, 41.100000000000016, 47.7, -50.00000000000044, 43.50000000000001, -50.00000000000044, 40.500000000000014, 45.9, -50.00000000000044, 45.5, 44.900000000000006, 45.7, -50.00000000000044, -50.00000000000044, 45.1, 32.50000000000002, -50.00000000000044, 46.5, -50.00000000000044, 44.10000000000001, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 28.89999999999997, 44.10000000000001, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 36.900000000000034, 45.1, 42.10000000000001, 40.10000000000002, -50.00000000000044, 42.500000000000014, 44.900000000000006, -50.00000000000044, 10.099999999999703, 41.70000000000002, -50.00000000000044, 44.7, 43.30000000000001, -50.00000000000044, 44.900000000000006, 41.70000000000002, 38.50000000000003, 44.300000000000004], "episode_lengths": [500, 88, 356, 500, 500, 52, 88, 122, 500, 500, 48, 500, 228, 426, 282, 48, 368, 30, 290, 500, 500, 500, 48, 88, 136, 206, 174, 500, 500, 500, 500, 500, 500, 132, 74, 500, 500, 66, 500, 56, 162, 32, 78, 172, 500, 50, 500, 170, 90, 24, 500, 66, 500, 96, 42, 500, 46, 52, 44, 500, 500, 50, 176, 500, 36, 500, 60, 90, 500, 500, 500, 500, 34, 500, 212, 60, 500, 38, 500, 500, 500, 76, 132, 50, 80, 100, 500, 76, 52, 500, 400, 84, 500, 54, 68, 500, 52, 84, 116, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37763989281870636, "mean_inference_ms": 1.209818658493522, "mean_action_processing_ms": 0.13903852992009338, "mean_env_wait_ms": 0.08335067071209191, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03700828552246094, "StateBufferConnector_ms": 0.008003950119018555, "ViewRequirementAgentConnector_ms": 0.11700081825256348}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.2919999999998133, "episode_len_mean": 267.68, "episodes_this_iter": 54, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 41.30000000000001, 14.499999999999766, -50.00000000000044, -50.00000000000044, 44.900000000000006, 41.30000000000001, 37.90000000000003, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 27.299999999999947, 7.499999999999666, 21.89999999999987, 45.3, 13.299999999999748, 47.1, 21.09999999999986, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 41.30000000000001, 36.50000000000003, 29.49999999999998, 32.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.900000000000034, 42.70000000000001, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 44.5, 33.90000000000004, 46.9, 42.30000000000001, 32.90000000000003, -50.00000000000044, 45.1, -50.00000000000044, 33.10000000000003, 41.100000000000016, 47.7, -50.00000000000044, 43.50000000000001, -50.00000000000044, 40.500000000000014, 45.9, -50.00000000000044, 45.5, 44.900000000000006, 45.7, -50.00000000000044, -50.00000000000044, 45.1, 32.50000000000002, -50.00000000000044, 46.5, -50.00000000000044, 44.10000000000001, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 28.89999999999997, 44.10000000000001, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 36.900000000000034, 45.1, 42.10000000000001, 40.10000000000002, -50.00000000000044, 42.500000000000014, 44.900000000000006, -50.00000000000044, 10.099999999999703, 41.70000000000002, -50.00000000000044, 44.7, 43.30000000000001, -50.00000000000044, 44.900000000000006, 41.70000000000002, 38.50000000000003, 44.300000000000004], "episode_lengths": [500, 88, 356, 500, 500, 52, 88, 122, 500, 500, 48, 500, 228, 426, 282, 48, 368, 30, 290, 500, 500, 500, 48, 88, 136, 206, 174, 500, 500, 500, 500, 500, 500, 132, 74, 500, 500, 66, 500, 56, 162, 32, 78, 172, 500, 50, 500, 170, 90, 24, 500, 66, 500, 96, 42, 500, 46, 52, 44, 500, 500, 50, 176, 500, 36, 500, 60, 90, 500, 500, 500, 500, 34, 500, 212, 60, 500, 38, 500, 500, 500, 76, 132, 50, 80, 100, 500, 76, 52, 500, 400, 84, 500, 54, 68, 500, 52, 84, 116, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37763989281870636, "mean_inference_ms": 1.209818658493522, "mean_action_processing_ms": 0.13903852992009338, "mean_env_wait_ms": 0.08335067071209191, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03700828552246094, "StateBufferConnector_ms": 0.008003950119018555, "ViewRequirementAgentConnector_ms": 0.11700081825256348}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000, "num_env_steps_sampled": 972000, "num_env_steps_trained": 972000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5321.872104152595, "num_env_steps_trained_throughput_per_sec": 5321.872104152595, "timesteps_total": 972000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 972000, "timers": {"training_iteration_time_ms": 2168.559, "sample_time_ms": 1895.975, "load_time_ms": 12.27, "load_throughput": 978016.206, "learn_time_ms": 249.024, "learn_throughput": 48188.083, "synch_weights_time_ms": 9.689}, "counters": {"num_env_steps_sampled": 972000, "num_env_steps_trained": 972000, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000}, "done": false, "episodes_total": 3682, "training_iteration": 81, "trial_id": "9f288_00016", "date": "2023-10-25_16-54-31", "timestamp": 1698249271, "time_this_iter_s": 2.2598438262939453, "time_total_s": 176.69270849227905, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 176.69270849227905, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 60.5, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.271806125530278e-26, "cur_lr": 0.0003, "total_loss": 6.094558901256985, "policy_loss": -0.00017098658200767305, "vf_loss": 6.0947848955790205, "vf_explained_var": -9.967221154106987e-07, "kl": 0.0003947184250089701, "entropy": 0.5517449975013733, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1467.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 984000, "num_env_steps_trained": 984000, "num_agent_steps_sampled": 984000, "num_agent_steps_trained": 984000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.561999999999832, "episode_len_mean": 245.0, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.30000000000001, 32.90000000000003, -50.00000000000044, 45.1, -50.00000000000044, 33.10000000000003, 41.100000000000016, 47.7, -50.00000000000044, 43.50000000000001, -50.00000000000044, 40.500000000000014, 45.9, -50.00000000000044, 45.5, 44.900000000000006, 45.7, -50.00000000000044, -50.00000000000044, 45.1, 32.50000000000002, -50.00000000000044, 46.5, -50.00000000000044, 44.10000000000001, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 28.89999999999997, 44.10000000000001, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 36.900000000000034, 45.1, 42.10000000000001, 40.10000000000002, -50.00000000000044, 42.500000000000014, 44.900000000000006, -50.00000000000044, 10.099999999999703, 41.70000000000002, -50.00000000000044, 44.7, 43.30000000000001, -50.00000000000044, 44.900000000000006, 41.70000000000002, 38.50000000000003, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 44.300000000000004, 46.5, 42.900000000000006, -50.00000000000044, 42.900000000000006, 46.5, -50.00000000000044, 24.899999999999913, 33.500000000000036, 43.50000000000001, 42.500000000000014, -50.00000000000044, 44.5, 44.900000000000006, 37.90000000000003, -50.00000000000044, 24.099999999999902, -50.00000000000044, -50.00000000000044, 46.3, 45.3, 46.9, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 35.10000000000004, 35.500000000000036, 47.3, 43.900000000000006, 46.5, -50.00000000000044, -50.00000000000044, 32.700000000000024, 41.500000000000014, 43.30000000000001, -50.00000000000044], "episode_lengths": [78, 172, 500, 50, 500, 170, 90, 24, 500, 66, 500, 96, 42, 500, 46, 52, 44, 500, 500, 50, 176, 500, 36, 500, 60, 90, 500, 500, 500, 500, 34, 500, 212, 60, 500, 38, 500, 500, 500, 76, 132, 50, 80, 100, 500, 76, 52, 500, 400, 84, 500, 54, 68, 500, 52, 84, 116, 58, 500, 500, 500, 76, 500, 58, 36, 72, 500, 72, 36, 500, 252, 166, 66, 76, 500, 56, 52, 122, 500, 260, 500, 500, 38, 48, 32, 500, 64, 500, 500, 150, 146, 28, 62, 36, 500, 500, 174, 86, 68, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.377437740529042, "mean_inference_ms": 1.2104356856134748, "mean_action_processing_ms": 0.13893313900515614, "mean_env_wait_ms": 0.0833247807424671, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03200221061706543, "StateBufferConnector_ms": 0.012007474899291992, "ViewRequirementAgentConnector_ms": 0.12699675559997559}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.561999999999832, "episode_len_mean": 245.0, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.30000000000001, 32.90000000000003, -50.00000000000044, 45.1, -50.00000000000044, 33.10000000000003, 41.100000000000016, 47.7, -50.00000000000044, 43.50000000000001, -50.00000000000044, 40.500000000000014, 45.9, -50.00000000000044, 45.5, 44.900000000000006, 45.7, -50.00000000000044, -50.00000000000044, 45.1, 32.50000000000002, -50.00000000000044, 46.5, -50.00000000000044, 44.10000000000001, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 28.89999999999997, 44.10000000000001, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 36.900000000000034, 45.1, 42.10000000000001, 40.10000000000002, -50.00000000000044, 42.500000000000014, 44.900000000000006, -50.00000000000044, 10.099999999999703, 41.70000000000002, -50.00000000000044, 44.7, 43.30000000000001, -50.00000000000044, 44.900000000000006, 41.70000000000002, 38.50000000000003, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 44.300000000000004, 46.5, 42.900000000000006, -50.00000000000044, 42.900000000000006, 46.5, -50.00000000000044, 24.899999999999913, 33.500000000000036, 43.50000000000001, 42.500000000000014, -50.00000000000044, 44.5, 44.900000000000006, 37.90000000000003, -50.00000000000044, 24.099999999999902, -50.00000000000044, -50.00000000000044, 46.3, 45.3, 46.9, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 35.10000000000004, 35.500000000000036, 47.3, 43.900000000000006, 46.5, -50.00000000000044, -50.00000000000044, 32.700000000000024, 41.500000000000014, 43.30000000000001, -50.00000000000044], "episode_lengths": [78, 172, 500, 50, 500, 170, 90, 24, 500, 66, 500, 96, 42, 500, 46, 52, 44, 500, 500, 50, 176, 500, 36, 500, 60, 90, 500, 500, 500, 500, 34, 500, 212, 60, 500, 38, 500, 500, 500, 76, 132, 50, 80, 100, 500, 76, 52, 500, 400, 84, 500, 54, 68, 500, 52, 84, 116, 58, 500, 500, 500, 76, 500, 58, 36, 72, 500, 72, 36, 500, 252, 166, 66, 76, 500, 56, 52, 122, 500, 260, 500, 500, 38, 48, 32, 500, 64, 500, 500, 150, 146, 28, 62, 36, 500, 500, 174, 86, 68, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.377437740529042, "mean_inference_ms": 1.2104356856134748, "mean_action_processing_ms": 0.13893313900515614, "mean_env_wait_ms": 0.0833247807424671, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03200221061706543, "StateBufferConnector_ms": 0.012007474899291992, "ViewRequirementAgentConnector_ms": 0.12699675559997559}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 984000, "num_agent_steps_trained": 984000, "num_env_steps_sampled": 984000, "num_env_steps_trained": 984000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5688.724927565225, "num_env_steps_trained_throughput_per_sec": 5688.724927565225, "timesteps_total": 984000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 984000, "timers": {"training_iteration_time_ms": 2168.493, "sample_time_ms": 1899.375, "load_time_ms": 11.97, "load_throughput": 1002534.599, "learn_time_ms": 245.761, "learn_throughput": 48827.938, "synch_weights_time_ms": 9.786}, "counters": {"num_env_steps_sampled": 984000, "num_env_steps_trained": 984000, "num_agent_steps_sampled": 984000, "num_agent_steps_trained": 984000}, "done": false, "episodes_total": 3724, "training_iteration": 82, "trial_id": "9f288_00016", "date": "2023-10-25_16-54-33", "timestamp": 1698249273, "time_this_iter_s": 2.1144351959228516, "time_total_s": 178.8071436882019, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 178.8071436882019, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 58.6, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.135903062765139e-26, "cur_lr": 0.0003, "total_loss": 6.0668080647786455, "policy_loss": -0.0011772219505574969, "vf_loss": 6.068030251397027, "vf_explained_var": -1.7417801751030816e-06, "kl": 0.0012207524329078802, "entropy": 0.4498559253083335, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1485.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 996000, "num_env_steps_trained": 996000, "num_agent_steps_sampled": 996000, "num_agent_steps_trained": 996000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.496999999999819, "episode_len_mean": 260.64, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.500000000000014, 36.900000000000034, 45.1, 42.10000000000001, 40.10000000000002, -50.00000000000044, 42.500000000000014, 44.900000000000006, -50.00000000000044, 10.099999999999703, 41.70000000000002, -50.00000000000044, 44.7, 43.30000000000001, -50.00000000000044, 44.900000000000006, 41.70000000000002, 38.50000000000003, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 44.300000000000004, 46.5, 42.900000000000006, -50.00000000000044, 42.900000000000006, 46.5, -50.00000000000044, 24.899999999999913, 33.500000000000036, 43.50000000000001, 42.500000000000014, -50.00000000000044, 44.5, 44.900000000000006, 37.90000000000003, -50.00000000000044, 24.099999999999902, -50.00000000000044, -50.00000000000044, 46.3, 45.3, 46.9, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 35.10000000000004, 35.500000000000036, 47.3, 43.900000000000006, 46.5, -50.00000000000044, -50.00000000000044, 32.700000000000024, 41.500000000000014, 43.30000000000001, -50.00000000000044, -50.00000000000044, 44.5, 46.699999999999996, -50.00000000000044, 43.7, 21.299999999999862, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.70000000000001, -50.00000000000044, 46.3, 42.10000000000001, 43.30000000000001, 42.30000000000001, 42.10000000000001, -50.00000000000044, -50.00000000000044, 46.699999999999996, 34.30000000000004, -50.00000000000044, 3.699999999999612, -50.00000000000044, 44.300000000000004, 41.90000000000001, -50.00000000000044, -50.00000000000044, 27.299999999999947, 45.5, -50.00000000000044, 42.900000000000006, 14.499999999999766, -50.00000000000044, -50.00000000000044, 21.89999999999987, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [76, 132, 50, 80, 100, 500, 76, 52, 500, 400, 84, 500, 54, 68, 500, 52, 84, 116, 58, 500, 500, 500, 76, 500, 58, 36, 72, 500, 72, 36, 500, 252, 166, 66, 76, 500, 56, 52, 122, 500, 260, 500, 500, 38, 48, 32, 500, 64, 500, 500, 150, 146, 28, 62, 36, 500, 500, 174, 86, 68, 500, 500, 56, 34, 500, 64, 288, 500, 500, 500, 184, 500, 38, 80, 68, 78, 80, 500, 500, 34, 158, 500, 464, 500, 58, 82, 500, 500, 228, 46, 500, 72, 356, 500, 500, 282, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.377382832393911, "mean_inference_ms": 1.2108326405803245, "mean_action_processing_ms": 0.1387952125499067, "mean_env_wait_ms": 0.0833243398669826, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03400444984436035, "StateBufferConnector_ms": 0.008000612258911133, "ViewRequirementAgentConnector_ms": 0.13253545761108398}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.496999999999819, "episode_len_mean": 260.64, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.500000000000014, 36.900000000000034, 45.1, 42.10000000000001, 40.10000000000002, -50.00000000000044, 42.500000000000014, 44.900000000000006, -50.00000000000044, 10.099999999999703, 41.70000000000002, -50.00000000000044, 44.7, 43.30000000000001, -50.00000000000044, 44.900000000000006, 41.70000000000002, 38.50000000000003, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 44.300000000000004, 46.5, 42.900000000000006, -50.00000000000044, 42.900000000000006, 46.5, -50.00000000000044, 24.899999999999913, 33.500000000000036, 43.50000000000001, 42.500000000000014, -50.00000000000044, 44.5, 44.900000000000006, 37.90000000000003, -50.00000000000044, 24.099999999999902, -50.00000000000044, -50.00000000000044, 46.3, 45.3, 46.9, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 35.10000000000004, 35.500000000000036, 47.3, 43.900000000000006, 46.5, -50.00000000000044, -50.00000000000044, 32.700000000000024, 41.500000000000014, 43.30000000000001, -50.00000000000044, -50.00000000000044, 44.5, 46.699999999999996, -50.00000000000044, 43.7, 21.299999999999862, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.70000000000001, -50.00000000000044, 46.3, 42.10000000000001, 43.30000000000001, 42.30000000000001, 42.10000000000001, -50.00000000000044, -50.00000000000044, 46.699999999999996, 34.30000000000004, -50.00000000000044, 3.699999999999612, -50.00000000000044, 44.300000000000004, 41.90000000000001, -50.00000000000044, -50.00000000000044, 27.299999999999947, 45.5, -50.00000000000044, 42.900000000000006, 14.499999999999766, -50.00000000000044, -50.00000000000044, 21.89999999999987, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [76, 132, 50, 80, 100, 500, 76, 52, 500, 400, 84, 500, 54, 68, 500, 52, 84, 116, 58, 500, 500, 500, 76, 500, 58, 36, 72, 500, 72, 36, 500, 252, 166, 66, 76, 500, 56, 52, 122, 500, 260, 500, 500, 38, 48, 32, 500, 64, 500, 500, 150, 146, 28, 62, 36, 500, 500, 174, 86, 68, 500, 500, 56, 34, 500, 64, 288, 500, 500, 500, 184, 500, 38, 80, 68, 78, 80, 500, 500, 34, 158, 500, 464, 500, 58, 82, 500, 500, 228, 46, 500, 72, 356, 500, 500, 282, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.377382832393911, "mean_inference_ms": 1.2108326405803245, "mean_action_processing_ms": 0.1387952125499067, "mean_env_wait_ms": 0.0833243398669826, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03400444984436035, "StateBufferConnector_ms": 0.008000612258911133, "ViewRequirementAgentConnector_ms": 0.13253545761108398}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 996000, "num_agent_steps_trained": 996000, "num_env_steps_sampled": 996000, "num_env_steps_trained": 996000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5528.3076770994085, "num_env_steps_trained_throughput_per_sec": 5528.3076770994085, "timesteps_total": 996000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 996000, "timers": {"training_iteration_time_ms": 2165.114, "sample_time_ms": 1898.727, "load_time_ms": 11.4, "load_throughput": 1052663.845, "learn_time_ms": 243.541, "learn_throughput": 49272.969, "synch_weights_time_ms": 9.867}, "counters": {"num_env_steps_sampled": 996000, "num_env_steps_trained": 996000, "num_agent_steps_sampled": 996000, "num_agent_steps_trained": 996000}, "done": false, "episodes_total": 3763, "training_iteration": 83, "trial_id": "9f288_00016", "date": "2023-10-25_16-54-35", "timestamp": 1698249275, "time_this_iter_s": 2.1758692264556885, "time_total_s": 180.9830129146576, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 180.9830129146576, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 60.800000000000004, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.0679515313825696e-26, "cur_lr": 0.0003, "total_loss": 6.270236889521281, "policy_loss": -0.00027326887680424587, "vf_loss": 6.270555231306288, "vf_explained_var": -1.2119611104329426e-06, "kl": 0.0005902502319846311, "entropy": 0.4500812490781148, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1503.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1008000, "num_env_steps_trained": 1008000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -2.8630000000002194, "episode_len_mean": 294.16, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 46.3, 45.3, 46.9, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 35.10000000000004, 35.500000000000036, 47.3, 43.900000000000006, 46.5, -50.00000000000044, -50.00000000000044, 32.700000000000024, 41.500000000000014, 43.30000000000001, -50.00000000000044, -50.00000000000044, 44.5, 46.699999999999996, -50.00000000000044, 43.7, 21.299999999999862, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.70000000000001, -50.00000000000044, 46.3, 42.10000000000001, 43.30000000000001, 42.30000000000001, 42.10000000000001, -50.00000000000044, -50.00000000000044, 46.699999999999996, 34.30000000000004, -50.00000000000044, 3.699999999999612, -50.00000000000044, 44.300000000000004, 41.90000000000001, -50.00000000000044, -50.00000000000044, 27.299999999999947, 45.5, -50.00000000000044, 42.900000000000006, 14.499999999999766, -50.00000000000044, -50.00000000000044, 21.89999999999987, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 46.099999999999994, 42.900000000000006, -50.00000000000044, 42.30000000000001, 39.50000000000002, 46.9, 28.499999999999964, -50.00000000000044, 46.5, -50.00000000000044, 43.30000000000001, -50.00000000000044, 35.900000000000034, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 4.099999999999618, -50.00000000000044, -50.00000000000044, 44.5, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 44.7, -50.00000000000044, 21.09999999999986, -50.00000000000044, 45.5, -50.00000000000044, 29.099999999999973, -50.00000000000044, 43.30000000000001], "episode_lengths": [500, 500, 38, 48, 32, 500, 64, 500, 500, 150, 146, 28, 62, 36, 500, 500, 174, 86, 68, 500, 500, 56, 34, 500, 64, 288, 500, 500, 500, 184, 500, 38, 80, 68, 78, 80, 500, 500, 34, 158, 500, 464, 500, 58, 82, 500, 500, 228, 46, 500, 72, 356, 500, 500, 282, 500, 500, 500, 500, 82, 500, 40, 72, 500, 78, 106, 32, 216, 500, 36, 500, 68, 500, 142, 500, 28, 500, 500, 42, 500, 460, 500, 500, 56, 62, 500, 500, 500, 500, 46, 500, 54, 500, 290, 500, 46, 500, 210, 500, 68]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3769152781391076, "mean_inference_ms": 1.2103983249602128, "mean_action_processing_ms": 0.1388952207040705, "mean_env_wait_ms": 0.08326835159482388, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028998613357543945, "StateBufferConnector_ms": 0.006999969482421875, "ViewRequirementAgentConnector_ms": 0.12654781341552734}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -2.8630000000002194, "episode_len_mean": 294.16, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 46.3, 45.3, 46.9, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 35.10000000000004, 35.500000000000036, 47.3, 43.900000000000006, 46.5, -50.00000000000044, -50.00000000000044, 32.700000000000024, 41.500000000000014, 43.30000000000001, -50.00000000000044, -50.00000000000044, 44.5, 46.699999999999996, -50.00000000000044, 43.7, 21.299999999999862, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.70000000000001, -50.00000000000044, 46.3, 42.10000000000001, 43.30000000000001, 42.30000000000001, 42.10000000000001, -50.00000000000044, -50.00000000000044, 46.699999999999996, 34.30000000000004, -50.00000000000044, 3.699999999999612, -50.00000000000044, 44.300000000000004, 41.90000000000001, -50.00000000000044, -50.00000000000044, 27.299999999999947, 45.5, -50.00000000000044, 42.900000000000006, 14.499999999999766, -50.00000000000044, -50.00000000000044, 21.89999999999987, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 46.099999999999994, 42.900000000000006, -50.00000000000044, 42.30000000000001, 39.50000000000002, 46.9, 28.499999999999964, -50.00000000000044, 46.5, -50.00000000000044, 43.30000000000001, -50.00000000000044, 35.900000000000034, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 4.099999999999618, -50.00000000000044, -50.00000000000044, 44.5, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 44.7, -50.00000000000044, 21.09999999999986, -50.00000000000044, 45.5, -50.00000000000044, 29.099999999999973, -50.00000000000044, 43.30000000000001], "episode_lengths": [500, 500, 38, 48, 32, 500, 64, 500, 500, 150, 146, 28, 62, 36, 500, 500, 174, 86, 68, 500, 500, 56, 34, 500, 64, 288, 500, 500, 500, 184, 500, 38, 80, 68, 78, 80, 500, 500, 34, 158, 500, 464, 500, 58, 82, 500, 500, 228, 46, 500, 72, 356, 500, 500, 282, 500, 500, 500, 500, 82, 500, 40, 72, 500, 78, 106, 32, 216, 500, 36, 500, 68, 500, 142, 500, 28, 500, 500, 42, 500, 460, 500, 500, 56, 62, 500, 500, 500, 500, 46, 500, 54, 500, 290, 500, 46, 500, 210, 500, 68]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3769152781391076, "mean_inference_ms": 1.2103983249602128, "mean_action_processing_ms": 0.1388952207040705, "mean_env_wait_ms": 0.08326835159482388, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028998613357543945, "StateBufferConnector_ms": 0.006999969482421875, "ViewRequirementAgentConnector_ms": 0.12654781341552734}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000, "num_env_steps_sampled": 1008000, "num_env_steps_trained": 1008000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5740.190360970082, "num_env_steps_trained_throughput_per_sec": 5740.190360970082, "timesteps_total": 1008000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1008000, "timers": {"training_iteration_time_ms": 2163.422, "sample_time_ms": 1897.135, "load_time_ms": 11.2, "load_throughput": 1071460.613, "learn_time_ms": 243.441, "learn_throughput": 49293.251, "synch_weights_time_ms": 10.167}, "counters": {"num_env_steps_sampled": 1008000, "num_env_steps_trained": 1008000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "done": false, "episodes_total": 3804, "training_iteration": 84, "trial_id": "9f288_00016", "date": "2023-10-25_16-54-37", "timestamp": 1698249277, "time_this_iter_s": 2.095520496368408, "time_total_s": 183.078533411026, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 183.078533411026, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 57.70000000000001, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.0339757656912848e-26, "cur_lr": 0.0003, "total_loss": 6.9362996684180365, "policy_loss": -0.00035491844432221516, "vf_loss": 6.936704556147258, "vf_explained_var": -1.1722246805826824e-06, "kl": 0.0010534990458508117, "entropy": 0.5006393392880758, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1521.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1020000, "num_env_steps_trained": 1020000, "num_agent_steps_sampled": 1020000, "num_agent_steps_trained": 1020000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.32199999999979456, "episode_len_mean": 277.34, "episode_media": {}, "episodes_this_iter": 54, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.89999999999987, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 46.099999999999994, 42.900000000000006, -50.00000000000044, 42.30000000000001, 39.50000000000002, 46.9, 28.499999999999964, -50.00000000000044, 46.5, -50.00000000000044, 43.30000000000001, -50.00000000000044, 35.900000000000034, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 4.099999999999618, -50.00000000000044, -50.00000000000044, 44.5, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 44.7, -50.00000000000044, 21.09999999999986, -50.00000000000044, 45.5, -50.00000000000044, 29.099999999999973, -50.00000000000044, 43.30000000000001, -50.00000000000044, 11.29999999999972, 45.5, 46.5, 32.30000000000002, 45.9, 41.70000000000002, -50.00000000000044, 44.5, 44.7, 47.7, 44.5, 42.30000000000001, 45.3, 43.7, -50.00000000000044, 44.900000000000006, -50.00000000000044, 45.9, 38.50000000000003, 43.900000000000006, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 44.10000000000001, 40.70000000000002, -50.00000000000044, 46.3, 9.8999999999997, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 46.3, 24.299999999999905, 44.300000000000004, -50.00000000000044, -50.00000000000044, 34.900000000000034, -50.00000000000044, 37.90000000000003, -50.00000000000044, 45.9, 40.10000000000002, -50.00000000000044, 35.10000000000004, 43.7], "episode_lengths": [282, 500, 500, 500, 500, 82, 500, 40, 72, 500, 78, 106, 32, 216, 500, 36, 500, 68, 500, 142, 500, 28, 500, 500, 42, 500, 460, 500, 500, 56, 62, 500, 500, 500, 500, 46, 500, 54, 500, 290, 500, 46, 500, 210, 500, 68, 500, 388, 46, 36, 178, 42, 84, 500, 56, 54, 24, 56, 78, 48, 64, 500, 52, 500, 42, 116, 62, 500, 500, 66, 500, 500, 500, 34, 60, 94, 500, 38, 402, 500, 500, 54, 500, 60, 500, 500, 38, 258, 58, 500, 500, 152, 500, 122, 500, 42, 100, 500, 150, 64]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3768596808069154, "mean_inference_ms": 1.2101793920434507, "mean_action_processing_ms": 0.1391357969285367, "mean_env_wait_ms": 0.08315586230039107, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022993087768554688, "StateBufferConnector_ms": 0.002999544143676758, "ViewRequirementAgentConnector_ms": 0.12102580070495605}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.32199999999979456, "episode_len_mean": 277.34, "episodes_this_iter": 54, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.89999999999987, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 46.099999999999994, 42.900000000000006, -50.00000000000044, 42.30000000000001, 39.50000000000002, 46.9, 28.499999999999964, -50.00000000000044, 46.5, -50.00000000000044, 43.30000000000001, -50.00000000000044, 35.900000000000034, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 4.099999999999618, -50.00000000000044, -50.00000000000044, 44.5, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 44.7, -50.00000000000044, 21.09999999999986, -50.00000000000044, 45.5, -50.00000000000044, 29.099999999999973, -50.00000000000044, 43.30000000000001, -50.00000000000044, 11.29999999999972, 45.5, 46.5, 32.30000000000002, 45.9, 41.70000000000002, -50.00000000000044, 44.5, 44.7, 47.7, 44.5, 42.30000000000001, 45.3, 43.7, -50.00000000000044, 44.900000000000006, -50.00000000000044, 45.9, 38.50000000000003, 43.900000000000006, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 44.10000000000001, 40.70000000000002, -50.00000000000044, 46.3, 9.8999999999997, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 46.3, 24.299999999999905, 44.300000000000004, -50.00000000000044, -50.00000000000044, 34.900000000000034, -50.00000000000044, 37.90000000000003, -50.00000000000044, 45.9, 40.10000000000002, -50.00000000000044, 35.10000000000004, 43.7], "episode_lengths": [282, 500, 500, 500, 500, 82, 500, 40, 72, 500, 78, 106, 32, 216, 500, 36, 500, 68, 500, 142, 500, 28, 500, 500, 42, 500, 460, 500, 500, 56, 62, 500, 500, 500, 500, 46, 500, 54, 500, 290, 500, 46, 500, 210, 500, 68, 500, 388, 46, 36, 178, 42, 84, 500, 56, 54, 24, 56, 78, 48, 64, 500, 52, 500, 42, 116, 62, 500, 500, 66, 500, 500, 500, 34, 60, 94, 500, 38, 402, 500, 500, 54, 500, 60, 500, 500, 38, 258, 58, 500, 500, 152, 500, 122, 500, 42, 100, 500, 150, 64]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3768596808069154, "mean_inference_ms": 1.2101793920434507, "mean_action_processing_ms": 0.1391357969285367, "mean_env_wait_ms": 0.08315586230039107, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022993087768554688, "StateBufferConnector_ms": 0.002999544143676758, "ViewRequirementAgentConnector_ms": 0.12102580070495605}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1020000, "num_agent_steps_trained": 1020000, "num_env_steps_sampled": 1020000, "num_env_steps_trained": 1020000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5269.607338638086, "num_env_steps_trained_throughput_per_sec": 5269.607338638086, "timesteps_total": 1020000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1020000, "timers": {"training_iteration_time_ms": 2170.338, "sample_time_ms": 1903.912, "load_time_ms": 11.7, "load_throughput": 1025669.384, "learn_time_ms": 243.477, "learn_throughput": 49285.914, "synch_weights_time_ms": 9.77}, "counters": {"num_env_steps_sampled": 1020000, "num_env_steps_trained": 1020000, "num_agent_steps_sampled": 1020000, "num_agent_steps_trained": 1020000}, "done": false, "episodes_total": 3858, "training_iteration": 85, "trial_id": "9f288_00016", "date": "2023-10-25_16-54-40", "timestamp": 1698249280, "time_this_iter_s": 2.282262086868286, "time_total_s": 185.3607954978943, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 185.3607954978943, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 60.63333333333333, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.169878828456424e-27, "cur_lr": 0.0003, "total_loss": 6.32855502764384, "policy_loss": -0.00021704410513242087, "vf_loss": 6.328816678788927, "vf_explained_var": -9.669197930230034e-07, "kl": 0.00034701286542965844, "entropy": 0.4445076402690675, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1539.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1032000, "num_env_steps_trained": 1032000, "num_agent_steps_sampled": 1032000, "num_agent_steps_trained": 1032000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.866999999999822, "episode_len_mean": 246.94, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 11.29999999999972, 45.5, 46.5, 32.30000000000002, 45.9, 41.70000000000002, -50.00000000000044, 44.5, 44.7, 47.7, 44.5, 42.30000000000001, 45.3, 43.7, -50.00000000000044, 44.900000000000006, -50.00000000000044, 45.9, 38.50000000000003, 43.900000000000006, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 44.10000000000001, 40.70000000000002, -50.00000000000044, 46.3, 9.8999999999997, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 46.3, 24.299999999999905, 44.300000000000004, -50.00000000000044, -50.00000000000044, 34.900000000000034, -50.00000000000044, 37.90000000000003, -50.00000000000044, 45.9, 40.10000000000002, -50.00000000000044, 35.10000000000004, 43.7, -50.00000000000044, 46.5, 46.5, -50.00000000000044, 44.300000000000004, 44.7, 46.699999999999996, 28.29999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 41.90000000000001, 44.5, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 46.099999999999994, 41.100000000000016, -50.00000000000044, 45.7, 47.7, -50.00000000000044, 44.7, 42.70000000000001, 27.299999999999947, 45.5, 46.9, -50.00000000000044, 43.900000000000006, 46.3, -50.00000000000044, 45.7, 28.89999999999997, 44.900000000000006, -50.00000000000044, -50.00000000000044, 41.90000000000001, 44.7], "episode_lengths": [500, 388, 46, 36, 178, 42, 84, 500, 56, 54, 24, 56, 78, 48, 64, 500, 52, 500, 42, 116, 62, 500, 500, 66, 500, 500, 500, 34, 60, 94, 500, 38, 402, 500, 500, 54, 500, 60, 500, 500, 38, 258, 58, 500, 500, 152, 500, 122, 500, 42, 100, 500, 150, 64, 500, 36, 36, 500, 58, 54, 34, 218, 500, 500, 500, 500, 74, 82, 56, 500, 500, 62, 500, 500, 500, 500, 500, 90, 40, 90, 500, 44, 24, 500, 54, 74, 228, 46, 32, 500, 62, 38, 500, 44, 212, 52, 500, 500, 82, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.376872519076643, "mean_inference_ms": 1.2103650567337279, "mean_action_processing_ms": 0.13906026576829764, "mean_env_wait_ms": 0.08319092012061721, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03099846839904785, "StateBufferConnector_ms": 0.0050013065338134766, "ViewRequirementAgentConnector_ms": 0.1340043544769287}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.866999999999822, "episode_len_mean": 246.94, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 11.29999999999972, 45.5, 46.5, 32.30000000000002, 45.9, 41.70000000000002, -50.00000000000044, 44.5, 44.7, 47.7, 44.5, 42.30000000000001, 45.3, 43.7, -50.00000000000044, 44.900000000000006, -50.00000000000044, 45.9, 38.50000000000003, 43.900000000000006, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 44.10000000000001, 40.70000000000002, -50.00000000000044, 46.3, 9.8999999999997, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 46.3, 24.299999999999905, 44.300000000000004, -50.00000000000044, -50.00000000000044, 34.900000000000034, -50.00000000000044, 37.90000000000003, -50.00000000000044, 45.9, 40.10000000000002, -50.00000000000044, 35.10000000000004, 43.7, -50.00000000000044, 46.5, 46.5, -50.00000000000044, 44.300000000000004, 44.7, 46.699999999999996, 28.29999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 41.90000000000001, 44.5, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 46.099999999999994, 41.100000000000016, -50.00000000000044, 45.7, 47.7, -50.00000000000044, 44.7, 42.70000000000001, 27.299999999999947, 45.5, 46.9, -50.00000000000044, 43.900000000000006, 46.3, -50.00000000000044, 45.7, 28.89999999999997, 44.900000000000006, -50.00000000000044, -50.00000000000044, 41.90000000000001, 44.7], "episode_lengths": [500, 388, 46, 36, 178, 42, 84, 500, 56, 54, 24, 56, 78, 48, 64, 500, 52, 500, 42, 116, 62, 500, 500, 66, 500, 500, 500, 34, 60, 94, 500, 38, 402, 500, 500, 54, 500, 60, 500, 500, 38, 258, 58, 500, 500, 152, 500, 122, 500, 42, 100, 500, 150, 64, 500, 36, 36, 500, 58, 54, 34, 218, 500, 500, 500, 500, 74, 82, 56, 500, 500, 62, 500, 500, 500, 500, 500, 90, 40, 90, 500, 44, 24, 500, 54, 74, 228, 46, 32, 500, 62, 38, 500, 44, 212, 52, 500, 500, 82, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.376872519076643, "mean_inference_ms": 1.2103650567337279, "mean_action_processing_ms": 0.13906026576829764, "mean_env_wait_ms": 0.08319092012061721, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03099846839904785, "StateBufferConnector_ms": 0.0050013065338134766, "ViewRequirementAgentConnector_ms": 0.1340043544769287}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1032000, "num_agent_steps_trained": 1032000, "num_env_steps_sampled": 1032000, "num_env_steps_trained": 1032000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5581.34620590113, "num_env_steps_trained_throughput_per_sec": 5581.34620590113, "timesteps_total": 1032000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1032000, "timers": {"training_iteration_time_ms": 2176.128, "sample_time_ms": 1905.79, "load_time_ms": 12.0, "load_throughput": 1000020.822, "learn_time_ms": 246.89, "learn_throughput": 48604.666, "synch_weights_time_ms": 9.87}, "counters": {"num_env_steps_sampled": 1032000, "num_env_steps_trained": 1032000, "num_agent_steps_sampled": 1032000, "num_agent_steps_trained": 1032000}, "done": false, "episodes_total": 3904, "training_iteration": 86, "trial_id": "9f288_00016", "date": "2023-10-25_16-54-42", "timestamp": 1698249282, "time_this_iter_s": 2.1550159454345703, "time_total_s": 187.51581144332886, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 187.51581144332886, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 55.366666666666674, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.584939414228212e-27, "cur_lr": 0.0003, "total_loss": 5.989149358537462, "policy_loss": -0.0002678397835956679, "vf_loss": 5.989467965232001, "vf_explained_var": -9.106265174018013e-07, "kl": 0.000503117984741329, "entropy": 0.5065065821011862, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1557.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1044000, "num_env_steps_trained": 1044000, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.5039999999998255, "episode_len_mean": 245.58, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 34.900000000000034, -50.00000000000044, 37.90000000000003, -50.00000000000044, 45.9, 40.10000000000002, -50.00000000000044, 35.10000000000004, 43.7, -50.00000000000044, 46.5, 46.5, -50.00000000000044, 44.300000000000004, 44.7, 46.699999999999996, 28.29999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 41.90000000000001, 44.5, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 46.099999999999994, 41.100000000000016, -50.00000000000044, 45.7, 47.7, -50.00000000000044, 44.7, 42.70000000000001, 27.299999999999947, 45.5, 46.9, -50.00000000000044, 43.900000000000006, 46.3, -50.00000000000044, 45.7, 28.89999999999997, 44.900000000000006, -50.00000000000044, -50.00000000000044, 41.90000000000001, 44.7, 43.50000000000001, -50.00000000000044, 45.9, 47.1, -50.00000000000044, 3.0999999999996035, -50.00000000000044, 46.3, -50.00000000000044, 45.3, -50.00000000000044, 30.499999999999993, 43.7, -50.00000000000044, 46.699999999999996, 47.3, 44.5, 42.500000000000014, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 47.7, 21.299999999999862, 46.099999999999994, 44.300000000000004, 36.30000000000003, 43.30000000000001, -50.00000000000044, 44.7, -50.00000000000044, 36.50000000000003, 19.69999999999984, 43.30000000000001, -50.00000000000044, 42.900000000000006, -50.00000000000044, 44.5, 46.3, 40.30000000000002, 20.899999999999856], "episode_lengths": [500, 152, 500, 122, 500, 42, 100, 500, 150, 64, 500, 36, 36, 500, 58, 54, 34, 218, 500, 500, 500, 500, 74, 82, 56, 500, 500, 62, 500, 500, 500, 500, 500, 90, 40, 90, 500, 44, 24, 500, 54, 74, 228, 46, 32, 500, 62, 38, 500, 44, 212, 52, 500, 500, 82, 54, 66, 500, 42, 30, 500, 470, 500, 38, 500, 48, 500, 196, 64, 500, 34, 28, 56, 76, 500, 30, 500, 500, 40, 500, 500, 24, 288, 40, 58, 138, 68, 500, 54, 500, 136, 304, 68, 500, 72, 500, 56, 38, 98, 292]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37746344517506386, "mean_inference_ms": 1.2112807247614945, "mean_action_processing_ms": 0.1388624219098013, "mean_env_wait_ms": 0.08340804930754014, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03801727294921875, "StateBufferConnector_ms": 0.01099848747253418, "ViewRequirementAgentConnector_ms": 0.13499927520751953}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.5039999999998255, "episode_len_mean": 245.58, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 34.900000000000034, -50.00000000000044, 37.90000000000003, -50.00000000000044, 45.9, 40.10000000000002, -50.00000000000044, 35.10000000000004, 43.7, -50.00000000000044, 46.5, 46.5, -50.00000000000044, 44.300000000000004, 44.7, 46.699999999999996, 28.29999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 41.90000000000001, 44.5, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 46.099999999999994, 41.100000000000016, -50.00000000000044, 45.7, 47.7, -50.00000000000044, 44.7, 42.70000000000001, 27.299999999999947, 45.5, 46.9, -50.00000000000044, 43.900000000000006, 46.3, -50.00000000000044, 45.7, 28.89999999999997, 44.900000000000006, -50.00000000000044, -50.00000000000044, 41.90000000000001, 44.7, 43.50000000000001, -50.00000000000044, 45.9, 47.1, -50.00000000000044, 3.0999999999996035, -50.00000000000044, 46.3, -50.00000000000044, 45.3, -50.00000000000044, 30.499999999999993, 43.7, -50.00000000000044, 46.699999999999996, 47.3, 44.5, 42.500000000000014, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 47.7, 21.299999999999862, 46.099999999999994, 44.300000000000004, 36.30000000000003, 43.30000000000001, -50.00000000000044, 44.7, -50.00000000000044, 36.50000000000003, 19.69999999999984, 43.30000000000001, -50.00000000000044, 42.900000000000006, -50.00000000000044, 44.5, 46.3, 40.30000000000002, 20.899999999999856], "episode_lengths": [500, 152, 500, 122, 500, 42, 100, 500, 150, 64, 500, 36, 36, 500, 58, 54, 34, 218, 500, 500, 500, 500, 74, 82, 56, 500, 500, 62, 500, 500, 500, 500, 500, 90, 40, 90, 500, 44, 24, 500, 54, 74, 228, 46, 32, 500, 62, 38, 500, 44, 212, 52, 500, 500, 82, 54, 66, 500, 42, 30, 500, 470, 500, 38, 500, 48, 500, 196, 64, 500, 34, 28, 56, 76, 500, 30, 500, 500, 40, 500, 500, 24, 288, 40, 58, 138, 68, 500, 54, 500, 136, 304, 68, 500, 72, 500, 56, 38, 98, 292]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37746344517506386, "mean_inference_ms": 1.2112807247614945, "mean_action_processing_ms": 0.1388624219098013, "mean_env_wait_ms": 0.08340804930754014, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03801727294921875, "StateBufferConnector_ms": 0.01099848747253418, "ViewRequirementAgentConnector_ms": 0.13499927520751953}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000, "num_env_steps_sampled": 1044000, "num_env_steps_trained": 1044000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5008.766597029211, "num_env_steps_trained_throughput_per_sec": 5008.766597029211, "timesteps_total": 1044000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1044000, "timers": {"training_iteration_time_ms": 2192.796, "sample_time_ms": 1922.86, "load_time_ms": 12.21, "load_throughput": 982830.765, "learn_time_ms": 246.335, "learn_throughput": 48714.195, "synch_weights_time_ms": 9.913}, "counters": {"num_env_steps_sampled": 1044000, "num_env_steps_trained": 1044000, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000}, "done": false, "episodes_total": 3948, "training_iteration": 87, "trial_id": "9f288_00016", "date": "2023-10-25_16-54-44", "timestamp": 1698249284, "time_this_iter_s": 2.40179705619812, "time_total_s": 189.91760849952698, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 189.91760849952698, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 60.325, "ram_util_percent": 27.224999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.292469707114106e-27, "cur_lr": 0.0003, "total_loss": 6.199145820405748, "policy_loss": -0.0001038530608639121, "vf_loss": 6.199301719665527, "vf_explained_var": -1.284811231825087e-06, "kl": 0.00035970114092581044, "entropy": 0.5183491475052304, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1575.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1056000, "num_env_steps_trained": 1056000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.372999999999829, "episode_len_mean": 241.9, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 41.90000000000001, 44.7, 43.50000000000001, -50.00000000000044, 45.9, 47.1, -50.00000000000044, 3.0999999999996035, -50.00000000000044, 46.3, -50.00000000000044, 45.3, -50.00000000000044, 30.499999999999993, 43.7, -50.00000000000044, 46.699999999999996, 47.3, 44.5, 42.500000000000014, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 47.7, 21.299999999999862, 46.099999999999994, 44.300000000000004, 36.30000000000003, 43.30000000000001, -50.00000000000044, 44.7, -50.00000000000044, 36.50000000000003, 19.69999999999984, 43.30000000000001, -50.00000000000044, 42.900000000000006, -50.00000000000044, 44.5, 46.3, 40.30000000000002, 20.899999999999856, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.70000000000003, -50.00000000000044, 46.5, 44.900000000000006, 47.5, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 45.7, 46.5, 45.7, 45.9, 44.900000000000006, -50.00000000000044, 42.900000000000006, 36.30000000000003, -50.00000000000044, 26.89999999999994, 38.700000000000024, 46.5, 12.499999999999737, 41.70000000000002, 44.300000000000004, -50.00000000000044, 46.3, 40.70000000000002, -50.00000000000044, 43.50000000000001, 46.5, 42.900000000000006, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 44.300000000000004, 45.3, 45.9, -50.00000000000044, -50.00000000000044, 38.90000000000002, 42.70000000000001, -50.00000000000044, 45.7, 34.900000000000034, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044], "episode_lengths": [500, 500, 82, 54, 66, 500, 42, 30, 500, 470, 500, 38, 500, 48, 500, 196, 64, 500, 34, 28, 56, 76, 500, 30, 500, 500, 40, 500, 500, 24, 288, 40, 58, 138, 68, 500, 54, 500, 136, 304, 68, 500, 72, 500, 56, 38, 98, 292, 500, 500, 500, 134, 500, 36, 52, 26, 500, 54, 500, 500, 44, 36, 44, 42, 52, 500, 72, 138, 500, 232, 114, 36, 376, 84, 58, 500, 38, 94, 500, 66, 36, 72, 500, 52, 500, 500, 58, 48, 42, 500, 500, 112, 74, 500, 44, 152, 500, 500, 84, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3775278507163721, "mean_inference_ms": 1.2115265706898928, "mean_action_processing_ms": 0.13903185888799077, "mean_env_wait_ms": 0.0834337752061092, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031029462814331055, "StateBufferConnector_ms": 0.008994579315185547, "ViewRequirementAgentConnector_ms": 0.12332916259765625}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.372999999999829, "episode_len_mean": 241.9, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 41.90000000000001, 44.7, 43.50000000000001, -50.00000000000044, 45.9, 47.1, -50.00000000000044, 3.0999999999996035, -50.00000000000044, 46.3, -50.00000000000044, 45.3, -50.00000000000044, 30.499999999999993, 43.7, -50.00000000000044, 46.699999999999996, 47.3, 44.5, 42.500000000000014, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 47.7, 21.299999999999862, 46.099999999999994, 44.300000000000004, 36.30000000000003, 43.30000000000001, -50.00000000000044, 44.7, -50.00000000000044, 36.50000000000003, 19.69999999999984, 43.30000000000001, -50.00000000000044, 42.900000000000006, -50.00000000000044, 44.5, 46.3, 40.30000000000002, 20.899999999999856, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.70000000000003, -50.00000000000044, 46.5, 44.900000000000006, 47.5, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 45.7, 46.5, 45.7, 45.9, 44.900000000000006, -50.00000000000044, 42.900000000000006, 36.30000000000003, -50.00000000000044, 26.89999999999994, 38.700000000000024, 46.5, 12.499999999999737, 41.70000000000002, 44.300000000000004, -50.00000000000044, 46.3, 40.70000000000002, -50.00000000000044, 43.50000000000001, 46.5, 42.900000000000006, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 44.300000000000004, 45.3, 45.9, -50.00000000000044, -50.00000000000044, 38.90000000000002, 42.70000000000001, -50.00000000000044, 45.7, 34.900000000000034, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044], "episode_lengths": [500, 500, 82, 54, 66, 500, 42, 30, 500, 470, 500, 38, 500, 48, 500, 196, 64, 500, 34, 28, 56, 76, 500, 30, 500, 500, 40, 500, 500, 24, 288, 40, 58, 138, 68, 500, 54, 500, 136, 304, 68, 500, 72, 500, 56, 38, 98, 292, 500, 500, 500, 134, 500, 36, 52, 26, 500, 54, 500, 500, 44, 36, 44, 42, 52, 500, 72, 138, 500, 232, 114, 36, 376, 84, 58, 500, 38, 94, 500, 66, 36, 72, 500, 52, 500, 500, 58, 48, 42, 500, 500, 112, 74, 500, 44, 152, 500, 500, 84, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3775278507163721, "mean_inference_ms": 1.2115265706898928, "mean_action_processing_ms": 0.13903185888799077, "mean_env_wait_ms": 0.0834337752061092, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031029462814331055, "StateBufferConnector_ms": 0.008994579315185547, "ViewRequirementAgentConnector_ms": 0.12332916259765625}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000, "num_env_steps_sampled": 1056000, "num_env_steps_trained": 1056000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5668.8261487754025, "num_env_steps_trained_throughput_per_sec": 5668.8261487754025, "timesteps_total": 1056000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1056000, "timers": {"training_iteration_time_ms": 2197.525, "sample_time_ms": 1927.46, "load_time_ms": 12.309, "load_throughput": 974867.865, "learn_time_ms": 246.467, "learn_throughput": 48688.089, "synch_weights_time_ms": 9.81}, "counters": {"num_env_steps_sampled": 1056000, "num_env_steps_trained": 1056000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "done": false, "episodes_total": 4000, "training_iteration": 88, "trial_id": "9f288_00016", "date": "2023-10-25_16-54-47", "timestamp": 1698249287, "time_this_iter_s": 2.1218457221984863, "time_total_s": 192.03945422172546, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 192.03945422172546, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 60.5, "ram_util_percent": 27.266666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.46234853557053e-28, "cur_lr": 0.0003, "total_loss": 5.93081095483568, "policy_loss": 2.5012219945589702e-05, "vf_loss": 5.930832677417332, "vf_explained_var": -1.2516975402832031e-06, "kl": 0.00016117003721167263, "entropy": 0.46741557783550686, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1593.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1068000, "num_env_steps_trained": 1068000, "num_agent_steps_sampled": 1068000, "num_agent_steps_trained": 1068000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.8739999999998087, "episode_len_mean": 261.84, "episode_media": {}, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [36.50000000000003, 19.69999999999984, 43.30000000000001, -50.00000000000044, 42.900000000000006, -50.00000000000044, 44.5, 46.3, 40.30000000000002, 20.899999999999856, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.70000000000003, -50.00000000000044, 46.5, 44.900000000000006, 47.5, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 45.7, 46.5, 45.7, 45.9, 44.900000000000006, -50.00000000000044, 42.900000000000006, 36.30000000000003, -50.00000000000044, 26.89999999999994, 38.700000000000024, 46.5, 12.499999999999737, 41.70000000000002, 44.300000000000004, -50.00000000000044, 46.3, 40.70000000000002, -50.00000000000044, 43.50000000000001, 46.5, 42.900000000000006, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 44.300000000000004, 45.3, 45.9, -50.00000000000044, -50.00000000000044, 38.90000000000002, 42.70000000000001, -50.00000000000044, 45.7, 34.900000000000034, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 8.299999999999677, 47.5, -50.00000000000044, 42.500000000000014, 47.3, -50.00000000000044, 45.3, -50.00000000000044, 47.1, 46.699999999999996, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, 31.500000000000007, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 41.500000000000014, -50.00000000000044, -50.00000000000044, 46.9, 38.300000000000026, 34.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 46.099999999999994], "episode_lengths": [136, 304, 68, 500, 72, 500, 56, 38, 98, 292, 500, 500, 500, 134, 500, 36, 52, 26, 500, 54, 500, 500, 44, 36, 44, 42, 52, 500, 72, 138, 500, 232, 114, 36, 376, 84, 58, 500, 38, 94, 500, 66, 36, 72, 500, 52, 500, 500, 58, 48, 42, 500, 500, 112, 74, 500, 44, 152, 500, 500, 84, 500, 500, 500, 500, 50, 418, 26, 500, 76, 28, 500, 48, 500, 30, 34, 500, 30, 500, 500, 500, 100, 186, 500, 500, 500, 500, 32, 86, 500, 500, 32, 118, 154, 500, 500, 500, 500, 30, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37758373766705383, "mean_inference_ms": 1.211424575815524, "mean_action_processing_ms": 0.13897336791334847, "mean_env_wait_ms": 0.08356914225725905, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02105236053466797, "StateBufferConnector_ms": 0.006995201110839844, "ViewRequirementAgentConnector_ms": 0.12739992141723633}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.8739999999998087, "episode_len_mean": 261.84, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [36.50000000000003, 19.69999999999984, 43.30000000000001, -50.00000000000044, 42.900000000000006, -50.00000000000044, 44.5, 46.3, 40.30000000000002, 20.899999999999856, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.70000000000003, -50.00000000000044, 46.5, 44.900000000000006, 47.5, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 45.7, 46.5, 45.7, 45.9, 44.900000000000006, -50.00000000000044, 42.900000000000006, 36.30000000000003, -50.00000000000044, 26.89999999999994, 38.700000000000024, 46.5, 12.499999999999737, 41.70000000000002, 44.300000000000004, -50.00000000000044, 46.3, 40.70000000000002, -50.00000000000044, 43.50000000000001, 46.5, 42.900000000000006, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 44.300000000000004, 45.3, 45.9, -50.00000000000044, -50.00000000000044, 38.90000000000002, 42.70000000000001, -50.00000000000044, 45.7, 34.900000000000034, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 8.299999999999677, 47.5, -50.00000000000044, 42.500000000000014, 47.3, -50.00000000000044, 45.3, -50.00000000000044, 47.1, 46.699999999999996, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, 31.500000000000007, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 41.500000000000014, -50.00000000000044, -50.00000000000044, 46.9, 38.300000000000026, 34.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 46.099999999999994], "episode_lengths": [136, 304, 68, 500, 72, 500, 56, 38, 98, 292, 500, 500, 500, 134, 500, 36, 52, 26, 500, 54, 500, 500, 44, 36, 44, 42, 52, 500, 72, 138, 500, 232, 114, 36, 376, 84, 58, 500, 38, 94, 500, 66, 36, 72, 500, 52, 500, 500, 58, 48, 42, 500, 500, 112, 74, 500, 44, 152, 500, 500, 84, 500, 500, 500, 500, 50, 418, 26, 500, 76, 28, 500, 48, 500, 30, 34, 500, 30, 500, 500, 500, 100, 186, 500, 500, 500, 500, 32, 86, 500, 500, 32, 118, 154, 500, 500, 500, 500, 30, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37758373766705383, "mean_inference_ms": 1.211424575815524, "mean_action_processing_ms": 0.13897336791334847, "mean_env_wait_ms": 0.08356914225725905, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02105236053466797, "StateBufferConnector_ms": 0.006995201110839844, "ViewRequirementAgentConnector_ms": 0.12739992141723633}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1068000, "num_agent_steps_trained": 1068000, "num_env_steps_sampled": 1068000, "num_env_steps_trained": 1068000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5405.85353248019, "num_env_steps_trained_throughput_per_sec": 5405.85353248019, "timesteps_total": 1068000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1068000, "timers": {"training_iteration_time_ms": 2188.669, "sample_time_ms": 1927.081, "load_time_ms": 12.78, "load_throughput": 938949.709, "learn_time_ms": 237.758, "learn_throughput": 50471.408, "synch_weights_time_ms": 9.571}, "counters": {"num_env_steps_sampled": 1068000, "num_env_steps_trained": 1068000, "num_agent_steps_sampled": 1068000, "num_agent_steps_trained": 1068000}, "done": false, "episodes_total": 4038, "training_iteration": 89, "trial_id": "9f288_00016", "date": "2023-10-25_16-54-49", "timestamp": 1698249289, "time_this_iter_s": 2.224813222885132, "time_total_s": 194.2642674446106, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 194.2642674446106, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 60.9, "ram_util_percent": 27.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.231174267785265e-28, "cur_lr": 0.0003, "total_loss": 6.785414457321167, "policy_loss": -0.00014923947552839914, "vf_loss": 6.785611708958943, "vf_explained_var": -8.046627044677734e-07, "kl": 0.0001599535775843227, "entropy": 0.47898125648498535, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1611.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1080000, "num_env_steps_trained": 1080000, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -2.864000000000218, "episode_len_mean": 289.16, "episode_media": {}, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.9, -50.00000000000044, -50.00000000000044, 38.90000000000002, 42.70000000000001, -50.00000000000044, 45.7, 34.900000000000034, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 8.299999999999677, 47.5, -50.00000000000044, 42.500000000000014, 47.3, -50.00000000000044, 45.3, -50.00000000000044, 47.1, 46.699999999999996, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, 31.500000000000007, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 41.500000000000014, -50.00000000000044, -50.00000000000044, 46.9, 38.300000000000026, 34.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 46.099999999999994, 10.299999999999706, 46.9, 45.1, 42.10000000000001, 45.9, 46.5, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 45.3, 42.500000000000014, -50.00000000000044, 36.50000000000003, -50.00000000000044, 45.7, 1.6999999999995836, 43.900000000000006, 33.10000000000003, 43.10000000000001, -50.00000000000044, 39.70000000000002, 38.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 45.9, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.69999999999994, 39.70000000000002, -50.00000000000044, -50.00000000000044, 40.90000000000002, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 35.30000000000004], "episode_lengths": [42, 500, 500, 112, 74, 500, 44, 152, 500, 500, 84, 500, 500, 500, 500, 50, 418, 26, 500, 76, 28, 500, 48, 500, 30, 34, 500, 30, 500, 500, 500, 100, 186, 500, 500, 500, 500, 32, 86, 500, 500, 32, 118, 154, 500, 500, 500, 500, 30, 40, 398, 32, 50, 80, 42, 36, 46, 500, 500, 500, 500, 32, 48, 76, 500, 136, 500, 44, 484, 62, 170, 70, 500, 104, 116, 500, 500, 500, 500, 50, 500, 500, 500, 42, 42, 36, 500, 500, 500, 234, 104, 500, 500, 92, 56, 500, 500, 500, 60, 148]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3775277006682499, "mean_inference_ms": 1.211303160549214, "mean_action_processing_ms": 0.13888333426102326, "mean_env_wait_ms": 0.08345510099128153, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022020816802978516, "StateBufferConnector_ms": 0.010994434356689453, "ViewRequirementAgentConnector_ms": 0.1404125690460205}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -2.864000000000218, "episode_len_mean": 289.16, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.9, -50.00000000000044, -50.00000000000044, 38.90000000000002, 42.70000000000001, -50.00000000000044, 45.7, 34.900000000000034, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 8.299999999999677, 47.5, -50.00000000000044, 42.500000000000014, 47.3, -50.00000000000044, 45.3, -50.00000000000044, 47.1, 46.699999999999996, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, 31.500000000000007, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 41.500000000000014, -50.00000000000044, -50.00000000000044, 46.9, 38.300000000000026, 34.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 46.099999999999994, 10.299999999999706, 46.9, 45.1, 42.10000000000001, 45.9, 46.5, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 45.3, 42.500000000000014, -50.00000000000044, 36.50000000000003, -50.00000000000044, 45.7, 1.6999999999995836, 43.900000000000006, 33.10000000000003, 43.10000000000001, -50.00000000000044, 39.70000000000002, 38.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 45.9, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.69999999999994, 39.70000000000002, -50.00000000000044, -50.00000000000044, 40.90000000000002, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 35.30000000000004], "episode_lengths": [42, 500, 500, 112, 74, 500, 44, 152, 500, 500, 84, 500, 500, 500, 500, 50, 418, 26, 500, 76, 28, 500, 48, 500, 30, 34, 500, 30, 500, 500, 500, 100, 186, 500, 500, 500, 500, 32, 86, 500, 500, 32, 118, 154, 500, 500, 500, 500, 30, 40, 398, 32, 50, 80, 42, 36, 46, 500, 500, 500, 500, 32, 48, 76, 500, 136, 500, 44, 484, 62, 170, 70, 500, 104, 116, 500, 500, 500, 500, 50, 500, 500, 500, 42, 42, 36, 500, 500, 500, 234, 104, 500, 500, 92, 56, 500, 500, 500, 60, 148]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3775277006682499, "mean_inference_ms": 1.211303160549214, "mean_action_processing_ms": 0.13888333426102326, "mean_env_wait_ms": 0.08345510099128153, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022020816802978516, "StateBufferConnector_ms": 0.010994434356689453, "ViewRequirementAgentConnector_ms": 0.1404125690460205}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000, "num_env_steps_sampled": 1080000, "num_env_steps_trained": 1080000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5662.203950565729, "num_env_steps_trained_throughput_per_sec": 5662.203950565729, "timesteps_total": 1080000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1080000, "timers": {"training_iteration_time_ms": 2190.345, "sample_time_ms": 1928.826, "load_time_ms": 13.08, "load_throughput": 917422.77, "learn_time_ms": 237.402, "learn_throughput": 50547.186, "synch_weights_time_ms": 9.472}, "counters": {"num_env_steps_sampled": 1080000, "num_env_steps_trained": 1080000, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000}, "done": false, "episodes_total": 4088, "training_iteration": 90, "trial_id": "9f288_00016", "date": "2023-10-25_16-54-51", "timestamp": 1698249291, "time_this_iter_s": 2.124307155609131, "time_total_s": 196.38857460021973, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 196.38857460021973, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 58.79999999999999, "ram_util_percent": 27.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.6155871338926325e-28, "cur_lr": 0.0003, "total_loss": 6.545610772238837, "policy_loss": 0.00011555829809771644, "vf_loss": 6.545545789930555, "vf_explained_var": -1.1987156338161892e-06, "kl": 6.26568446066875e-05, "entropy": 0.5054692228635153, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1629.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1092000, "num_env_steps_trained": 1092000, "num_agent_steps_sampled": 1092000, "num_agent_steps_trained": 1092000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.1319999999998034, "episode_len_mean": 269.26, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 47.1, 46.099999999999994, 10.299999999999706, 46.9, 45.1, 42.10000000000001, 45.9, 46.5, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 45.3, 42.500000000000014, -50.00000000000044, 36.50000000000003, -50.00000000000044, 45.7, 1.6999999999995836, 43.900000000000006, 33.10000000000003, 43.10000000000001, -50.00000000000044, 39.70000000000002, 38.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 45.9, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.69999999999994, 39.70000000000002, -50.00000000000044, -50.00000000000044, 40.90000000000002, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 35.30000000000004, -50.00000000000044, 39.70000000000002, 29.69999999999998, 41.500000000000014, 42.900000000000006, 44.7, 44.10000000000001, 46.099999999999994, -50.00000000000044, 40.30000000000002, -50.00000000000044, 46.3, -50.00000000000044, 46.3, 45.7, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 46.099999999999994, 35.900000000000034, -50.00000000000044, 42.900000000000006, 13.499999999999751, 13.499999999999751, 43.900000000000006, 41.30000000000001, 47.5, 45.9, -50.00000000000044, -50.00000000000044, 27.899999999999956, 45.3, -50.00000000000044, -50.00000000000044, 35.10000000000004, 15.099999999999774, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5], "episode_lengths": [500, 500, 30, 40, 398, 32, 50, 80, 42, 36, 46, 500, 500, 500, 500, 32, 48, 76, 500, 136, 500, 44, 484, 62, 170, 70, 500, 104, 116, 500, 500, 500, 500, 50, 500, 500, 500, 42, 42, 36, 500, 500, 500, 234, 104, 500, 500, 92, 56, 500, 500, 500, 60, 148, 500, 104, 204, 86, 72, 54, 60, 40, 500, 98, 500, 38, 500, 38, 44, 500, 42, 500, 500, 500, 32, 500, 500, 40, 142, 500, 72, 366, 366, 62, 88, 26, 42, 500, 500, 222, 48, 500, 500, 150, 350, 44, 500, 500, 500, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37738927450078896, "mean_inference_ms": 1.2111932811380541, "mean_action_processing_ms": 0.13917434752765545, "mean_env_wait_ms": 0.08317159556378345, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02099609375, "StateBufferConnector_ms": 0.008995771408081055, "ViewRequirementAgentConnector_ms": 0.13003230094909668}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.1319999999998034, "episode_len_mean": 269.26, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 47.1, 46.099999999999994, 10.299999999999706, 46.9, 45.1, 42.10000000000001, 45.9, 46.5, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 45.3, 42.500000000000014, -50.00000000000044, 36.50000000000003, -50.00000000000044, 45.7, 1.6999999999995836, 43.900000000000006, 33.10000000000003, 43.10000000000001, -50.00000000000044, 39.70000000000002, 38.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 45.9, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.69999999999994, 39.70000000000002, -50.00000000000044, -50.00000000000044, 40.90000000000002, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 35.30000000000004, -50.00000000000044, 39.70000000000002, 29.69999999999998, 41.500000000000014, 42.900000000000006, 44.7, 44.10000000000001, 46.099999999999994, -50.00000000000044, 40.30000000000002, -50.00000000000044, 46.3, -50.00000000000044, 46.3, 45.7, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 46.099999999999994, 35.900000000000034, -50.00000000000044, 42.900000000000006, 13.499999999999751, 13.499999999999751, 43.900000000000006, 41.30000000000001, 47.5, 45.9, -50.00000000000044, -50.00000000000044, 27.899999999999956, 45.3, -50.00000000000044, -50.00000000000044, 35.10000000000004, 15.099999999999774, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5], "episode_lengths": [500, 500, 30, 40, 398, 32, 50, 80, 42, 36, 46, 500, 500, 500, 500, 32, 48, 76, 500, 136, 500, 44, 484, 62, 170, 70, 500, 104, 116, 500, 500, 500, 500, 50, 500, 500, 500, 42, 42, 36, 500, 500, 500, 234, 104, 500, 500, 92, 56, 500, 500, 500, 60, 148, 500, 104, 204, 86, 72, 54, 60, 40, 500, 98, 500, 38, 500, 38, 44, 500, 42, 500, 500, 500, 32, 500, 500, 40, 142, 500, 72, 366, 366, 62, 88, 26, 42, 500, 500, 222, 48, 500, 500, 150, 350, 44, 500, 500, 500, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37738927450078896, "mean_inference_ms": 1.2111932811380541, "mean_action_processing_ms": 0.13917434752765545, "mean_env_wait_ms": 0.08317159556378345, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02099609375, "StateBufferConnector_ms": 0.008995771408081055, "ViewRequirementAgentConnector_ms": 0.13003230094909668}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1092000, "num_agent_steps_trained": 1092000, "num_env_steps_sampled": 1092000, "num_env_steps_trained": 1092000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4612.674330560932, "num_env_steps_trained_throughput_per_sec": 4612.674330560932, "timesteps_total": 1092000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1092000, "timers": {"training_iteration_time_ms": 2225.013, "sample_time_ms": 1957.005, "load_time_ms": 12.98, "load_throughput": 924503.745, "learn_time_ms": 243.959, "learn_throughput": 49188.57, "synch_weights_time_ms": 9.592}, "counters": {"num_env_steps_sampled": 1092000, "num_env_steps_trained": 1092000, "num_agent_steps_sampled": 1092000, "num_agent_steps_trained": 1092000}, "done": false, "episodes_total": 4134, "training_iteration": 91, "trial_id": "9f288_00016", "date": "2023-10-25_16-54-54", "timestamp": 1698249294, "time_this_iter_s": 2.6066043376922607, "time_total_s": 198.995178937912, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 198.995178937912, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 48.05, "ram_util_percent": 27.25}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.077935669463162e-29, "cur_lr": 0.0003, "total_loss": 6.353629165225559, "policy_loss": -0.00044587130347887677, "vf_loss": 6.3541220559014215, "vf_explained_var": -9.669197930230034e-07, "kl": 0.0009751596731019971, "entropy": 0.4720562994480133, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1647.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1104000, "num_env_steps_trained": 1104000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.697999999999812, "episode_len_mean": 263.62, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [26.69999999999994, 39.70000000000002, -50.00000000000044, -50.00000000000044, 40.90000000000002, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 35.30000000000004, -50.00000000000044, 39.70000000000002, 29.69999999999998, 41.500000000000014, 42.900000000000006, 44.7, 44.10000000000001, 46.099999999999994, -50.00000000000044, 40.30000000000002, -50.00000000000044, 46.3, -50.00000000000044, 46.3, 45.7, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 46.099999999999994, 35.900000000000034, -50.00000000000044, 42.900000000000006, 13.499999999999751, 13.499999999999751, 43.900000000000006, 41.30000000000001, 47.5, 45.9, -50.00000000000044, -50.00000000000044, 27.899999999999956, 45.3, -50.00000000000044, -50.00000000000044, 35.10000000000004, 15.099999999999774, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 47.5, 43.900000000000006, 47.1, -50.00000000000044, 44.7, -50.00000000000044, 39.10000000000002, 45.3, -50.00000000000044, 38.90000000000002, 47.1, 43.10000000000001, 40.70000000000002, 37.50000000000003, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 44.300000000000004, 20.099999999999845, 45.9, -50.00000000000044, 45.7, -50.00000000000044, 33.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, 5.6999999999996405, -50.00000000000044, -50.00000000000044, 44.7, 40.10000000000002, 43.7, -50.00000000000044, 12.099999999999731, 46.3, 46.5, -50.00000000000044, 45.1], "episode_lengths": [234, 104, 500, 500, 92, 56, 500, 500, 500, 60, 148, 500, 104, 204, 86, 72, 54, 60, 40, 500, 98, 500, 38, 500, 38, 44, 500, 42, 500, 500, 500, 32, 500, 500, 40, 142, 500, 72, 366, 366, 62, 88, 26, 42, 500, 500, 222, 48, 500, 500, 150, 350, 44, 500, 500, 500, 36, 500, 500, 26, 62, 30, 500, 54, 500, 110, 48, 500, 112, 30, 70, 94, 126, 500, 46, 500, 500, 58, 300, 42, 500, 44, 500, 166, 500, 500, 500, 118, 444, 500, 500, 54, 100, 64, 500, 380, 38, 36, 500, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37752681007982825, "mean_inference_ms": 1.2110641549510062, "mean_action_processing_ms": 0.13925540505953082, "mean_env_wait_ms": 0.08331305778772387, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01699686050415039, "StateBufferConnector_ms": 0.005001544952392578, "ViewRequirementAgentConnector_ms": 0.13202810287475586}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.697999999999812, "episode_len_mean": 263.62, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [26.69999999999994, 39.70000000000002, -50.00000000000044, -50.00000000000044, 40.90000000000002, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 35.30000000000004, -50.00000000000044, 39.70000000000002, 29.69999999999998, 41.500000000000014, 42.900000000000006, 44.7, 44.10000000000001, 46.099999999999994, -50.00000000000044, 40.30000000000002, -50.00000000000044, 46.3, -50.00000000000044, 46.3, 45.7, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 46.099999999999994, 35.900000000000034, -50.00000000000044, 42.900000000000006, 13.499999999999751, 13.499999999999751, 43.900000000000006, 41.30000000000001, 47.5, 45.9, -50.00000000000044, -50.00000000000044, 27.899999999999956, 45.3, -50.00000000000044, -50.00000000000044, 35.10000000000004, 15.099999999999774, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 47.5, 43.900000000000006, 47.1, -50.00000000000044, 44.7, -50.00000000000044, 39.10000000000002, 45.3, -50.00000000000044, 38.90000000000002, 47.1, 43.10000000000001, 40.70000000000002, 37.50000000000003, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 44.300000000000004, 20.099999999999845, 45.9, -50.00000000000044, 45.7, -50.00000000000044, 33.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, 5.6999999999996405, -50.00000000000044, -50.00000000000044, 44.7, 40.10000000000002, 43.7, -50.00000000000044, 12.099999999999731, 46.3, 46.5, -50.00000000000044, 45.1], "episode_lengths": [234, 104, 500, 500, 92, 56, 500, 500, 500, 60, 148, 500, 104, 204, 86, 72, 54, 60, 40, 500, 98, 500, 38, 500, 38, 44, 500, 42, 500, 500, 500, 32, 500, 500, 40, 142, 500, 72, 366, 366, 62, 88, 26, 42, 500, 500, 222, 48, 500, 500, 150, 350, 44, 500, 500, 500, 36, 500, 500, 26, 62, 30, 500, 54, 500, 110, 48, 500, 112, 30, 70, 94, 126, 500, 46, 500, 500, 58, 300, 42, 500, 44, 500, 166, 500, 500, 500, 118, 444, 500, 500, 54, 100, 64, 500, 380, 38, 36, 500, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37752681007982825, "mean_inference_ms": 1.2110641549510062, "mean_action_processing_ms": 0.13925540505953082, "mean_env_wait_ms": 0.08331305778772387, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01699686050415039, "StateBufferConnector_ms": 0.005001544952392578, "ViewRequirementAgentConnector_ms": 0.13202810287475586}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000, "num_env_steps_sampled": 1104000, "num_env_steps_trained": 1104000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5874.561844166855, "num_env_steps_trained_throughput_per_sec": 5874.561844166855, "timesteps_total": 1104000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1104000, "timers": {"training_iteration_time_ms": 2218.34, "sample_time_ms": 1953.68, "load_time_ms": 13.032, "load_throughput": 920824.965, "learn_time_ms": 240.656, "learn_throughput": 49863.653, "synch_weights_time_ms": 9.595}, "counters": {"num_env_steps_sampled": 1104000, "num_env_steps_trained": 1104000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "done": false, "episodes_total": 4177, "training_iteration": 92, "trial_id": "9f288_00016", "date": "2023-10-25_16-54-56", "timestamp": 1698249296, "time_this_iter_s": 2.0477030277252197, "time_total_s": 201.0428819656372, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 201.0428819656372, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 66.0, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.038967834731581e-29, "cur_lr": 0.0003, "total_loss": 6.259681966569689, "policy_loss": -0.0001032371073961258, "vf_loss": 6.25983124309116, "vf_explained_var": -9.338061014811198e-07, "kl": 0.0003869625920038317, "entropy": 0.45928127070267993, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1665.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1116000, "num_env_steps_trained": 1116000, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.3119999999998044, "episode_len_mean": 277.5, "episode_media": {}, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.499999999999751, 13.499999999999751, 43.900000000000006, 41.30000000000001, 47.5, 45.9, -50.00000000000044, -50.00000000000044, 27.899999999999956, 45.3, -50.00000000000044, -50.00000000000044, 35.10000000000004, 15.099999999999774, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 47.5, 43.900000000000006, 47.1, -50.00000000000044, 44.7, -50.00000000000044, 39.10000000000002, 45.3, -50.00000000000044, 38.90000000000002, 47.1, 43.10000000000001, 40.70000000000002, 37.50000000000003, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 44.300000000000004, 20.099999999999845, 45.9, -50.00000000000044, 45.7, -50.00000000000044, 33.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, 5.6999999999996405, -50.00000000000044, -50.00000000000044, 44.7, 40.10000000000002, 43.7, -50.00000000000044, 12.099999999999731, 46.3, 46.5, -50.00000000000044, 45.1, -50.00000000000044, 35.10000000000004, 43.7, 25.499999999999922, -50.00000000000044, -50.00000000000044, 21.699999999999868, 33.30000000000003, 39.90000000000002, -50.00000000000044, 26.89999999999994, 47.7, -50.00000000000044, 20.49999999999985, -50.00000000000044, 20.899999999999856, -50.00000000000044, 31.1, 46.3, -50.00000000000044, -50.00000000000044, 12.499999999999737, 45.1, 41.100000000000016, 18.099999999999817, 2.299999999999592, 37.50000000000003, 39.300000000000026, -50.00000000000044, 10.099999999999703, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 45.3, 42.30000000000001, -50.00000000000044, 46.3], "episode_lengths": [366, 366, 62, 88, 26, 42, 500, 500, 222, 48, 500, 500, 150, 350, 44, 500, 500, 500, 36, 500, 500, 26, 62, 30, 500, 54, 500, 110, 48, 500, 112, 30, 70, 94, 126, 500, 46, 500, 500, 58, 300, 42, 500, 44, 500, 166, 500, 500, 500, 118, 444, 500, 500, 54, 100, 64, 500, 380, 38, 36, 500, 50, 500, 150, 64, 246, 500, 500, 284, 168, 102, 500, 232, 24, 500, 296, 500, 292, 500, 190, 38, 500, 500, 376, 50, 90, 320, 478, 126, 108, 500, 400, 500, 500, 500, 50, 48, 78, 500, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3777288914571445, "mean_inference_ms": 1.2113834351060662, "mean_action_processing_ms": 0.13923345376318877, "mean_env_wait_ms": 0.08350709558315861, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012998580932617188, "StateBufferConnector_ms": 0.005002260208129883, "ViewRequirementAgentConnector_ms": 0.13504266738891602}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.3119999999998044, "episode_len_mean": 277.5, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [13.499999999999751, 13.499999999999751, 43.900000000000006, 41.30000000000001, 47.5, 45.9, -50.00000000000044, -50.00000000000044, 27.899999999999956, 45.3, -50.00000000000044, -50.00000000000044, 35.10000000000004, 15.099999999999774, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 47.5, 43.900000000000006, 47.1, -50.00000000000044, 44.7, -50.00000000000044, 39.10000000000002, 45.3, -50.00000000000044, 38.90000000000002, 47.1, 43.10000000000001, 40.70000000000002, 37.50000000000003, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 44.300000000000004, 20.099999999999845, 45.9, -50.00000000000044, 45.7, -50.00000000000044, 33.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, 5.6999999999996405, -50.00000000000044, -50.00000000000044, 44.7, 40.10000000000002, 43.7, -50.00000000000044, 12.099999999999731, 46.3, 46.5, -50.00000000000044, 45.1, -50.00000000000044, 35.10000000000004, 43.7, 25.499999999999922, -50.00000000000044, -50.00000000000044, 21.699999999999868, 33.30000000000003, 39.90000000000002, -50.00000000000044, 26.89999999999994, 47.7, -50.00000000000044, 20.49999999999985, -50.00000000000044, 20.899999999999856, -50.00000000000044, 31.1, 46.3, -50.00000000000044, -50.00000000000044, 12.499999999999737, 45.1, 41.100000000000016, 18.099999999999817, 2.299999999999592, 37.50000000000003, 39.300000000000026, -50.00000000000044, 10.099999999999703, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 45.3, 42.30000000000001, -50.00000000000044, 46.3], "episode_lengths": [366, 366, 62, 88, 26, 42, 500, 500, 222, 48, 500, 500, 150, 350, 44, 500, 500, 500, 36, 500, 500, 26, 62, 30, 500, 54, 500, 110, 48, 500, 112, 30, 70, 94, 126, 500, 46, 500, 500, 58, 300, 42, 500, 44, 500, 166, 500, 500, 500, 118, 444, 500, 500, 54, 100, 64, 500, 380, 38, 36, 500, 50, 500, 150, 64, 246, 500, 500, 284, 168, 102, 500, 232, 24, 500, 296, 500, 292, 500, 190, 38, 500, 500, 376, 50, 90, 320, 478, 126, 108, 500, 400, 500, 500, 500, 50, 48, 78, 500, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3777288914571445, "mean_inference_ms": 1.2113834351060662, "mean_action_processing_ms": 0.13923345376318877, "mean_env_wait_ms": 0.08350709558315861, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012998580932617188, "StateBufferConnector_ms": 0.005002260208129883, "ViewRequirementAgentConnector_ms": 0.13504266738891602}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000, "num_env_steps_sampled": 1116000, "num_env_steps_trained": 1116000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5536.230433399062, "num_env_steps_trained_throughput_per_sec": 5536.230433399062, "timesteps_total": 1116000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1116000, "timers": {"training_iteration_time_ms": 2218.03, "sample_time_ms": 1959.858, "load_time_ms": 12.932, "load_throughput": 927953.628, "learn_time_ms": 234.168, "learn_throughput": 51245.186, "synch_weights_time_ms": 9.672}, "counters": {"num_env_steps_sampled": 1116000, "num_env_steps_trained": 1116000, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000}, "done": false, "episodes_total": 4215, "training_iteration": 93, "trial_id": "9f288_00016", "date": "2023-10-25_16-54-58", "timestamp": 1698249298, "time_this_iter_s": 2.172990322113037, "time_total_s": 203.21587228775024, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 203.21587228775024, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 62.03333333333333, "ram_util_percent": 27.133333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.0194839173657906e-29, "cur_lr": 0.0003, "total_loss": 6.55352963341607, "policy_loss": 0.00013574502534336515, "vf_loss": 6.553440093994141, "vf_explained_var": -8.013513353135851e-07, "kl": 0.0002056345730510303, "entropy": 0.462896176510387, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1683.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1128000, "num_env_steps_trained": 1128000, "num_agent_steps_sampled": 1128000, "num_agent_steps_trained": 1128000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.619999999999813, "episode_len_mean": 264.44, "episode_media": {}, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 44.7, 40.10000000000002, 43.7, -50.00000000000044, 12.099999999999731, 46.3, 46.5, -50.00000000000044, 45.1, -50.00000000000044, 35.10000000000004, 43.7, 25.499999999999922, -50.00000000000044, -50.00000000000044, 21.699999999999868, 33.30000000000003, 39.90000000000002, -50.00000000000044, 26.89999999999994, 47.7, -50.00000000000044, 20.49999999999985, -50.00000000000044, 20.899999999999856, -50.00000000000044, 31.1, 46.3, -50.00000000000044, -50.00000000000044, 12.499999999999737, 45.1, 41.100000000000016, 18.099999999999817, 2.299999999999592, 37.50000000000003, 39.300000000000026, -50.00000000000044, 10.099999999999703, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 45.3, 42.30000000000001, -50.00000000000044, 46.3, -50.00000000000044, 44.300000000000004, 1.299999999999578, -50.00000000000044, -50.00000000000044, 44.300000000000004, 47.5, -50.00000000000044, 44.5, 6.8999999999996575, -50.00000000000044, 47.5, 46.099999999999994, 46.699999999999996, -50.00000000000044, 45.3, 45.3, 42.30000000000001, 46.9, 45.9, 27.099999999999945, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 46.699999999999996, 38.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 31.900000000000013, 47.7, 47.1, -50.00000000000044, 26.299999999999933, -50.00000000000044, -50.00000000000044, 45.9, 43.900000000000006, -50.00000000000044, 1.099999999999575, 46.5, 46.699999999999996, 43.50000000000001, 46.5, 34.50000000000004, 40.90000000000002, 45.7], "episode_lengths": [500, 500, 54, 100, 64, 500, 380, 38, 36, 500, 50, 500, 150, 64, 246, 500, 500, 284, 168, 102, 500, 232, 24, 500, 296, 500, 292, 500, 190, 38, 500, 500, 376, 50, 90, 320, 478, 126, 108, 500, 400, 500, 500, 500, 50, 48, 78, 500, 38, 500, 58, 488, 500, 500, 58, 26, 500, 56, 432, 500, 26, 40, 34, 500, 48, 48, 78, 32, 42, 230, 500, 40, 500, 500, 34, 118, 500, 500, 500, 500, 54, 500, 182, 24, 30, 500, 238, 500, 500, 42, 62, 500, 490, 36, 34, 66, 36, 156, 92, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37807564342217653, "mean_inference_ms": 1.2113647482133407, "mean_action_processing_ms": 0.1390074494895962, "mean_env_wait_ms": 0.08354875527603484, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017998218536376953, "StateBufferConnector_ms": 0.0030002593994140625, "ViewRequirementAgentConnector_ms": 0.12301874160766602}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.619999999999813, "episode_len_mean": 264.44, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 44.7, 40.10000000000002, 43.7, -50.00000000000044, 12.099999999999731, 46.3, 46.5, -50.00000000000044, 45.1, -50.00000000000044, 35.10000000000004, 43.7, 25.499999999999922, -50.00000000000044, -50.00000000000044, 21.699999999999868, 33.30000000000003, 39.90000000000002, -50.00000000000044, 26.89999999999994, 47.7, -50.00000000000044, 20.49999999999985, -50.00000000000044, 20.899999999999856, -50.00000000000044, 31.1, 46.3, -50.00000000000044, -50.00000000000044, 12.499999999999737, 45.1, 41.100000000000016, 18.099999999999817, 2.299999999999592, 37.50000000000003, 39.300000000000026, -50.00000000000044, 10.099999999999703, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 45.3, 42.30000000000001, -50.00000000000044, 46.3, -50.00000000000044, 44.300000000000004, 1.299999999999578, -50.00000000000044, -50.00000000000044, 44.300000000000004, 47.5, -50.00000000000044, 44.5, 6.8999999999996575, -50.00000000000044, 47.5, 46.099999999999994, 46.699999999999996, -50.00000000000044, 45.3, 45.3, 42.30000000000001, 46.9, 45.9, 27.099999999999945, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 46.699999999999996, 38.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 31.900000000000013, 47.7, 47.1, -50.00000000000044, 26.299999999999933, -50.00000000000044, -50.00000000000044, 45.9, 43.900000000000006, -50.00000000000044, 1.099999999999575, 46.5, 46.699999999999996, 43.50000000000001, 46.5, 34.50000000000004, 40.90000000000002, 45.7], "episode_lengths": [500, 500, 54, 100, 64, 500, 380, 38, 36, 500, 50, 500, 150, 64, 246, 500, 500, 284, 168, 102, 500, 232, 24, 500, 296, 500, 292, 500, 190, 38, 500, 500, 376, 50, 90, 320, 478, 126, 108, 500, 400, 500, 500, 500, 50, 48, 78, 500, 38, 500, 58, 488, 500, 500, 58, 26, 500, 56, 432, 500, 26, 40, 34, 500, 48, 48, 78, 32, 42, 230, 500, 40, 500, 500, 34, 118, 500, 500, 500, 500, 54, 500, 182, 24, 30, 500, 238, 500, 500, 42, 62, 500, 490, 36, 34, 66, 36, 156, 92, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37807564342217653, "mean_inference_ms": 1.2113647482133407, "mean_action_processing_ms": 0.1390074494895962, "mean_env_wait_ms": 0.08354875527603484, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017998218536376953, "StateBufferConnector_ms": 0.0030002593994140625, "ViewRequirementAgentConnector_ms": 0.12301874160766602}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1128000, "num_agent_steps_trained": 1128000, "num_env_steps_sampled": 1128000, "num_env_steps_trained": 1128000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5274.183929805876, "num_env_steps_trained_throughput_per_sec": 5274.183929805876, "timesteps_total": 1128000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1128000, "timers": {"training_iteration_time_ms": 2236.501, "sample_time_ms": 1963.038, "load_time_ms": 13.732, "load_throughput": 873849.744, "learn_time_ms": 248.759, "learn_throughput": 48239.547, "synch_weights_time_ms": 9.572}, "counters": {"num_env_steps_sampled": 1128000, "num_env_steps_trained": 1128000, "num_agent_steps_sampled": 1128000, "num_agent_steps_trained": 1128000}, "done": false, "episodes_total": 4266, "training_iteration": 94, "trial_id": "9f288_00016", "date": "2023-10-25_16-55-00", "timestamp": 1698249300, "time_this_iter_s": 2.2812297344207764, "time_total_s": 205.49710202217102, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 205.49710202217102, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 57.6, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.0097419586828953e-29, "cur_lr": 0.0003, "total_loss": 6.28123042318556, "policy_loss": -0.000560843696196874, "vf_loss": 6.281845066282484, "vf_explained_var": -1.3444158766004775e-06, "kl": 0.0005675407356291215, "entropy": 0.5367012222607931, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1701.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1140000, "num_env_steps_trained": 1140000, "num_agent_steps_sampled": 1140000, "num_agent_steps_trained": 1140000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.351999999999828, "episode_len_mean": 247.12, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.30000000000001, -50.00000000000044, 46.3, -50.00000000000044, 44.300000000000004, 1.299999999999578, -50.00000000000044, -50.00000000000044, 44.300000000000004, 47.5, -50.00000000000044, 44.5, 6.8999999999996575, -50.00000000000044, 47.5, 46.099999999999994, 46.699999999999996, -50.00000000000044, 45.3, 45.3, 42.30000000000001, 46.9, 45.9, 27.099999999999945, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 46.699999999999996, 38.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 31.900000000000013, 47.7, 47.1, -50.00000000000044, 26.299999999999933, -50.00000000000044, -50.00000000000044, 45.9, 43.900000000000006, -50.00000000000044, 1.099999999999575, 46.5, 46.699999999999996, 43.50000000000001, 46.5, 34.50000000000004, 40.90000000000002, 45.7, -50.00000000000044, 46.3, -50.00000000000044, 36.10000000000004, 40.30000000000002, 45.5, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 43.50000000000001, 42.900000000000006, 39.70000000000002, 29.099999999999973, -50.00000000000044, 45.5, 27.699999999999953, 42.70000000000001, -50.00000000000044, -50.00000000000044, 27.899999999999956, 43.900000000000006, 34.50000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 31.500000000000007, -50.00000000000044, 43.900000000000006, -50.00000000000044, 42.900000000000006, 42.30000000000001, -50.00000000000044, 23.699999999999896, 39.90000000000002, 46.099999999999994, 41.70000000000002, 18.899999999999828, -50.00000000000044, 37.50000000000003, 45.5, 44.10000000000001, -50.00000000000044, 45.9], "episode_lengths": [78, 500, 38, 500, 58, 488, 500, 500, 58, 26, 500, 56, 432, 500, 26, 40, 34, 500, 48, 48, 78, 32, 42, 230, 500, 40, 500, 500, 34, 118, 500, 500, 500, 500, 54, 500, 182, 24, 30, 500, 238, 500, 500, 42, 62, 500, 490, 36, 34, 66, 36, 156, 92, 44, 500, 38, 500, 140, 98, 46, 500, 38, 500, 500, 66, 72, 104, 210, 500, 46, 224, 74, 500, 500, 222, 62, 156, 500, 500, 500, 500, 52, 186, 500, 62, 500, 72, 78, 500, 264, 102, 40, 84, 312, 500, 126, 46, 60, 500, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37773105190165174, "mean_inference_ms": 1.2117254974501508, "mean_action_processing_ms": 0.13904194986335466, "mean_env_wait_ms": 0.08345407973449483, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019004106521606445, "StateBufferConnector_ms": 0.0020008087158203125, "ViewRequirementAgentConnector_ms": 0.12400984764099121}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.351999999999828, "episode_len_mean": 247.12, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.30000000000001, -50.00000000000044, 46.3, -50.00000000000044, 44.300000000000004, 1.299999999999578, -50.00000000000044, -50.00000000000044, 44.300000000000004, 47.5, -50.00000000000044, 44.5, 6.8999999999996575, -50.00000000000044, 47.5, 46.099999999999994, 46.699999999999996, -50.00000000000044, 45.3, 45.3, 42.30000000000001, 46.9, 45.9, 27.099999999999945, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 46.699999999999996, 38.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 31.900000000000013, 47.7, 47.1, -50.00000000000044, 26.299999999999933, -50.00000000000044, -50.00000000000044, 45.9, 43.900000000000006, -50.00000000000044, 1.099999999999575, 46.5, 46.699999999999996, 43.50000000000001, 46.5, 34.50000000000004, 40.90000000000002, 45.7, -50.00000000000044, 46.3, -50.00000000000044, 36.10000000000004, 40.30000000000002, 45.5, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 43.50000000000001, 42.900000000000006, 39.70000000000002, 29.099999999999973, -50.00000000000044, 45.5, 27.699999999999953, 42.70000000000001, -50.00000000000044, -50.00000000000044, 27.899999999999956, 43.900000000000006, 34.50000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 31.500000000000007, -50.00000000000044, 43.900000000000006, -50.00000000000044, 42.900000000000006, 42.30000000000001, -50.00000000000044, 23.699999999999896, 39.90000000000002, 46.099999999999994, 41.70000000000002, 18.899999999999828, -50.00000000000044, 37.50000000000003, 45.5, 44.10000000000001, -50.00000000000044, 45.9], "episode_lengths": [78, 500, 38, 500, 58, 488, 500, 500, 58, 26, 500, 56, 432, 500, 26, 40, 34, 500, 48, 48, 78, 32, 42, 230, 500, 40, 500, 500, 34, 118, 500, 500, 500, 500, 54, 500, 182, 24, 30, 500, 238, 500, 500, 42, 62, 500, 490, 36, 34, 66, 36, 156, 92, 44, 500, 38, 500, 140, 98, 46, 500, 38, 500, 500, 66, 72, 104, 210, 500, 46, 224, 74, 500, 500, 222, 62, 156, 500, 500, 500, 500, 52, 186, 500, 62, 500, 72, 78, 500, 264, 102, 40, 84, 312, 500, 126, 46, 60, 500, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37773105190165174, "mean_inference_ms": 1.2117254974501508, "mean_action_processing_ms": 0.13904194986335466, "mean_env_wait_ms": 0.08345407973449483, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019004106521606445, "StateBufferConnector_ms": 0.0020008087158203125, "ViewRequirementAgentConnector_ms": 0.12400984764099121}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1140000, "num_agent_steps_trained": 1140000, "num_env_steps_sampled": 1140000, "num_env_steps_trained": 1140000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5306.441216192708, "num_env_steps_trained_throughput_per_sec": 5306.441216192708, "timesteps_total": 1140000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1140000, "timers": {"training_iteration_time_ms": 2234.92, "sample_time_ms": 1962.316, "load_time_ms": 13.331, "load_throughput": 900153.77, "learn_time_ms": 248.147, "learn_throughput": 48358.468, "synch_weights_time_ms": 9.627}, "counters": {"num_env_steps_sampled": 1140000, "num_env_steps_trained": 1140000, "num_agent_steps_sampled": 1140000, "num_agent_steps_trained": 1140000}, "done": false, "episodes_total": 4312, "training_iteration": 95, "trial_id": "9f288_00016", "date": "2023-10-25_16-55-02", "timestamp": 1698249302, "time_this_iter_s": 2.2664008140563965, "time_total_s": 207.76350283622742, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 207.76350283622742, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 58.93333333333334, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.0487097934144765e-30, "cur_lr": 0.0003, "total_loss": 6.949517329533895, "policy_loss": -0.0002570998751454883, "vf_loss": 6.949829684363471, "vf_explained_var": -1.178847418891059e-06, "kl": 0.00024694671896617767, "entropy": 0.5519797321822908, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1719.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1152000, "num_env_steps_trained": 1152000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.86999999999985, "episode_len_mean": 241.98, "episode_media": {}, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.5, 34.50000000000004, 40.90000000000002, 45.7, -50.00000000000044, 46.3, -50.00000000000044, 36.10000000000004, 40.30000000000002, 45.5, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 43.50000000000001, 42.900000000000006, 39.70000000000002, 29.099999999999973, -50.00000000000044, 45.5, 27.699999999999953, 42.70000000000001, -50.00000000000044, -50.00000000000044, 27.899999999999956, 43.900000000000006, 34.50000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 31.500000000000007, -50.00000000000044, 43.900000000000006, -50.00000000000044, 42.900000000000006, 42.30000000000001, -50.00000000000044, 23.699999999999896, 39.90000000000002, 46.099999999999994, 41.70000000000002, 18.899999999999828, -50.00000000000044, 37.50000000000003, 45.5, 44.10000000000001, -50.00000000000044, 45.9, -50.00000000000044, 46.699999999999996, 36.900000000000034, 26.89999999999994, -50.00000000000044, 22.699999999999882, 40.10000000000002, 41.30000000000001, 26.69999999999994, -50.00000000000044, 37.50000000000003, -50.00000000000044, 11.899999999999729, -50.00000000000044, 43.10000000000001, 42.30000000000001, 38.300000000000026, -50.00000000000044, 16.699999999999797, -50.00000000000044, -50.00000000000044, 38.300000000000026, 41.90000000000001, -50.00000000000044, -50.00000000000044, 42.70000000000001, 34.900000000000034, 41.70000000000002, 45.9, 27.899999999999956, 43.900000000000006, -50.00000000000044, 29.899999999999984, 43.900000000000006, 43.50000000000001, 46.099999999999994, 44.5, 37.90000000000003, 41.70000000000002, -50.00000000000044, -50.00000000000044, 19.69999999999984, 38.90000000000002, 43.30000000000001, 39.10000000000002, -50.00000000000044, -50.00000000000044, 46.5, 29.899999999999984, 25.499999999999922], "episode_lengths": [36, 156, 92, 44, 500, 38, 500, 140, 98, 46, 500, 38, 500, 500, 66, 72, 104, 210, 500, 46, 224, 74, 500, 500, 222, 62, 156, 500, 500, 500, 500, 52, 186, 500, 62, 500, 72, 78, 500, 264, 102, 40, 84, 312, 500, 126, 46, 60, 500, 42, 500, 34, 132, 232, 500, 274, 100, 88, 234, 500, 126, 500, 382, 500, 70, 78, 118, 500, 334, 500, 500, 118, 82, 500, 500, 74, 152, 84, 42, 222, 62, 500, 202, 62, 66, 40, 56, 122, 84, 500, 500, 304, 112, 68, 110, 500, 500, 36, 202, 246]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37746177160277583, "mean_inference_ms": 1.2121800333870987, "mean_action_processing_ms": 0.13918989015531236, "mean_env_wait_ms": 0.08362756909594367, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0240018367767334, "StateBufferConnector_ms": 0.0020008087158203125, "ViewRequirementAgentConnector_ms": 0.11899614334106445}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.86999999999985, "episode_len_mean": 241.98, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.5, 34.50000000000004, 40.90000000000002, 45.7, -50.00000000000044, 46.3, -50.00000000000044, 36.10000000000004, 40.30000000000002, 45.5, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 43.50000000000001, 42.900000000000006, 39.70000000000002, 29.099999999999973, -50.00000000000044, 45.5, 27.699999999999953, 42.70000000000001, -50.00000000000044, -50.00000000000044, 27.899999999999956, 43.900000000000006, 34.50000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 31.500000000000007, -50.00000000000044, 43.900000000000006, -50.00000000000044, 42.900000000000006, 42.30000000000001, -50.00000000000044, 23.699999999999896, 39.90000000000002, 46.099999999999994, 41.70000000000002, 18.899999999999828, -50.00000000000044, 37.50000000000003, 45.5, 44.10000000000001, -50.00000000000044, 45.9, -50.00000000000044, 46.699999999999996, 36.900000000000034, 26.89999999999994, -50.00000000000044, 22.699999999999882, 40.10000000000002, 41.30000000000001, 26.69999999999994, -50.00000000000044, 37.50000000000003, -50.00000000000044, 11.899999999999729, -50.00000000000044, 43.10000000000001, 42.30000000000001, 38.300000000000026, -50.00000000000044, 16.699999999999797, -50.00000000000044, -50.00000000000044, 38.300000000000026, 41.90000000000001, -50.00000000000044, -50.00000000000044, 42.70000000000001, 34.900000000000034, 41.70000000000002, 45.9, 27.899999999999956, 43.900000000000006, -50.00000000000044, 29.899999999999984, 43.900000000000006, 43.50000000000001, 46.099999999999994, 44.5, 37.90000000000003, 41.70000000000002, -50.00000000000044, -50.00000000000044, 19.69999999999984, 38.90000000000002, 43.30000000000001, 39.10000000000002, -50.00000000000044, -50.00000000000044, 46.5, 29.899999999999984, 25.499999999999922], "episode_lengths": [36, 156, 92, 44, 500, 38, 500, 140, 98, 46, 500, 38, 500, 500, 66, 72, 104, 210, 500, 46, 224, 74, 500, 500, 222, 62, 156, 500, 500, 500, 500, 52, 186, 500, 62, 500, 72, 78, 500, 264, 102, 40, 84, 312, 500, 126, 46, 60, 500, 42, 500, 34, 132, 232, 500, 274, 100, 88, 234, 500, 126, 500, 382, 500, 70, 78, 118, 500, 334, 500, 500, 118, 82, 500, 500, 74, 152, 84, 42, 222, 62, 500, 202, 62, 66, 40, 56, 122, 84, 500, 500, 304, 112, 68, 110, 500, 500, 36, 202, 246]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37746177160277583, "mean_inference_ms": 1.2121800333870987, "mean_action_processing_ms": 0.13918989015531236, "mean_env_wait_ms": 0.08362756909594367, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0240018367767334, "StateBufferConnector_ms": 0.0020008087158203125, "ViewRequirementAgentConnector_ms": 0.11899614334106445}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000, "num_env_steps_sampled": 1152000, "num_env_steps_trained": 1152000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5796.468726754566, "num_env_steps_trained_throughput_per_sec": 5796.468726754566, "timesteps_total": 1152000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1152000, "timers": {"training_iteration_time_ms": 2226.941, "sample_time_ms": 1954.7, "load_time_ms": 13.131, "load_throughput": 913866.383, "learn_time_ms": 247.984, "learn_throughput": 48390.232, "synch_weights_time_ms": 9.627}, "counters": {"num_env_steps_sampled": 1152000, "num_env_steps_trained": 1152000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "done": false, "episodes_total": 4362, "training_iteration": 96, "trial_id": "9f288_00016", "date": "2023-10-25_16-55-05", "timestamp": 1698249305, "time_this_iter_s": 2.075223922729492, "time_total_s": 209.8387267589569, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 209.8387267589569, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 59.26666666666667, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.5243548967072383e-30, "cur_lr": 0.0003, "total_loss": 6.802327050103082, "policy_loss": 4.9992154041926064e-05, "vf_loss": 6.802329407797919, "vf_explained_var": -1.006656222873264e-06, "kl": 0.00037835829267862664, "entropy": 0.5226022551457087, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1737.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1164000, "num_env_steps_trained": 1164000, "num_agent_steps_sampled": 1164000, "num_agent_steps_trained": 1164000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.695999999999838, "episode_len_mean": 253.7, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.10000000000001, -50.00000000000044, 45.9, -50.00000000000044, 46.699999999999996, 36.900000000000034, 26.89999999999994, -50.00000000000044, 22.699999999999882, 40.10000000000002, 41.30000000000001, 26.69999999999994, -50.00000000000044, 37.50000000000003, -50.00000000000044, 11.899999999999729, -50.00000000000044, 43.10000000000001, 42.30000000000001, 38.300000000000026, -50.00000000000044, 16.699999999999797, -50.00000000000044, -50.00000000000044, 38.300000000000026, 41.90000000000001, -50.00000000000044, -50.00000000000044, 42.70000000000001, 34.900000000000034, 41.70000000000002, 45.9, 27.899999999999956, 43.900000000000006, -50.00000000000044, 29.899999999999984, 43.900000000000006, 43.50000000000001, 46.099999999999994, 44.5, 37.90000000000003, 41.70000000000002, -50.00000000000044, -50.00000000000044, 19.69999999999984, 38.90000000000002, 43.30000000000001, 39.10000000000002, -50.00000000000044, -50.00000000000044, 46.5, 29.899999999999984, 25.499999999999922, -50.00000000000044, 45.3, 28.89999999999997, 28.499999999999964, 44.7, 20.49999999999985, 32.100000000000016, 43.10000000000001, -50.00000000000044, -50.00000000000044, 45.9, 44.10000000000001, -50.00000000000044, 34.70000000000004, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 41.500000000000014, -50.00000000000044, 27.49999999999995, -50.00000000000044, -50.00000000000044, 36.10000000000004, -50.00000000000044, 42.70000000000001, -50.00000000000044, 43.30000000000001, 41.100000000000016, 34.70000000000004, -50.00000000000044, 23.8999999999999, 45.1, 45.1, -50.00000000000044, 41.500000000000014, 46.099999999999994, -50.00000000000044, 30.9, -50.00000000000044, -50.00000000000044, 37.90000000000003, 47.3, 45.1, 11.29999999999972], "episode_lengths": [60, 500, 42, 500, 34, 132, 232, 500, 274, 100, 88, 234, 500, 126, 500, 382, 500, 70, 78, 118, 500, 334, 500, 500, 118, 82, 500, 500, 74, 152, 84, 42, 222, 62, 500, 202, 62, 66, 40, 56, 122, 84, 500, 500, 304, 112, 68, 110, 500, 500, 36, 202, 246, 500, 48, 212, 216, 54, 296, 180, 70, 500, 500, 42, 60, 500, 154, 500, 38, 500, 500, 500, 44, 86, 500, 226, 500, 500, 140, 500, 74, 500, 68, 90, 154, 500, 262, 50, 50, 500, 86, 40, 500, 192, 500, 500, 122, 28, 50, 388]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.377307823149088, "mean_inference_ms": 1.2118206654149584, "mean_action_processing_ms": 0.13928603761641237, "mean_env_wait_ms": 0.0836357056411387, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02300095558166504, "StateBufferConnector_ms": 0.0029997825622558594, "ViewRequirementAgentConnector_ms": 0.11599421501159668}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.695999999999838, "episode_len_mean": 253.7, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.10000000000001, -50.00000000000044, 45.9, -50.00000000000044, 46.699999999999996, 36.900000000000034, 26.89999999999994, -50.00000000000044, 22.699999999999882, 40.10000000000002, 41.30000000000001, 26.69999999999994, -50.00000000000044, 37.50000000000003, -50.00000000000044, 11.899999999999729, -50.00000000000044, 43.10000000000001, 42.30000000000001, 38.300000000000026, -50.00000000000044, 16.699999999999797, -50.00000000000044, -50.00000000000044, 38.300000000000026, 41.90000000000001, -50.00000000000044, -50.00000000000044, 42.70000000000001, 34.900000000000034, 41.70000000000002, 45.9, 27.899999999999956, 43.900000000000006, -50.00000000000044, 29.899999999999984, 43.900000000000006, 43.50000000000001, 46.099999999999994, 44.5, 37.90000000000003, 41.70000000000002, -50.00000000000044, -50.00000000000044, 19.69999999999984, 38.90000000000002, 43.30000000000001, 39.10000000000002, -50.00000000000044, -50.00000000000044, 46.5, 29.899999999999984, 25.499999999999922, -50.00000000000044, 45.3, 28.89999999999997, 28.499999999999964, 44.7, 20.49999999999985, 32.100000000000016, 43.10000000000001, -50.00000000000044, -50.00000000000044, 45.9, 44.10000000000001, -50.00000000000044, 34.70000000000004, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 41.500000000000014, -50.00000000000044, 27.49999999999995, -50.00000000000044, -50.00000000000044, 36.10000000000004, -50.00000000000044, 42.70000000000001, -50.00000000000044, 43.30000000000001, 41.100000000000016, 34.70000000000004, -50.00000000000044, 23.8999999999999, 45.1, 45.1, -50.00000000000044, 41.500000000000014, 46.099999999999994, -50.00000000000044, 30.9, -50.00000000000044, -50.00000000000044, 37.90000000000003, 47.3, 45.1, 11.29999999999972], "episode_lengths": [60, 500, 42, 500, 34, 132, 232, 500, 274, 100, 88, 234, 500, 126, 500, 382, 500, 70, 78, 118, 500, 334, 500, 500, 118, 82, 500, 500, 74, 152, 84, 42, 222, 62, 500, 202, 62, 66, 40, 56, 122, 84, 500, 500, 304, 112, 68, 110, 500, 500, 36, 202, 246, 500, 48, 212, 216, 54, 296, 180, 70, 500, 500, 42, 60, 500, 154, 500, 38, 500, 500, 500, 44, 86, 500, 226, 500, 500, 140, 500, 74, 500, 68, 90, 154, 500, 262, 50, 50, 500, 86, 40, 500, 192, 500, 500, 122, 28, 50, 388]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.377307823149088, "mean_inference_ms": 1.2118206654149584, "mean_action_processing_ms": 0.13928603761641237, "mean_env_wait_ms": 0.0836357056411387, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02300095558166504, "StateBufferConnector_ms": 0.0029997825622558594, "ViewRequirementAgentConnector_ms": 0.11599421501159668}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1164000, "num_agent_steps_trained": 1164000, "num_env_steps_sampled": 1164000, "num_env_steps_trained": 1164000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4929.169671194114, "num_env_steps_trained_throughput_per_sec": 4929.169671194114, "timesteps_total": 1164000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1164000, "timers": {"training_iteration_time_ms": 2230.809, "sample_time_ms": 1957.719, "load_time_ms": 12.921, "load_throughput": 928691.59, "learn_time_ms": 248.944, "learn_throughput": 48203.687, "synch_weights_time_ms": 9.527}, "counters": {"num_env_steps_sampled": 1164000, "num_env_steps_trained": 1164000, "num_agent_steps_sampled": 1164000, "num_agent_steps_trained": 1164000}, "done": false, "episodes_total": 4409, "training_iteration": 97, "trial_id": "9f288_00016", "date": "2023-10-25_16-55-07", "timestamp": 1698249307, "time_this_iter_s": 2.4404869079589844, "time_total_s": 212.2792136669159, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 212.2792136669159, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 58.26666666666667, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.2621774483536191e-30, "cur_lr": 0.0003, "total_loss": 6.528480105929905, "policy_loss": -0.00041579662097824947, "vf_loss": 6.5289482805464, "vf_explained_var": -7.947285970052084e-07, "kl": 0.0006007001219201255, "entropy": 0.5241524312231276, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1755.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1176000, "num_env_steps_trained": 1176000, "num_agent_steps_sampled": 1176000, "num_agent_steps_trained": 1176000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.2579999999998144, "episode_len_mean": 268.02, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19.69999999999984, 38.90000000000002, 43.30000000000001, 39.10000000000002, -50.00000000000044, -50.00000000000044, 46.5, 29.899999999999984, 25.499999999999922, -50.00000000000044, 45.3, 28.89999999999997, 28.499999999999964, 44.7, 20.49999999999985, 32.100000000000016, 43.10000000000001, -50.00000000000044, -50.00000000000044, 45.9, 44.10000000000001, -50.00000000000044, 34.70000000000004, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 41.500000000000014, -50.00000000000044, 27.49999999999995, -50.00000000000044, -50.00000000000044, 36.10000000000004, -50.00000000000044, 42.70000000000001, -50.00000000000044, 43.30000000000001, 41.100000000000016, 34.70000000000004, -50.00000000000044, 23.8999999999999, 45.1, 45.1, -50.00000000000044, 41.500000000000014, 46.099999999999994, -50.00000000000044, 30.9, -50.00000000000044, -50.00000000000044, 37.90000000000003, 47.3, 45.1, 11.29999999999972, 33.500000000000036, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 42.10000000000001, 41.500000000000014, 44.900000000000006, 45.3, 44.5, 45.5, 42.10000000000001, 16.499999999999794, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.09999999999996, 47.5, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, 46.099999999999994, 33.70000000000004, -50.00000000000044, -50.00000000000044, 45.3, 44.7, 46.5, 22.49999999999988, -50.00000000000044, 44.5, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044], "episode_lengths": [304, 112, 68, 110, 500, 500, 36, 202, 246, 500, 48, 212, 216, 54, 296, 180, 70, 500, 500, 42, 60, 500, 154, 500, 38, 500, 500, 500, 44, 86, 500, 226, 500, 500, 140, 500, 74, 500, 68, 90, 154, 500, 262, 50, 50, 500, 86, 40, 500, 192, 500, 500, 122, 28, 50, 388, 166, 32, 500, 500, 500, 500, 500, 40, 500, 80, 86, 52, 48, 56, 46, 80, 336, 500, 500, 500, 220, 26, 86, 500, 500, 500, 88, 500, 40, 164, 500, 500, 48, 54, 36, 276, 500, 56, 500, 50, 500, 500, 38, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3776433605623668, "mean_inference_ms": 1.2105290803323836, "mean_action_processing_ms": 0.13908977610375778, "mean_env_wait_ms": 0.08333214205245193, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019002676010131836, "StateBufferConnector_ms": 0.002998828887939453, "ViewRequirementAgentConnector_ms": 0.11201238632202148}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.2579999999998144, "episode_len_mean": 268.02, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [19.69999999999984, 38.90000000000002, 43.30000000000001, 39.10000000000002, -50.00000000000044, -50.00000000000044, 46.5, 29.899999999999984, 25.499999999999922, -50.00000000000044, 45.3, 28.89999999999997, 28.499999999999964, 44.7, 20.49999999999985, 32.100000000000016, 43.10000000000001, -50.00000000000044, -50.00000000000044, 45.9, 44.10000000000001, -50.00000000000044, 34.70000000000004, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 41.500000000000014, -50.00000000000044, 27.49999999999995, -50.00000000000044, -50.00000000000044, 36.10000000000004, -50.00000000000044, 42.70000000000001, -50.00000000000044, 43.30000000000001, 41.100000000000016, 34.70000000000004, -50.00000000000044, 23.8999999999999, 45.1, 45.1, -50.00000000000044, 41.500000000000014, 46.099999999999994, -50.00000000000044, 30.9, -50.00000000000044, -50.00000000000044, 37.90000000000003, 47.3, 45.1, 11.29999999999972, 33.500000000000036, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 42.10000000000001, 41.500000000000014, 44.900000000000006, 45.3, 44.5, 45.5, 42.10000000000001, 16.499999999999794, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.09999999999996, 47.5, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, 46.099999999999994, 33.70000000000004, -50.00000000000044, -50.00000000000044, 45.3, 44.7, 46.5, 22.49999999999988, -50.00000000000044, 44.5, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044], "episode_lengths": [304, 112, 68, 110, 500, 500, 36, 202, 246, 500, 48, 212, 216, 54, 296, 180, 70, 500, 500, 42, 60, 500, 154, 500, 38, 500, 500, 500, 44, 86, 500, 226, 500, 500, 140, 500, 74, 500, 68, 90, 154, 500, 262, 50, 50, 500, 86, 40, 500, 192, 500, 500, 122, 28, 50, 388, 166, 32, 500, 500, 500, 500, 500, 40, 500, 80, 86, 52, 48, 56, 46, 80, 336, 500, 500, 500, 220, 26, 86, 500, 500, 500, 88, 500, 40, 164, 500, 500, 48, 54, 36, 276, 500, 56, 500, 50, 500, 500, 38, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3776433605623668, "mean_inference_ms": 1.2105290803323836, "mean_action_processing_ms": 0.13908977610375778, "mean_env_wait_ms": 0.08333214205245193, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019002676010131836, "StateBufferConnector_ms": 0.002998828887939453, "ViewRequirementAgentConnector_ms": 0.11201238632202148}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1176000, "num_agent_steps_trained": 1176000, "num_env_steps_sampled": 1176000, "num_env_steps_trained": 1176000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5811.133156953763, "num_env_steps_trained_throughput_per_sec": 5811.133156953763, "timesteps_total": 1176000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1176000, "timers": {"training_iteration_time_ms": 2225.626, "sample_time_ms": 1956.718, "load_time_ms": 12.722, "load_throughput": 943264.454, "learn_time_ms": 244.957, "learn_throughput": 48988.258, "synch_weights_time_ms": 9.63}, "counters": {"num_env_steps_sampled": 1176000, "num_env_steps_trained": 1176000, "num_agent_steps_sampled": 1176000, "num_agent_steps_trained": 1176000}, "done": false, "episodes_total": 4453, "training_iteration": 98, "trial_id": "9f288_00016", "date": "2023-10-25_16-55-09", "timestamp": 1698249309, "time_this_iter_s": 2.070000410079956, "time_total_s": 214.34921407699585, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 214.34921407699585, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 50.93333333333334, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.310887241768096e-31, "cur_lr": 0.0003, "total_loss": 6.190658595826891, "policy_loss": -9.88453005750974e-05, "vf_loss": 6.190808958477444, "vf_explained_var": -9.27183363172743e-07, "kl": 0.00017452838303850312, "entropy": 0.5153420137034522, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1773.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1188000, "num_env_steps_trained": 1188000, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.085999999999816, "episode_len_mean": 259.74, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.099999999999994, -50.00000000000044, 30.9, -50.00000000000044, -50.00000000000044, 37.90000000000003, 47.3, 45.1, 11.29999999999972, 33.500000000000036, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 42.10000000000001, 41.500000000000014, 44.900000000000006, 45.3, 44.5, 45.5, 42.10000000000001, 16.499999999999794, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.09999999999996, 47.5, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, 46.099999999999994, 33.70000000000004, -50.00000000000044, -50.00000000000044, 45.3, 44.7, 46.5, 22.49999999999988, -50.00000000000044, 44.5, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 40.30000000000002, 35.900000000000034, 45.7, -50.00000000000044, 43.50000000000001, 26.89999999999994, 39.70000000000002, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.499999999999964, 45.9, 42.900000000000006, 41.100000000000016, 27.899999999999956, -50.00000000000044, 44.300000000000004, -50.00000000000044, 45.7, -50.00000000000044, 45.7, 45.3, 29.299999999999976, 41.500000000000014, 15.49999999999978, 39.10000000000002, 37.300000000000026, 44.5, -50.00000000000044, 45.7, 40.90000000000002, 45.5, -50.00000000000044, -50.00000000000044, 47.9, 46.5, 38.300000000000026, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044], "episode_lengths": [40, 500, 192, 500, 500, 122, 28, 50, 388, 166, 32, 500, 500, 500, 500, 500, 40, 500, 80, 86, 52, 48, 56, 46, 80, 336, 500, 500, 500, 220, 26, 86, 500, 500, 500, 88, 500, 40, 164, 500, 500, 48, 54, 36, 276, 500, 56, 500, 50, 500, 500, 38, 500, 500, 98, 142, 44, 500, 66, 232, 104, 500, 62, 500, 500, 500, 216, 42, 72, 90, 222, 500, 58, 500, 44, 500, 44, 48, 208, 86, 346, 110, 128, 56, 500, 44, 92, 46, 500, 500, 22, 36, 118, 36, 500, 500, 500, 500, 38, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.377451159481099, "mean_inference_ms": 1.2105605319861998, "mean_action_processing_ms": 0.13900911747480946, "mean_env_wait_ms": 0.08322027940406436, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019122600555419922, "StateBufferConnector_ms": 0.003000020980834961, "ViewRequirementAgentConnector_ms": 0.10100150108337402}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.085999999999816, "episode_len_mean": 259.74, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.099999999999994, -50.00000000000044, 30.9, -50.00000000000044, -50.00000000000044, 37.90000000000003, 47.3, 45.1, 11.29999999999972, 33.500000000000036, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 42.10000000000001, 41.500000000000014, 44.900000000000006, 45.3, 44.5, 45.5, 42.10000000000001, 16.499999999999794, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.09999999999996, 47.5, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, 46.099999999999994, 33.70000000000004, -50.00000000000044, -50.00000000000044, 45.3, 44.7, 46.5, 22.49999999999988, -50.00000000000044, 44.5, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 40.30000000000002, 35.900000000000034, 45.7, -50.00000000000044, 43.50000000000001, 26.89999999999994, 39.70000000000002, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.499999999999964, 45.9, 42.900000000000006, 41.100000000000016, 27.899999999999956, -50.00000000000044, 44.300000000000004, -50.00000000000044, 45.7, -50.00000000000044, 45.7, 45.3, 29.299999999999976, 41.500000000000014, 15.49999999999978, 39.10000000000002, 37.300000000000026, 44.5, -50.00000000000044, 45.7, 40.90000000000002, 45.5, -50.00000000000044, -50.00000000000044, 47.9, 46.5, 38.300000000000026, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044], "episode_lengths": [40, 500, 192, 500, 500, 122, 28, 50, 388, 166, 32, 500, 500, 500, 500, 500, 40, 500, 80, 86, 52, 48, 56, 46, 80, 336, 500, 500, 500, 220, 26, 86, 500, 500, 500, 88, 500, 40, 164, 500, 500, 48, 54, 36, 276, 500, 56, 500, 50, 500, 500, 38, 500, 500, 98, 142, 44, 500, 66, 232, 104, 500, 62, 500, 500, 500, 216, 42, 72, 90, 222, 500, 58, 500, 44, 500, 44, 48, 208, 86, 346, 110, 128, 56, 500, 44, 92, 46, 500, 500, 22, 36, 118, 36, 500, 500, 500, 500, 38, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.377451159481099, "mean_inference_ms": 1.2105605319861998, "mean_action_processing_ms": 0.13900911747480946, "mean_env_wait_ms": 0.08322027940406436, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019122600555419922, "StateBufferConnector_ms": 0.003000020980834961, "ViewRequirementAgentConnector_ms": 0.10100150108337402}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000, "num_env_steps_sampled": 1188000, "num_env_steps_trained": 1188000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5281.182324934748, "num_env_steps_trained_throughput_per_sec": 5281.182324934748, "timesteps_total": 1188000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1188000, "timers": {"training_iteration_time_ms": 2230.866, "sample_time_ms": 1955.448, "load_time_ms": 12.951, "load_throughput": 926583.554, "learn_time_ms": 251.135, "learn_throughput": 47783.012, "synch_weights_time_ms": 9.733}, "counters": {"num_env_steps_sampled": 1188000, "num_env_steps_trained": 1188000, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000}, "done": false, "episodes_total": 4500, "training_iteration": 99, "trial_id": "9f288_00016", "date": "2023-10-25_16-55-11", "timestamp": 1698249311, "time_this_iter_s": 2.276216745376587, "time_total_s": 216.62543082237244, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 216.62543082237244, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 61.9, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.155443620884048e-31, "cur_lr": 0.0003, "total_loss": 6.4434883329603405, "policy_loss": -0.00016217598588102392, "vf_loss": 6.44369830025567, "vf_explained_var": -8.245309193929037e-07, "kl": 0.00017733083148622578, "entropy": 0.476523800028695, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1791.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1200000, "num_env_steps_trained": 1200000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.363999999999819, "episode_len_mean": 256.98, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 40.30000000000002, 35.900000000000034, 45.7, -50.00000000000044, 43.50000000000001, 26.89999999999994, 39.70000000000002, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.499999999999964, 45.9, 42.900000000000006, 41.100000000000016, 27.899999999999956, -50.00000000000044, 44.300000000000004, -50.00000000000044, 45.7, -50.00000000000044, 45.7, 45.3, 29.299999999999976, 41.500000000000014, 15.49999999999978, 39.10000000000002, 37.300000000000026, 44.5, -50.00000000000044, 45.7, 40.90000000000002, 45.5, -50.00000000000044, -50.00000000000044, 47.9, 46.5, 38.300000000000026, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 43.50000000000001, -50.00000000000044, 38.50000000000003, 44.7, 43.900000000000006, 8.699999999999683, 46.5, 45.9, 37.50000000000003, -50.00000000000044, 42.900000000000006, -50.00000000000044, 36.10000000000004, 45.1, 43.30000000000001, 10.299999999999706, 38.300000000000026, -50.00000000000044, -50.00000000000044, 32.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 12.69999999999974, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 45.3, 45.7, 45.9, 45.9, 42.500000000000014, -50.00000000000044, -50.00000000000044, 36.50000000000003, 45.9, -50.00000000000044, 45.7, 10.099999999999703, 26.09999999999993, 41.100000000000016, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 50, 500, 500, 38, 500, 500, 98, 142, 44, 500, 66, 232, 104, 500, 62, 500, 500, 500, 216, 42, 72, 90, 222, 500, 58, 500, 44, 500, 44, 48, 208, 86, 346, 110, 128, 56, 500, 44, 92, 46, 500, 500, 22, 36, 118, 36, 500, 500, 500, 500, 38, 500, 66, 500, 116, 54, 62, 414, 36, 42, 126, 500, 72, 500, 140, 50, 68, 398, 118, 500, 500, 178, 500, 500, 500, 374, 26, 500, 500, 500, 38, 48, 44, 42, 42, 76, 500, 500, 136, 42, 500, 44, 400, 240, 90, 500, 78, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3771985506708354, "mean_inference_ms": 1.2098347230559405, "mean_action_processing_ms": 0.1392045610382589, "mean_env_wait_ms": 0.0831203415901183, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020121335983276367, "StateBufferConnector_ms": 0.003998517990112305, "ViewRequirementAgentConnector_ms": 0.11002159118652344}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.363999999999819, "episode_len_mean": 256.98, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 40.30000000000002, 35.900000000000034, 45.7, -50.00000000000044, 43.50000000000001, 26.89999999999994, 39.70000000000002, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.499999999999964, 45.9, 42.900000000000006, 41.100000000000016, 27.899999999999956, -50.00000000000044, 44.300000000000004, -50.00000000000044, 45.7, -50.00000000000044, 45.7, 45.3, 29.299999999999976, 41.500000000000014, 15.49999999999978, 39.10000000000002, 37.300000000000026, 44.5, -50.00000000000044, 45.7, 40.90000000000002, 45.5, -50.00000000000044, -50.00000000000044, 47.9, 46.5, 38.300000000000026, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 43.50000000000001, -50.00000000000044, 38.50000000000003, 44.7, 43.900000000000006, 8.699999999999683, 46.5, 45.9, 37.50000000000003, -50.00000000000044, 42.900000000000006, -50.00000000000044, 36.10000000000004, 45.1, 43.30000000000001, 10.299999999999706, 38.300000000000026, -50.00000000000044, -50.00000000000044, 32.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 12.69999999999974, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 45.3, 45.7, 45.9, 45.9, 42.500000000000014, -50.00000000000044, -50.00000000000044, 36.50000000000003, 45.9, -50.00000000000044, 45.7, 10.099999999999703, 26.09999999999993, 41.100000000000016, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 50, 500, 500, 38, 500, 500, 98, 142, 44, 500, 66, 232, 104, 500, 62, 500, 500, 500, 216, 42, 72, 90, 222, 500, 58, 500, 44, 500, 44, 48, 208, 86, 346, 110, 128, 56, 500, 44, 92, 46, 500, 500, 22, 36, 118, 36, 500, 500, 500, 500, 38, 500, 66, 500, 116, 54, 62, 414, 36, 42, 126, 500, 72, 500, 140, 50, 68, 398, 118, 500, 500, 178, 500, 500, 500, 374, 26, 500, 500, 500, 38, 48, 44, 42, 42, 76, 500, 500, 136, 42, 500, 44, 400, 240, 90, 500, 78, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3771985506708354, "mean_inference_ms": 1.2098347230559405, "mean_action_processing_ms": 0.1392045610382589, "mean_env_wait_ms": 0.0831203415901183, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020121335983276367, "StateBufferConnector_ms": 0.003998517990112305, "ViewRequirementAgentConnector_ms": 0.11002159118652344}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000, "num_env_steps_sampled": 1200000, "num_env_steps_trained": 1200000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5661.863183581787, "num_env_steps_trained_throughput_per_sec": 5661.863183581787, "timesteps_total": 1200000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1200000, "timers": {"training_iteration_time_ms": 2230.879, "sample_time_ms": 1954.792, "load_time_ms": 12.851, "load_throughput": 933784.682, "learn_time_ms": 251.992, "learn_throughput": 47620.629, "synch_weights_time_ms": 9.732}, "counters": {"num_env_steps_sampled": 1200000, "num_env_steps_trained": 1200000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "done": false, "episodes_total": 4547, "training_iteration": 100, "trial_id": "9f288_00016", "date": "2023-10-25_16-55-14", "timestamp": 1698249314, "time_this_iter_s": 2.1244421005249023, "time_total_s": 218.74987292289734, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 218.74987292289734, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 54.666666666666664, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.577721810442024e-31, "cur_lr": 0.0003, "total_loss": 6.75351881980896, "policy_loss": -0.00013053365465667512, "vf_loss": 6.753695567448934, "vf_explained_var": -1.1391109890407986e-06, "kl": 0.0003163243424827063, "entropy": 0.4605685422817866, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1809.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1212000, "num_env_steps_trained": 1212000, "num_agent_steps_sampled": 1212000, "num_agent_steps_trained": 1212000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.841999999999835, "episode_len_mean": 242.24, "episode_media": {}, "episodes_this_iter": 54, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 38.50000000000003, 44.7, 43.900000000000006, 8.699999999999683, 46.5, 45.9, 37.50000000000003, -50.00000000000044, 42.900000000000006, -50.00000000000044, 36.10000000000004, 45.1, 43.30000000000001, 10.299999999999706, 38.300000000000026, -50.00000000000044, -50.00000000000044, 32.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 12.69999999999974, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 45.3, 45.7, 45.9, 45.9, 42.500000000000014, -50.00000000000044, -50.00000000000044, 36.50000000000003, 45.9, -50.00000000000044, 45.7, 10.099999999999703, 26.09999999999993, 41.100000000000016, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, 42.900000000000006, 44.7, 21.299999999999862, -50.00000000000044, 43.30000000000001, 40.70000000000002, 37.70000000000003, 30.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 39.50000000000002, -50.00000000000044, -50.00000000000044, 45.9, 44.900000000000006, 42.70000000000001, 46.9, 46.3, 46.3, 45.5, -50.00000000000044, 17.899999999999814, 45.9, 43.900000000000006, 31.300000000000004, -50.00000000000044, 44.7, 25.899999999999928, -50.00000000000044, 45.7, 33.10000000000003, -50.00000000000044, 44.5, -50.00000000000044, 45.1, -50.00000000000044, 46.5, 47.3, 27.899999999999956, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 46.099999999999994, 47.5, 16.699999999999797, 44.900000000000006, -50.00000000000044, 40.500000000000014], "episode_lengths": [500, 116, 54, 62, 414, 36, 42, 126, 500, 72, 500, 140, 50, 68, 398, 118, 500, 500, 178, 500, 500, 500, 374, 26, 500, 500, 500, 38, 48, 44, 42, 42, 76, 500, 500, 136, 42, 500, 44, 400, 240, 90, 500, 78, 500, 500, 500, 94, 72, 54, 288, 500, 68, 94, 124, 192, 500, 500, 500, 40, 106, 500, 500, 42, 52, 74, 32, 38, 38, 46, 500, 322, 42, 62, 188, 500, 54, 242, 500, 44, 170, 500, 56, 500, 50, 500, 36, 28, 222, 80, 500, 500, 500, 32, 40, 26, 334, 52, 500, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37693179143070393, "mean_inference_ms": 1.2098712286723892, "mean_action_processing_ms": 0.13924720975203925, "mean_env_wait_ms": 0.08333933812602363, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024990081787109375, "StateBufferConnector_ms": 0.0029990673065185547, "ViewRequirementAgentConnector_ms": 0.12201261520385742}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.841999999999835, "episode_len_mean": 242.24, "episodes_this_iter": 54, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 38.50000000000003, 44.7, 43.900000000000006, 8.699999999999683, 46.5, 45.9, 37.50000000000003, -50.00000000000044, 42.900000000000006, -50.00000000000044, 36.10000000000004, 45.1, 43.30000000000001, 10.299999999999706, 38.300000000000026, -50.00000000000044, -50.00000000000044, 32.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 12.69999999999974, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 45.3, 45.7, 45.9, 45.9, 42.500000000000014, -50.00000000000044, -50.00000000000044, 36.50000000000003, 45.9, -50.00000000000044, 45.7, 10.099999999999703, 26.09999999999993, 41.100000000000016, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, 42.900000000000006, 44.7, 21.299999999999862, -50.00000000000044, 43.30000000000001, 40.70000000000002, 37.70000000000003, 30.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 39.50000000000002, -50.00000000000044, -50.00000000000044, 45.9, 44.900000000000006, 42.70000000000001, 46.9, 46.3, 46.3, 45.5, -50.00000000000044, 17.899999999999814, 45.9, 43.900000000000006, 31.300000000000004, -50.00000000000044, 44.7, 25.899999999999928, -50.00000000000044, 45.7, 33.10000000000003, -50.00000000000044, 44.5, -50.00000000000044, 45.1, -50.00000000000044, 46.5, 47.3, 27.899999999999956, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 46.099999999999994, 47.5, 16.699999999999797, 44.900000000000006, -50.00000000000044, 40.500000000000014], "episode_lengths": [500, 116, 54, 62, 414, 36, 42, 126, 500, 72, 500, 140, 50, 68, 398, 118, 500, 500, 178, 500, 500, 500, 374, 26, 500, 500, 500, 38, 48, 44, 42, 42, 76, 500, 500, 136, 42, 500, 44, 400, 240, 90, 500, 78, 500, 500, 500, 94, 72, 54, 288, 500, 68, 94, 124, 192, 500, 500, 500, 40, 106, 500, 500, 42, 52, 74, 32, 38, 38, 46, 500, 322, 42, 62, 188, 500, 54, 242, 500, 44, 170, 500, 56, 500, 50, 500, 36, 28, 222, 80, 500, 500, 500, 32, 40, 26, 334, 52, 500, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37693179143070393, "mean_inference_ms": 1.2098712286723892, "mean_action_processing_ms": 0.13924720975203925, "mean_env_wait_ms": 0.08333933812602363, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024990081787109375, "StateBufferConnector_ms": 0.0029990673065185547, "ViewRequirementAgentConnector_ms": 0.12201261520385742}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1212000, "num_agent_steps_trained": 1212000, "num_env_steps_sampled": 1212000, "num_env_steps_trained": 1212000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5423.6987724824785, "num_env_steps_trained_throughput_per_sec": 5423.6987724824785, "timesteps_total": 1212000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1212000, "timers": {"training_iteration_time_ms": 2191.977, "sample_time_ms": 1921.913, "load_time_ms": 12.851, "load_throughput": 933770.823, "learn_time_ms": 245.998, "learn_throughput": 48780.851, "synch_weights_time_ms": 9.615}, "counters": {"num_env_steps_sampled": 1212000, "num_env_steps_trained": 1212000, "num_agent_steps_sampled": 1212000, "num_agent_steps_trained": 1212000}, "done": false, "episodes_total": 4601, "training_iteration": 101, "trial_id": "9f288_00016", "date": "2023-10-25_16-55-16", "timestamp": 1698249316, "time_this_iter_s": 2.2175114154815674, "time_total_s": 220.9673843383789, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 220.9673843383789, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 54.15, "ram_util_percent": 27.224999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.88860905221012e-32, "cur_lr": 0.0003, "total_loss": 6.730797741148207, "policy_loss": -0.00014682052036126456, "vf_loss": 6.730988370047675, "vf_explained_var": -7.020102606879341e-07, "kl": 0.00018782066800011106, "entropy": 0.43805412616994643, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1827.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1224000, "num_env_steps_trained": 1224000, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.810999999999838, "episode_len_mean": 237.54, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.900000000000006, 44.7, 21.299999999999862, -50.00000000000044, 43.30000000000001, 40.70000000000002, 37.70000000000003, 30.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 39.50000000000002, -50.00000000000044, -50.00000000000044, 45.9, 44.900000000000006, 42.70000000000001, 46.9, 46.3, 46.3, 45.5, -50.00000000000044, 17.899999999999814, 45.9, 43.900000000000006, 31.300000000000004, -50.00000000000044, 44.7, 25.899999999999928, -50.00000000000044, 45.7, 33.10000000000003, -50.00000000000044, 44.5, -50.00000000000044, 45.1, -50.00000000000044, 46.5, 47.3, 27.899999999999956, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 46.099999999999994, 47.5, 16.699999999999797, 44.900000000000006, -50.00000000000044, 40.500000000000014, -50.00000000000044, 46.9, -50.00000000000044, 35.30000000000004, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 25.29999999999992, 46.099999999999994, -50.00000000000044, 46.9, 44.300000000000004, -50.00000000000044, 47.3, 44.7, -50.00000000000044, 41.30000000000001, 41.30000000000001, 33.10000000000003, -50.00000000000044, 45.7, 47.1, 46.699999999999996, 43.7, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 10.099999999999703, 35.70000000000003, 47.7, 36.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002, -50.00000000000044, 43.50000000000001, 41.70000000000002, 31.70000000000001, 45.7, -50.00000000000044, 46.9, 47.3, -50.00000000000044, 32.50000000000002, -50.00000000000044], "episode_lengths": [72, 54, 288, 500, 68, 94, 124, 192, 500, 500, 500, 40, 106, 500, 500, 42, 52, 74, 32, 38, 38, 46, 500, 322, 42, 62, 188, 500, 54, 242, 500, 44, 170, 500, 56, 500, 50, 500, 36, 28, 222, 80, 500, 500, 500, 32, 40, 26, 334, 52, 500, 96, 500, 32, 500, 148, 500, 500, 58, 500, 248, 40, 500, 32, 58, 500, 28, 54, 500, 88, 88, 170, 500, 44, 30, 34, 64, 80, 500, 500, 500, 400, 144, 24, 134, 500, 500, 500, 106, 500, 66, 84, 184, 44, 500, 32, 28, 500, 176, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37737114126260607, "mean_inference_ms": 1.2095497680526608, "mean_action_processing_ms": 0.13912912482018625, "mean_env_wait_ms": 0.0833919159877874, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027007102966308594, "StateBufferConnector_ms": 0.0020012855529785156, "ViewRequirementAgentConnector_ms": 0.12698054313659668}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.810999999999838, "episode_len_mean": 237.54, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.900000000000006, 44.7, 21.299999999999862, -50.00000000000044, 43.30000000000001, 40.70000000000002, 37.70000000000003, 30.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 39.50000000000002, -50.00000000000044, -50.00000000000044, 45.9, 44.900000000000006, 42.70000000000001, 46.9, 46.3, 46.3, 45.5, -50.00000000000044, 17.899999999999814, 45.9, 43.900000000000006, 31.300000000000004, -50.00000000000044, 44.7, 25.899999999999928, -50.00000000000044, 45.7, 33.10000000000003, -50.00000000000044, 44.5, -50.00000000000044, 45.1, -50.00000000000044, 46.5, 47.3, 27.899999999999956, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 46.099999999999994, 47.5, 16.699999999999797, 44.900000000000006, -50.00000000000044, 40.500000000000014, -50.00000000000044, 46.9, -50.00000000000044, 35.30000000000004, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 25.29999999999992, 46.099999999999994, -50.00000000000044, 46.9, 44.300000000000004, -50.00000000000044, 47.3, 44.7, -50.00000000000044, 41.30000000000001, 41.30000000000001, 33.10000000000003, -50.00000000000044, 45.7, 47.1, 46.699999999999996, 43.7, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 10.099999999999703, 35.70000000000003, 47.7, 36.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002, -50.00000000000044, 43.50000000000001, 41.70000000000002, 31.70000000000001, 45.7, -50.00000000000044, 46.9, 47.3, -50.00000000000044, 32.50000000000002, -50.00000000000044], "episode_lengths": [72, 54, 288, 500, 68, 94, 124, 192, 500, 500, 500, 40, 106, 500, 500, 42, 52, 74, 32, 38, 38, 46, 500, 322, 42, 62, 188, 500, 54, 242, 500, 44, 170, 500, 56, 500, 50, 500, 36, 28, 222, 80, 500, 500, 500, 32, 40, 26, 334, 52, 500, 96, 500, 32, 500, 148, 500, 500, 58, 500, 248, 40, 500, 32, 58, 500, 28, 54, 500, 88, 88, 170, 500, 44, 30, 34, 64, 80, 500, 500, 500, 400, 144, 24, 134, 500, 500, 500, 106, 500, 66, 84, 184, 44, 500, 32, 28, 500, 176, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37737114126260607, "mean_inference_ms": 1.2095497680526608, "mean_action_processing_ms": 0.13912912482018625, "mean_env_wait_ms": 0.0833919159877874, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027007102966308594, "StateBufferConnector_ms": 0.0020012855529785156, "ViewRequirementAgentConnector_ms": 0.12698054313659668}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000, "num_env_steps_sampled": 1224000, "num_env_steps_trained": 1224000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5849.321847204864, "num_env_steps_trained_throughput_per_sec": 5849.321847204864, "timesteps_total": 1224000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1224000, "timers": {"training_iteration_time_ms": 2192.859, "sample_time_ms": 1916.49, "load_time_ms": 13.099, "load_throughput": 916080.259, "learn_time_ms": 251.854, "learn_throughput": 47646.596, "synch_weights_time_ms": 9.715}, "counters": {"num_env_steps_sampled": 1224000, "num_env_steps_trained": 1224000, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000}, "done": false, "episodes_total": 4649, "training_iteration": 102, "trial_id": "9f288_00016", "date": "2023-10-25_16-55-18", "timestamp": 1698249318, "time_this_iter_s": 2.056519031524658, "time_total_s": 223.02390336990356, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 223.02390336990356, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 63.85, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.94430452610506e-32, "cur_lr": 0.0003, "total_loss": 6.263232549031575, "policy_loss": -0.00014578799406687418, "vf_loss": 6.263417853249444, "vf_explained_var": -1.105997297498915e-06, "kl": 0.00011623674108799757, "entropy": 0.39623893797397614, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1845.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1236000, "num_env_steps_trained": 1236000, "num_agent_steps_sampled": 1236000, "num_agent_steps_trained": 1236000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.843999999999831, "episode_len_mean": 242.18, "episode_media": {}, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.500000000000014, -50.00000000000044, 46.9, -50.00000000000044, 35.30000000000004, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 25.29999999999992, 46.099999999999994, -50.00000000000044, 46.9, 44.300000000000004, -50.00000000000044, 47.3, 44.7, -50.00000000000044, 41.30000000000001, 41.30000000000001, 33.10000000000003, -50.00000000000044, 45.7, 47.1, 46.699999999999996, 43.7, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 10.099999999999703, 35.70000000000003, 47.7, 36.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002, -50.00000000000044, 43.50000000000001, 41.70000000000002, 31.70000000000001, 45.7, -50.00000000000044, 46.9, 47.3, -50.00000000000044, 32.50000000000002, -50.00000000000044, 23.099999999999888, 42.900000000000006, 45.9, -50.00000000000044, 47.3, 46.5, 46.5, -50.00000000000044, 43.900000000000006, 47.1, 45.5, 43.50000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, 43.30000000000001, 26.499999999999936, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 44.900000000000006, 46.099999999999994, 32.30000000000002, -50.00000000000044, 47.5, 41.90000000000001, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 47.7, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 39.300000000000026, 47.3, 47.3, 23.29999999999989, -50.00000000000044, 43.7, -50.00000000000044, 45.1, 39.10000000000002], "episode_lengths": [96, 500, 32, 500, 148, 500, 500, 58, 500, 248, 40, 500, 32, 58, 500, 28, 54, 500, 88, 88, 170, 500, 44, 30, 34, 64, 80, 500, 500, 500, 400, 144, 24, 134, 500, 500, 500, 106, 500, 66, 84, 184, 44, 500, 32, 28, 500, 176, 500, 270, 72, 42, 500, 28, 36, 36, 500, 62, 30, 46, 66, 40, 500, 500, 68, 236, 28, 500, 500, 500, 44, 52, 40, 178, 500, 26, 82, 500, 36, 500, 500, 500, 500, 54, 24, 500, 100, 500, 500, 500, 52, 108, 28, 28, 268, 500, 64, 500, 50, 110]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3774329965228593, "mean_inference_ms": 1.2089968602160726, "mean_action_processing_ms": 0.13895293827713148, "mean_env_wait_ms": 0.08308666338933327, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02100968360900879, "StateBufferConnector_ms": 0.004000425338745117, "ViewRequirementAgentConnector_ms": 0.12797975540161133}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.843999999999831, "episode_len_mean": 242.18, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [40.500000000000014, -50.00000000000044, 46.9, -50.00000000000044, 35.30000000000004, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 25.29999999999992, 46.099999999999994, -50.00000000000044, 46.9, 44.300000000000004, -50.00000000000044, 47.3, 44.7, -50.00000000000044, 41.30000000000001, 41.30000000000001, 33.10000000000003, -50.00000000000044, 45.7, 47.1, 46.699999999999996, 43.7, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 10.099999999999703, 35.70000000000003, 47.7, 36.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002, -50.00000000000044, 43.50000000000001, 41.70000000000002, 31.70000000000001, 45.7, -50.00000000000044, 46.9, 47.3, -50.00000000000044, 32.50000000000002, -50.00000000000044, 23.099999999999888, 42.900000000000006, 45.9, -50.00000000000044, 47.3, 46.5, 46.5, -50.00000000000044, 43.900000000000006, 47.1, 45.5, 43.50000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, 43.30000000000001, 26.499999999999936, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 44.900000000000006, 46.099999999999994, 32.30000000000002, -50.00000000000044, 47.5, 41.90000000000001, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 47.7, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 39.300000000000026, 47.3, 47.3, 23.29999999999989, -50.00000000000044, 43.7, -50.00000000000044, 45.1, 39.10000000000002], "episode_lengths": [96, 500, 32, 500, 148, 500, 500, 58, 500, 248, 40, 500, 32, 58, 500, 28, 54, 500, 88, 88, 170, 500, 44, 30, 34, 64, 80, 500, 500, 500, 400, 144, 24, 134, 500, 500, 500, 106, 500, 66, 84, 184, 44, 500, 32, 28, 500, 176, 500, 270, 72, 42, 500, 28, 36, 36, 500, 62, 30, 46, 66, 40, 500, 500, 68, 236, 28, 500, 500, 500, 44, 52, 40, 178, 500, 26, 82, 500, 36, 500, 500, 500, 500, 54, 24, 500, 100, 500, 500, 500, 52, 108, 28, 28, 268, 500, 64, 500, 50, 110]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3774329965228593, "mean_inference_ms": 1.2089968602160726, "mean_action_processing_ms": 0.13895293827713148, "mean_env_wait_ms": 0.08308666338933327, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02100968360900879, "StateBufferConnector_ms": 0.004000425338745117, "ViewRequirementAgentConnector_ms": 0.12797975540161133}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1236000, "num_agent_steps_trained": 1236000, "num_env_steps_sampled": 1236000, "num_env_steps_trained": 1236000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5193.447575808386, "num_env_steps_trained_throughput_per_sec": 5193.447575808386, "timesteps_total": 1236000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1236000, "timers": {"training_iteration_time_ms": 2207.165, "sample_time_ms": 1910.42, "load_time_ms": 13.7, "load_throughput": 875940.835, "learn_time_ms": 271.688, "learn_throughput": 44168.267, "synch_weights_time_ms": 9.756}, "counters": {"num_env_steps_sampled": 1236000, "num_env_steps_trained": 1236000, "num_agent_steps_sampled": 1236000, "num_agent_steps_trained": 1236000}, "done": false, "episodes_total": 4700, "training_iteration": 103, "trial_id": "9f288_00016", "date": "2023-10-25_16-55-20", "timestamp": 1698249320, "time_this_iter_s": 2.316599130630493, "time_total_s": 225.34050250053406, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 225.34050250053406, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 55.325, "ram_util_percent": 27.224999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.97215226305253e-32, "cur_lr": 0.0003, "total_loss": 6.196006218592326, "policy_loss": -0.00016589509323239326, "vf_loss": 6.196216503779094, "vf_explained_var": -7.549921671549479e-07, "kl": 0.00019187241919224916, "entropy": 0.44382033745447796, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1863.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1248000, "num_env_steps_trained": 1248000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.612999999999818, "episode_len_mean": 249.48, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.9, 47.3, -50.00000000000044, 32.50000000000002, -50.00000000000044, 23.099999999999888, 42.900000000000006, 45.9, -50.00000000000044, 47.3, 46.5, 46.5, -50.00000000000044, 43.900000000000006, 47.1, 45.5, 43.50000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, 43.30000000000001, 26.499999999999936, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 44.900000000000006, 46.099999999999994, 32.30000000000002, -50.00000000000044, 47.5, 41.90000000000001, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 47.7, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 39.300000000000026, 47.3, 47.3, 23.29999999999989, -50.00000000000044, 43.7, -50.00000000000044, 45.1, 39.10000000000002, 35.500000000000036, 44.7, -50.00000000000044, 46.9, 46.3, -50.00000000000044, 2.499999999999595, 44.900000000000006, 42.900000000000006, 43.7, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 45.1, 42.70000000000001, 24.099999999999902, -50.00000000000044, 18.499999999999822, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 12.899999999999743, -50.00000000000044, -50.00000000000044, 46.5, 44.10000000000001, 34.30000000000004, -50.00000000000044, 43.30000000000001, 40.30000000000002, -50.00000000000044, 47.3, 47.7, -50.00000000000044, 45.9, -50.00000000000044, 40.30000000000002, 46.699999999999996], "episode_lengths": [500, 32, 28, 500, 176, 500, 270, 72, 42, 500, 28, 36, 36, 500, 62, 30, 46, 66, 40, 500, 500, 68, 236, 28, 500, 500, 500, 44, 52, 40, 178, 500, 26, 82, 500, 36, 500, 500, 500, 500, 54, 24, 500, 100, 500, 500, 500, 52, 108, 28, 28, 268, 500, 64, 500, 50, 110, 146, 54, 500, 32, 38, 500, 476, 52, 72, 64, 500, 82, 500, 500, 500, 500, 46, 50, 74, 260, 500, 316, 500, 500, 500, 28, 372, 500, 500, 36, 60, 158, 500, 68, 98, 500, 28, 24, 500, 42, 500, 98, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3773329662808702, "mean_inference_ms": 1.2097205198290293, "mean_action_processing_ms": 0.1389475304457103, "mean_env_wait_ms": 0.08317850969903487, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022993803024291992, "StateBufferConnector_ms": 0.004000425338745117, "ViewRequirementAgentConnector_ms": 0.11501455307006836}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.612999999999818, "episode_len_mean": 249.48, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.9, 47.3, -50.00000000000044, 32.50000000000002, -50.00000000000044, 23.099999999999888, 42.900000000000006, 45.9, -50.00000000000044, 47.3, 46.5, 46.5, -50.00000000000044, 43.900000000000006, 47.1, 45.5, 43.50000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, 43.30000000000001, 26.499999999999936, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 44.900000000000006, 46.099999999999994, 32.30000000000002, -50.00000000000044, 47.5, 41.90000000000001, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 47.7, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 39.300000000000026, 47.3, 47.3, 23.29999999999989, -50.00000000000044, 43.7, -50.00000000000044, 45.1, 39.10000000000002, 35.500000000000036, 44.7, -50.00000000000044, 46.9, 46.3, -50.00000000000044, 2.499999999999595, 44.900000000000006, 42.900000000000006, 43.7, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 45.1, 42.70000000000001, 24.099999999999902, -50.00000000000044, 18.499999999999822, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 12.899999999999743, -50.00000000000044, -50.00000000000044, 46.5, 44.10000000000001, 34.30000000000004, -50.00000000000044, 43.30000000000001, 40.30000000000002, -50.00000000000044, 47.3, 47.7, -50.00000000000044, 45.9, -50.00000000000044, 40.30000000000002, 46.699999999999996], "episode_lengths": [500, 32, 28, 500, 176, 500, 270, 72, 42, 500, 28, 36, 36, 500, 62, 30, 46, 66, 40, 500, 500, 68, 236, 28, 500, 500, 500, 44, 52, 40, 178, 500, 26, 82, 500, 36, 500, 500, 500, 500, 54, 24, 500, 100, 500, 500, 500, 52, 108, 28, 28, 268, 500, 64, 500, 50, 110, 146, 54, 500, 32, 38, 500, 476, 52, 72, 64, 500, 82, 500, 500, 500, 500, 46, 50, 74, 260, 500, 316, 500, 500, 500, 28, 372, 500, 500, 36, 60, 158, 500, 68, 98, 500, 28, 24, 500, 42, 500, 98, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3773329662808702, "mean_inference_ms": 1.2097205198290293, "mean_action_processing_ms": 0.1389475304457103, "mean_env_wait_ms": 0.08317850969903487, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022993803024291992, "StateBufferConnector_ms": 0.004000425338745117, "ViewRequirementAgentConnector_ms": 0.11501455307006836}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000, "num_env_steps_sampled": 1248000, "num_env_steps_trained": 1248000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5819.371826722287, "num_env_steps_trained_throughput_per_sec": 5819.371826722287, "timesteps_total": 1248000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1248000, "timers": {"training_iteration_time_ms": 2185.85, "sample_time_ms": 1906.996, "load_time_ms": 12.599, "load_throughput": 952464.404, "learn_time_ms": 255.02, "learn_throughput": 47055.168, "synch_weights_time_ms": 9.634}, "counters": {"num_env_steps_sampled": 1248000, "num_env_steps_trained": 1248000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "done": false, "episodes_total": 4743, "training_iteration": 104, "trial_id": "9f288_00016", "date": "2023-10-25_16-55-22", "timestamp": 1698249322, "time_this_iter_s": 2.067840576171875, "time_total_s": 227.40834307670593, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 227.40834307670593, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 59.53333333333333, "ram_util_percent": 27.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.86076131526265e-33, "cur_lr": 0.0003, "total_loss": 6.713908990224202, "policy_loss": -0.00031665774683157605, "vf_loss": 6.7142722606658936, "vf_explained_var": -1.0132789611816406e-06, "kl": 0.0003852427799182736, "entropy": 0.4652271403206719, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1881.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1260000, "num_env_steps_trained": 1260000, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.913999999999817, "episode_len_mean": 261.48, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.300000000000026, 47.3, 47.3, 23.29999999999989, -50.00000000000044, 43.7, -50.00000000000044, 45.1, 39.10000000000002, 35.500000000000036, 44.7, -50.00000000000044, 46.9, 46.3, -50.00000000000044, 2.499999999999595, 44.900000000000006, 42.900000000000006, 43.7, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 45.1, 42.70000000000001, 24.099999999999902, -50.00000000000044, 18.499999999999822, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 12.899999999999743, -50.00000000000044, -50.00000000000044, 46.5, 44.10000000000001, 34.30000000000004, -50.00000000000044, 43.30000000000001, 40.30000000000002, -50.00000000000044, 47.3, 47.7, -50.00000000000044, 45.9, -50.00000000000044, 40.30000000000002, 46.699999999999996, -50.00000000000044, 36.900000000000034, -50.00000000000044, 44.7, 42.500000000000014, 46.699999999999996, 31.500000000000007, 40.500000000000014, 36.10000000000004, 36.30000000000003, -50.00000000000044, -50.00000000000044, 14.299999999999763, -50.00000000000044, -50.00000000000044, 38.50000000000003, -50.00000000000044, 46.5, 46.099999999999994, -50.00000000000044, 46.5, 44.10000000000001, 9.099999999999689, -50.00000000000044, -50.00000000000044, 13.499999999999751, 41.30000000000001, 47.1, 19.09999999999983, -50.00000000000044, 27.899999999999956, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 33.90000000000004, -50.00000000000044, 45.1, 30.9, -50.00000000000044, -50.00000000000044, 44.7, 44.900000000000006, -50.00000000000044, 44.900000000000006, -50.00000000000044, 45.5, 39.10000000000002], "episode_lengths": [108, 28, 28, 268, 500, 64, 500, 50, 110, 146, 54, 500, 32, 38, 500, 476, 52, 72, 64, 500, 82, 500, 500, 500, 500, 46, 50, 74, 260, 500, 316, 500, 500, 500, 28, 372, 500, 500, 36, 60, 158, 500, 68, 98, 500, 28, 24, 500, 42, 500, 98, 34, 500, 132, 500, 54, 76, 34, 186, 96, 140, 138, 500, 500, 358, 500, 500, 116, 500, 36, 40, 500, 36, 60, 410, 500, 500, 366, 88, 30, 310, 500, 222, 500, 38, 500, 500, 162, 500, 50, 192, 500, 500, 54, 52, 500, 52, 500, 46, 110]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37739131486147637, "mean_inference_ms": 1.209575568735322, "mean_action_processing_ms": 0.13886603601046382, "mean_env_wait_ms": 0.08325988241465723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02579331398010254, "StateBufferConnector_ms": 0.007899761199951172, "ViewRequirementAgentConnector_ms": 0.11588191986083984}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.913999999999817, "episode_len_mean": 261.48, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [39.300000000000026, 47.3, 47.3, 23.29999999999989, -50.00000000000044, 43.7, -50.00000000000044, 45.1, 39.10000000000002, 35.500000000000036, 44.7, -50.00000000000044, 46.9, 46.3, -50.00000000000044, 2.499999999999595, 44.900000000000006, 42.900000000000006, 43.7, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 45.1, 42.70000000000001, 24.099999999999902, -50.00000000000044, 18.499999999999822, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 12.899999999999743, -50.00000000000044, -50.00000000000044, 46.5, 44.10000000000001, 34.30000000000004, -50.00000000000044, 43.30000000000001, 40.30000000000002, -50.00000000000044, 47.3, 47.7, -50.00000000000044, 45.9, -50.00000000000044, 40.30000000000002, 46.699999999999996, -50.00000000000044, 36.900000000000034, -50.00000000000044, 44.7, 42.500000000000014, 46.699999999999996, 31.500000000000007, 40.500000000000014, 36.10000000000004, 36.30000000000003, -50.00000000000044, -50.00000000000044, 14.299999999999763, -50.00000000000044, -50.00000000000044, 38.50000000000003, -50.00000000000044, 46.5, 46.099999999999994, -50.00000000000044, 46.5, 44.10000000000001, 9.099999999999689, -50.00000000000044, -50.00000000000044, 13.499999999999751, 41.30000000000001, 47.1, 19.09999999999983, -50.00000000000044, 27.899999999999956, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 33.90000000000004, -50.00000000000044, 45.1, 30.9, -50.00000000000044, -50.00000000000044, 44.7, 44.900000000000006, -50.00000000000044, 44.900000000000006, -50.00000000000044, 45.5, 39.10000000000002], "episode_lengths": [108, 28, 28, 268, 500, 64, 500, 50, 110, 146, 54, 500, 32, 38, 500, 476, 52, 72, 64, 500, 82, 500, 500, 500, 500, 46, 50, 74, 260, 500, 316, 500, 500, 500, 28, 372, 500, 500, 36, 60, 158, 500, 68, 98, 500, 28, 24, 500, 42, 500, 98, 34, 500, 132, 500, 54, 76, 34, 186, 96, 140, 138, 500, 500, 358, 500, 500, 116, 500, 36, 40, 500, 36, 60, 410, 500, 500, 366, 88, 30, 310, 500, 222, 500, 38, 500, 500, 162, 500, 50, 192, 500, 500, 54, 52, 500, 52, 500, 46, 110]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37739131486147637, "mean_inference_ms": 1.209575568735322, "mean_action_processing_ms": 0.13886603601046382, "mean_env_wait_ms": 0.08325988241465723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02579331398010254, "StateBufferConnector_ms": 0.007899761199951172, "ViewRequirementAgentConnector_ms": 0.11588191986083984}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000, "num_env_steps_sampled": 1260000, "num_env_steps_trained": 1260000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5408.917425525579, "num_env_steps_trained_throughput_per_sec": 5408.917425525579, "timesteps_total": 1260000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1260000, "timers": {"training_iteration_time_ms": 2181.565, "sample_time_ms": 1908.333, "load_time_ms": 12.375, "load_throughput": 969667.303, "learn_time_ms": 249.906, "learn_throughput": 48018.066, "synch_weights_time_ms": 9.449}, "counters": {"num_env_steps_sampled": 1260000, "num_env_steps_trained": 1260000, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000}, "done": false, "episodes_total": 4791, "training_iteration": 105, "trial_id": "9f288_00016", "date": "2023-10-25_16-55-25", "timestamp": 1698249325, "time_this_iter_s": 2.22355318069458, "time_total_s": 229.6318962574005, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 229.6318962574005, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 61.23333333333333, "ram_util_percent": 27.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.930380657631325e-33, "cur_lr": 0.0003, "total_loss": 6.928673479292128, "policy_loss": -0.0005654659536149767, "vf_loss": 6.929280042648315, "vf_explained_var": -8.477105034722222e-07, "kl": 0.00040335204872437517, "entropy": 0.4106718980603748, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1899.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1272000, "num_env_steps_trained": 1272000, "num_agent_steps_sampled": 1272000, "num_agent_steps_trained": 1272000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.7899999999998215, "episode_len_mean": 262.74, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.9, -50.00000000000044, 40.30000000000002, 46.699999999999996, -50.00000000000044, 36.900000000000034, -50.00000000000044, 44.7, 42.500000000000014, 46.699999999999996, 31.500000000000007, 40.500000000000014, 36.10000000000004, 36.30000000000003, -50.00000000000044, -50.00000000000044, 14.299999999999763, -50.00000000000044, -50.00000000000044, 38.50000000000003, -50.00000000000044, 46.5, 46.099999999999994, -50.00000000000044, 46.5, 44.10000000000001, 9.099999999999689, -50.00000000000044, -50.00000000000044, 13.499999999999751, 41.30000000000001, 47.1, 19.09999999999983, -50.00000000000044, 27.899999999999956, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 33.90000000000004, -50.00000000000044, 45.1, 30.9, -50.00000000000044, -50.00000000000044, 44.7, 44.900000000000006, -50.00000000000044, 44.900000000000006, -50.00000000000044, 45.5, 39.10000000000002, 44.900000000000006, 28.89999999999997, -50.00000000000044, 24.69999999999991, -50.00000000000044, 22.49999999999988, 45.9, -50.00000000000044, -50.00000000000044, 46.699999999999996, 47.5, 16.09999999999979, 23.29999999999989, 46.5, -50.00000000000044, 37.90000000000003, -50.00000000000044, -50.00000000000044, 40.500000000000014, 40.30000000000002, -50.00000000000044, 43.50000000000001, 42.70000000000001, 46.099999999999994, 10.099999999999703, 44.10000000000001, 33.70000000000004, 45.9, 29.899999999999984, -50.00000000000044, 43.30000000000001, 20.299999999999848, 45.5, 9.8999999999997, 44.5, -50.00000000000044, -50.00000000000044, 41.100000000000016, 30.29999999999999, 43.10000000000001, 46.9, -50.00000000000044, -50.00000000000044, 34.10000000000004, 40.90000000000002, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 42, 500, 98, 34, 500, 132, 500, 54, 76, 34, 186, 96, 140, 138, 500, 500, 358, 500, 500, 116, 500, 36, 40, 500, 36, 60, 410, 500, 500, 366, 88, 30, 310, 500, 222, 500, 38, 500, 500, 162, 500, 50, 192, 500, 500, 54, 52, 500, 52, 500, 46, 110, 52, 212, 500, 254, 500, 276, 42, 500, 500, 34, 26, 340, 268, 36, 500, 122, 500, 500, 96, 98, 500, 66, 74, 40, 400, 60, 164, 42, 202, 500, 68, 298, 46, 402, 56, 500, 500, 90, 198, 70, 32, 500, 500, 160, 92, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3770624022004558, "mean_inference_ms": 1.2093574460409762, "mean_action_processing_ms": 0.1389965404432125, "mean_env_wait_ms": 0.08314485587436528, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02078866958618164, "StateBufferConnector_ms": 0.006897926330566406, "ViewRequirementAgentConnector_ms": 0.10987019538879395}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.7899999999998215, "episode_len_mean": 262.74, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.9, -50.00000000000044, 40.30000000000002, 46.699999999999996, -50.00000000000044, 36.900000000000034, -50.00000000000044, 44.7, 42.500000000000014, 46.699999999999996, 31.500000000000007, 40.500000000000014, 36.10000000000004, 36.30000000000003, -50.00000000000044, -50.00000000000044, 14.299999999999763, -50.00000000000044, -50.00000000000044, 38.50000000000003, -50.00000000000044, 46.5, 46.099999999999994, -50.00000000000044, 46.5, 44.10000000000001, 9.099999999999689, -50.00000000000044, -50.00000000000044, 13.499999999999751, 41.30000000000001, 47.1, 19.09999999999983, -50.00000000000044, 27.899999999999956, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 33.90000000000004, -50.00000000000044, 45.1, 30.9, -50.00000000000044, -50.00000000000044, 44.7, 44.900000000000006, -50.00000000000044, 44.900000000000006, -50.00000000000044, 45.5, 39.10000000000002, 44.900000000000006, 28.89999999999997, -50.00000000000044, 24.69999999999991, -50.00000000000044, 22.49999999999988, 45.9, -50.00000000000044, -50.00000000000044, 46.699999999999996, 47.5, 16.09999999999979, 23.29999999999989, 46.5, -50.00000000000044, 37.90000000000003, -50.00000000000044, -50.00000000000044, 40.500000000000014, 40.30000000000002, -50.00000000000044, 43.50000000000001, 42.70000000000001, 46.099999999999994, 10.099999999999703, 44.10000000000001, 33.70000000000004, 45.9, 29.899999999999984, -50.00000000000044, 43.30000000000001, 20.299999999999848, 45.5, 9.8999999999997, 44.5, -50.00000000000044, -50.00000000000044, 41.100000000000016, 30.29999999999999, 43.10000000000001, 46.9, -50.00000000000044, -50.00000000000044, 34.10000000000004, 40.90000000000002, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 42, 500, 98, 34, 500, 132, 500, 54, 76, 34, 186, 96, 140, 138, 500, 500, 358, 500, 500, 116, 500, 36, 40, 500, 36, 60, 410, 500, 500, 366, 88, 30, 310, 500, 222, 500, 38, 500, 500, 162, 500, 50, 192, 500, 500, 54, 52, 500, 52, 500, 46, 110, 52, 212, 500, 254, 500, 276, 42, 500, 500, 34, 26, 340, 268, 36, 500, 122, 500, 500, 96, 98, 500, 66, 74, 40, 400, 60, 164, 42, 202, 500, 68, 298, 46, 402, 56, 500, 500, 90, 198, 70, 32, 500, 500, 160, 92, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3770624022004558, "mean_inference_ms": 1.2093574460409762, "mean_action_processing_ms": 0.1389965404432125, "mean_env_wait_ms": 0.08314485587436528, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02078866958618164, "StateBufferConnector_ms": 0.006897926330566406, "ViewRequirementAgentConnector_ms": 0.10987019538879395}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1272000, "num_agent_steps_trained": 1272000, "num_env_steps_sampled": 1272000, "num_env_steps_trained": 1272000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5326.637490532114, "num_env_steps_trained_throughput_per_sec": 5326.637490532114, "timesteps_total": 1272000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1272000, "timers": {"training_iteration_time_ms": 2199.826, "sample_time_ms": 1914.885, "load_time_ms": 13.157, "load_throughput": 912028.268, "learn_time_ms": 261.048, "learn_throughput": 45968.619, "synch_weights_time_ms": 9.263}, "counters": {"num_env_steps_sampled": 1272000, "num_env_steps_trained": 1272000, "num_agent_steps_sampled": 1272000, "num_agent_steps_trained": 1272000}, "done": false, "episodes_total": 4838, "training_iteration": 106, "trial_id": "9f288_00016", "date": "2023-10-25_16-55-27", "timestamp": 1698249327, "time_this_iter_s": 2.2582204341888428, "time_total_s": 231.89011669158936, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 231.89011669158936, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 61.300000000000004, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.4651903288156624e-33, "cur_lr": 0.0003, "total_loss": 5.961059967676799, "policy_loss": -0.000320134891404046, "vf_loss": 5.961427344216241, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0005225872642742817, "entropy": 0.4721708546082179, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1917.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1284000, "num_env_steps_trained": 1284000, "num_agent_steps_sampled": 1284000, "num_agent_steps_trained": 1284000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.087999999999838, "episode_len_mean": 239.78, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.900000000000006, -50.00000000000044, 44.900000000000006, -50.00000000000044, 45.5, 39.10000000000002, 44.900000000000006, 28.89999999999997, -50.00000000000044, 24.69999999999991, -50.00000000000044, 22.49999999999988, 45.9, -50.00000000000044, -50.00000000000044, 46.699999999999996, 47.5, 16.09999999999979, 23.29999999999989, 46.5, -50.00000000000044, 37.90000000000003, -50.00000000000044, -50.00000000000044, 40.500000000000014, 40.30000000000002, -50.00000000000044, 43.50000000000001, 42.70000000000001, 46.099999999999994, 10.099999999999703, 44.10000000000001, 33.70000000000004, 45.9, 29.899999999999984, -50.00000000000044, 43.30000000000001, 20.299999999999848, 45.5, 9.8999999999997, 44.5, -50.00000000000044, -50.00000000000044, 41.100000000000016, 30.29999999999999, 43.10000000000001, 46.9, -50.00000000000044, -50.00000000000044, 34.10000000000004, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 43.900000000000006, 45.5, 47.3, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 45.3, 45.7, -50.00000000000044, -50.00000000000044, 37.300000000000026, 45.1, -50.00000000000044, 43.900000000000006, 46.099999999999994, 46.3, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 8.299999999999677, -50.00000000000044, -50.00000000000044, 46.699999999999996, 45.5, 46.9, -50.00000000000044, -50.00000000000044, 44.900000000000006, 33.70000000000004, 32.100000000000016, 44.300000000000004, 44.5, -50.00000000000044, 26.89999999999994, 46.699999999999996, 39.90000000000002, 46.3, -50.00000000000044, 46.699999999999996, 45.7, 44.10000000000001, 45.5, -50.00000000000044], "episode_lengths": [52, 500, 52, 500, 46, 110, 52, 212, 500, 254, 500, 276, 42, 500, 500, 34, 26, 340, 268, 36, 500, 122, 500, 500, 96, 98, 500, 66, 74, 40, 400, 60, 164, 42, 202, 500, 68, 298, 46, 402, 56, 500, 500, 90, 198, 70, 32, 500, 500, 160, 92, 500, 500, 500, 44, 62, 46, 28, 500, 48, 500, 500, 48, 44, 500, 500, 128, 50, 500, 62, 40, 38, 34, 500, 500, 500, 418, 500, 500, 34, 46, 32, 500, 500, 52, 164, 180, 58, 56, 500, 232, 34, 102, 38, 500, 34, 44, 60, 46, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3772236043302618, "mean_inference_ms": 1.2096516867154026, "mean_action_processing_ms": 0.13901847322274155, "mean_env_wait_ms": 0.0831448341303853, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02499079704284668, "StateBufferConnector_ms": 0.004998922348022461, "ViewRequirementAgentConnector_ms": 0.12285804748535156}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.087999999999838, "episode_len_mean": 239.78, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.900000000000006, -50.00000000000044, 44.900000000000006, -50.00000000000044, 45.5, 39.10000000000002, 44.900000000000006, 28.89999999999997, -50.00000000000044, 24.69999999999991, -50.00000000000044, 22.49999999999988, 45.9, -50.00000000000044, -50.00000000000044, 46.699999999999996, 47.5, 16.09999999999979, 23.29999999999989, 46.5, -50.00000000000044, 37.90000000000003, -50.00000000000044, -50.00000000000044, 40.500000000000014, 40.30000000000002, -50.00000000000044, 43.50000000000001, 42.70000000000001, 46.099999999999994, 10.099999999999703, 44.10000000000001, 33.70000000000004, 45.9, 29.899999999999984, -50.00000000000044, 43.30000000000001, 20.299999999999848, 45.5, 9.8999999999997, 44.5, -50.00000000000044, -50.00000000000044, 41.100000000000016, 30.29999999999999, 43.10000000000001, 46.9, -50.00000000000044, -50.00000000000044, 34.10000000000004, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 43.900000000000006, 45.5, 47.3, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 45.3, 45.7, -50.00000000000044, -50.00000000000044, 37.300000000000026, 45.1, -50.00000000000044, 43.900000000000006, 46.099999999999994, 46.3, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 8.299999999999677, -50.00000000000044, -50.00000000000044, 46.699999999999996, 45.5, 46.9, -50.00000000000044, -50.00000000000044, 44.900000000000006, 33.70000000000004, 32.100000000000016, 44.300000000000004, 44.5, -50.00000000000044, 26.89999999999994, 46.699999999999996, 39.90000000000002, 46.3, -50.00000000000044, 46.699999999999996, 45.7, 44.10000000000001, 45.5, -50.00000000000044], "episode_lengths": [52, 500, 52, 500, 46, 110, 52, 212, 500, 254, 500, 276, 42, 500, 500, 34, 26, 340, 268, 36, 500, 122, 500, 500, 96, 98, 500, 66, 74, 40, 400, 60, 164, 42, 202, 500, 68, 298, 46, 402, 56, 500, 500, 90, 198, 70, 32, 500, 500, 160, 92, 500, 500, 500, 44, 62, 46, 28, 500, 48, 500, 500, 48, 44, 500, 500, 128, 50, 500, 62, 40, 38, 34, 500, 500, 500, 418, 500, 500, 34, 46, 32, 500, 500, 52, 164, 180, 58, 56, 500, 232, 34, 102, 38, 500, 34, 44, 60, 46, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3772236043302618, "mean_inference_ms": 1.2096516867154026, "mean_action_processing_ms": 0.13901847322274155, "mean_env_wait_ms": 0.0831448341303853, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02499079704284668, "StateBufferConnector_ms": 0.004998922348022461, "ViewRequirementAgentConnector_ms": 0.12285804748535156}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1284000, "num_agent_steps_trained": 1284000, "num_env_steps_sampled": 1284000, "num_env_steps_trained": 1284000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5786.148737665319, "num_env_steps_trained_throughput_per_sec": 5786.148737665319, "timesteps_total": 1284000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1284000, "timers": {"training_iteration_time_ms": 2163.769, "sample_time_ms": 1898.8, "load_time_ms": 12.157, "load_throughput": 987063.44, "learn_time_ms": 242.195, "learn_throughput": 49546.924, "synch_weights_time_ms": 9.344}, "counters": {"num_env_steps_sampled": 1284000, "num_env_steps_trained": 1284000, "num_agent_steps_sampled": 1284000, "num_agent_steps_trained": 1284000}, "done": false, "episodes_total": 4885, "training_iteration": 107, "trial_id": "9f288_00016", "date": "2023-10-25_16-55-29", "timestamp": 1698249329, "time_this_iter_s": 2.079916477203369, "time_total_s": 233.97003316879272, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 233.97003316879272, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 57.4, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.2325951644078312e-33, "cur_lr": 0.0003, "total_loss": 6.513895591100057, "policy_loss": -0.0001988149144583278, "vf_loss": 6.51414171854655, "vf_explained_var": -1.1656019422743056e-06, "kl": 0.0003047824315811138, "entropy": 0.4748263011376063, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1935.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1296000, "num_env_steps_trained": 1296000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.1409999999998046, "episode_len_mean": 264.16, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [30.29999999999999, 43.10000000000001, 46.9, -50.00000000000044, -50.00000000000044, 34.10000000000004, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 43.900000000000006, 45.5, 47.3, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 45.3, 45.7, -50.00000000000044, -50.00000000000044, 37.300000000000026, 45.1, -50.00000000000044, 43.900000000000006, 46.099999999999994, 46.3, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 8.299999999999677, -50.00000000000044, -50.00000000000044, 46.699999999999996, 45.5, 46.9, -50.00000000000044, -50.00000000000044, 44.900000000000006, 33.70000000000004, 32.100000000000016, 44.300000000000004, 44.5, -50.00000000000044, 26.89999999999994, 46.699999999999996, 39.90000000000002, 46.3, -50.00000000000044, 46.699999999999996, 45.7, 44.10000000000001, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 43.50000000000001, 42.30000000000001, 44.300000000000004, 45.5, -50.00000000000044, 24.299999999999905, -50.00000000000044, -50.00000000000044, 43.30000000000001, 37.70000000000003, -50.00000000000044, 46.099999999999994, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 44.900000000000006, 45.7, -50.00000000000044, 29.49999999999998, 46.5, 15.099999999999774, 45.5, -50.00000000000044, -50.00000000000044, 44.7, 44.7, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 26.499999999999936], "episode_lengths": [198, 70, 32, 500, 500, 160, 92, 500, 500, 500, 44, 62, 46, 28, 500, 48, 500, 500, 48, 44, 500, 500, 128, 50, 500, 62, 40, 38, 34, 500, 500, 500, 418, 500, 500, 34, 46, 32, 500, 500, 52, 164, 180, 58, 56, 500, 232, 34, 102, 38, 500, 34, 44, 60, 46, 500, 500, 500, 500, 50, 500, 66, 78, 58, 46, 500, 258, 500, 500, 68, 124, 500, 40, 50, 500, 500, 500, 500, 500, 56, 500, 500, 52, 44, 500, 206, 36, 350, 46, 500, 500, 54, 54, 500, 52, 500, 500, 38, 500, 236]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3772193551129977, "mean_inference_ms": 1.2099495677752643, "mean_action_processing_ms": 0.1389803660254488, "mean_env_wait_ms": 0.08330418769353265, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026992082595825195, "StateBufferConnector_ms": 0.006994009017944336, "ViewRequirementAgentConnector_ms": 0.11722469329833984}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.1409999999998046, "episode_len_mean": 264.16, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [30.29999999999999, 43.10000000000001, 46.9, -50.00000000000044, -50.00000000000044, 34.10000000000004, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 43.900000000000006, 45.5, 47.3, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 45.3, 45.7, -50.00000000000044, -50.00000000000044, 37.300000000000026, 45.1, -50.00000000000044, 43.900000000000006, 46.099999999999994, 46.3, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 8.299999999999677, -50.00000000000044, -50.00000000000044, 46.699999999999996, 45.5, 46.9, -50.00000000000044, -50.00000000000044, 44.900000000000006, 33.70000000000004, 32.100000000000016, 44.300000000000004, 44.5, -50.00000000000044, 26.89999999999994, 46.699999999999996, 39.90000000000002, 46.3, -50.00000000000044, 46.699999999999996, 45.7, 44.10000000000001, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 43.50000000000001, 42.30000000000001, 44.300000000000004, 45.5, -50.00000000000044, 24.299999999999905, -50.00000000000044, -50.00000000000044, 43.30000000000001, 37.70000000000003, -50.00000000000044, 46.099999999999994, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 44.900000000000006, 45.7, -50.00000000000044, 29.49999999999998, 46.5, 15.099999999999774, 45.5, -50.00000000000044, -50.00000000000044, 44.7, 44.7, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 26.499999999999936], "episode_lengths": [198, 70, 32, 500, 500, 160, 92, 500, 500, 500, 44, 62, 46, 28, 500, 48, 500, 500, 48, 44, 500, 500, 128, 50, 500, 62, 40, 38, 34, 500, 500, 500, 418, 500, 500, 34, 46, 32, 500, 500, 52, 164, 180, 58, 56, 500, 232, 34, 102, 38, 500, 34, 44, 60, 46, 500, 500, 500, 500, 50, 500, 66, 78, 58, 46, 500, 258, 500, 500, 68, 124, 500, 40, 50, 500, 500, 500, 500, 500, 56, 500, 500, 52, 44, 500, 206, 36, 350, 46, 500, 500, 54, 54, 500, 52, 500, 500, 38, 500, 236]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3772193551129977, "mean_inference_ms": 1.2099495677752643, "mean_action_processing_ms": 0.1389803660254488, "mean_env_wait_ms": 0.08330418769353265, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026992082595825195, "StateBufferConnector_ms": 0.006994009017944336, "ViewRequirementAgentConnector_ms": 0.11722469329833984}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000, "num_env_steps_sampled": 1296000, "num_env_steps_trained": 1296000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5424.059988807383, "num_env_steps_trained_throughput_per_sec": 5424.059988807383, "timesteps_total": 1296000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1296000, "timers": {"training_iteration_time_ms": 2178.505, "sample_time_ms": 1902.637, "load_time_ms": 12.557, "load_throughput": 955607.35, "learn_time_ms": 252.738, "learn_throughput": 47479.999, "synch_weights_time_ms": 9.301}, "counters": {"num_env_steps_sampled": 1296000, "num_env_steps_trained": 1296000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "done": false, "episodes_total": 4929, "training_iteration": 108, "trial_id": "9f288_00016", "date": "2023-10-25_16-55-31", "timestamp": 1698249331, "time_this_iter_s": 2.2183737754821777, "time_total_s": 236.1884069442749, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 236.1884069442749, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 62.53333333333333, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.162975822039156e-34, "cur_lr": 0.0003, "total_loss": 6.26303243637085, "policy_loss": -9.2077793346511e-05, "vf_loss": 6.263173076841566, "vf_explained_var": -1.0132789611816406e-06, "kl": 0.00023365467777954527, "entropy": 0.4861586739619573, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1953.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1308000, "num_env_steps_trained": 1308000, "num_agent_steps_sampled": 1308000, "num_agent_steps_trained": 1308000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.359999999999811, "episode_len_mean": 266.98, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [33.70000000000004, 32.100000000000016, 44.300000000000004, 44.5, -50.00000000000044, 26.89999999999994, 46.699999999999996, 39.90000000000002, 46.3, -50.00000000000044, 46.699999999999996, 45.7, 44.10000000000001, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 43.50000000000001, 42.30000000000001, 44.300000000000004, 45.5, -50.00000000000044, 24.299999999999905, -50.00000000000044, -50.00000000000044, 43.30000000000001, 37.70000000000003, -50.00000000000044, 46.099999999999994, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 44.900000000000006, 45.7, -50.00000000000044, 29.49999999999998, 46.5, 15.099999999999774, 45.5, -50.00000000000044, -50.00000000000044, 44.7, 44.7, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 26.499999999999936, 43.50000000000001, 45.7, 32.50000000000002, 45.5, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 14.299999999999763, -50.00000000000044, 46.5, 39.70000000000002, 36.10000000000004, 26.09999999999993, 42.900000000000006, 34.30000000000004, -50.00000000000044, 45.9, 36.900000000000034, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 35.30000000000004, 41.70000000000002, 34.900000000000034, 41.90000000000001, 39.10000000000002, -50.00000000000044, 45.7, 44.300000000000004, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044], "episode_lengths": [164, 180, 58, 56, 500, 232, 34, 102, 38, 500, 34, 44, 60, 46, 500, 500, 500, 500, 50, 500, 66, 78, 58, 46, 500, 258, 500, 500, 68, 124, 500, 40, 50, 500, 500, 500, 500, 500, 56, 500, 500, 52, 44, 500, 206, 36, 350, 46, 500, 500, 54, 54, 500, 52, 500, 500, 38, 500, 236, 66, 44, 176, 46, 500, 58, 500, 500, 500, 500, 500, 358, 500, 36, 104, 140, 240, 72, 158, 500, 42, 132, 500, 80, 500, 500, 148, 84, 152, 82, 110, 500, 44, 58, 500, 76, 500, 500, 82, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3770900788328082, "mean_inference_ms": 1.2102280710803148, "mean_action_processing_ms": 0.1389503545964924, "mean_env_wait_ms": 0.08336233134363294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023992300033569336, "StateBufferConnector_ms": 0.0059969425201416016, "ViewRequirementAgentConnector_ms": 0.10338878631591797}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.359999999999811, "episode_len_mean": 266.98, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [33.70000000000004, 32.100000000000016, 44.300000000000004, 44.5, -50.00000000000044, 26.89999999999994, 46.699999999999996, 39.90000000000002, 46.3, -50.00000000000044, 46.699999999999996, 45.7, 44.10000000000001, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 43.50000000000001, 42.30000000000001, 44.300000000000004, 45.5, -50.00000000000044, 24.299999999999905, -50.00000000000044, -50.00000000000044, 43.30000000000001, 37.70000000000003, -50.00000000000044, 46.099999999999994, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 44.900000000000006, 45.7, -50.00000000000044, 29.49999999999998, 46.5, 15.099999999999774, 45.5, -50.00000000000044, -50.00000000000044, 44.7, 44.7, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 26.499999999999936, 43.50000000000001, 45.7, 32.50000000000002, 45.5, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 14.299999999999763, -50.00000000000044, 46.5, 39.70000000000002, 36.10000000000004, 26.09999999999993, 42.900000000000006, 34.30000000000004, -50.00000000000044, 45.9, 36.900000000000034, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 35.30000000000004, 41.70000000000002, 34.900000000000034, 41.90000000000001, 39.10000000000002, -50.00000000000044, 45.7, 44.300000000000004, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044], "episode_lengths": [164, 180, 58, 56, 500, 232, 34, 102, 38, 500, 34, 44, 60, 46, 500, 500, 500, 500, 50, 500, 66, 78, 58, 46, 500, 258, 500, 500, 68, 124, 500, 40, 50, 500, 500, 500, 500, 500, 56, 500, 500, 52, 44, 500, 206, 36, 350, 46, 500, 500, 54, 54, 500, 52, 500, 500, 38, 500, 236, 66, 44, 176, 46, 500, 58, 500, 500, 500, 500, 500, 358, 500, 36, 104, 140, 240, 72, 158, 500, 42, 132, 500, 80, 500, 500, 148, 84, 152, 82, 110, 500, 44, 58, 500, 76, 500, 500, 82, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3770900788328082, "mean_inference_ms": 1.2102280710803148, "mean_action_processing_ms": 0.1389503545964924, "mean_env_wait_ms": 0.08336233134363294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023992300033569336, "StateBufferConnector_ms": 0.0059969425201416016, "ViewRequirementAgentConnector_ms": 0.10338878631591797}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1308000, "num_agent_steps_trained": 1308000, "num_env_steps_sampled": 1308000, "num_env_steps_trained": 1308000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5355.167258645259, "num_env_steps_trained_throughput_per_sec": 5355.167258645259, "timesteps_total": 1308000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1308000, "timers": {"training_iteration_time_ms": 2175.465, "sample_time_ms": 1917.568, "load_time_ms": 11.65, "load_throughput": 1030071.2, "learn_time_ms": 235.575, "learn_throughput": 50939.19, "synch_weights_time_ms": 9.201}, "counters": {"num_env_steps_sampled": 1308000, "num_env_steps_trained": 1308000, "num_agent_steps_sampled": 1308000, "num_agent_steps_trained": 1308000}, "done": false, "episodes_total": 4970, "training_iteration": 109, "trial_id": "9f288_00016", "date": "2023-10-25_16-55-33", "timestamp": 1698249333, "time_this_iter_s": 2.2458231449127197, "time_total_s": 238.43423008918762, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 238.43423008918762, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 58.43333333333334, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.081487911019578e-34, "cur_lr": 0.0003, "total_loss": 6.352697796291775, "policy_loss": -5.626916471454832e-05, "vf_loss": 6.352802515029907, "vf_explained_var": -8.609559800889757e-07, "kl": 0.00017944216000071519, "entropy": 0.4856312870979309, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1971.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1320000, "num_env_steps_trained": 1320000, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.026000000000199534, "episode_len_mean": 280.82, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.7, -50.00000000000044, 29.49999999999998, 46.5, 15.099999999999774, 45.5, -50.00000000000044, -50.00000000000044, 44.7, 44.7, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 26.499999999999936, 43.50000000000001, 45.7, 32.50000000000002, 45.5, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 14.299999999999763, -50.00000000000044, 46.5, 39.70000000000002, 36.10000000000004, 26.09999999999993, 42.900000000000006, 34.30000000000004, -50.00000000000044, 45.9, 36.900000000000034, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 35.30000000000004, 41.70000000000002, 34.900000000000034, 41.90000000000001, 39.10000000000002, -50.00000000000044, 45.7, 44.300000000000004, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 13.499999999999751, -50.00000000000044, -50.00000000000044, 45.3, 26.299999999999933, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, 47.3, 43.10000000000001, 45.1, 40.30000000000002, -50.00000000000044, 40.70000000000002, -50.00000000000044, 44.7, 42.70000000000001, -50.00000000000044, 24.299999999999905, -50.00000000000044, 43.30000000000001, 26.69999999999994, 40.30000000000002, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.30000000000003, 39.70000000000002, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 45.3], "episode_lengths": [44, 500, 206, 36, 350, 46, 500, 500, 54, 54, 500, 52, 500, 500, 38, 500, 236, 66, 44, 176, 46, 500, 58, 500, 500, 500, 500, 500, 358, 500, 36, 104, 140, 240, 72, 158, 500, 42, 132, 500, 80, 500, 500, 148, 84, 152, 82, 110, 500, 44, 58, 500, 76, 500, 500, 82, 500, 500, 500, 366, 500, 500, 48, 238, 500, 500, 52, 500, 500, 94, 500, 28, 70, 50, 98, 500, 94, 500, 54, 74, 500, 258, 500, 68, 234, 98, 38, 500, 500, 500, 168, 104, 500, 64, 500, 500, 32, 500, 500, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37683797366279526, "mean_inference_ms": 1.2104343717134152, "mean_action_processing_ms": 0.13898984515734394, "mean_env_wait_ms": 0.08344354698799855, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015995502471923828, "StateBufferConnector_ms": 0.00400233268737793, "ViewRequirementAgentConnector_ms": 0.1091916561126709}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.026000000000199534, "episode_len_mean": 280.82, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.7, -50.00000000000044, 29.49999999999998, 46.5, 15.099999999999774, 45.5, -50.00000000000044, -50.00000000000044, 44.7, 44.7, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 26.499999999999936, 43.50000000000001, 45.7, 32.50000000000002, 45.5, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 14.299999999999763, -50.00000000000044, 46.5, 39.70000000000002, 36.10000000000004, 26.09999999999993, 42.900000000000006, 34.30000000000004, -50.00000000000044, 45.9, 36.900000000000034, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 35.30000000000004, 41.70000000000002, 34.900000000000034, 41.90000000000001, 39.10000000000002, -50.00000000000044, 45.7, 44.300000000000004, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 13.499999999999751, -50.00000000000044, -50.00000000000044, 45.3, 26.299999999999933, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, 47.3, 43.10000000000001, 45.1, 40.30000000000002, -50.00000000000044, 40.70000000000002, -50.00000000000044, 44.7, 42.70000000000001, -50.00000000000044, 24.299999999999905, -50.00000000000044, 43.30000000000001, 26.69999999999994, 40.30000000000002, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.30000000000003, 39.70000000000002, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 45.3], "episode_lengths": [44, 500, 206, 36, 350, 46, 500, 500, 54, 54, 500, 52, 500, 500, 38, 500, 236, 66, 44, 176, 46, 500, 58, 500, 500, 500, 500, 500, 358, 500, 36, 104, 140, 240, 72, 158, 500, 42, 132, 500, 80, 500, 500, 148, 84, 152, 82, 110, 500, 44, 58, 500, 76, 500, 500, 82, 500, 500, 500, 366, 500, 500, 48, 238, 500, 500, 52, 500, 500, 94, 500, 28, 70, 50, 98, 500, 94, 500, 54, 74, 500, 258, 500, 68, 234, 98, 38, 500, 500, 500, 168, 104, 500, 64, 500, 500, 32, 500, 500, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37683797366279526, "mean_inference_ms": 1.2104343717134152, "mean_action_processing_ms": 0.13898984515734394, "mean_env_wait_ms": 0.08344354698799855, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015995502471923828, "StateBufferConnector_ms": 0.00400233268737793, "ViewRequirementAgentConnector_ms": 0.1091916561126709}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000, "num_env_steps_sampled": 1320000, "num_env_steps_trained": 1320000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5146.318447602981, "num_env_steps_trained_throughput_per_sec": 5146.318447602981, "timesteps_total": 1320000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1320000, "timers": {"training_iteration_time_ms": 2196.697, "sample_time_ms": 1918.234, "load_time_ms": 12.25, "load_throughput": 979622.8, "learn_time_ms": 255.541, "learn_throughput": 46959.277, "synch_weights_time_ms": 9.201}, "counters": {"num_env_steps_sampled": 1320000, "num_env_steps_trained": 1320000, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000}, "done": false, "episodes_total": 5012, "training_iteration": 110, "trial_id": "9f288_00016", "date": "2023-10-25_16-55-36", "timestamp": 1698249336, "time_this_iter_s": 2.336760997772217, "time_total_s": 240.77099108695984, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 240.77099108695984, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 50.25, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.540743955509789e-34, "cur_lr": 0.0003, "total_loss": 6.317285113864475, "policy_loss": -0.0003507437391413583, "vf_loss": 6.31768732600742, "vf_explained_var": -7.748603820800781e-07, "kl": 0.0005790498725686019, "entropy": 0.5140979389349619, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1989.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1332000, "num_env_steps_trained": 1332000, "num_agent_steps_sampled": 1332000, "num_agent_steps_trained": 1332000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.15000000000020436, "episode_len_mean": 282.06, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [34.900000000000034, 41.90000000000001, 39.10000000000002, -50.00000000000044, 45.7, 44.300000000000004, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 13.499999999999751, -50.00000000000044, -50.00000000000044, 45.3, 26.299999999999933, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, 47.3, 43.10000000000001, 45.1, 40.30000000000002, -50.00000000000044, 40.70000000000002, -50.00000000000044, 44.7, 42.70000000000001, -50.00000000000044, 24.299999999999905, -50.00000000000044, 43.30000000000001, 26.69999999999994, 40.30000000000002, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.30000000000003, 39.70000000000002, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 45.3, 16.09999999999979, 27.49999999999995, -50.00000000000044, 27.099999999999945, -50.00000000000044, -50.00000000000044, 46.699999999999996, 45.1, 42.30000000000001, 41.70000000000002, -50.00000000000044, 7.299999999999663, -50.00000000000044, 45.7, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 41.30000000000001, 31.300000000000004, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 42.500000000000014, 42.70000000000001, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 46.699999999999996, 43.7, 38.90000000000002, 45.3, 8.49999999999968, 44.10000000000001, 33.90000000000004, 45.3, -50.00000000000044, -50.00000000000044, 40.500000000000014, 46.3, -50.00000000000044], "episode_lengths": [152, 82, 110, 500, 44, 58, 500, 76, 500, 500, 82, 500, 500, 500, 366, 500, 500, 48, 238, 500, 500, 52, 500, 500, 94, 500, 28, 70, 50, 98, 500, 94, 500, 54, 74, 500, 258, 500, 68, 234, 98, 38, 500, 500, 500, 168, 104, 500, 64, 500, 500, 32, 500, 500, 48, 340, 226, 500, 230, 500, 500, 34, 50, 78, 84, 500, 428, 500, 44, 500, 36, 500, 500, 88, 188, 500, 40, 500, 500, 76, 74, 90, 500, 500, 500, 500, 40, 34, 64, 112, 48, 416, 60, 162, 48, 500, 500, 96, 38, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37673960012231306, "mean_inference_ms": 1.2100521027794435, "mean_action_processing_ms": 0.1391651797175886, "mean_env_wait_ms": 0.08338538460595676, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017976999282836914, "StateBufferConnector_ms": 0.0030014514923095703, "ViewRequirementAgentConnector_ms": 0.1219642162322998}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.15000000000020436, "episode_len_mean": 282.06, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [34.900000000000034, 41.90000000000001, 39.10000000000002, -50.00000000000044, 45.7, 44.300000000000004, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 13.499999999999751, -50.00000000000044, -50.00000000000044, 45.3, 26.299999999999933, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, 47.3, 43.10000000000001, 45.1, 40.30000000000002, -50.00000000000044, 40.70000000000002, -50.00000000000044, 44.7, 42.70000000000001, -50.00000000000044, 24.299999999999905, -50.00000000000044, 43.30000000000001, 26.69999999999994, 40.30000000000002, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.30000000000003, 39.70000000000002, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 45.3, 16.09999999999979, 27.49999999999995, -50.00000000000044, 27.099999999999945, -50.00000000000044, -50.00000000000044, 46.699999999999996, 45.1, 42.30000000000001, 41.70000000000002, -50.00000000000044, 7.299999999999663, -50.00000000000044, 45.7, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 41.30000000000001, 31.300000000000004, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 42.500000000000014, 42.70000000000001, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 46.699999999999996, 43.7, 38.90000000000002, 45.3, 8.49999999999968, 44.10000000000001, 33.90000000000004, 45.3, -50.00000000000044, -50.00000000000044, 40.500000000000014, 46.3, -50.00000000000044], "episode_lengths": [152, 82, 110, 500, 44, 58, 500, 76, 500, 500, 82, 500, 500, 500, 366, 500, 500, 48, 238, 500, 500, 52, 500, 500, 94, 500, 28, 70, 50, 98, 500, 94, 500, 54, 74, 500, 258, 500, 68, 234, 98, 38, 500, 500, 500, 168, 104, 500, 64, 500, 500, 32, 500, 500, 48, 340, 226, 500, 230, 500, 500, 34, 50, 78, 84, 500, 428, 500, 44, 500, 36, 500, 500, 88, 188, 500, 40, 500, 500, 76, 74, 90, 500, 500, 500, 500, 40, 34, 64, 112, 48, 416, 60, 162, 48, 500, 500, 96, 38, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37673960012231306, "mean_inference_ms": 1.2100521027794435, "mean_action_processing_ms": 0.1391651797175886, "mean_env_wait_ms": 0.08338538460595676, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017976999282836914, "StateBufferConnector_ms": 0.0030014514923095703, "ViewRequirementAgentConnector_ms": 0.1219642162322998}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1332000, "num_agent_steps_trained": 1332000, "num_env_steps_sampled": 1332000, "num_env_steps_trained": 1332000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5849.471403146129, "num_env_steps_trained_throughput_per_sec": 5849.471403146129, "timesteps_total": 1332000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1332000, "timers": {"training_iteration_time_ms": 2180.593, "sample_time_ms": 1919.329, "load_time_ms": 11.05, "load_throughput": 1086011.729, "learn_time_ms": 239.544, "learn_throughput": 50095.164, "synch_weights_time_ms": 9.097}, "counters": {"num_env_steps_sampled": 1332000, "num_env_steps_trained": 1332000, "num_agent_steps_sampled": 1332000, "num_agent_steps_trained": 1332000}, "done": false, "episodes_total": 5057, "training_iteration": 111, "trial_id": "9f288_00016", "date": "2023-10-25_16-55-38", "timestamp": 1698249338, "time_this_iter_s": 2.0564661026000977, "time_total_s": 242.82745718955994, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 242.82745718955994, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 66.95, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.703719777548945e-35, "cur_lr": 0.0003, "total_loss": 6.638687557644314, "policy_loss": -0.0001071588032775455, "vf_loss": 6.638846450381809, "vf_explained_var": -1.0000334845648872e-06, "kl": 0.0002850417931388923, "entropy": 0.5179312427838644, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 2007.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1344000, "num_env_steps_trained": 1344000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.085999999999808, "episode_len_mean": 269.72, "episode_media": {}, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 45.3, 16.09999999999979, 27.49999999999995, -50.00000000000044, 27.099999999999945, -50.00000000000044, -50.00000000000044, 46.699999999999996, 45.1, 42.30000000000001, 41.70000000000002, -50.00000000000044, 7.299999999999663, -50.00000000000044, 45.7, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 41.30000000000001, 31.300000000000004, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 42.500000000000014, 42.70000000000001, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 46.699999999999996, 43.7, 38.90000000000002, 45.3, 8.49999999999968, 44.10000000000001, 33.90000000000004, 45.3, -50.00000000000044, -50.00000000000044, 40.500000000000014, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 44.900000000000006, -50.00000000000044, -50.00000000000044, 40.70000000000002, 40.10000000000002, -50.00000000000044, 45.7, -50.00000000000044, 33.70000000000004, -50.00000000000044, 45.9, -50.00000000000044, 25.699999999999925, 45.5, 36.900000000000034, 36.70000000000003, 42.30000000000001, 43.10000000000001, 41.500000000000014, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 28.699999999999967, 27.899999999999956, -50.00000000000044, 45.5, 46.9, 39.10000000000002, 44.10000000000001, 43.10000000000001, 41.70000000000002, -50.00000000000044, 43.7, 41.100000000000016, 41.500000000000014, -50.00000000000044, 43.7, 44.300000000000004], "episode_lengths": [500, 500, 32, 500, 500, 48, 340, 226, 500, 230, 500, 500, 34, 50, 78, 84, 500, 428, 500, 44, 500, 36, 500, 500, 88, 188, 500, 40, 500, 500, 76, 74, 90, 500, 500, 500, 500, 40, 34, 64, 112, 48, 416, 60, 162, 48, 500, 500, 96, 38, 500, 500, 500, 88, 52, 500, 500, 94, 100, 500, 44, 500, 164, 500, 42, 500, 244, 46, 132, 134, 78, 70, 86, 500, 58, 500, 500, 500, 500, 500, 500, 500, 500, 36, 214, 222, 500, 46, 32, 110, 60, 70, 84, 500, 64, 90, 86, 500, 64, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3773086891115577, "mean_inference_ms": 1.209647239930267, "mean_action_processing_ms": 0.13924843284277535, "mean_env_wait_ms": 0.08328472964104863, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02098822593688965, "StateBufferConnector_ms": 0.004999399185180664, "ViewRequirementAgentConnector_ms": 0.1199638843536377}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.085999999999808, "episode_len_mean": 269.72, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 45.3, 16.09999999999979, 27.49999999999995, -50.00000000000044, 27.099999999999945, -50.00000000000044, -50.00000000000044, 46.699999999999996, 45.1, 42.30000000000001, 41.70000000000002, -50.00000000000044, 7.299999999999663, -50.00000000000044, 45.7, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 41.30000000000001, 31.300000000000004, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 42.500000000000014, 42.70000000000001, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 46.699999999999996, 43.7, 38.90000000000002, 45.3, 8.49999999999968, 44.10000000000001, 33.90000000000004, 45.3, -50.00000000000044, -50.00000000000044, 40.500000000000014, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 44.900000000000006, -50.00000000000044, -50.00000000000044, 40.70000000000002, 40.10000000000002, -50.00000000000044, 45.7, -50.00000000000044, 33.70000000000004, -50.00000000000044, 45.9, -50.00000000000044, 25.699999999999925, 45.5, 36.900000000000034, 36.70000000000003, 42.30000000000001, 43.10000000000001, 41.500000000000014, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 28.699999999999967, 27.899999999999956, -50.00000000000044, 45.5, 46.9, 39.10000000000002, 44.10000000000001, 43.10000000000001, 41.70000000000002, -50.00000000000044, 43.7, 41.100000000000016, 41.500000000000014, -50.00000000000044, 43.7, 44.300000000000004], "episode_lengths": [500, 500, 32, 500, 500, 48, 340, 226, 500, 230, 500, 500, 34, 50, 78, 84, 500, 428, 500, 44, 500, 36, 500, 500, 88, 188, 500, 40, 500, 500, 76, 74, 90, 500, 500, 500, 500, 40, 34, 64, 112, 48, 416, 60, 162, 48, 500, 500, 96, 38, 500, 500, 500, 88, 52, 500, 500, 94, 100, 500, 44, 500, 164, 500, 42, 500, 244, 46, 132, 134, 78, 70, 86, 500, 58, 500, 500, 500, 500, 500, 500, 500, 500, 36, 214, 222, 500, 46, 32, 110, 60, 70, 84, 500, 64, 90, 86, 500, 64, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3773086891115577, "mean_inference_ms": 1.209647239930267, "mean_action_processing_ms": 0.13924843284277535, "mean_env_wait_ms": 0.08328472964104863, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02098822593688965, "StateBufferConnector_ms": 0.004999399185180664, "ViewRequirementAgentConnector_ms": 0.1199638843536377}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000, "num_env_steps_sampled": 1344000, "num_env_steps_trained": 1344000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5358.886495409374, "num_env_steps_trained_throughput_per_sec": 5358.886495409374, "timesteps_total": 1344000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1344000, "timers": {"training_iteration_time_ms": 2199.364, "sample_time_ms": 1928.748, "load_time_ms": 11.25, "load_throughput": 1066701.028, "learn_time_ms": 248.65, "learn_throughput": 48260.685, "synch_weights_time_ms": 9.078}, "counters": {"num_env_steps_sampled": 1344000, "num_env_steps_trained": 1344000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "done": false, "episodes_total": 5106, "training_iteration": 112, "trial_id": "9f288_00016", "date": "2023-10-25_16-55-40", "timestamp": 1698249340, "time_this_iter_s": 2.2442290782928467, "time_total_s": 245.07168626785278, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 245.07168626785278, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 56.625, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.8518598887744725e-35, "cur_lr": 0.0003, "total_loss": 6.773883554670546, "policy_loss": -0.0002498295572068956, "vf_loss": 6.7741842534806995, "vf_explained_var": -1.026524437798394e-06, "kl": 0.00033064322370693035, "entropy": 0.5083519485261705, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 2025.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1356000, "num_env_steps_trained": 1356000, "num_agent_steps_sampled": 1356000, "num_agent_steps_trained": 1356000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.572999999999858, "episode_len_mean": 229.94, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.30000000000001, 44.900000000000006, -50.00000000000044, -50.00000000000044, 40.70000000000002, 40.10000000000002, -50.00000000000044, 45.7, -50.00000000000044, 33.70000000000004, -50.00000000000044, 45.9, -50.00000000000044, 25.699999999999925, 45.5, 36.900000000000034, 36.70000000000003, 42.30000000000001, 43.10000000000001, 41.500000000000014, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 28.699999999999967, 27.899999999999956, -50.00000000000044, 45.5, 46.9, 39.10000000000002, 44.10000000000001, 43.10000000000001, 41.70000000000002, -50.00000000000044, 43.7, 41.100000000000016, 41.500000000000014, -50.00000000000044, 43.7, 44.300000000000004, 43.50000000000001, -50.00000000000044, -50.00000000000044, 42.70000000000001, 39.300000000000026, 29.69999999999998, 45.7, 33.70000000000004, 35.500000000000036, 44.300000000000004, 43.50000000000001, 45.5, -50.00000000000044, -50.00000000000044, 30.9, 43.900000000000006, 44.7, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, 42.30000000000001, 26.09999999999993, 31.500000000000007, -50.00000000000044, 39.50000000000002, -50.00000000000044, 24.099999999999902, 39.70000000000002, 31.900000000000013, -50.00000000000044, 44.5, -50.00000000000044, 36.70000000000003, -50.00000000000044, 39.50000000000002, 44.10000000000001, 40.500000000000014, -50.00000000000044, 45.5, 45.3, 44.7, 45.5, 43.900000000000006, 35.900000000000034, 41.500000000000014, -50.00000000000044, 43.50000000000001, 46.099999999999994, 44.10000000000001, 40.500000000000014], "episode_lengths": [88, 52, 500, 500, 94, 100, 500, 44, 500, 164, 500, 42, 500, 244, 46, 132, 134, 78, 70, 86, 500, 58, 500, 500, 500, 500, 500, 500, 500, 500, 36, 214, 222, 500, 46, 32, 110, 60, 70, 84, 500, 64, 90, 86, 500, 64, 58, 66, 500, 500, 74, 108, 204, 44, 164, 146, 58, 66, 46, 500, 500, 192, 62, 54, 500, 70, 500, 500, 500, 118, 78, 240, 186, 500, 106, 500, 260, 104, 182, 500, 56, 500, 134, 500, 106, 60, 96, 500, 46, 48, 54, 46, 62, 142, 86, 500, 66, 40, 60, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3774430569503446, "mean_inference_ms": 1.20904197583629, "mean_action_processing_ms": 0.13937574556475915, "mean_env_wait_ms": 0.08329245174594524, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019014596939086914, "StateBufferConnector_ms": 0.008001327514648438, "ViewRequirementAgentConnector_ms": 0.13353776931762695}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.572999999999858, "episode_len_mean": 229.94, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [41.30000000000001, 44.900000000000006, -50.00000000000044, -50.00000000000044, 40.70000000000002, 40.10000000000002, -50.00000000000044, 45.7, -50.00000000000044, 33.70000000000004, -50.00000000000044, 45.9, -50.00000000000044, 25.699999999999925, 45.5, 36.900000000000034, 36.70000000000003, 42.30000000000001, 43.10000000000001, 41.500000000000014, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 28.699999999999967, 27.899999999999956, -50.00000000000044, 45.5, 46.9, 39.10000000000002, 44.10000000000001, 43.10000000000001, 41.70000000000002, -50.00000000000044, 43.7, 41.100000000000016, 41.500000000000014, -50.00000000000044, 43.7, 44.300000000000004, 43.50000000000001, -50.00000000000044, -50.00000000000044, 42.70000000000001, 39.300000000000026, 29.69999999999998, 45.7, 33.70000000000004, 35.500000000000036, 44.300000000000004, 43.50000000000001, 45.5, -50.00000000000044, -50.00000000000044, 30.9, 43.900000000000006, 44.7, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, 42.30000000000001, 26.09999999999993, 31.500000000000007, -50.00000000000044, 39.50000000000002, -50.00000000000044, 24.099999999999902, 39.70000000000002, 31.900000000000013, -50.00000000000044, 44.5, -50.00000000000044, 36.70000000000003, -50.00000000000044, 39.50000000000002, 44.10000000000001, 40.500000000000014, -50.00000000000044, 45.5, 45.3, 44.7, 45.5, 43.900000000000006, 35.900000000000034, 41.500000000000014, -50.00000000000044, 43.50000000000001, 46.099999999999994, 44.10000000000001, 40.500000000000014], "episode_lengths": [88, 52, 500, 500, 94, 100, 500, 44, 500, 164, 500, 42, 500, 244, 46, 132, 134, 78, 70, 86, 500, 58, 500, 500, 500, 500, 500, 500, 500, 500, 36, 214, 222, 500, 46, 32, 110, 60, 70, 84, 500, 64, 90, 86, 500, 64, 58, 66, 500, 500, 74, 108, 204, 44, 164, 146, 58, 66, 46, 500, 500, 192, 62, 54, 500, 70, 500, 500, 500, 118, 78, 240, 186, 500, 106, 500, 260, 104, 182, 500, 56, 500, 134, 500, 106, 60, 96, 500, 46, 48, 54, 46, 62, 142, 86, 500, 66, 40, 60, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3774430569503446, "mean_inference_ms": 1.20904197583629, "mean_action_processing_ms": 0.13937574556475915, "mean_env_wait_ms": 0.08329245174594524, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019014596939086914, "StateBufferConnector_ms": 0.008001327514648438, "ViewRequirementAgentConnector_ms": 0.13353776931762695}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1356000, "num_agent_steps_trained": 1356000, "num_env_steps_sampled": 1356000, "num_env_steps_trained": 1356000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5111.08949262242, "num_env_steps_trained_throughput_per_sec": 5111.08949262242, "timesteps_total": 1356000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1356000, "timers": {"training_iteration_time_ms": 2203.087, "sample_time_ms": 1953.605, "load_time_ms": 10.355, "load_throughput": 1158887.615, "learn_time_ms": 228.414, "learn_throughput": 52536.116, "synch_weights_time_ms": 8.975}, "counters": {"num_env_steps_sampled": 1356000, "num_env_steps_trained": 1356000, "num_agent_steps_sampled": 1356000, "num_agent_steps_trained": 1356000}, "done": false, "episodes_total": 5159, "training_iteration": 113, "trial_id": "9f288_00016", "date": "2023-10-25_16-55-43", "timestamp": 1698249343, "time_this_iter_s": 2.352834463119507, "time_total_s": 247.4245207309723, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 247.4245207309723, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 59.56666666666666, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.9259299443872362e-35, "cur_lr": 0.0003, "total_loss": 6.701874838935004, "policy_loss": 0.00010852143168449402, "vf_loss": 6.701819870207045, "vf_explained_var": -7.020102606879341e-07, "kl": 8.674825454590973e-05, "entropy": 0.5354445957475238, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 2043.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1368000, "num_env_steps_trained": 1368000, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 15.350999999999875, "episode_len_mean": 212.22, "episode_media": {}, "episodes_this_iter": 56, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.300000000000004, 43.50000000000001, 45.5, -50.00000000000044, -50.00000000000044, 30.9, 43.900000000000006, 44.7, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, 42.30000000000001, 26.09999999999993, 31.500000000000007, -50.00000000000044, 39.50000000000002, -50.00000000000044, 24.099999999999902, 39.70000000000002, 31.900000000000013, -50.00000000000044, 44.5, -50.00000000000044, 36.70000000000003, -50.00000000000044, 39.50000000000002, 44.10000000000001, 40.500000000000014, -50.00000000000044, 45.5, 45.3, 44.7, 45.5, 43.900000000000006, 35.900000000000034, 41.500000000000014, -50.00000000000044, 43.50000000000001, 46.099999999999994, 44.10000000000001, 40.500000000000014, -50.00000000000044, 38.300000000000026, -50.00000000000044, 45.9, 29.899999999999984, 42.30000000000001, 45.3, 45.7, 17.69999999999981, 32.30000000000002, 45.1, -50.00000000000044, 39.90000000000002, 45.7, 27.299999999999947, 36.50000000000003, -50.00000000000044, -50.00000000000044, 41.90000000000001, 45.5, 23.699999999999896, 45.9, 40.70000000000002, 43.30000000000001, 41.500000000000014, 43.10000000000001, 46.699999999999996, -50.00000000000044, 43.7, -50.00000000000044, 26.499999999999936, -50.00000000000044, 33.90000000000004, 42.900000000000006, 42.10000000000001, 36.900000000000034, 38.10000000000002, -50.00000000000044, -50.00000000000044, 40.70000000000002, 23.8999999999999, -50.00000000000044, -50.00000000000044, 41.70000000000002, 44.10000000000001, 44.300000000000004, 42.70000000000001, 46.699999999999996, 3.499999999999609, 39.300000000000026, 42.10000000000001, 46.3, -50.00000000000044, -50.00000000000044, 44.300000000000004, 46.099999999999994], "episode_lengths": [58, 66, 46, 500, 500, 192, 62, 54, 500, 70, 500, 500, 500, 118, 78, 240, 186, 500, 106, 500, 260, 104, 182, 500, 56, 500, 134, 500, 106, 60, 96, 500, 46, 48, 54, 46, 62, 142, 86, 500, 66, 40, 60, 96, 500, 118, 500, 42, 202, 78, 48, 44, 324, 178, 50, 500, 102, 44, 228, 136, 500, 500, 82, 46, 264, 42, 94, 68, 86, 70, 34, 500, 64, 500, 236, 500, 162, 72, 80, 132, 120, 500, 500, 94, 262, 500, 500, 84, 60, 58, 74, 34, 466, 108, 80, 38, 500, 500, 58, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3775193726700275, "mean_inference_ms": 1.2090377933616119, "mean_action_processing_ms": 0.13937317745404013, "mean_env_wait_ms": 0.08338855653478795, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024991750717163086, "StateBufferConnector_ms": 0.011004209518432617, "ViewRequirementAgentConnector_ms": 0.13500714302062988}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 15.350999999999875, "episode_len_mean": 212.22, "episodes_this_iter": 56, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.300000000000004, 43.50000000000001, 45.5, -50.00000000000044, -50.00000000000044, 30.9, 43.900000000000006, 44.7, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, 42.30000000000001, 26.09999999999993, 31.500000000000007, -50.00000000000044, 39.50000000000002, -50.00000000000044, 24.099999999999902, 39.70000000000002, 31.900000000000013, -50.00000000000044, 44.5, -50.00000000000044, 36.70000000000003, -50.00000000000044, 39.50000000000002, 44.10000000000001, 40.500000000000014, -50.00000000000044, 45.5, 45.3, 44.7, 45.5, 43.900000000000006, 35.900000000000034, 41.500000000000014, -50.00000000000044, 43.50000000000001, 46.099999999999994, 44.10000000000001, 40.500000000000014, -50.00000000000044, 38.300000000000026, -50.00000000000044, 45.9, 29.899999999999984, 42.30000000000001, 45.3, 45.7, 17.69999999999981, 32.30000000000002, 45.1, -50.00000000000044, 39.90000000000002, 45.7, 27.299999999999947, 36.50000000000003, -50.00000000000044, -50.00000000000044, 41.90000000000001, 45.5, 23.699999999999896, 45.9, 40.70000000000002, 43.30000000000001, 41.500000000000014, 43.10000000000001, 46.699999999999996, -50.00000000000044, 43.7, -50.00000000000044, 26.499999999999936, -50.00000000000044, 33.90000000000004, 42.900000000000006, 42.10000000000001, 36.900000000000034, 38.10000000000002, -50.00000000000044, -50.00000000000044, 40.70000000000002, 23.8999999999999, -50.00000000000044, -50.00000000000044, 41.70000000000002, 44.10000000000001, 44.300000000000004, 42.70000000000001, 46.699999999999996, 3.499999999999609, 39.300000000000026, 42.10000000000001, 46.3, -50.00000000000044, -50.00000000000044, 44.300000000000004, 46.099999999999994], "episode_lengths": [58, 66, 46, 500, 500, 192, 62, 54, 500, 70, 500, 500, 500, 118, 78, 240, 186, 500, 106, 500, 260, 104, 182, 500, 56, 500, 134, 500, 106, 60, 96, 500, 46, 48, 54, 46, 62, 142, 86, 500, 66, 40, 60, 96, 500, 118, 500, 42, 202, 78, 48, 44, 324, 178, 50, 500, 102, 44, 228, 136, 500, 500, 82, 46, 264, 42, 94, 68, 86, 70, 34, 500, 64, 500, 236, 500, 162, 72, 80, 132, 120, 500, 500, 94, 262, 500, 500, 84, 60, 58, 74, 34, 466, 108, 80, 38, 500, 500, 58, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3775193726700275, "mean_inference_ms": 1.2090377933616119, "mean_action_processing_ms": 0.13937317745404013, "mean_env_wait_ms": 0.08338855653478795, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024991750717163086, "StateBufferConnector_ms": 0.011004209518432617, "ViewRequirementAgentConnector_ms": 0.13500714302062988}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000, "num_env_steps_sampled": 1368000, "num_env_steps_trained": 1368000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5253.305074476443, "num_env_steps_trained_throughput_per_sec": 5253.305074476443, "timesteps_total": 1368000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1368000, "timers": {"training_iteration_time_ms": 2225.207, "sample_time_ms": 1962.545, "load_time_ms": 11.356, "load_throughput": 1056739.311, "learn_time_ms": 240.373, "learn_throughput": 49922.409, "synch_weights_time_ms": 9.094}, "counters": {"num_env_steps_sampled": 1368000, "num_env_steps_trained": 1368000, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000}, "done": false, "episodes_total": 5215, "training_iteration": 114, "trial_id": "9f288_00016", "date": "2023-10-25_16-55-45", "timestamp": 1698249345, "time_this_iter_s": 2.289281129837036, "time_total_s": 249.71380186080933, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 249.71380186080933, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 60.699999999999996, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.629649721936181e-36, "cur_lr": 0.0003, "total_loss": 6.9956380526224775, "policy_loss": 7.63237476348877e-05, "vf_loss": 6.99561701880561, "vf_explained_var": -1.0000334845648872e-06, "kl": 8.71891439244463e-05, "entropy": 0.5530672305160098, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 2061.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1380000, "num_env_steps_trained": 1380000, "num_agent_steps_sampled": 1380000, "num_agent_steps_trained": 1380000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 14.35199999999987, "episode_len_mean": 217.2, "episode_media": {}, "episodes_this_iter": 56, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.90000000000002, 45.7, 27.299999999999947, 36.50000000000003, -50.00000000000044, -50.00000000000044, 41.90000000000001, 45.5, 23.699999999999896, 45.9, 40.70000000000002, 43.30000000000001, 41.500000000000014, 43.10000000000001, 46.699999999999996, -50.00000000000044, 43.7, -50.00000000000044, 26.499999999999936, -50.00000000000044, 33.90000000000004, 42.900000000000006, 42.10000000000001, 36.900000000000034, 38.10000000000002, -50.00000000000044, -50.00000000000044, 40.70000000000002, 23.8999999999999, -50.00000000000044, -50.00000000000044, 41.70000000000002, 44.10000000000001, 44.300000000000004, 42.70000000000001, 46.699999999999996, 3.499999999999609, 39.300000000000026, 42.10000000000001, 46.3, -50.00000000000044, -50.00000000000044, 44.300000000000004, 46.099999999999994, -50.00000000000044, -50.00000000000044, 41.70000000000002, 47.5, 46.5, 39.300000000000026, 44.900000000000006, 37.50000000000003, -50.00000000000044, 37.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 13.099999999999746, 32.50000000000002, 38.90000000000002, 45.7, -50.00000000000044, -50.00000000000044, 41.30000000000001, 42.10000000000001, -50.00000000000044, 43.7, 39.70000000000002, -50.00000000000044, -50.00000000000044, 36.10000000000004, 31.300000000000004, 44.300000000000004, 6.8999999999996575, 40.500000000000014, 45.1, 31.900000000000013, -50.00000000000044, -50.00000000000044, 46.099999999999994, 45.7, 46.5, 46.9, -50.00000000000044, 39.10000000000002, 35.500000000000036, 46.3, 46.3, 42.10000000000001, 31.900000000000013, 45.7, 45.5, 43.7, -50.00000000000044, -50.00000000000044, 40.70000000000002, 35.10000000000004, -50.00000000000044, 38.50000000000003, 40.30000000000002], "episode_lengths": [102, 44, 228, 136, 500, 500, 82, 46, 264, 42, 94, 68, 86, 70, 34, 500, 64, 500, 236, 500, 162, 72, 80, 132, 120, 500, 500, 94, 262, 500, 500, 84, 60, 58, 74, 34, 466, 108, 80, 38, 500, 500, 58, 40, 500, 500, 84, 26, 36, 108, 52, 126, 500, 128, 500, 500, 500, 370, 176, 112, 44, 500, 500, 88, 80, 500, 64, 104, 500, 500, 140, 188, 58, 432, 96, 50, 182, 500, 500, 40, 44, 36, 32, 500, 110, 146, 38, 38, 80, 182, 44, 46, 64, 500, 500, 94, 150, 500, 116, 98]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.377156515750176, "mean_inference_ms": 1.2101946197484827, "mean_action_processing_ms": 0.1390695356388512, "mean_env_wait_ms": 0.08355506886866568, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027999162673950195, "StateBufferConnector_ms": 0.01300501823425293, "ViewRequirementAgentConnector_ms": 0.12500238418579102}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 14.35199999999987, "episode_len_mean": 217.2, "episodes_this_iter": 56, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [39.90000000000002, 45.7, 27.299999999999947, 36.50000000000003, -50.00000000000044, -50.00000000000044, 41.90000000000001, 45.5, 23.699999999999896, 45.9, 40.70000000000002, 43.30000000000001, 41.500000000000014, 43.10000000000001, 46.699999999999996, -50.00000000000044, 43.7, -50.00000000000044, 26.499999999999936, -50.00000000000044, 33.90000000000004, 42.900000000000006, 42.10000000000001, 36.900000000000034, 38.10000000000002, -50.00000000000044, -50.00000000000044, 40.70000000000002, 23.8999999999999, -50.00000000000044, -50.00000000000044, 41.70000000000002, 44.10000000000001, 44.300000000000004, 42.70000000000001, 46.699999999999996, 3.499999999999609, 39.300000000000026, 42.10000000000001, 46.3, -50.00000000000044, -50.00000000000044, 44.300000000000004, 46.099999999999994, -50.00000000000044, -50.00000000000044, 41.70000000000002, 47.5, 46.5, 39.300000000000026, 44.900000000000006, 37.50000000000003, -50.00000000000044, 37.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 13.099999999999746, 32.50000000000002, 38.90000000000002, 45.7, -50.00000000000044, -50.00000000000044, 41.30000000000001, 42.10000000000001, -50.00000000000044, 43.7, 39.70000000000002, -50.00000000000044, -50.00000000000044, 36.10000000000004, 31.300000000000004, 44.300000000000004, 6.8999999999996575, 40.500000000000014, 45.1, 31.900000000000013, -50.00000000000044, -50.00000000000044, 46.099999999999994, 45.7, 46.5, 46.9, -50.00000000000044, 39.10000000000002, 35.500000000000036, 46.3, 46.3, 42.10000000000001, 31.900000000000013, 45.7, 45.5, 43.7, -50.00000000000044, -50.00000000000044, 40.70000000000002, 35.10000000000004, -50.00000000000044, 38.50000000000003, 40.30000000000002], "episode_lengths": [102, 44, 228, 136, 500, 500, 82, 46, 264, 42, 94, 68, 86, 70, 34, 500, 64, 500, 236, 500, 162, 72, 80, 132, 120, 500, 500, 94, 262, 500, 500, 84, 60, 58, 74, 34, 466, 108, 80, 38, 500, 500, 58, 40, 500, 500, 84, 26, 36, 108, 52, 126, 500, 128, 500, 500, 500, 370, 176, 112, 44, 500, 500, 88, 80, 500, 64, 104, 500, 500, 140, 188, 58, 432, 96, 50, 182, 500, 500, 40, 44, 36, 32, 500, 110, 146, 38, 38, 80, 182, 44, 46, 64, 500, 500, 94, 150, 500, 116, 98]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.377156515750176, "mean_inference_ms": 1.2101946197484827, "mean_action_processing_ms": 0.1390695356388512, "mean_env_wait_ms": 0.08355506886866568, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027999162673950195, "StateBufferConnector_ms": 0.01300501823425293, "ViewRequirementAgentConnector_ms": 0.12500238418579102}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1380000, "num_agent_steps_trained": 1380000, "num_env_steps_sampled": 1380000, "num_env_steps_trained": 1380000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5709.150482857172, "num_env_steps_trained_throughput_per_sec": 5709.150482857172, "timesteps_total": 1380000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1380000, "timers": {"training_iteration_time_ms": 2213.54, "sample_time_ms": 1963.327, "load_time_ms": 10.884, "load_throughput": 1102574.591, "learn_time_ms": 228.37, "learn_throughput": 52546.246, "synch_weights_time_ms": 9.021}, "counters": {"num_env_steps_sampled": 1380000, "num_env_steps_trained": 1380000, "num_agent_steps_sampled": 1380000, "num_agent_steps_trained": 1380000}, "done": false, "episodes_total": 5271, "training_iteration": 115, "trial_id": "9f288_00016", "date": "2023-10-25_16-55-47", "timestamp": 1698249347, "time_this_iter_s": 2.1078872680664062, "time_total_s": 251.82168912887573, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 251.82168912887573, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 55.833333333333336, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.8148248609680906e-36, "cur_lr": 0.0003, "total_loss": 6.861748033099705, "policy_loss": -0.00039385262708593573, "vf_loss": 6.86219596862793, "vf_explained_var": -8.742014567057291e-07, "kl": 0.0005465114502251191, "entropy": 0.5408863872289658, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 2079.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1392000, "num_env_steps_trained": 1392000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.28199999999985, "episode_len_mean": 237.88, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 41.70000000000002, 47.5, 46.5, 39.300000000000026, 44.900000000000006, 37.50000000000003, -50.00000000000044, 37.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 13.099999999999746, 32.50000000000002, 38.90000000000002, 45.7, -50.00000000000044, -50.00000000000044, 41.30000000000001, 42.10000000000001, -50.00000000000044, 43.7, 39.70000000000002, -50.00000000000044, -50.00000000000044, 36.10000000000004, 31.300000000000004, 44.300000000000004, 6.8999999999996575, 40.500000000000014, 45.1, 31.900000000000013, -50.00000000000044, -50.00000000000044, 46.099999999999994, 45.7, 46.5, 46.9, -50.00000000000044, 39.10000000000002, 35.500000000000036, 46.3, 46.3, 42.10000000000001, 31.900000000000013, 45.7, 45.5, 43.7, -50.00000000000044, -50.00000000000044, 40.70000000000002, 35.10000000000004, -50.00000000000044, 38.50000000000003, 40.30000000000002, 11.699999999999726, 42.70000000000001, 43.7, -50.00000000000044, 21.699999999999868, -50.00000000000044, 45.1, 40.90000000000002, -50.00000000000044, 43.10000000000001, -50.00000000000044, 25.699999999999925, 45.1, -50.00000000000044, -50.00000000000044, 47.5, 46.099999999999994, 43.10000000000001, -50.00000000000044, 23.29999999999989, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, 33.90000000000004, -50.00000000000044, 15.49999999999978, 30.099999999999987, 45.3, 10.299999999999706, 23.099999999999888, 43.50000000000001, 39.90000000000002, 42.900000000000006, 42.500000000000014, -50.00000000000044, -50.00000000000044, 30.099999999999987, 16.499999999999794, 42.900000000000006, 42.70000000000001, -50.00000000000044, 39.300000000000026, 47.3, 18.29999999999982], "episode_lengths": [500, 84, 26, 36, 108, 52, 126, 500, 128, 500, 500, 500, 370, 176, 112, 44, 500, 500, 88, 80, 500, 64, 104, 500, 500, 140, 188, 58, 432, 96, 50, 182, 500, 500, 40, 44, 36, 32, 500, 110, 146, 38, 38, 80, 182, 44, 46, 64, 500, 500, 94, 150, 500, 116, 98, 384, 74, 64, 500, 284, 500, 50, 92, 500, 70, 500, 244, 50, 500, 500, 26, 40, 70, 500, 268, 500, 500, 500, 94, 162, 500, 346, 200, 48, 398, 270, 66, 102, 72, 76, 500, 500, 200, 336, 72, 74, 500, 108, 28, 318]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3769442564770398, "mean_inference_ms": 1.2108879706288371, "mean_action_processing_ms": 0.13909676657704492, "mean_env_wait_ms": 0.08352951450497778, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02701091766357422, "StateBufferConnector_ms": 0.009000301361083984, "ViewRequirementAgentConnector_ms": 0.11798644065856934}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.28199999999985, "episode_len_mean": 237.88, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 41.70000000000002, 47.5, 46.5, 39.300000000000026, 44.900000000000006, 37.50000000000003, -50.00000000000044, 37.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 13.099999999999746, 32.50000000000002, 38.90000000000002, 45.7, -50.00000000000044, -50.00000000000044, 41.30000000000001, 42.10000000000001, -50.00000000000044, 43.7, 39.70000000000002, -50.00000000000044, -50.00000000000044, 36.10000000000004, 31.300000000000004, 44.300000000000004, 6.8999999999996575, 40.500000000000014, 45.1, 31.900000000000013, -50.00000000000044, -50.00000000000044, 46.099999999999994, 45.7, 46.5, 46.9, -50.00000000000044, 39.10000000000002, 35.500000000000036, 46.3, 46.3, 42.10000000000001, 31.900000000000013, 45.7, 45.5, 43.7, -50.00000000000044, -50.00000000000044, 40.70000000000002, 35.10000000000004, -50.00000000000044, 38.50000000000003, 40.30000000000002, 11.699999999999726, 42.70000000000001, 43.7, -50.00000000000044, 21.699999999999868, -50.00000000000044, 45.1, 40.90000000000002, -50.00000000000044, 43.10000000000001, -50.00000000000044, 25.699999999999925, 45.1, -50.00000000000044, -50.00000000000044, 47.5, 46.099999999999994, 43.10000000000001, -50.00000000000044, 23.29999999999989, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, 33.90000000000004, -50.00000000000044, 15.49999999999978, 30.099999999999987, 45.3, 10.299999999999706, 23.099999999999888, 43.50000000000001, 39.90000000000002, 42.900000000000006, 42.500000000000014, -50.00000000000044, -50.00000000000044, 30.099999999999987, 16.499999999999794, 42.900000000000006, 42.70000000000001, -50.00000000000044, 39.300000000000026, 47.3, 18.29999999999982], "episode_lengths": [500, 84, 26, 36, 108, 52, 126, 500, 128, 500, 500, 500, 370, 176, 112, 44, 500, 500, 88, 80, 500, 64, 104, 500, 500, 140, 188, 58, 432, 96, 50, 182, 500, 500, 40, 44, 36, 32, 500, 110, 146, 38, 38, 80, 182, 44, 46, 64, 500, 500, 94, 150, 500, 116, 98, 384, 74, 64, 500, 284, 500, 50, 92, 500, 70, 500, 244, 50, 500, 500, 26, 40, 70, 500, 268, 500, 500, 500, 94, 162, 500, 346, 200, 48, 398, 270, 66, 102, 72, 76, 500, 500, 200, 336, 72, 74, 500, 108, 28, 318]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3769442564770398, "mean_inference_ms": 1.2108879706288371, "mean_action_processing_ms": 0.13909676657704492, "mean_env_wait_ms": 0.08352951450497778, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02701091766357422, "StateBufferConnector_ms": 0.009000301361083984, "ViewRequirementAgentConnector_ms": 0.11798644065856934}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000, "num_env_steps_sampled": 1392000, "num_env_steps_trained": 1392000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5511.465180463092, "num_env_steps_trained_throughput_per_sec": 5511.465180463092, "timesteps_total": 1392000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1392000, "timers": {"training_iteration_time_ms": 2205.985, "sample_time_ms": 1962.587, "load_time_ms": 10.201, "load_throughput": 1176319.384, "learn_time_ms": 222.161, "learn_throughput": 54014.862, "synch_weights_time_ms": 9.067}, "counters": {"num_env_steps_sampled": 1392000, "num_env_steps_trained": 1392000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "done": false, "episodes_total": 5316, "training_iteration": 116, "trial_id": "9f288_00016", "date": "2023-10-25_16-55-49", "timestamp": 1698249349, "time_this_iter_s": 2.1832809448242188, "time_total_s": 254.00497007369995, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 254.00497007369995, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 60.333333333333336, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.4074124304840453e-36, "cur_lr": 0.0003, "total_loss": 6.816290458043416, "policy_loss": -0.0002343371096584532, "vf_loss": 6.8165815406375465, "vf_explained_var": -9.934107462565105e-07, "kl": 0.0003026576017646221, "entropy": 0.5670400973823335, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 2097.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1404000, "num_env_steps_trained": 1404000, "num_agent_steps_sampled": 1404000, "num_agent_steps_trained": 1404000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.414999999999859, "episode_len_mean": 231.56, "episode_media": {}, "episodes_this_iter": 55, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.699999999999726, 42.70000000000001, 43.7, -50.00000000000044, 21.699999999999868, -50.00000000000044, 45.1, 40.90000000000002, -50.00000000000044, 43.10000000000001, -50.00000000000044, 25.699999999999925, 45.1, -50.00000000000044, -50.00000000000044, 47.5, 46.099999999999994, 43.10000000000001, -50.00000000000044, 23.29999999999989, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, 33.90000000000004, -50.00000000000044, 15.49999999999978, 30.099999999999987, 45.3, 10.299999999999706, 23.099999999999888, 43.50000000000001, 39.90000000000002, 42.900000000000006, 42.500000000000014, -50.00000000000044, -50.00000000000044, 30.099999999999987, 16.499999999999794, 42.900000000000006, 42.70000000000001, -50.00000000000044, 39.300000000000026, 47.3, 18.29999999999982, -50.00000000000044, 39.90000000000002, 43.30000000000001, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 45.5, 40.70000000000002, -50.00000000000044, -50.00000000000044, 36.50000000000003, -50.00000000000044, 41.70000000000002, 41.500000000000014, 47.7, -50.00000000000044, 39.10000000000002, -50.00000000000044, 35.500000000000036, 25.899999999999928, 31.70000000000001, 45.3, 44.900000000000006, 31.900000000000013, 45.3, 32.30000000000002, 41.100000000000016, 47.3, 39.300000000000026, 46.099999999999994, 40.90000000000002, 16.29999999999979, 42.10000000000001, -50.00000000000044, 37.90000000000003, 42.70000000000001, -50.00000000000044, 42.30000000000001, -50.00000000000044, 44.7, 35.500000000000036, 40.90000000000002, 43.30000000000001, 44.10000000000001, 46.099999999999994, -50.00000000000044, 41.70000000000002, 43.30000000000001, 35.500000000000036, -50.00000000000044, -50.00000000000044, 37.50000000000003, 44.10000000000001], "episode_lengths": [384, 74, 64, 500, 284, 500, 50, 92, 500, 70, 500, 244, 50, 500, 500, 26, 40, 70, 500, 268, 500, 500, 500, 94, 162, 500, 346, 200, 48, 398, 270, 66, 102, 72, 76, 500, 500, 200, 336, 72, 74, 500, 108, 28, 318, 500, 102, 68, 66, 500, 500, 500, 80, 46, 94, 500, 500, 136, 500, 84, 86, 24, 500, 110, 500, 146, 242, 184, 48, 52, 182, 48, 178, 90, 28, 108, 40, 92, 338, 80, 500, 122, 74, 500, 78, 500, 54, 146, 92, 68, 60, 40, 500, 84, 68, 146, 500, 500, 126, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37708823272482334, "mean_inference_ms": 1.2095397597558297, "mean_action_processing_ms": 0.13934406350571593, "mean_env_wait_ms": 0.08337309278382955, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02851581573486328, "StateBufferConnector_ms": 0.00500035285949707, "ViewRequirementAgentConnector_ms": 0.11550760269165039}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.414999999999859, "episode_len_mean": 231.56, "episodes_this_iter": 55, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [11.699999999999726, 42.70000000000001, 43.7, -50.00000000000044, 21.699999999999868, -50.00000000000044, 45.1, 40.90000000000002, -50.00000000000044, 43.10000000000001, -50.00000000000044, 25.699999999999925, 45.1, -50.00000000000044, -50.00000000000044, 47.5, 46.099999999999994, 43.10000000000001, -50.00000000000044, 23.29999999999989, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, 33.90000000000004, -50.00000000000044, 15.49999999999978, 30.099999999999987, 45.3, 10.299999999999706, 23.099999999999888, 43.50000000000001, 39.90000000000002, 42.900000000000006, 42.500000000000014, -50.00000000000044, -50.00000000000044, 30.099999999999987, 16.499999999999794, 42.900000000000006, 42.70000000000001, -50.00000000000044, 39.300000000000026, 47.3, 18.29999999999982, -50.00000000000044, 39.90000000000002, 43.30000000000001, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 45.5, 40.70000000000002, -50.00000000000044, -50.00000000000044, 36.50000000000003, -50.00000000000044, 41.70000000000002, 41.500000000000014, 47.7, -50.00000000000044, 39.10000000000002, -50.00000000000044, 35.500000000000036, 25.899999999999928, 31.70000000000001, 45.3, 44.900000000000006, 31.900000000000013, 45.3, 32.30000000000002, 41.100000000000016, 47.3, 39.300000000000026, 46.099999999999994, 40.90000000000002, 16.29999999999979, 42.10000000000001, -50.00000000000044, 37.90000000000003, 42.70000000000001, -50.00000000000044, 42.30000000000001, -50.00000000000044, 44.7, 35.500000000000036, 40.90000000000002, 43.30000000000001, 44.10000000000001, 46.099999999999994, -50.00000000000044, 41.70000000000002, 43.30000000000001, 35.500000000000036, -50.00000000000044, -50.00000000000044, 37.50000000000003, 44.10000000000001], "episode_lengths": [384, 74, 64, 500, 284, 500, 50, 92, 500, 70, 500, 244, 50, 500, 500, 26, 40, 70, 500, 268, 500, 500, 500, 94, 162, 500, 346, 200, 48, 398, 270, 66, 102, 72, 76, 500, 500, 200, 336, 72, 74, 500, 108, 28, 318, 500, 102, 68, 66, 500, 500, 500, 80, 46, 94, 500, 500, 136, 500, 84, 86, 24, 500, 110, 500, 146, 242, 184, 48, 52, 182, 48, 178, 90, 28, 108, 40, 92, 338, 80, 500, 122, 74, 500, 78, 500, 54, 146, 92, 68, 60, 40, 500, 84, 68, 146, 500, 500, 126, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37708823272482334, "mean_inference_ms": 1.2095397597558297, "mean_action_processing_ms": 0.13934406350571593, "mean_env_wait_ms": 0.08337309278382955, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02851581573486328, "StateBufferConnector_ms": 0.00500035285949707, "ViewRequirementAgentConnector_ms": 0.11550760269165039}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1404000, "num_agent_steps_trained": 1404000, "num_env_steps_sampled": 1404000, "num_env_steps_trained": 1404000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5670.853398874069, "num_env_steps_trained_throughput_per_sec": 5670.853398874069, "timesteps_total": 1404000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1404000, "timers": {"training_iteration_time_ms": 2210.202, "sample_time_ms": 1961.656, "load_time_ms": 10.4, "load_throughput": 1153797.527, "learn_time_ms": 227.193, "learn_throughput": 52818.607, "synch_weights_time_ms": 8.985}, "counters": {"num_env_steps_sampled": 1404000, "num_env_steps_trained": 1404000, "num_agent_steps_sampled": 1404000, "num_agent_steps_trained": 1404000}, "done": false, "episodes_total": 5371, "training_iteration": 117, "trial_id": "9f288_00016", "date": "2023-10-25_16-55-51", "timestamp": 1698249351, "time_this_iter_s": 2.1220717430114746, "time_total_s": 256.1270418167114, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 256.1270418167114, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 59.9, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.2037062152420226e-36, "cur_lr": 0.0003, "total_loss": 6.688743061489529, "policy_loss": 1.2385244998666974e-05, "vf_loss": 6.688781367407905, "vf_explained_var": -1.006656222873264e-06, "kl": 0.00014372129921487917, "entropy": 0.5065146055486467, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 2115.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1416000, "num_env_steps_trained": 1416000, "num_agent_steps_sampled": 1416000, "num_agent_steps_trained": 1416000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.002999999999854, "episode_len_mean": 235.64, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.90000000000002, 43.30000000000001, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 45.5, 40.70000000000002, -50.00000000000044, -50.00000000000044, 36.50000000000003, -50.00000000000044, 41.70000000000002, 41.500000000000014, 47.7, -50.00000000000044, 39.10000000000002, -50.00000000000044, 35.500000000000036, 25.899999999999928, 31.70000000000001, 45.3, 44.900000000000006, 31.900000000000013, 45.3, 32.30000000000002, 41.100000000000016, 47.3, 39.300000000000026, 46.099999999999994, 40.90000000000002, 16.29999999999979, 42.10000000000001, -50.00000000000044, 37.90000000000003, 42.70000000000001, -50.00000000000044, 42.30000000000001, -50.00000000000044, 44.7, 35.500000000000036, 40.90000000000002, 43.30000000000001, 44.10000000000001, 46.099999999999994, -50.00000000000044, 41.70000000000002, 43.30000000000001, 35.500000000000036, -50.00000000000044, -50.00000000000044, 37.50000000000003, 44.10000000000001, -50.00000000000044, -50.00000000000044, 45.3, 40.70000000000002, 41.100000000000016, -50.00000000000044, 46.099999999999994, -50.00000000000044, 36.10000000000004, 19.299999999999834, 35.70000000000003, 46.099999999999994, 25.899999999999928, -50.00000000000044, -50.00000000000044, 44.5, 43.10000000000001, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 44.7, 38.90000000000002, 43.7, 44.300000000000004, 45.1, 46.3, 34.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 21.699999999999868, -50.00000000000044, -50.00000000000044, 38.300000000000026, 41.30000000000001, 45.3, 24.499999999999908, -50.00000000000044, -50.00000000000044, 32.90000000000003, 44.10000000000001, -50.00000000000044, 28.499999999999964], "episode_lengths": [102, 68, 66, 500, 500, 500, 80, 46, 94, 500, 500, 136, 500, 84, 86, 24, 500, 110, 500, 146, 242, 184, 48, 52, 182, 48, 178, 90, 28, 108, 40, 92, 338, 80, 500, 122, 74, 500, 78, 500, 54, 146, 92, 68, 60, 40, 500, 84, 68, 146, 500, 500, 126, 60, 500, 500, 48, 94, 90, 500, 40, 500, 140, 308, 144, 40, 242, 500, 500, 56, 70, 500, 50, 500, 500, 54, 112, 64, 58, 50, 38, 154, 500, 500, 500, 500, 500, 284, 500, 500, 118, 88, 48, 256, 500, 500, 172, 60, 500, 216]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3770947380171122, "mean_inference_ms": 1.2094059601812943, "mean_action_processing_ms": 0.1393686042434896, "mean_env_wait_ms": 0.08322297429557438, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03452134132385254, "StateBufferConnector_ms": 0.006998538970947266, "ViewRequirementAgentConnector_ms": 0.12148666381835938}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.002999999999854, "episode_len_mean": 235.64, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [39.90000000000002, 43.30000000000001, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 45.5, 40.70000000000002, -50.00000000000044, -50.00000000000044, 36.50000000000003, -50.00000000000044, 41.70000000000002, 41.500000000000014, 47.7, -50.00000000000044, 39.10000000000002, -50.00000000000044, 35.500000000000036, 25.899999999999928, 31.70000000000001, 45.3, 44.900000000000006, 31.900000000000013, 45.3, 32.30000000000002, 41.100000000000016, 47.3, 39.300000000000026, 46.099999999999994, 40.90000000000002, 16.29999999999979, 42.10000000000001, -50.00000000000044, 37.90000000000003, 42.70000000000001, -50.00000000000044, 42.30000000000001, -50.00000000000044, 44.7, 35.500000000000036, 40.90000000000002, 43.30000000000001, 44.10000000000001, 46.099999999999994, -50.00000000000044, 41.70000000000002, 43.30000000000001, 35.500000000000036, -50.00000000000044, -50.00000000000044, 37.50000000000003, 44.10000000000001, -50.00000000000044, -50.00000000000044, 45.3, 40.70000000000002, 41.100000000000016, -50.00000000000044, 46.099999999999994, -50.00000000000044, 36.10000000000004, 19.299999999999834, 35.70000000000003, 46.099999999999994, 25.899999999999928, -50.00000000000044, -50.00000000000044, 44.5, 43.10000000000001, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 44.7, 38.90000000000002, 43.7, 44.300000000000004, 45.1, 46.3, 34.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 21.699999999999868, -50.00000000000044, -50.00000000000044, 38.300000000000026, 41.30000000000001, 45.3, 24.499999999999908, -50.00000000000044, -50.00000000000044, 32.90000000000003, 44.10000000000001, -50.00000000000044, 28.499999999999964], "episode_lengths": [102, 68, 66, 500, 500, 500, 80, 46, 94, 500, 500, 136, 500, 84, 86, 24, 500, 110, 500, 146, 242, 184, 48, 52, 182, 48, 178, 90, 28, 108, 40, 92, 338, 80, 500, 122, 74, 500, 78, 500, 54, 146, 92, 68, 60, 40, 500, 84, 68, 146, 500, 500, 126, 60, 500, 500, 48, 94, 90, 500, 40, 500, 140, 308, 144, 40, 242, 500, 500, 56, 70, 500, 50, 500, 500, 54, 112, 64, 58, 50, 38, 154, 500, 500, 500, 500, 500, 284, 500, 500, 118, 88, 48, 256, 500, 500, 172, 60, 500, 216]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3770947380171122, "mean_inference_ms": 1.2094059601812943, "mean_action_processing_ms": 0.1393686042434896, "mean_env_wait_ms": 0.08322297429557438, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03452134132385254, "StateBufferConnector_ms": 0.006998538970947266, "ViewRequirementAgentConnector_ms": 0.12148666381835938}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1416000, "num_agent_steps_trained": 1416000, "num_env_steps_sampled": 1416000, "num_env_steps_trained": 1416000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5300.515932989266, "num_env_steps_trained_throughput_per_sec": 5300.515932989266, "timesteps_total": 1416000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1416000, "timers": {"training_iteration_time_ms": 2215.358, "sample_time_ms": 1962.502, "load_time_ms": 11.101, "load_throughput": 1081003.864, "learn_time_ms": 230.762, "learn_throughput": 52001.736, "synch_weights_time_ms": 8.926}, "counters": {"num_env_steps_sampled": 1416000, "num_env_steps_trained": 1416000, "num_agent_steps_sampled": 1416000, "num_agent_steps_trained": 1416000}, "done": false, "episodes_total": 5417, "training_iteration": 118, "trial_id": "9f288_00016", "date": "2023-10-25_16-55-54", "timestamp": 1698249354, "time_this_iter_s": 2.268927574157715, "time_total_s": 258.39596939086914, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 258.39596939086914, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 60.26666666666666, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.018531076210113e-37, "cur_lr": 0.0003, "total_loss": 6.383124536938137, "policy_loss": -0.00014114266054497825, "vf_loss": 6.383316490385267, "vf_explained_var": -1.079506344265408e-06, "kl": 0.0004782855946561742, "entropy": 0.5083291265699599, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 2133.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1428000, "num_env_steps_trained": 1428000, "num_agent_steps_sampled": 1428000, "num_agent_steps_trained": 1428000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.86699999999983, "episode_len_mean": 256.96, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 41.70000000000002, 43.30000000000001, 35.500000000000036, -50.00000000000044, -50.00000000000044, 37.50000000000003, 44.10000000000001, -50.00000000000044, -50.00000000000044, 45.3, 40.70000000000002, 41.100000000000016, -50.00000000000044, 46.099999999999994, -50.00000000000044, 36.10000000000004, 19.299999999999834, 35.70000000000003, 46.099999999999994, 25.899999999999928, -50.00000000000044, -50.00000000000044, 44.5, 43.10000000000001, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 44.7, 38.90000000000002, 43.7, 44.300000000000004, 45.1, 46.3, 34.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 21.699999999999868, -50.00000000000044, -50.00000000000044, 38.300000000000026, 41.30000000000001, 45.3, 24.499999999999908, -50.00000000000044, -50.00000000000044, 32.90000000000003, 44.10000000000001, -50.00000000000044, 28.499999999999964, 29.49999999999998, 44.10000000000001, -50.00000000000044, 36.10000000000004, 35.900000000000034, 24.899999999999913, -50.00000000000044, -50.00000000000044, 44.900000000000006, 43.50000000000001, 46.3, 19.899999999999842, 44.5, 46.3, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 45.1, 41.70000000000002, -50.00000000000044, 13.699999999999754, -50.00000000000044, 45.3, -50.00000000000044, 44.7, 47.5, 46.3, 34.900000000000034, 46.9, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 39.10000000000002, -50.00000000000044, 31.1, -50.00000000000044, 30.29999999999999, 43.900000000000006, -50.00000000000044, 45.3, 45.1, 45.3, 31.1, 10.899999999999714], "episode_lengths": [500, 84, 68, 146, 500, 500, 126, 60, 500, 500, 48, 94, 90, 500, 40, 500, 140, 308, 144, 40, 242, 500, 500, 56, 70, 500, 50, 500, 500, 54, 112, 64, 58, 50, 38, 154, 500, 500, 500, 500, 500, 284, 500, 500, 118, 88, 48, 256, 500, 500, 172, 60, 500, 216, 206, 60, 500, 140, 142, 252, 500, 500, 52, 66, 38, 302, 56, 38, 500, 500, 74, 500, 50, 84, 500, 364, 500, 48, 500, 54, 26, 38, 152, 32, 500, 56, 500, 500, 110, 500, 190, 500, 198, 62, 500, 48, 50, 48, 190, 392]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37750923516855933, "mean_inference_ms": 1.209328856375769, "mean_action_processing_ms": 0.1392908881135657, "mean_env_wait_ms": 0.08323067457761266, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03300762176513672, "StateBufferConnector_ms": 0.006996870040893555, "ViewRequirementAgentConnector_ms": 0.12794709205627441}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.86699999999983, "episode_len_mean": 256.96, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 41.70000000000002, 43.30000000000001, 35.500000000000036, -50.00000000000044, -50.00000000000044, 37.50000000000003, 44.10000000000001, -50.00000000000044, -50.00000000000044, 45.3, 40.70000000000002, 41.100000000000016, -50.00000000000044, 46.099999999999994, -50.00000000000044, 36.10000000000004, 19.299999999999834, 35.70000000000003, 46.099999999999994, 25.899999999999928, -50.00000000000044, -50.00000000000044, 44.5, 43.10000000000001, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 44.7, 38.90000000000002, 43.7, 44.300000000000004, 45.1, 46.3, 34.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 21.699999999999868, -50.00000000000044, -50.00000000000044, 38.300000000000026, 41.30000000000001, 45.3, 24.499999999999908, -50.00000000000044, -50.00000000000044, 32.90000000000003, 44.10000000000001, -50.00000000000044, 28.499999999999964, 29.49999999999998, 44.10000000000001, -50.00000000000044, 36.10000000000004, 35.900000000000034, 24.899999999999913, -50.00000000000044, -50.00000000000044, 44.900000000000006, 43.50000000000001, 46.3, 19.899999999999842, 44.5, 46.3, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 45.1, 41.70000000000002, -50.00000000000044, 13.699999999999754, -50.00000000000044, 45.3, -50.00000000000044, 44.7, 47.5, 46.3, 34.900000000000034, 46.9, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 39.10000000000002, -50.00000000000044, 31.1, -50.00000000000044, 30.29999999999999, 43.900000000000006, -50.00000000000044, 45.3, 45.1, 45.3, 31.1, 10.899999999999714], "episode_lengths": [500, 84, 68, 146, 500, 500, 126, 60, 500, 500, 48, 94, 90, 500, 40, 500, 140, 308, 144, 40, 242, 500, 500, 56, 70, 500, 50, 500, 500, 54, 112, 64, 58, 50, 38, 154, 500, 500, 500, 500, 500, 284, 500, 500, 118, 88, 48, 256, 500, 500, 172, 60, 500, 216, 206, 60, 500, 140, 142, 252, 500, 500, 52, 66, 38, 302, 56, 38, 500, 500, 74, 500, 50, 84, 500, 364, 500, 48, 500, 54, 26, 38, 152, 32, 500, 56, 500, 500, 110, 500, 190, 500, 198, 62, 500, 48, 50, 48, 190, 392]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37750923516855933, "mean_inference_ms": 1.209328856375769, "mean_action_processing_ms": 0.1392908881135657, "mean_env_wait_ms": 0.08323067457761266, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03300762176513672, "StateBufferConnector_ms": 0.006996870040893555, "ViewRequirementAgentConnector_ms": 0.12794709205627441}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1428000, "num_agent_steps_trained": 1428000, "num_env_steps_sampled": 1428000, "num_env_steps_trained": 1428000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5004.011429412244, "num_env_steps_trained_throughput_per_sec": 5004.011429412244, "timesteps_total": 1428000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1428000, "timers": {"training_iteration_time_ms": 2231.083, "sample_time_ms": 1977.892, "load_time_ms": 10.909, "load_throughput": 1100051.537, "learn_time_ms": 231.189, "learn_throughput": 51905.538, "synch_weights_time_ms": 9.226}, "counters": {"num_env_steps_sampled": 1428000, "num_env_steps_trained": 1428000, "num_agent_steps_sampled": 1428000, "num_agent_steps_trained": 1428000}, "done": false, "episodes_total": 5463, "training_iteration": 119, "trial_id": "9f288_00016", "date": "2023-10-25_16-55-56", "timestamp": 1698249356, "time_this_iter_s": 2.404075860977173, "time_total_s": 260.8000452518463, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 260.8000452518463, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 52.14999999999999, "ram_util_percent": 27.175}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.0092655381050566e-37, "cur_lr": 0.0003, "total_loss": 6.254930337270101, "policy_loss": -7.277747823132409e-05, "vf_loss": 6.255055507024129, "vf_explained_var": -1.0728836059570312e-06, "kl": 0.00027487893800702697, "entropy": 0.5234178784820769, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 2151.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1440000, "num_env_steps_trained": 1440000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.085999999999822, "episode_len_mean": 259.76, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.30000000000001, 45.3, 24.499999999999908, -50.00000000000044, -50.00000000000044, 32.90000000000003, 44.10000000000001, -50.00000000000044, 28.499999999999964, 29.49999999999998, 44.10000000000001, -50.00000000000044, 36.10000000000004, 35.900000000000034, 24.899999999999913, -50.00000000000044, -50.00000000000044, 44.900000000000006, 43.50000000000001, 46.3, 19.899999999999842, 44.5, 46.3, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 45.1, 41.70000000000002, -50.00000000000044, 13.699999999999754, -50.00000000000044, 45.3, -50.00000000000044, 44.7, 47.5, 46.3, 34.900000000000034, 46.9, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 39.10000000000002, -50.00000000000044, 31.1, -50.00000000000044, 30.29999999999999, 43.900000000000006, -50.00000000000044, 45.3, 45.1, 45.3, 31.1, 10.899999999999714, -50.00000000000044, 46.699999999999996, 43.7, 46.9, 24.299999999999905, -50.00000000000044, -50.00000000000044, 38.300000000000026, 45.5, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 46.5, 46.699999999999996, 44.900000000000006, 30.29999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 45.1, -50.00000000000044, 46.099999999999994, 44.300000000000004, -50.00000000000044, 31.500000000000007, 36.30000000000003, 46.5, 10.499999999999709, -50.00000000000044, 34.30000000000004, 28.89999999999997, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 47.3, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [88, 48, 256, 500, 500, 172, 60, 500, 216, 206, 60, 500, 140, 142, 252, 500, 500, 52, 66, 38, 302, 56, 38, 500, 500, 74, 500, 50, 84, 500, 364, 500, 48, 500, 54, 26, 38, 152, 32, 500, 56, 500, 500, 110, 500, 190, 500, 198, 62, 500, 48, 50, 48, 190, 392, 500, 34, 64, 32, 258, 500, 500, 118, 46, 500, 72, 500, 500, 500, 68, 36, 34, 52, 198, 500, 500, 500, 68, 50, 500, 40, 58, 500, 186, 138, 36, 396, 500, 158, 212, 500, 500, 52, 500, 28, 500, 84, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3775067172362412, "mean_inference_ms": 1.2090068763425992, "mean_action_processing_ms": 0.1391991580211177, "mean_env_wait_ms": 0.08321848209864724, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022997140884399414, "StateBufferConnector_ms": 0.003999233245849609, "ViewRequirementAgentConnector_ms": 0.1251509189605713}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.085999999999822, "episode_len_mean": 259.76, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [41.30000000000001, 45.3, 24.499999999999908, -50.00000000000044, -50.00000000000044, 32.90000000000003, 44.10000000000001, -50.00000000000044, 28.499999999999964, 29.49999999999998, 44.10000000000001, -50.00000000000044, 36.10000000000004, 35.900000000000034, 24.899999999999913, -50.00000000000044, -50.00000000000044, 44.900000000000006, 43.50000000000001, 46.3, 19.899999999999842, 44.5, 46.3, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 45.1, 41.70000000000002, -50.00000000000044, 13.699999999999754, -50.00000000000044, 45.3, -50.00000000000044, 44.7, 47.5, 46.3, 34.900000000000034, 46.9, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 39.10000000000002, -50.00000000000044, 31.1, -50.00000000000044, 30.29999999999999, 43.900000000000006, -50.00000000000044, 45.3, 45.1, 45.3, 31.1, 10.899999999999714, -50.00000000000044, 46.699999999999996, 43.7, 46.9, 24.299999999999905, -50.00000000000044, -50.00000000000044, 38.300000000000026, 45.5, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 46.5, 46.699999999999996, 44.900000000000006, 30.29999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 45.1, -50.00000000000044, 46.099999999999994, 44.300000000000004, -50.00000000000044, 31.500000000000007, 36.30000000000003, 46.5, 10.499999999999709, -50.00000000000044, 34.30000000000004, 28.89999999999997, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 47.3, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [88, 48, 256, 500, 500, 172, 60, 500, 216, 206, 60, 500, 140, 142, 252, 500, 500, 52, 66, 38, 302, 56, 38, 500, 500, 74, 500, 50, 84, 500, 364, 500, 48, 500, 54, 26, 38, 152, 32, 500, 56, 500, 500, 110, 500, 190, 500, 198, 62, 500, 48, 50, 48, 190, 392, 500, 34, 64, 32, 258, 500, 500, 118, 46, 500, 72, 500, 500, 500, 68, 36, 34, 52, 198, 500, 500, 500, 68, 50, 500, 40, 58, 500, 186, 138, 36, 396, 500, 158, 212, 500, 500, 52, 500, 28, 500, 84, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3775067172362412, "mean_inference_ms": 1.2090068763425992, "mean_action_processing_ms": 0.1391991580211177, "mean_env_wait_ms": 0.08321848209864724, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022997140884399414, "StateBufferConnector_ms": 0.003999233245849609, "ViewRequirementAgentConnector_ms": 0.1251509189605713}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000, "num_env_steps_sampled": 1440000, "num_env_steps_trained": 1440000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5244.663185483064, "num_env_steps_trained_throughput_per_sec": 5244.663185483064, "timesteps_total": 1440000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1440000, "timers": {"training_iteration_time_ms": 2226.711, "sample_time_ms": 1978.724, "load_time_ms": 10.58, "load_throughput": 1134226.653, "learn_time_ms": 226.212, "learn_throughput": 53047.488, "synch_weights_time_ms": 9.226}, "counters": {"num_env_steps_sampled": 1440000, "num_env_steps_trained": 1440000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "done": false, "episodes_total": 5508, "training_iteration": 120, "trial_id": "9f288_00016", "date": "2023-10-25_16-55-58", "timestamp": 1698249358, "time_this_iter_s": 2.2930335998535156, "time_total_s": 263.09307885169983, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 263.09307885169983, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 58.833333333333336, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.5046327690525283e-37, "cur_lr": 0.0003, "total_loss": 6.409281280305651, "policy_loss": 8.143732945124309e-05, "vf_loss": 6.409252934985691, "vf_explained_var": -9.5367431640625e-07, "kl": 5.0318835022908656e-05, "entropy": 0.5306124803092744, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 2169.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1452000, "num_env_steps_trained": 1452000, "num_agent_steps_sampled": 1452000, "num_agent_steps_trained": 1452000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.2279999999998177, "episode_len_mean": 268.32, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.10000000000002, -50.00000000000044, 31.1, -50.00000000000044, 30.29999999999999, 43.900000000000006, -50.00000000000044, 45.3, 45.1, 45.3, 31.1, 10.899999999999714, -50.00000000000044, 46.699999999999996, 43.7, 46.9, 24.299999999999905, -50.00000000000044, -50.00000000000044, 38.300000000000026, 45.5, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 46.5, 46.699999999999996, 44.900000000000006, 30.29999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 45.1, -50.00000000000044, 46.099999999999994, 44.300000000000004, -50.00000000000044, 31.500000000000007, 36.30000000000003, 46.5, 10.499999999999709, -50.00000000000044, 34.30000000000004, 28.89999999999997, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 47.3, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 38.300000000000026, -50.00000000000044, 42.500000000000014, 38.300000000000026, 30.9, 41.30000000000001, 39.90000000000002, 44.7, 33.90000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 40.90000000000002, 33.70000000000004, -50.00000000000044, 47.7, 44.10000000000001, 6.8999999999996575, 40.30000000000002, -50.00000000000044, 32.50000000000002, 44.900000000000006, -50.00000000000044, 25.699999999999925, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 32.30000000000002, 37.300000000000026, -50.00000000000044, -50.00000000000044, 44.7, 46.699999999999996, 34.900000000000034], "episode_lengths": [110, 500, 190, 500, 198, 62, 500, 48, 50, 48, 190, 392, 500, 34, 64, 32, 258, 500, 500, 118, 46, 500, 72, 500, 500, 500, 68, 36, 34, 52, 198, 500, 500, 500, 68, 50, 500, 40, 58, 500, 186, 138, 36, 396, 500, 158, 212, 500, 500, 52, 500, 28, 500, 84, 500, 500, 500, 500, 500, 500, 46, 118, 500, 76, 118, 192, 88, 102, 54, 162, 500, 500, 500, 500, 500, 90, 92, 164, 500, 24, 60, 432, 98, 500, 176, 52, 500, 244, 36, 500, 500, 500, 56, 178, 128, 500, 500, 54, 34, 152]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3775006644349109, "mean_inference_ms": 1.2095393419284592, "mean_action_processing_ms": 0.13924002600049004, "mean_env_wait_ms": 0.08331857218615328, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021999120712280273, "StateBufferConnector_ms": 0.0010004043579101562, "ViewRequirementAgentConnector_ms": 0.12199282646179199}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.2279999999998177, "episode_len_mean": 268.32, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [39.10000000000002, -50.00000000000044, 31.1, -50.00000000000044, 30.29999999999999, 43.900000000000006, -50.00000000000044, 45.3, 45.1, 45.3, 31.1, 10.899999999999714, -50.00000000000044, 46.699999999999996, 43.7, 46.9, 24.299999999999905, -50.00000000000044, -50.00000000000044, 38.300000000000026, 45.5, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 46.5, 46.699999999999996, 44.900000000000006, 30.29999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 45.1, -50.00000000000044, 46.099999999999994, 44.300000000000004, -50.00000000000044, 31.500000000000007, 36.30000000000003, 46.5, 10.499999999999709, -50.00000000000044, 34.30000000000004, 28.89999999999997, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 47.3, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 38.300000000000026, -50.00000000000044, 42.500000000000014, 38.300000000000026, 30.9, 41.30000000000001, 39.90000000000002, 44.7, 33.90000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 40.90000000000002, 33.70000000000004, -50.00000000000044, 47.7, 44.10000000000001, 6.8999999999996575, 40.30000000000002, -50.00000000000044, 32.50000000000002, 44.900000000000006, -50.00000000000044, 25.699999999999925, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 32.30000000000002, 37.300000000000026, -50.00000000000044, -50.00000000000044, 44.7, 46.699999999999996, 34.900000000000034], "episode_lengths": [110, 500, 190, 500, 198, 62, 500, 48, 50, 48, 190, 392, 500, 34, 64, 32, 258, 500, 500, 118, 46, 500, 72, 500, 500, 500, 68, 36, 34, 52, 198, 500, 500, 500, 68, 50, 500, 40, 58, 500, 186, 138, 36, 396, 500, 158, 212, 500, 500, 52, 500, 28, 500, 84, 500, 500, 500, 500, 500, 500, 46, 118, 500, 76, 118, 192, 88, 102, 54, 162, 500, 500, 500, 500, 500, 90, 92, 164, 500, 24, 60, 432, 98, 500, 176, 52, 500, 244, 36, 500, 500, 500, 56, 178, 128, 500, 500, 54, 34, 152]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3775006644349109, "mean_inference_ms": 1.2095393419284592, "mean_action_processing_ms": 0.13924002600049004, "mean_env_wait_ms": 0.08331857218615328, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021999120712280273, "StateBufferConnector_ms": 0.0010004043579101562, "ViewRequirementAgentConnector_ms": 0.12199282646179199}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1452000, "num_agent_steps_trained": 1452000, "num_env_steps_sampled": 1452000, "num_env_steps_trained": 1452000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5684.397196361428, "num_env_steps_trained_throughput_per_sec": 5684.397196361428, "timesteps_total": 1452000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1452000, "timers": {"training_iteration_time_ms": 2232.668, "sample_time_ms": 1981.199, "load_time_ms": 10.981, "load_throughput": 1092831.106, "learn_time_ms": 229.489, "learn_throughput": 52289.986, "synch_weights_time_ms": 9.23}, "counters": {"num_env_steps_sampled": 1452000, "num_env_steps_trained": 1452000, "num_agent_steps_sampled": 1452000, "num_agent_steps_trained": 1452000}, "done": false, "episodes_total": 5551, "training_iteration": 121, "trial_id": "9f288_00016", "date": "2023-10-25_16-56-00", "timestamp": 1698249360, "time_this_iter_s": 2.1180484294891357, "time_total_s": 265.21112728118896, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 265.21112728118896, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 57.166666666666664, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.523163845262642e-38, "cur_lr": 0.0003, "total_loss": 6.678192933400472, "policy_loss": -0.0002656356535024113, "vf_loss": 6.6785107718573675, "vf_explained_var": -8.940696716308594e-07, "kl": 0.0002517849913338131, "entropy": 0.5212064435084661, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 2187.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1464000, "num_env_steps_trained": 1464000, "num_agent_steps_sampled": 1464000, "num_agent_steps_trained": 1464000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.8920000000002057, "episode_len_mean": 289.46, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 34.30000000000004, 28.89999999999997, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 47.3, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 38.300000000000026, -50.00000000000044, 42.500000000000014, 38.300000000000026, 30.9, 41.30000000000001, 39.90000000000002, 44.7, 33.90000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 40.90000000000002, 33.70000000000004, -50.00000000000044, 47.7, 44.10000000000001, 6.8999999999996575, 40.30000000000002, -50.00000000000044, 32.50000000000002, 44.900000000000006, -50.00000000000044, 25.699999999999925, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 32.30000000000002, 37.300000000000026, -50.00000000000044, -50.00000000000044, 44.7, 46.699999999999996, 34.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002, -50.00000000000044, 39.50000000000002, 44.900000000000006, 46.099999999999994, 41.70000000000002, -50.00000000000044, 44.7, 44.7, -50.00000000000044, -50.00000000000044, 12.499999999999737, 44.900000000000006, 44.5, 36.10000000000004, -50.00000000000044, -50.00000000000044, 45.1, 37.70000000000003, 43.900000000000006, -50.00000000000044, 43.7, 23.099999999999888, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 43.10000000000001, 43.10000000000001, 34.30000000000004, 37.90000000000003, -50.00000000000044, -50.00000000000044, 28.89999999999997, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 158, 212, 500, 500, 52, 500, 28, 500, 84, 500, 500, 500, 500, 500, 500, 46, 118, 500, 76, 118, 192, 88, 102, 54, 162, 500, 500, 500, 500, 500, 90, 92, 164, 500, 24, 60, 432, 98, 500, 176, 52, 500, 244, 36, 500, 500, 500, 56, 178, 128, 500, 500, 54, 34, 152, 500, 500, 500, 106, 500, 106, 52, 40, 84, 500, 54, 54, 500, 500, 376, 52, 56, 140, 500, 500, 50, 124, 62, 500, 64, 270, 500, 500, 36, 500, 500, 70, 70, 158, 122, 500, 500, 212, 500, 28, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3771539420527405, "mean_inference_ms": 1.2105022430203574, "mean_action_processing_ms": 0.13945179368952815, "mean_env_wait_ms": 0.08350998525254497, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023990631103515625, "StateBufferConnector_ms": 0.003999233245849609, "ViewRequirementAgentConnector_ms": 0.12395811080932617}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.8920000000002057, "episode_len_mean": 289.46, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 34.30000000000004, 28.89999999999997, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 47.3, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 38.300000000000026, -50.00000000000044, 42.500000000000014, 38.300000000000026, 30.9, 41.30000000000001, 39.90000000000002, 44.7, 33.90000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 40.90000000000002, 33.70000000000004, -50.00000000000044, 47.7, 44.10000000000001, 6.8999999999996575, 40.30000000000002, -50.00000000000044, 32.50000000000002, 44.900000000000006, -50.00000000000044, 25.699999999999925, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 32.30000000000002, 37.300000000000026, -50.00000000000044, -50.00000000000044, 44.7, 46.699999999999996, 34.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002, -50.00000000000044, 39.50000000000002, 44.900000000000006, 46.099999999999994, 41.70000000000002, -50.00000000000044, 44.7, 44.7, -50.00000000000044, -50.00000000000044, 12.499999999999737, 44.900000000000006, 44.5, 36.10000000000004, -50.00000000000044, -50.00000000000044, 45.1, 37.70000000000003, 43.900000000000006, -50.00000000000044, 43.7, 23.099999999999888, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 43.10000000000001, 43.10000000000001, 34.30000000000004, 37.90000000000003, -50.00000000000044, -50.00000000000044, 28.89999999999997, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 158, 212, 500, 500, 52, 500, 28, 500, 84, 500, 500, 500, 500, 500, 500, 46, 118, 500, 76, 118, 192, 88, 102, 54, 162, 500, 500, 500, 500, 500, 90, 92, 164, 500, 24, 60, 432, 98, 500, 176, 52, 500, 244, 36, 500, 500, 500, 56, 178, 128, 500, 500, 54, 34, 152, 500, 500, 500, 106, 500, 106, 52, 40, 84, 500, 54, 54, 500, 500, 376, 52, 56, 140, 500, 500, 50, 124, 62, 500, 64, 270, 500, 500, 36, 500, 500, 70, 70, 158, 122, 500, 500, 212, 500, 28, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3771539420527405, "mean_inference_ms": 1.2105022430203574, "mean_action_processing_ms": 0.13945179368952815, "mean_env_wait_ms": 0.08350998525254497, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023990631103515625, "StateBufferConnector_ms": 0.003999233245849609, "ViewRequirementAgentConnector_ms": 0.12395811080932617}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1464000, "num_agent_steps_trained": 1464000, "num_env_steps_sampled": 1464000, "num_env_steps_trained": 1464000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5243.118671131176, "num_env_steps_trained_throughput_per_sec": 5243.118671131176, "timesteps_total": 1464000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1464000, "timers": {"training_iteration_time_ms": 2237.617, "sample_time_ms": 1976.707, "load_time_ms": 11.595, "load_throughput": 1034927.888, "learn_time_ms": 238.463, "learn_throughput": 50322.353, "synch_weights_time_ms": 9.15}, "counters": {"num_env_steps_sampled": 1464000, "num_env_steps_trained": 1464000, "num_agent_steps_sampled": 1464000, "num_agent_steps_trained": 1464000}, "done": false, "episodes_total": 5595, "training_iteration": 122, "trial_id": "9f288_00016", "date": "2023-10-25_16-56-03", "timestamp": 1698249363, "time_this_iter_s": 2.2937114238739014, "time_total_s": 267.50483870506287, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 267.50483870506287, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 61.666666666666664, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.761581922631321e-38, "cur_lr": 0.0003, "total_loss": 6.754587809244792, "policy_loss": -0.0007373444322082731, "vf_loss": 6.755375385284424, "vf_explained_var": -8.742014567057291e-07, "kl": 0.0010576250720835863, "entropy": 0.5019072691599528, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 2205.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1476000, "num_env_steps_trained": 1476000, "num_agent_steps_sampled": 1476000, "num_agent_steps_trained": 1476000}, "sampler_results": {"episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.306999999999837, "episode_len_mean": 242.58, "episode_media": {}, "episodes_this_iter": 57, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 39.50000000000002, -50.00000000000044, 39.50000000000002, 44.900000000000006, 46.099999999999994, 41.70000000000002, -50.00000000000044, 44.7, 44.7, -50.00000000000044, -50.00000000000044, 12.499999999999737, 44.900000000000006, 44.5, 36.10000000000004, -50.00000000000044, -50.00000000000044, 45.1, 37.70000000000003, 43.900000000000006, -50.00000000000044, 43.7, 23.099999999999888, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 43.10000000000001, 43.10000000000001, 34.30000000000004, 37.90000000000003, -50.00000000000044, -50.00000000000044, 28.89999999999997, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 2.699999999999598, 40.90000000000002, 33.10000000000003, 46.5, 44.10000000000001, 47.5, 47.5, 34.70000000000004, 46.9, 40.500000000000014, 29.49999999999998, -50.00000000000044, 44.5, 48.1, -50.00000000000044, 37.90000000000003, 44.10000000000001, 46.3, 46.3, -50.00000000000044, 45.5, 45.3, -50.00000000000044, 44.900000000000006, -50.00000000000044, 21.09999999999986, 43.7, 43.7, 46.3, -50.00000000000044, 44.300000000000004, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 24.099999999999902, -50.00000000000044, 36.30000000000003, 39.10000000000002, -50.00000000000044, 44.900000000000006, 45.3, 44.10000000000001, 45.5, 42.70000000000001, -50.00000000000044, 46.9, 18.29999999999982, -50.00000000000044, 36.70000000000003, 41.90000000000001, 44.7, -50.00000000000044, 8.49999999999968, 45.5, 43.30000000000001, -50.00000000000044], "episode_lengths": [500, 500, 106, 500, 106, 52, 40, 84, 500, 54, 54, 500, 500, 376, 52, 56, 140, 500, 500, 50, 124, 62, 500, 64, 270, 500, 500, 36, 500, 500, 70, 70, 158, 122, 500, 500, 212, 500, 28, 500, 500, 500, 500, 474, 92, 170, 36, 60, 26, 26, 154, 32, 96, 206, 500, 56, 20, 500, 122, 60, 38, 38, 500, 46, 48, 500, 52, 500, 290, 64, 64, 38, 500, 58, 500, 68, 500, 500, 260, 500, 138, 110, 500, 52, 48, 60, 46, 74, 500, 32, 318, 500, 134, 82, 54, 500, 416, 46, 68, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3770000367230364, "mean_inference_ms": 1.2102636099684871, "mean_action_processing_ms": 0.1392767603640337, "mean_env_wait_ms": 0.083362951661374, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027991294860839844, "StateBufferConnector_ms": 0.010999679565429688, "ViewRequirementAgentConnector_ms": 0.10700654983520508}}, "episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.306999999999837, "episode_len_mean": 242.58, "episodes_this_iter": 57, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 39.50000000000002, -50.00000000000044, 39.50000000000002, 44.900000000000006, 46.099999999999994, 41.70000000000002, -50.00000000000044, 44.7, 44.7, -50.00000000000044, -50.00000000000044, 12.499999999999737, 44.900000000000006, 44.5, 36.10000000000004, -50.00000000000044, -50.00000000000044, 45.1, 37.70000000000003, 43.900000000000006, -50.00000000000044, 43.7, 23.099999999999888, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 43.10000000000001, 43.10000000000001, 34.30000000000004, 37.90000000000003, -50.00000000000044, -50.00000000000044, 28.89999999999997, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 2.699999999999598, 40.90000000000002, 33.10000000000003, 46.5, 44.10000000000001, 47.5, 47.5, 34.70000000000004, 46.9, 40.500000000000014, 29.49999999999998, -50.00000000000044, 44.5, 48.1, -50.00000000000044, 37.90000000000003, 44.10000000000001, 46.3, 46.3, -50.00000000000044, 45.5, 45.3, -50.00000000000044, 44.900000000000006, -50.00000000000044, 21.09999999999986, 43.7, 43.7, 46.3, -50.00000000000044, 44.300000000000004, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 24.099999999999902, -50.00000000000044, 36.30000000000003, 39.10000000000002, -50.00000000000044, 44.900000000000006, 45.3, 44.10000000000001, 45.5, 42.70000000000001, -50.00000000000044, 46.9, 18.29999999999982, -50.00000000000044, 36.70000000000003, 41.90000000000001, 44.7, -50.00000000000044, 8.49999999999968, 45.5, 43.30000000000001, -50.00000000000044], "episode_lengths": [500, 500, 106, 500, 106, 52, 40, 84, 500, 54, 54, 500, 500, 376, 52, 56, 140, 500, 500, 50, 124, 62, 500, 64, 270, 500, 500, 36, 500, 500, 70, 70, 158, 122, 500, 500, 212, 500, 28, 500, 500, 500, 500, 474, 92, 170, 36, 60, 26, 26, 154, 32, 96, 206, 500, 56, 20, 500, 122, 60, 38, 38, 500, 46, 48, 500, 52, 500, 290, 64, 64, 38, 500, 58, 500, 68, 500, 500, 260, 500, 138, 110, 500, 52, 48, 60, 46, 74, 500, 32, 318, 500, 134, 82, 54, 500, 416, 46, 68, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3770000367230364, "mean_inference_ms": 1.2102636099684871, "mean_action_processing_ms": 0.1392767603640337, "mean_env_wait_ms": 0.083362951661374, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027991294860839844, "StateBufferConnector_ms": 0.010999679565429688, "ViewRequirementAgentConnector_ms": 0.10700654983520508}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1476000, "num_agent_steps_trained": 1476000, "num_env_steps_sampled": 1476000, "num_env_steps_trained": 1476000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5760.160404857465, "num_env_steps_trained_throughput_per_sec": 5760.160404857465, "timesteps_total": 1476000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1476000, "timers": {"training_iteration_time_ms": 2211.161, "sample_time_ms": 1953.824, "load_time_ms": 11.366, "load_throughput": 1055768.422, "learn_time_ms": 234.918, "learn_throughput": 51081.582, "synch_weights_time_ms": 9.25}, "counters": {"num_env_steps_sampled": 1476000, "num_env_steps_trained": 1476000, "num_agent_steps_sampled": 1476000, "num_agent_steps_trained": 1476000}, "done": false, "episodes_total": 5652, "training_iteration": 123, "trial_id": "9f288_00016", "date": "2023-10-25_16-56-05", "timestamp": 1698249365, "time_this_iter_s": 2.088273286819458, "time_total_s": 269.5931119918823, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 269.5931119918823, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 55.53333333333334, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.8807909613156604e-38, "cur_lr": 0.0003, "total_loss": 6.437712907791138, "policy_loss": -0.0005972116357750363, "vf_loss": 6.438354068332249, "vf_explained_var": -8.344650268554688e-07, "kl": 0.0003864792494141511, "entropy": 0.44101908140712315, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 2223.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1488000, "num_env_steps_trained": 1488000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "sampler_results": {"episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.079999999999846, "episode_len_mean": 229.88, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.5, 44.10000000000001, 47.5, 47.5, 34.70000000000004, 46.9, 40.500000000000014, 29.49999999999998, -50.00000000000044, 44.5, 48.1, -50.00000000000044, 37.90000000000003, 44.10000000000001, 46.3, 46.3, -50.00000000000044, 45.5, 45.3, -50.00000000000044, 44.900000000000006, -50.00000000000044, 21.09999999999986, 43.7, 43.7, 46.3, -50.00000000000044, 44.300000000000004, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 24.099999999999902, -50.00000000000044, 36.30000000000003, 39.10000000000002, -50.00000000000044, 44.900000000000006, 45.3, 44.10000000000001, 45.5, 42.70000000000001, -50.00000000000044, 46.9, 18.29999999999982, -50.00000000000044, 36.70000000000003, 41.90000000000001, 44.7, -50.00000000000044, 8.49999999999968, 45.5, 43.30000000000001, -50.00000000000044, -50.00000000000044, 31.900000000000013, 28.699999999999967, -50.00000000000044, 44.5, 44.300000000000004, 46.099999999999994, -50.00000000000044, 46.5, 45.5, 46.3, 46.699999999999996, -50.00000000000044, 44.900000000000006, 45.5, 46.9, 46.3, -50.00000000000044, 45.5, -50.00000000000044, 1.6999999999995836, -50.00000000000044, -50.00000000000044, 21.499999999999865, 46.3, -50.00000000000044, 42.500000000000014, 45.7, 42.500000000000014, 38.10000000000002, 40.10000000000002, -50.00000000000044, 32.700000000000024, 37.90000000000003, -50.00000000000044, 37.90000000000003, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.50000000000002, 46.3, 0.6999999999995694], "episode_lengths": [36, 60, 26, 26, 154, 32, 96, 206, 500, 56, 20, 500, 122, 60, 38, 38, 500, 46, 48, 500, 52, 500, 290, 64, 64, 38, 500, 58, 500, 68, 500, 500, 260, 500, 138, 110, 500, 52, 48, 60, 46, 74, 500, 32, 318, 500, 134, 82, 54, 500, 416, 46, 68, 500, 500, 182, 214, 500, 56, 58, 40, 500, 36, 46, 38, 34, 500, 52, 46, 32, 38, 500, 46, 500, 484, 500, 500, 286, 38, 500, 76, 44, 76, 120, 100, 500, 174, 122, 500, 122, 500, 500, 84, 500, 500, 500, 500, 176, 38, 494]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3770338969139663, "mean_inference_ms": 1.2096042308846642, "mean_action_processing_ms": 0.1395177893950402, "mean_env_wait_ms": 0.0831338011887158, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027524709701538086, "StateBufferConnector_ms": 0.008000850677490234, "ViewRequirementAgentConnector_ms": 0.10976338386535645}}, "episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.079999999999846, "episode_len_mean": 229.88, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.5, 44.10000000000001, 47.5, 47.5, 34.70000000000004, 46.9, 40.500000000000014, 29.49999999999998, -50.00000000000044, 44.5, 48.1, -50.00000000000044, 37.90000000000003, 44.10000000000001, 46.3, 46.3, -50.00000000000044, 45.5, 45.3, -50.00000000000044, 44.900000000000006, -50.00000000000044, 21.09999999999986, 43.7, 43.7, 46.3, -50.00000000000044, 44.300000000000004, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 24.099999999999902, -50.00000000000044, 36.30000000000003, 39.10000000000002, -50.00000000000044, 44.900000000000006, 45.3, 44.10000000000001, 45.5, 42.70000000000001, -50.00000000000044, 46.9, 18.29999999999982, -50.00000000000044, 36.70000000000003, 41.90000000000001, 44.7, -50.00000000000044, 8.49999999999968, 45.5, 43.30000000000001, -50.00000000000044, -50.00000000000044, 31.900000000000013, 28.699999999999967, -50.00000000000044, 44.5, 44.300000000000004, 46.099999999999994, -50.00000000000044, 46.5, 45.5, 46.3, 46.699999999999996, -50.00000000000044, 44.900000000000006, 45.5, 46.9, 46.3, -50.00000000000044, 45.5, -50.00000000000044, 1.6999999999995836, -50.00000000000044, -50.00000000000044, 21.499999999999865, 46.3, -50.00000000000044, 42.500000000000014, 45.7, 42.500000000000014, 38.10000000000002, 40.10000000000002, -50.00000000000044, 32.700000000000024, 37.90000000000003, -50.00000000000044, 37.90000000000003, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.50000000000002, 46.3, 0.6999999999995694], "episode_lengths": [36, 60, 26, 26, 154, 32, 96, 206, 500, 56, 20, 500, 122, 60, 38, 38, 500, 46, 48, 500, 52, 500, 290, 64, 64, 38, 500, 58, 500, 68, 500, 500, 260, 500, 138, 110, 500, 52, 48, 60, 46, 74, 500, 32, 318, 500, 134, 82, 54, 500, 416, 46, 68, 500, 500, 182, 214, 500, 56, 58, 40, 500, 36, 46, 38, 34, 500, 52, 46, 32, 38, 500, 46, 500, 484, 500, 500, 286, 38, 500, 76, 44, 76, 120, 100, 500, 174, 122, 500, 122, 500, 500, 84, 500, 500, 500, 500, 176, 38, 494]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3770338969139663, "mean_inference_ms": 1.2096042308846642, "mean_action_processing_ms": 0.1395177893950402, "mean_env_wait_ms": 0.0831338011887158, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027524709701538086, "StateBufferConnector_ms": 0.008000850677490234, "ViewRequirementAgentConnector_ms": 0.10976338386535645}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000, "num_env_steps_sampled": 1488000, "num_env_steps_trained": 1488000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5501.507591077684, "num_env_steps_trained_throughput_per_sec": 5501.507591077684, "timesteps_total": 1488000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1488000, "timers": {"training_iteration_time_ms": 2200.955, "sample_time_ms": 1944.898, "load_time_ms": 10.641, "load_throughput": 1127753.708, "learn_time_ms": 234.462, "learn_throughput": 51181.096, "synch_weights_time_ms": 9.253}, "counters": {"num_env_steps_sampled": 1488000, "num_env_steps_trained": 1488000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "done": false, "episodes_total": 5698, "training_iteration": 124, "trial_id": "9f288_00016", "date": "2023-10-25_16-56-07", "timestamp": 1698249367, "time_this_iter_s": 2.1872169971466064, "time_total_s": 271.78032898902893, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 271.78032898902893, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 60.06666666666666, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.403954806578302e-39, "cur_lr": 0.0003, "total_loss": 6.875014464060466, "policy_loss": -0.00045257041023837193, "vf_loss": 6.875508891211616, "vf_explained_var": -9.470515780978733e-07, "kl": 0.0004806753216178726, "entropy": 0.41787300176090664, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 2241.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1500000, "num_env_steps_trained": 1500000, "num_agent_steps_sampled": 1500000, "num_agent_steps_trained": 1500000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.289999999999848, "episode_len_mean": 227.78, "episode_media": {}, "episodes_this_iter": 58, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.5, 44.300000000000004, 46.099999999999994, -50.00000000000044, 46.5, 45.5, 46.3, 46.699999999999996, -50.00000000000044, 44.900000000000006, 45.5, 46.9, 46.3, -50.00000000000044, 45.5, -50.00000000000044, 1.6999999999995836, -50.00000000000044, -50.00000000000044, 21.499999999999865, 46.3, -50.00000000000044, 42.500000000000014, 45.7, 42.500000000000014, 38.10000000000002, 40.10000000000002, -50.00000000000044, 32.700000000000024, 37.90000000000003, -50.00000000000044, 37.90000000000003, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.50000000000002, 46.3, 0.6999999999995694, -50.00000000000044, 47.9, 44.10000000000001, 40.30000000000002, 38.90000000000002, -50.00000000000044, 45.3, 43.30000000000001, 30.29999999999999, 47.1, 46.5, 39.10000000000002, -50.00000000000044, 46.099999999999994, 42.30000000000001, 42.900000000000006, 47.7, -50.00000000000044, -50.00000000000044, 44.7, 44.900000000000006, 41.30000000000001, -50.00000000000044, 38.10000000000002, -50.00000000000044, 45.1, 45.9, -50.00000000000044, 44.7, 44.5, 38.10000000000002, -50.00000000000044, 43.900000000000006, -50.00000000000044, 45.7, 46.099999999999994, -50.00000000000044, 3.899999999999615, -50.00000000000044, 21.89999999999987, 35.10000000000004, 44.7, 37.10000000000003, 37.10000000000003, 43.7, -50.00000000000044, 46.9, 42.70000000000001, 28.699999999999967, -50.00000000000044, 47.9, -50.00000000000044, 46.699999999999996, 45.9, -50.00000000000044, 42.500000000000014, -50.00000000000044, 22.299999999999876], "episode_lengths": [56, 58, 40, 500, 36, 46, 38, 34, 500, 52, 46, 32, 38, 500, 46, 500, 484, 500, 500, 286, 38, 500, 76, 44, 76, 120, 100, 500, 174, 122, 500, 122, 500, 500, 84, 500, 500, 500, 500, 176, 38, 494, 500, 22, 60, 98, 112, 500, 48, 68, 198, 30, 36, 110, 500, 40, 78, 72, 24, 500, 500, 54, 52, 88, 500, 120, 500, 50, 42, 500, 54, 56, 120, 500, 62, 500, 44, 40, 500, 462, 500, 282, 150, 54, 130, 130, 64, 500, 32, 74, 214, 500, 22, 500, 34, 42, 500, 76, 500, 278]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3769770878497557, "mean_inference_ms": 1.2094498823060826, "mean_action_processing_ms": 0.1397957569305209, "mean_env_wait_ms": 0.08318811544854633, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022525787353515625, "StateBufferConnector_ms": 0.0019986629486083984, "ViewRequirementAgentConnector_ms": 0.12054038047790527}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.289999999999848, "episode_len_mean": 227.78, "episodes_this_iter": 58, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.5, 44.300000000000004, 46.099999999999994, -50.00000000000044, 46.5, 45.5, 46.3, 46.699999999999996, -50.00000000000044, 44.900000000000006, 45.5, 46.9, 46.3, -50.00000000000044, 45.5, -50.00000000000044, 1.6999999999995836, -50.00000000000044, -50.00000000000044, 21.499999999999865, 46.3, -50.00000000000044, 42.500000000000014, 45.7, 42.500000000000014, 38.10000000000002, 40.10000000000002, -50.00000000000044, 32.700000000000024, 37.90000000000003, -50.00000000000044, 37.90000000000003, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.50000000000002, 46.3, 0.6999999999995694, -50.00000000000044, 47.9, 44.10000000000001, 40.30000000000002, 38.90000000000002, -50.00000000000044, 45.3, 43.30000000000001, 30.29999999999999, 47.1, 46.5, 39.10000000000002, -50.00000000000044, 46.099999999999994, 42.30000000000001, 42.900000000000006, 47.7, -50.00000000000044, -50.00000000000044, 44.7, 44.900000000000006, 41.30000000000001, -50.00000000000044, 38.10000000000002, -50.00000000000044, 45.1, 45.9, -50.00000000000044, 44.7, 44.5, 38.10000000000002, -50.00000000000044, 43.900000000000006, -50.00000000000044, 45.7, 46.099999999999994, -50.00000000000044, 3.899999999999615, -50.00000000000044, 21.89999999999987, 35.10000000000004, 44.7, 37.10000000000003, 37.10000000000003, 43.7, -50.00000000000044, 46.9, 42.70000000000001, 28.699999999999967, -50.00000000000044, 47.9, -50.00000000000044, 46.699999999999996, 45.9, -50.00000000000044, 42.500000000000014, -50.00000000000044, 22.299999999999876], "episode_lengths": [56, 58, 40, 500, 36, 46, 38, 34, 500, 52, 46, 32, 38, 500, 46, 500, 484, 500, 500, 286, 38, 500, 76, 44, 76, 120, 100, 500, 174, 122, 500, 122, 500, 500, 84, 500, 500, 500, 500, 176, 38, 494, 500, 22, 60, 98, 112, 500, 48, 68, 198, 30, 36, 110, 500, 40, 78, 72, 24, 500, 500, 54, 52, 88, 500, 120, 500, 50, 42, 500, 54, 56, 120, 500, 62, 500, 44, 40, 500, 462, 500, 282, 150, 54, 130, 130, 64, 500, 32, 74, 214, 500, 22, 500, 34, 42, 500, 76, 500, 278]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3769770878497557, "mean_inference_ms": 1.2094498823060826, "mean_action_processing_ms": 0.1397957569305209, "mean_env_wait_ms": 0.08318811544854633, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022525787353515625, "StateBufferConnector_ms": 0.0019986629486083984, "ViewRequirementAgentConnector_ms": 0.12054038047790527}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1500000, "num_agent_steps_trained": 1500000, "num_env_steps_sampled": 1500000, "num_env_steps_trained": 1500000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5750.854801783677, "num_env_steps_trained_throughput_per_sec": 5750.854801783677, "timesteps_total": 1500000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1500000, "timers": {"training_iteration_time_ms": 2199.431, "sample_time_ms": 1938.521, "load_time_ms": 10.737, "load_throughput": 1117582.034, "learn_time_ms": 238.914, "learn_throughput": 50227.191, "synch_weights_time_ms": 9.556}, "counters": {"num_env_steps_sampled": 1500000, "num_env_steps_trained": 1500000, "num_agent_steps_sampled": 1500000, "num_agent_steps_trained": 1500000}, "done": true, "episodes_total": 5756, "training_iteration": 125, "trial_id": "9f288_00016", "date": "2023-10-25_16-56-09", "timestamp": 1698249369, "time_this_iter_s": 2.092651128768921, "time_total_s": 273.87298011779785, "pid": 9832, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 273.87298011779785, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 56.86666666666667, "ram_util_percent": 27.2}}
